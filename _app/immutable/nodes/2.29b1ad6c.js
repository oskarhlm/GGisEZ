import{J as ap,K as qn,L as iu,M as CP,N as AP,S as sr,i as or,s as Qi,C as Ri,O as zt,k as qt,l as Wt,m as Qt,h as de,P as Xn,b as tt,G as Kt,Q as li,D as Pi,E as Di,F as Oi,R as hi,T as Gi,g as Te,d as Ne,U as Ss,V as vi,W as ds,X as Fr,I as Dl,o as ro,Y as bf,Z as Dh,_ as ls,w as Sn,e as pi,v as Wi,f as Xi,$ as lr,x as Xa,y as sn,z as dn,A as on,a0 as Mr,B as an,H as _l,a1 as PE,a2 as TE,a3 as wE,a4 as IC,a as vn,c as bn,n as tn,a5 as i0,a6 as lL,a7 as Lv,a8 as MP,a9 as LP,aa as RP,ab as PP,ac as DP,ad as OP,ae as NP,q as _i,r as yi,u as ys,af as DE,ag as uL,ah as eg,ai as uI,t as kP,aj as Xr,ak as Qr,p as wa,al as vm,am as bw,an as TC,ao as FP}from"../chunks/index.06842cad.js";import{w as Eh}from"../chunks/index.58f15b62.js";var ld=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ES(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var cL={exports:{}};(function(n,e){(function(t,i){n.exports=i()})(ld,function(){var t,i,r;function a(s,d){if(!t)t=d;else if(!i)i=d;else{var g="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+t+")(sharedChunk); ("+i+")(sharedChunk); self.onerror = null;",x={};t(x),r=d(x),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(r.workerUrl=window.URL.createObjectURL(new Blob([g],{type:"text/javascript"})))}}a(["exports"],function(s){var d=typeof self<"u"?self:{},g="2.13.0";let x;const I={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(x==null){const u=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{x={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):u}catch{x=u}}return x},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},A={supported:!1,testSupport:function(u){!B&&N&&(F?z(u):L=u)}};let L,N,B=!1,F=!1;function z(u){const o=u.createTexture();u.bindTexture(u.TEXTURE_2D,o);try{if(u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,N),u.isContextLost())return;A.supported=!0}catch{}u.deleteTexture(o),B=!0}d.document&&(N=d.document.createElement("img"),N.onload=function(){L&&z(L),L=null,F=!0},N.onerror=function(){B=!0,L=null},N.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const V="01";var Y=Q;function Q(u,o,c,f){this.cx=3*u,this.bx=3*(c-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(f-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=o,this.p2x=c,this.p2y=f}Q.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,o){if(o===void 0&&(o=1e-6),u<0)return 0;if(u>1)return 1;for(var c=u,f=0;f<8;f++){var m=this.sampleCurveX(c)-u;if(Math.abs(m)<o)return c;var v=this.sampleCurveDerivativeX(c);if(Math.abs(v)<1e-6)break;c-=m/v}var E=0,S=1;for(c=u,f=0;f<20&&(m=this.sampleCurveX(c),!(Math.abs(m-u)<o));f++)u>m?E=c:S=c,c=.5*(S-E)+E;return c},solve:function(u,o){return this.sampleCurveY(this.solveCurveX(u,o))}};var J=he;function he(u,o){this.x=u,this.y=o}he.prototype={clone:function(){return new he(this.x,this.y)},add:function(u){return this.clone()._add(u)},sub:function(u){return this.clone()._sub(u)},multByPoint:function(u){return this.clone()._multByPoint(u)},divByPoint:function(u){return this.clone()._divByPoint(u)},mult:function(u){return this.clone()._mult(u)},div:function(u){return this.clone()._div(u)},rotate:function(u){return this.clone()._rotate(u)},rotateAround:function(u,o){return this.clone()._rotateAround(u,o)},matMult:function(u){return this.clone()._matMult(u)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(u){return this.x===u.x&&this.y===u.y},dist:function(u){return Math.sqrt(this.distSqr(u))},distSqr:function(u){var o=u.x-this.x,c=u.y-this.y;return o*o+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(u){return Math.atan2(this.y-u.y,this.x-u.x)},angleWith:function(u){return this.angleWithSep(u.x,u.y)},angleWithSep:function(u,o){return Math.atan2(this.x*o-this.y*u,this.x*u+this.y*o)},_matMult:function(u){var o=u[2]*this.x+u[3]*this.y;return this.x=u[0]*this.x+u[1]*this.y,this.y=o,this},_add:function(u){return this.x+=u.x,this.y+=u.y,this},_sub:function(u){return this.x-=u.x,this.y-=u.y,this},_mult:function(u){return this.x*=u,this.y*=u,this},_div:function(u){return this.x/=u,this.y/=u,this},_multByPoint:function(u){return this.x*=u.x,this.y*=u.y,this},_divByPoint:function(u){return this.x/=u.x,this.y/=u.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var u=this.y;return this.y=this.x,this.x=-u,this},_rotate:function(u){var o=Math.cos(u),c=Math.sin(u),f=c*this.x+o*this.y;return this.x=o*this.x-c*this.y,this.y=f,this},_rotateAround:function(u,o){var c=Math.cos(u),f=Math.sin(u),m=o.y+f*(this.x-o.x)+c*(this.y-o.y);return this.x=o.x+c*(this.x-o.x)-f*(this.y-o.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},he.convert=function(u){return u instanceof he?u:Array.isArray(u)?new he(u[0],u[1]):u};const ee=Math.PI/180,ae=180/Math.PI;function De(u){return u*ee}function fe(u){return u*ae}const le=[[0,0],[1,0],[1,1],[0,1]];function Be(u){if(u<=0)return 0;if(u>=1)return 1;const o=u*u,c=o*u;return 4*(u<.5?c:3*(u-o)+c-.75)}function Pe(u,o,c,f){const m=new Y(u,o,c,f);return function(v){return m.solve(v)}}const Ce=Pe(.25,.1,.25,1);function it(u,o,c){return Math.min(c,Math.max(o,u))}function Et(u,o,c){return(c=it((c-u)/(o-u),0,1))*c*(3-2*c)}function Ue(u,o,c){const f=c-o,m=((u-o)%f+f)%f+o;return m===o?c:m}function at(u,o,c){if(!u.length)return c(null,[]);let f=u.length;const m=new Array(u.length);let v=null;u.forEach((E,S)=>{o(E,(M,R)=>{M&&(v=M),m[S]=R,--f==0&&c(v,m)})})}function ke(u){const o=[];for(const c in u)o.push(u[c]);return o}function Dt(u,...o){for(const c of o)for(const f in c)u[f]=c[f];return u}let fn=1;function Cn(){return fn++}function Gt(){return function u(o){return o?(o^Math.random()*(16>>o/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,u)}()}function Mt(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))}function vt(u){return!!u&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(u)}function xn(u,o){u.forEach(c=>{o[c]&&(o[c]=o[c].bind(o))})}function En(u,o){return u.indexOf(o,u.length-o.length)!==-1}function _t(u,o,c){const f={};for(const m in u)f[m]=o.call(c||this,u[m],m,u);return f}function kt(u,o,c){const f={};for(const m in u)o.call(c||this,u[m],m,u)&&(f[m]=u[m]);return f}function Ct(u){return Array.isArray(u)?u.map(Ct):typeof u=="object"&&u?_t(u,Ct):u}const Bt={};function Zn(u){Bt[u]||(typeof console<"u"&&console.warn(u),Bt[u]=!0)}function mi(u,o,c){return(c.y-u.y)*(o.x-u.x)>(o.y-u.y)*(c.x-u.x)}function yn(u){let o=0;for(let c,f,m=0,v=u.length,E=v-1;m<v;E=m++)c=u[m],f=u[E],o+=(f.x-c.x)*(c.y+f.y);return o}function Pt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Yn(u){const o={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,f,m,v)=>{const E=m||v;return o[f]=!E||E.toLowerCase(),""}),o["max-age"]){const c=parseInt(o["max-age"],10);isNaN(c)?delete o["max-age"]:o["max-age"]=c}return o}let si=null;function Dr(u){if(si==null){const o=u.navigator?u.navigator.userAgent:null;si=!!u.safari||!(!o||!(/\b(iPad|iPhone|iPod)\b/.test(o)||o.match("Safari")&&!o.match("Chrome")))}return si}function Ur(u){try{const o=d[u];return o.setItem("_mapbox_test_",1),o.removeItem("_mapbox_test_"),!0}catch{return!1}}function He(u,o){return[u[4*o],u[4*o+1],u[4*o+2],u[4*o+3]]}const Jt="mapbox-tiles";let ui,$e,kn=500,Ei=50;function ni(){try{return d.caches}catch{}}function Ln(){ni()&&!ui&&(ui=d.caches.open(Jt))}function ki(u){const o=u.indexOf("?");if(o<0)return u;const c=function(m){const v=m.indexOf("?");return v>0?m.slice(v+1).split("&"):[]}(u),f=c.filter(m=>{const v=m.split("=");return v[0]==="language"||v[0]==="worldview"});return f.length?`${u.slice(0,o)}?${f.join("&")}`:u.slice(0,o)}let Hs=1/0;const Xt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Xt);class Rn extends Error{constructor(o,c,f){c===401&&Ma(f)&&(o+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(o),this.status=c,this.url=f}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ti=Pt()?()=>self.worker&&self.worker.referrer:()=>(d.location.protocol==="blob:"?d.parent:d).location.href,tr=function(u,o){if(!(/^file:/.test(c=u.url)||/^file:/.test(ti())&&!/^\w+:/.test(c))){if(d.fetch&&d.Request&&d.AbortController&&d.Request.prototype.hasOwnProperty("signal"))return function(f,m){const v=new d.AbortController,E=new d.Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:ti(),signal:v.signal});let S=!1,M=!1;const R=(U=E.url).indexOf("sku=")>0&&Ma(U);var U;f.type==="json"&&E.headers.set("Accept","application/json");const H=(K,$,ie)=>{if(M)return;if(K&&K.message!=="SecurityError"&&Zn(K),$&&ie)return q($);const me=Date.now();d.fetch(E).then(Me=>{if(Me.ok){const Ve=R?Me.clone():null;return q(Me,Ve,me)}return m(new Rn(Me.statusText,Me.status,f.url))}).catch(Me=>{Me.name!=="AbortError"&&m(new Error(`${Me.message} ${f.url}`))})},q=(K,$,ie)=>{(f.type==="arrayBuffer"?K.arrayBuffer():f.type==="json"?K.json():K.text()).then(me=>{M||($&&ie&&function(Me,Ve,Se){if(Ln(),!ui)return;const ze={status:Ve.status,statusText:Ve.statusText,headers:new d.Headers};Ve.headers.forEach((It,bt)=>ze.headers.set(bt,It));const Ze=Yn(Ve.headers.get("Cache-Control")||"");if(Ze["no-store"])return;Ze["max-age"]&&ze.headers.set("Expires",new Date(Se+1e3*Ze["max-age"]).toUTCString());const qe=ze.headers.get("Expires");qe&&(new Date(qe).getTime()-Se<42e4||function(It,bt){if($e===void 0)try{new Response(new ReadableStream),$e=!0}catch{$e=!1}$e?bt(It.body):It.blob().then(bt)}(Ve,It=>{const bt=new d.Response(It,ze);Ln(),ui&&ui.then(Vt=>Vt.put(ki(Me.url),bt)).catch(Vt=>Zn(Vt.message))}))}(E,$,ie),S=!0,m(null,me,K.headers.get("Cache-Control"),K.headers.get("Expires")))}).catch(me=>{M||m(new Error(me.message))})};return R?function(K,$){if(Ln(),!ui)return $(null);const ie=ki(K.url);ui.then(me=>{me.match(ie).then(Me=>{const Ve=function(Se){if(!Se)return!1;const ze=new Date(Se.headers.get("Expires")||0),Ze=Yn(Se.headers.get("Cache-Control")||"");return ze>Date.now()&&!Ze["no-cache"]}(Me);me.delete(ie),Ve&&me.put(ie,Me.clone()),$(null,Me,Ve)}).catch($)}).catch($)}(E,H):H(null,null),{cancel:()=>{M=!0,S||v.abort()}}}(u,o);if(Pt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",u,o,void 0,!0)}var c;return function(f,m){const v=new d.XMLHttpRequest;v.open(f.method||"GET",f.url,!0),f.type==="arrayBuffer"&&(v.responseType="arraybuffer");for(const E in f.headers)v.setRequestHeader(E,f.headers[E]);return f.type==="json"&&(v.responseType="text",v.setRequestHeader("Accept","application/json")),v.withCredentials=f.credentials==="include",v.onerror=()=>{m(new Error(v.statusText))},v.onload=()=>{if((v.status>=200&&v.status<300||v.status===0)&&v.response!==null){let E=v.response;if(f.type==="json")try{E=JSON.parse(v.response)}catch(S){return m(S)}m(null,E,v.getResponseHeader("Cache-Control"),v.getResponseHeader("Expires"))}else m(new Rn(v.statusText,v.status,f.url))},v.send(f.body),{cancel:()=>v.abort()}}(u,o)},js=function(u,o){return tr(Dt(u,{type:"arrayBuffer"}),o)};function mo(u){const o=d.document.createElement("a");return o.href=u,o.protocol===d.document.location.protocol&&o.host===d.document.location.host}const ca="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Xo,qs;Xo=[],qs=0;const No=function(u,o){if(A.supported&&(u.headers||(u.headers={}),u.headers.accept="image/webp,*/*"),qs>=I.MAX_PARALLEL_IMAGE_REQUESTS){const v={requestParameters:u,callback:o,cancelled:!1,cancel(){this.cancelled=!0}};return Xo.push(v),v}qs++;let c=!1;const f=()=>{if(!c)for(c=!0,qs--;Xo.length&&qs<I.MAX_PARALLEL_IMAGE_REQUESTS;){const v=Xo.shift(),{requestParameters:E,callback:S,cancelled:M}=v;M||(v.cancel=No(E,S).cancel)}},m=js(u,(v,E,S,M)=>{f(),v?o(v):E&&(d.createImageBitmap?function(R,U){const H=new d.Blob([new Uint8Array(R)],{type:"image/png"});d.createImageBitmap(H).then(q=>{U(null,q)}).catch(q=>{U(new Error(`Could not load image because of ${q.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(E,(R,U)=>o(R,U,S,M)):function(R,U){const H=new d.Image,q=d.URL;H.onload=()=>{U(null,H),q.revokeObjectURL(H.src),H.onload=null,d.requestAnimationFrame(()=>{H.src=ca})},H.onerror=()=>U(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const K=new d.Blob([new Uint8Array(R)],{type:"image/png"});H.src=R.byteLength?q.createObjectURL(K):ca}(E,(R,U)=>o(R,U,S,M)))});return{cancel:()=>{m.cancel(),f()}}},Ja="NO_ACCESS_TOKEN";function go(u){return u.indexOf("mapbox:")===0}function Ma(u){return I.API_URL_REGEX.test(u)}function Vl(u){return I.API_CDN_URL_REGEX.test(u)}function Qa(u){return I.API_STYLE_REGEX.test(u)&&!ha(u)}function ha(u){return I.API_SPRITE_REGEX.test(u)}const $a=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Zs(u){const o=u.match($a);if(!o)throw new Error("Unable to parse URL object");return{protocol:o[1],authority:o[2],path:o[3]||"/",params:o[4]?o[4].split("&"):[]}}function La(u){const o=u.params.length?`?${u.params.join("&")}`:"";return`${u.protocol}://${u.authority}${u.path}${o}`}function so(u){if(!u)return null;const o=u.split(".");if(!o||o.length!==3)return null;try{return JSON.parse(decodeURIComponent(d.atob(o[1]).split("").map(c=>"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Ra{constructor(o){this.type=o,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(o){const c=so(I.ACCESS_TOKEN);let f="";return f=c&&c.u?d.btoa(encodeURIComponent(c.u).replace(/%([0-9A-F]{2})/g,(m,v)=>String.fromCharCode(+("0x"+v)))):I.ACCESS_TOKEN||"",o?`mapbox.eventData.${o}:${f}`:`mapbox.eventData:${f}`}fetchEventData(){const o=Ur("localStorage"),c=this.getStorageKey(),f=this.getStorageKey("uuid");if(o)try{const m=d.localStorage.getItem(c);m&&(this.eventData=JSON.parse(m));const v=d.localStorage.getItem(f);v&&(this.anonId=v)}catch{Zn("Unable to read from LocalStorage")}}saveEventData(){const o=Ur("localStorage"),c=this.getStorageKey(),f=this.getStorageKey("uuid");if(o)try{d.localStorage.setItem(f,this.anonId),Object.keys(this.eventData).length>=1&&d.localStorage.setItem(c,JSON.stringify(this.eventData))}catch{Zn("Unable to write to LocalStorage")}}processRequests(o){}postEvent(o,c,f,m){if(!I.EVENTS_URL)return;const v=Zs(I.EVENTS_URL);v.params.push(`access_token=${m||I.ACCESS_TOKEN||""}`);const E={event:this.type,created:new Date(o).toISOString()},S=c?Dt(E,c):E,M={url:La(v),headers:{"Content-Type":"text/plain"},body:JSON.stringify([S])};this.pendingRequest=function(R,U){return tr(Dt(R,{method:"POST"}),U)}(M,R=>{this.pendingRequest=null,f(R),this.saveEventData(),this.processRequests(m)})}queueRequest(o,c){this.queue.push(o),this.processRequests(c)}}const we=new class extends Ra{constructor(u){super("appUserTurnstile"),this._customAccessToken=u}postTurnstileEvent(u,o){I.EVENTS_URL&&I.ACCESS_TOKEN&&Array.isArray(u)&&u.some(c=>go(c)||Ma(c))&&this.queueRequest(Date.now(),o)}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const o=so(I.ACCESS_TOKEN),c=o?o.u:I.ACCESS_TOKEN;let f=c!==this.eventData.tokenU;vt(this.anonId)||(this.anonId=Gt(),f=!0);const m=this.queue.shift();if(this.eventData.lastSuccess){const v=new Date(this.eventData.lastSuccess),E=new Date(m),S=(m-this.eventData.lastSuccess)/864e5;f=f||S>=1||S<-1||v.getDate()!==E.getDate()}else f=!0;f?this.postEvent(m,{sdkIdentifier:"mapbox-gl-js",sdkVersion:g,skuId:V,"enabled.telemetry":!1,userId:this.anonId},v=>{v||(this.eventData.lastSuccess=m,this.eventData.tokenU=c)},u):this.processRequests()}},te=we.postTurnstileEvent.bind(we),re=new class extends Ra{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(u,o,c,f){this.skuToken=o,this.errorCb=f,I.EVENTS_URL&&(c||I.ACCESS_TOKEN?this.queueRequest({id:u,timestamp:Date.now()},c):this.errorCb(new Error(Ja)))}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;const{id:o,timestamp:c}=this.queue.shift();o&&this.success[o]||(this.anonId||this.fetchEventData(),vt(this.anonId)||(this.anonId=Gt()),this.postEvent(c,{sdkIdentifier:"mapbox-gl-js",sdkVersion:g,skuId:V,skuToken:this.skuToken,userId:this.anonId},f=>{f?this.errorCb(f):o&&(this.success[o]=!0)},u))}},Ie=re.postMapLoadEvent.bind(re),Oe=new class extends Ra{constructor(){super("gljs.performance")}postPerformanceEvent(u,o){I.EVENTS_URL&&(u||I.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:o},u)}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:o,performanceData:c}=this.queue.shift(),f=function(m){const v=d.performance.getEntriesByType("resource"),E=d.performance.getEntriesByType("mark"),S=function(q){const K={};if(q){for(const $ in q)if($!=="other")for(const ie of q[$]){const me=`${$}ResolveRangeMin`,Me=`${$}ResolveRangeMax`,Ve=`${$}RequestCount`,Se=`${$}RequestCachedCount`;K[me]=Math.min(K[me]||1/0,ie.startTime),K[Me]=Math.max(K[Me]||-1/0,ie.responseEnd);const ze=Ze=>{K[Ze]===void 0&&(K[Ze]=0),++K[Ze]};ie.transferSize!==void 0&&ie.transferSize===0&&ze(Se),ze(Ve)}}return K}(function(q,K){const $={};if(q)for(const ie of q){const me=K(ie);$[me]===void 0&&($[me]=[]),$[me].push(ie)}return $}(v,be)),M=d.devicePixelRatio,R=d.navigator.connection||d.navigator.mozConnection||d.navigator.webkitConnection,U={counters:[],metadata:[],attributes:[]},H=(q,K,$)=>{$!=null&&q.push({name:K,value:$.toString()})};for(const q in S)H(U.counters,q,S[q]);if(m.interactionRange[0]!==1/0&&m.interactionRange[1]!==-1/0&&(H(U.counters,"interactionRangeMin",m.interactionRange[0]),H(U.counters,"interactionRangeMax",m.interactionRange[1])),E)for(const q of Object.keys(pe)){const K=pe[q],$=E.find(ie=>ie.name===K);$&&H(U.counters,K,$.startTime)}return H(U.counters,"visibilityHidden",m.visibilityHidden),H(U.attributes,"style",function(q){if(q)for(const K of q){const $=K.name.split("?")[0];if(Qa($)){const ie=$.split("/").slice(-2);if(ie.length===2)return`mapbox://styles/${ie[0]}/${ie[1]}`}}}(v)),H(U.attributes,"terrainEnabled",m.terrainEnabled?"true":"false"),H(U.attributes,"fogEnabled",m.fogEnabled?"true":"false"),H(U.attributes,"projection",m.projection),H(U.attributes,"zoom",m.zoom),H(U.metadata,"devicePixelRatio",M),H(U.metadata,"connectionEffectiveType",R?R.effectiveType:void 0),H(U.metadata,"navigatorUserAgent",d.navigator.userAgent),H(U.metadata,"screenWidth",d.screen.width),H(U.metadata,"screenHeight",d.screen.height),H(U.metadata,"windowWidth",d.innerWidth),H(U.metadata,"windowHeight",d.innerHeight),H(U.metadata,"mapWidth",m.width/M),H(U.metadata,"mapHeight",m.height/M),H(U.metadata,"webglRenderer",m.renderer),H(U.metadata,"webglVendor",m.vendor),H(U.metadata,"sdkVersion",g),H(U.metadata,"sdkIdentifier","mapbox-gl-js"),U}(c);for(const m of f.metadata);for(const m of f.counters);for(const m of f.attributes);this.postEvent(o,f,()=>{},u)}},We=Oe.postPerformanceEvent.bind(Oe),ut=new class extends Ra{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(u,o,c,f){if(!I.API_URL||!I.SESSION_PATH)return;const m=Zs(I.API_URL+I.SESSION_PATH);m.params.push(`sku=${o||""}`),m.params.push(`access_token=${f||I.ACCESS_TOKEN||""}`);const v={url:La(m),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(E,S){return tr(Dt(E,{method:"GET"}),S)}(v,E=>{this.pendingRequest=null,c(E),this.saveEventData(),this.processRequests(f)})}getSessionAPI(u,o,c,f){this.skuToken=o,this.errorCb=f,I.SESSION_PATH&&I.API_URL&&(c||I.ACCESS_TOKEN?this.queueRequest({id:u,timestamp:Date.now()},c):this.errorCb(new Error(Ja)))}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;const{id:o,timestamp:c}=this.queue.shift();o&&this.success[o]||this.getSession(c,this.skuToken,f=>{f?this.errorCb(f):o&&(this.success[o]=!0)},u)}},ot=ut.getSessionAPI.bind(ut),Je=new Set,pe={create:"create",load:"load",fullLoad:"fullLoad"},nt={mark(u){d.performance.mark(u)},measure(u,o,c){d.performance.measure(u,o,c)}};function be(u){const o=u.name.split("?")[0];return Vl(o)&&o.includes("mapbox-gl.js")?"javascript":Vl(o)&&o.includes("mapbox-gl.css")?"css":function(c){return I.API_FONTS_REGEX.test(c)}(o)?"fontRange":ha(o)?"sprite":Qa(o)?"style":function(c){return I.API_TILEJSON_REGEX.test(c)}(o)?"tilejson":"other"}const Ot=d.performance;function On(u){const o=u?u.url.toString():void 0;return Ot.getEntriesByName(o)}let ii,ei,Ye,Qn;const xr={now:()=>Ye!==void 0?Ye:d.performance.now(),setNow(u){Ye=u},restoreNow(){Ye=void 0},frame(u){const o=d.requestAnimationFrame(u);return{cancel:()=>d.cancelAnimationFrame(o)}},getImageData(u,o=0){const{width:c,height:f}=u;Qn||(Qn=d.document.createElement("canvas"));const m=Qn.getContext("2d",{willReadFrequently:!0});if(!m)throw new Error("failed to create canvas 2d context");return(c>Qn.width||f>Qn.height)&&(Qn.width=c,Qn.height=f),m.clearRect(-o,-o,c+2*o,f+2*o),m.drawImage(u,0,0,c,f),m.getImageData(-o,-o,c+2*o,f+2*o)},resolveURL:u=>(ii||(ii=d.document.createElement("a")),ii.href=u,ii.href),get devicePixelRatio(){return d.devicePixelRatio},get prefersReducedMotion(){return!!d.matchMedia&&(ei==null&&(ei=d.matchMedia("(prefers-reduced-motion: reduce)")),ei.matches)}};function Ti(u,o,c){c[u]&&c[u].indexOf(o)!==-1||(c[u]=c[u]||[],c[u].push(o))}function mr(u,o,c){if(c&&c[u]){const f=c[u].indexOf(o);f!==-1&&c[u].splice(f,1)}}class yr{constructor(o,c={}){Dt(this,c),this.type=o}}class Gl extends yr{constructor(o,c={}){super("error",Dt({error:o},c))}}class fa{on(o,c){return this._listeners=this._listeners||{},Ti(o,c,this._listeners),this}off(o,c){return mr(o,c,this._listeners),mr(o,c,this._oneTimeListeners),this}once(o,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},Ti(o,c,this._oneTimeListeners),this):new Promise(f=>this.once(o,f))}fire(o,c){typeof o=="string"&&(o=new yr(o,c||{}));const f=o.type;if(this.listens(f)){o.target=this;const m=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const S of m)S.call(this,o);const v=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const S of v)mr(f,S,this._oneTimeListeners),S.call(this,o);const E=this._eventedParent;E&&(Dt(o,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),E.fire(o))}else o instanceof Gl&&console.error(o.error);return this}listens(o){return!!(this._listeners&&this._listeners[o]&&this._listeners[o].length>0||this._oneTimeListeners&&this._oneTimeListeners[o]&&this._oneTimeListeners[o].length>0||this._eventedParent&&this._eventedParent.listens(o))}setEventedParent(o,c){return this._eventedParent=o,this._eventedParentData=c,this}}var Rt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Hl(u,...o){for(const c of o)for(const f in c)u[f]=c[f];return u}function Ys(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function dc(u){if(Array.isArray(u))return u.map(dc);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const o={};for(const c in u)o[c]=dc(u[c]);return o}return Ys(u)}class xm extends Error{constructor(o,c){super(c),this.message=c,this.key=o}}var jl=xm;class Pu{constructor(o,c=[]){this.parent=o,this.bindings={};for(const[f,m]of c)this.bindings[f]=m}concat(o){return new Pu(this,o)}get(o){if(this.bindings[o])return this.bindings[o];if(this.parent)return this.parent.get(o);throw new Error(`${o} not found in scope.`)}has(o){return!!this.bindings[o]||!!this.parent&&this.parent.has(o)}}var Ip=Pu;const pc={kind:"null"},An={kind:"number"},hr={kind:"string"},pr={kind:"boolean"},Pa={kind:"color"},O={kind:"object"},j={kind:"value"},ue={kind:"collator"},Fe={kind:"formatted"},et={kind:"resolvedImage"};function Qe(u,o){return{kind:"array",itemType:u,N:o}}function st(u){if(u.kind==="array"){const o=st(u.itemType);return typeof u.N=="number"?`array<${o}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${o}>`}return u.kind}const _n=[pc,An,hr,pr,Pa,Fe,O,Qe(j),et];function mn(u,o){if(o.kind==="error")return null;if(u.kind==="array"){if(o.kind==="array"&&(o.N===0&&o.itemType.kind==="value"||!mn(u.itemType,o.itemType))&&(typeof u.N!="number"||u.N===o.N))return null}else{if(u.kind===o.kind)return null;if(u.kind==="value"){for(const c of _n)if(!mn(c,o))return null}}return`Expected ${st(u)} but found ${st(o)} instead.`}function Wn(u,o){return o.some(c=>c.kind===u.kind)}function Pn(u,o){return o.some(c=>c==="null"?u===null:c==="array"?Array.isArray(u):c==="object"?u&&!Array.isArray(u)&&typeof u=="object":c===typeof u)}var Fn,Fi={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function vs(u){return(u=Math.round(u))<0?0:u>255?255:u}function zi(u){return vs(u[u.length-1]==="%"?parseFloat(u)/100*255:parseInt(u))}function Cs(u){return(o=u[u.length-1]==="%"?parseFloat(u)/100:parseFloat(u))<0?0:o>1?1:o;var o}function nn(u,o,c){return c<0?c+=1:c>1&&(c-=1),6*c<1?u+(o-u)*c*6:2*c<1?o:3*c<2?u+(o-u)*(2/3-c)*6:u}try{Fn={}.parseCSSColor=function(u){var o,c=u.replace(/ /g,"").toLowerCase();if(c in Fi)return Fi[c].slice();if(c[0]==="#")return c.length===4?(o=parseInt(c.substr(1),16))>=0&&o<=4095?[(3840&o)>>4|(3840&o)>>8,240&o|(240&o)>>4,15&o|(15&o)<<4,1]:null:c.length===7&&(o=parseInt(c.substr(1),16))>=0&&o<=16777215?[(16711680&o)>>16,(65280&o)>>8,255&o,1]:null;var f=c.indexOf("("),m=c.indexOf(")");if(f!==-1&&m+1===c.length){var v=c.substr(0,f),E=c.substr(f+1,m-(f+1)).split(","),S=1;switch(v){case"rgba":if(E.length!==4)return null;S=Cs(E.pop());case"rgb":return E.length!==3?null:[zi(E[0]),zi(E[1]),zi(E[2]),S];case"hsla":if(E.length!==4)return null;S=Cs(E.pop());case"hsl":if(E.length!==3)return null;var M=(parseFloat(E[0])%360+360)%360/360,R=Cs(E[1]),U=Cs(E[2]),H=U<=.5?U*(R+1):U+R-U*R,q=2*U-H;return[vs(255*nn(q,H,M+1/3)),vs(255*nn(q,H,M)),vs(255*nn(q,H,M-1/3)),S];default:return null}}return null}}catch{}class Kn{constructor(o,c,f,m=1){this.r=o,this.g=c,this.b=f,this.a=m}static parse(o){if(!o)return;if(o instanceof Kn)return o;if(typeof o!="string")return;const c=Fn(o);return c?new Kn(c[0]/255*c[3],c[1]/255*c[3],c[2]/255*c[3],c[3]):void 0}toString(){const[o,c,f,m]=this.toArray();return`rgba(${Math.round(o)},${Math.round(c)},${Math.round(f)},${m})`}toArray(){const{r:o,g:c,b:f,a:m}=this;return m===0?[0,0,0,0]:[255*o/m,255*c/m,255*f/m,m]}toArray01(){const{r:o,g:c,b:f,a:m}=this;return m===0?[0,0,0,0]:[o/m,c/m,f/m,m]}toArray01PremultipliedAlpha(){const{r:o,g:c,b:f,a:m}=this;return[o,c,f,m]}}Kn.black=new Kn(0,0,0,1),Kn.white=new Kn(1,1,1,1),Kn.transparent=new Kn(0,0,0,0),Kn.red=new Kn(1,0,0,1),Kn.blue=new Kn(0,0,1,1);var qi=Kn;class oo{constructor(o,c,f){this.sensitivity=o?c?"variant":"case":c?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(o,c){return this.collator.compare(o,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Fs{constructor(o,c,f,m,v){this.text=o.normalize?o.normalize():o,this.image=c,this.scale=f,this.fontStack=m,this.textColor=v}}class Zo{constructor(o){this.sections=o}static fromString(o){return new Zo([new Fs(o,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(o=>o.text.length!==0||o.image&&o.image.name.length!==0)}static factory(o){return o instanceof Zo?o:Zo.fromString(o)}toString(){return this.sections.length===0?"":this.sections.map(o=>o.text).join("")}serialize(){const o=["format"];for(const c of this.sections){if(c.image){o.push(["image",c.image.name]);continue}o.push(c.text);const f={};c.fontStack&&(f["text-font"]=["literal",c.fontStack.split(",")]),c.scale&&(f["font-scale"]=c.scale),c.textColor&&(f["text-color"]=["rgba"].concat(c.textColor.toArray())),o.push(f)}return o}}class da{constructor(o){this.name=o.name,this.available=o.available}toString(){return this.name}static fromString(o){return o?new da({name:o,available:!1}):null}serialize(){return["image",this.name]}}function As(u,o,c,f){return typeof u=="number"&&u>=0&&u<=255&&typeof o=="number"&&o>=0&&o<=255&&typeof c=="number"&&c>=0&&c<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[u,o,c,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[u,o,c,f]:[u,o,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Bf(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof qi||u instanceof oo||u instanceof Zo||u instanceof da)return!0;if(Array.isArray(u)){for(const o of u)if(!Bf(o))return!1;return!0}if(typeof u=="object"){for(const o in u)if(!Bf(u[o]))return!1;return!0}return!1}function _o(u){if(u===null)return pc;if(typeof u=="string")return hr;if(typeof u=="boolean")return pr;if(typeof u=="number")return An;if(u instanceof qi)return Pa;if(u instanceof oo)return ue;if(u instanceof Zo)return Fe;if(u instanceof da)return et;if(Array.isArray(u)){const o=u.length;let c;for(const f of u){const m=_o(f);if(c){if(c===m)continue;c=j;break}c=m}return Qe(c||j,o)}return O}function pa(u){const o=typeof u;return u===null?"":o==="string"||o==="number"||o==="boolean"?String(u):u instanceof qi||u instanceof Zo||u instanceof da?u.toString():JSON.stringify(u)}class Cd{constructor(o,c){this.type=o,this.value=c}static parse(o,c){if(o.length!==2)return c.error(`'literal' expression requires exactly one argument, but found ${o.length-1} instead.`);if(!Bf(o[1]))return c.error("invalid value");const f=o[1];let m=_o(f);const v=c.expectedType;return m.kind!=="array"||m.N!==0||!v||v.kind!=="array"||typeof v.N=="number"&&v.N!==0||(m=v),new Cd(m,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof qi?["rgba"].concat(this.value.toArray()):this.value instanceof Zo?this.value.serialize():this.value}}var kh=Cd,ko=class{constructor(u){this.name="ExpressionEvaluationError",this.message=u}toJSON(){return this.message}};const Fh={string:hr,number:An,boolean:pr,object:O};class Qc{constructor(o,c){this.type=o,this.args=c}static parse(o,c){if(o.length<2)return c.error("Expected at least one argument.");let f,m=1;const v=o[0];if(v==="array"){let S,M;if(o.length>2){const R=o[1];if(typeof R!="string"||!(R in Fh)||R==="object")return c.error('The item type argument of "array" must be one of string, number, boolean',1);S=Fh[R],m++}else S=j;if(o.length>3){if(o[2]!==null&&(typeof o[2]!="number"||o[2]<0||o[2]!==Math.floor(o[2])))return c.error('The length argument to "array" must be a positive integer literal',2);M=o[2],m++}f=Qe(S,M)}else f=Fh[v];const E=[];for(;m<o.length;m++){const S=c.parse(o[m],m,j);if(!S)return null;E.push(S)}return new Qc(f,E)}evaluate(o){for(let c=0;c<this.args.length;c++){const f=this.args[c].evaluate(o);if(!mn(this.type,_o(f)))return f;if(c===this.args.length-1)throw new ko(`Expected value to be of type ${st(this.type)}, but found ${st(_o(f))} instead.`)}return null}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=this.type,c=[o.kind];if(o.kind==="array"){const f=o.itemType;if(f.kind==="string"||f.kind==="number"||f.kind==="boolean"){c.push(f.kind);const m=o.N;(typeof m=="number"||this.args.length>1)&&c.push(m)}}return c.concat(this.args.map(f=>f.serialize()))}}var Vr=Qc;class rs{constructor(o){this.type=Fe,this.sections=o}static parse(o,c){if(o.length<2)return c.error("Expected at least one argument.");const f=o[1];if(!Array.isArray(f)&&typeof f=="object")return c.error("First argument must be an image or text section.");const m=[];let v=!1;for(let E=1;E<=o.length-1;++E){const S=o[E];if(v&&typeof S=="object"&&!Array.isArray(S)){v=!1;let M=null;if(S["font-scale"]&&(M=c.parse(S["font-scale"],1,An),!M))return null;let R=null;if(S["text-font"]&&(R=c.parse(S["text-font"],1,Qe(hr)),!R))return null;let U=null;if(S["text-color"]&&(U=c.parse(S["text-color"],1,Pa),!U))return null;const H=m[m.length-1];H.scale=M,H.font=R,H.textColor=U}else{const M=c.parse(o[E],1,j);if(!M)return null;const R=M.type.kind;if(R!=="string"&&R!=="value"&&R!=="null"&&R!=="resolvedImage")return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,m.push({content:M,scale:null,font:null,textColor:null})}}return new rs(m)}evaluate(o){return new Zo(this.sections.map(c=>{const f=c.content.evaluate(o);return _o(f)===et?new Fs("",f,null,null,null):new Fs(pa(f),null,c.scale?c.scale.evaluate(o):null,c.font?c.font.evaluate(o).join(","):null,c.textColor?c.textColor.evaluate(o):null)}))}eachChild(o){for(const c of this.sections)o(c.content),c.scale&&o(c.scale),c.font&&o(c.font),c.textColor&&o(c.textColor)}outputDefined(){return!1}serialize(){const o=["format"];for(const c of this.sections){o.push(c.content.serialize());const f={};c.scale&&(f["font-scale"]=c.scale.serialize()),c.font&&(f["text-font"]=c.font.serialize()),c.textColor&&(f["text-color"]=c.textColor.serialize()),o.push(f)}return o}}class Ad{constructor(o){this.type=et,this.input=o}static parse(o,c){if(o.length!==2)return c.error("Expected two arguments.");const f=c.parse(o[1],1,hr);return f?new Ad(f):c.error("No image name provided.")}evaluate(o){const c=this.input.evaluate(o),f=da.fromString(c);return f&&o.availableImages&&(f.available=o.availableImages.indexOf(c)>-1),f}eachChild(o){o(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const wg={"to-boolean":pr,"to-color":Pa,"to-number":An,"to-string":hr};class Md{constructor(o,c){this.type=o,this.args=c}static parse(o,c){if(o.length<2)return c.error("Expected at least one argument.");const f=o[0];if((f==="to-boolean"||f==="to-string")&&o.length!==2)return c.error("Expected one argument.");const m=wg[f],v=[];for(let E=1;E<o.length;E++){const S=c.parse(o[E],E,j);if(!S)return null;v.push(S)}return new Md(m,v)}evaluate(o){if(this.type.kind==="boolean")return!!this.args[0].evaluate(o);if(this.type.kind==="color"){let c,f;for(const m of this.args){if(c=m.evaluate(o),f=null,c instanceof qi)return c;if(typeof c=="string"){const v=o.parseColor(c);if(v)return v}else if(Array.isArray(c)&&(f=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:As(c[0],c[1],c[2],c[3]),!f))return new qi(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new ko(f||`Could not parse color from value '${typeof c=="string"?c:String(JSON.stringify(c))}'`)}if(this.type.kind==="number"){let c=null;for(const f of this.args){if(c=f.evaluate(o),c===null)return 0;const m=Number(c);if(!isNaN(m))return m}throw new ko(`Could not convert ${JSON.stringify(c)} to number.`)}return this.type.kind==="formatted"?Zo.fromString(pa(this.args[0].evaluate(o))):this.type.kind==="resolvedImage"?da.fromString(pa(this.args[0].evaluate(o))):pa(this.args[0].evaluate(o))}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){if(this.type.kind==="formatted")return new rs([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Ad(this.args[0]).serialize();const o=[`to-${this.type.kind}`];return this.eachChild(c=>{o.push(c.serialize())}),o}}var $c=Md;const Tp=["Unknown","Point","LineString","Polygon"];var zf=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Tp[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const u=this.featureDistanceData.center,o=this.featureDistanceData.scale,{x:c,y:f}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(c*o-u[0])+this.featureDistanceData.bearing[1]*(f*o-u[1])}return 0}parseColor(u){let o=this._parseColorCache[u];return o||(o=this._parseColorCache[u]=qi.parse(u)),o}};class eh{constructor(o,c,f,m){this.name=o,this.type=c,this._evaluate=f,this.args=m}evaluate(o){return this._evaluate(o,this.args)}eachChild(o){this.args.forEach(o)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(o=>o.serialize()))}static parse(o,c){const f=o[0],m=eh.definitions[f];if(!m)return c.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(m)?m[0]:m.type,E=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,S=E.filter(([R])=>!Array.isArray(R)||R.length===o.length-1);let M=null;for(const[R,U]of S){M=new Sp(c.registry,c.path,null,c.scope);const H=[];let q=!1;for(let K=1;K<o.length;K++){const $=o[K],ie=Array.isArray(R)?R[K-1]:R.type,me=M.parse($,1+H.length,ie);if(!me){q=!0;break}H.push(me)}if(!q)if(Array.isArray(R)&&R.length!==H.length)M.error(`Expected ${R.length} arguments, but found ${H.length} instead.`);else{for(let K=0;K<H.length;K++){const $=Array.isArray(R)?R[K]:R.type,ie=H[K];M.concat(K+1).checkSubtype($,ie.type)}if(M.errors.length===0)return new eh(f,v,U,H)}}if(S.length===1)c.errors.push(...M.errors);else{const R=(S.length?S:E).map(([H])=>{return q=H,Array.isArray(q)?`(${q.map(st).join(", ")})`:`(${st(q.type)}...)`;var q}).join(" | "),U=[];for(let H=1;H<o.length;H++){const q=c.parse(o[H],1+U.length);if(!q)return null;U.push(st(q.type))}c.error(`Expected arguments of type ${R}, but found (${U.join(", ")}) instead.`)}return null}static register(o,c){eh.definitions=c;for(const f in c)o[f]=eh}}var ql=eh;class Ks{constructor(o,c,f){this.type=ue,this.locale=f,this.caseSensitive=o,this.diacriticSensitive=c}static parse(o,c){if(o.length!==2)return c.error("Expected one argument.");const f=o[1];if(typeof f!="object"||Array.isArray(f))return c.error("Collator options argument must be an object.");const m=c.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,pr);if(!m)return null;const v=c.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,pr);if(!v)return null;let E=null;return f.locale&&(E=c.parse(f.locale,1,hr),!E)?null:new Ks(m,v,E)}evaluate(o){return new oo(this.caseSensitive.evaluate(o),this.diacriticSensitive.evaluate(o),this.locale?this.locale.evaluate(o):null)}eachChild(o){o(this.caseSensitive),o(this.diacriticSensitive),this.locale&&o(this.locale)}outputDefined(){return!1}serialize(){const o={};return o["case-sensitive"]=this.caseSensitive.serialize(),o["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(o.locale=this.locale.serialize()),["collator",o]}}const Wl=8192;function bs(u,o){u[0]=Math.min(u[0],o[0]),u[1]=Math.min(u[1],o[1]),u[2]=Math.max(u[2],o[0]),u[3]=Math.max(u[3],o[1])}function th(u,o){return!(u[0]<=o[0]||u[2]>=o[2]||u[1]<=o[1]||u[3]>=o[3])}function Uf(u,o){const c=(180+u[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,m=Math.pow(2,o.z);return[Math.round(c*m*Wl),Math.round(f*m*Wl)]}function el(u,o,c){const f=u[0]-o[0],m=u[1]-o[1],v=u[0]-c[0],E=u[1]-c[1];return f*E-v*m==0&&f*v<=0&&m*E<=0}function Bh(u,o){let c=!1;for(let E=0,S=o.length;E<S;E++){const M=o[E];for(let R=0,U=M.length;R<U-1;R++){if(el(u,M[R],M[R+1]))return!1;(m=M[R])[1]>(f=u)[1]!=(v=M[R+1])[1]>f[1]&&f[0]<(v[0]-m[0])*(f[1]-m[1])/(v[1]-m[1])+m[0]&&(c=!c)}}var f,m,v;return c}function zh(u,o){for(let c=0;c<o.length;c++)if(Bh(u,o[c]))return!0;return!1}function Vf(u,o,c,f){const m=f[0]-c[0],v=f[1]-c[1],E=(u[0]-c[0])*v-m*(u[1]-c[1]),S=(o[0]-c[0])*v-m*(o[1]-c[1]);return E>0&&S<0||E<0&&S>0}function Gf(u,o,c){for(const R of c)for(let U=0;U<R.length-1;++U)if((S=[(E=R[U+1])[0]-(v=R[U])[0],E[1]-v[1]])[0]*(M=[(m=o)[0]-(f=u)[0],m[1]-f[1]])[1]-S[1]*M[0]!=0&&Vf(f,m,v,E)&&Vf(v,E,f,m))return!0;var f,m,v,E,S,M;return!1}function nh(u,o){for(let c=0;c<u.length;++c)if(!Bh(u[c],o))return!1;for(let c=0;c<u.length-1;++c)if(Gf(u[c],u[c+1],o))return!1;return!0}function Du(u,o){for(let c=0;c<o.length;c++)if(nh(u,o[c]))return!0;return!1}function Yo(u,o,c){const f=[];for(let m=0;m<u.length;m++){const v=[];for(let E=0;E<u[m].length;E++){const S=Uf(u[m][E],c);bs(o,S),v.push(S)}f.push(v)}return f}function Ld(u,o,c){const f=[];for(let m=0;m<u.length;m++){const v=Yo(u[m],o,c);f.push(v)}return f}function Da(u,o,c,f){if(u[0]<c[0]||u[0]>c[2]){const m=.5*f;let v=u[0]-c[0]>m?-f:c[0]-u[0]>m?f:0;v===0&&(v=u[0]-c[2]>m?-f:c[2]-u[0]>m?f:0),u[0]+=v}bs(o,u)}function Ou(u,o,c,f){const m=Math.pow(2,f.z)*Wl,v=[f.x*Wl,f.y*Wl],E=[];if(!u)return E;for(const S of u)for(const M of S){const R=[M.x+v[0],M.y+v[1]];Da(R,o,c,m),E.push(R)}return E}function Er(u,o,c,f){const m=Math.pow(2,f.z)*Wl,v=[f.x*Wl,f.y*Wl],E=[];if(!u)return E;for(const M of u){const R=[];for(const U of M){const H=[U.x+v[0],U.y+v[1]];bs(o,H),R.push(H)}E.push(R)}if(o[2]-o[0]<=m/2){(S=o)[0]=S[1]=1/0,S[2]=S[3]=-1/0;for(const M of E)for(const R of M)Da(R,o,c,m)}var S;return E}class Oa{constructor(o,c){this.type=pr,this.geojson=o,this.geometries=c}static parse(o,c){if(o.length!==2)return c.error(`'within' expression requires exactly one argument, but found ${o.length-1} instead.`);if(Bf(o[1])){const f=o[1];if(f.type==="FeatureCollection")for(let m=0;m<f.features.length;++m){const v=f.features[m].geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new Oa(f,f.features[m].geometry)}else if(f.type==="Feature"){const m=f.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Oa(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new Oa(f,f)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(o){if(o.geometry()!=null&&o.canonicalID()!=null){if(o.geometryType()==="Point")return function(c,f){const m=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],E=c.canonicalID();if(!E)return!1;if(f.type==="Polygon"){const S=Yo(f.coordinates,v,E),M=Ou(c.geometry(),m,v,E);if(!th(m,v))return!1;for(const R of M)if(!Bh(R,S))return!1}if(f.type==="MultiPolygon"){const S=Ld(f.coordinates,v,E),M=Ou(c.geometry(),m,v,E);if(!th(m,v))return!1;for(const R of M)if(!zh(R,S))return!1}return!0}(o,this.geometries);if(o.geometryType()==="LineString")return function(c,f){const m=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],E=c.canonicalID();if(!E)return!1;if(f.type==="Polygon"){const S=Yo(f.coordinates,v,E),M=Er(c.geometry(),m,v,E);if(!th(m,v))return!1;for(const R of M)if(!nh(R,S))return!1}if(f.type==="MultiPolygon"){const S=Ld(f.coordinates,v,E),M=Er(c.geometry(),m,v,E);if(!th(m,v))return!1;for(const R of M)if(!Du(R,S))return!1}return!0}(o,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var mc=Oa;function Nu(u){if(u instanceof ql&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof mc)return!1;let o=!0;return u.eachChild(c=>{o&&!Nu(c)&&(o=!1)}),o}function Zr(u){if(u instanceof ql&&u.name==="feature-state")return!1;let o=!0;return u.eachChild(c=>{o&&!Zr(c)&&(o=!1)}),o}function Xl(u,o){if(u instanceof ql&&o.indexOf(u.name)>=0)return!1;let c=!0;return u.eachChild(f=>{c&&!Xl(f,o)&&(c=!1)}),c}class Uh{constructor(o,c){this.type=c.type,this.name=o,this.boundExpression=c}static parse(o,c){if(o.length!==2||typeof o[1]!="string")return c.error("'var' expression requires exactly one string literal argument.");const f=o[1];return c.scope.has(f)?new Uh(f,c.scope.get(f)):c.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(o){return this.boundExpression.evaluate(o)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var wp=Uh;class Vh{constructor(o,c=[],f,m=new Ip,v=[]){this.registry=o,this.path=c,this.key=c.map(E=>`[${E}]`).join(""),this.scope=m,this.errors=v,this.expectedType=f}parse(o,c,f,m,v={}){return c?this.concat(c,f,m)._parse(o,v):this._parse(o,v)}_parse(o,c){function f(m,v,E){return E==="assert"?new Vr(v,[m]):E==="coerce"?new $c(v,[m]):m}if(o!==null&&typeof o!="string"&&typeof o!="boolean"&&typeof o!="number"||(o=["literal",o]),Array.isArray(o)){if(o.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=o[0];if(typeof m!="string")return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const v=this.registry[m];if(v){let E=v.parse(o,this);if(!E)return null;if(this.expectedType){const S=this.expectedType,M=E.type;if(S.kind!=="string"&&S.kind!=="number"&&S.kind!=="boolean"&&S.kind!=="object"&&S.kind!=="array"||M.kind!=="value")if(S.kind!=="color"&&S.kind!=="formatted"&&S.kind!=="resolvedImage"||M.kind!=="value"&&M.kind!=="string"){if(this.checkSubtype(S,M))return null}else E=f(E,S,c.typeAnnotation||"coerce");else E=f(E,S,c.typeAnnotation||"assert")}if(!(E instanceof kh)&&E.type.kind!=="resolvedImage"&&ku(E)){const S=new zf;try{E=new kh(E.type,E.evaluate(S))}catch(M){return this.error(M.message),null}}return E}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(o===void 0?"'undefined' value invalid. Use null instead.":typeof o=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof o} instead.`)}concat(o,c,f){const m=typeof o=="number"?this.path.concat(o):this.path,v=f?this.scope.concat(f):this.scope;return new Vh(this.registry,m,c||null,v,this.errors)}error(o,...c){const f=`${this.key}${c.map(m=>`[${m}]`).join("")}`;this.errors.push(new jl(f,o))}checkSubtype(o,c){const f=mn(o,c);return f&&this.error(f),f}}var Sp=Vh;function ku(u){if(u instanceof wp)return ku(u.boundExpression);if(u instanceof ql&&u.name==="error"||u instanceof Ks||u instanceof mc)return!1;const o=u instanceof $c||u instanceof Vr;let c=!0;return u.eachChild(f=>{c=o?c&&ku(f):c&&f instanceof kh}),!!c&&Nu(u)&&Xl(u,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Fu(u,o){const c=u.length-1;let f,m,v=0,E=c,S=0;for(;v<=E;)if(S=Math.floor((v+E)/2),f=u[S],m=u[S+1],f<=o){if(S===c||o<m)return S;v=S+1}else{if(!(f>o))throw new ko("Input is not a number.");E=S-1}return 0}class Zl{constructor(o,c,f){this.type=o,this.input=c,this.labels=[],this.outputs=[];for(const[m,v]of f)this.labels.push(m),this.outputs.push(v)}static parse(o,c){if(o.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return c.error("Expected an even number of arguments.");const f=c.parse(o[1],1,An);if(!f)return null;const m=[];let v=null;c.expectedType&&c.expectedType.kind!=="value"&&(v=c.expectedType);for(let E=1;E<o.length;E+=2){const S=E===1?-1/0:o[E],M=o[E+1],R=E,U=E+1;if(typeof S!="number")return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(m.length&&m[m.length-1][0]>=S)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',R);const H=c.parse(M,U,v);if(!H)return null;v=v||H.type,m.push([S,H])}return new Zl(v,f,m)}evaluate(o){const c=this.labels,f=this.outputs;if(c.length===1)return f[0].evaluate(o);const m=this.input.evaluate(o);if(m<=c[0])return f[0].evaluate(o);const v=c.length;return m>=c[v-1]?f[v-1].evaluate(o):f[Fu(c,m)].evaluate(o)}eachChild(o){o(this.input);for(const c of this.outputs)o(c)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){const o=["step",this.input.serialize()];for(let c=0;c<this.labels.length;c++)c>0&&o.push(this.labels[c]),o.push(this.outputs[c].serialize());return o}}var Na=Zl;function Zi(u,o,c){return u*(1-c)+o*c}var gc=Object.freeze({__proto__:null,number:Zi,color:function(u,o,c){return new qi(Zi(u.r,o.r,c),Zi(u.g,o.g,c),Zi(u.b,o.b,c),Zi(u.a,o.a,c))},array:function(u,o,c){return u.map((f,m)=>Zi(f,o[m],c))}});const lu=.95047,Cp=1.08883,_c=4/29,Bu=6/29,Hf=3*Bu*Bu,Ap=Math.PI/180,Mp=180/Math.PI;function Gh(u){return u>.008856451679035631?Math.pow(u,1/3):u/Hf+_c}function Rd(u){return u>Bu?u*u*u:Hf*(u-_c)}function Hh(u){return 255*(u<=.0031308?12.92*u:1.055*Math.pow(u,1/2.4)-.055)}function wo(u){return(u/=255)<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function zu(u){const o=wo(u.r),c=wo(u.g),f=wo(u.b),m=Gh((.4124564*o+.3575761*c+.1804375*f)/lu),v=Gh((.2126729*o+.7151522*c+.072175*f)/1);return{l:116*v-16,a:500*(m-v),b:200*(v-Gh((.0193339*o+.119192*c+.9503041*f)/Cp)),alpha:u.a}}function jh(u){let o=(u.l+16)/116,c=isNaN(u.a)?o:o+u.a/500,f=isNaN(u.b)?o:o-u.b/200;return o=1*Rd(o),c=lu*Rd(c),f=Cp*Rd(f),new qi(Hh(3.2404542*c-1.5371385*o-.4985314*f),Hh(-.969266*c+1.8760108*o+.041556*f),Hh(.0556434*c-.2040259*o+1.0572252*f),u.alpha)}function Uu(u,o,c){const f=o-u;return u+c*(f>180||f<-180?f-360*Math.round(f/360):f)}const qh={forward:zu,reverse:jh,interpolate:function(u,o,c){return{l:Zi(u.l,o.l,c),a:Zi(u.a,o.a,c),b:Zi(u.b,o.b,c),alpha:Zi(u.alpha,o.alpha,c)}}},Yl={forward:function(u){const{l:o,a:c,b:f}=zu(u),m=Math.atan2(f,c)*Mp;return{h:m<0?m+360:m,c:Math.sqrt(c*c+f*f),l:o,alpha:u.a}},reverse:function(u){const o=u.h*Ap,c=u.c;return jh({l:u.l,a:Math.cos(o)*c,b:Math.sin(o)*c,alpha:u.alpha})},interpolate:function(u,o,c){return{h:Uu(u.h,o.h,c),c:Zi(u.c,o.c,c),l:Zi(u.l,o.l,c),alpha:Zi(u.alpha,o.alpha,c)}}};var Lp=Object.freeze({__proto__:null,lab:qh,hcl:Yl});class jf{constructor(o,c,f,m,v){this.type=o,this.operator=c,this.interpolation=f,this.input=m,this.labels=[],this.outputs=[];for(const[E,S]of v)this.labels.push(E),this.outputs.push(S)}static interpolationFactor(o,c,f,m){let v=0;if(o.name==="exponential")v=Wh(c,o.base,f,m);else if(o.name==="linear")v=Wh(c,1,f,m);else if(o.name==="cubic-bezier"){const E=o.controlPoints;v=new Y(E[0],E[1],E[2],E[3]).solve(Wh(c,1,f,m))}return v}static parse(o,c){let[f,m,v,...E]=o;if(!Array.isArray(m)||m.length===0)return c.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const R=m[1];if(typeof R!="number")return c.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:R}}else{if(m[0]!=="cubic-bezier")return c.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const R=m.slice(1);if(R.length!==4||R.some(U=>typeof U!="number"||U<0||U>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:R}}}if(o.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(v=c.parse(v,2,An),!v)return null;const S=[];let M=null;f==="interpolate-hcl"||f==="interpolate-lab"?M=Pa:c.expectedType&&c.expectedType.kind!=="value"&&(M=c.expectedType);for(let R=0;R<E.length;R+=2){const U=E[R],H=E[R+1],q=R+3,K=R+4;if(typeof U!="number")return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',q);if(S.length&&S[S.length-1][0]>=U)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',q);const $=c.parse(H,K,M);if(!$)return null;M=M||$.type,S.push([U,$])}return M.kind==="number"||M.kind==="color"||M.kind==="array"&&M.itemType.kind==="number"&&typeof M.N=="number"?new jf(M,f,m,v,S):c.error(`Type ${st(M)} is not interpolatable.`)}evaluate(o){const c=this.labels,f=this.outputs;if(c.length===1)return f[0].evaluate(o);const m=this.input.evaluate(o);if(m<=c[0])return f[0].evaluate(o);const v=c.length;if(m>=c[v-1])return f[v-1].evaluate(o);const E=Fu(c,m),S=jf.interpolationFactor(this.interpolation,m,c[E],c[E+1]),M=f[E].evaluate(o),R=f[E+1].evaluate(o);return this.operator==="interpolate"?gc[this.type.kind.toLowerCase()](M,R,S):this.operator==="interpolate-hcl"?Yl.reverse(Yl.interpolate(Yl.forward(M),Yl.forward(R),S)):qh.reverse(qh.interpolate(qh.forward(M),qh.forward(R),S))}eachChild(o){o(this.input);for(const c of this.outputs)o(c)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){let o;o=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const c=[this.operator,o,this.input.serialize()];for(let f=0;f<this.labels.length;f++)c.push(this.labels[f],this.outputs[f].serialize());return c}}function Wh(u,o,c,f){const m=f-c,v=u-c;return m===0?0:o===1?v/m:(Math.pow(o,v)-1)/(Math.pow(o,m)-1)}var El=jf;class Vu{constructor(o,c){this.type=o,this.args=c}static parse(o,c){if(o.length<2)return c.error("Expectected at least one argument.");let f=null;const m=c.expectedType;m&&m.kind!=="value"&&(f=m);const v=[];for(const S of o.slice(1)){const M=c.parse(S,1+v.length,f,void 0,{typeAnnotation:"omit"});if(!M)return null;f=f||M.type,v.push(M)}const E=m&&v.some(S=>mn(m,S.type));return new Vu(E?j:f,v)}evaluate(o){let c,f=null,m=0;for(const v of this.args){if(m++,f=v.evaluate(o),f&&f instanceof da&&!f.available&&(c||(c=f),f=null,m===this.args.length))return c;if(f!==null)break}return f}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=["coalesce"];return this.eachChild(c=>{o.push(c.serialize())}),o}}var Rp=Vu;class qf{constructor(o,c){this.type=c.type,this.bindings=[].concat(o),this.result=c}evaluate(o){return this.result.evaluate(o)}eachChild(o){for(const c of this.bindings)o(c[1]);o(this.result)}static parse(o,c){if(o.length<4)return c.error(`Expected at least 3 arguments, but found ${o.length-1} instead.`);const f=[];for(let v=1;v<o.length-1;v+=2){const E=o[v];if(typeof E!="string")return c.error(`Expected string, but found ${typeof E} instead.`,v);if(/[^a-zA-Z0-9_]/.test(E))return c.error("Variable names must contain only alphanumeric characters or '_'.",v);const S=c.parse(o[v+1],v+1);if(!S)return null;f.push([E,S])}const m=c.parse(o[o.length-1],o.length-1,c.expectedType,f);return m?new qf(f,m):null}outputDefined(){return this.result.outputDefined()}serialize(){const o=["let"];for(const[c,f]of this.bindings)o.push(c,f.serialize());return o.push(this.result.serialize()),o}}var Gu=qf;class Xh{constructor(o,c,f){this.type=o,this.index=c,this.input=f}static parse(o,c){if(o.length!==3)return c.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const f=c.parse(o[1],1,An),m=c.parse(o[2],2,Qe(c.expectedType||j));return f&&m?new Xh(m.type.itemType,f,m):null}evaluate(o){const c=this.index.evaluate(o),f=this.input.evaluate(o);if(c<0)throw new ko(`Array index out of bounds: ${c} < 0.`);if(c>=f.length)throw new ko(`Array index out of bounds: ${c} > ${f.length-1}.`);if(c!==Math.floor(c))throw new ko(`Array index must be an integer, but found ${c} instead.`);return f[c]}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var yc=Xh;class ct{constructor(o,c){this.type=pr,this.needle=o,this.haystack=c}static parse(o,c){if(o.length!==3)return c.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const f=c.parse(o[1],1,j),m=c.parse(o[2],2,j);return f&&m?Wn(f.type,[pr,hr,An,pc,j])?new ct(f,m):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${st(f.type)} instead`):null}evaluate(o){const c=this.needle.evaluate(o),f=this.haystack.evaluate(o);if(f==null)return!1;if(!Pn(c,["boolean","string","number","null"]))throw new ko(`Expected first argument to be of type boolean, string, number or null, but found ${st(_o(c))} instead.`);if(!Pn(f,["string","array"]))throw new ko(`Expected second argument to be of type array or string, but found ${st(_o(f))} instead.`);return f.indexOf(c)>=0}eachChild(o){o(this.needle),o(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Ut=ct;class zn{constructor(o,c,f){this.type=An,this.needle=o,this.haystack=c,this.fromIndex=f}static parse(o,c){if(o.length<=2||o.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const f=c.parse(o[1],1,j),m=c.parse(o[2],2,j);if(!f||!m)return null;if(!Wn(f.type,[pr,hr,An,pc,j]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${st(f.type)} instead`);if(o.length===4){const v=c.parse(o[3],3,An);return v?new zn(f,m,v):null}return new zn(f,m)}evaluate(o){const c=this.needle.evaluate(o),f=this.haystack.evaluate(o);if(!Pn(c,["boolean","string","number","null"]))throw new ko(`Expected first argument to be of type boolean, string, number or null, but found ${st(_o(c))} instead.`);if(!Pn(f,["string","array"]))throw new ko(`Expected second argument to be of type array or string, but found ${st(_o(f))} instead.`);if(this.fromIndex){const m=this.fromIndex.evaluate(o);return f.indexOf(c,m)}return f.indexOf(c)}eachChild(o){o(this.needle),o(this.haystack),this.fromIndex&&o(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const o=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),o]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Si=zn;class Yr{constructor(o,c,f,m,v,E){this.inputType=o,this.type=c,this.input=f,this.cases=m,this.outputs=v,this.otherwise=E}static parse(o,c){if(o.length<5)return c.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length%2!=1)return c.error("Expected an even number of arguments.");let f,m;c.expectedType&&c.expectedType.kind!=="value"&&(m=c.expectedType);const v={},E=[];for(let R=2;R<o.length-1;R+=2){let U=o[R];const H=o[R+1];Array.isArray(U)||(U=[U]);const q=c.concat(R);if(U.length===0)return q.error("Expected at least one branch label.");for(const $ of U){if(typeof $!="number"&&typeof $!="string")return q.error("Branch labels must be numbers or strings.");if(typeof $=="number"&&Math.abs($)>Number.MAX_SAFE_INTEGER)return q.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof $=="number"&&Math.floor($)!==$)return q.error("Numeric branch labels must be integer values.");if(f){if(q.checkSubtype(f,_o($)))return null}else f=_o($);if(v[String($)]!==void 0)return q.error("Branch labels must be unique.");v[String($)]=E.length}const K=c.parse(H,R,m);if(!K)return null;m=m||K.type,E.push(K)}const S=c.parse(o[1],1,j);if(!S)return null;const M=c.parse(o[o.length-1],o.length-1,m);return M?S.type.kind!=="value"&&c.concat(1).checkSubtype(f,S.type)?null:new Yr(f,m,S,v,E,M):null}evaluate(o){const c=this.input.evaluate(o);return(_o(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(o)}eachChild(o){o(this.input),this.outputs.forEach(o),o(this.otherwise)}outputDefined(){return this.outputs.every(o=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["match",this.input.serialize()],c=Object.keys(this.cases).sort(),f=[],m={};for(const E of c){const S=m[this.cases[E]];S===void 0?(m[this.cases[E]]=f.length,f.push([this.cases[E],[E]])):f[S][1].push(E)}const v=E=>this.inputType.kind==="number"?Number(E):E;for(const[E,S]of f)o.push(S.length===1?v(S[0]):S.map(v)),o.push(this.outputs[E].serialize());return o.push(this.otherwise.serialize()),o}}var nr=Yr;class Rs{constructor(o,c,f){this.type=o,this.branches=c,this.otherwise=f}static parse(o,c){if(o.length<4)return c.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length%2!=0)return c.error("Expected an odd number of arguments.");let f;c.expectedType&&c.expectedType.kind!=="value"&&(f=c.expectedType);const m=[];for(let E=1;E<o.length-1;E+=2){const S=c.parse(o[E],E,pr);if(!S)return null;const M=c.parse(o[E+1],E+1,f);if(!M)return null;m.push([S,M]),f=f||M.type}const v=c.parse(o[o.length-1],o.length-1,f);return v?new Rs(f,m,v):null}evaluate(o){for(const[c,f]of this.branches)if(c.evaluate(o))return f.evaluate(o);return this.otherwise.evaluate(o)}eachChild(o){for(const[c,f]of this.branches)o(c),o(f);o(this.otherwise)}outputDefined(){return this.branches.every(([o,c])=>c.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["case"];return this.eachChild(c=>{o.push(c.serialize())}),o}}var yo=Rs;class Ko{constructor(o,c,f,m){this.type=o,this.input=c,this.beginIndex=f,this.endIndex=m}static parse(o,c){if(o.length<=2||o.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const f=c.parse(o[1],1,j),m=c.parse(o[2],2,An);if(!f||!m)return null;if(!Wn(f.type,[Qe(j),hr,j]))return c.error(`Expected first argument to be of type array or string, but found ${st(f.type)} instead`);if(o.length===4){const v=c.parse(o[3],3,An);return v?new Ko(f.type,f,m,v):null}return new Ko(f.type,f,m)}evaluate(o){const c=this.input.evaluate(o),f=this.beginIndex.evaluate(o);if(!Pn(c,["string","array"]))throw new ko(`Expected first argument to be of type array or string, but found ${st(_o(c))} instead.`);if(this.endIndex){const m=this.endIndex.evaluate(o);return c.slice(f,m)}return c.slice(f)}eachChild(o){o(this.input),o(this.beginIndex),this.endIndex&&o(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const o=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),o]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var vo=Ko;function ao(u,o){return u==="=="||u==="!="?o.kind==="boolean"||o.kind==="string"||o.kind==="number"||o.kind==="null"||o.kind==="value":o.kind==="string"||o.kind==="number"||o.kind==="value"}function Kl(u,o,c,f){return f.compare(o,c)===0}function So(u,o,c){const f=u!=="=="&&u!=="!=";return class hL{constructor(v,E,S){this.type=pr,this.lhs=v,this.rhs=E,this.collator=S,this.hasUntypedArgument=v.type.kind==="value"||E.type.kind==="value"}static parse(v,E){if(v.length!==3&&v.length!==4)return E.error("Expected two or three arguments.");const S=v[0];let M=E.parse(v[1],1,j);if(!M)return null;if(!ao(S,M.type))return E.concat(1).error(`"${S}" comparisons are not supported for type '${st(M.type)}'.`);let R=E.parse(v[2],2,j);if(!R)return null;if(!ao(S,R.type))return E.concat(2).error(`"${S}" comparisons are not supported for type '${st(R.type)}'.`);if(M.type.kind!==R.type.kind&&M.type.kind!=="value"&&R.type.kind!=="value")return E.error(`Cannot compare types '${st(M.type)}' and '${st(R.type)}'.`);f&&(M.type.kind==="value"&&R.type.kind!=="value"?M=new Vr(R.type,[M]):M.type.kind!=="value"&&R.type.kind==="value"&&(R=new Vr(M.type,[R])));let U=null;if(v.length===4){if(M.type.kind!=="string"&&R.type.kind!=="string"&&M.type.kind!=="value"&&R.type.kind!=="value")return E.error("Cannot use collator to compare non-string types.");if(U=E.parse(v[3],3,ue),!U)return null}return new hL(M,R,U)}evaluate(v){const E=this.lhs.evaluate(v),S=this.rhs.evaluate(v);if(f&&this.hasUntypedArgument){const M=_o(E),R=_o(S);if(M.kind!==R.kind||M.kind!=="string"&&M.kind!=="number")throw new ko(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${M.kind}, ${R.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const M=_o(E),R=_o(S);if(M.kind!=="string"||R.kind!=="string")return o(v,E,S)}return this.collator?c(v,E,S,this.collator.evaluate(v)):o(v,E,S)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}serialize(){const v=[u];return this.eachChild(E=>{v.push(E.serialize())}),v}}}const lt=So("==",function(u,o,c){return o===c},Kl),Ht=So("!=",function(u,o,c){return o!==c},function(u,o,c,f){return!Kl(0,o,c,f)}),Nt=So("<",function(u,o,c){return o<c},function(u,o,c,f){return f.compare(o,c)<0}),oi=So(">",function(u,o,c){return o>c},function(u,o,c,f){return f.compare(o,c)>0}),Ui=So("<=",function(u,o,c){return o<=c},function(u,o,c,f){return f.compare(o,c)<=0}),Or=So(">=",function(u,o,c){return o>=c},function(u,o,c,f){return f.compare(o,c)>=0});class Js{constructor(o,c,f,m,v,E){this.type=hr,this.number=o,this.locale=c,this.currency=f,this.unit=m,this.minFractionDigits=v,this.maxFractionDigits=E}static parse(o,c){if(o.length!==3)return c.error("Expected two arguments.");const f=c.parse(o[1],1,An);if(!f)return null;const m=o[2];if(typeof m!="object"||Array.isArray(m))return c.error("NumberFormat options argument must be an object.");let v=null;if(m.locale&&(v=c.parse(m.locale,1,hr),!v))return null;let E=null;if(m.currency&&(E=c.parse(m.currency,1,hr),!E))return null;let S=null;if(m.unit&&(S=c.parse(m.unit,1,hr),!S))return null;let M=null;if(m["min-fraction-digits"]&&(M=c.parse(m["min-fraction-digits"],1,An),!M))return null;let R=null;return m["max-fraction-digits"]&&(R=c.parse(m["max-fraction-digits"],1,An),!R)?null:new Js(f,v,E,S,M,R)}evaluate(o){return new Intl.NumberFormat(this.locale?this.locale.evaluate(o):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(o):void 0,unit:this.unit?this.unit.evaluate(o):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(o):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(o):void 0}).format(this.number.evaluate(o))}eachChild(o){o(this.number),this.locale&&o(this.locale),this.currency&&o(this.currency),this.unit&&o(this.unit),this.minFractionDigits&&o(this.minFractionDigits),this.maxFractionDigits&&o(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const o={};return this.locale&&(o.locale=this.locale.serialize()),this.currency&&(o.currency=this.currency.serialize()),this.unit&&(o.unit=this.unit.serialize()),this.minFractionDigits&&(o["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(o["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),o]}}class us{constructor(o){this.type=An,this.input=o}static parse(o,c){if(o.length!==2)return c.error(`Expected 1 argument, but found ${o.length-1} instead.`);const f=c.parse(o[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?c.error(`Expected argument of type string or array, but found ${st(f.type)} instead.`):new us(f):null}evaluate(o){const c=this.input.evaluate(o);if(typeof c=="string"||Array.isArray(c))return c.length;throw new ko(`Expected value to be of type string or array, but found ${st(_o(c))} instead.`)}eachChild(o){o(this.input)}outputDefined(){return!1}serialize(){const o=["length"];return this.eachChild(c=>{o.push(c.serialize())}),o}}const Pd={"==":lt,"!=":Ht,">":oi,"<":Nt,">=":Or,"<=":Ui,array:Vr,at:yc,boolean:Vr,case:yo,coalesce:Rp,collator:Ks,format:rs,image:Ad,in:Ut,"index-of":Si,interpolate:El,"interpolate-hcl":El,"interpolate-lab":El,length:us,let:Gu,literal:kh,match:nr,number:Vr,"number-format":Js,object:Vr,slice:vo,step:Na,string:Vr,"to-boolean":$c,"to-color":$c,"to-number":$c,"to-string":$c,var:wp,within:mc};function ms(u,[o,c,f,m]){o=o.evaluate(u),c=c.evaluate(u),f=f.evaluate(u);const v=m?m.evaluate(u):1,E=As(o,c,f,v);if(E)throw new ko(E);return new qi(o/255*v,c/255*v,f/255*v,v)}function gr(u,o){return u in o}function Hu(u,o){const c=o[u];return c===void 0?null:c}function ma(u){return{type:u}}ql.register(Pd,{error:[{kind:"error"},[hr],(u,[o])=>{throw new ko(o.evaluate(u))}],typeof:[hr,[j],(u,[o])=>st(_o(o.evaluate(u)))],"to-rgba":[Qe(An,4),[Pa],(u,[o])=>o.evaluate(u).toArray()],rgb:[Pa,[An,An,An],ms],rgba:[Pa,[An,An,An,An],ms],has:{type:pr,overloads:[[[hr],(u,[o])=>gr(o.evaluate(u),u.properties())],[[hr,O],(u,[o,c])=>gr(o.evaluate(u),c.evaluate(u))]]},get:{type:j,overloads:[[[hr],(u,[o])=>Hu(o.evaluate(u),u.properties())],[[hr,O],(u,[o,c])=>Hu(o.evaluate(u),c.evaluate(u))]]},"feature-state":[j,[hr],(u,[o])=>Hu(o.evaluate(u),u.featureState||{})],properties:[O,[],u=>u.properties()],"geometry-type":[hr,[],u=>u.geometryType()],id:[j,[],u=>u.id()],zoom:[An,[],u=>u.globals.zoom],pitch:[An,[],u=>u.globals.pitch||0],"distance-from-center":[An,[],u=>u.distanceFromCenter()],"heatmap-density":[An,[],u=>u.globals.heatmapDensity||0],"line-progress":[An,[],u=>u.globals.lineProgress||0],"sky-radial-progress":[An,[],u=>u.globals.skyRadialProgress||0],accumulated:[j,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[An,ma(An),(u,o)=>{let c=0;for(const f of o)c+=f.evaluate(u);return c}],"*":[An,ma(An),(u,o)=>{let c=1;for(const f of o)c*=f.evaluate(u);return c}],"-":{type:An,overloads:[[[An,An],(u,[o,c])=>o.evaluate(u)-c.evaluate(u)],[[An],(u,[o])=>-o.evaluate(u)]]},"/":[An,[An,An],(u,[o,c])=>o.evaluate(u)/c.evaluate(u)],"%":[An,[An,An],(u,[o,c])=>o.evaluate(u)%c.evaluate(u)],ln2:[An,[],()=>Math.LN2],pi:[An,[],()=>Math.PI],e:[An,[],()=>Math.E],"^":[An,[An,An],(u,[o,c])=>Math.pow(o.evaluate(u),c.evaluate(u))],sqrt:[An,[An],(u,[o])=>Math.sqrt(o.evaluate(u))],log10:[An,[An],(u,[o])=>Math.log(o.evaluate(u))/Math.LN10],ln:[An,[An],(u,[o])=>Math.log(o.evaluate(u))],log2:[An,[An],(u,[o])=>Math.log(o.evaluate(u))/Math.LN2],sin:[An,[An],(u,[o])=>Math.sin(o.evaluate(u))],cos:[An,[An],(u,[o])=>Math.cos(o.evaluate(u))],tan:[An,[An],(u,[o])=>Math.tan(o.evaluate(u))],asin:[An,[An],(u,[o])=>Math.asin(o.evaluate(u))],acos:[An,[An],(u,[o])=>Math.acos(o.evaluate(u))],atan:[An,[An],(u,[o])=>Math.atan(o.evaluate(u))],min:[An,ma(An),(u,o)=>Math.min(...o.map(c=>c.evaluate(u)))],max:[An,ma(An),(u,o)=>Math.max(...o.map(c=>c.evaluate(u)))],abs:[An,[An],(u,[o])=>Math.abs(o.evaluate(u))],round:[An,[An],(u,[o])=>{const c=o.evaluate(u);return c<0?-Math.round(-c):Math.round(c)}],floor:[An,[An],(u,[o])=>Math.floor(o.evaluate(u))],ceil:[An,[An],(u,[o])=>Math.ceil(o.evaluate(u))],"filter-==":[pr,[hr,j],(u,[o,c])=>u.properties()[o.value]===c.value],"filter-id-==":[pr,[j],(u,[o])=>u.id()===o.value],"filter-type-==":[pr,[hr],(u,[o])=>u.geometryType()===o.value],"filter-<":[pr,[hr,j],(u,[o,c])=>{const f=u.properties()[o.value],m=c.value;return typeof f==typeof m&&f<m}],"filter-id-<":[pr,[j],(u,[o])=>{const c=u.id(),f=o.value;return typeof c==typeof f&&c<f}],"filter->":[pr,[hr,j],(u,[o,c])=>{const f=u.properties()[o.value],m=c.value;return typeof f==typeof m&&f>m}],"filter-id->":[pr,[j],(u,[o])=>{const c=u.id(),f=o.value;return typeof c==typeof f&&c>f}],"filter-<=":[pr,[hr,j],(u,[o,c])=>{const f=u.properties()[o.value],m=c.value;return typeof f==typeof m&&f<=m}],"filter-id-<=":[pr,[j],(u,[o])=>{const c=u.id(),f=o.value;return typeof c==typeof f&&c<=f}],"filter->=":[pr,[hr,j],(u,[o,c])=>{const f=u.properties()[o.value],m=c.value;return typeof f==typeof m&&f>=m}],"filter-id->=":[pr,[j],(u,[o])=>{const c=u.id(),f=o.value;return typeof c==typeof f&&c>=f}],"filter-has":[pr,[j],(u,[o])=>o.value in u.properties()],"filter-has-id":[pr,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[pr,[Qe(hr)],(u,[o])=>o.value.indexOf(u.geometryType())>=0],"filter-id-in":[pr,[Qe(j)],(u,[o])=>o.value.indexOf(u.id())>=0],"filter-in-small":[pr,[hr,Qe(j)],(u,[o,c])=>c.value.indexOf(u.properties()[o.value])>=0],"filter-in-large":[pr,[hr,Qe(j)],(u,[o,c])=>function(f,m,v,E){for(;v<=E;){const S=v+E>>1;if(m[S]===f)return!0;m[S]>f?E=S-1:v=S+1}return!1}(u.properties()[o.value],c.value,0,c.value.length-1)],all:{type:pr,overloads:[[[pr,pr],(u,[o,c])=>o.evaluate(u)&&c.evaluate(u)],[ma(pr),(u,o)=>{for(const c of o)if(!c.evaluate(u))return!1;return!0}]]},any:{type:pr,overloads:[[[pr,pr],(u,[o,c])=>o.evaluate(u)||c.evaluate(u)],[ma(pr),(u,o)=>{for(const c of o)if(c.evaluate(u))return!0;return!1}]]},"!":[pr,[pr],(u,[o])=>!o.evaluate(u)],"is-supported-script":[pr,[hr],(u,[o])=>{const c=u.globals&&u.globals.isSupportedScript;return!c||c(o.evaluate(u))}],upcase:[hr,[hr],(u,[o])=>o.evaluate(u).toUpperCase()],downcase:[hr,[hr],(u,[o])=>o.evaluate(u).toLowerCase()],concat:[hr,ma(j),(u,o)=>o.map(c=>pa(c.evaluate(u))).join("")],"resolved-locale":[hr,[ue],(u,[o])=>o.evaluate(u).resolvedLocale()]});var tl=Pd;function Co(u){return{result:"success",value:u}}function Jo(u){return{result:"error",value:u}}function _r(u){return u["property-type"]==="data-driven"}function nl(u){return!!u.expression&&u.expression.parameters.indexOf("zoom")>-1}function vc(u){return!!u.expression&&u.expression.interpolated}function $i(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}function uu(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function Em(u){return u}function Zh(u,o){const c=o.type==="color",f=u.stops&&typeof u.stops[0][0]=="object",m=f||!(f||u.property!==void 0),v=u.type||(vc(o)?"exponential":"interval");if(c&&((u=Hl({},u)).stops&&(u.stops=u.stops.map(R=>[R[0],qi.parse(R[1])])),u.default=qi.parse(u.default?u.default:o.default)),u.colorSpace&&u.colorSpace!=="rgb"&&!Lp[u.colorSpace])throw new Error(`Unknown color space: ${u.colorSpace}`);let E,S,M;if(v==="exponential")E=Yh;else if(v==="interval")E=bc;else if(v==="categorical"){E=il,S=Object.create(null);for(const R of u.stops)S[R[0]]=R[1];M=typeof u.stops[0][0]}else{if(v!=="identity")throw new Error(`Unknown function type "${v}"`);E=xc}if(f){const R={},U=[];for(let K=0;K<u.stops.length;K++){const $=u.stops[K],ie=$[0].zoom;R[ie]===void 0&&(R[ie]={zoom:ie,type:u.type,property:u.property,default:u.default,stops:[]},U.push(ie)),R[ie].stops.push([$[0].value,$[1]])}const H=[];for(const K of U)H.push([R[K].zoom,Zh(R[K],o)]);const q={name:"linear"};return{kind:"composite",interpolationType:q,interpolationFactor:El.interpolationFactor.bind(void 0,q),zoomStops:H.map(K=>K[0]),evaluate:({zoom:K},$)=>Yh({stops:H,base:u.base},o,K).evaluate(K,$)}}if(m){const R=v==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:R,interpolationFactor:El.interpolationFactor.bind(void 0,R),zoomStops:u.stops.map(U=>U[0]),evaluate:({zoom:U})=>E(u,o,U,S,M)}}return{kind:"source",evaluate(R,U){const H=U&&U.properties?U.properties[u.property]:void 0;return H===void 0?cu(u.default,o.default):E(u,o,H,S,M)}}}function cu(u,o,c){return u!==void 0?u:o!==void 0?o:c!==void 0?c:void 0}function il(u,o,c,f,m){return cu(typeof c===m?f[c]:void 0,u.default,o.default)}function bc(u,o,c){if($i(c)!=="number")return cu(u.default,o.default);const f=u.stops.length;if(f===1||c<=u.stops[0][0])return u.stops[0][1];if(c>=u.stops[f-1][0])return u.stops[f-1][1];const m=Fu(u.stops.map(v=>v[0]),c);return u.stops[m][1]}function Yh(u,o,c){const f=u.base!==void 0?u.base:1;if($i(c)!=="number")return cu(u.default,o.default);const m=u.stops.length;if(m===1||c<=u.stops[0][0])return u.stops[0][1];if(c>=u.stops[m-1][0])return u.stops[m-1][1];const v=Fu(u.stops.map(U=>U[0]),c),E=function(U,H,q,K){const $=K-q,ie=U-q;return $===0?0:H===1?ie/$:(Math.pow(H,ie)-1)/(Math.pow(H,$)-1)}(c,f,u.stops[v][0],u.stops[v+1][0]),S=u.stops[v][1],M=u.stops[v+1][1];let R=gc[o.type]||Em;if(u.colorSpace&&u.colorSpace!=="rgb"){const U=Lp[u.colorSpace];R=(H,q)=>U.reverse(U.interpolate(U.forward(H),U.forward(q),E))}return typeof S.evaluate=="function"?{evaluate(...U){const H=S.evaluate.apply(void 0,U),q=M.evaluate.apply(void 0,U);if(H!==void 0&&q!==void 0)return R(H,q,E)}}:R(S,M,E)}function xc(u,o,c){return o.type==="color"?c=qi.parse(c):o.type==="formatted"?c=Zo.fromString(c.toString()):o.type==="resolvedImage"?c=da.fromString(c.toString()):$i(c)===o.type||o.type==="enum"&&o.values[c]||(c=void 0),cu(c,u.default,o.default)}class Ec{constructor(o,c){this.expression=o,this._warningHistory={},this._evaluator=new zf,this._defaultValue=c?function(f){return f.type==="color"&&(uu(f.default)||Array.isArray(f.default))?new qi(0,0,0,0):f.type==="color"?qi.parse(f.default)||null:f.default===void 0?null:f.default}(c):null,this._enumValues=c&&c.type==="enum"?c.values:null}evaluateWithoutErrorHandling(o,c,f,m,v,E,S,M){return this._evaluator.globals=o,this._evaluator.feature=c,this._evaluator.featureState=f,this._evaluator.canonical=m||null,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=E,this._evaluator.featureTileCoord=S||null,this._evaluator.featureDistanceData=M||null,this.expression.evaluate(this._evaluator)}evaluate(o,c,f,m,v,E,S,M){this._evaluator.globals=o,this._evaluator.feature=c||null,this._evaluator.featureState=f||null,this._evaluator.canonical=m||null,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=E||null,this._evaluator.featureTileCoord=S||null,this._evaluator.featureDistanceData=M||null;try{const R=this.expression.evaluate(this._evaluator);if(R==null||typeof R=="number"&&R!=R)return this._defaultValue;if(this._enumValues&&!(R in this._enumValues))throw new ko(`Expected value to be one of ${Object.keys(this._enumValues).map(U=>JSON.stringify(U)).join(", ")}, but found ${JSON.stringify(R)} instead.`);return R}catch(R){return this._warningHistory[R.message]||(this._warningHistory[R.message]=!0,typeof console<"u"&&console.warn(R.message)),this._defaultValue}}}function Wf(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in tl}function ih(u,o){const c=new Sp(tl,[],o?function(m){const v={color:Pa,string:hr,number:An,enum:hr,boolean:pr,formatted:Fe,resolvedImage:et};return m.type==="array"?Qe(v[m.value]||j,m.length):v[m.type]}(o):void 0),f=c.parse(u,void 0,void 0,void 0,o&&o.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?Co(new Ec(f,o)):Jo(c.errors)}class Pp{constructor(o,c){this.kind=o,this._styleExpression=c,this.isStateDependent=o!=="constant"&&!Zr(c.expression)}evaluateWithoutErrorHandling(o,c,f,m,v,E){return this._styleExpression.evaluateWithoutErrorHandling(o,c,f,m,v,E)}evaluate(o,c,f,m,v,E){return this._styleExpression.evaluate(o,c,f,m,v,E)}}class ju{constructor(o,c,f,m){this.kind=o,this.zoomStops=f,this._styleExpression=c,this.isStateDependent=o!=="camera"&&!Zr(c.expression),this.interpolationType=m}evaluateWithoutErrorHandling(o,c,f,m,v,E){return this._styleExpression.evaluateWithoutErrorHandling(o,c,f,m,v,E)}evaluate(o,c,f,m,v,E){return this._styleExpression.evaluate(o,c,f,m,v,E)}interpolationFactor(o,c,f){return this.interpolationType?El.interpolationFactor(this.interpolationType,o,c,f):0}}function Jl(u,o){if((u=ih(u,o)).result==="error")return u;const c=u.value.expression,f=Nu(c);if(!f&&!_r(o))return Jo([new jl("","data expressions not supported")]);const m=Xl(c,["zoom","pitch","distance-from-center"]);if(!m&&!nl(o))return Jo([new jl("","zoom expressions not supported")]);const v=Dp(c);return v||m?v instanceof jl?Jo([v]):v instanceof El&&!vc(o)?Jo([new jl("",'"interpolate" expressions cannot be used with this property')]):Co(v?new ju(f?"camera":"composite",u.value,v.labels,v instanceof El?v.interpolation:void 0):new Pp(f?"constant":"source",u.value)):Jo([new jl("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Kh{constructor(o,c){this._parameters=o,this._specification=c,Hl(this,Zh(this._parameters,this._specification))}static deserialize(o){return new Kh(o._parameters,o._specification)}static serialize(o){return{_parameters:o._parameters,_specification:o._specification}}}function Dp(u){let o=null;if(u instanceof Gu)o=Dp(u.result);else if(u instanceof Rp){for(const c of u.args)if(o=Dp(c),o)break}else(u instanceof Na||u instanceof El)&&u.input instanceof ql&&u.input.name==="zoom"&&(o=u);return o instanceof jl||u.eachChild(c=>{const f=Dp(c);f instanceof jl?o=f:!o&&f?o=new jl("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):o&&f&&o!==f&&(o=new jl("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),o}class Vn{constructor(o,c,f,m){this.message=(o?`${o}: `:"")+f,m&&(this.identifier=m),c!=null&&c.__line__&&(this.line=c.__line__)}}function hu(u){const o=u.key,c=u.value,f=u.valueSpec||{},m=u.objectElementValidators||{},v=u.style,E=u.styleSpec;let S=[];const M=$i(c);if(M!=="object")return[new Vn(o,c,`object expected, ${M} found`)];for(const R in c){const U=R.split(".")[0],H=f[U]||f["*"];let q;m[U]?q=m[U]:f[U]?q=Yi:m["*"]?q=m["*"]:f["*"]&&(q=Yi),q?S=S.concat(q({key:(o&&`${o}.`)+R,value:c[R],valueSpec:H,style:v,styleSpec:E,object:c,objectKey:R},c)):S.push(new Vn(o,c[R],`unknown property "${R}"`))}for(const R in f)m[R]||f[R].required&&f[R].default===void 0&&c[R]===void 0&&S.push(new Vn(o,c,`missing required property "${R}"`));return S}function Op(u){const o=u.value,c=u.valueSpec,f=u.style,m=u.styleSpec,v=u.key,E=u.arrayElementValidator||Yi;if($i(o)!=="array")return[new Vn(v,o,`array expected, ${$i(o)} found`)];if(c.length&&o.length!==c.length)return[new Vn(v,o,`array length ${c.length} expected, length ${o.length} found`)];if(c["min-length"]&&o.length<c["min-length"])return[new Vn(v,o,`array length at least ${c["min-length"]} expected, length ${o.length} found`)];let S={type:c.value,values:c.values,minimum:c.minimum,maximum:c.maximum,function:void 0};m.$version<7&&(S.function=c.function),$i(c.value)==="object"&&(S=c.value);let M=[];for(let R=0;R<o.length;R++)M=M.concat(E({array:o,arrayIndex:R,value:o[R],valueSpec:S,style:f,styleSpec:m,key:`${v}[${R}]`}));return M}function Dd(u){const o=u.key,c=u.value,f=u.valueSpec;let m=$i(c);if(m==="number"&&c!=c&&(m="NaN"),m!=="number")return[new Vn(o,c,`number expected, ${m} found`)];if("minimum"in f){let v=f.minimum;if($i(f.minimum)==="array"&&(v=f.minimum[u.arrayIndex]),c<v)return[new Vn(o,c,`${c} is less than the minimum value ${v}`)]}if("maximum"in f){let v=f.maximum;if($i(f.maximum)==="array"&&(v=f.maximum[u.arrayIndex]),c>v)return[new Vn(o,c,`${c} is greater than the maximum value ${v}`)]}return[]}function Xf(u){const o=u.valueSpec,c=Ys(u.value.type);let f,m,v,E={};const S=c!=="categorical"&&u.value.property===void 0,M=!S,R=$i(u.value.stops)==="array"&&$i(u.value.stops[0])==="array"&&$i(u.value.stops[0][0])==="object",U=hu({key:u.key,value:u.value,valueSpec:u.styleSpec.function,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{stops:function(K){if(c==="identity")return[new Vn(K.key,K.value,'identity function may not have a "stops" property')];let $=[];const ie=K.value;return $=$.concat(Op({key:K.key,value:ie,valueSpec:K.valueSpec,style:K.style,styleSpec:K.styleSpec,arrayElementValidator:H})),$i(ie)==="array"&&ie.length===0&&$.push(new Vn(K.key,ie,"array must have at least one stop")),$},default:function(K){return Yi({key:K.key,value:K.value,valueSpec:o,style:K.style,styleSpec:K.styleSpec})}}});return c==="identity"&&S&&U.push(new Vn(u.key,u.value,'missing required property "property"')),c==="identity"||u.value.stops||U.push(new Vn(u.key,u.value,'missing required property "stops"')),c==="exponential"&&u.valueSpec.expression&&!vc(u.valueSpec)&&U.push(new Vn(u.key,u.value,"exponential functions not supported")),u.styleSpec.$version>=8&&(M&&!_r(u.valueSpec)?U.push(new Vn(u.key,u.value,"property functions not supported")):S&&!nl(u.valueSpec)&&U.push(new Vn(u.key,u.value,"zoom functions not supported"))),c!=="categorical"&&!R||u.value.property!==void 0||U.push(new Vn(u.key,u.value,'"property" property is required')),U;function H(K){let $=[];const ie=K.value,me=K.key;if($i(ie)!=="array")return[new Vn(me,ie,`array expected, ${$i(ie)} found`)];if(ie.length!==2)return[new Vn(me,ie,`array length 2 expected, length ${ie.length} found`)];if(R){if($i(ie[0])!=="object")return[new Vn(me,ie,`object expected, ${$i(ie[0])} found`)];if(ie[0].zoom===void 0)return[new Vn(me,ie,"object stop key must have zoom")];if(ie[0].value===void 0)return[new Vn(me,ie,"object stop key must have value")];const Me=Ys(ie[0].zoom);if(typeof Me!="number")return[new Vn(me,ie[0].zoom,"stop zoom values must be numbers")];if(v&&v>Me)return[new Vn(me,ie[0].zoom,"stop zoom values must appear in ascending order")];Me!==v&&(v=Me,m=void 0,E={}),$=$.concat(hu({key:`${me}[0]`,value:ie[0],valueSpec:{zoom:{}},style:K.style,styleSpec:K.styleSpec,objectElementValidators:{zoom:Dd,value:q}}))}else $=$.concat(q({key:`${me}[0]`,value:ie[0],valueSpec:{},style:K.style,styleSpec:K.styleSpec},ie));return Wf(dc(ie[1]))?$.concat([new Vn(`${me}[1]`,ie[1],"expressions are not allowed in function stops.")]):$.concat(Yi({key:`${me}[1]`,value:ie[1],valueSpec:o,style:K.style,styleSpec:K.styleSpec}))}function q(K,$){const ie=$i(K.value),me=Ys(K.value),Me=K.value!==null?K.value:$;if(f){if(ie!==f)return[new Vn(K.key,Me,`${ie} stop domain type must match previous stop domain type ${f}`)]}else f=ie;if(ie!=="number"&&ie!=="string"&&ie!=="boolean"&&typeof me!="number"&&typeof me!="string"&&typeof me!="boolean")return[new Vn(K.key,Me,"stop domain value must be a number, string, or boolean")];if(ie!=="number"&&c!=="categorical"){let Ve=`number expected, ${ie} found`;return _r(o)&&c===void 0&&(Ve+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Vn(K.key,Me,Ve)]}return c!=="categorical"||ie!=="number"||typeof me=="number"&&isFinite(me)&&Math.floor(me)===me?c!=="categorical"&&ie==="number"&&typeof me=="number"&&typeof m=="number"&&m!==void 0&&me<m?[new Vn(K.key,Me,"stop domain values must appear in ascending order")]:(m=me,c==="categorical"&&me in E?[new Vn(K.key,Me,"stop domain values must be unique")]:(E[me]=!0,[])):[new Vn(K.key,Me,`integer expected, found ${String(me)}`)]}}function Od(u){const o=(u.expressionContext==="property"?Jl:ih)(dc(u.value),u.valueSpec);if(o.result==="error")return o.value.map(f=>new Vn(`${u.key}${f.key}`,u.value,f.message));const c=o.value.expression||o.value._styleExpression.expression;if(u.expressionContext==="property"&&u.propertyKey==="text-font"&&!c.outputDefined())return[new Vn(u.key,u.value,`Invalid data expression for "${u.propertyKey}". Output values must be contained as literals within the expression.`)];if(u.expressionContext==="property"&&u.propertyType==="layout"&&!Zr(c))return[new Vn(u.key,u.value,'"feature-state" data expressions are not supported with layout properties.')];if(u.expressionContext==="filter")return Sg(c,u);if(u.expressionContext&&u.expressionContext.indexOf("cluster")===0){if(!Xl(c,["zoom","feature-state"]))return[new Vn(u.key,u.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(u.expressionContext==="cluster-initial"&&!Nu(c))return[new Vn(u.key,u.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Sg(u,o){const c=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(o.valueSpec&&o.valueSpec.expression)for(const m of o.valueSpec.expression.parameters)c.delete(m);if(c.size===0)return[];const f=[];return u instanceof ql&&c.has(u.name)?[new Vn(o.key,o.value,`["${u.name}"] expression is not supported in a filter for a ${o.object.type} layer with id: ${o.object.id}`)]:(u.eachChild(m=>{f.push(...Sg(m,o))}),f)}function Im(u){const o=u.key,c=u.value,f=u.valueSpec,m=[];return Array.isArray(f.values)?f.values.indexOf(Ys(c))===-1&&m.push(new Vn(o,c,`expected one of [${f.values.join(", ")}], ${JSON.stringify(c)} found`)):Object.keys(f.values).indexOf(Ys(c))===-1&&m.push(new Vn(o,c,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(c)} found`)),m}function Cg(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const o of u.slice(1))if(!Cg(o)&&typeof o!="boolean")return!1;return!0;default:return!0}}function bo(u,o="fill"){if(u==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Cg(u)||(u=Jh(u));const c=u;let f=!0;try{f=function(R){if(!aa(R))return R;let U=dc(R);return Np(U),U=Fo(U),U}(c)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(c,null,2)}
        `)}const m=Rt[`filter_${o}`],v=ih(f,m);let E=null;if(v.result==="error")throw new Error(v.value.map(R=>`${R.key}: ${R.message}`).join(", "));E=(R,U,H)=>v.value.evaluate(R,U,{},H);let S=null,M=null;if(f!==c){const R=ih(c,m);if(R.result==="error")throw new Error(R.value.map(U=>`${U.key}: ${U.message}`).join(", "));S=(U,H,q,K,$)=>R.value.evaluate(U,H,{},q,void 0,void 0,K,$),M=!Nu(R.value.expression)}return{filter:E,dynamicFilter:S||void 0,needGeometry:Tm(f),needFeature:!!M}}function Fo(u){if(!Array.isArray(u))return u;const o=function(c){if(kp.has(c[0])){for(let f=1;f<c.length;f++)if(aa(c[f]))return!0}return c}(u);return o===!0?o:o.map(c=>Fo(c))}function Np(u){let o=!1;const c=[];if(u[0]==="case"){for(let f=1;f<u.length-1;f+=2)o=o||aa(u[f]),c.push(u[f+1]);c.push(u[u.length-1])}else if(u[0]==="match"){o=o||aa(u[1]);for(let f=2;f<u.length-1;f+=2)c.push(u[f+1]);c.push(u[u.length-1])}else if(u[0]==="step"){o=o||aa(u[1]);for(let f=1;f<u.length-1;f+=2)c.push(u[f+1])}o&&(u.length=0,u.push("any",...c));for(let f=1;f<u.length;f++)Np(u[f])}function aa(u){if(!Array.isArray(u))return!1;if((o=u[0])==="pitch"||o==="distance-from-center")return!0;var o;for(let c=1;c<u.length;c++)if(aa(u[c]))return!0;return!1}const kp=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function f0(u,o){return u<o?-1:u>o?1:0}function Tm(u){if(!Array.isArray(u))return!1;if(u[0]==="within")return!0;for(let o=1;o<u.length;o++)if(Tm(u[o]))return!0;return!1}function Jh(u){if(!u)return!0;const o=u[0];return u.length<=1?o!=="any":o==="=="?Fp(u[1],u[2],"=="):o==="!="?Ic(Fp(u[1],u[2],"==")):o==="<"||o===">"||o==="<="||o===">="?Fp(u[1],u[2],o):o==="any"?(c=u.slice(1),["any"].concat(c.map(Jh))):o==="all"?["all"].concat(u.slice(1).map(Jh)):o==="none"?["all"].concat(u.slice(1).map(Jh).map(Ic)):o==="in"?rh(u[1],u.slice(2)):o==="!in"?Ic(rh(u[1],u.slice(2))):o==="has"?Nd(u[1]):o==="!has"?Ic(Nd(u[1])):o!=="within"||u;var c}function Fp(u,o,c){switch(u){case"$type":return[`filter-type-${c}`,o];case"$id":return[`filter-id-${c}`,o];default:return[`filter-${c}`,u,o]}}function rh(u,o){if(o.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(c=>typeof c!=typeof o[0])?["filter-in-large",u,["literal",o.sort(f0)]]:["filter-in-small",u,["literal",o]]}}function Nd(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function Ic(u){return["!",u]}function kd(u){return Cg(dc(u.value))?Od(Hl({},u,{expressionContext:"filter",valueSpec:u.styleSpec[`filter_${u.layerType||"fill"}`]})):Zf(u)}function Zf(u){const o=u.value,c=u.key;if($i(o)!=="array")return[new Vn(c,o,`array expected, ${$i(o)} found`)];const f=u.styleSpec;let m,v=[];if(o.length<1)return[new Vn(c,o,"filter array must have at least 1 element")];switch(v=v.concat(Im({key:`${c}[0]`,value:o[0],valueSpec:f.filter_operator,style:u.style,styleSpec:u.styleSpec})),Ys(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&Ys(o[1])==="$type"&&v.push(new Vn(c,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":o.length!==3&&v.push(new Vn(c,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(m=$i(o[1]),m!=="string"&&v.push(new Vn(`${c}[1]`,o[1],`string expected, ${m} found`)));for(let E=2;E<o.length;E++)m=$i(o[E]),Ys(o[1])==="$type"?v=v.concat(Im({key:`${c}[${E}]`,value:o[E],valueSpec:f.geometry_type,style:u.style,styleSpec:u.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&v.push(new Vn(`${c}[${E}]`,o[E],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let E=1;E<o.length;E++)v=v.concat(Zf({key:`${c}[${E}]`,value:o[E],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":m=$i(o[1]),o.length!==2?v.push(new Vn(c,o,`filter array for "${o[0]}" operator must have 2 elements`)):m!=="string"&&v.push(new Vn(`${c}[1]`,o[1],`string expected, ${m} found`));break;case"within":m=$i(o[1]),o.length!==2?v.push(new Vn(c,o,`filter array for "${o[0]}" operator must have 2 elements`)):m!=="object"&&v.push(new Vn(`${c}[1]`,o[1],`object expected, ${m} found`))}return v}function wm(u,o){const c=u.key,f=u.style,m=u.styleSpec,v=u.value,E=u.objectKey,S=m[`${o}_${u.layerType}`];if(!S)return[];const M=E.match(/^(.*)-transition$/);if(o==="paint"&&M&&S[M[1]]&&S[M[1]].transition)return Yi({key:c,value:v,valueSpec:m.transition,style:f,styleSpec:m});const R=u.valueSpec||S[E];if(!R)return[new Vn(c,v,`unknown property "${E}"`)];let U;if($i(v)==="string"&&_r(R)&&!R.tokens&&(U=/^{([^}]+)}$/.exec(v)))return[new Vn(c,v,`"${E}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(U[1])} }\`.`)];const H=[];return u.layerType==="symbol"&&(E==="text-field"&&f&&!f.glyphs&&H.push(new Vn(c,v,'use of "text-field" requires a style "glyphs" property')),E==="text-font"&&uu(dc(v))&&Ys(v.type)==="identity"&&H.push(new Vn(c,v,'"text-font" does not support identity functions'))),H.concat(Yi({key:u.key,value:v,valueSpec:R,style:f,styleSpec:m,expressionContext:"property",propertyType:o,propertyKey:E}))}function Q_(u){return wm(u,"paint")}function Ag(u){return wm(u,"layout")}function Mg(u){let o=[];const c=u.value,f=u.key,m=u.style,v=u.styleSpec;c.type||c.ref||o.push(new Vn(f,c,'either "type" or "ref" is required'));let E=Ys(c.type);const S=Ys(c.ref);if(c.id){const M=Ys(c.id);for(let R=0;R<u.arrayIndex;R++){const U=m.layers[R];Ys(U.id)===M&&o.push(new Vn(f,c.id,`duplicate layer id "${c.id}", previously used at line ${U.id.__line__}`))}}if("ref"in c){let M;["type","source","source-layer","filter","layout"].forEach(R=>{R in c&&o.push(new Vn(f,c[R],`"${R}" is prohibited for ref layers`))}),m.layers.forEach(R=>{Ys(R.id)===S&&(M=R)}),M?M.ref?o.push(new Vn(f,c.ref,"ref cannot reference another ref layer")):E=Ys(M.type):typeof S=="string"&&o.push(new Vn(f,c.ref,`ref layer "${S}" not found`))}else if(E!=="background"&&E!=="sky")if(c.source){const M=m.sources&&m.sources[c.source],R=M&&Ys(M.type);M?R==="vector"&&E==="raster"?o.push(new Vn(f,c.source,`layer "${c.id}" requires a raster source`)):R==="raster"&&E!=="raster"?o.push(new Vn(f,c.source,`layer "${c.id}" requires a vector source`)):R!=="vector"||c["source-layer"]?R==="raster-dem"&&E!=="hillshade"?o.push(new Vn(f,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):E!=="line"||!c.paint||!c.paint["line-gradient"]&&!c.paint["line-trim-offset"]||R==="geojson"&&M.lineMetrics||o.push(new Vn(f,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):o.push(new Vn(f,c,`layer "${c.id}" must specify a "source-layer"`)):o.push(new Vn(f,c.source,`source "${c.source}" not found`))}else o.push(new Vn(f,c,'missing required property "source"'));return o=o.concat(hu({key:f,value:c,valueSpec:v.layer,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Yi({key:`${f}.type`,value:c.type,valueSpec:v.layer.type,style:u.style,styleSpec:u.styleSpec,object:c,objectKey:"type"}),filter:M=>kd(Hl({layerType:E},M)),layout:M=>hu({layer:c,key:M.key,value:M.value,valueSpec:{},style:M.style,styleSpec:M.styleSpec,objectElementValidators:{"*":R=>Ag(Hl({layerType:E},R))}}),paint:M=>hu({layer:c,key:M.key,value:M.value,valueSpec:{},style:M.style,styleSpec:M.styleSpec,objectElementValidators:{"*":R=>Q_(Hl({layerType:E},R))}})}})),o}function Fd(u){const o=u.value,c=u.key,f=$i(o);return f!=="string"?[new Vn(c,o,`string expected, ${f} found`)]:[]}const Yf={promoteId:function({key:u,value:o}){if($i(o)==="string")return Fd({key:u,value:o});{const c=[];for(const f in o)c.push(...Fd({key:`${u}.${f}`,value:o[f]}));return c}}};function sh(u){const o=u.value,c=u.key,f=u.styleSpec,m=u.style;if(!o.type)return[new Vn(c,o,'"type" is required')];const v=Ys(o.type);let E;switch(v){case"vector":case"raster":case"raster-dem":return E=hu({key:c,value:o,valueSpec:f[`source_${v.replace("-","_")}`],style:u.style,styleSpec:f,objectElementValidators:Yf}),E;case"geojson":if(E=hu({key:c,value:o,valueSpec:f.source_geojson,style:m,styleSpec:f,objectElementValidators:Yf}),o.cluster)for(const S in o.clusterProperties){const[M,R]=o.clusterProperties[S],U=typeof M=="string"?[M,["accumulated"],["get",S]]:M;E.push(...Od({key:`${c}.${S}.map`,value:R,expressionContext:"cluster-map"})),E.push(...Od({key:`${c}.${S}.reduce`,value:U,expressionContext:"cluster-reduce"}))}return E;case"video":return hu({key:c,value:o,valueSpec:f.source_video,style:m,styleSpec:f});case"image":return hu({key:c,value:o,valueSpec:f.source_image,style:m,styleSpec:f});case"canvas":return[new Vn(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Im({key:`${c}.type`,value:o.type,valueSpec:{values:Lg(f)},style:m,styleSpec:f})}}function Lg(u){return u.source.reduce((o,c)=>{const f=u[c];return f.type.type==="enum"&&(o=o.concat(Object.keys(f.type.values))),o},[])}function ge(u){const o=u.value,c=u.styleSpec,f=c.light,m=u.style;let v=[];const E=$i(o);if(o===void 0)return v;if(E!=="object")return v=v.concat([new Vn("light",o,`object expected, ${E} found`)]),v;for(const S in o){const M=S.match(/^(.*)-transition$/);v=v.concat(M&&f[M[1]]&&f[M[1]].transition?Yi({key:S,value:o[S],valueSpec:c.transition,style:m,styleSpec:c}):f[S]?Yi({key:S,value:o[S],valueSpec:f[S],style:m,styleSpec:c}):[new Vn(S,o[S],`unknown property "${S}"`)])}return v}function Qh(u){const o=u.value,c=u.key,f=u.style,m=u.styleSpec,v=m.terrain;let E=[];const S=$i(o);if(o===void 0)return E;if(S!=="object")return E=E.concat([new Vn("terrain",o,`object expected, ${S} found`)]),E;for(const M in o){const R=M.match(/^(.*)-transition$/);E=E.concat(R&&v[R[1]]&&v[R[1]].transition?Yi({key:M,value:o[M],valueSpec:m.transition,style:f,styleSpec:m}):v[M]?Yi({key:M,value:o[M],valueSpec:v[M],style:f,styleSpec:m}):[new Vn(M,o[M],`unknown property "${M}"`)])}if(o.source){const M=f.sources&&f.sources[o.source],R=M&&Ys(M.type);M?R!=="raster-dem"&&E.push(new Vn(c,o.source,`terrain cannot be used with a source of type ${String(R)}, it only be used with a "raster-dem" source type`)):E.push(new Vn(c,o.source,`source "${o.source}" not found`))}else E.push(new Vn(c,o,'terrain is missing required property "source"'));return E}function Bp(u){const o=u.value,c=u.style,f=u.styleSpec,m=f.fog;let v=[];const E=$i(o);if(o===void 0)return v;if(E!=="object")return v=v.concat([new Vn("fog",o,`object expected, ${E} found`)]),v;for(const S in o){const M=S.match(/^(.*)-transition$/);v=v.concat(M&&m[M[1]]&&m[M[1]].transition?Yi({key:S,value:o[S],valueSpec:f.transition,style:c,styleSpec:f}):m[S]?Yi({key:S,value:o[S],valueSpec:m[S],style:c,styleSpec:f}):[new Vn(S,o[S],`unknown property "${S}"`)])}return v}const rl={"*":()=>[],array:Op,boolean:function(u){const o=u.value,c=u.key,f=$i(o);return f!=="boolean"?[new Vn(c,o,`boolean expected, ${f} found`)]:[]},number:Dd,color:function(u){const o=u.key,c=u.value,f=$i(c);return f!=="string"?[new Vn(o,c,`color expected, ${f} found`)]:Fn(c)===null?[new Vn(o,c,`color expected, "${c}" found`)]:[]},enum:Im,filter:kd,function:Xf,layer:Mg,object:hu,source:sh,light:ge,terrain:Qh,fog:Bp,string:Fd,formatted:function(u){return Fd(u).length===0?[]:Od(u)},resolvedImage:function(u){return Fd(u).length===0?[]:Od(u)},projection:function(u){const o=u.value,c=u.styleSpec,f=c.projection,m=u.style;let v=[];const E=$i(o);if(E==="object")for(const S in o)v=v.concat(Yi({key:S,value:o[S],valueSpec:f[S],style:m,styleSpec:c}));else E!=="string"&&(v=v.concat([new Vn("projection",o,`object or string expected, ${E} found`)]));return v}};function Yi(u){const o=u.value,c=u.valueSpec,f=u.styleSpec;return c.expression&&uu(Ys(o))?Xf(u):c.expression&&Wf(dc(o))?Od(u):c.type&&rl[c.type]?rl[c.type](u):hu(Hl({},u,{valueSpec:c.type?f[c.type]:c}))}function d0(u){const o=u.value,c=u.key,f=Fd(u);return f.length||(o.indexOf("{fontstack}")===-1&&f.push(new Vn(c,o,'"glyphs" url must include a "{fontstack}" token')),o.indexOf("{range}")===-1&&f.push(new Vn(c,o,'"glyphs" url must include a "{range}" token'))),f}function $_(u,o=Rt){return oh(Yi({key:"",value:u,valueSpec:o.$root,styleSpec:o,style:u,objectElementValidators:{glyphs:d0,"*":()=>[]}}))}const p0=u=>oh(Q_(u)),$h=u=>oh(Ag(u));function oh(u){return u.slice().sort((o,c)=>o.line&&c.line?o.line-c.line:0)}function ey(u,o){let c=!1;if(o&&o.length)for(const f of o)u.fire(new Gl(new Error(f.message))),c=!0;return c}var Bd=Tc;function Tc(u,o,c){var f=this.cells=[];if(u instanceof ArrayBuffer){this.arrayBuffer=u;var m=new Int32Array(this.arrayBuffer);u=m[0],this.d=(o=m[1])+2*(c=m[2]);for(var v=0;v<this.d*this.d;v++){var E=m[3+v],S=m[3+v+1];f.push(E===S?null:m.subarray(E,S))}var M=m[3+f.length+1];this.keys=m.subarray(m[3+f.length],M),this.bboxes=m.subarray(M),this.insert=this._insertReadonly}else{this.d=o+2*c;for(var R=0;R<this.d*this.d;R++)f.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=u,this.padding=c,this.scale=o/u,this.uid=0;var U=c/o*u;this.min=-U,this.max=u+U}Tc.prototype.insert=function(u,o,c,f,m){this._forEachCell(o,c,f,m,this._insertCell,this.uid++),this.keys.push(u),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(m)},Tc.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Tc.prototype._insertCell=function(u,o,c,f,m,v){this.cells[m].push(v)},Tc.prototype.query=function(u,o,c,f,m){var v=this.min,E=this.max;if(u<=v&&o<=v&&E<=c&&E<=f&&!m)return Array.prototype.slice.call(this.keys);var S=[];return this._forEachCell(u,o,c,f,this._queryCell,S,{},m),S},Tc.prototype._queryCell=function(u,o,c,f,m,v,E,S){var M=this.cells[m];if(M!==null)for(var R=this.keys,U=this.bboxes,H=0;H<M.length;H++){var q=M[H];if(E[q]===void 0){var K=4*q;(S?S(U[K+0],U[K+1],U[K+2],U[K+3]):u<=U[K+2]&&o<=U[K+3]&&c>=U[K+0]&&f>=U[K+1])?(E[q]=!0,v.push(R[q])):E[q]=!1}}},Tc.prototype._forEachCell=function(u,o,c,f,m,v,E,S){for(var M=this._convertToCellCoord(u),R=this._convertToCellCoord(o),U=this._convertToCellCoord(c),H=this._convertToCellCoord(f),q=M;q<=U;q++)for(var K=R;K<=H;K++){var $=this.d*K+q;if((!S||S(this._convertFromCellCoord(q),this._convertFromCellCoord(K),this._convertFromCellCoord(q+1),this._convertFromCellCoord(K+1)))&&m.call(this,u,o,c,f,$,v,E,S))return}},Tc.prototype._convertFromCellCoord=function(u){return(u-this.padding)/this.scale},Tc.prototype._convertToCellCoord=function(u){return Math.max(0,Math.min(this.d-1,Math.floor(u*this.scale)+this.padding))},Tc.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var u=this.cells,o=3+this.cells.length+1+1,c=0,f=0;f<this.cells.length;f++)c+=this.cells[f].length;var m=new Int32Array(o+c+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;for(var v=o,E=0;E<u.length;E++){var S=u[E];m[3+E]=v,m.set(S,v),v+=S.length}return m[3+u.length]=v,m.set(this.keys,v),m[3+u.length+1]=v+=this.keys.length,m.set(this.bboxes,v),v+=this.bboxes.length,m.buffer};const Sm={};function Gn(u,o,c={}){Object.defineProperty(u,"_classRegistryKey",{value:o,writeable:!1}),Sm[o]={klass:u,omit:c.omit||[]}}Gn(Object,"Object"),Bd.serialize=function(u,o){const c=u.toArrayBuffer();return o&&o.push(c),{buffer:c}},Bd.deserialize=function(u){return new Bd(u.buffer)},Object.defineProperty(Bd,"name",{value:"Grid"}),Gn(Bd,"Grid"),Gn(qi,"Color"),Gn(Error,"Error"),Gn(Rn,"AJAXError"),Gn(da,"ResolvedImage"),Gn(Kh,"StylePropertyFunction"),Gn(Ec,"StyleExpression",{omit:["_evaluator"]}),Gn(ju,"ZoomDependentExpression"),Gn(Pp,"ZoomConstantExpression"),Gn(ql,"CompoundExpression",{omit:["_evaluate"]});for(const u in tl)Sm[tl[u]._classRegistryKey]||Gn(tl[u],`Expression${u}`);function ty(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function zp(u){return d.ImageBitmap&&u instanceof d.ImageBitmap}function Up(u,o){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp)return u;if(ty(u)||zp(u))return o&&o.push(u),u;if(ArrayBuffer.isView(u)){const c=u;return o&&o.push(c.buffer),c}if(u instanceof d.ImageData)return o&&o.push(u.data.buffer),u;if(Array.isArray(u)){const c=[];for(const f of u)c.push(Up(f,o));return c}if(typeof u=="object"){const c=u.constructor,f=c._classRegistryKey;if(!f)throw new Error(`can't serialize object of unregistered class ${f}`);const m=c.serialize?c.serialize(u,o):{};if(!c.serialize){for(const v in u)u.hasOwnProperty(v)&&(Sm[f].omit.indexOf(v)>=0||(m[v]=Up(u[v],o)));u instanceof Error&&(m.message=u.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return f!=="Object"&&(m.$name=f),m}throw new Error("can't serialize object of type "+typeof u)}function Vp(u){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||ty(u)||zp(u)||ArrayBuffer.isView(u)||u instanceof d.ImageData)return u;if(Array.isArray(u))return u.map(Vp);if(typeof u=="object"){const o=u.$name||"Object",{klass:c}=Sm[o];if(!c)throw new Error(`can't deserialize unregistered class ${o}`);if(c.deserialize)return c.deserialize(u);const f=Object.create(c.prototype);for(const m of Object.keys(u))m!=="$name"&&(f[m]=Vp(u[m]));return f}throw new Error("can't deserialize object of type "+typeof u)}const Gp=u=>u>=1536&&u<=1791,wc=u=>u>=1872&&u<=1919,Rg=u=>u>=2208&&u<=2303,ny=u=>u>=11904&&u<=12031,Pg=u=>u>=12032&&u<=12255,Dg=u=>u>=12272&&u<=12287,Hp=u=>u>=12288&&u<=12351,Sc=u=>u>=12352&&u<=12447,zd=u=>u>=12448&&u<=12543,Cm=u=>u>=12544&&u<=12591,fu=u=>u>=12704&&u<=12735,iy=u=>u>=12736&&u<=12783,Og=u=>u>=12784&&u<=12799,ry=u=>u>=12800&&u<=13055,sy=u=>u>=13056&&u<=13311,oy=u=>u>=13312&&u<=19903,Am=u=>u>=19968&&u<=40959,Ng=u=>u>=40960&&u<=42127,ay=u=>u>=42128&&u<=42191,ly=u=>u>=44032&&u<=55215,Mm=u=>u>=63744&&u<=64255,ef=u=>u>=64336&&u<=65023,tf=u=>u>=65040&&u<=65055,y=u=>u>=65072&&u<=65103,h=u=>u>=65104&&u<=65135,p=u=>u>=65136&&u<=65279,b=u=>u>=65280&&u<=65519;function w(u){for(const o of u)if(k(o.charCodeAt(0)))return!0;return!1}function C(u){for(const o of u)if(!P(o.charCodeAt(0)))return!1;return!0}function P(u){return!(Gp(u)||wc(u)||Rg(u)||ef(u)||p(u))}function k(u){return!(u!==746&&u!==747&&(u<4352||!(fu(u)||Cm(u)||y(u)&&!(u>=65097&&u<=65103)||Mm(u)||sy(u)||ny(u)||iy(u)||!(!Hp(u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||oy(u)||Am(u)||ry(u)||(o=>o>=12592&&o<=12687)(u)||(o=>o>=43360&&o<=43391)(u)||(o=>o>=55216&&o<=55295)(u)||(o=>o>=4352&&o<=4607)(u)||ly(u)||Sc(u)||Dg(u)||(o=>o>=12688&&o<=12703)(u)||Pg(u)||Og(u)||zd(u)&&u!==12540||!(!b(u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!h(u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||(o=>o>=5120&&o<=5759)(u)||(o=>o>=6320&&o<=6399)(u)||tf(u)||(o=>o>=19904&&o<=19967)(u)||Ng(u)||ay(u))))}function G(u){return!(k(u)||function(o){return!!((c=>c>=128&&c<=255)(o)&&(o===167||o===169||o===174||o===177||o===188||o===189||o===190||o===215||o===247)||(c=>c>=8192&&c<=8303)(o)&&(o===8214||o===8224||o===8225||o===8240||o===8241||o===8251||o===8252||o===8258||o===8263||o===8264||o===8265||o===8273)||(c=>c>=8448&&c<=8527)(o)||(c=>c>=8528&&c<=8591)(o)||(c=>c>=8960&&c<=9215)(o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||o===9003||o>=9085&&o<=9114||o>=9150&&o<=9165||o===9167||o>=9169&&o<=9179||o>=9186&&o<=9215)||(c=>c>=9216&&c<=9279)(o)&&o!==9251||(c=>c>=9280&&c<=9311)(o)||(c=>c>=9312&&c<=9471)(o)||(c=>c>=9632&&c<=9727)(o)||(c=>c>=9728&&c<=9983)(o)&&!(o>=9754&&o<=9759)||(c=>c>=11008&&c<=11263)(o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||Hp(o)||zd(o)||(c=>c>=57344&&c<=63743)(o)||y(o)||h(o)||b(o)||o===8734||o===8756||o===8757||o>=9984&&o<=10087||o>=10102&&o<=10131||o===65532||o===65533)}(u))}function W(u){return u>=1424&&u<=2303||ef(u)||p(u)}function X(u,o){return!(!o&&W(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||(c=>c>=6016&&c<=6143)(u))}function ne(u){for(const o of u)if(W(o.charCodeAt(0)))return!0;return!1}const ce="deferred",ye="loading",_e="loaded";let ve=null,xe="unavailable",se=null;const Le=function(u){u&&typeof u=="string"&&u.indexOf("NetworkError")>-1&&(xe="error"),ve&&ve(u)};function Ae(){Re.fire(new yr("pluginStateChange",{pluginStatus:xe,pluginURL:se}))}const Re=new fa,Xe=function(){return xe},je=function(){if(xe!==ce||!se)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");xe=ye,Ae(),se&&js({url:se},u=>{u?Le(u):(xe=_e,Ae())})},Ke={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>xe===_e||Ke.applyArabicShaping!=null,isLoading:()=>xe===ye,setState(u){xe=u.pluginStatus,se=u.pluginURL},isParsed:()=>Ke.applyArabicShaping!=null&&Ke.processBidirectionalText!=null&&Ke.processStyledBidirectionalText!=null,getPluginURL:()=>se};class ft{constructor(o,c){this.zoom=o,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.transition=c.transition,this.pitch=c.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(o){return function(c,f){for(const m of c)if(!X(m.charCodeAt(0),f))return!1;return!0}(o,Ke.isLoaded())}}class dt{constructor(o,c){this.property=o,this.value=c,this.expression=function(f,m){if(uu(f))return new Kh(f,m);if(Wf(f)){const v=Jl(f,m);if(v.result==="error")throw new Error(v.value.map(E=>`${E.key}: ${E.message}`).join(", "));return v.value}{let v=f;return typeof f=="string"&&m.type==="color"&&(v=qi.parse(f)),{kind:"constant",evaluate:()=>v}}}(c===void 0?o.specification.default:c,o.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(o,c,f){return this.property.possiblyEvaluate(this,o,c,f)}}class xt{constructor(o){this.property=o,this.value=new dt(o,void 0)}transitioned(o,c){return new gt(this.property,this.value,c,Dt({},o.transition,this.transition),o.now)}untransitioned(){return new gt(this.property,this.value,null,{},0)}}class Tn{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues)}getValue(o){return Ct(this._values[o].value.value)}setValue(o,c){this._values.hasOwnProperty(o)||(this._values[o]=new xt(this._values[o].property)),this._values[o].value=new dt(this._values[o].property,c===null?void 0:Ct(c))}getTransition(o){return Ct(this._values[o].transition)}setTransition(o,c){this._values.hasOwnProperty(o)||(this._values[o]=new xt(this._values[o].property)),this._values[o].transition=Ct(c)||void 0}serialize(){const o={};for(const c of Object.keys(this._values)){const f=this.getValue(c);f!==void 0&&(o[c]=f);const m=this.getTransition(c);m!==void 0&&(o[`${c}-transition`]=m)}return o}transitioned(o,c){const f=new Zt(this._properties);for(const m of Object.keys(this._values))f._values[m]=this._values[m].transitioned(o,c._values[m]);return f}untransitioned(){const o=new Zt(this._properties);for(const c of Object.keys(this._values))o._values[c]=this._values[c].untransitioned();return o}}class gt{constructor(o,c,f,m,v){const E=m.delay||0,S=m.duration||0;v=v||0,this.property=o,this.value=c,this.begin=v+E,this.end=this.begin+S,o.specification.transition&&(m.delay||m.duration)&&(this.prior=f)}possiblyEvaluate(o,c,f){const m=o.now||0,v=this.value.possiblyEvaluate(o,c,f),E=this.prior;if(E){if(m>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(m<this.begin)return E.possiblyEvaluate(o,c,f);{const S=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(E.possiblyEvaluate(o,c,f),v,Be(S))}}return v}}class Zt{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)}possiblyEvaluate(o,c,f){const m=new yt(this._properties);for(const v of Object.keys(this._values))m._values[v]=this._values[v].possiblyEvaluate(o,c,f);return m}hasTransition(){for(const o of Object.keys(this._values))if(this._values[o].prior)return!0;return!1}}class St{constructor(o){this._properties=o,this._values=Object.create(o.defaultPropertyValues)}getValue(o){return Ct(this._values[o].value)}setValue(o,c){this._values[o]=new dt(this._values[o].property,c===null?void 0:Ct(c))}serialize(){const o={};for(const c of Object.keys(this._values)){const f=this.getValue(c);f!==void 0&&(o[c]=f)}return o}possiblyEvaluate(o,c,f){const m=new yt(this._properties);for(const v of Object.keys(this._values))m._values[v]=this._values[v].possiblyEvaluate(o,c,f);return m}}class un{constructor(o,c,f){this.property=o,this.value=c,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(o){return this.value.kind==="constant"?this.value.value:o}evaluate(o,c,f,m){return this.property.evaluate(this.value,this.parameters,o,c,f,m)}}class yt{constructor(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)}get(o){return this._values[o]}}class ht{constructor(o){this.specification=o}possiblyEvaluate(o,c){return o.expression.evaluate(c)}interpolate(o,c,f){const m=gc[this.specification.type];return m?m(o,c,f):o}}class Tt{constructor(o,c){this.specification=o,this.overrides=c}possiblyEvaluate(o,c,f,m){return new un(this,o.expression.kind==="constant"||o.expression.kind==="camera"?{kind:"constant",value:o.expression.evaluate(c,null,{},f,m)}:o.expression,c)}interpolate(o,c,f){if(o.value.kind!=="constant"||c.value.kind!=="constant")return o;if(o.value.value===void 0||c.value.value===void 0)return new un(this,{kind:"constant",value:void 0},o.parameters);const m=gc[this.specification.type];return m?new un(this,{kind:"constant",value:m(o.value.value,c.value.value,f)},o.parameters):o}evaluate(o,c,f,m,v,E){return o.kind==="constant"?o.value:o.evaluate(c,f,m,v,E)}}class en{constructor(o){this.specification=o}possiblyEvaluate(o,c,f,m){return!!o.expression.evaluate(c,null,{},f,m)}interpolate(){return!1}}class ln{constructor(o){this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const c=new ft(0,{});for(const f in o){const m=o[f];m.specification.overridable&&this.overridableProperties.push(f);const v=this.defaultPropertyValues[f]=new dt(m,void 0),E=this.defaultTransitionablePropertyValues[f]=new xt(m);this.defaultTransitioningPropertyValues[f]=E.untransitioned(),this.defaultPossiblyEvaluatedValues[f]=v.possiblyEvaluate(c)}}}function ci(u,o){return 256*(u=it(Math.floor(u),0,255))+it(Math.floor(o),0,255)}Gn(Tt,"DataDrivenProperty"),Gn(ht,"DataConstantProperty"),Gn(en,"ColorRampProperty");const ur={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class $n{constructor(o,c){this._structArray=o,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Hn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(o,c){return o._trim(),c&&(o.isTransferred=!0,c.push(o.arrayBuffer)),{length:o.length,arrayBuffer:o.arrayBuffer}}static deserialize(o){const c=Object.create(this.prototype);return c.arrayBuffer=o.arrayBuffer,c.length=o.length,c.capacity=o.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(o){this.reserve(o),this.length=o}reserve(o){if(o>this.capacity){this.capacity=Math.max(o,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function di(u,o=1){let c=0,f=0;return{members:u.map(m=>{const v=ur[m.type].BYTES_PER_ELEMENT,E=c=vr(c,Math.max(o,v)),S=m.components||1;return f=Math.max(f,v),c+=v*S,{name:m.name,type:m.type,components:S,offset:E}}),size:vr(c,Math.max(f,o)),alignment:o}}function vr(u,o){return Math.ceil(u/o)*o}class bi extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c){const f=this.length;return this.resize(f+1),this.emplace(f,o,c)}emplace(o,c,f){const m=2*o;return this.int16[m+0]=c,this.int16[m+1]=f,o}}bi.prototype.bytesPerElement=4,Gn(bi,"StructArrayLayout2i4");class Wr extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,f){const m=this.length;return this.resize(m+1),this.emplace(m,o,c,f)}emplace(o,c,f,m){const v=3*o;return this.int16[v+0]=c,this.int16[v+1]=f,this.int16[v+2]=m,o}}Wr.prototype.bytesPerElement=6,Gn(Wr,"StructArrayLayout3i6");class $r extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,f,m){const v=this.length;return this.resize(v+1),this.emplace(v,o,c,f,m)}emplace(o,c,f,m,v){const E=4*o;return this.int16[E+0]=c,this.int16[E+1]=f,this.int16[E+2]=m,this.int16[E+3]=v,o}}$r.prototype.bytesPerElement=8,Gn($r,"StructArrayLayout4i8");class xs extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f,m,v,E,S){const M=this.length;return this.resize(M+1),this.emplace(M,o,c,f,m,v,E,S)}emplace(o,c,f,m,v,E,S,M){const R=6*o,U=12*o,H=3*o;return this.int16[R+0]=c,this.int16[R+1]=f,this.uint8[U+4]=m,this.uint8[U+5]=v,this.uint8[U+6]=E,this.uint8[U+7]=S,this.float32[H+2]=M,o}}xs.prototype.bytesPerElement=12,Gn(xs,"StructArrayLayout2i4ub1f12");class ss extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f,m){const v=this.length;return this.resize(v+1),this.emplace(v,o,c,f,m)}emplace(o,c,f,m,v){const E=4*o;return this.float32[E+0]=c,this.float32[E+1]=f,this.float32[E+2]=m,this.float32[E+3]=v,o}}ss.prototype.bytesPerElement=16,Gn(ss,"StructArrayLayout4f16");class xo extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f,m,v){const E=this.length;return this.resize(E+1),this.emplace(E,o,c,f,m,v)}emplace(o,c,f,m,v,E){const S=6*o,M=3*o;return this.uint16[S+0]=c,this.uint16[S+1]=f,this.uint16[S+2]=m,this.uint16[S+3]=v,this.float32[M+2]=E,o}}xo.prototype.bytesPerElement=12,Gn(xo,"StructArrayLayout4ui1f12");class sl extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,f,m){const v=this.length;return this.resize(v+1),this.emplace(v,o,c,f,m)}emplace(o,c,f,m,v){const E=4*o;return this.uint16[E+0]=c,this.uint16[E+1]=f,this.uint16[E+2]=m,this.uint16[E+3]=v,o}}sl.prototype.bytesPerElement=8,Gn(sl,"StructArrayLayout4ui8");class du extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,f,m,v,E){const S=this.length;return this.resize(S+1),this.emplace(S,o,c,f,m,v,E)}emplace(o,c,f,m,v,E,S){const M=6*o;return this.int16[M+0]=c,this.int16[M+1]=f,this.int16[M+2]=m,this.int16[M+3]=v,this.int16[M+4]=E,this.int16[M+5]=S,o}}du.prototype.bytesPerElement=12,Gn(du,"StructArrayLayout6i12");class pu extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,f,m,v,E,S,M,R,U,H,q){const K=this.length;return this.resize(K+1),this.emplace(K,o,c,f,m,v,E,S,M,R,U,H,q)}emplace(o,c,f,m,v,E,S,M,R,U,H,q,K){const $=12*o;return this.int16[$+0]=c,this.int16[$+1]=f,this.int16[$+2]=m,this.int16[$+3]=v,this.uint16[$+4]=E,this.uint16[$+5]=S,this.uint16[$+6]=M,this.uint16[$+7]=R,this.int16[$+8]=U,this.int16[$+9]=H,this.int16[$+10]=q,this.int16[$+11]=K,o}}pu.prototype.bytesPerElement=24,Gn(pu,"StructArrayLayout4i4ui4i24");class Ps extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f,m,v,E){const S=this.length;return this.resize(S+1),this.emplace(S,o,c,f,m,v,E)}emplace(o,c,f,m,v,E,S){const M=10*o,R=5*o;return this.int16[M+0]=c,this.int16[M+1]=f,this.int16[M+2]=m,this.float32[R+2]=v,this.float32[R+3]=E,this.float32[R+4]=S,o}}Ps.prototype.bytesPerElement=20,Gn(Ps,"StructArrayLayout3i3f20");class cs extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.uint32[1*o+0]=c,o}}cs.prototype.bytesPerElement=4,Gn(cs,"StructArrayLayout1ul4");class Nr extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,f,m,v,E,S,M,R,U,H,q,K){const $=this.length;return this.resize($+1),this.emplace($,o,c,f,m,v,E,S,M,R,U,H,q,K)}emplace(o,c,f,m,v,E,S,M,R,U,H,q,K,$){const ie=20*o,me=10*o;return this.int16[ie+0]=c,this.int16[ie+1]=f,this.int16[ie+2]=m,this.int16[ie+3]=v,this.int16[ie+4]=E,this.float32[me+3]=S,this.float32[me+4]=M,this.float32[me+5]=R,this.float32[me+6]=U,this.int16[ie+14]=H,this.uint32[me+8]=q,this.uint16[ie+18]=K,this.uint16[ie+19]=$,o}}Nr.prototype.bytesPerElement=40,Gn(Nr,"StructArrayLayout5i4f1i1ul2ui40");class lo extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,f,m,v,E,S){const M=this.length;return this.resize(M+1),this.emplace(M,o,c,f,m,v,E,S)}emplace(o,c,f,m,v,E,S,M){const R=8*o;return this.int16[R+0]=c,this.int16[R+1]=f,this.int16[R+2]=m,this.int16[R+4]=v,this.int16[R+5]=E,this.int16[R+6]=S,this.int16[R+7]=M,o}}lo.prototype.bytesPerElement=16,Gn(lo,"StructArrayLayout3i2i2i16");class ga extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,f,m,v){const E=this.length;return this.resize(E+1),this.emplace(E,o,c,f,m,v)}emplace(o,c,f,m,v,E){const S=4*o,M=8*o;return this.float32[S+0]=c,this.float32[S+1]=f,this.float32[S+2]=m,this.int16[M+6]=v,this.int16[M+7]=E,o}}ga.prototype.bytesPerElement=16,Gn(ga,"StructArrayLayout2f1f2i16");class Ms extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f,m){const v=this.length;return this.resize(v+1),this.emplace(v,o,c,f,m)}emplace(o,c,f,m,v){const E=12*o,S=3*o;return this.uint8[E+0]=c,this.uint8[E+1]=f,this.float32[S+1]=m,this.float32[S+2]=v,o}}Ms.prototype.bytesPerElement=12,Gn(Ms,"StructArrayLayout2ub2f12");class la extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f){const m=this.length;return this.resize(m+1),this.emplace(m,o,c,f)}emplace(o,c,f,m){const v=3*o;return this.float32[v+0]=c,this.float32[v+1]=f,this.float32[v+2]=m,o}}la.prototype.bytesPerElement=12,Gn(la,"StructArrayLayout3f12");class _a extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,f){const m=this.length;return this.resize(m+1),this.emplace(m,o,c,f)}emplace(o,c,f,m){const v=3*o;return this.uint16[v+0]=c,this.uint16[v+1]=f,this.uint16[v+2]=m,o}}_a.prototype.bytesPerElement=6,Gn(_a,"StructArrayLayout3ui6");class Cc extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,c,f,m,v,E,S,M,R,U,H,q,K,$,ie,me,Me,Ve,Se,ze,Ze){const qe=this.length;return this.resize(qe+1),this.emplace(qe,o,c,f,m,v,E,S,M,R,U,H,q,K,$,ie,me,Me,Ve,Se,ze,Ze)}emplace(o,c,f,m,v,E,S,M,R,U,H,q,K,$,ie,me,Me,Ve,Se,ze,Ze,qe){const It=30*o,bt=15*o,Vt=60*o;return this.int16[It+0]=c,this.int16[It+1]=f,this.int16[It+2]=m,this.float32[bt+2]=v,this.float32[bt+3]=E,this.uint16[It+8]=S,this.uint16[It+9]=M,this.uint32[bt+5]=R,this.uint32[bt+6]=U,this.uint32[bt+7]=H,this.uint16[It+16]=q,this.uint16[It+17]=K,this.uint16[It+18]=$,this.float32[bt+10]=ie,this.float32[bt+11]=me,this.uint8[Vt+48]=Me,this.uint8[Vt+49]=Ve,this.uint8[Vt+50]=Se,this.uint32[bt+13]=ze,this.int16[It+28]=Ze,this.uint8[Vt+58]=qe,o}}Cc.prototype.bytesPerElement=60,Gn(Cc,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Ud extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,c,f,m,v,E,S,M,R,U,H,q,K,$,ie,me,Me,Ve,Se,ze,Ze,qe,It,bt,Vt,pn,At,Yt,$t,hn){const gn=this.length;return this.resize(gn+1),this.emplace(gn,o,c,f,m,v,E,S,M,R,U,H,q,K,$,ie,me,Me,Ve,Se,ze,Ze,qe,It,bt,Vt,pn,At,Yt,$t,hn)}emplace(o,c,f,m,v,E,S,M,R,U,H,q,K,$,ie,me,Me,Ve,Se,ze,Ze,qe,It,bt,Vt,pn,At,Yt,$t,hn,gn){const Lt=38*o,Dn=19*o;return this.int16[Lt+0]=c,this.int16[Lt+1]=f,this.int16[Lt+2]=m,this.float32[Dn+2]=v,this.float32[Dn+3]=E,this.int16[Lt+8]=S,this.int16[Lt+9]=M,this.int16[Lt+10]=R,this.int16[Lt+11]=U,this.int16[Lt+12]=H,this.int16[Lt+13]=q,this.uint16[Lt+14]=K,this.uint16[Lt+15]=$,this.uint16[Lt+16]=ie,this.uint16[Lt+17]=me,this.uint16[Lt+18]=Me,this.uint16[Lt+19]=Ve,this.uint16[Lt+20]=Se,this.uint16[Lt+21]=ze,this.uint16[Lt+22]=Ze,this.uint16[Lt+23]=qe,this.uint16[Lt+24]=It,this.uint16[Lt+25]=bt,this.uint16[Lt+26]=Vt,this.uint16[Lt+27]=pn,this.uint16[Lt+28]=At,this.uint32[Dn+15]=Yt,this.float32[Dn+16]=$t,this.float32[Dn+17]=hn,this.float32[Dn+18]=gn,o}}Ud.prototype.bytesPerElement=76,Gn(Ud,"StructArrayLayout3i2f6i15ui1ul3f76");class ol extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.float32[1*o+0]=c,o}}ol.prototype.bytesPerElement=4,Gn(ol,"StructArrayLayout1f4");class Ki extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,f,m,v){const E=this.length;return this.resize(E+1),this.emplace(E,o,c,f,m,v)}emplace(o,c,f,m,v,E){const S=5*o;return this.float32[S+0]=c,this.float32[S+1]=f,this.float32[S+2]=m,this.float32[S+3]=v,this.float32[S+4]=E,o}}Ki.prototype.bytesPerElement=20,Gn(Ki,"StructArrayLayout5f20");class ah extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,f,m){const v=this.length;return this.resize(v+1),this.emplace(v,o,c,f,m)}emplace(o,c,f,m,v){const E=6*o;return this.uint32[3*o+0]=c,this.uint16[E+2]=f,this.uint16[E+3]=m,this.uint16[E+4]=v,o}}ah.prototype.bytesPerElement=12,Gn(ah,"StructArrayLayout1ul3ui12");class nf extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c){const f=this.length;return this.resize(f+1),this.emplace(f,o,c)}emplace(o,c,f){const m=2*o;return this.uint16[m+0]=c,this.uint16[m+1]=f,o}}nf.prototype.bytesPerElement=4,Gn(nf,"StructArrayLayout2ui4");class mu extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.uint16[1*o+0]=c,o}}mu.prototype.bytesPerElement=2,Gn(mu,"StructArrayLayout1ui2");class Kf extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c){const f=this.length;return this.resize(f+1),this.emplace(f,o,c)}emplace(o,c,f){const m=2*o;return this.float32[m+0]=c,this.float32[m+1]=f,o}}Kf.prototype.bytesPerElement=8,Gn(Kf,"StructArrayLayout2f8");class bb extends $n{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}bb.prototype.size=40;class m0 extends Nr{get(o){return new bb(this,o)}}Gn(m0,"CollisionBoxArray");class qu extends $n{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(o){this._structArray.uint8[this._pos1+49]=o}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(o){this._structArray.uint8[this._pos1+50]=o}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(o){this._structArray.uint32[this._pos4+13]=o}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(o){this._structArray.uint8[this._pos1+58]=o}}qu.prototype.size=60;class xb extends Cc{get(o){return new qu(this,o)}}Gn(xb,"PlacedSymbolArray");class kg extends $n{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(o){this._structArray.uint32[this._pos4+15]=o}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}kg.prototype.size=76;class uy extends Ud{get(o){return new kg(this,o)}}Gn(uy,"SymbolInstanceArray");class g0 extends ol{getoffsetX(o){return this.float32[1*o+0]}}Gn(g0,"GlyphOffsetArray");class _0 extends bi{getx(o){return this.int16[2*o+0]}gety(o){return this.int16[2*o+1]}}Gn(_0,"SymbolLineVertexArray");class gu extends $n{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}gu.prototype.size=12;class Jf extends ah{get(o){return new gu(this,o)}}Gn(Jf,"FeatureIndexArray");class cy extends nf{geta_centroid_pos0(o){return this.uint16[2*o+0]}geta_centroid_pos1(o){return this.uint16[2*o+1]}}Gn(cy,"FillExtrusionCentroidArray");const Eb=di([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),hy=di([{name:"a_dash",components:4,type:"Uint16"}]);var Vd={},y0={get exports(){return Vd},set exports(u){Vd=u}},fy={};({get exports(){return fy},set exports(u){fy=u}}).exports=function(u,o){var c,f,m,v,E,S,M,R;for(f=u.length-(c=3&u.length),m=o,E=3432918353,S=461845907,R=0;R<f;)M=255&u.charCodeAt(R)|(255&u.charCodeAt(++R))<<8|(255&u.charCodeAt(++R))<<16|(255&u.charCodeAt(++R))<<24,++R,m=27492+(65535&(v=5*(65535&(m=(m^=M=(65535&(M=(M=(65535&M)*E+(((M>>>16)*E&65535)<<16)&4294967295)<<15|M>>>17))*S+(((M>>>16)*S&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(M=0,c){case 3:M^=(255&u.charCodeAt(R+2))<<16;case 2:M^=(255&u.charCodeAt(R+1))<<8;case 1:m^=M=(65535&(M=(M=(65535&(M^=255&u.charCodeAt(R)))*E+(((M>>>16)*E&65535)<<16)&4294967295)<<15|M>>>17))*S+(((M>>>16)*S&65535)<<16)&4294967295}return m^=u.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0};var Fg={};({get exports(){return Fg},set exports(u){Fg=u}}).exports=function(u,o){for(var c,f=u.length,m=o^f,v=0;f>=4;)c=1540483477*(65535&(c=255&u.charCodeAt(v)|(255&u.charCodeAt(++v))<<8|(255&u.charCodeAt(++v))<<16|(255&u.charCodeAt(++v))<<24))+((1540483477*(c>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),f-=4,++v;switch(f){case 3:m^=(255&u.charCodeAt(v+2))<<16;case 2:m^=(255&u.charCodeAt(v+1))<<8;case 1:m=1540483477*(65535&(m^=255&u.charCodeAt(v)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0};var dy=fy,Gd=Fg;y0.exports=dy,Vd.murmur3=dy,Vd.murmur2=Gd;class py{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(o,c,f,m){this.ids.push(Qf(o)),this.positions.push(c,f,m)}getPositions(o){const c=Qf(o);let f=0,m=this.ids.length-1;for(;f<m;){const E=f+m>>1;this.ids[E]>=c?m=E:f=E+1}const v=[];for(;this.ids[f]===c;)v.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return v}static serialize(o,c){const f=new Float64Array(o.ids),m=new Uint32Array(o.positions);return my(f,m,0,f.length-1),c&&c.push(f.buffer,m.buffer),{ids:f,positions:m}}static deserialize(o){const c=new py;return c.ids=o.ids,c.positions=o.positions,c.indexed=!0,c}}function Qf(u){const o=+u;return!isNaN(o)&&Number.MIN_SAFE_INTEGER<=o&&o<=Number.MAX_SAFE_INTEGER?o:Vd(String(u))}function my(u,o,c,f){for(;c<f;){const m=u[c+f>>1];let v=c-1,E=f+1;for(;;){do v++;while(u[v]<m);do E--;while(u[E]>m);if(v>=E)break;Bg(u,v,E),Bg(o,3*v,3*E),Bg(o,3*v+1,3*E+1),Bg(o,3*v+2,3*E+2)}E-c<f-E?(my(u,o,c,E),c=E+1):(my(u,o,E+1,f),f=E)}}function Bg(u,o,c){const f=u[o];u[o]=u[c],u[c]=f}Gn(py,"FeaturePositionMap");class lh{constructor(o){this.gl=o.gl,this.initialized=!1}fetchUniformLocation(o,c){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(o,c),this.initialized=!0),!!this.location}}class gy extends lh{constructor(o){super(o),this.current=0}set(o,c,f){this.fetchUniformLocation(o,c)&&this.current!==f&&(this.current=f,this.gl.uniform1f(this.location,f))}}class Ib extends lh{constructor(o){super(o),this.current=[0,0,0,0]}set(o,c,f){this.fetchUniformLocation(o,c)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]&&f[3]===this.current[3]||(this.current=f,this.gl.uniform4f(this.location,f[0],f[1],f[2],f[3])))}}class Tb extends lh{constructor(o){super(o),this.current=qi.transparent}set(o,c,f){this.fetchUniformLocation(o,c)&&(f.r===this.current.r&&f.g===this.current.g&&f.b===this.current.b&&f.a===this.current.a||(this.current=f,this.gl.uniform4f(this.location,f.r,f.g,f.b,f.a)))}}const wb=new Float32Array(16),Sb=new Float32Array(9),PI=new Float32Array(4);function _y(u){return[ci(255*u.r,255*u.g),ci(255*u.b,255*u.a)]}class Lm{constructor(o,c,f){this.value=o,this.uniformNames=c.map(m=>`u_${m}`),this.type=f}setUniform(o,c,f,m,v){c.set(o,v,m.constantOr(this.value))}getBinding(o,c){return this.type==="color"?new Tb(o):new gy(o)}}class ya{constructor(o,c){this.uniformNames=c.map(f=>`u_${f}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(o){this.pixelRatio=o.pixelRatio||1,this.pattern=o.tl.concat(o.br)}setUniform(o,c,f,m,v){const E=v==="u_pattern"||v==="u_dash"?this.pattern:v==="u_pixel_ratio"?this.pixelRatio:null;E&&c.set(o,v,E)}getBinding(o,c){return c==="u_pattern"||c==="u_dash"?new Ib(o):new gy(o)}}class ka{constructor(o,c,f,m){this.expression=o,this.type=f,this.maxValue=0,this.paintVertexAttributes=c.map(v=>({name:`a_${v}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(o,c,f,m,v,E){const S=this.paintVertexArray.length,M=this.expression.evaluate(new ft(0),c,{},v,m,E);this.paintVertexArray.resize(o),this._setPaintValue(S,o,M)}updatePaintArray(o,c,f,m,v){const E=this.expression.evaluate({zoom:0},f,m,void 0,v);this._setPaintValue(o,c,E)}_setPaintValue(o,c,f){if(this.type==="color"){const m=_y(f);for(let v=o;v<c;v++)this.paintVertexArray.emplace(v,m[0],m[1])}else{for(let m=o;m<c;m++)this.paintVertexArray.emplace(m,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class uh{constructor(o,c,f,m,v,E){this.expression=o,this.uniformNames=c.map(S=>`u_${S}_t`),this.type=f,this.useIntegerZoom=m,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=c.map(S=>({name:`a_${S}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new E}populatePaintArray(o,c,f,m,v,E){const S=this.expression.evaluate(new ft(this.zoom),c,{},v,m,E),M=this.expression.evaluate(new ft(this.zoom+1),c,{},v,m,E),R=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValue(R,o,S,M)}updatePaintArray(o,c,f,m,v){const E=this.expression.evaluate({zoom:this.zoom},f,m,void 0,v),S=this.expression.evaluate({zoom:this.zoom+1},f,m,void 0,v);this._setPaintValue(o,c,E,S)}_setPaintValue(o,c,f,m){if(this.type==="color"){const v=_y(f),E=_y(m);for(let S=o;S<c;S++)this.paintVertexArray.emplace(S,v[0],v[1],E[0],E[1])}else{for(let v=o;v<c;v++)this.paintVertexArray.emplace(v,f,m);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(m))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(o,c,f,m,v){const E=this.useIntegerZoom?Math.floor(f.zoom):f.zoom,S=it(this.expression.interpolationFactor(E,this.zoom,this.zoom+1),0,1);c.set(o,v,S)}getBinding(o,c){return new gy(o)}}class Hd{constructor(o,c,f,m,v){this.expression=o,this.layerId=v,this.paintVertexAttributes=(f==="array"?hy:Eb).members;for(let E=0;E<c.length;++E);this.paintVertexArray=new m}populatePaintArray(o,c,f){const m=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValues(m,o,c.patterns&&c.patterns[this.layerId],f)}updatePaintArray(o,c,f,m,v,E){this._setPaintValues(o,c,f.patterns&&f.patterns[this.layerId],E)}_setPaintValues(o,c,f,m){if(!m||!f)return;const v=m[f];if(!v)return;const{tl:E,br:S,pixelRatio:M}=v;for(let R=o;R<c;R++)this.paintVertexArray.emplace(R,E[0],E[1],S[0],S[1],M)}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ch{constructor(o,c,f=()=>!0){this.binders={},this._buffers=[];const m=[];for(const v in o.paint._values){if(!f(v))continue;const E=o.paint.get(v);if(!(E instanceof un&&_r(E.property.specification)))continue;const S=Ab(v,o.type),M=E.value,R=E.property.specification.type,U=E.property.useIntegerZoom,H=v==="line-dasharray"||v.endsWith("pattern"),q=v==="line-dasharray"&&o.layout.get("line-cap").value.kind!=="constant";if(M.kind!=="constant"||q)if(M.kind==="source"||q||H){const K=jp(v,R,"source");this.binders[v]=H?new Hd(M,S,R,K,o.id):new ka(M,S,R,K),m.push(`/a_${v}`)}else{const K=jp(v,R,"composite");this.binders[v]=new uh(M,S,R,U,c,K),m.push(`/z_${v}`)}else this.binders[v]=H?new ya(M.value,S):new Lm(M.value,S,R),m.push(`/u_${v}`)}this.cacheKey=m.sort().join("")}getMaxValue(o){const c=this.binders[o];return c instanceof ka||c instanceof uh?c.maxValue:0}populatePaintArrays(o,c,f,m,v,E){for(const S in this.binders){const M=this.binders[S];(M instanceof ka||M instanceof uh||M instanceof Hd)&&M.populatePaintArray(o,c,f,m,v,E)}}setConstantPatternPositions(o){for(const c in this.binders){const f=this.binders[c];f instanceof ya&&f.setConstantPatternPositions(o)}}updatePaintArrays(o,c,f,m,v,E){let S=!1;for(const M in o){const R=c.getPositions(M);for(const U of R){const H=f.feature(U.index);for(const q in this.binders){const K=this.binders[q];if((K instanceof ka||K instanceof uh||K instanceof Hd)&&K.expression.isStateDependent===!0){const $=m.paint.get(q);K.expression=$.value,K.updatePaintArray(U.start,U.end,H,o[M],v,E),S=!0}}}}return S}defines(){const o=[];for(const c in this.binders){const f=this.binders[c];(f instanceof Lm||f instanceof ya)&&o.push(...f.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return o}getBinderAttributes(){const o=[];for(const c in this.binders){const f=this.binders[c];if(f instanceof ka||f instanceof uh||f instanceof Hd)for(let m=0;m<f.paintVertexAttributes.length;m++)o.push(f.paintVertexAttributes[m].name)}return o}getBinderUniforms(){const o=[];for(const c in this.binders){const f=this.binders[c];if(f instanceof Lm||f instanceof ya||f instanceof uh)for(const m of f.uniformNames)o.push(m)}return o}getPaintVertexBuffers(){return this._buffers}getUniforms(o){const c=[];for(const f in this.binders){const m=this.binders[f];if(m instanceof Lm||m instanceof ya||m instanceof uh)for(const v of m.uniformNames)c.push({name:v,property:f,binding:m.getBinding(o,v)})}return c}setUniforms(o,c,f,m,v){for(const{name:E,property:S,binding:M}of f)this.binders[S].setUniform(o,M,v,m.get(S),E)}updatePaintBuffers(){this._buffers=[];for(const o in this.binders){const c=this.binders[o];(c instanceof ka||c instanceof uh||c instanceof Hd)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(o){for(const c in this.binders){const f=this.binders[c];(f instanceof ka||f instanceof uh||f instanceof Hd)&&f.upload(o)}this.updatePaintBuffers()}destroy(){for(const o in this.binders){const c=this.binders[o];(c instanceof ka||c instanceof uh||c instanceof Hd)&&c.destroy()}}}class Ac{constructor(o,c,f=()=>!0){this.programConfigurations={};for(const m of o)this.programConfigurations[m.id]=new ch(m,c,f);this.needsUpload=!1,this._featureMap=new py,this._bufferOffset=0}populatePaintArrays(o,c,f,m,v,E,S){for(const M in this.programConfigurations)this.programConfigurations[M].populatePaintArrays(o,c,m,v,E,S);c.id!==void 0&&this._featureMap.add(c.id,f,this._bufferOffset,o),this._bufferOffset=o,this.needsUpload=!0}updatePaintArrays(o,c,f,m,v){for(const E of f)this.needsUpload=this.programConfigurations[E.id].updatePaintArrays(o,this._featureMap,c,E,m,v)||this.needsUpload}get(o){return this.programConfigurations[o]}upload(o){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(o);this.needsUpload=!1}}destroy(){for(const o in this.programConfigurations)this.programConfigurations[o].destroy()}}const Cb={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Ab(u,o){return Cb[u]||[u.replace(`${o}-`,"").replace(/-/g,"_")]}const DI={"line-pattern":{source:xo,composite:xo},"fill-pattern":{source:xo,composite:xo},"fill-extrusion-pattern":{source:xo,composite:xo},"line-dasharray":{source:sl,composite:sl}},Mb={color:{source:Kf,composite:ss},number:{source:ol,composite:Kf}};function jp(u,o,c){const f=DI[u];return f&&f[c]||Mb[o][c]}Gn(Lm,"ConstantBinder"),Gn(ya,"PatternConstantBinder"),Gn(ka,"SourceExpressionBinder"),Gn(Hd,"PatternCompositeBinder"),Gn(uh,"CompositeExpressionBinder"),Gn(ch,"ProgramConfiguration",{omit:["_buffers"]}),Gn(Ac,"ProgramConfigurationSet");const jd="-transition";class hh extends fa{constructor(o,c){if(super(),this.id=o.id,this.type=o.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,o.type!=="custom"&&(this.metadata=o.metadata,this.minzoom=o.minzoom,this.maxzoom=o.maxzoom,o.type!=="background"&&o.type!=="sky"&&(this.source=o.source,this.sourceLayer=o["source-layer"],this.filter=o.filter),c.layout&&(this._unevaluatedLayout=new St(c.layout)),c.paint)){this._transitionablePaint=new Tn(c.paint);for(const f in o.paint)this.setPaintProperty(f,o.paint[f],{validate:!1});for(const f in o.layout)this.setLayoutProperty(f,o.layout[f],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new yt(c.paint)}}getLayoutProperty(o){return o==="visibility"?this.visibility:this._unevaluatedLayout.getValue(o)}setLayoutProperty(o,c,f={}){c!=null&&this._validate($h,`layers.${this.id}.layout.${o}`,o,c,f)||(o!=="visibility"?this._unevaluatedLayout.setValue(o,c):this.visibility=c)}getPaintProperty(o){return En(o,jd)?this._transitionablePaint.getTransition(o.slice(0,-jd.length)):this._transitionablePaint.getValue(o)}setPaintProperty(o,c,f={}){if(c!=null&&this._validate(p0,`layers.${this.id}.paint.${o}`,o,c,f))return!1;if(En(o,jd))return this._transitionablePaint.setTransition(o.slice(0,-jd.length),c||void 0),!1;{const m=this._transitionablePaint._values[o],v=m.value.isDataDriven(),E=m.value;this._transitionablePaint.setValue(o,c),this._handleSpecialPaintPropertyUpdate(o);const S=this._transitionablePaint._values[o].value,M=S.isDataDriven(),R=En(o,"pattern")||o==="line-dasharray";return M||v||R||this._handleOverridablePaintPropertyUpdate(o,E,S)}}_handleSpecialPaintPropertyUpdate(o){}getProgramIds(){return null}getProgramConfiguration(o){return null}_handleOverridablePaintPropertyUpdate(o,c,f){return!1}isHidden(o){return!!(this.minzoom&&o<this.minzoom)||!!(this.maxzoom&&o>=this.maxzoom)||this.visibility==="none"}updateTransitions(o){this._transitioningPaint=this._transitionablePaint.transitioned(o,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(o,c){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(o,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(o,void 0,c)}serialize(){const o={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(o.layout=o.layout||{},o.layout.visibility=this.visibility),kt(o,(c,f)=>!(c===void 0||f==="layout"&&!Object.keys(c).length||f==="paint"&&!Object.keys(c).length))}_validate(o,c,f,m,v={}){return(!v||v.validate!==!1)&&ey(this,o.call($_,{key:c,layerType:this.type,objectKey:f,value:m,styleSpec:Rt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const o in this.paint._values){const c=this.paint.get(o);if(c instanceof un&&_r(c.property.specification)&&(c.value.kind==="source"||c.value.kind==="composite")&&c.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=bo(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const Lb=di([{name:"a_pos",components:2,type:"Int16"}],4),Rb=di([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Qs{constructor(o=[]){this.segments=o}prepareSegment(o,c,f,m){let v=this.segments[this.segments.length-1];return o>Qs.MAX_VERTEX_ARRAY_LENGTH&&Zn(`Max vertices per segment is ${Qs.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${o}`),(!v||v.vertexLength+o>Qs.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==m)&&(v={vertexOffset:c.length,primitiveOffset:f.length,vertexLength:0,primitiveLength:0},m!==void 0&&(v.sortKey=m),this.segments.push(v)),v}get(){return this.segments}destroy(){for(const o of this.segments)for(const c in o.vaos)o.vaos[c].destroy()}static simpleSegment(o,c,f,m){return new Qs([{vertexOffset:o,primitiveOffset:c,vertexLength:f,primitiveLength:m,vaos:{},sortKey:0}])}}Qs.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Gn(Qs,"SegmentVector");var Mi=8192;class fh{constructor(o,c){o&&(c?this.setSouthWest(o).setNorthEast(c):o.length===4?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1]))}setNorthEast(o){return this._ne=o instanceof kr?new kr(o.lng,o.lat):kr.convert(o),this}setSouthWest(o){return this._sw=o instanceof kr?new kr(o.lng,o.lat):kr.convert(o),this}extend(o){const c=this._sw,f=this._ne;let m,v;if(o instanceof kr)m=o,v=o;else{if(!(o instanceof fh))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(fh.convert(o)):this.extend(kr.convert(o)):typeof o=="object"&&o!==null&&o.hasOwnProperty("lat")&&o.hasOwnProperty("lon")?this.extend(kr.convert(o)):this;if(m=o._sw,v=o._ne,!m||!v)return this}return c||f?(c.lng=Math.min(m.lng,c.lng),c.lat=Math.min(m.lat,c.lat),f.lng=Math.max(v.lng,f.lng),f.lat=Math.max(v.lat,f.lat)):(this._sw=new kr(m.lng,m.lat),this._ne=new kr(v.lng,v.lat)),this}getCenter(){return new kr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new kr(this.getWest(),this.getNorth())}getSouthEast(){return new kr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:c,lat:f}=kr.convert(o);let m=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&m}static convert(o){return!o||o instanceof fh?o:new fh(o)}}var Rm=1e-6,al=typeof Float32Array<"u"?Float32Array:Array;function Pb(){var u=new al(9);return al!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[5]=0,u[6]=0,u[7]=0),u[0]=1,u[4]=1,u[8]=1,u}function v0(u,o,c){var f=o[0],m=o[1],v=o[2],E=o[3],S=o[4],M=o[5],R=o[6],U=o[7],H=o[8],q=c[0],K=c[1],$=c[2],ie=c[3],me=c[4],Me=c[5],Ve=c[6],Se=c[7],ze=c[8];return u[0]=q*f+K*E+$*R,u[1]=q*m+K*S+$*U,u[2]=q*v+K*M+$*H,u[3]=ie*f+me*E+Me*R,u[4]=ie*m+me*S+Me*U,u[5]=ie*v+me*M+Me*H,u[6]=Ve*f+Se*E+ze*R,u[7]=Ve*m+Se*S+ze*U,u[8]=Ve*v+Se*M+ze*H,u}function _u(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function yy(u,o){var c=o[0],f=o[1],m=o[2],v=o[3],E=o[4],S=o[5],M=o[6],R=o[7],U=o[8],H=o[9],q=o[10],K=o[11],$=o[12],ie=o[13],me=o[14],Me=o[15],Ve=c*S-f*E,Se=c*M-m*E,ze=c*R-v*E,Ze=f*M-m*S,qe=f*R-v*S,It=m*R-v*M,bt=U*ie-H*$,Vt=U*me-q*$,pn=U*Me-K*$,At=H*me-q*ie,Yt=H*Me-K*ie,$t=q*Me-K*me,hn=Ve*$t-Se*Yt+ze*At+Ze*pn-qe*Vt+It*bt;return hn?(u[0]=(S*$t-M*Yt+R*At)*(hn=1/hn),u[1]=(m*Yt-f*$t-v*At)*hn,u[2]=(ie*It-me*qe+Me*Ze)*hn,u[3]=(q*qe-H*It-K*Ze)*hn,u[4]=(M*pn-E*$t-R*Vt)*hn,u[5]=(c*$t-m*pn+v*Vt)*hn,u[6]=(me*ze-$*It-Me*Se)*hn,u[7]=(U*It-q*ze+K*Se)*hn,u[8]=(E*Yt-S*pn+R*bt)*hn,u[9]=(f*pn-c*Yt-v*bt)*hn,u[10]=($*qe-ie*ze+Me*Ve)*hn,u[11]=(H*ze-U*qe-K*Ve)*hn,u[12]=(S*Vt-E*At-M*bt)*hn,u[13]=(c*At-f*Vt+m*bt)*hn,u[14]=(ie*Se-$*Ze-me*Ve)*hn,u[15]=(U*Ze-H*Se+q*Ve)*hn,u):null}function $f(u,o,c){var f=o[0],m=o[1],v=o[2],E=o[3],S=o[4],M=o[5],R=o[6],U=o[7],H=o[8],q=o[9],K=o[10],$=o[11],ie=o[12],me=o[13],Me=o[14],Ve=o[15],Se=c[0],ze=c[1],Ze=c[2],qe=c[3];return u[0]=Se*f+ze*S+Ze*H+qe*ie,u[1]=Se*m+ze*M+Ze*q+qe*me,u[2]=Se*v+ze*R+Ze*K+qe*Me,u[3]=Se*E+ze*U+Ze*$+qe*Ve,u[4]=(Se=c[4])*f+(ze=c[5])*S+(Ze=c[6])*H+(qe=c[7])*ie,u[5]=Se*m+ze*M+Ze*q+qe*me,u[6]=Se*v+ze*R+Ze*K+qe*Me,u[7]=Se*E+ze*U+Ze*$+qe*Ve,u[8]=(Se=c[8])*f+(ze=c[9])*S+(Ze=c[10])*H+(qe=c[11])*ie,u[9]=Se*m+ze*M+Ze*q+qe*me,u[10]=Se*v+ze*R+Ze*K+qe*Me,u[11]=Se*E+ze*U+Ze*$+qe*Ve,u[12]=(Se=c[12])*f+(ze=c[13])*S+(Ze=c[14])*H+(qe=c[15])*ie,u[13]=Se*m+ze*M+Ze*q+qe*me,u[14]=Se*v+ze*R+Ze*K+qe*Me,u[15]=Se*E+ze*U+Ze*$+qe*Ve,u}function zg(u,o,c){var f,m,v,E,S,M,R,U,H,q,K,$,ie=c[0],me=c[1],Me=c[2];return o===u?(u[12]=o[0]*ie+o[4]*me+o[8]*Me+o[12],u[13]=o[1]*ie+o[5]*me+o[9]*Me+o[13],u[14]=o[2]*ie+o[6]*me+o[10]*Me+o[14],u[15]=o[3]*ie+o[7]*me+o[11]*Me+o[15]):(m=o[1],v=o[2],E=o[3],S=o[4],M=o[5],R=o[6],U=o[7],H=o[8],q=o[9],K=o[10],$=o[11],u[0]=f=o[0],u[1]=m,u[2]=v,u[3]=E,u[4]=S,u[5]=M,u[6]=R,u[7]=U,u[8]=H,u[9]=q,u[10]=K,u[11]=$,u[12]=f*ie+S*me+H*Me+o[12],u[13]=m*ie+M*me+q*Me+o[13],u[14]=v*ie+R*me+K*Me+o[14],u[15]=E*ie+U*me+$*Me+o[15]),u}function qd(u,o,c){var f=c[0],m=c[1],v=c[2];return u[0]=o[0]*f,u[1]=o[1]*f,u[2]=o[2]*f,u[3]=o[3]*f,u[4]=o[4]*m,u[5]=o[5]*m,u[6]=o[6]*m,u[7]=o[7]*m,u[8]=o[8]*v,u[9]=o[9]*v,u[10]=o[10]*v,u[11]=o[11]*v,u[12]=o[12],u[13]=o[13],u[14]=o[14],u[15]=o[15],u}function dh(u,o,c){var f=Math.sin(c),m=Math.cos(c),v=o[4],E=o[5],S=o[6],M=o[7],R=o[8],U=o[9],H=o[10],q=o[11];return o!==u&&(u[0]=o[0],u[1]=o[1],u[2]=o[2],u[3]=o[3],u[12]=o[12],u[13]=o[13],u[14]=o[14],u[15]=o[15]),u[4]=v*m+R*f,u[5]=E*m+U*f,u[6]=S*m+H*f,u[7]=M*m+q*f,u[8]=R*m-v*f,u[9]=U*m-E*f,u[10]=H*m-S*f,u[11]=q*m-M*f,u}function Ug(u,o,c){var f=Math.sin(c),m=Math.cos(c),v=o[0],E=o[1],S=o[2],M=o[3],R=o[8],U=o[9],H=o[10],q=o[11];return o!==u&&(u[4]=o[4],u[5]=o[5],u[6]=o[6],u[7]=o[7],u[12]=o[12],u[13]=o[13],u[14]=o[14],u[15]=o[15]),u[0]=v*m-R*f,u[1]=E*m-U*f,u[2]=S*m-H*f,u[3]=M*m-q*f,u[8]=v*f+R*m,u[9]=E*f+U*m,u[10]=S*f+H*m,u[11]=M*f+q*m,u}function b0(u,o){return u[0]=o[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=o[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=o[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function Db(u,o,c){var f,m,v,E=c[0],S=c[1],M=c[2],R=Math.hypot(E,S,M);return R<Rm?null:(E*=R=1/R,S*=R,M*=R,f=Math.sin(o),m=Math.cos(o),u[0]=E*E*(v=1-m)+m,u[1]=S*E*v+M*f,u[2]=M*E*v-S*f,u[3]=0,u[4]=E*S*v-M*f,u[5]=S*S*v+m,u[6]=M*S*v+E*f,u[7]=0,u[8]=E*M*v+S*f,u[9]=S*M*v-E*f,u[10]=M*M*v+m,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u)}Math.hypot||(Math.hypot=function(){for(var u=0,o=arguments.length;o--;)u+=arguments[o]*arguments[o];return Math.sqrt(u)});var Ob=$f;function x0(){var u=new al(3);return al!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u}function Nb(u){var o=new al(3);return o[0]=u[0],o[1]=u[1],o[2]=u[2],o}function Wu(u){return Math.hypot(u[0],u[1],u[2])}function Wd(u,o,c){var f=new al(3);return f[0]=u,f[1]=o,f[2]=c,f}function ph(u,o,c){return u[0]=o[0]+c[0],u[1]=o[1]+c[1],u[2]=o[2]+c[2],u}function Vg(u,o,c){return u[0]=o[0]-c[0],u[1]=o[1]-c[1],u[2]=o[2]-c[2],u}function Gg(u,o,c){return u[0]=o[0]*c[0],u[1]=o[1]*c[1],u[2]=o[2]*c[2],u}function rf(u,o,c){return u[0]=Math.min(o[0],c[0]),u[1]=Math.min(o[1],c[1]),u[2]=Math.min(o[2],c[2]),u}function Vi(u,o,c){return u[0]=Math.max(o[0],c[0]),u[1]=Math.max(o[1],c[1]),u[2]=Math.max(o[2],c[2]),u}function Il(u,o,c){return u[0]=o[0]*c,u[1]=o[1]*c,u[2]=o[2]*c,u}function qp(u,o,c,f){return u[0]=o[0]+c[0]*f,u[1]=o[1]+c[1]*f,u[2]=o[2]+c[2]*f,u}function Bo(u,o){var c=o[0],f=o[1],m=o[2],v=c*c+f*f+m*m;return v>0&&(v=1/Math.sqrt(v)),u[0]=o[0]*v,u[1]=o[1]*v,u[2]=o[2]*v,u}function Mc(u,o){return u[0]*o[0]+u[1]*o[1]+u[2]*o[2]}function Hg(u,o,c){var f=o[0],m=o[1],v=o[2],E=c[0],S=c[1],M=c[2];return u[0]=m*M-v*S,u[1]=v*E-f*M,u[2]=f*S-m*E,u}function uo(u,o,c){var f=o[0],m=o[1],v=o[2],E=c[3]*f+c[7]*m+c[11]*v+c[15];return u[0]=(c[0]*f+c[4]*m+c[8]*v+c[12])/(E=E||1),u[1]=(c[1]*f+c[5]*m+c[9]*v+c[13])/E,u[2]=(c[2]*f+c[6]*m+c[10]*v+c[14])/E,u}function ll(u,o,c){var f=c[0],m=c[1],v=c[2],E=o[0],S=o[1],M=o[2],R=m*M-v*S,U=v*E-f*M,H=f*S-m*E,q=m*H-v*U,K=v*R-f*H,$=f*U-m*R,ie=2*c[3];return U*=ie,H*=ie,K*=2,$*=2,u[0]=E+(R*=ie)+(q*=2),u[1]=S+U+K,u[2]=M+H+$,u}var jg,mh=Vg,kb=Gg,OI=Wu;function E0(u,o,c){return u[0]=o[0]*c,u[1]=o[1]*c,u[2]=o[2]*c,u[3]=o[3]*c,u}function Fb(u,o){var c=o[0],f=o[1],m=o[2],v=o[3],E=c*c+f*f+m*m+v*v;return E>0&&(E=1/Math.sqrt(E)),u[0]=c*E,u[1]=f*E,u[2]=m*E,u[3]=v*E,u}function Wp(u,o,c){var f=o[0],m=o[1],v=o[2],E=o[3];return u[0]=c[0]*f+c[4]*m+c[8]*v+c[12]*E,u[1]=c[1]*f+c[5]*m+c[9]*v+c[13]*E,u[2]=c[2]*f+c[6]*m+c[10]*v+c[14]*E,u[3]=c[3]*f+c[7]*m+c[11]*v+c[15]*E,u}function Bb(){var u=new al(4);return al!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u[3]=1,u}function sf(u){return u[0]=0,u[1]=0,u[2]=0,u[3]=1,u}function Tl(u,o,c){c*=.5;var f=o[0],m=o[1],v=o[2],E=o[3],S=Math.sin(c),M=Math.cos(c);return u[0]=f*M+E*S,u[1]=m*M+v*S,u[2]=v*M-m*S,u[3]=E*M-f*S,u}function vy(u,o,c){c*=.5;var f=o[0],m=o[1],v=o[2],E=o[3],S=Math.sin(c),M=Math.cos(c);return u[0]=f*M-v*S,u[1]=m*M+E*S,u[2]=v*M+f*S,u[3]=E*M-m*S,u}x0(),jg=new al(4),al!=Float32Array&&(jg[0]=0,jg[1]=0,jg[2]=0,jg[3]=0);var NI=Fb;x0(),Wd(1,0,0),Wd(0,1,0),Bb(),Bb(),Pb();const I0=di([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:zb}=I0,Ub=di([{name:"a_pos_3",components:3,type:"Int16"}]);var ed=di([{name:"a_pos",type:"Int16",components:2}]);class by{constructor(o,c){this.pos=o,this.dir=c}intersectsPlane(o,c,f){const m=Mc(c,this.dir);if(Math.abs(m)<1e-6)return!1;const v=((o[0]-this.pos[0])*c[0]+(o[1]-this.pos[1])*c[1]+(o[2]-this.pos[2])*c[2])/m;return f[0]=this.pos[0]+this.dir[0]*v,f[1]=this.pos[1]+this.dir[1]*v,f[2]=this.pos[2]+this.dir[2]*v,!0}closestPointOnSphere(o,c,f){if(function(K,$){var ie=K[0],me=K[1],Me=K[2],Ve=$[0],Se=$[1],ze=$[2];return Math.abs(ie-Ve)<=Rm*Math.max(1,Math.abs(ie),Math.abs(Ve))&&Math.abs(me-Se)<=Rm*Math.max(1,Math.abs(me),Math.abs(Se))&&Math.abs(Me-ze)<=Rm*Math.max(1,Math.abs(Me),Math.abs(ze))}(this.pos,o)||c===0)return f[0]=f[1]=f[2]=0,!1;const[m,v,E]=this.dir,S=this.pos[0]-o[0],M=this.pos[1]-o[1],R=this.pos[2]-o[2],U=m*m+v*v+E*E,H=2*(S*m+M*v+R*E),q=H*H-4*U*(S*S+M*M+R*R-c*c);if(q<0){const K=Math.max(-H/2,0),$=S+m*K,ie=M+v*K,me=R+E*K,Me=Math.hypot($,ie,me);return f[0]=$*c/Me,f[1]=ie*c/Me,f[2]=me*c/Me,!1}{const K=(-H-Math.sqrt(q))/(2*U);if(K<0){const $=Math.hypot(S,M,R);return f[0]=S*c/$,f[1]=M*c/$,f[2]=R*c/$,!1}return f[0]=S+m*K,f[1]=M+v*K,f[2]=R+E*K,!0}}}class xy{constructor(o,c,f,m,v){this.TL=o,this.TR=c,this.BR=f,this.BL=m,this.horizon=v}static fromInvProjectionMatrix(o,c,f){const m=[-1,1,1],v=[1,1,1],E=[1,-1,1],S=[-1,-1,1],M=uo(m,m,o),R=uo(v,v,o),U=uo(E,E,o),H=uo(S,S,o);return new xy(M,R,U,H,c/f)}}class T0{constructor(o,c){this.points=o,this.planes=c}static fromInvProjectionMatrix(o,c,f,m){const v=Math.pow(2,f),E=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(M=>{const R=Wp([],M,o),U=1/R[3]/c*v;return function(H,q,K){return H[0]=q[0]*K[0],H[1]=q[1]*K[1],H[2]=q[2]*K[2],H[3]=q[3]*K[3],H}(R,R,[U,U,m?1/R[3]:U,U])}),S=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(M=>{const R=Bo([],Hg([],mh([],E[M[0]],E[M[1]]),mh([],E[M[2]],E[M[1]]))),U=-Mc(R,E[M[1]]);return R.concat(U)});return new T0(E,S)}}class wl{static fromPoints(o){const c=[1/0,1/0,1/0],f=[-1/0,-1/0,-1/0];for(const m of o)rf(c,c,m),Vi(f,f,m);return new wl(c,f)}static applyTransform(o,c){const f=o.getCorners();for(let m=0;m<f.length;++m)uo(f[m],f[m],c);return wl.fromPoints(f)}constructor(o,c){this.min=o,this.max=c,this.center=Il([],ph([],this.min,this.max),.5)}quadrant(o){const c=[o%2==0,o<2],f=Nb(this.min),m=Nb(this.max);for(let v=0;v<c.length;v++)f[v]=c[v]?this.min[v]:this.center[v],m[v]=c[v]?this.center[v]:this.max[v];return m[2]=this.max[2],new wl(f,m)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}distanceZ(o){return Math.max(Math.min(this.max[2],o[2]),this.min[2])-o[2]}getCorners(){const o=this.min,c=this.max;return[[o[0],o[1],o[2]],[c[0],o[1],o[2]],[c[0],c[1],o[2]],[o[0],c[1],o[2]],[o[0],o[1],c[2]],[c[0],o[1],c[2]],[c[0],c[1],c[2]],[o[0],c[1],c[2]]]}intersects(o){const c=this.getCorners();let f=!0;for(let m=0;m<o.planes.length;m++){const v=o.planes[m];let E=0;for(let S=0;S<c.length;S++)E+=Mc(v,c[S])+v[3]>=0;if(E===0)return 0;E!==c.length&&(f=!1)}if(f)return 2;for(let m=0;m<3;m++){let v=Number.MAX_VALUE,E=-Number.MAX_VALUE;for(let S=0;S<o.points.length;S++){const M=o.points[S][m]-this.min[m];v=Math.min(v,M),E=Math.max(E,M)}if(E<0||v>this.max[m]-this.min[m])return 0}return 1}}const of=Mi/Math.PI/2,Xp=64,Pm=[Xp,32,16],Xu=-of,Lc=of,w0=[new wl([Xu,Xu,Xu],[Lc,Lc,Lc]),new wl([Xu,Xu,Xu],[0,0,Lc]),new wl([0,Xu,Xu],[Lc,0,Lc]),new wl([Xu,0,Xu],[0,Lc,Lc]),new wl([0,0,Xu],[Lc,Lc,Lc])];function qg(u){return u*of/Zg}function Dm(u,o,c,f=!0){const m=Il([],u._camera.position,u.worldSize),v=[o,c,1,1];Wp(v,v,u.pixelMatrixInverse),E0(v,v,1/v[3]);const E=Bo([],mh([],v,m)),S=u.globeMatrix,M=[S[12],S[13],S[14]],R=mh([],M,m),U=Wu(R),H=Bo([],R),q=u.worldSize/(2*Math.PI),K=Mc(H,E),$=Math.asin(q/U);if($<Math.acos(K)){if(!f)return null;const pn=[],At=[];Il(pn,E,U/K),Bo(At,mh(At,pn,R)),Bo(E,ph(E,R,Il(E,At,Math.tan($)*U)))}const ie=[];new by(m,E).closestPointOnSphere(M,q,ie);const me=Bo([],He(S,0)),Me=Bo([],He(S,1)),Ve=Bo([],He(S,2)),Se=Mc(me,ie),ze=Mc(Me,ie),Ze=Mc(Ve,ie),qe=fe(Math.asin(-ze/q));let It=fe(Math.atan2(Se,Ze));It=u.center.lng+function(pn,At){const Yt=(At-pn+180)%360-180;return Yt<-180?Yt+360:Yt}(u.center.lng,It);const bt=lf(It),Vt=it(uf(qe),0,1);return new Fm(bt,Vt)}class S0{constructor(o,c,f){this.a=mh([],o,f),this.b=mh([],c,f),this.center=f;const m=Bo([],this.a),v=Bo([],this.b);this.angle=Math.acos(Mc(m,v))}}function Ey(u,o){if(u.angle===0)return null;let c;return c=u.a[o]===0?1/u.angle*.5*Math.PI:1/u.angle*Math.atan(u.b[o]/u.a[o]/Math.sin(u.angle)-1/Math.tan(u.angle)),c<0||c>1?null:function(f,m,v,E){const S=Math.sin(v);return f*(Math.sin((1-E)*v)/S)+m*(Math.sin(E*v)/S)}(u.a[o],u.b[o],u.angle,it(c,0,1))+u.center[o]}function gh(u){if(u.z<=1)return w0[u.z+2*u.y+u.x];const o=Ty(Iy(u));return wl.fromPoints(o)}function af(u,o,c){return Il(u,u,1-c),qp(u,u,o,c)}function C0(u,o){const c=km(o.zoom);if(c===0)return gh(u);const f=Iy(u),m=Ty(f),v=lf(f.getWest())*o.worldSize,E=lf(f.getEast())*o.worldSize,S=uf(f.getNorth())*o.worldSize,M=uf(f.getSouth())*o.worldSize,R=[v,S,0],U=[E,S,0],H=[v,M,0],q=[E,M,0],K=yy([],o.globeMatrix);return uo(R,R,K),uo(U,U,K),uo(H,H,K),uo(q,q,K),m[0]=af(m[0],H,c),m[1]=af(m[1],q,c),m[2]=af(m[2],U,c),m[3]=af(m[3],R,c),wl.fromPoints(m)}function _h(u,o,c){for(const f of u)uo(f,f,o),Il(f,f,c)}function Zp(u,o,c){const f=o/u.worldSize,m=u.globeMatrix;if(c.z<=1){const bt=gh(c).getCorners();return _h(bt,m,f),wl.fromPoints(bt)}const v=Iy(c),E=Ty(v);_h(E,m,f);const S=Number.MAX_VALUE,M=[-S,-S,-S],R=[S,S,S];if(v.contains(u.center)){for(const pn of E)rf(R,R,pn),Vi(M,M,pn);M[2]=0;const bt=u.point,Vt=[bt.x*f,bt.y*f,0];return rf(R,R,Vt),Vi(M,M,Vt),new wl(R,M)}const U=[m[12]*f,m[13]*f,m[14]*f],H=v.getCenter(),q=it(u.center.lat,-Ds,Ds),K=it(H.lat,-Ds,Ds),$=lf(u.center.lng),ie=uf(q);let me=$-lf(H.lng);const Me=ie-uf(K);me>.5?me-=1:me<-.5&&(me+=1);let Ve=0;Math.abs(me)>Math.abs(Me)?Ve=me>=0?1:3:(Ve=Me>=0?0:2,qp(U,U,[m[4]*f,m[5]*f,m[6]*f],-Math.sin(De(Me>=0?v.getSouth():v.getNorth()))*of));const Se=E[Ve],ze=E[(Ve+1)%4],Ze=new S0(Se,ze,U),qe=[Ey(Ze,0)||Se[0],Ey(Ze,1)||Se[1],Ey(Ze,2)||Se[2]],It=km(u.zoom);if(It>0){const bt=function({x:pn,y:At,z:Yt},$t,hn,gn,Lt){const Dn=1/(1<<Yt);let Ai=pn*Dn,jn=Ai+Dn,ai=At*Dn,Nn=ai+Dn,Li=0;const Cr=(Ai+jn)/2-gn;return Cr>.5?Li=-1:Cr<-.5&&(Li=1),Ai=((Ai+Li)*$t-(gn*=$t))*hn+gn,jn=((jn+Li)*$t-gn)*hn+gn,ai=(ai*$t-(Lt*=$t))*hn+Lt,Nn=(Nn*$t-Lt)*hn+Lt,[[Ai,Nn,0],[jn,Nn,0],[jn,ai,0],[Ai,ai,0]]}(c,o,u._pixelsPerMercatorPixel,$,ie);for(let pn=0;pn<E.length;pn++)af(E[pn],bt[pn],It);const Vt=ph([],bt[Ve],bt[(Ve+1)%4]);Il(Vt,Vt,.5),af(qe,Vt,It)}for(const bt of E)rf(R,R,bt),Vi(M,M,bt);return R[2]=Math.min(Se[2],ze[2]),rf(R,R,qe),Vi(M,M,qe),new wl(R,M)}function Iy({x:u,y:o,z:c}){const f=1/(1<<c),m=new kr(Zu(u*f),Fa((o+1)*f)),v=new kr(Zu((u+1)*f),Fa(o*f));return new fh(m,v)}function Ty(u){const o=De(u.getNorth()),c=De(u.getSouth()),f=Math.cos(o),m=Math.cos(c),v=Math.sin(o),E=Math.sin(c),S=u.getWest(),M=u.getEast();return[Om(m,E,S),Om(m,E,M),Om(f,v,M),Om(f,v,S)]}function Om(u,o,c,f=of){return c=De(c),[u*Math.sin(c)*f,-o*f,u*Math.cos(c)*f]}function Nm(u,o,c){return Om(Math.cos(De(u)),Math.sin(De(u)),o,c)}function Wg(u,o,c,f){const m=1<<c.z,v=(u/Mi+c.x)/m;return Nm(Fa((o/Mi+c.y)/m),Zu(v),f)}function wy({min:u,max:o}){return 16383/Math.max(o[0]-u[0],o[1]-u[1],o[2]-u[2])}const Vb=new Float64Array(16);function Xg(u){const o=wy(u),c=b0(Vb,[o,o,o]);return zg(c,c,((f=[])[0]=-(m=u.min)[0],f[1]=-m[1],f[2]=-m[2],f));var f,m}function A0(u){const o=(f=u.min,(c=Vb)[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=f[0],c[13]=f[1],c[14]=f[2],c[15]=1,c);var c,f;const m=1/wy(u);return qd(o,o,[m,m,m])}function Gb(u,o,c,f,m){const v=function(M){const R=Mi/(2*Math.PI);return M/(2*Math.PI)/R}(c),E=[u,o,-c/(2*Math.PI)],S=_u(new Float64Array(16));return zg(S,S,E),qd(S,S,[v,v,v]),dh(S,S,De(-m)),Ug(S,S,De(-f)),S}function km(u){return Et(5,6,u)}function Hb(u,o){const c=Nm(o.lat,o.lng),f=function($){const ie=Nm($._center.lat,$._center.lng);let me=Hg([],Wd(0,1,0),ie);const Me=Db([],-$.angle,ie);me=uo(me,me,Me),Db(Me,-$._pitch,me);const Ve=Bo([],ie);return Il(Ve,Ve,qg($.cameraToCenterDistance/$.pixelsPerMeter)),uo(Ve,Ve,Me),ph([],ie,Ve)}(u);return E=(m=Vg([],f,c))[0],S=m[1],M=m[2],R=(v=c)[0],U=v[1],H=v[2],K=(q=Math.sqrt(E*E+S*S+M*M)*Math.sqrt(R*R+U*U+H*H))&&Mc(m,v)/q,Math.acos(Math.min(Math.max(K,-1),1));var m,v,E,S,M,R,U,H,q,K}function M0(u,o){return Hb(u,o)>Math.PI/2*1.01}const L0=De(85),jb=Math.cos(L0),qb=Math.sin(L0),Zg=63710088e-1,Wb=2*Math.PI*Zg;class kr{constructor(o,c){if(isNaN(o)||isNaN(c))throw new Error(`Invalid LngLat object: (${o}, ${c})`);if(this.lng=+o,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new kr(Ue(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(o){const c=Math.PI/180,f=this.lat*c,m=o.lat*c,v=Math.sin(f)*Math.sin(m)+Math.cos(f)*Math.cos(m)*Math.cos((o.lng-this.lng)*c);return Zg*Math.acos(Math.min(v,1))}toBounds(o=0){const c=360*o/40075017,f=c/Math.cos(Math.PI/180*this.lat);return new fh(new kr(this.lng-f,this.lat-c),new kr(this.lng+f,this.lat+c))}toEcef(o){const c=qg(o);return Nm(this.lat,this.lng,of+c)}static convert(o){if(o instanceof kr)return o;if(Array.isArray(o)&&(o.length===2||o.length===3))return new kr(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&typeof o=="object"&&o!==null)return new kr(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}function Sy(u){return Wb*Math.cos(u*Math.PI/180)}function lf(u){return(180+u)/360}function uf(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function yh(u,o){return u/Sy(o)}function Zu(u){return 360*u-180}function Fa(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function Xb(u,o){return u*Sy(Fa(o))}const Ds=85.051129;function Zb(u){return 1/Math.cos(u*Math.PI/180)}class Fm{constructor(o,c,f=0){this.x=+o,this.y=+c,this.z=+f}static fromLngLat(o,c=0){const f=kr.convert(o);return new Fm(lf(f.lng),uf(f.lat),yh(c,f.lat))}toLngLat(){return new kr(Zu(this.x),Fa(this.y))}toAltitude(){return Xb(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Wb*Zb(Fa(this.y))}}function R0(u,o,c,f,m,v,E,S,M){const R=(o+f)/2,U=(c+m)/2,H=new J(R,U);S(H),function(q,K,$,ie,me,Me){const Ve=$-me,Se=ie-Me;return Math.abs((ie-K)*Ve-($-q)*Se)/Math.hypot(Ve,Se)}(H.x,H.y,v.x,v.y,E.x,E.y)>=M?(R0(u,o,c,R,U,v,H,S,M),R0(u,R,U,f,m,H,E,S,M)):u.push(E)}function P0(u,o,c){let f=u[0],m=f.x,v=f.y;o(f);const E=[f];for(let S=1;S<u.length;S++){const M=u[S],{x:R,y:U}=M;o(M),R0(E,m,v,R,U,f,M,o,c),m=R,v=U,f=M}return E}function D0(u,o,c,f){if(f(o,c)){const m=o.add(c)._mult(.5);D0(u,o,m,f),D0(u,m,c,f)}else u.push(c)}function kI(u,o){let c=u[0];const f=[c];for(let m=1;m<u.length;m++){const v=u[m];D0(f,c,v,o),c=v}return f}const O0=Math.pow(2,14)-1,Yb=-O0-1;function N0(u,o){const c=Math.round(u.x*o),f=Math.round(u.y*o);return u.x=it(c,Yb,O0),u.y=it(f,Yb,O0),(c<u.x||c>u.x+1||f<u.y||f>u.y+1)&&Zn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),u}function td(u,o,c){const f=u.loadGeometry(),m=u.extent,v=Mi/m;if(o&&c&&c.projection.isReprojectedInTileSpace){const E=1<<o.z,{scale:S,x:M,y:R,projection:U}=c,H=q=>{const K=Zu((o.x+q.x/m)/E),$=Fa((o.y+q.y/m)/E),ie=U.project(K,$);q.x=(ie.x*S-M)*m,q.y=(ie.y*S-R)*m};for(let q=0;q<f.length;q++)if(u.type!==1)f[q]=P0(f[q],H,1);else{const K=[];for(const $ of f[q])$.x<0||$.x>=m||$.y<0||$.y>=m||(H($),K.push($));f[q]=K}}for(const E of f)for(const S of E)N0(S,v);return f}function Yp(u,o){return{type:u.type,id:u.id,properties:u.properties,geometry:o?td(u):[]}}function Cy(u,o,c,f,m){u.emplaceBack(2*o+(f+1)/2,2*c+(m+1)/2)}function Ay(u,o,c){u.emplaceBack(o.x,o.y,o.z,c[0]*16384,c[1]*16384,c[2]*16384)}class k0{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.id),this.index=o.index,this.hasPattern=!1,this.projection=o.projection,this.layoutVertexArray=new bi,this.indexArray=new _a,this.segments=new Qs,this.programConfigurations=new Ac(o.layers,o.zoom),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(o,c,f,m){const v=this.layers[0],E=[];let S=null;v.type==="circle"&&(S=v.layout.get("circle-sort-key"));for(const{feature:R,id:U,index:H,sourceLayerIndex:q}of o){const K=this.layers[0]._featureFilter.needGeometry,$=Yp(R,K);if(!this.layers[0]._featureFilter.filter(new ft(this.zoom),$,f))continue;const ie=S?S.evaluate($,{},f):void 0,me={id:U,properties:R.properties,type:R.type,sourceLayerIndex:q,index:H,geometry:K?$.geometry:td(R,f,m),patterns:{},sortKey:ie};E.push(me)}S&&E.sort((R,U)=>R.sortKey-U.sortKey);let M=null;m.projection.name==="globe"&&(this.globeExtVertexArray=new du,M=m.projection);for(const R of E){const{geometry:U,index:H,sourceLayerIndex:q}=R,K=o[H].feature;this.addFeature(R,U,H,c.availableImages,f,M),c.featureIndex.insert(K,U,H,q,this.index)}}update(o,c,f,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,c,this.stateDependentLayers,f,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Lb.members),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,Rb.members))),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(o,c,f,m,v,E){for(const S of c)for(const M of S){const R=M.x,U=M.y;if(R<0||R>=Mi||U<0||U>=Mi)continue;if(E){const K=E.projectTilePoint(R,U,v),$=E.upVector(v,R,U),ie=this.globeExtVertexArray;Ay(ie,K,$),Ay(ie,K,$),Ay(ie,K,$),Ay(ie,K,$)}const H=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,o.sortKey),q=H.vertexLength;Cy(this.layoutVertexArray,R,U,-1,-1),Cy(this.layoutVertexArray,R,U,1,-1),Cy(this.layoutVertexArray,R,U,1,1),Cy(this.layoutVertexArray,R,U,-1,1),this.indexArray.emplaceBack(q,q+1,q+2),this.indexArray.emplaceBack(q,q+2,q+3),H.vertexLength+=4,H.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,{},m,v)}}function Kb(u,o){for(let c=0;c<u.length;c++)if(Kp(o,u[c]))return!0;for(let c=0;c<o.length;c++)if(Kp(u,o[c]))return!0;return!!F0(u,o)}function FI(u,o,c){return!!Kp(u,o)||!!B0(o,u,c)}function Jb(u,o){if(u.length===1)return $b(o,u[0]);for(let c=0;c<o.length;c++){const f=o[c];for(let m=0;m<f.length;m++)if(Kp(u,f[m]))return!0}for(let c=0;c<u.length;c++)if($b(o,u[c]))return!0;for(let c=0;c<o.length;c++)if(F0(u,o[c]))return!0;return!1}function BI(u,o,c){if(u.length>1){if(F0(u,o))return!0;for(let f=0;f<o.length;f++)if(B0(o[f],u,c))return!0}for(let f=0;f<u.length;f++)if(B0(u[f],o,c))return!0;return!1}function F0(u,o){if(u.length===0||o.length===0)return!1;for(let c=0;c<u.length-1;c++){const f=u[c],m=u[c+1];for(let v=0;v<o.length-1;v++)if(zI(f,m,o[v],o[v+1]))return!0}return!1}function zI(u,o,c,f){return mi(u,c,f)!==mi(o,c,f)&&mi(u,o,c)!==mi(u,o,f)}function B0(u,o,c){const f=c*c;if(o.length===1)return u.distSqr(o[0])<f;for(let m=1;m<o.length;m++)if(Qb(u,o[m-1],o[m])<f)return!0;return!1}function Qb(u,o,c){const f=o.distSqr(c);if(f===0)return u.distSqr(o);const m=((u.x-o.x)*(c.x-o.x)+(u.y-o.y)*(c.y-o.y))/f;return u.distSqr(m<0?o:m>1?c:c.sub(o)._mult(m)._add(o))}function $b(u,o){let c,f,m,v=!1;for(let E=0;E<u.length;E++){c=u[E];for(let S=0,M=c.length-1;S<c.length;M=S++)f=c[S],m=c[M],f.y>o.y!=m.y>o.y&&o.x<(m.x-f.x)*(o.y-f.y)/(m.y-f.y)+f.x&&(v=!v)}return v}function Kp(u,o){let c=!1;for(let f=0,m=u.length-1;f<u.length;m=f++){const v=u[f],E=u[m];v.y>o.y!=E.y>o.y&&o.x<(E.x-v.x)*(o.y-v.y)/(E.y-v.y)+v.x&&(c=!c)}return c}function ex(u,o,c,f,m){for(const E of u)if(o<=E.x&&c<=E.y&&f>=E.x&&m>=E.y)return!0;const v=[new J(o,c),new J(o,m),new J(f,m),new J(f,c)];if(u.length>2){for(const E of v)if(Kp(u,E))return!0}for(let E=0;E<u.length-1;E++)if(UI(u[E],u[E+1],v))return!0;return!1}function UI(u,o,c){const f=c[0],m=c[2];if(u.x<f.x&&o.x<f.x||u.x>m.x&&o.x>m.x||u.y<f.y&&o.y<f.y||u.y>m.y&&o.y>m.y)return!1;const v=mi(u,o,c[0]);return v!==mi(u,o,c[1])||v!==mi(u,o,c[2])||v!==mi(u,o,c[3])}function Bm(u,o,c){const f=o.paint.get(u).value;return f.kind==="constant"?f.value:c.programConfigurations.get(o.id).getMaxValue(u)}function My(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function tx(u,o,c,f,m){if(!o[0]&&!o[1])return u;const v=J.convert(o)._mult(m);c==="viewport"&&v._rotate(-f);const E=[];for(let S=0;S<u.length;S++)E.push(u[S].sub(v));return E}function Ly(u,o,c,f){const m=J.convert(u)._mult(f);return o==="viewport"&&m._rotate(-c),m}Gn(k0,"CircleBucket",{omit:["layers"]});const nx=new ln({"circle-sort-key":new Tt(Rt.layout_circle["circle-sort-key"])});var VI={paint:new ln({"circle-radius":new Tt(Rt.paint_circle["circle-radius"]),"circle-color":new Tt(Rt.paint_circle["circle-color"]),"circle-blur":new Tt(Rt.paint_circle["circle-blur"]),"circle-opacity":new Tt(Rt.paint_circle["circle-opacity"]),"circle-translate":new ht(Rt.paint_circle["circle-translate"]),"circle-translate-anchor":new ht(Rt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ht(Rt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ht(Rt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Tt(Rt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Tt(Rt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Tt(Rt.paint_circle["circle-stroke-opacity"])}),layout:nx};function ix(u,o,c,f,m,v,E,S,M){if(v&&u.queryGeometry.isAboveHorizon)return!1;v&&(M*=u.pixelToTileUnitsFactor);const R=u.tileID.canonical,U=c.projection.upVectorScale(R,c.center.lat,c.worldSize).metersToTile;for(const H of o)for(const q of H){const K=q.add(S),$=m&&c.elevation?c.elevation.exaggeration()*m.getElevationAt(K.x,K.y,!0):0,ie=c.projection.projectTilePoint(K.x,K.y,R);if($>0){const Se=c.projection.upVector(R,K.x,K.y);ie.x+=Se[0]*U*$,ie.y+=Se[1]*U*$,ie.z+=Se[2]*U*$}const me=v?K:GI(ie.x,ie.y,ie.z,f),Me=v?u.tilespaceRays.map(Se=>jI(Se,$)):u.queryGeometry.screenGeometry,Ve=Wp([],[ie.x,ie.y,ie.z,1],f);if(!E&&v?M*=Ve[3]/c.cameraToCenterDistance:E&&!v&&(M*=c.cameraToCenterDistance/Ve[3]),v){const Se=Fa((q.y/Mi+R.y)/(1<<R.z));M/=c.projection.pixelsPerMeter(Se,1)/yh(1,Se)}if(FI(Me,me,M))return!0}return!1}function GI(u,o,c,f){const m=Wp([],[u,o,c,1],f);return new J(m[0]/m[3],m[1]/m[3])}const rx=Wd(0,0,0),HI=Wd(0,0,1);function jI(u,o){const c=x0();return rx[2]=o,u.intersectsPlane(rx,HI,c),new J(c[0],c[1])}class sx extends k0{}function ox(u,{width:o,height:c},f,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==o*c*f)throw new RangeError("mismatched image size")}else m=new Uint8Array(o*c*f);return u.width=o,u.height=c,u.data=m,u}function z0(u,o,c){const{width:f,height:m}=o;f===u.width&&m===u.height||(U0(u,o,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,f),height:Math.min(u.height,m)},c),u.width=f,u.height=m,u.data=o.data)}function U0(u,o,c,f,m,v){if(m.width===0||m.height===0)return o;if(m.width>u.width||m.height>u.height||c.x>u.width-m.width||c.y>u.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>o.width||m.height>o.height||f.x>o.width-m.width||f.y>o.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const E=u.data,S=o.data;for(let M=0;M<m.height;M++){const R=((c.y+M)*u.width+c.x)*v,U=((f.y+M)*o.width+f.x)*v;for(let H=0;H<m.width*v;H++)S[U+H]=E[R+H]}return o}Gn(sx,"HeatmapBucket",{omit:["layers"]});class Rc{constructor(o,c){ox(this,o,1,c)}resize(o){z0(this,new Rc(o),1)}clone(){return new Rc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,c,f,m,v){U0(o,c,f,m,v,1)}}class yu{constructor(o,c){ox(this,o,4,c)}resize(o){z0(this,new yu(o),4)}replace(o,c){c?this.data.set(o):this.data=o instanceof Uint8ClampedArray?new Uint8Array(o.buffer):o}clone(){return new yu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,c,f,m,v){U0(o,c,f,m,v,4)}}Gn(Rc,"AlphaImage"),Gn(yu,"RGBAImage");var qI={paint:new ln({"heatmap-radius":new Tt(Rt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Tt(Rt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ht(Rt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new en(Rt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ht(Rt.paint_heatmap["heatmap-opacity"])})};function V0(u){const o={},c=u.resolution||256,f=u.clips?u.clips.length:1,m=u.image||new yu({width:c,height:f}),v=(E,S,M)=>{o[u.evaluationKey]=M;const R=u.expression.evaluate(o);m.data[E+S+0]=Math.floor(255*R.r/R.a),m.data[E+S+1]=Math.floor(255*R.g/R.a),m.data[E+S+2]=Math.floor(255*R.b/R.a),m.data[E+S+3]=Math.floor(255*R.a)};if(u.clips)for(let E=0,S=0;E<f;++E,S+=4*c)for(let M=0,R=0;M<c;M++,R+=4){const U=M/(c-1),{start:H,end:q}=u.clips[E];v(S,R,H*(1-U)+q*U)}else for(let E=0,S=0;E<c;E++,S+=4)v(0,S,E/(c-1));return m}var WI={paint:new ln({"hillshade-illumination-direction":new ht(Rt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ht(Rt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ht(Rt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ht(Rt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ht(Rt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ht(Rt.paint_hillshade["hillshade-accent-color"])})};const XI=di([{name:"a_pos",components:2,type:"Int16"}],4),{members:ZI}=XI;var zm={};function Ry(u,o,c){c=c||2;var f,m,v,E,S,M,R,U=o&&o.length,H=U?o[0]*c:u.length,q=ax(u,0,H,c,!0),K=[];if(!q||q.next===q.prev)return K;if(U&&(q=function(ie,me,Me,Ve){var Se,ze,Ze,qe=[];for(Se=0,ze=me.length;Se<ze;Se++)(Ze=ax(ie,me[Se]*Ve,Se<ze-1?me[Se+1]*Ve:ie.length,Ve,!1))===Ze.next&&(Ze.steiner=!0),qe.push(eT(Ze));for(qe.sort($I),Se=0;Se<qe.length;Se++)Me=lx(qe[Se],Me);return Me}(u,o,q,c)),u.length>80*c){f=v=u[0],m=E=u[1];for(var $=c;$<H;$+=c)(S=u[$])<f&&(f=S),(M=u[$+1])<m&&(m=M),S>v&&(v=S),M>E&&(E=M);R=(R=Math.max(v-f,E-m))!==0?32767/R:0}return Yg(q,K,c,f,m,R,0),K}function ax(u,o,c,f,m){var v,E;if(m===j0(u,o,c,f)>0)for(v=o;v<c;v+=f)E=fx(v,u[v],u[v+1],E);else for(v=c-f;v>=o;v-=f)E=fx(v,u[v],u[v+1],E);return E&&Py(E,E.next)&&(Jg(E),E=E.next),E}function Jp(u,o){if(!u)return u;o||(o=u);var c,f=u;do if(c=!1,f.steiner||!Py(f,f.next)&&$s(f.prev,f,f.next)!==0)f=f.next;else{if(Jg(f),(f=o=f.prev)===f.next)break;c=!0}while(c||f!==o);return o}function Yg(u,o,c,f,m,v,E){if(u){!E&&v&&function(U,H,q,K){var $=U;do $.z===0&&($.z=G0($.x,$.y,H,q,K)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next;while($!==U);$.prevZ.nextZ=null,$.prevZ=null,function(ie){var me,Me,Ve,Se,ze,Ze,qe,It,bt=1;do{for(Me=ie,ie=null,ze=null,Ze=0;Me;){for(Ze++,Ve=Me,qe=0,me=0;me<bt&&(qe++,Ve=Ve.nextZ);me++);for(It=bt;qe>0||It>0&&Ve;)qe!==0&&(It===0||!Ve||Me.z<=Ve.z)?(Se=Me,Me=Me.nextZ,qe--):(Se=Ve,Ve=Ve.nextZ,It--),ze?ze.nextZ=Se:ie=Se,Se.prevZ=ze,ze=Se;Me=Ve}ze.nextZ=null,bt*=2}while(Ze>1)}($)}(u,f,m,v);for(var S,M,R=u;u.prev!==u.next;)if(S=u.prev,M=u.next,v?KI(u,f,m,v):YI(u))o.push(S.i/c|0),o.push(u.i/c|0),o.push(M.i/c|0),Jg(u),u=M.next,R=M.next;else if((u=M)===R){E?E===1?Yg(u=JI(Jp(u),o,c),o,c,f,m,v,2):E===2&&QI(u,o,c,f,m,v):Yg(Jp(u),o,c,f,m,v,1);break}}}function YI(u){var o=u.prev,c=u,f=u.next;if($s(o,c,f)>=0)return!1;for(var m=o.x,v=c.x,E=f.x,S=o.y,M=c.y,R=f.y,U=m<v?m<E?m:E:v<E?v:E,H=S<M?S<R?S:R:M<R?M:R,q=m>v?m>E?m:E:v>E?v:E,K=S>M?S>R?S:R:M>R?M:R,$=f.next;$!==o;){if($.x>=U&&$.x<=q&&$.y>=H&&$.y<=K&&Um(m,S,v,M,E,R,$.x,$.y)&&$s($.prev,$,$.next)>=0)return!1;$=$.next}return!0}function KI(u,o,c,f){var m=u.prev,v=u,E=u.next;if($s(m,v,E)>=0)return!1;for(var S=m.x,M=v.x,R=E.x,U=m.y,H=v.y,q=E.y,K=S<M?S<R?S:R:M<R?M:R,$=U<H?U<q?U:q:H<q?H:q,ie=S>M?S>R?S:R:M>R?M:R,me=U>H?U>q?U:q:H>q?H:q,Me=G0(K,$,o,c,f),Ve=G0(ie,me,o,c,f),Se=u.prevZ,ze=u.nextZ;Se&&Se.z>=Me&&ze&&ze.z<=Ve;){if(Se.x>=K&&Se.x<=ie&&Se.y>=$&&Se.y<=me&&Se!==m&&Se!==E&&Um(S,U,M,H,R,q,Se.x,Se.y)&&$s(Se.prev,Se,Se.next)>=0||(Se=Se.prevZ,ze.x>=K&&ze.x<=ie&&ze.y>=$&&ze.y<=me&&ze!==m&&ze!==E&&Um(S,U,M,H,R,q,ze.x,ze.y)&&$s(ze.prev,ze,ze.next)>=0))return!1;ze=ze.nextZ}for(;Se&&Se.z>=Me;){if(Se.x>=K&&Se.x<=ie&&Se.y>=$&&Se.y<=me&&Se!==m&&Se!==E&&Um(S,U,M,H,R,q,Se.x,Se.y)&&$s(Se.prev,Se,Se.next)>=0)return!1;Se=Se.prevZ}for(;ze&&ze.z<=Ve;){if(ze.x>=K&&ze.x<=ie&&ze.y>=$&&ze.y<=me&&ze!==m&&ze!==E&&Um(S,U,M,H,R,q,ze.x,ze.y)&&$s(ze.prev,ze,ze.next)>=0)return!1;ze=ze.nextZ}return!0}function JI(u,o,c){var f=u;do{var m=f.prev,v=f.next.next;!Py(m,v)&&cx(m,f,f.next,v)&&Kg(m,v)&&Kg(v,m)&&(o.push(m.i/c|0),o.push(f.i/c|0),o.push(v.i/c|0),Jg(f),Jg(f.next),f=u=v),f=f.next}while(f!==u);return Jp(f)}function QI(u,o,c,f,m,v){var E=u;do{for(var S=E.next.next;S!==E.prev;){if(E.i!==S.i&&tT(E,S)){var M=hx(E,S);return E=Jp(E,E.next),M=Jp(M,M.next),Yg(E,o,c,f,m,v,0),void Yg(M,o,c,f,m,v,0)}S=S.next}E=E.next}while(E!==u)}function $I(u,o){return u.x-o.x}function lx(u,o){var c=function(m,v){var E,S=v,M=m.x,R=m.y,U=-1/0;do{if(R<=S.y&&R>=S.next.y&&S.next.y!==S.y){var H=S.x+(R-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(H<=M&&H>U&&(U=H,E=S.x<S.next.x?S:S.next,H===M))return E}S=S.next}while(S!==v);if(!E)return null;var q,K=E,$=E.x,ie=E.y,me=1/0;S=E;do M>=S.x&&S.x>=$&&M!==S.x&&Um(R<ie?M:U,R,$,ie,R<ie?U:M,R,S.x,S.y)&&(q=Math.abs(R-S.y)/(M-S.x),Kg(S,m)&&(q<me||q===me&&(S.x>E.x||S.x===E.x&&ux(E,S)))&&(E=S,me=q)),S=S.next;while(S!==K);return E}(u,o);if(!c)return o;var f=hx(c,u);return Jp(f,f.next),Jp(c,c.next)}function ux(u,o){return $s(u.prev,u,o.prev)<0&&$s(o.next,u,u.next)<0}function G0(u,o,c,f,m){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-c)*m|0)|u<<8))|u<<4))|u<<2))|u<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-f)*m|0)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function eT(u){var o=u,c=u;do(o.x<c.x||o.x===c.x&&o.y<c.y)&&(c=o),o=o.next;while(o!==u);return c}function Um(u,o,c,f,m,v,E,S){return(m-E)*(o-S)>=(u-E)*(v-S)&&(u-E)*(f-S)>=(c-E)*(o-S)&&(c-E)*(v-S)>=(m-E)*(f-S)}function tT(u,o){return u.next.i!==o.i&&u.prev.i!==o.i&&!function(c,f){var m=c;do{if(m.i!==c.i&&m.next.i!==c.i&&m.i!==f.i&&m.next.i!==f.i&&cx(m,m.next,c,f))return!0;m=m.next}while(m!==c);return!1}(u,o)&&(Kg(u,o)&&Kg(o,u)&&function(c,f){var m=c,v=!1,E=(c.x+f.x)/2,S=(c.y+f.y)/2;do m.y>S!=m.next.y>S&&m.next.y!==m.y&&E<(m.next.x-m.x)*(S-m.y)/(m.next.y-m.y)+m.x&&(v=!v),m=m.next;while(m!==c);return v}(u,o)&&($s(u.prev,u,o.prev)||$s(u,o.prev,o))||Py(u,o)&&$s(u.prev,u,u.next)>0&&$s(o.prev,o,o.next)>0)}function $s(u,o,c){return(o.y-u.y)*(c.x-o.x)-(o.x-u.x)*(c.y-o.y)}function Py(u,o){return u.x===o.x&&u.y===o.y}function cx(u,o,c,f){var m=Oy($s(u,o,c)),v=Oy($s(u,o,f)),E=Oy($s(c,f,u)),S=Oy($s(c,f,o));return m!==v&&E!==S||!(m!==0||!Dy(u,c,o))||!(v!==0||!Dy(u,f,o))||!(E!==0||!Dy(c,u,f))||!(S!==0||!Dy(c,o,f))}function Dy(u,o,c){return o.x<=Math.max(u.x,c.x)&&o.x>=Math.min(u.x,c.x)&&o.y<=Math.max(u.y,c.y)&&o.y>=Math.min(u.y,c.y)}function Oy(u){return u>0?1:u<0?-1:0}function Kg(u,o){return $s(u.prev,u,u.next)<0?$s(u,o,u.next)>=0&&$s(u,u.prev,o)>=0:$s(u,o,u.prev)<0||$s(u,u.next,o)<0}function hx(u,o){var c=new H0(u.i,u.x,u.y),f=new H0(o.i,o.x,o.y),m=u.next,v=o.prev;return u.next=o,o.prev=u,c.next=m,m.prev=c,f.next=c,c.prev=f,v.next=f,f.prev=v,f}function fx(u,o,c,f){var m=new H0(u,o,c);return f?(m.next=f.next,m.prev=f,f.next.prev=m,f.next=m):(m.prev=m,m.next=m),m}function Jg(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function H0(u,o,c){this.i=u,this.x=o,this.y=c,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function j0(u,o,c,f){for(var m=0,v=o,E=c-f;v<c;v+=f)m+=(u[E]-u[v])*(u[v+1]+u[E+1]),E=v;return m}function nT(u,o,c,f,m){Qg(u,o,c||0,f||u.length-1,m||dx)}function Qg(u,o,c,f,m){for(;f>c;){if(f-c>600){var v=f-c+1,E=o-c+1,S=Math.log(v),M=.5*Math.exp(2*S/3),R=.5*Math.sqrt(S*M*(v-M)/v)*(E-v/2<0?-1:1);Qg(u,o,Math.max(c,Math.floor(o-E*M/v+R)),Math.min(f,Math.floor(o+(v-E)*M/v+R)),m)}var U=u[o],H=c,q=f;for($g(u,c,o),m(u[f],U)>0&&$g(u,c,f);H<q;){for($g(u,H,q),H++,q--;m(u[H],U)<0;)H++;for(;m(u[q],U)>0;)q--}m(u[c],U)===0?$g(u,c,q):$g(u,++q,f),q<=o&&(c=q+1),o<=q&&(f=q-1)}}function $g(u,o,c){var f=u[o];u[o]=u[c],u[c]=f}function dx(u,o){return u<o?-1:u>o?1:0}function Ny(u,o){const c=u.length;if(c<=1)return[u];const f=[];let m,v;for(let E=0;E<c;E++){const S=yn(u[E]);S!==0&&(u[E].area=Math.abs(S),v===void 0&&(v=S<0),v===S<0?(m&&f.push(m),m=[u[E]]):m.push(u[E]))}if(m&&f.push(m),o>1)for(let E=0;E<f.length;E++)f[E].length<=o||(nT(f[E],o,1,f[E].length-1,q0),f[E]=f[E].slice(0,o));return f}function q0(u,o){return o.area-u.area}function ky(u,o,c){const f=c.patternDependencies;let m=!1;for(const v of o){const E=v.paint.get(`${u}-pattern`);E.isConstant()||(m=!0);const S=E.constantOr(null);S&&(m=!0,f[S]=!0)}return m}function Fy(u,o,c,f,m){const v=m.patternDependencies;for(const E of o){const S=E.paint.get(`${u}-pattern`).value;if(S.kind!=="constant"){let M=S.evaluate({zoom:f},c,{},m.availableImages);M=M&&M.name?M.name:M,v[M]=!0,c.patterns[E.id]=M}}return c}({get exports(){return zm},set exports(u){zm=u}}).exports=Ry,zm.default=Ry,Ry.deviation=function(u,o,c,f){var m=o&&o.length,v=Math.abs(j0(u,0,m?o[0]*c:u.length,c));if(m)for(var E=0,S=o.length;E<S;E++)v-=Math.abs(j0(u,o[E]*c,E<S-1?o[E+1]*c:u.length,c));var M=0;for(E=0;E<f.length;E+=3){var R=f[E]*c,U=f[E+1]*c,H=f[E+2]*c;M+=Math.abs((u[R]-u[H])*(u[U+1]-u[R+1])-(u[R]-u[U])*(u[H+1]-u[R+1]))}return v===0&&M===0?0:Math.abs((M-v)/v)},Ry.flatten=function(u){for(var o=u[0][0].length,c={vertices:[],holes:[],dimensions:o},f=0,m=0;m<u.length;m++){for(var v=0;v<u[m].length;v++)for(var E=0;E<o;E++)c.vertices.push(u[m][v][E]);m>0&&c.holes.push(f+=u[m-1].length)}return c};class e_{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.id),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new bi,this.indexArray=new _a,this.indexArray2=new nf,this.programConfigurations=new Ac(o.layers,o.zoom),this.segments=new Qs,this.segments2=new Qs,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.projection=o.projection}populate(o,c,f,m){this.hasPattern=ky("fill",this.layers,c);const v=this.layers[0].layout.get("fill-sort-key"),E=[];for(const{feature:S,id:M,index:R,sourceLayerIndex:U}of o){const H=this.layers[0]._featureFilter.needGeometry,q=Yp(S,H);if(!this.layers[0]._featureFilter.filter(new ft(this.zoom),q,f))continue;const K=v?v.evaluate(q,{},f,c.availableImages):void 0,$={id:M,properties:S.properties,type:S.type,sourceLayerIndex:U,index:R,geometry:H?q.geometry:td(S,f,m),patterns:{},sortKey:K};E.push($)}v&&E.sort((S,M)=>S.sortKey-M.sortKey);for(const S of E){const{geometry:M,index:R,sourceLayerIndex:U}=S;if(this.hasPattern){const H=Fy("fill",this.layers,S,this.zoom,c);this.patternFeatures.push(H)}else this.addFeature(S,M,R,f,{},c.availableImages);c.featureIndex.insert(o[R].feature,M,R,U,this.index)}}update(o,c,f,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,c,this.stateDependentLayers,f,m)}addFeatures(o,c,f,m,v){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,c,f,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,ZI),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.indexBuffer2=o.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(o,c,f,m,v,E=[]){for(const S of Ny(c,500)){let M=0;for(const $ of S)M+=$.length;const R=this.segments.prepareSegment(M,this.layoutVertexArray,this.indexArray),U=R.vertexLength,H=[],q=[];for(const $ of S){if($.length===0)continue;$!==S[0]&&q.push(H.length/2);const ie=this.segments2.prepareSegment($.length,this.layoutVertexArray,this.indexArray2),me=ie.vertexLength;this.layoutVertexArray.emplaceBack($[0].x,$[0].y),this.indexArray2.emplaceBack(me+$.length-1,me),H.push($[0].x),H.push($[0].y);for(let Me=1;Me<$.length;Me++)this.layoutVertexArray.emplaceBack($[Me].x,$[Me].y),this.indexArray2.emplaceBack(me+Me-1,me+Me),H.push($[Me].x),H.push($[Me].y);ie.vertexLength+=$.length,ie.primitiveLength+=$.length}const K=zm(H,q);for(let $=0;$<K.length;$+=3)this.indexArray.emplaceBack(U+K[$],U+K[$+1],U+K[$+2]);R.vertexLength+=M,R.primitiveLength+=K.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,v,E,m)}}Gn(e_,"FillBucket",{omit:["layers","patternFeatures"]});const px=new ln({"fill-sort-key":new Tt(Rt.layout_fill["fill-sort-key"])});var iT={paint:new ln({"fill-antialias":new ht(Rt.paint_fill["fill-antialias"]),"fill-opacity":new Tt(Rt.paint_fill["fill-opacity"]),"fill-color":new Tt(Rt.paint_fill["fill-color"]),"fill-outline-color":new Tt(Rt.paint_fill["fill-outline-color"]),"fill-translate":new ht(Rt.paint_fill["fill-translate"]),"fill-translate-anchor":new ht(Rt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Tt(Rt.paint_fill["fill-pattern"])}),layout:px};const rT=di([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),sT=di([{name:"a_centroid_pos",components:2,type:"Uint16"}]),By=di([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:zy}=rT;var Uy={},oT=J,Vy=Qp;function Qp(u,o,c,f,m){this.properties={},this.extent=c,this.type=0,this._pbf=u,this._geometry=-1,this._keys=f,this._values=m,u.readFields(aT,this,o)}function aT(u,o,c){u==1?o.id=c.readVarint():u==2?function(f,m){for(var v=f.readVarint()+f.pos;f.pos<v;){var E=m._keys[f.readVarint()],S=m._values[f.readVarint()];m.properties[E]=S}}(c,o):u==3?o.type=c.readVarint():u==4&&(o._geometry=c.pos)}function lT(u){for(var o,c,f=0,m=0,v=u.length,E=v-1;m<v;E=m++)f+=((c=u[E]).x-(o=u[m]).x)*(o.y+c.y);return f}Qp.types=["Unknown","Point","LineString","Polygon"],Qp.prototype.loadGeometry=function(){var u=this._pbf;u.pos=this._geometry;for(var o,c=u.readVarint()+u.pos,f=1,m=0,v=0,E=0,S=[];u.pos<c;){if(m<=0){var M=u.readVarint();f=7&M,m=M>>3}if(m--,f===1||f===2)v+=u.readSVarint(),E+=u.readSVarint(),f===1&&(o&&S.push(o),o=[]),o.push(new oT(v,E));else{if(f!==7)throw new Error("unknown command "+f);o&&o.push(o[0].clone())}}return o&&S.push(o),S},Qp.prototype.bbox=function(){var u=this._pbf;u.pos=this._geometry;for(var o=u.readVarint()+u.pos,c=1,f=0,m=0,v=0,E=1/0,S=-1/0,M=1/0,R=-1/0;u.pos<o;){if(f<=0){var U=u.readVarint();c=7&U,f=U>>3}if(f--,c===1||c===2)(m+=u.readSVarint())<E&&(E=m),m>S&&(S=m),(v+=u.readSVarint())<M&&(M=v),v>R&&(R=v);else if(c!==7)throw new Error("unknown command "+c)}return[E,M,S,R]},Qp.prototype.toGeoJSON=function(u,o,c){var f,m,v=this.extent*Math.pow(2,c),E=this.extent*u,S=this.extent*o,M=this.loadGeometry(),R=Qp.types[this.type];function U(K){for(var $=0;$<K.length;$++){var ie=K[$];K[$]=[360*(ie.x+E)/v-180,360/Math.PI*Math.atan(Math.exp((180-360*(ie.y+S)/v)*Math.PI/180))-90]}}switch(this.type){case 1:var H=[];for(f=0;f<M.length;f++)H[f]=M[f][0];U(M=H);break;case 2:for(f=0;f<M.length;f++)U(M[f]);break;case 3:for(M=function(K){var $=K.length;if($<=1)return[K];for(var ie,me,Me=[],Ve=0;Ve<$;Ve++){var Se=lT(K[Ve]);Se!==0&&(me===void 0&&(me=Se<0),me===Se<0?(ie&&Me.push(ie),ie=[K[Ve]]):ie.push(K[Ve]))}return ie&&Me.push(ie),Me}(M),f=0;f<M.length;f++)for(m=0;m<M[f].length;m++)U(M[f][m])}M.length===1?M=M[0]:R="Multi"+R;var q={type:"Feature",geometry:{type:R,coordinates:M},properties:this.properties};return"id"in this&&(q.id=this.id),q};var uT=Vy,mx=gx;function gx(u,o){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(cT,this,o),this.length=this._features.length}function cT(u,o,c){u===15?o.version=c.readVarint():u===1?o.name=c.readString():u===5?o.extent=c.readVarint():u===2?o._features.push(c.pos):u===3?o._keys.push(c.readString()):u===4&&o._values.push(function(f){for(var m=null,v=f.readVarint()+f.pos;f.pos<v;){var E=f.readVarint()>>3;m=E===1?f.readString():E===2?f.readFloat():E===3?f.readDouble():E===4?f.readVarint64():E===5?f.readVarint():E===6?f.readSVarint():E===7?f.readBoolean():null}return m}(c))}gx.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var o=this._pbf.readVarint()+this._pbf.pos;return new uT(this._pbf,o,this.extent,this._keys,this._values)};var hT=mx;function fT(u,o,c){if(u===3){var f=new hT(c,c.readVarint()+c.pos);f.length&&(o[f.name]=f)}}var W0=Uy.VectorTile=function(u,o){this.layers=u.readFields(fT,{},o)},Gy=Uy.VectorTileFeature=Vy;function Hy(u,o,c,f){const m=[],v=f===0?(E,S,M,R,U,H)=>{E.push(new J(H,M+(H-S)/(R-S)*(U-M)))}:(E,S,M,R,U,H)=>{E.push(new J(S+(H-M)/(U-M)*(R-S),H))};for(const E of u){const S=[];for(const M of E){if(M.length<=2)continue;const R=[];for(let q=0;q<M.length-1;q++){const K=M[q].x,$=M[q].y,ie=M[q+1].x,me=M[q+1].y,Me=f===0?K:$,Ve=f===0?ie:me;Me<o?Ve>o&&v(R,K,$,ie,me,o):Me>c?Ve<c&&v(R,K,$,ie,me,c):R.push(M[q]),Ve<o&&Me>=o&&v(R,K,$,ie,me,o),Ve>c&&Me<=c&&v(R,K,$,ie,me,c)}let U=M[M.length-1];const H=f===0?U.x:U.y;H>=o&&H<=c&&R.push(U),R.length&&(U=R[R.length-1],R[0].x===U.x&&R[0].y===U.y||R.push(R[0]),S.push(R))}S.length&&m.push(S)}return m}Uy.VectorTileLayer=mx;const dT=Gy.types,vh=Math.pow(2,13);function t_(u,o,c,f,m,v,E,S){u.emplaceBack((o<<1)+E,(c<<1)+v,(Math.floor(f*vh)<<1)+m,Math.round(S))}function n_(u,o,c){u.emplaceBack(o.x,o.y,o.z,c[0]*16384,c[1]*16384,c[2]*16384)}class Xd{constructor(){this.acc=new J(0,0),this.polyCount=[]}startRing(o){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new J(o.x,o.y),this.max=new J(o.x,o.y))}append(o,c){this.currentPolyCount.edges++,this.acc._add(o);const f=this.min,m=this.max;o.x<f.x?f.x=o.x:o.x>m.x&&(m.x=o.x),o.y<f.y?f.y=o.y:o.y>m.y&&(m.y=o.y),((o.x===0||o.x===Mi)&&o.x===c.x)!=((o.y===0||o.y===Mi)&&o.y===c.y)&&this.processBorderOverlap(o,c),c.x<0!=o.x<0&&this.addBorderIntersection(0,Zi(c.y,o.y,(0-c.x)/(o.x-c.x))),c.x>Mi!=o.x>Mi&&this.addBorderIntersection(1,Zi(c.y,o.y,(Mi-c.x)/(o.x-c.x))),c.y<0!=o.y<0&&this.addBorderIntersection(2,Zi(c.x,o.x,(0-c.y)/(o.y-c.y))),c.y>Mi!=o.y>Mi&&this.addBorderIntersection(3,Zi(c.x,o.x,(Mi-c.y)/(o.y-c.y)))}addBorderIntersection(o,c){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const f=this.borders[o];c<f[0]&&(f[0]=c),c>f[1]&&(f[1]=c)}processBorderOverlap(o,c){if(o.x===c.x){if(o.y===c.y)return;const f=o.x===0?0:1;this.addBorderIntersection(f,c.y),this.addBorderIntersection(f,o.y)}else{const f=o.y===0?2:3;this.addBorderIntersection(f,c.x),this.addBorderIntersection(f,o.x)}}centroid(){const o=this.polyCount.reduce((c,f)=>c+f.edges,0);return o!==0?this.acc.div(o)._round():new J(0,0)}span(){return new J(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((o,c)=>o+ +(c[0]!==Number.MAX_VALUE),0)}}class fr{constructor(o){this.zoom=o.zoom,this.canonical=o.canonical,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.id),this.index=o.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=o.projection,this.layoutVertexArray=new $r,this.centroidVertexArray=new cy,this.indexArray=new _a,this.programConfigurations=new Ac(o.layers,o.zoom),this.segments=new Qs,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.enableTerrain=o.enableTerrain}populate(o,c,f,m){this.features=[],this.hasPattern=ky("fill-extrusion",this.layers,c),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(v){const E=Math.exp(Math.PI*(1-v.y/(1<<v.z)*2));return 80150034*E/(E*E+1)/Mi/(1<<v.z)}(f),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:v,id:E,index:S,sourceLayerIndex:M}of o){const R=this.layers[0]._featureFilter.needGeometry,U=Yp(v,R);if(!this.layers[0]._featureFilter.filter(new ft(this.zoom),U,f))continue;const H={id:E,sourceLayerIndex:M,index:S,geometry:R?U.geometry:td(v,f,m),properties:v.properties,type:v.type,patterns:{}},q=this.layoutVertexArray.length;this.hasPattern?this.features.push(Fy("fill-extrusion",this.layers,H,this.zoom,c)):this.addFeature(H,H.geometry,S,f,{},c.availableImages,m),c.featureIndex.insert(v,H.geometry,S,M,this.index,q)}this.sortBorders()}addFeatures(o,c,f,m,v){for(const E of this.features){const{geometry:S}=E;this.addFeature(E,S,E.index,c,f,m,v)}this.sortBorders()}update(o,c,f,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,c,this.stateDependentLayers,f,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,zy),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=o.createVertexBuffer(this.layoutVertexExtArray,By.members,!0))),this.programConfigurations.upload(o),this.uploaded=!0}uploadCentroid(o){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=o.createVertexBuffer(this.centroidVertexArray,sT.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(o,c,f,m,v,E,S){const M=[new J(0,0),new J(Mi,Mi)],R=S.projection,U=R.name==="globe",H=this.enableTerrain&&!U?new Xd:null,q=dT[o.type]==="Polygon";U&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new du);const K=Ny(c,500);for(let Me=K.length-1;Me>=0;Me--){const Ve=K[Me];(Ve.length===0||($=Ve[0]).every(Se=>Se.x<=0)||$.every(Se=>Se.x>=Mi)||$.every(Se=>Se.y<=0)||$.every(Se=>Se.y>=Mi))&&K.splice(Me,1)}var $;let ie;if(U)ie=xx(K,M,m);else{ie=[];for(const Me of K)ie.push({polygon:Me,bounds:M})}const me=q?this.edgeRadius:0;for(const{polygon:Me,bounds:Ve}of ie){let Se=0,ze=0;for(const qe of Me)q&&!qe[0].equals(qe[qe.length-1])&&qe.push(qe[0]),ze+=q?qe.length-1:qe.length;const Ze=this.segments.prepareSegment((q?5:4)*ze,this.layoutVertexArray,this.indexArray);if(q){const qe=[],It=[];Se=Ze.vertexLength;for(const Vt of Me){let pn,At;Vt.length&&Vt!==Me[0]&&It.push(qe.length/2),pn=Vt[1].sub(Vt[0])._perp()._unit();for(let Yt=1;Yt<Vt.length;Yt++){const $t=Vt[Yt],hn=Vt[Yt===Vt.length-1?1:Yt+1];let{x:gn,y:Lt}=$t;if(me){At=hn.sub($t)._perp()._unit();const Dn=pn.add(At)._unit(),Ai=me*Math.min(4,1/(pn.x*Dn.x+pn.y*Dn.y));gn+=Ai*Dn.x,Lt+=Ai*Dn.y,pn=At}t_(this.layoutVertexArray,gn,Lt,0,0,1,1,0),Ze.vertexLength++,qe.push($t.x,$t.y),U&&n_(this.layoutVertexExtArray,R.projectTilePoint(gn,Lt,m),R.upVector(m,gn,Lt))}}const bt=zm(qe,It);for(let Vt=0;Vt<bt.length;Vt+=3)this.indexArray.emplaceBack(Se+bt[Vt],Se+bt[Vt+2],Se+bt[Vt+1]),Ze.primitiveLength++}for(const qe of Me){H&&qe.length&&H.startRing(qe[0]);let It,bt,Vt,pn=qe.length>4&&nd(qe[qe.length-2],qe[0],qe[1]),At=me?vu(qe[qe.length-2],qe[0],qe[1],me):0;bt=qe[1].sub(qe[0])._perp()._unit();let Yt=!0;for(let $t=1,hn=0;$t<qe.length;$t++){let gn=qe[$t-1],Lt=qe[$t];const Dn=qe[$t===qe.length-1?1:$t+1];if(H&&q&&H.currentPolyCount.top++,yx(Lt,gn,Ve)){me&&(bt=Dn.sub(Lt)._perp()._unit(),Yt=!Yt);continue}H&&H.append(Lt,gn);const Ai=Lt.sub(gn)._perp(),jn=Ai.x/(Math.abs(Ai.x)+Math.abs(Ai.y)),ai=Ai.y>0?1:0,Nn=gn.dist(Lt);if(hn+Nn>32768&&(hn=0),me){Vt=Dn.sub(Lt)._perp()._unit();let br=zo(gn,Lt,Dn,_x(bt,Vt),me);isNaN(br)&&(br=0);const Ni=Lt.sub(gn)._unit();gn=gn.add(Ni.mult(At))._round(),Lt=Lt.add(Ni.mult(-br))._round(),At=br,bt=Vt}const Li=Ze.vertexLength,Cr=qe.length>4&&nd(gn,Lt,Dn);let Tr=vx(hn,pn,Yt);if(t_(this.layoutVertexArray,gn.x,gn.y,jn,ai,0,0,Tr),t_(this.layoutVertexArray,gn.x,gn.y,jn,ai,0,1,Tr),hn+=Nn,Tr=vx(hn,Cr,!Yt),pn=Cr,t_(this.layoutVertexArray,Lt.x,Lt.y,jn,ai,0,0,Tr),t_(this.layoutVertexArray,Lt.x,Lt.y,jn,ai,0,1,Tr),Ze.vertexLength+=4,this.indexArray.emplaceBack(Li+0,Li+1,Li+2),this.indexArray.emplaceBack(Li+1,Li+3,Li+2),Ze.primitiveLength+=2,me){const br=Se+($t===1?qe.length-2:$t-2),Ni=$t===1?Se:br+1;if(this.indexArray.emplaceBack(Li+1,br,Li+3),this.indexArray.emplaceBack(br,Ni,Li+3),Ze.primitiveLength+=2,It===void 0&&(It=Li),!yx(Dn,qe[$t],Ve)){const gs=$t===qe.length-1?It:Ze.vertexLength;this.indexArray.emplaceBack(Li+2,Li+3,gs),this.indexArray.emplaceBack(Li+3,gs+1,gs),this.indexArray.emplaceBack(Li+3,Ni,gs+1),Ze.primitiveLength+=3}Yt=!Yt}if(U){const br=this.layoutVertexExtArray,Ni=R.projectTilePoint(gn.x,gn.y,m),gs=R.projectTilePoint(Lt.x,Lt.y,m),Ji=R.upVector(m,gn.x,gn.y),Ar=R.upVector(m,Lt.x,Lt.y);n_(br,Ni,Ji),n_(br,Ni,Ji),n_(br,gs,Ar),n_(br,gs,Ar)}}q&&(Se+=qe.length-1)}}if(H&&H.polyCount.length>0){if(H.borders){H.vertexArrayOffset=this.centroidVertexArray.length;const Me=H.borders,Ve=this.featuresOnBorder.push(H)-1;for(let Se=0;Se<4;Se++)Me[Se][0]!==Number.MAX_VALUE&&this.borders[Se].push(Ve)}this.encodeCentroid(H.borders?void 0:H.centroid(),H)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,v,E,m)}sortBorders(){for(let o=0;o<4;o++)this.borders[o].sort((c,f)=>this.featuresOnBorder[c].borders[o][0]-this.featuresOnBorder[f].borders[o][0])}encodeCentroid(o,c,f=!0){let m,v;if(o)if(o.y!==0){const S=c.span()._mult(this.tileToMeter);m=(Math.max(o.x,1)<<3)+Math.min(7,Math.round(S.x/10)),v=(Math.max(o.y,1)<<3)+Math.min(7,Math.round(S.y/10))}else m=Math.ceil(7*(o.x+450)),v=0;else m=0,v=+f;let E=f?this.centroidVertexArray.length:c.vertexArrayOffset;for(const S of c.polyCount){f&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*S.edges+S.top);for(let M=0;M<S.top;M++)this.centroidVertexArray.emplace(E++,m,v);for(let M=0;M<2*S.edges;M++)this.centroidVertexArray.emplace(E++,0,v),this.centroidVertexArray.emplace(E++,m,v)}}}function _x(u,o){const c=u.add(o)._unit();return u.x*c.x+u.y*c.y}function vu(u,o,c,f){const m=o.sub(u)._perp()._unit(),v=c.sub(o)._perp()._unit();return zo(u,o,c,_x(m,v),f)}function zo(u,o,c,f,m){const v=Math.sqrt(1-f*f);return Math.min(u.dist(o)/3,o.dist(c)/3,m*v/f)}function yx(u,o,c){return u.x<c[0].x&&o.x<c[0].x||u.x>c[1].x&&o.x>c[1].x||u.y<c[0].y&&o.y<c[0].y||u.y>c[1].y&&o.y>c[1].y}function nd(u,o,c){if(u.x<0||u.x>=Mi||o.x<0||o.x>=Mi||c.x<0||c.x>=Mi)return!1;const f=c.sub(o),m=f.perp(),v=u.sub(o);return(f.x*v.x+f.y*v.y)/Math.sqrt((f.x*f.x+f.y*f.y)*(v.x*v.x+v.y*v.y))>-.866&&m.x*v.x+m.y*v.y<0}function vx(u,o,c){const f=o?2|u:-3&u;return c?1|f:-2&f}function bx(){const u=Math.PI/32,o=Math.tan(u),c=Zg;return c*Math.sqrt(1+2*o*o)-c}function xx(u,o,c){const f=1<<c.z,m=Zu(c.x/f),v=Zu((c.x+1)/f),E=Fa(c.y/f),S=Fa((c.y+1)/f);return function(M,R,U,H,q=0,K){const $=[];if(!M.length||!U||!H)return $;const ie=(qe,It)=>{for(const bt of qe)$.push({polygon:bt,bounds:It})},me=Math.ceil(Math.log2(U)),Me=Math.ceil(Math.log2(H)),Ve=me-Me,Se=[];for(let qe=0;qe<Math.abs(Ve);qe++)Se.push(Ve>0?0:1);for(let qe=0;qe<Math.min(me,Me);qe++)Se.push(0),Se.push(1);let ze=M;if(ze=Hy(ze,R[0].y-q,R[1].y+q,1),ze=Hy(ze,R[0].x-q,R[1].x+q,0),!ze.length)return $;const Ze=[];for(Se.length?Ze.push({polygons:ze,bounds:R,depth:0}):ie(ze,R);Ze.length;){const qe=Ze.pop(),It=qe.depth,bt=Se[It],Vt=qe.bounds[0],pn=qe.bounds[1],At=bt===0?Vt.x:Vt.y,Yt=bt===0?pn.x:pn.y,$t=K?K(bt,At,Yt):.5*(At+Yt),hn=Hy(qe.polygons,At-q,$t+q,bt),gn=Hy(qe.polygons,$t-q,Yt+q,bt);if(hn.length){const Lt=[Vt,new J(bt===0?$t:pn.x,bt===1?$t:pn.y)];Se.length>It+1?Ze.push({polygons:hn,bounds:Lt,depth:It+1}):ie(hn,Lt)}if(gn.length){const Lt=[new J(bt===0?$t:Vt.x,bt===1?$t:Vt.y),pn];Se.length>It+1?Ze.push({polygons:gn,bounds:Lt,depth:It+1}):ie(gn,Lt)}}return $}(u,o,Math.ceil((v-m)/11.25),Math.ceil((E-S)/11.25),1,(M,R,U)=>{if(M===0)return .5*(R+U);{const H=Fa((c.y+R/Mi)/f);return(uf(.5*(Fa((c.y+U/Mi)/f)+H))*f-c.y)*Mi}})}Gn(fr,"FillExtrusionBucket",{omit:["layers","features"]}),Gn(Xd,"PartMetadata");const pT=new ln({"fill-extrusion-edge-radius":new ht(Rt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var mT={paint:new ln({"fill-extrusion-opacity":new ht(Rt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Tt(Rt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ht(Rt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ht(Rt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Tt(Rt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Tt(Rt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Tt(Rt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ht(Rt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new ht(Rt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new ht(Rt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:pT};function jy(u,o,c){var f=2*Math.PI*6378137/256/Math.pow(2,c);return[u*f-2*Math.PI*6378137/2,o*f-2*Math.PI*6378137/2]}class qy{constructor(o,c,f){this.z=o,this.x=c,this.y=f,this.key=Zd(0,o,o,c,f)}equals(o){return this.z===o.z&&this.x===o.x&&this.y===o.y}url(o,c){const f=function(v,E,S){var M=jy(256*v,256*(E=Math.pow(2,S)-E-1),S),R=jy(256*(v+1),256*(E+1),S);return M[0]+","+M[1]+","+R[0]+","+R[1]}(this.x,this.y,this.z),m=function(v,E,S){let M,R="";for(let U=v;U>0;U--)M=1<<U-1,R+=(E&M?1:0)+(S&M?2:0);return R}(this.z,this.x,this.y);return o[(this.x+this.y)%o.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(c==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",m).replace("{bbox-epsg-3857}",f)}toString(){return`${this.z}/${this.x}/${this.y}`}}class cf{constructor(o,c){this.wrap=o,this.canonical=c,this.key=Zd(o,c.z,c.z,c.x,c.y)}}class ul{constructor(o,c,f,m,v){this.overscaledZ=o,this.wrap=c,this.canonical=new qy(f,+m,+v),this.key=c===0&&o===f?this.canonical.key:Zd(c,o,f,m,v)}equals(o){return this.overscaledZ===o.overscaledZ&&this.wrap===o.wrap&&this.canonical.equals(o.canonical)}scaledTo(o){const c=this.canonical.z-o;return o>this.canonical.z?new ul(o,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ul(o,this.wrap,o,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(o,c=!0){if(this.overscaledZ===o&&c)return this.key;if(o>this.canonical.z)return Zd(this.wrap*+c,o,this.canonical.z,this.canonical.x,this.canonical.y);{const f=this.canonical.z-o;return Zd(this.wrap*+c,o,o,this.canonical.x>>f,this.canonical.y>>f)}}isChildOf(o){if(o.wrap!==this.wrap)return!1;const c=this.canonical.z-o.canonical.z;return o.overscaledZ===0||o.overscaledZ<this.overscaledZ&&o.canonical.x===this.canonical.x>>c&&o.canonical.y===this.canonical.y>>c}children(o){if(this.overscaledZ>=o)return[new ul(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,f=2*this.canonical.x,m=2*this.canonical.y;return[new ul(c,this.wrap,c,f,m),new ul(c,this.wrap,c,f+1,m),new ul(c,this.wrap,c,f,m+1),new ul(c,this.wrap,c,f+1,m+1)]}isLessThan(o){return this.wrap<o.wrap||!(this.wrap>o.wrap)&&(this.overscaledZ<o.overscaledZ||!(this.overscaledZ>o.overscaledZ)&&(this.canonical.x<o.canonical.x||!(this.canonical.x>o.canonical.x)&&this.canonical.y<o.canonical.y))}wrapped(){return new ul(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(o){return new ul(this.overscaledZ,o,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new cf(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Zd(u,o,c,f,m){const v=1<<Math.min(c,22);let E=v*(m%v)+f%v;return u&&c<22&&(E+=v*v*((u<0?-2*u-1:2*u)%(1<<2*(22-c)))),16*(32*E+c)+(o-c)}Gn(qy,"CanonicalTileID"),Gn(ul,"OverscaledTileID",{omit:["projMatrix"]});class Bs extends J{constructor(o,c,f){super(o,c),this.z=f}}function eo(u,o){return u.x*o.x+u.y*o.y}function X0(u,o){if(u.length===1){let c=0;const f=o[c++];let m;for(;!m||f.equals(m);)if(m=o[c++],!m)return 1/0;for(;c<o.length;c++){const v=o[c],E=u[0],S=m.sub(f),M=v.sub(f),R=E.sub(f),U=eo(S,S),H=eo(S,M),q=eo(M,M),K=eo(R,S),$=eo(R,M),ie=U*q-H*H,me=(q*K-H*$)/ie,Me=(U*$-H*K)/ie,Ve=f.z*(1-me-Me)+m.z*me+v.z*Me;if(isFinite(Ve))return Ve}return 1/0}{let c=1/0;for(const f of o)c=Math.min(c,f.z);return c}}function Ex(u,o,c,f,m,v,E,S){const M=E*m.getElevationAt(u,o,!0,!0),R=v[0]!==0,U=R?v[1]===0?E*(v[0]/7-450):E*function(H,q,K){const $=Math.floor(q[0]/8),ie=Math.floor(q[1]/8),me=10*(q[0]-8*$),Me=10*(q[1]-8*ie),Ve=H.getElevationAt($,ie,!0,!0),Se=H.getMeterToDEM(K),ze=Math.floor(.5*(me*Se-1)),Ze=Math.floor(.5*(Me*Se-1)),qe=H.tileCoordToPixel($,ie),It=2*ze+1,bt=2*Ze+1,Vt=function(gn,Lt,Dn,Ai,jn){return[gn.getElevationAtPixel(Lt,Dn,!0),gn.getElevationAtPixel(Lt+jn,Dn,!0),gn.getElevationAtPixel(Lt,Dn+jn,!0),gn.getElevationAtPixel(Lt+Ai,Dn+jn,!0)]}(H,qe.x-ze,qe.y-Ze,It,bt),pn=Math.abs(Vt[0]-Vt[1]),At=Math.abs(Vt[2]-Vt[3]),Yt=Math.abs(Vt[0]-Vt[2])+Math.abs(Vt[1]-Vt[3]),$t=Math.min(.25,.5*Se*(pn+At)/It),hn=Math.min(.25,.5*Se*Yt/bt);return Ve+Math.max($t*me,hn*Me)}(m,v,S):M;return{base:M+(c===0)?-1:c,top:R?Math.max(U+f,M+c+2):M+f}}const gT=di([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:_T}=gT,yT=di([{name:"a_packed",components:4,type:"Float32"}]),{members:vT}=yT,bT=Gy.types,Ix=Math.cos(Math.PI/180*37.5);class Yd{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.id),this.index=o.index,this.projection=o.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new xs,this.layoutVertexArray2=new ss,this.indexArray=new _a,this.programConfigurations=new Ac(o.layers,o.zoom),this.segments=new Qs,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(o,c,f,m){this.hasPattern=ky("line",this.layers,c);const v=this.layers[0].layout.get("line-sort-key"),E=[];for(const{feature:U,id:H,index:q,sourceLayerIndex:K}of o){const $=this.layers[0]._featureFilter.needGeometry,ie=Yp(U,$);if(!this.layers[0]._featureFilter.filter(new ft(this.zoom),ie,f))continue;const me=v?v.evaluate(ie,{},f):void 0,Me={id:H,properties:U.properties,type:U.type,sourceLayerIndex:K,index:q,geometry:$?ie.geometry:td(U,f,m),patterns:{},sortKey:me};E.push(Me)}v&&E.sort((U,H)=>U.sortKey-H.sortKey);const{lineAtlas:S,featureIndex:M}=c,R=this.addConstantDashes(S);for(const U of E){const{geometry:H,index:q,sourceLayerIndex:K}=U;if(R&&this.addFeatureDashes(U,S),this.hasPattern){const $=Fy("line",this.layers,U,this.zoom,c);this.patternFeatures.push($)}else this.addFeature(U,H,q,f,S.positions,c.availableImages);M.insert(o[q].feature,H,q,K,this.index)}}addConstantDashes(o){let c=!1;for(const f of this.layers){const m=f.paint.get("line-dasharray").value,v=f.layout.get("line-cap").value;if(m.kind!=="constant"||v.kind!=="constant")c=!0;else{const E=v.value,S=m.value;if(!S)continue;o.addDash(S,E)}}return c}addFeatureDashes(o,c){const f=this.zoom;for(const m of this.layers){const v=m.paint.get("line-dasharray").value,E=m.layout.get("line-cap").value;if(v.kind==="constant"&&E.kind==="constant")continue;let S,M;if(v.kind==="constant"){if(S=v.value,!S)continue}else S=v.evaluate({zoom:f},o);M=E.kind==="constant"?E.value:E.evaluate({zoom:f},o),c.addDash(S,M),o.patterns[m.id]=c.getKey(S,M)}}update(o,c,f,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,c,this.stateDependentLayers,f,m)}addFeatures(o,c,f,m,v){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,c,f,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=o.createVertexBuffer(this.layoutVertexArray2,vT)),this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,_T),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(o){if(o.properties&&o.properties.hasOwnProperty("mapbox_clip_start")&&o.properties.hasOwnProperty("mapbox_clip_end"))return{start:+o.properties.mapbox_clip_start,end:+o.properties.mapbox_clip_end}}addFeature(o,c,f,m,v,E){const S=this.layers[0].layout,M=S.get("line-join").evaluate(o,{}),R=S.get("line-cap").evaluate(o,{}),U=S.get("line-miter-limit"),H=S.get("line-round-limit");this.lineClips=this.lineFeatureClips(o);for(const q of c)this.addLine(q,o,M,R,U,H);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,v,E,m)}addLine(o,c,f,m,v,E){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Me=0;Me<o.length-1;Me++)this.totalDistance+=o[Me].dist(o[Me+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const S=bT[c.type]==="Polygon";let M=o.length;for(;M>=2&&o[M-1].equals(o[M-2]);)M--;let R=0;for(;R<M-1&&o[R].equals(o[R+1]);)R++;if(M<(S?3:2))return;f==="bevel"&&(v=1.05);const U=this.overscaling<=16?122880/(512*this.overscaling):0,H=this.segments.prepareSegment(10*M,this.layoutVertexArray,this.indexArray);let q,K,$,ie,me;this.e1=this.e2=-1,S&&(q=o[M-2],me=o[R].sub(q)._unit()._perp());for(let Me=R;Me<M;Me++){if($=Me===M-1?S?o[R+1]:void 0:o[Me+1],$&&o[Me].equals($))continue;me&&(ie=me),q&&(K=q),q=o[Me],me=$?$.sub(q)._unit()._perp():ie,ie=ie||me;let Ve=ie.add(me);Ve.x===0&&Ve.y===0||Ve._unit();const Se=ie.x*me.x+ie.y*me.y,ze=Ve.x*me.x+Ve.y*me.y,Ze=ze!==0?1/ze:1/0,qe=2*Math.sqrt(2-2*ze),It=ze<Ix&&K&&$,bt=ie.x*me.y-ie.y*me.x>0;if(It&&Me>R){const At=q.dist(K);if(At>2*U){const Yt=q.sub(q.sub(K)._mult(U/At)._round());this.updateDistance(K,Yt),this.addCurrentVertex(Yt,ie,0,0,H),K=Yt}}const Vt=K&&$;let pn=Vt?f:S?"butt":m;if(Vt&&pn==="round"&&(Ze<E?pn="miter":Ze<=2&&(pn="fakeround")),pn==="miter"&&Ze>v&&(pn="bevel"),pn==="bevel"&&(Ze>2&&(pn="flipbevel"),Ze<v&&(pn="miter")),K&&this.updateDistance(K,q),pn==="miter")Ve._mult(Ze),this.addCurrentVertex(q,Ve,0,0,H);else if(pn==="flipbevel"){if(Ze>100)Ve=me.mult(-1);else{const At=Ze*ie.add(me).mag()/ie.sub(me).mag();Ve._perp()._mult(At*(bt?-1:1))}this.addCurrentVertex(q,Ve,0,0,H),this.addCurrentVertex(q,Ve.mult(-1),0,0,H)}else if(pn==="bevel"||pn==="fakeround"){const At=-Math.sqrt(Ze*Ze-1),Yt=bt?At:0,$t=bt?0:At;if(K&&this.addCurrentVertex(q,ie,Yt,$t,H),pn==="fakeround"){const hn=Math.round(180*qe/Math.PI/20);for(let gn=1;gn<hn;gn++){let Lt=gn/hn;if(Lt!==.5){const Ai=Lt-.5;Lt+=Lt*Ai*(Lt-1)*((1.0904+Se*(Se*(3.55645-1.43519*Se)-3.2452))*Ai*Ai+(.848013+Se*(.215638*Se-1.06021)))}const Dn=me.sub(ie)._mult(Lt)._add(ie)._unit()._mult(bt?-1:1);this.addHalfVertex(q,Dn.x,Dn.y,!1,bt,0,H)}}$&&this.addCurrentVertex(q,me,-Yt,-$t,H)}else if(pn==="butt")this.addCurrentVertex(q,Ve,0,0,H);else if(pn==="square"){const At=K?1:-1;K||this.addCurrentVertex(q,Ve,At,At,H),this.addCurrentVertex(q,Ve,0,0,H),K&&this.addCurrentVertex(q,Ve,At,At,H)}else pn==="round"&&(K&&(this.addCurrentVertex(q,ie,0,0,H),this.addCurrentVertex(q,ie,1,1,H,!0)),$&&(this.addCurrentVertex(q,me,-1,-1,H,!0),this.addCurrentVertex(q,me,0,0,H)));if(It&&Me<M-1){const At=q.dist($);if(At>2*U){const Yt=q.add($.sub(q)._mult(U/At)._round());this.updateDistance(q,Yt),this.addCurrentVertex(Yt,me,0,0,H),q=Yt}}}}addCurrentVertex(o,c,f,m,v,E=!1){const S=c.y*m-c.x,M=-c.y-c.x*m;this.addHalfVertex(o,c.x+c.y*f,c.y-c.x*f,E,!1,f,v),this.addHalfVertex(o,S,M,E,!0,-m,v)}addHalfVertex({x:o,y:c},f,m,v,E,S,M){this.layoutVertexArray.emplaceBack((o<<1)+(v?1:0),(c<<1)+(E?1:0),Math.round(63*f)+128,Math.round(63*m)+128,1+(S===0?0:S<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const R=M.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,R),M.primitiveLength++),E?this.e2=R:this.e1=R}updateScaledDistance(){if(this.lineClips){const o=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=o*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(o,c){this.distance+=o.dist(c),this.updateScaledDistance()}}Gn(Yd,"LineBucket",{omit:["layers","patternFeatures"]});const Z0=new ln({"line-cap":new Tt(Rt.layout_line["line-cap"]),"line-join":new Tt(Rt.layout_line["line-join"]),"line-miter-limit":new ht(Rt.layout_line["line-miter-limit"]),"line-round-limit":new ht(Rt.layout_line["line-round-limit"]),"line-sort-key":new Tt(Rt.layout_line["line-sort-key"])});var Tx={paint:new ln({"line-opacity":new Tt(Rt.paint_line["line-opacity"]),"line-color":new Tt(Rt.paint_line["line-color"]),"line-translate":new ht(Rt.paint_line["line-translate"]),"line-translate-anchor":new ht(Rt.paint_line["line-translate-anchor"]),"line-width":new Tt(Rt.paint_line["line-width"]),"line-gap-width":new Tt(Rt.paint_line["line-gap-width"]),"line-offset":new Tt(Rt.paint_line["line-offset"]),"line-blur":new Tt(Rt.paint_line["line-blur"]),"line-dasharray":new Tt(Rt.paint_line["line-dasharray"]),"line-pattern":new Tt(Rt.paint_line["line-pattern"]),"line-gradient":new en(Rt.paint_line["line-gradient"]),"line-trim-offset":new ht(Rt.paint_line["line-trim-offset"])}),layout:Z0};const Y0=new class extends Tt{possiblyEvaluate(u,o){return o=new ft(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,transition:o.transition}),super.possiblyEvaluate(u,o)}evaluate(u,o,c,f){return o=Dt({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(u,o,c,f)}}(Tx.paint.properties["line-width"].specification);function i_(u,o){return o>0?o+2*u:u}Y0.useIntegerZoom=!0;const Yu=di([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Vm=di([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),xT=di([{name:"a_projected_pos",components:4,type:"Float32"}],4);di([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const ET=di([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),IT=di([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);di([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const wx=di([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),TT=di([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);di([{name:"triangle",components:3,type:"Uint16"}]),di([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),di([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),di([{type:"Float32",name:"offsetX"}]),di([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var va=24;const Ba=128;function Ir(u,o){const{expression:c}=o;if(c.kind==="constant")return{kind:"constant",layoutSize:c.evaluate(new ft(u+1))};if(c.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:m}=c;let v=0;for(;v<f.length&&f[v]<=u;)v++;v=Math.max(0,v-1);let E=v;for(;E<f.length&&f[E]<u+1;)E++;E=Math.min(f.length-1,E);const S=f[v],M=f[E];return c.kind==="composite"?{kind:"composite",minZoom:S,maxZoom:M,interpolationType:m}:{kind:"camera",minZoom:S,maxZoom:M,minSize:c.evaluate(new ft(S)),maxSize:c.evaluate(new ft(M)),interpolationType:m}}}function r_(u,{uSize:o,uSizeT:c},{lowerSize:f,upperSize:m}){return u.kind==="source"?f/Ba:u.kind==="composite"?Zi(f/Ba,m/Ba,c):o}function cl(u,o){let c=0,f=0;if(u.kind==="constant")f=u.layoutSize;else if(u.kind!=="source"){const{interpolationType:m,minZoom:v,maxZoom:E}=u,S=m?it(El.interpolationFactor(m,o,v,E),0,1):0;u.kind==="camera"?f=Zi(u.minSize,u.maxSize,S):c=S}return{uSizeT:c,uSize:f}}var Sx=Object.freeze({__proto__:null,getSizeData:Ir,evaluateSizeForFeature:r_,evaluateSizeForZoom:cl,SIZE_PACK_FACTOR:Ba});function wT(u,o,c){return u.sections.forEach(f=>{f.text=function(m,v,E){const S=v.layout.get("text-transform").evaluate(E,{});return S==="uppercase"?m=m.toLocaleUpperCase():S==="lowercase"&&(m=m.toLocaleLowerCase()),Ke.applyArabicShaping&&(m=Ke.applyArabicShaping(m)),m}(f.text,o,c)}),u}const os={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};function ST(u){return u==="︶"||u==="﹈"||u==="︸"||u==="﹄"||u==="﹂"||u==="︾"||u==="︼"||u==="︺"||u==="︘"||u==="﹀"||u==="︐"||u==="︓"||u==="︔"||u==="｀"||u==="￣"||u==="︑"||u==="︒"}function Cx(u){return u==="︵"||u==="﹇"||u==="︷"||u==="﹃"||u==="﹁"||u==="︽"||u==="︻"||u==="︹"||u==="︗"||u==="︿"}var Kd=Es,Ax=function(u,o,c,f,m){var v,E,S=8*m-f-1,M=(1<<S)-1,R=M>>1,U=-7,H=c?m-1:0,q=c?-1:1,K=u[o+H];for(H+=q,v=K&(1<<-U)-1,K>>=-U,U+=S;U>0;v=256*v+u[o+H],H+=q,U-=8);for(E=v&(1<<-U)-1,v>>=-U,U+=f;U>0;E=256*E+u[o+H],H+=q,U-=8);if(v===0)v=1-R;else{if(v===M)return E?NaN:1/0*(K?-1:1);E+=Math.pow(2,f),v-=R}return(K?-1:1)*E*Math.pow(2,v-f)},Mx=function(u,o,c,f,m,v){var E,S,M,R=8*v-m-1,U=(1<<R)-1,H=U>>1,q=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,K=f?0:v-1,$=f?1:-1,ie=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(S=isNaN(o)?1:0,E=U):(E=Math.floor(Math.log(o)/Math.LN2),o*(M=Math.pow(2,-E))<1&&(E--,M*=2),(o+=E+H>=1?q/M:q*Math.pow(2,1-H))*M>=2&&(E++,M/=2),E+H>=U?(S=0,E=U):E+H>=1?(S=(o*M-1)*Math.pow(2,m),E+=H):(S=o*Math.pow(2,H-1)*Math.pow(2,m),E=0));m>=8;u[c+K]=255&S,K+=$,S/=256,m-=8);for(E=E<<m|S,R+=m;R>0;u[c+K]=255&E,K+=$,E/=256,R-=8);u[c+K-$]|=128*ie};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Es(u){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(u)?u:new Uint8Array(u||0),this.pos=0,this.type=0,this.length=this.buf.length}Es.Varint=0,Es.Fixed64=1,Es.Bytes=2,Es.Fixed32=5;var K0=4294967296,Lx=1/K0,Rx=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function id(u){return u.type===Es.Bytes?u.readVarint()+u.pos:u.pos+1}function Gm(u,o,c){return c?4294967296*o+(u>>>0):4294967296*(o>>>0)+(u>>>0)}function Px(u,o,c){var f=o<=16383?1:o<=2097151?2:o<=268435455?3:Math.floor(Math.log(o)/(7*Math.LN2));c.realloc(f);for(var m=c.pos-1;m>=u;m--)c.buf[m+f]=c.buf[m]}function CT(u,o){for(var c=0;c<u.length;c++)o.writeVarint(u[c])}function AT(u,o){for(var c=0;c<u.length;c++)o.writeSVarint(u[c])}function MT(u,o){for(var c=0;c<u.length;c++)o.writeFloat(u[c])}function LT(u,o){for(var c=0;c<u.length;c++)o.writeDouble(u[c])}function J0(u,o){for(var c=0;c<u.length;c++)o.writeBoolean(u[c])}function RT(u,o){for(var c=0;c<u.length;c++)o.writeFixed32(u[c])}function Q0(u,o){for(var c=0;c<u.length;c++)o.writeSFixed32(u[c])}function PT(u,o){for(var c=0;c<u.length;c++)o.writeFixed64(u[c])}function DT(u,o){for(var c=0;c<u.length;c++)o.writeSFixed64(u[c])}function Wy(u,o){return(u[o]|u[o+1]<<8|u[o+2]<<16)+16777216*u[o+3]}function Ao(u,o,c){u[c]=o,u[c+1]=o>>>8,u[c+2]=o>>>16,u[c+3]=o>>>24}function Ql(u,o){return(u[o]|u[o+1]<<8|u[o+2]<<16)+(u[o+3]<<24)}function OT(u,o,c){o.glyphs=[],u===1&&c.readMessage(NT,o)}function NT(u,o,c){if(u===3){const{id:f,bitmap:m,width:v,height:E,left:S,top:M,advance:R}=c.readMessage(kT,{});o.glyphs.push({id:f,bitmap:new Rc({width:v+6,height:E+6},m),metrics:{width:v,height:E,left:S,top:M,advance:R}})}else u===4?o.ascender=c.readSVarint():u===5&&(o.descender=c.readSVarint())}function kT(u,o,c){u===1?o.id=c.readVarint():u===2?o.bitmap=c.readBytes():u===3?o.width=c.readVarint():u===4?o.height=c.readVarint():u===5?o.left=c.readSVarint():u===6?o.top=c.readSVarint():u===7&&(o.advance=c.readVarint())}function Xy(u){let o=0,c=0;for(const E of u)o+=E.w*E.h,c=Math.max(c,E.w);u.sort((E,S)=>S.h-E.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),c),h:1/0}];let m=0,v=0;for(const E of u)for(let S=f.length-1;S>=0;S--){const M=f[S];if(!(E.w>M.w||E.h>M.h)){if(E.x=M.x,E.y=M.y,v=Math.max(v,E.y+E.h),m=Math.max(m,E.x+E.w),E.w===M.w&&E.h===M.h){const R=f.pop();S<f.length&&(f[S]=R)}else E.h===M.h?(M.x+=E.w,M.w-=E.w):E.w===M.w?(M.y+=E.h,M.h-=E.h):(f.push({x:M.x+E.w,y:M.y,w:M.w-E.w,h:E.h}),M.y+=E.h,M.h-=E.h);break}}return{w:m,h:v,fill:o/(m*v)||0}}Es.prototype={destroy:function(){this.buf=null},readFields:function(u,o,c){for(c=c||this.length;this.pos<c;){var f=this.readVarint(),m=f>>3,v=this.pos;this.type=7&f,u(m,o,this),this.pos===v&&this.skip(f)}return o},readMessage:function(u,o){return this.readFields(u,o,this.readVarint()+this.pos)},readFixed32:function(){var u=Wy(this.buf,this.pos);return this.pos+=4,u},readSFixed32:function(){var u=Ql(this.buf,this.pos);return this.pos+=4,u},readFixed64:function(){var u=Wy(this.buf,this.pos)+Wy(this.buf,this.pos+4)*K0;return this.pos+=8,u},readSFixed64:function(){var u=Wy(this.buf,this.pos)+Ql(this.buf,this.pos+4)*K0;return this.pos+=8,u},readFloat:function(){var u=Ax(this.buf,this.pos,!0,23,4);return this.pos+=4,u},readDouble:function(){var u=Ax(this.buf,this.pos,!0,52,8);return this.pos+=8,u},readVarint:function(u){var o,c,f=this.buf;return o=127&(c=f[this.pos++]),c<128?o:(o|=(127&(c=f[this.pos++]))<<7,c<128?o:(o|=(127&(c=f[this.pos++]))<<14,c<128?o:(o|=(127&(c=f[this.pos++]))<<21,c<128?o:function(m,v,E){var S,M,R=E.buf;if(S=(112&(M=R[E.pos++]))>>4,M<128||(S|=(127&(M=R[E.pos++]))<<3,M<128)||(S|=(127&(M=R[E.pos++]))<<10,M<128)||(S|=(127&(M=R[E.pos++]))<<17,M<128)||(S|=(127&(M=R[E.pos++]))<<24,M<128)||(S|=(1&(M=R[E.pos++]))<<31,M<128))return Gm(m,S,v);throw new Error("Expected varint not more than 10 bytes")}(o|=(15&(c=f[this.pos]))<<28,u,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var u=this.readVarint();return u%2==1?(u+1)/-2:u/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var u=this.readVarint()+this.pos,o=this.pos;return this.pos=u,u-o>=12&&Rx?function(c,f,m){return Rx.decode(c.subarray(f,m))}(this.buf,o,u):function(c,f,m){for(var v="",E=f;E<m;){var S,M,R,U=c[E],H=null,q=U>239?4:U>223?3:U>191?2:1;if(E+q>m)break;q===1?U<128&&(H=U):q===2?(192&(S=c[E+1]))==128&&(H=(31&U)<<6|63&S)<=127&&(H=null):q===3?(M=c[E+2],(192&(S=c[E+1]))==128&&(192&M)==128&&((H=(15&U)<<12|(63&S)<<6|63&M)<=2047||H>=55296&&H<=57343)&&(H=null)):q===4&&(M=c[E+2],R=c[E+3],(192&(S=c[E+1]))==128&&(192&M)==128&&(192&R)==128&&((H=(15&U)<<18|(63&S)<<12|(63&M)<<6|63&R)<=65535||H>=1114112)&&(H=null)),H===null?(H=65533,q=1):H>65535&&(H-=65536,v+=String.fromCharCode(H>>>10&1023|55296),H=56320|1023&H),v+=String.fromCharCode(H),E+=q}return v}(this.buf,o,u)},readBytes:function(){var u=this.readVarint()+this.pos,o=this.buf.subarray(this.pos,u);return this.pos=u,o},readPackedVarint:function(u,o){if(this.type!==Es.Bytes)return u.push(this.readVarint(o));var c=id(this);for(u=u||[];this.pos<c;)u.push(this.readVarint(o));return u},readPackedSVarint:function(u){if(this.type!==Es.Bytes)return u.push(this.readSVarint());var o=id(this);for(u=u||[];this.pos<o;)u.push(this.readSVarint());return u},readPackedBoolean:function(u){if(this.type!==Es.Bytes)return u.push(this.readBoolean());var o=id(this);for(u=u||[];this.pos<o;)u.push(this.readBoolean());return u},readPackedFloat:function(u){if(this.type!==Es.Bytes)return u.push(this.readFloat());var o=id(this);for(u=u||[];this.pos<o;)u.push(this.readFloat());return u},readPackedDouble:function(u){if(this.type!==Es.Bytes)return u.push(this.readDouble());var o=id(this);for(u=u||[];this.pos<o;)u.push(this.readDouble());return u},readPackedFixed32:function(u){if(this.type!==Es.Bytes)return u.push(this.readFixed32());var o=id(this);for(u=u||[];this.pos<o;)u.push(this.readFixed32());return u},readPackedSFixed32:function(u){if(this.type!==Es.Bytes)return u.push(this.readSFixed32());var o=id(this);for(u=u||[];this.pos<o;)u.push(this.readSFixed32());return u},readPackedFixed64:function(u){if(this.type!==Es.Bytes)return u.push(this.readFixed64());var o=id(this);for(u=u||[];this.pos<o;)u.push(this.readFixed64());return u},readPackedSFixed64:function(u){if(this.type!==Es.Bytes)return u.push(this.readSFixed64());var o=id(this);for(u=u||[];this.pos<o;)u.push(this.readSFixed64());return u},skip:function(u){var o=7&u;if(o===Es.Varint)for(;this.buf[this.pos++]>127;);else if(o===Es.Bytes)this.pos=this.readVarint()+this.pos;else if(o===Es.Fixed32)this.pos+=4;else{if(o!==Es.Fixed64)throw new Error("Unimplemented type: "+o);this.pos+=8}},writeTag:function(u,o){this.writeVarint(u<<3|o)},realloc:function(u){for(var o=this.length||16;o<this.pos+u;)o*=2;if(o!==this.length){var c=new Uint8Array(o);c.set(this.buf),this.buf=c,this.length=o}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(u){this.realloc(4),Ao(this.buf,u,this.pos),this.pos+=4},writeSFixed32:function(u){this.realloc(4),Ao(this.buf,u,this.pos),this.pos+=4},writeFixed64:function(u){this.realloc(8),Ao(this.buf,-1&u,this.pos),Ao(this.buf,Math.floor(u*Lx),this.pos+4),this.pos+=8},writeSFixed64:function(u){this.realloc(8),Ao(this.buf,-1&u,this.pos),Ao(this.buf,Math.floor(u*Lx),this.pos+4),this.pos+=8},writeVarint:function(u){(u=+u||0)>268435455||u<0?function(o,c){var f,m;if(o>=0?(f=o%4294967296|0,m=o/4294967296|0):(m=~(-o/4294967296),4294967295^(f=~(-o%4294967296))?f=f+1|0:(f=0,m=m+1|0)),o>=18446744073709552e3||o<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),function(v,E,S){S.buf[S.pos++]=127&v|128,v>>>=7,S.buf[S.pos++]=127&v|128,v>>>=7,S.buf[S.pos++]=127&v|128,v>>>=7,S.buf[S.pos++]=127&v|128,S.buf[S.pos]=127&(v>>>=7)}(f,0,c),function(v,E){var S=(7&v)<<4;E.buf[E.pos++]|=S|((v>>>=3)?128:0),v&&(E.buf[E.pos++]=127&v|((v>>>=7)?128:0),v&&(E.buf[E.pos++]=127&v|((v>>>=7)?128:0),v&&(E.buf[E.pos++]=127&v|((v>>>=7)?128:0),v&&(E.buf[E.pos++]=127&v|((v>>>=7)?128:0),v&&(E.buf[E.pos++]=127&v)))))}(m,c)}(u,this):(this.realloc(4),this.buf[this.pos++]=127&u|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=u>>>7&127))))},writeSVarint:function(u){this.writeVarint(u<0?2*-u-1:2*u)},writeBoolean:function(u){this.writeVarint(!!u)},writeString:function(u){u=String(u),this.realloc(4*u.length),this.pos++;var o=this.pos;this.pos=function(f,m,v){for(var E,S,M=0;M<m.length;M++){if((E=m.charCodeAt(M))>55295&&E<57344){if(!S){E>56319||M+1===m.length?(f[v++]=239,f[v++]=191,f[v++]=189):S=E;continue}if(E<56320){f[v++]=239,f[v++]=191,f[v++]=189,S=E;continue}E=S-55296<<10|E-56320|65536,S=null}else S&&(f[v++]=239,f[v++]=191,f[v++]=189,S=null);E<128?f[v++]=E:(E<2048?f[v++]=E>>6|192:(E<65536?f[v++]=E>>12|224:(f[v++]=E>>18|240,f[v++]=E>>12&63|128),f[v++]=E>>6&63|128),f[v++]=63&E|128)}return v}(this.buf,u,this.pos);var c=this.pos-o;c>=128&&Px(o,c,this),this.pos=o-1,this.writeVarint(c),this.pos+=c},writeFloat:function(u){this.realloc(4),Mx(this.buf,u,this.pos,!0,23,4),this.pos+=4},writeDouble:function(u){this.realloc(8),Mx(this.buf,u,this.pos,!0,52,8),this.pos+=8},writeBytes:function(u){var o=u.length;this.writeVarint(o),this.realloc(o);for(var c=0;c<o;c++)this.buf[this.pos++]=u[c]},writeRawMessage:function(u,o){this.pos++;var c=this.pos;u(o,this);var f=this.pos-c;f>=128&&Px(c,f,this),this.pos=c-1,this.writeVarint(f),this.pos+=f},writeMessage:function(u,o,c){this.writeTag(u,Es.Bytes),this.writeRawMessage(o,c)},writePackedVarint:function(u,o){o.length&&this.writeMessage(u,CT,o)},writePackedSVarint:function(u,o){o.length&&this.writeMessage(u,AT,o)},writePackedBoolean:function(u,o){o.length&&this.writeMessage(u,J0,o)},writePackedFloat:function(u,o){o.length&&this.writeMessage(u,MT,o)},writePackedDouble:function(u,o){o.length&&this.writeMessage(u,LT,o)},writePackedFixed32:function(u,o){o.length&&this.writeMessage(u,RT,o)},writePackedSFixed32:function(u,o){o.length&&this.writeMessage(u,Q0,o)},writePackedFixed64:function(u,o){o.length&&this.writeMessage(u,PT,o)},writePackedSFixed64:function(u,o){o.length&&this.writeMessage(u,DT,o)},writeBytesField:function(u,o){this.writeTag(u,Es.Bytes),this.writeBytes(o)},writeFixed32Field:function(u,o){this.writeTag(u,Es.Fixed32),this.writeFixed32(o)},writeSFixed32Field:function(u,o){this.writeTag(u,Es.Fixed32),this.writeSFixed32(o)},writeFixed64Field:function(u,o){this.writeTag(u,Es.Fixed64),this.writeFixed64(o)},writeSFixed64Field:function(u,o){this.writeTag(u,Es.Fixed64),this.writeSFixed64(o)},writeVarintField:function(u,o){this.writeTag(u,Es.Varint),this.writeVarint(o)},writeSVarintField:function(u,o){this.writeTag(u,Es.Varint),this.writeSVarint(o)},writeStringField:function(u,o){this.writeTag(u,Es.Bytes),this.writeString(o)},writeFloatField:function(u,o){this.writeTag(u,Es.Fixed32),this.writeFloat(o)},writeDoubleField:function(u,o){this.writeTag(u,Es.Fixed64),this.writeDouble(o)},writeBooleanField:function(u,o){this.writeVarintField(u,!!o)}};class $0{constructor(o,{pixelRatio:c,version:f,stretchX:m,stretchY:v,content:E}){this.paddedRect=o,this.pixelRatio=c,this.stretchX=m,this.stretchY=v,this.content=E,this.version=f}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Dx{constructor(o,c){const f={},m={};this.haveRenderCallbacks=[];const v=[];this.addImages(o,f,v),this.addImages(c,m,v);const{w:E,h:S}=Xy(v),M=new yu({width:E||1,height:S||1});for(const R in o){const U=o[R],H=f[R].paddedRect;yu.copy(U.data,M,{x:0,y:0},{x:H.x+1,y:H.y+1},U.data)}for(const R in c){const U=c[R],H=m[R].paddedRect,q=H.x+1,K=H.y+1,$=U.data.width,ie=U.data.height;yu.copy(U.data,M,{x:0,y:0},{x:q,y:K},U.data),yu.copy(U.data,M,{x:0,y:ie-1},{x:q,y:K-1},{width:$,height:1}),yu.copy(U.data,M,{x:0,y:0},{x:q,y:K+ie},{width:$,height:1}),yu.copy(U.data,M,{x:$-1,y:0},{x:q-1,y:K},{width:1,height:ie}),yu.copy(U.data,M,{x:0,y:0},{x:q+$,y:K},{width:1,height:ie})}this.image=M,this.iconPositions=f,this.patternPositions=m}addImages(o,c,f){for(const m in o){const v=o[m],E={x:0,y:0,w:v.data.width+2,h:v.data.height+2};f.push(E),c[m]=new $0(E,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(o,c){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(f=>o.hasImage(f)),o.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in o.updatedImages)this.patchUpdatedImage(this.iconPositions[f],o.getImage(f),c),this.patchUpdatedImage(this.patternPositions[f],o.getImage(f),c)}patchUpdatedImage(o,c,f){if(!o||!c||o.version===c.version)return;o.version=c.version;const[m,v]=o.tl;f.update(c.data,void 0,{x:m,y:v})}}Gn($0,"ImagePosition"),Gn(Dx,"ImageAtlas");const Ku={horizontal:1,vertical:2,horizontalOnly:3};class Hm{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(o,c){const f=new Hm;return f.scale=o||1,f.fontStack=c,f}static forImage(o){const c=new Hm;return c.imageName=o,c}}class jm{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(o,c){const f=new jm;for(let m=0;m<o.sections.length;m++){const v=o.sections[m];v.image?f.addImageSection(v):f.addTextSection(v,c)}return f}length(){return this.text.length}getSection(o){return this.sections[this.sectionIndex[o]]}getSections(){return this.sections}getSectionIndex(o){return this.sectionIndex[o]}getCharCode(o){return this.text.charCodeAt(o)}verticalizePunctuation(o){this.text=function(c,f){let m="";for(let v=0;v<c.length;v++){const E=c.charCodeAt(v+1)||null,S=c.charCodeAt(v-1)||null;m+=!f&&(E&&G(E)&&!os[c[v+1]]||S&&G(S)&&!os[c[v-1]])||!os[c[v]]?c[v]:os[c[v]]}return m}(this.text,o)}trim(){let o=0;for(let f=0;f<this.text.length&&Zy[this.text.charCodeAt(f)];f++)o++;let c=this.text.length;for(let f=this.text.length-1;f>=0&&f>=o&&Zy[this.text.charCodeAt(f)];f--)c--;this.text=this.text.substring(o,c),this.sectionIndex=this.sectionIndex.slice(o,c)}substring(o,c){const f=new jm;return f.text=this.text.substring(o,c),f.sectionIndex=this.sectionIndex.slice(o,c),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((o,c)=>Math.max(o,this.sections[c].scale),0)}addTextSection(o,c){this.text+=o.text,this.sections.push(Hm.forText(o.scale,o.fontStack||c));const f=this.sections.length-1;for(let m=0;m<o.text.length;++m)this.sectionIndex.push(f)}addImageSection(o){const c=o.image?o.image.name:"";if(c.length===0)return void Zn("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(Hm.forImage(c)),this.sectionIndex.push(this.sections.length-1)):Zn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function e1(u,o,c,f,m,v,E,S,M,R,U,H,q,K,$){const ie=jm.fromFeature(u,m);H===Ku.vertical&&ie.verticalizePunctuation(q);let me=[];const Me=function(qe,It,bt,Vt,pn,At){if(!qe)return[];const Yt=[],$t=function(Dn,Ai,jn,ai,Nn,Li){let Cr=0;for(let Tr=0;Tr<Dn.length();Tr++){const br=Dn.getSection(Tr);Cr+=t1(Dn.getCharCode(Tr),br,ai,Nn,Ai,Li)}return Cr/Math.max(1,Math.ceil(Cr/jn))}(qe,It,bt,Vt,pn,At),hn=qe.text.indexOf("​")>=0;let gn=0;for(let Dn=0;Dn<qe.length();Dn++){const Ai=qe.getSection(Dn),jn=qe.getCharCode(Dn);if(Zy[jn]||(gn+=t1(jn,Ai,Vt,pn,It,At)),Dn<qe.length()-1){const ai=!((Lt=jn)<11904||!(fu(Lt)||Cm(Lt)||y(Lt)||Mm(Lt)||sy(Lt)||ny(Lt)||iy(Lt)||Hp(Lt)||oy(Lt)||Am(Lt)||ry(Lt)||b(Lt)||Sc(Lt)||Dg(Lt)||Pg(Lt)||Og(Lt)||zd(Lt)||tf(Lt)||ay(Lt)||Ng(Lt)));(Ox[jn]||ai||Ai.imageName)&&Yt.push(kx(Dn+1,gn,$t,Yt,FT(jn,qe.getCharCode(Dn+1),ai&&hn),!1))}}var Lt;return Fx(kx(qe.length(),gn,$t,Yt,0,!0))}(ie,R,v,o,f,K),{processBidirectionalText:Ve,processStyledBidirectionalText:Se}=Ke;if(Ve&&ie.sections.length===1){const qe=Ve(ie.toString(),Me);for(const It of qe){const bt=new jm;bt.text=It,bt.sections=ie.sections;for(let Vt=0;Vt<It.length;Vt++)bt.sectionIndex.push(0);me.push(bt)}}else if(Se){const qe=Se(ie.text,ie.sectionIndex,Me);for(const It of qe){const bt=new jm;bt.text=It[0],bt.sectionIndex=It[1],bt.sections=ie.sections,me.push(bt)}}else me=function(qe,It){const bt=[],Vt=qe.text;let pn=0;for(const At of It)bt.push(qe.substring(pn,At)),pn=At;return pn<Vt.length&&bt.push(qe.substring(pn,Vt.length)),bt}(ie,Me);const ze=[],Ze={positionedLines:ze,text:ie.toString(),top:U[1],bottom:U[1],left:U[0],right:U[0],writingMode:H,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(qe,It,bt,Vt,pn,At,Yt,$t,hn,gn,Lt,Dn){let Ai=0,jn=0,ai=0;const Nn=$t==="right"?1:$t==="left"?0:.5;let Li=!1;for(const Ji of pn){const Ar=Ji.getSections();for(const Is of Ar){if(Is.imageName)continue;const zs=It[Is.fontStack];if(zs&&(Li=zs.ascender!==void 0&&zs.descender!==void 0,!Li))break}if(!Li)break}let Cr=0;for(const Ji of pn){Ji.trim();const Ar=Ji.getMaxScale(),Is=(Ar-1)*va,zs={positionedGlyphs:[],lineOffset:0};qe.positionedLines[Cr]=zs;const Os=zs.positionedGlyphs;let Us=0;if(!Ji.length()){jn+=At,++Cr;continue}let Ws=0,Mo=0;for(let _s=0;_s<Ji.length();_s++){const ua=Ji.getSection(_s),Qo=Ji.getSectionIndex(_s),Jr=Ji.getCharCode(_s);let co=ua.scale,ba=null,Ts=null,Vo=null,$l=va,fl=0;const dl=!(hn===Ku.horizontal||!Lt&&!k(Jr)||Lt&&(Zy[Jr]||(Tr=Jr,Gp(Tr)||wc(Tr)||Rg(Tr)||ef(Tr)||p(Tr))));if(ua.imageName){const Iu=Vt[ua.imageName];if(!Iu)continue;Vo=ua.imageName,qe.iconsInText=qe.iconsInText||!0,Ts=Iu.paddedRect;const pl=Iu.displaySize;co=co*va/Dn,ba={width:pl[0],height:pl[1],left:1,top:-3,advance:dl?pl[1]:pl[0],localGlyph:!1},fl=Li?-ba.height*co:Ar*va-17-pl[1]*co,$l=ba.advance;const tm=(dl?pl[0]:pl[1])*co-va*Ar;tm>0&&tm>Us&&(Us=tm)}else{const Iu=bt[ua.fontStack];if(!Iu)continue;Iu[Jr]&&(Ts=Iu[Jr]);const pl=It[ua.fontStack];if(!pl)continue;const tm=pl.glyphs[Jr];if(!tm)continue;if(ba=tm.metrics,$l=Jr!==8203?va:0,Li){const av=pl.ascender!==void 0?Math.abs(pl.ascender):0,m1=pl.descender!==void 0?Math.abs(pl.descender):0,g1=(av+m1)*co;Ws<g1&&(Ws=g1,Mo=(av-m1)/2*co),fl=-av*co}else fl=(Ar-co)*va-17}dl?(qe.verticalizable=!0,Os.push({glyph:Jr,imageName:Vo,x:Ai,y:jn+fl,vertical:dl,scale:co,localGlyph:ba.localGlyph,fontStack:ua.fontStack,sectionIndex:Qo,metrics:ba,rect:Ts}),Ai+=$l*co+gn):(Os.push({glyph:Jr,imageName:Vo,x:Ai,y:jn+fl,vertical:dl,scale:co,localGlyph:ba.localGlyph,fontStack:ua.fontStack,sectionIndex:Qo,metrics:ba,rect:Ts}),Ai+=ba.advance*co+gn)}Os.length!==0&&(ai=Math.max(Ai-gn,ai),Li?Bx(Os,Nn,Us,Mo,At*Ar/2):Bx(Os,Nn,Us,0,At/2)),Ai=0;const hl=At*Ar+Us;zs.lineOffset=Math.max(Us,Is),jn+=hl,++Cr}var Tr;const br=jn,{horizontalAlign:Ni,verticalAlign:gs}=Jd(Yt);(function(Ji,Ar,Is,zs,Os,Us){const Ws=(Ar-Is)*Os,Mo=-Us*zs;for(const hl of Ji)for(const _s of hl.positionedGlyphs)_s.x+=Ws,_s.y+=Mo})(qe.positionedLines,Nn,Ni,gs,ai,br),qe.top+=-gs*br,qe.bottom=qe.top+br,qe.left+=-Ni*ai,qe.right=qe.left+ai,qe.hasBaseline=Li}(Ze,o,c,f,me,E,S,M,H,R,q,$),!function(qe){for(const It of qe)if(It.positionedGlyphs.length!==0)return!1;return!0}(ze)&&Ze}const Zy={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Ox={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function t1(u,o,c,f,m,v){if(o.imageName){const E=f[o.imageName];return E?E.displaySize[0]*o.scale*va/v+m:0}{const E=c[o.fontStack],S=E&&E.glyphs[u];return S?S.metrics.advance*o.scale+m:0}}function Nx(u,o,c,f){const m=Math.pow(u-o,2);return f?u<o?m/2:2*m:m+Math.abs(c)*c}function FT(u,o,c){let f=0;return u===10&&(f-=1e4),c&&(f+=150),u!==40&&u!==65288||(f+=50),o!==41&&o!==65289||(f+=50),f}function kx(u,o,c,f,m,v){let E=null,S=Nx(o,c,m,v);for(const M of f){const R=Nx(o-M.x,c,m,v)+M.badness;R<=S&&(E=M,S=R)}return{index:u,x:o,priorBreak:E,badness:S}}function Fx(u){return u?Fx(u.priorBreak).concat(u.index):[]}function Jd(u){let o=.5,c=.5;switch(u){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:o,verticalAlign:c}}function Bx(u,o,c,f,m){if(!(o||c||f||m))return;const v=u.length-1,E=u[v],S=(E.x+E.metrics.advance*E.scale)*o;for(let M=0;M<=v;M++)u[M].x-=S,u[M].y+=c+f+m}function BT(u,o,c){const{horizontalAlign:f,verticalAlign:m}=Jd(c),v=o[0]-u.displaySize[0]*f,E=o[1]-u.displaySize[1]*m;return{image:u,top:E,bottom:E+u.displaySize[1],left:v,right:v+u.displaySize[0]}}function zx(u,o,c,f,m,v){const E=u.image;let S;if(E.content){const me=E.content,Me=E.pixelRatio||1;S=[me[0]/Me,me[1]/Me,E.displaySize[0]-me[2]/Me,E.displaySize[1]-me[3]/Me]}const M=o.left*v,R=o.right*v;let U,H,q,K;c==="width"||c==="both"?(K=m[0]+M-f[3],H=m[0]+R+f[1]):(K=m[0]+(M+R-E.displaySize[0])/2,H=K+E.displaySize[0]);const $=o.top*v,ie=o.bottom*v;return c==="height"||c==="both"?(U=m[1]+$-f[0],q=m[1]+ie+f[2]):(U=m[1]+($+ie-E.displaySize[1])/2,q=U+E.displaySize[1]),{image:E,top:U,right:H,bottom:q,left:K,collisionPadding:S}}class rd extends J{constructor(o,c,f,m,v){super(o,c),this.angle=m,this.z=f,v!==void 0&&(this.segment=v)}clone(){return new rd(this.x,this.y,this.z,this.angle,this.segment)}}function Ux(u,o,c,f,m){if(o.segment===void 0)return!0;let v=o,E=o.segment+1,S=0;for(;S>-c/2;){if(E--,E<0)return!1;S-=u[E].dist(v),v=u[E]}S+=u[E].dist(u[E+1]),E++;const M=[];let R=0;for(;S<c/2;){const U=u[E],H=u[E+1];if(!H)return!1;let q=u[E-1].angleTo(U)-U.angleTo(H);for(q=Math.abs((q+3*Math.PI)%(2*Math.PI)-Math.PI),M.push({distance:S,angleDelta:q}),R+=q;S-M[0].distance>f;)R-=M.shift().angleDelta;if(R>m)return!1;E++,S+=U.dist(H)}return!0}function n1(u){let o=0;for(let c=0;c<u.length-1;c++)o+=u[c].dist(u[c+1]);return o}function i1(u,o,c){return u?.6*o*c:0}function Vx(u,o){return Math.max(u?u.right-u.left:0,o?o.right-o.left:0)}function zT(u,o,c,f,m,v){const E=i1(c,m,v),S=Vx(c,f)*v;let M=0;const R=n1(u)/2;for(let U=0;U<u.length-1;U++){const H=u[U],q=u[U+1],K=H.dist(q);if(M+K>R){const $=(R-M)/K,ie=Zi(H.x,q.x,$),me=Zi(H.y,q.y,$),Me=new rd(ie,me,0,q.angleTo(H),U);return!E||Ux(u,Me,S,E,o)?Me:void 0}M+=K}}function UT(u,o,c,f,m,v,E,S,M){const R=i1(f,v,E),U=Vx(f,m),H=U*E,q=u[0].x===0||u[0].x===M||u[0].y===0||u[0].y===M;return o-H<o/4&&(o=H+o/4),Gx(u,q?o/2*S%o:(U/2+2*v)*E*S%o,o,R,c,H,q,!1,M)}function Gx(u,o,c,f,m,v,E,S,M){const R=v/2,U=n1(u);let H=0,q=o-c,K=[];for(let $=0;$<u.length-1;$++){const ie=u[$],me=u[$+1],Me=ie.dist(me),Ve=me.angleTo(ie);for(;q+c<H+Me;){q+=c;const Se=(q-H)/Me,ze=Zi(ie.x,me.x,Se),Ze=Zi(ie.y,me.y,Se);if(ze>=0&&ze<M&&Ze>=0&&Ze<M&&q-R>=0&&q+R<=U){const qe=new rd(ze,Ze,0,Ve,$);qe._round(),f&&!Ux(u,qe,v,f,m)||K.push(qe)}}H+=Me}return S||K.length||E||(K=Gx(u,H/2,c,f,m,v,E,!0,M)),K}function Hx(u,o,c,f,m){const v=[];for(let E=0;E<u.length;E++){const S=u[E];let M;for(let R=0;R<S.length-1;R++){let U=S[R],H=S[R+1];U.x<o&&H.x<o||(U.x<o?U=new J(o,U.y+(o-U.x)/(H.x-U.x)*(H.y-U.y))._round():H.x<o&&(H=new J(o,U.y+(o-U.x)/(H.x-U.x)*(H.y-U.y))._round()),U.y<c&&H.y<c||(U.y<c?U=new J(U.x+(c-U.y)/(H.y-U.y)*(H.x-U.x),c)._round():H.y<c&&(H=new J(U.x+(c-U.y)/(H.y-U.y)*(H.x-U.x),c)._round()),U.x>=f&&H.x>=f||(U.x>=f?U=new J(f,U.y+(f-U.x)/(H.x-U.x)*(H.y-U.y))._round():H.x>=f&&(H=new J(f,U.y+(f-U.x)/(H.x-U.x)*(H.y-U.y))._round()),U.y>=m&&H.y>=m||(U.y>=m?U=new J(U.x+(m-U.y)/(H.y-U.y)*(H.x-U.x),m)._round():H.y>=m&&(H=new J(U.x+(m-U.y)/(H.y-U.y)*(H.x-U.x),m)._round()),M&&U.equals(M[M.length-1])||(M=[U],v.push(M)),M.push(H)))))}}return v}Gn(rd,"Anchor");const s_=1e20;function jx(u,o,c,f,m,v,E,S,M){for(let R=o;R<o+f;R++)qx(u,c*v+R,v,m,E,S,M);for(let R=c;R<c+m;R++)qx(u,R*v+o,1,f,E,S,M)}function qx(u,o,c,f,m,v,E){v[0]=0,E[0]=-s_,E[1]=s_,m[0]=u[o];for(let S=1,M=0,R=0;S<f;S++){m[S]=u[o+S*c];const U=S*S;do{const H=v[M];R=(m[S]-m[H]+U-H*H)/(S-H)/2}while(R<=E[M]&&--M>-1);M++,v[M]=S,E[M]=R,E[M+1]=s_}for(let S=0,M=0;S<f;S++){for(;E[M+1]<S;)M++;const R=v[M],U=S-R;u[o+S*c]=m[R]+U*U}}const r1={none:0,ideographs:1,all:2};class qm{constructor(o,c,f){this.requestManager=o,this.localGlyphMode=c,this.localFontFamily=f,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(o){this.url=o}getGlyphs(o,c){const f=[];for(const m in o)for(const v of o[m])f.push({stack:m,id:v});at(f,({stack:m,id:v},E)=>{let S=this.entries[m];S||(S=this.entries[m]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let M=S.glyphs[v];if(M!==void 0)return void E(null,{stack:m,id:v,glyph:M});if(M=this._tinySDF(S,m,v),M)return S.glyphs[v]=M,void E(null,{stack:m,id:v,glyph:M});const R=Math.floor(v/256);if(256*R>65535)return void E(new Error("glyphs > 65535 not supported"));if(S.ranges[R])return void E(null,{stack:m,id:v,glyph:M});let U=S.requests[R];U||(U=S.requests[R]=[],qm.loadGlyphRange(m,R,this.url,this.requestManager,(H,q)=>{if(q){S.ascender=q.ascender,S.descender=q.descender;for(const K in q.glyphs)this._doesCharSupportLocalGlyph(+K)||(S.glyphs[+K]=q.glyphs[+K]);S.ranges[R]=!0}for(const K of U)K(H,q);delete S.requests[R]})),U.push((H,q)=>{H?E(H):q&&E(null,{stack:m,id:v,glyph:q.glyphs[v]||null})})},(m,v)=>{if(m)c(m);else if(v){const E={};for(const{stack:S,id:M,glyph:R}of v)E[S]===void 0&&(E[S]={}),E[S].glyphs===void 0&&(E[S].glyphs={}),E[S].glyphs[M]=R&&{id:R.id,bitmap:R.bitmap.clone(),metrics:R.metrics},E[S].ascender=this.entries[S].ascender,E[S].descender=this.entries[S].descender;c(null,E)}})}_doesCharSupportLocalGlyph(o){return this.localGlyphMode!==r1.none&&(this.localGlyphMode===r1.all?!!this.localFontFamily:!!this.localFontFamily&&(Am(o)||ly(o)||Sc(o)||zd(o)||Hp(o)))}_tinySDF(o,c,f){const m=this.localFontFamily;if(!m||!this._doesCharSupportLocalGlyph(f))return;let v=o.tinySDF;if(!v){let ie="400";/bold/i.test(c)?ie="900":/medium/i.test(c)?ie="500":/light/i.test(c)&&(ie="200"),v=o.tinySDF=new qm.TinySDF({fontFamily:m,fontWeight:ie,fontSize:48,buffer:6,radius:16}),v.fontWeight=ie}if(this.localGlyphs[v.fontWeight][f])return this.localGlyphs[v.fontWeight][f];const E=String.fromCharCode(f),{data:S,width:M,height:R,glyphWidth:U,glyphHeight:H,glyphLeft:q,glyphTop:K,glyphAdvance:$}=v.draw(E);return this.localGlyphs[v.fontWeight][f]={id:f,bitmap:new Rc({width:M,height:R},S),metrics:{width:U/2,height:H/2,left:q/2,top:K/2-27,advance:$/2,localGlyph:!0}}}}function Wx(u,o,c,f){const m=[],v=u.image,E=v.pixelRatio,S=v.paddedRect.w-2,M=v.paddedRect.h-2,R=u.right-u.left,U=u.bottom-u.top,H=v.stretchX||[[0,S]],q=v.stretchY||[[0,M]],K=(At,Yt)=>At+Yt[1]-Yt[0],$=H.reduce(K,0),ie=q.reduce(K,0),me=S-$,Me=M-ie;let Ve=0,Se=$,ze=0,Ze=ie,qe=0,It=me,bt=0,Vt=Me;if(v.content&&f){const At=v.content;Ve=Yy(H,0,At[0]),ze=Yy(q,0,At[1]),Se=Yy(H,At[0],At[2]),Ze=Yy(q,At[1],At[3]),qe=At[0]-Ve,bt=At[1]-ze,It=At[2]-At[0]-Se,Vt=At[3]-At[1]-Ze}const pn=(At,Yt,$t,hn)=>{const gn=Ky(At.stretch-Ve,Se,R,u.left),Lt=Jy(At.fixed-qe,It,At.stretch,$),Dn=Ky(Yt.stretch-ze,Ze,U,u.top),Ai=Jy(Yt.fixed-bt,Vt,Yt.stretch,ie),jn=Ky($t.stretch-Ve,Se,R,u.left),ai=Jy($t.fixed-qe,It,$t.stretch,$),Nn=Ky(hn.stretch-ze,Ze,U,u.top),Li=Jy(hn.fixed-bt,Vt,hn.stretch,ie),Cr=new J(gn,Dn),Tr=new J(jn,Dn),br=new J(jn,Nn),Ni=new J(gn,Nn),gs=new J(Lt/E,Ai/E),Ji=new J(ai/E,Li/E),Ar=o*Math.PI/180;if(Ar){const Os=Math.sin(Ar),Us=Math.cos(Ar),Ws=[Us,-Os,Os,Us];Cr._matMult(Ws),Tr._matMult(Ws),Ni._matMult(Ws),br._matMult(Ws)}const Is=At.stretch+At.fixed,zs=Yt.stretch+Yt.fixed;return{tl:Cr,tr:Tr,bl:Ni,br,tex:{x:v.paddedRect.x+1+Is,y:v.paddedRect.y+1+zs,w:$t.stretch+$t.fixed-Is,h:hn.stretch+hn.fixed-zs},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:gs,pixelOffsetBR:Ji,minFontScaleX:It/E/R,minFontScaleY:Vt/E/U,isSDF:c}};if(f&&(v.stretchX||v.stretchY)){const At=Xx(H,me,$),Yt=Xx(q,Me,ie);for(let $t=0;$t<At.length-1;$t++){const hn=At[$t],gn=At[$t+1];for(let Lt=0;Lt<Yt.length-1;Lt++)m.push(pn(hn,Yt[Lt],gn,Yt[Lt+1]))}}else m.push(pn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:S+1},{fixed:0,stretch:M+1}));return m}function Yy(u,o,c){let f=0;for(const m of u)f+=Math.max(o,Math.min(c,m[1]))-Math.max(o,Math.min(c,m[0]));return f}function Xx(u,o,c){const f=[{fixed:-1,stretch:0}];for(const[m,v]of u){const E=f[f.length-1];f.push({fixed:m-E.stretch,stretch:E.stretch}),f.push({fixed:m-E.stretch,stretch:E.stretch+(v-m)})}return f.push({fixed:o+1,stretch:c}),f}function Ky(u,o,c,f){return u/o*c+f}function Jy(u,o,c,f){return u-o*c/f}function VT(u,o,c,f){const m=o+u.positionedLines[f].lineOffset;return f===0?c+m/2:c+(m+(o+u.positionedLines[f-1].lineOffset))/2}qm.loadGlyphRange=function(u,o,c,f,m){const v=256*o,E=v+255,S=f.transformRequest(f.normalizeGlyphsURL(c).replace("{fontstack}",u).replace("{range}",`${v}-${E}`),Xt.Glyphs);js(S,(M,R)=>{if(M)m(M);else if(R){const U={},H=function(q){return new Kd(q).readFields(OT,{})}(R);for(const q of H.glyphs)U[q.id]=q;m(null,{glyphs:U,ascender:H.ascender,descender:H.descender})}})},qm.TinySDF=class{constructor({fontSize:u=24,buffer:o=3,radius:c=8,cutoff:f=.25,fontFamily:m="sans-serif",fontWeight:v="normal",fontStyle:E="normal"}={}){this.buffer=o,this.cutoff=f,this.radius=c;const S=this.size=u+4*o,M=this._createCanvas(S),R=this.ctx=M.getContext("2d",{willReadFrequently:!0});R.font=`${E} ${v} ${u}px ${m}`,R.textBaseline="alphabetic",R.textAlign="left",R.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Uint16Array(S)}_createCanvas(u){const o=document.createElement("canvas");return o.width=o.height=u,o}draw(u){const{width:o,actualBoundingBoxAscent:c,actualBoundingBoxDescent:f,actualBoundingBoxLeft:m,actualBoundingBoxRight:v}=this.ctx.measureText(u),E=Math.ceil(c),S=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(v-m))),M=Math.min(this.size-this.buffer,E+Math.ceil(f)),R=S+2*this.buffer,U=M+2*this.buffer,H=Math.max(R*U,0),q=new Uint8ClampedArray(H),K={data:q,width:R,height:U,glyphWidth:S,glyphHeight:M,glyphTop:E,glyphLeft:0,glyphAdvance:o};if(S===0||M===0)return K;const{ctx:$,buffer:ie,gridInner:me,gridOuter:Me}=this;$.clearRect(ie,ie,S,M),$.fillText(u,ie,ie+E);const Ve=$.getImageData(ie,ie,S,M);Me.fill(s_,0,H),me.fill(0,0,H);for(let Se=0;Se<M;Se++)for(let ze=0;ze<S;ze++){const Ze=Ve.data[4*(Se*S+ze)+3]/255;if(Ze===0)continue;const qe=(Se+ie)*R+ze+ie;if(Ze===1)Me[qe]=0,me[qe]=s_;else{const It=.5-Ze;Me[qe]=It>0?It*It:0,me[qe]=It<0?It*It:0}}jx(Me,0,0,R,U,R,this.f,this.v,this.z),jx(me,ie,ie,S,M,R,this.f,this.v,this.z);for(let Se=0;Se<H;Se++){const ze=Math.sqrt(Me[Se])-Math.sqrt(me[Se]);q[Se]=Math.round(255-255*(ze/this.radius+this.cutoff))}return K}};class GT{constructor(o=[],c=HT){if(this.data=o,this.length=this.data.length,this.compare=c,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(o){this.data.push(o),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const o=this.data[0],c=this.data.pop();return this.length--,this.length>0&&(this.data[0]=c,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:c,compare:f}=this,m=c[o];for(;o>0;){const v=o-1>>1,E=c[v];if(f(m,E)>=0)break;c[o]=E,o=v}c[o]=m}_down(o){const{data:c,compare:f}=this,m=this.length>>1,v=c[o];for(;o<m;){let E=1+(o<<1),S=c[E];const M=E+1;if(M<this.length&&f(c[M],S)<0&&(E=M,S=c[M]),f(S,v)>=0)break;c[o]=S,o=E}c[o]=v}}function HT(u,o){return u<o?-1:u>o?1:0}function jT(u,o=1,c=!1){let f=1/0,m=1/0,v=-1/0,E=-1/0;const S=u[0];for(let K=0;K<S.length;K++){const $=S[K];(!K||$.x<f)&&(f=$.x),(!K||$.y<m)&&(m=$.y),(!K||$.x>v)&&(v=$.x),(!K||$.y>E)&&(E=$.y)}const M=Math.min(v-f,E-m);let R=M/2;const U=new GT([],qT);if(M===0)return new J(f,m);for(let K=f;K<v;K+=M)for(let $=m;$<E;$+=M)U.push(new Wm(K+R,$+R,R,u));let H=function(K){let $=0,ie=0,me=0;const Me=K[0];for(let Ve=0,Se=Me.length,ze=Se-1;Ve<Se;ze=Ve++){const Ze=Me[Ve],qe=Me[ze],It=Ze.x*qe.y-qe.x*Ze.y;ie+=(Ze.x+qe.x)*It,me+=(Ze.y+qe.y)*It,$+=3*It}return new Wm(ie/$,me/$,0,K)}(u),q=U.length;for(;U.length;){const K=U.pop();(K.d>H.d||!H.d)&&(H=K,c&&console.log("found best %d after %d probes",Math.round(1e4*K.d)/1e4,q)),K.max-H.d<=o||(R=K.h/2,U.push(new Wm(K.p.x-R,K.p.y-R,R,u)),U.push(new Wm(K.p.x+R,K.p.y-R,R,u)),U.push(new Wm(K.p.x-R,K.p.y+R,R,u)),U.push(new Wm(K.p.x+R,K.p.y+R,R,u)),q+=4)}return c&&(console.log(`num probes: ${q}`),console.log(`best distance: ${H.d}`)),H.p}function qT(u,o){return o.max-u.max}function Wm(u,o,c,f){this.p=new J(u,o),this.h=c,this.d=function(m,v){let E=!1,S=1/0;for(let M=0;M<v.length;M++){const R=v[M];for(let U=0,H=R.length,q=H-1;U<H;q=U++){const K=R[U],$=R[q];K.y>m.y!=$.y>m.y&&m.x<($.x-K.x)*(m.y-K.y)/($.y-K.y)+K.x&&(E=!E),S=Math.min(S,Qb(m,K,$))}}return(E?1:-1)*Math.sqrt(S)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}const s1=Number.POSITIVE_INFINITY,WT=Math.sqrt(2);function Zx(u,[o,c]){let f=0,m=0;if(c===s1){o<0&&(o=0);const v=o/WT;switch(u){case"top-right":case"top-left":m=v-7;break;case"bottom-right":case"bottom-left":m=7-v;break;case"bottom":m=7-o;break;case"top":m=o-7}switch(u){case"top-right":case"bottom-right":f=-v;break;case"top-left":case"bottom-left":f=v;break;case"left":f=o;break;case"right":f=-o}}else{switch(o=Math.abs(o),c=Math.abs(c),u){case"top-right":case"top-left":case"top":m=c-7;break;case"bottom-right":case"bottom-left":case"bottom":m=7-c}switch(u){case"top-right":case"bottom-right":case"right":f=-o;break;case"top-left":case"bottom-left":case"left":f=o}}return[f,m]}function XT(u,o,c,f,m,v,E,S,M,R){u.createArrays(),u.tilePixelRatio=Mi/(512*u.overscaling),u.compareText={},u.iconsNeedLinear=!1;const U=u.layers[0].layout,H=u.layers[0]._unevaluatedLayout._values,q={};if(u.textSizeData.kind==="composite"){const{minZoom:ie,maxZoom:me}=u.textSizeData;q.compositeTextSizes=[H["text-size"].possiblyEvaluate(new ft(ie),S),H["text-size"].possiblyEvaluate(new ft(me),S)]}if(u.iconSizeData.kind==="composite"){const{minZoom:ie,maxZoom:me}=u.iconSizeData;q.compositeIconSizes=[H["icon-size"].possiblyEvaluate(new ft(ie),S),H["icon-size"].possiblyEvaluate(new ft(me),S)]}q.layoutTextSize=H["text-size"].possiblyEvaluate(new ft(M+1),S),q.layoutIconSize=H["icon-size"].possiblyEvaluate(new ft(M+1),S),q.textMaxSize=H["text-size"].possiblyEvaluate(new ft(18),S);const K=U.get("text-rotation-alignment")==="map"&&U.get("symbol-placement")!=="point",$=U.get("text-size");for(const ie of u.features){const me=U.get("text-font").evaluate(ie,{},S).join(","),Me=$.evaluate(ie,{},S),Ve=q.layoutTextSize.evaluate(ie,{},S),Se=(q.layoutIconSize.evaluate(ie,{},S),{horizontal:{},vertical:void 0}),ze=ie.text;let Ze,qe=[0,0];if(ze){const Vt=ze.toString(),pn=U.get("text-letter-spacing").evaluate(ie,{},S)*va,At=U.get("text-line-height").evaluate(ie,{},S)*va,Yt=C(Vt)?pn:0,$t=U.get("text-anchor").evaluate(ie,{},S),hn=U.get("text-variable-anchor");if(!hn){const jn=U.get("text-radial-offset").evaluate(ie,{},S);qe=jn?Zx($t,[jn*va,s1]):U.get("text-offset").evaluate(ie,{},S).map(ai=>ai*va)}let gn=K?"center":U.get("text-justify").evaluate(ie,{},S);const Lt=U.get("symbol-placement")==="point",Dn=Lt?U.get("text-max-width").evaluate(ie,{},S)*va:1/0,Ai=jn=>{u.allowVerticalPlacement&&w(Vt)&&(Se.vertical=e1(ze,o,c,m,me,Dn,At,$t,jn,Yt,qe,Ku.vertical,!0,Ve,Me))};if(!K&&hn){const jn=gn==="auto"?hn.map(Nn=>o_(Nn)):[gn];let ai=!1;for(let Nn=0;Nn<jn.length;Nn++){const Li=jn[Nn];if(!Se.horizontal[Li])if(ai)Se.horizontal[Li]=Se.horizontal[0];else{const Cr=e1(ze,o,c,m,me,Dn,At,"center",Li,Yt,qe,Ku.horizontal,!1,Ve,Me);Cr&&(Se.horizontal[Li]=Cr,ai=Cr.positionedLines.length===1)}}Ai("left")}else{if(gn==="auto"&&(gn=o_($t)),Lt||U.get("text-writing-mode").indexOf("horizontal")>=0||!w(Vt)){const jn=e1(ze,o,c,m,me,Dn,At,$t,gn,Yt,qe,Ku.horizontal,!1,Ve,Me);jn&&(Se.horizontal[gn]=jn)}Ai(Lt?"left":gn)}}let It=!1;if(ie.icon&&ie.icon.name){const Vt=f[ie.icon.name];Vt&&(Ze=BT(m[ie.icon.name],U.get("icon-offset").evaluate(ie,{},S),U.get("icon-anchor").evaluate(ie,{},S)),It=Vt.sdf,u.sdfIcons===void 0?u.sdfIcons=Vt.sdf:u.sdfIcons!==Vt.sdf&&Zn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Vt.pixelRatio!==u.pixelRatio||U.get("icon-rotate").constantOr(1)!==0)&&(u.iconsNeedLinear=!0))}const bt=Jx(Se.horizontal)||Se.vertical;u.iconsInText||(u.iconsInText=!!bt&&bt.iconsInText),(bt||Ze)&&Yx(u,ie,Se,Ze,f,q,Ve,0,qe,It,E,S,R)}v&&u.generateCollisionDebugBuffers(M,u.collisionBoxArray)}function o_(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Yx(u,o,c,f,m,v,E,S,M,R,U,H,q){let K=v.textMaxSize.evaluate(o,{},H);K===void 0&&(K=E);const $=u.layers[0].layout,ie=$.get("icon-offset").evaluate(o,{},H),me=Jx(c.horizontal)||c.vertical,Me=q.name==="globe",Ve=E/24,Se=u.tilePixelRatio*K/24,ze=(Yt=u.overscaling,u.zoom>18&&Yt>2&&(Yt>>=1),Math.max(Mi/(512*Yt),1)*$.get("symbol-spacing")),Ze=$.get("text-padding")*u.tilePixelRatio,qe=$.get("icon-padding")*u.tilePixelRatio,It=De($.get("text-max-angle")),bt=$.get("text-rotation-alignment")==="map"&&$.get("symbol-placement")!=="point",Vt=$.get("icon-rotation-alignment")==="map"&&$.get("symbol-placement")!=="point",pn=$.get("symbol-placement"),At=ze/2;var Yt;const $t=$.get("icon-text-fit");let hn;f&&$t!=="none"&&(u.allowVerticalPlacement&&c.vertical&&(hn=zx(f,c.vertical,$t,$.get("icon-text-fit-padding"),ie,Ve)),me&&(f=zx(f,me,$t,$.get("icon-text-fit-padding"),ie,Ve)));const gn=(Lt,Dn,Ai)=>{if(Dn.x<0||Dn.x>=Mi||Dn.y<0||Dn.y>=Mi)return;let jn=null;if(Me){const{x:ai,y:Nn,z:Li}=q.projectTilePoint(Dn.x,Dn.y,Ai);jn={anchor:new rd(ai,Nn,Li,0,void 0),up:q.upVector(Ai,Dn.x,Dn.y)}}(function(ai,Nn,Li,Cr,Tr,br,Ni,gs,Ji,Ar,Is,zs,Os,Us,Ws,Mo,hl,_s,ua,Qo,Jr,co,ba,Ts,Vo){const $l=ai.addToLineVertexArray(Nn,Cr);let fl,dl,Iu,pl,tm,av,m1,g1=0,yC=0,vC=0,bC=0,pw=-1,mw=-1;const ep={};let xC=Vd("");const f_=Li?Li.anchor:Nn;let gw=0,_w=0;if(Ji._unevaluatedLayout.getValue("text-radial-offset")===void 0?[gw,_w]=Ji.layout.get("text-offset").evaluate(Jr,{},Vo).map(Dc=>Dc*va):(gw=Ji.layout.get("text-radial-offset").evaluate(Jr,{},Vo)*va,_w=s1),ai.allowVerticalPlacement&&Tr.vertical){const Dc=Tr.vertical;if(Ws)av=a_(Dc),gs&&(m1=a_(gs));else{const Oc=Ji.layout.get("text-rotate").evaluate(Jr,{},Vo)+90;Iu=Qy(Ar,f_,Nn,Is,zs,Os,Dc,Us,Oc,Mo),gs&&(pl=Qy(Ar,f_,Nn,Is,zs,Os,gs,_s,Oc))}}if(br){const Dc=Ji.layout.get("icon-rotate").evaluate(Jr,{},Vo),Oc=Ji.layout.get("icon-text-fit")!=="none",_1=Wx(br,Dc,ba,Oc),vw=gs?Wx(gs,Dc,ba,Oc):void 0;dl=Qy(Ar,f_,Nn,Is,zs,Os,br,_s,Dc),g1=4*_1.length;const EC=ai.iconSizeData;let d_=null;EC.kind==="source"?(d_=[Ba*Ji.layout.get("icon-size").evaluate(Jr,{},Vo)],d_[0]>sd&&Zn(`${ai.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):EC.kind==="composite"&&(d_=[Ba*co.compositeIconSizes[0].evaluate(Jr,{},Vo),Ba*co.compositeIconSizes[1].evaluate(Jr,{},Vo)],(d_[0]>sd||d_[1]>sd)&&Zn(`${ai.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),ai.addSymbols(ai.icon,_1,d_,Qo,ua,Jr,!1,Li,Nn,$l.lineStartIndex,$l.lineLength,-1,Ts,Vo),pw=ai.icon.placedSymbolArray.length-1,vw&&(yC=4*vw.length,ai.addSymbols(ai.icon,vw,d_,Qo,ua,Jr,Ku.vertical,Li,Nn,$l.lineStartIndex,$l.lineLength,-1,Ts,Vo),mw=ai.icon.placedSymbolArray.length-1)}for(const Dc in Tr.horizontal){const Oc=Tr.horizontal[Dc];fl||(xC=Vd(Oc.text),Ws?tm=a_(Oc):fl=Qy(Ar,f_,Nn,Is,zs,Os,Oc,Us,Ji.layout.get("text-rotate").evaluate(Jr,{},Vo),Mo));const _1=Oc.positionedLines.length===1;if(vC+=Kx(ai,Li,Nn,Oc,Ni,Ji,Ws,Jr,Mo,$l,Tr.vertical?Ku.horizontal:Ku.horizontalOnly,_1?Object.keys(Tr.horizontal):[Dc],ep,pw,co,Ts,Vo),_1)break}Tr.vertical&&(bC+=Kx(ai,Li,Nn,Tr.vertical,Ni,Ji,Ws,Jr,Mo,$l,Ku.vertical,["vertical"],ep,mw,co,Ts,Vo));let Zm=-1;const yw=(Dc,Oc)=>Dc?Math.max(Dc,Oc):Oc;Zm=yw(tm,Zm),Zm=yw(av,Zm),Zm=yw(m1,Zm);const SP=Zm>-1?1:0;ai.glyphOffsetArray.length>=Qd.MAX_GLYPHS&&Zn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Jr.sortKey!==void 0&&ai.addToSortKeyRanges(ai.symbolInstances.length,Jr.sortKey),ai.symbolInstances.emplaceBack(f_.x,f_.y,f_.z,Nn.x,Nn.y,ep.right>=0?ep.right:-1,ep.center>=0?ep.center:-1,ep.left>=0?ep.left:-1,ep.vertical>=0?ep.vertical:-1,pw,mw,xC,fl!==void 0?fl:ai.collisionBoxArray.length,fl!==void 0?fl+1:ai.collisionBoxArray.length,Iu!==void 0?Iu:ai.collisionBoxArray.length,Iu!==void 0?Iu+1:ai.collisionBoxArray.length,dl!==void 0?dl:ai.collisionBoxArray.length,dl!==void 0?dl+1:ai.collisionBoxArray.length,pl||ai.collisionBoxArray.length,pl?pl+1:ai.collisionBoxArray.length,Is,vC,bC,g1,yC,SP,0,gw,_w,Zm)})(u,Dn,jn,Lt,c,f,m,hn,u.layers[0],u.collisionBoxArray,o.index,o.sourceLayerIndex,u.index,Ze,bt,M,0,qe,Vt,ie,o,v,R,U,H)};if(pn==="line")for(const Lt of Hx(o.geometry,0,0,Mi,Mi)){const Dn=UT(Lt,ze,It,c.vertical||me,f,24,Se,u.overscaling,Mi);for(const Ai of Dn){const jn=me;jn&&ZT(u,jn.text,At,Ai)||gn(Lt,Ai,H)}}else if(pn==="line-center"){for(const Lt of o.geometry)if(Lt.length>1){const Dn=zT(Lt,It,c.vertical||me,f,24,Se);Dn&&gn(Lt,Dn,H)}}else if(o.type==="Polygon")for(const Lt of Ny(o.geometry,0)){const Dn=jT(Lt,16);gn(Lt[0],new rd(Dn.x,Dn.y,0,0,void 0),H)}else if(o.type==="LineString")for(const Lt of o.geometry)gn(Lt,new rd(Lt[0].x,Lt[0].y,0,0,void 0),H);else if(o.type==="Point")for(const Lt of o.geometry)for(const Dn of Lt)gn([Dn],new rd(Dn.x,Dn.y,0,0,void 0),H)}const sd=32640;function Kx(u,o,c,f,m,v,E,S,M,R,U,H,q,K,$,ie,me){const Me=function(ze,Ze,qe,It,bt,Vt,pn,At){const Yt=[];if(Ze.positionedLines.length===0)return Yt;const $t=It.layout.get("text-rotate").evaluate(Vt,{})*Math.PI/180,hn=function(jn){const ai=jn[0],Nn=jn[1],Li=ai*Nn;return Li>0?[ai,-Nn]:Li<0?[-ai,Nn]:ai===0?[Nn,ai]:[Nn,-ai]}(qe);let gn=Math.abs(Ze.top-Ze.bottom);for(const jn of Ze.positionedLines)gn-=jn.lineOffset;const Lt=Ze.positionedLines.length,Dn=gn/Lt;let Ai=Ze.top-qe[1];for(let jn=0;jn<Lt;++jn){const ai=Ze.positionedLines[jn];Ai=VT(Ze,Dn,Ai,jn);for(const Nn of ai.positionedGlyphs){if(!Nn.rect)continue;const Li=Nn.rect||{};let Cr=4,Tr=!0,br=1,Ni=0;if(Nn.imageName){const Ts=pn[Nn.imageName];if(!Ts)continue;if(Ts.sdf){Zn("SDF images are not supported in formatted text and will be ignored.");continue}Tr=!1,br=Ts.pixelRatio,Cr=1/br}const gs=(bt||At)&&Nn.vertical,Ji=Nn.metrics.advance*Nn.scale/2,Ar=Nn.metrics,Is=Nn.rect;if(Is===null)continue;At&&Ze.verticalizable&&(Ni=Nn.imageName?Ji-Nn.metrics.width*Nn.scale/2:0);const zs=bt?[Nn.x+Ji,Nn.y]:[0,0];let Os=[0,0],Us=[0,0],Ws=!1;bt||(gs?(Us=[Nn.x+Ji+hn[0],Nn.y+hn[1]-Ni],Ws=!0):Os=[Nn.x+Ji+qe[0],Nn.y+qe[1]-Ni]);const Mo=Is.w*Nn.scale/(br*(Nn.localGlyph?2:1)),hl=Is.h*Nn.scale/(br*(Nn.localGlyph?2:1));let _s,ua,Qo,Jr;if(gs){const Ts=Nn.y-Ai,Vo=new J(-Ji,Ji-Ts),$l=-Math.PI/2,fl=new J(...Us);_s=new J(-Ji+Os[0],Os[1]),_s._rotateAround($l,Vo)._add(fl),_s.x+=-Ts+Ji,_s.y-=(Ar.left-Cr)*Nn.scale;const dl=Nn.imageName?Ar.advance*Nn.scale:va*Nn.scale,Iu=String.fromCharCode(Nn.glyph);ST(Iu)?_s.x+=(1-Cr)*Nn.scale:Cx(Iu)?_s.x+=dl-Ar.height*Nn.scale+(-Cr-1)*Nn.scale:_s.x+=Nn.imageName||Ar.width+2*Cr===Is.w&&Ar.height+2*Cr===Is.h?(dl-hl)/2:(dl-(Ar.height+2*Cr)*Nn.scale)/2,ua=new J(_s.x,_s.y-Mo),Qo=new J(_s.x+hl,_s.y),Jr=new J(_s.x+hl,_s.y-Mo)}else{const Ts=(Ar.left-Cr)*Nn.scale-Ji+Os[0],Vo=(-Ar.top-Cr)*Nn.scale+Os[1],$l=Ts+Mo,fl=Vo+hl;_s=new J(Ts,Vo),ua=new J($l,Vo),Qo=new J(Ts,fl),Jr=new J($l,fl)}if($t){let Ts;Ts=bt?new J(0,0):Ws?new J(hn[0],hn[1]):new J(qe[0],qe[1]),_s._rotateAround($t,Ts),ua._rotateAround($t,Ts),Qo._rotateAround($t,Ts),Jr._rotateAround($t,Ts)}const co=new J(0,0),ba=new J(0,0);Yt.push({tl:_s,tr:ua,bl:Qo,br:Jr,tex:Li,writingMode:Ze.writingMode,glyphOffset:zs,sectionIndex:Nn.sectionIndex,isSDF:Tr,pixelOffsetTL:co,pixelOffsetBR:ba,minFontScaleX:0,minFontScaleY:0})}}return Yt}(0,f,M,v,E,S,m,u.allowVerticalPlacement),Ve=u.textSizeData;let Se=null;Ve.kind==="source"?(Se=[Ba*v.layout.get("text-size").evaluate(S,{},me)],Se[0]>sd&&Zn(`${u.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Ve.kind==="composite"&&(Se=[Ba*$.compositeTextSizes[0].evaluate(S,{},me),Ba*$.compositeTextSizes[1].evaluate(S,{},me)],(Se[0]>sd||Se[1]>sd)&&Zn(`${u.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),u.addSymbols(u.text,Me,Se,M,E,S,U,o,c,R.lineStartIndex,R.lineLength,K,ie,me);for(const ze of H)q[ze]=u.text.placedSymbolArray.length-1;return 4*Me.length}function Jx(u){for(const o in u)return u[o];return null}function Qy(u,o,c,f,m,v,E,S,M,R){let U=E.top,H=E.bottom,q=E.left,K=E.right;const $=E.collisionPadding;if($&&(q-=$[0],U-=$[1],K+=$[2],H+=$[3]),M){const ie=new J(q,U),me=new J(K,U),Me=new J(q,H),Ve=new J(K,H),Se=De(M);let ze=new J(0,0);R&&(ze=new J(R[0],R[1])),ie._rotateAround(Se,ze),me._rotateAround(Se,ze),Me._rotateAround(Se,ze),Ve._rotateAround(Se,ze),q=Math.min(ie.x,me.x,Me.x,Ve.x),K=Math.max(ie.x,me.x,Me.x,Ve.x),U=Math.min(ie.y,me.y,Me.y,Ve.y),H=Math.max(ie.y,me.y,Me.y,Ve.y)}return u.emplaceBack(o.x,o.y,o.z,c.x,c.y,q,U,K,H,S,f,m,v),u.length-1}function a_(u){u.collisionPadding&&(u.top-=u.collisionPadding[1],u.bottom+=u.collisionPadding[3]);const o=u.bottom-u.top;return o>0?Math.max(10,o):null}function ZT(u,o,c,f){const m=u.compareText;if(o in m){const v=m[o];for(let E=v.length-1;E>=0;E--)if(f.dist(v[E])<c)return!0}else m[o]=[];return m[o].push(f),!1}function Qx(u,o){const c=u.fovAboveCenter,f=u.elevation?u.elevation.getMinElevationBelowMSL()*o:0,m=(u._camera.position[2]*u.worldSize-f)/Math.cos(u._pitch),v=Math.sin(c)*m/Math.sin(Math.max(Math.PI/2-u._pitch-c,.01)),E=Math.sin(u._pitch)*v+m;return Math.min(1.01*E,m*(1/u._horizonShift))}function $p(u,o){if(!o.isReprojectedInTileSpace)return{scale:1<<u.z,x:u.x,y:u.y,x2:u.x+1,y2:u.y+1,projection:o};const c=Math.pow(2,-u.z),f=u.x*c,m=(u.x+1)*c,v=u.y*c,E=(u.y+1)*c,S=Zu(f),M=Zu(m),R=Fa(v),U=Fa(E),H=o.project(S,R),q=o.project(M,R),K=o.project(M,U),$=o.project(S,U);let ie=Math.min(H.x,q.x,K.x,$.x),me=Math.min(H.y,q.y,K.y,$.y),Me=Math.max(H.x,q.x,K.x,$.x),Ve=Math.max(H.y,q.y,K.y,$.y);const Se=c/16;function ze(qe,It,bt,Vt,pn,At){const Yt=(bt+pn)/2,$t=(Vt+At)/2,hn=o.project(Zu(Yt),Fa($t)),gn=Math.max(0,ie-hn.x,me-hn.y,hn.x-Me,hn.y-Ve);ie=Math.min(ie,hn.x),Me=Math.max(Me,hn.x),me=Math.min(me,hn.y),Ve=Math.max(Ve,hn.y),gn>Se&&(ze(qe,hn,bt,Vt,Yt,$t),ze(hn,It,Yt,$t,pn,At))}ze(H,q,f,v,m,v),ze(q,K,m,v,m,E),ze(K,$,m,E,f,E),ze($,H,f,E,f,v),ie-=Se,me-=Se,Me+=Se,Ve+=Se;const Ze=1/Math.max(Me-ie,Ve-me);return{scale:Ze,x:ie*Ze,y:me*Ze,x2:Me*Ze,y2:Ve*Ze,projection:o}}const bu=_u(new Float32Array(16));class hf{constructor(o){this.spec=o,this.name=o.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(o,c){return{x:0,y:0,z:0}}unproject(o,c){return new kr(0,0)}projectTilePoint(o,c,f){return{x:o,y:c,z:0}}locationPoint(o,c,f=!0){return o._coordinatePoint(o.locationCoordinate(c),f)}pixelsPerMeter(o,c){return yh(1,o)*c}pixelSpaceConversion(o,c,f){return 1}farthestPixelDistance(o){return Qx(o,o.pixelsPerMeter)}pointCoordinate(o,c,f,m){const v=o.horizonLineFromTop(!1),E=new J(c,Math.max(v,f));return o.rayIntersectionCoordinate(o.pointRayIntersection(E,m))}pointCoordinate3D(o,c,f){const m=new J(c,f);if(o.elevation)return o.elevation.pointCoordinate(m);{const v=this.pointCoordinate(o,m.x,m.y,0);return[v.x,v.y,v.z]}}isPointAboveHorizon(o,c){if(o.elevation)return!this.pointCoordinate3D(o,c.x,c.y);const f=o.horizonLineFromTop();return c.y<f}createInversionMatrix(o,c){return bu}createTileMatrix(o,c,f){let m,v,E;const S=f.canonical,M=_u(new Float64Array(16));if(this.isReprojectedInTileSpace){const R=$p(S,this);m=1,v=R.x+f.wrap*R.scale,E=R.y,qd(M,M,[m/R.scale,m/R.scale,o.pixelsPerMeter/c])}else m=c/o.zoomScale(S.z),v=(S.x+Math.pow(2,S.z)*f.wrap)*m,E=S.y*m;return zg(M,M,[v,E,0]),qd(M,M,[m/Mi,m/Mi,1]),M}upVector(o,c,f){return[0,0,1]}upVectorScale(o,c,f){return{metersToTile:1}}}class YT extends hf{constructor(o){super(o),this.range=[4,7],this.center=o.center||[-96,37.5];const[c,f]=this.parallels=o.parallels||[29.5,45.5],m=Math.sin(De(c));this.n=(m+Math.sin(De(f)))/2,this.c=1+m*(2*this.n-m),this.r0=Math.sqrt(this.c)/this.n}project(o,c){const{n:f,c:m,r0:v}=this,E=De(o-this.center[0]),S=De(c),M=Math.sqrt(m-2*f*Math.sin(S))/f;return{x:M*Math.sin(E*f),y:M*Math.cos(E*f)-v,z:0}}unproject(o,c){const{n:f,c:m,r0:v}=this,E=v+c;let S=Math.atan2(o,Math.abs(E))*Math.sign(E);E*f<0&&(S-=Math.PI*Math.sign(o)*Math.sign(E));const M=De(this.center[0])*f;S=Ue(S,-Math.PI-M,Math.PI-M);const R=it(fe(S/f)+this.center[0],-180,180),U=Math.asin(it((m-(o*o+E*E)*f*f)/(2*f),-1,1)),H=it(fe(U),-Ds,Ds);return new kr(R,H)}}const l_=1.340264,u_=-.081106,c_=893e-6,em=.003796,$y=Math.sqrt(3)/2;class o1 extends hf{project(o,c){c=c/180*Math.PI,o=o/180*Math.PI;const f=Math.asin($y*Math.sin(c)),m=f*f,v=m*m*m;return{x:.5*(o*Math.cos(f)/($y*(l_+3*u_*m+v*(7*c_+9*em*m)))/Math.PI+.5),y:1-.5*(f*(l_+u_*m+v*(c_+em*m))/Math.PI+1),z:0}}unproject(o,c){o=(2*o-.5)*Math.PI;let f=c=(2*(1-c)-1)*Math.PI,m=f*f,v=m*m*m;for(let U,H,q,K=0;K<12&&(H=f*(l_+u_*m+v*(c_+em*m))-c,q=l_+3*u_*m+v*(7*c_+9*em*m),U=H/q,f=it(f-U,-Math.PI/3,Math.PI/3),m=f*f,v=m*m*m,!(Math.abs(U)<1e-12));++K);const E=$y*o*(l_+3*u_*m+v*(7*c_+9*em*m))/Math.cos(f),S=Math.asin(Math.sin(f)/$y),M=it(180*E/Math.PI,-180,180),R=it(180*S/Math.PI,-Ds,Ds);return new kr(M,R)}}class KT extends hf{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0}project(o,c){return{x:.5+o/360,y:.5-c/360,z:0}}unproject(o,c){const f=360*(o-.5),m=it(360*(.5-c),-Ds,Ds);return new kr(f,m)}}const Xm=Math.PI/2;function ev(u){return Math.tan((Xm+u)/2)}class JT extends hf{constructor(o){super(o),this.center=o.center||[0,30];const[c,f]=this.parallels=o.parallels||[30,30];let m=De(c),v=De(f);this.southernCenter=m+v<0,this.southernCenter&&(m=-m,v=-v);const E=Math.cos(m),S=ev(m);this.n=m===v?Math.sin(m):Math.log(E/Math.cos(v))/Math.log(ev(v)/S),this.f=E*Math.pow(ev(m),this.n)/this.n}project(o,c){c=De(c),this.southernCenter&&(c=-c),o=De(o-this.center[0]);const f=1e-6,{n:m,f:v}=this;v>0?c<-Xm+f&&(c=-Xm+f):c>Xm-f&&(c=Xm-f);const E=v/Math.pow(ev(c),m);let S=E*Math.sin(m*o),M=v-E*Math.cos(m*o);return S=.5*(S/Math.PI+.5),M=.5*(M/Math.PI+.5),{x:S,y:this.southernCenter?M:1-M,z:0}}unproject(o,c){o=(2*o-.5)*Math.PI,this.southernCenter&&(c=1-c),c=(2*(1-c)-.5)*Math.PI;const{n:f,f:m}=this,v=m-c,E=Math.sign(v),S=Math.sign(f)*Math.sqrt(o*o+v*v);let M=Math.atan2(o,Math.abs(v))*E;v*f<0&&(M-=Math.PI*Math.sign(o)*E);const R=it(fe(M/f)+this.center[0],-180,180),U=it(fe(2*Math.atan(Math.pow(m/S,1/f))-Xm),-Ds,Ds);return new kr(R,this.southernCenter?-U:U)}}class a1 extends hf{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(o,c){return{x:lf(o),y:uf(c),z:0}}unproject(o,c){const f=Zu(o),m=Fa(c);return new kr(f,m)}}const $x=De(Ds);class QT extends hf{project(o,c){const f=(c=De(c))*c,m=f*f;return{x:.5*((o=De(o))*(.8707-.131979*f+m*(m*(.003971*f-.001529*m)-.013791))/Math.PI+.5),y:1-.5*(c*(1.007226+f*(.015085+m*(.028874*f-.044475-.005916*m)))/Math.PI+1),z:0}}unproject(o,c){o=(2*o-.5)*Math.PI;let f=c=(2*(1-c)-1)*Math.PI,m=25,v=0,E=f*f;do{E=f*f;const R=E*E;v=(f*(1.007226+E*(.015085+R*(.028874*E-.044475-.005916*R)))-c)/(1.007226+E*(.045255+R*(.259866*E-.311325-.005916*11*R))),f=it(f-v,-$x,$x)}while(Math.abs(v)>1e-6&&--m>0);E=f*f;const S=it(fe(o/(.8707+E*(E*(E*E*E*(.003971-.001529*E)-.013791)-.131979))),-180,180),M=fe(f);return new kr(S,M)}}const eE=De(Ds);class l1 extends hf{project(o,c){c=De(c),o=De(o);const f=Math.cos(c),m=2/Math.PI,v=Math.acos(f*Math.cos(o/2)),E=Math.sin(v)/v,S=.5*(o*m+2*f*Math.sin(o/2)/E)||0,M=.5*(c+Math.sin(c)/E)||0;return{x:.5*(S/Math.PI+.5),y:1-.5*(M/Math.PI+1),z:0}}unproject(o,c){let f=o=(2*o-.5)*Math.PI,m=c=(2*(1-c)-1)*Math.PI,v=25;const E=1e-6;let S=0,M=0;do{const R=Math.cos(m),U=Math.sin(m),H=2*U*R,q=U*U,K=R*R,$=Math.cos(f/2),ie=Math.sin(f/2),me=2*$*ie,Me=ie*ie,Ve=1-K*$*$,Se=Ve?1/Ve:0,ze=Ve?Math.acos(R*$)*Math.sqrt(1/Ve):0,Ze=.5*(2*ze*R*ie+2*f/Math.PI)-o,qe=.5*(ze*U+m)-c,It=.5*Se*(K*Me+ze*R*$*q)+1/Math.PI,bt=Se*(me*H/4-ze*U*ie),Vt=.125*Se*(H*ie-ze*U*K*me),pn=.5*Se*(q*$+ze*Me*R)+.5,At=bt*Vt-pn*It;S=(qe*bt-Ze*pn)/At,M=(Ze*Vt-qe*It)/At,f=it(f-S,-Math.PI,Math.PI),m=it(m-M,-eE,eE)}while((Math.abs(S)>E||Math.abs(M)>E)&&--v>0);return new kr(fe(f),fe(m))}}class tv extends hf{constructor(o){super(o),this.center=o.center||[0,0],this.parallels=o.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(De(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(o,c){const{scale:f,cosPhi:m}=this;return{x:De(o)*m*f+.5,y:-Math.sin(De(c))/m*f+.5,z:0}}unproject(o,c){const{scale:f,cosPhi:m}=this,v=-(c-.5)/f,E=it(fe((o-.5)/f)/m,-180,180),S=Math.asin(it(v*m,-1,1)),M=it(fe(S),-Ds,Ds);return new kr(E,M)}}class $T extends a1{constructor(o){super(o),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(o,c,f){const m=Wg(o,c,f);return uo(m,m,Xg(gh(f))),{x:m[0],y:m[1],z:m[2]}}locationPoint(o,c){const f=Nm(c.lat,c.lng),m=Bo([],f),v=o.elevation?o.elevation.getAtPointOrZero(o.locationCoordinate(c),o._centerAltitude):o._centerAltitude;qp(f,f,m,yh(1,0)*Mi*v);const E=_u(new Float64Array(16));return $f(E,o.pixelMatrix,o.globeMatrix),uo(f,f,E),new J(f[0],f[1])}pixelsPerMeter(o,c){return yh(1,0)*c}pixelSpaceConversion(o,c,f){const m=yh(1,o)*c,v=Zi(yh(1,45)*c,m,f);return this.pixelsPerMeter(o,c)/v}createTileMatrix(o,c,f){const m=A0(gh(f.canonical));return $f(new Float64Array(16),o.globeMatrix,m)}createInversionMatrix(o,c){const{center:f}=o,m=Xg(gh(c));return Ug(m,m,De(f.lng)),dh(m,m,De(f.lat)),qd(m,m,[o._pixelsPerMercatorPixel,o._pixelsPerMercatorPixel,1]),Float32Array.from(m)}pointCoordinate(o,c,f,m){return Dm(o,c,f,!0)||new Fm(0,0)}pointCoordinate3D(o,c,f){const m=this.pointCoordinate(o,c,f,0);return[m.x,m.y,m.z]}isPointAboveHorizon(o,c){return!Dm(o,c.x,c.y,!1)}farthestPixelDistance(o){const c=function(m,v){const E=m.cameraToCenterDistance,S=m._centerAltitude*v,M=m._camera,R=m._camera.forward(),U=ph([],Il([],R,-E),[0,0,S]),H=m.worldSize/(2*Math.PI),q=[0,0,-H],K=m.width/m.height,$=Math.tan(m.fovAboveCenter),ie=Il([],M.up(),$),me=Il([],M.right(),$*K),Me=Bo([],ph([],ph([],R,ie),me)),Ve=[];let Se;if(new by(U,Me).closestPointOnSphere(q,H,Ve)){const ze=ph([],Ve,q),Ze=mh([],ze,U);Se=Math.cos(m.fovAboveCenter)*Wu(Ze)}else{const ze=mh([],U,q),Ze=mh([],q,U);Bo(Ze,Ze);const qe=Wu(ze)-H;Se=Math.sqrt(qe*(qe+2*H));const It=Math.acos(Se/(H+qe))-Math.acos(Mc(R,Ze));Se*=Math.cos(It)}return 1.01*Se}(o,this.pixelsPerMeter(o.center.lat,o.worldSize)),f=km(o.zoom);if(f>0){const m=Qx(o,yh(1,o.center.lat)*o.worldSize),v=o.worldSize/(2*Math.PI),E=Math.max(o.width,o.height)/o.worldSize*Math.PI;return Zi(c,m+v*(1-Math.cos(E)),Math.pow(f,10))}return c}upVector(o,c,f){return Wg(c,f,o,1)}upVectorScale(o){return{metersToTile:qg(wy(gh(o)))}}}function tE(u){const o=u.parallels,c=!!o&&Math.abs(o[0]+o[1])<.01;switch(u.name){case"mercator":return new a1(u);case"equirectangular":return new KT(u);case"naturalEarth":return new QT(u);case"equalEarth":return new o1(u);case"winkelTripel":return new l1(u);case"albers":return c?new tv(u):new YT(u);case"lambertConformalConic":return c?new tv(u):new JT(u);case"globe":return new $T(u)}throw new Error(`Invalid projection name: ${u.name}`)}const ew=Gy.types,tw=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function nv(u,o,c,f,m,v,E,S,M,R,U,H,q){const K=S?Math.min(sd,Math.round(S[0])):0,$=S?Math.min(sd,Math.round(S[1])):0;u.emplaceBack(o,c,Math.round(32*f),Math.round(32*m),v,E,(K<<1)+(M?1:0),$,16*R,16*U,256*H,256*q)}function iv(u,o,c,f,m,v,E){u.emplaceBack(o,c,f,m,v,E)}function rv(u,o,c,f,m){u.emplaceBack(o,c,f,m),u.emplaceBack(o,c,f,m),u.emplaceBack(o,c,f,m),u.emplaceBack(o,c,f,m)}function nw(u){for(const o of u.sections)if(ne(o.text))return!0;return!1}class u1{constructor(o){this.layoutVertexArray=new pu,this.indexArray=new _a,this.programConfigurations=o,this.segments=new Qs,this.dynamicLayoutVertexArray=new ss,this.opacityVertexArray=new cs,this.placedSymbolArray=new xb,this.globeExtVertexArray=new Ps}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(o,c,f,m){this.isEmpty()||(f&&(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Yu.members),this.indexBuffer=o.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=o.createVertexBuffer(this.dynamicLayoutVertexArray,xT.members,!0),this.opacityVertexBuffer=o.createVertexBuffer(this.opacityVertexArray,tw,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,Vm.members,!0)),this.opacityVertexBuffer.itemSize=1),(f||m)&&this.programConfigurations.upload(o))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Gn(u1,"SymbolBuffers");class c1{constructor(o,c,f){this.layoutVertexArray=new o,this.layoutAttributes=c,this.indexArray=new f,this.segments=new Qs,this.collisionVertexArray=new Ms,this.collisionVertexArrayExt=new la}upload(o){this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=o.createVertexBuffer(this.collisionVertexArray,ET.members,!0),this.collisionVertexBufferExt=o.createVertexBuffer(this.collisionVertexArrayExt,IT.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Gn(c1,"CollisionBuffers");class Qd{constructor(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(E=>E.id),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=_u([]),this.placementViewportMatrix=_u([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ir(this.zoom,c["text-size"]),this.iconSizeData=Ir(this.zoom,c["icon-size"]);const f=this.layers[0].layout,m=f.get("symbol-sort-key"),v=f.get("symbol-z-order");this.canOverlap=f.get("text-allow-overlap")||f.get("icon-allow-overlap")||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=v!=="viewport-y"&&m.constantOr(1)!==void 0,this.sortFeaturesByY=(v==="viewport-y"||v==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=f.get("text-writing-mode").map(E=>Ku[E]),this.stateDependentLayerIds=this.layers.filter(E=>E.isStateDependent()).map(E=>E.id),this.sourceID=o.sourceID,this.projection=o.projection}createArrays(){this.text=new u1(new Ac(this.layers,this.zoom,o=>/^text/.test(o))),this.icon=new u1(new Ac(this.layers,this.zoom,o=>/^icon/.test(o))),this.glyphOffsetArray=new g0,this.lineVertexArray=new _0,this.symbolInstances=new uy}calculateGlyphDependencies(o,c,f,m,v){for(let E=0;E<o.length;E++)if(c[o.charCodeAt(E)]=!0,m&&v){const S=os[o.charAt(E)];S&&(c[S.charCodeAt(0)]=!0)}}populate(o,c,f,m){const v=this.layers[0],E=v.layout,S=this.projection.name==="globe",M=E.get("text-font"),R=E.get("text-field"),U=E.get("icon-image"),H=(R.value.kind!=="constant"||R.value.value instanceof Zo&&!R.value.value.isEmpty()||R.value.value.toString().length>0)&&(M.value.kind!=="constant"||M.value.value.length>0),q=U.value.kind!=="constant"||!!U.value.value||Object.keys(U.parameters).length>0,K=E.get("symbol-sort-key");if(this.features=[],!H&&!q)return;const $=c.iconDependencies,ie=c.glyphDependencies,me=c.availableImages,Me=new ft(this.zoom);for(const{feature:Ve,id:Se,index:ze,sourceLayerIndex:Ze}of o){const qe=v._featureFilter.needGeometry,It=Yp(Ve,qe);if(!v._featureFilter.filter(Me,It,f))continue;if(qe||(It.geometry=td(Ve,f,m)),S&&Ve.type!==1&&f.z<=5){const At=It.geometry,Yt=.98078528056,$t=(hn,gn)=>Mc(Wg(hn.x,hn.y,f,1),Wg(gn.x,gn.y,f,1))<Yt;for(let hn=0;hn<At.length;hn++)At[hn]=kI(At[hn],$t)}let bt,Vt;if(H){const At=v.getValueAndResolveTokens("text-field",It,f,me),Yt=Zo.factory(At);nw(Yt)&&(this.hasRTLText=!0),(!this.hasRTLText||Xe()==="unavailable"||this.hasRTLText&&Ke.isParsed())&&(bt=wT(Yt,v,It))}if(q){const At=v.getValueAndResolveTokens("icon-image",It,f,me);Vt=At instanceof da?At:da.fromString(At)}if(!bt&&!Vt)continue;const pn=this.sortFeaturesByKey?K.evaluate(It,{},f):void 0;if(this.features.push({id:Se,text:bt,icon:Vt,index:ze,sourceLayerIndex:Ze,geometry:It.geometry,properties:Ve.properties,type:ew[Ve.type],sortKey:pn}),Vt&&($[Vt.name]=!0),bt){const At=M.evaluate(It,{},f).join(","),Yt=E.get("text-rotation-alignment")==="map"&&E.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ku.vertical)>=0;for(const $t of bt.sections)if($t.image)$[$t.image.name]=!0;else{const hn=w(bt.toString()),gn=$t.fontStack||At,Lt=ie[gn]=ie[gn]||{};this.calculateGlyphDependencies($t.text,Lt,Yt,this.allowVerticalPlacement,hn)}}}E.get("symbol-placement")==="line"&&(this.features=function(Ve){const Se={},ze={},Ze=[];let qe=0;function It(At){Ze.push(Ve[At]),qe++}function bt(At,Yt,$t){const hn=ze[At];return delete ze[At],ze[Yt]=hn,Ze[hn].geometry[0].pop(),Ze[hn].geometry[0]=Ze[hn].geometry[0].concat($t[0]),hn}function Vt(At,Yt,$t){const hn=Se[Yt];return delete Se[Yt],Se[At]=hn,Ze[hn].geometry[0].shift(),Ze[hn].geometry[0]=$t[0].concat(Ze[hn].geometry[0]),hn}function pn(At,Yt,$t){const hn=$t?Yt[0][Yt[0].length-1]:Yt[0][0];return`${At}:${hn.x}:${hn.y}`}for(let At=0;At<Ve.length;At++){const Yt=Ve[At],$t=Yt.geometry,hn=Yt.text?Yt.text.toString():null;if(!hn){It(At);continue}const gn=pn(hn,$t),Lt=pn(hn,$t,!0);if(gn in ze&&Lt in Se&&ze[gn]!==Se[Lt]){const Dn=Vt(gn,Lt,$t),Ai=bt(gn,Lt,Ze[Dn].geometry);delete Se[gn],delete ze[Lt],ze[pn(hn,Ze[Ai].geometry,!0)]=Ai,Ze[Dn].geometry=null}else gn in ze?bt(gn,Lt,$t):Lt in Se?Vt(gn,Lt,$t):(It(At),Se[gn]=qe-1,ze[Lt]=qe-1)}return Ze.filter(At=>At.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Ve,Se)=>Ve.sortKey-Se.sortKey)}update(o,c,f,m){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(o,c,this.layers,f,m),this.icon.programConfigurations.updatePaintArrays(o,c,this.layers,f,m))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(o){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(o),this.iconCollisionBox.upload(o)),this.text.upload(o,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(o,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=tE(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(o,c){const f=this.lineVertexArray.length;if(o.segment!==void 0)for(const{x:m,y:v}of c)this.lineVertexArray.emplaceBack(m,v);return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(o,c,f,m,v,E,S,M,R,U,H,q,K,$){const ie=o.indexArray,me=o.layoutVertexArray,Me=o.globeExtVertexArray,Ve=o.segments.prepareSegment(4*c.length,me,ie,this.canOverlap?E.sortKey:void 0),Se=this.glyphOffsetArray.length,ze=Ve.vertexLength,Ze=this.allowVerticalPlacement&&S===Ku.vertical?Math.PI/2:0,qe=E.text&&E.text.sections;for(let bt=0;bt<c.length;bt++){const{tl:Vt,tr:pn,bl:At,br:Yt,tex:$t,pixelOffsetTL:hn,pixelOffsetBR:gn,minFontScaleX:Lt,minFontScaleY:Dn,glyphOffset:Ai,isSDF:jn,sectionIndex:ai}=c[bt],Nn=Ve.vertexLength,Li=Ai[1];if(nv(me,R.x,R.y,Vt.x,Li+Vt.y,$t.x,$t.y,f,jn,hn.x,hn.y,Lt,Dn),nv(me,R.x,R.y,pn.x,Li+pn.y,$t.x+$t.w,$t.y,f,jn,gn.x,hn.y,Lt,Dn),nv(me,R.x,R.y,At.x,Li+At.y,$t.x,$t.y+$t.h,f,jn,hn.x,gn.y,Lt,Dn),nv(me,R.x,R.y,Yt.x,Li+Yt.y,$t.x+$t.w,$t.y+$t.h,f,jn,gn.x,gn.y,Lt,Dn),M){const{x:Cr,y:Tr,z:br}=M.anchor,[Ni,gs,Ji]=M.up;iv(Me,Cr,Tr,br,Ni,gs,Ji),iv(Me,Cr,Tr,br,Ni,gs,Ji),iv(Me,Cr,Tr,br,Ni,gs,Ji),iv(Me,Cr,Tr,br,Ni,gs,Ji),rv(o.dynamicLayoutVertexArray,Cr,Tr,br,Ze)}else rv(o.dynamicLayoutVertexArray,R.x,R.y,R.z,Ze);ie.emplaceBack(Nn,Nn+1,Nn+2),ie.emplaceBack(Nn+1,Nn+2,Nn+3),Ve.vertexLength+=4,Ve.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ai[0]),bt!==c.length-1&&ai===c[bt+1].sectionIndex||o.programConfigurations.populatePaintArrays(me.length,E,E.index,{},K,$,qe&&qe[ai])}const It=M?M.anchor:R;o.placedSymbolArray.emplaceBack(It.x,It.y,It.z,R.x,R.y,Se,this.glyphOffsetArray.length-Se,ze,U,H,R.segment,f?f[0]:0,f?f[1]:0,m[0],m[1],S,0,!1,0,q,0)}_commitLayoutVertex(o,c,f,m,v,E,S){o.emplaceBack(c,f,m,v,E,Math.round(S.x),Math.round(S.y))}_addCollisionDebugVertices(o,c,f,m,v,E,S){const M=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),R=M.vertexLength,U=S.tileAnchorX,H=S.tileAnchorY;for(let K=0;K<4;K++)f.collisionVertexArray.emplaceBack(0,0,0,0);f.collisionVertexArrayExt.emplaceBack(c,-o.padding,-o.padding),f.collisionVertexArrayExt.emplaceBack(c,o.padding,-o.padding),f.collisionVertexArrayExt.emplaceBack(c,o.padding,o.padding),f.collisionVertexArrayExt.emplaceBack(c,-o.padding,o.padding),this._commitLayoutVertex(f.layoutVertexArray,m,v,E,U,H,new J(o.x1,o.y1)),this._commitLayoutVertex(f.layoutVertexArray,m,v,E,U,H,new J(o.x2,o.y1)),this._commitLayoutVertex(f.layoutVertexArray,m,v,E,U,H,new J(o.x2,o.y2)),this._commitLayoutVertex(f.layoutVertexArray,m,v,E,U,H,new J(o.x1,o.y2)),M.vertexLength+=4;const q=f.indexArray;q.emplaceBack(R,R+1),q.emplaceBack(R+1,R+2),q.emplaceBack(R+2,R+3),q.emplaceBack(R+3,R),M.primitiveLength+=4}_addTextDebugCollisionBoxes(o,c,f,m,v,E){for(let S=m;S<v;S++){const M=f.get(S),R=this.getSymbolInstanceTextSize(o,E,c,S);this._addCollisionDebugVertices(M,R,this.textCollisionBox,M.projectedAnchorX,M.projectedAnchorY,M.projectedAnchorZ,E)}}_addIconDebugCollisionBoxes(o,c,f,m,v,E){for(let S=m;S<v;S++){const M=f.get(S),R=this.getSymbolInstanceIconSize(o,c,E.placedIconSymbolIndex);this._addCollisionDebugVertices(M,R,this.iconCollisionBox,M.projectedAnchorX,M.projectedAnchorY,M.projectedAnchorZ,E)}}generateCollisionDebugBuffers(o,c){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new c1(lo,wx.members,nf),this.iconCollisionBox=new c1(lo,wx.members,nf);const f=cl(this.iconSizeData,o),m=cl(this.textSizeData,o);for(let v=0;v<this.symbolInstances.length;v++){const E=this.symbolInstances.get(v);this._addTextDebugCollisionBoxes(m,o,c,E.textBoxStartIndex,E.textBoxEndIndex,E),this._addTextDebugCollisionBoxes(m,o,c,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E),this._addIconDebugCollisionBoxes(f,o,c,E.iconBoxStartIndex,E.iconBoxEndIndex,E),this._addIconDebugCollisionBoxes(f,o,c,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E)}}getSymbolInstanceTextSize(o,c,f,m){const v=this.text.placedSymbolArray.get(c.rightJustifiedTextSymbolIndex>=0?c.rightJustifiedTextSymbolIndex:c.centerJustifiedTextSymbolIndex>=0?c.centerJustifiedTextSymbolIndex:c.leftJustifiedTextSymbolIndex>=0?c.leftJustifiedTextSymbolIndex:c.verticalPlacedTextSymbolIndex>=0?c.verticalPlacedTextSymbolIndex:m),E=r_(this.textSizeData,o,v)/va;return this.tilePixelRatio*E}getSymbolInstanceIconSize(o,c,f){const m=this.icon.placedSymbolArray.get(f),v=r_(this.iconSizeData,o,m);return this.tilePixelRatio*v}_commitDebugCollisionVertexUpdate(o,c,f){o.emplaceBack(c,-f,-f),o.emplaceBack(c,f,-f),o.emplaceBack(c,f,f),o.emplaceBack(c,-f,f)}_updateTextDebugCollisionBoxes(o,c,f,m,v,E){for(let S=m;S<v;S++){const M=f.get(S),R=this.getSymbolInstanceTextSize(o,E,c,S);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,R,M.padding)}}_updateIconDebugCollisionBoxes(o,c,f,m,v,E){for(let S=m;S<v;S++){const M=f.get(S),R=this.getSymbolInstanceIconSize(o,c,E);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,R,M.padding)}}updateCollisionDebugBuffers(o,c){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const f=cl(this.iconSizeData,o),m=cl(this.textSizeData,o);for(let v=0;v<this.symbolInstances.length;v++){const E=this.symbolInstances.get(v);this._updateTextDebugCollisionBoxes(m,o,c,E.textBoxStartIndex,E.textBoxEndIndex,E),this._updateTextDebugCollisionBoxes(m,o,c,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E),this._updateIconDebugCollisionBoxes(f,o,c,E.iconBoxStartIndex,E.iconBoxEndIndex,E.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(f,o,c,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(o,c,f,m,v,E,S,M,R){const U={};if(c<f){const{x1:H,y1:q,x2:K,y2:$,padding:ie,projectedAnchorX:me,projectedAnchorY:Me,projectedAnchorZ:Ve,tileAnchorX:Se,tileAnchorY:ze,featureIndex:Ze}=o.get(c);U.textBox={x1:H,y1:q,x2:K,y2:$,padding:ie,projectedAnchorX:me,projectedAnchorY:Me,projectedAnchorZ:Ve,tileAnchorX:Se,tileAnchorY:ze},U.textFeatureIndex=Ze}if(m<v){const{x1:H,y1:q,x2:K,y2:$,padding:ie,projectedAnchorX:me,projectedAnchorY:Me,projectedAnchorZ:Ve,tileAnchorX:Se,tileAnchorY:ze,featureIndex:Ze}=o.get(m);U.verticalTextBox={x1:H,y1:q,x2:K,y2:$,padding:ie,projectedAnchorX:me,projectedAnchorY:Me,projectedAnchorZ:Ve,tileAnchorX:Se,tileAnchorY:ze},U.verticalTextFeatureIndex=Ze}if(E<S){const{x1:H,y1:q,x2:K,y2:$,padding:ie,projectedAnchorX:me,projectedAnchorY:Me,projectedAnchorZ:Ve,tileAnchorX:Se,tileAnchorY:ze,featureIndex:Ze}=o.get(E);U.iconBox={x1:H,y1:q,x2:K,y2:$,padding:ie,projectedAnchorX:me,projectedAnchorY:Me,projectedAnchorZ:Ve,tileAnchorX:Se,tileAnchorY:ze},U.iconFeatureIndex=Ze}if(M<R){const{x1:H,y1:q,x2:K,y2:$,padding:ie,projectedAnchorX:me,projectedAnchorY:Me,projectedAnchorZ:Ve,tileAnchorX:Se,tileAnchorY:ze,featureIndex:Ze}=o.get(M);U.verticalIconBox={x1:H,y1:q,x2:K,y2:$,padding:ie,projectedAnchorX:me,projectedAnchorY:Me,projectedAnchorZ:Ve,tileAnchorX:Se,tileAnchorY:ze},U.verticalIconFeatureIndex=Ze}return U}deserializeCollisionBoxes(o){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const f=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(o,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(o,c){const f=o.placedSymbolArray.get(c),m=f.vertexStartIndex+4*f.numGlyphs;for(let v=f.vertexStartIndex;v<m;v+=4)o.indexArray.emplaceBack(v,v+1,v+2),o.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(o){if(this.sortedAngle===o&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const c=Math.sin(o),f=Math.cos(o),m=[],v=[],E=[];for(let S=0;S<this.symbolInstances.length;++S){E.push(S);const M=this.symbolInstances.get(S);m.push(0|Math.round(c*M.tileAnchorX+f*M.tileAnchorY)),v.push(M.featureIndex)}return E.sort((S,M)=>m[S]-m[M]||v[M]-v[S]),E}addToSortKeyRanges(o,c){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===c?f.symbolInstanceEnd=o+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:o,symbolInstanceEnd:o+1})}sortFeatures(o){if(this.sortFeaturesByY&&this.sortedAngle!==o&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(o),this.sortedAngle=o,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const f=this.symbolInstances.get(c);this.featureSortOrder.push(f.featureIndex);const{rightJustifiedTextSymbolIndex:m,centerJustifiedTextSymbolIndex:v,leftJustifiedTextSymbolIndex:E,verticalPlacedTextSymbolIndex:S,placedIconSymbolIndex:M,verticalPlacedIconSymbolIndex:R}=f;m>=0&&this.addIndicesForPlacedSymbol(this.text,m),v>=0&&v!==m&&this.addIndicesForPlacedSymbol(this.text,v),E>=0&&E!==v&&E!==m&&this.addIndicesForPlacedSymbol(this.text,E),S>=0&&this.addIndicesForPlacedSymbol(this.text,S),M>=0&&this.addIndicesForPlacedSymbol(this.icon,M),R>=0&&this.addIndicesForPlacedSymbol(this.icon,R)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Gn(Qd,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Qd.MAX_GLYPHS=65535,Qd.addDynamicAttributes=rv;const iw=new ln({"symbol-placement":new ht(Rt.layout_symbol["symbol-placement"]),"symbol-spacing":new ht(Rt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ht(Rt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Tt(Rt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ht(Rt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ht(Rt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ht(Rt.layout_symbol["icon-ignore-placement"]),"icon-optional":new ht(Rt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ht(Rt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Tt(Rt.layout_symbol["icon-size"]),"icon-text-fit":new ht(Rt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ht(Rt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Tt(Rt.layout_symbol["icon-image"]),"icon-rotate":new Tt(Rt.layout_symbol["icon-rotate"]),"icon-padding":new ht(Rt.layout_symbol["icon-padding"]),"icon-keep-upright":new ht(Rt.layout_symbol["icon-keep-upright"]),"icon-offset":new Tt(Rt.layout_symbol["icon-offset"]),"icon-anchor":new Tt(Rt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ht(Rt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ht(Rt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ht(Rt.layout_symbol["text-rotation-alignment"]),"text-field":new Tt(Rt.layout_symbol["text-field"]),"text-font":new Tt(Rt.layout_symbol["text-font"]),"text-size":new Tt(Rt.layout_symbol["text-size"]),"text-max-width":new Tt(Rt.layout_symbol["text-max-width"]),"text-line-height":new Tt(Rt.layout_symbol["text-line-height"]),"text-letter-spacing":new Tt(Rt.layout_symbol["text-letter-spacing"]),"text-justify":new Tt(Rt.layout_symbol["text-justify"]),"text-radial-offset":new Tt(Rt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ht(Rt.layout_symbol["text-variable-anchor"]),"text-anchor":new Tt(Rt.layout_symbol["text-anchor"]),"text-max-angle":new ht(Rt.layout_symbol["text-max-angle"]),"text-writing-mode":new ht(Rt.layout_symbol["text-writing-mode"]),"text-rotate":new Tt(Rt.layout_symbol["text-rotate"]),"text-padding":new ht(Rt.layout_symbol["text-padding"]),"text-keep-upright":new ht(Rt.layout_symbol["text-keep-upright"]),"text-transform":new Tt(Rt.layout_symbol["text-transform"]),"text-offset":new Tt(Rt.layout_symbol["text-offset"]),"text-allow-overlap":new ht(Rt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ht(Rt.layout_symbol["text-ignore-placement"]),"text-optional":new ht(Rt.layout_symbol["text-optional"])});var h1={paint:new ln({"icon-opacity":new Tt(Rt.paint_symbol["icon-opacity"]),"icon-color":new Tt(Rt.paint_symbol["icon-color"]),"icon-halo-color":new Tt(Rt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Tt(Rt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Tt(Rt.paint_symbol["icon-halo-blur"]),"icon-translate":new ht(Rt.paint_symbol["icon-translate"]),"icon-translate-anchor":new ht(Rt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Tt(Rt.paint_symbol["text-opacity"]),"text-color":new Tt(Rt.paint_symbol["text-color"],{runtimeType:Pa,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new Tt(Rt.paint_symbol["text-halo-color"]),"text-halo-width":new Tt(Rt.paint_symbol["text-halo-width"]),"text-halo-blur":new Tt(Rt.paint_symbol["text-halo-blur"]),"text-translate":new ht(Rt.paint_symbol["text-translate"]),"text-translate-anchor":new ht(Rt.paint_symbol["text-translate-anchor"])}),layout:iw};class nE{constructor(o){this.type=o.property.overrides?o.property.overrides.runtimeType:pc,this.defaultValue=o}evaluate(o){if(o.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(o.formattedSection))return c.getOverride(o.formattedSection)}return o.feature&&o.featureState?this.defaultValue.evaluate(o.feature,o.featureState):this.defaultValue.property.specification.default}eachChild(o){this.defaultValue.isConstant()||o(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Gn(nE,"FormatSectionOverride",{omit:["defaultValue"]});class sv extends hh{constructor(o){super(o,h1)}recalculate(o,c){super.recalculate(o,c),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const f=this.layout.get("text-writing-mode");if(f){const m=[];for(const v of f)m.indexOf(v)<0&&m.push(v);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(o,c,f,m){const v=this.layout.get(o).evaluate(c,{},f,m),E=this._unevaluatedLayout._values[o];return E.isDataDriven()||Wf(E.value)||!v?v:function(S,M){return M.replace(/{([^{}]+)}/g,(R,U)=>U in S?String(S[U]):"")}(c.properties,v)}createBucket(o){return new Qd(o)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const o of h1.paint.overridableProperties){if(!sv.hasPaintOverride(this.layout,o))continue;const c=this.paint.get(o),f=new nE(c),m=new Ec(f,c.property.specification);let v=null;v=c.value.kind==="constant"||c.value.kind==="source"?new Pp("source",m):new ju("composite",m,c.value.zoomStops,c.value._interpolationType),this.paint._values[o]=new un(c.property,v,c.parameters)}}_handleOverridablePaintPropertyUpdate(o,c,f){return!(!this.layout||c.isDataDriven()||f.isDataDriven())&&sv.hasPaintOverride(this.layout,o)}static hasPaintOverride(o,c){const f=o.get("text-field"),m=h1.paint.properties[c];let v=!1;const E=S=>{for(const M of S)if(m.overrides&&m.overrides.hasOverride(M))return void(v=!0)};if(f.value.kind==="constant"&&f.value.value instanceof Zo)E(f.value.value.sections);else if(f.value.kind==="source"){const S=R=>{v||(R instanceof kh&&_o(R.value)===Fe?E(R.value.sections):R instanceof rs?E(R.sections):R.eachChild(S))},M=f.value;M._styleExpression&&S(M._styleExpression.expression)}return v}getProgramConfiguration(o){return new ch(this,o)}}var rw={paint:new ln({"background-color":new ht(Rt.paint_background["background-color"]),"background-pattern":new ht(Rt.paint_background["background-pattern"]),"background-opacity":new ht(Rt.paint_background["background-opacity"])})},sw={paint:new ln({"raster-opacity":new ht(Rt.paint_raster["raster-opacity"]),"raster-hue-rotate":new ht(Rt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ht(Rt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ht(Rt.paint_raster["raster-brightness-max"]),"raster-saturation":new ht(Rt.paint_raster["raster-saturation"]),"raster-contrast":new ht(Rt.paint_raster["raster-contrast"]),"raster-resampling":new ht(Rt.paint_raster["raster-resampling"]),"raster-fade-duration":new ht(Rt.paint_raster["raster-fade-duration"])})};class ow extends hh{constructor(o){super(o,{}),this.implementation=o}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(o){this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)}onRemove(o){this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)}}var aw={paint:new ln({"sky-type":new ht(Rt.paint_sky["sky-type"]),"sky-atmosphere-sun":new ht(Rt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new ht(Rt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new ht(Rt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new ht(Rt.paint_sky["sky-gradient-radius"]),"sky-gradient":new en(Rt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new ht(Rt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new ht(Rt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new ht(Rt.paint_sky["sky-opacity"])})};function f1(u,o,c){const f=[0,0,1],m=sf([]);return vy(m,m,c?-De(u)+Math.PI:De(u)),Tl(m,m,-De(o)),ll(f,f,m),Bo(f,f)}const lw={circle:class extends hh{constructor(u){super(u,VI)}createBucket(u){return new k0(u)}queryRadius(u){const o=u;return Bm("circle-radius",this,o)+Bm("circle-stroke-width",this,o)+My(this.paint.get("circle-translate"))}queryIntersectsFeature(u,o,c,f,m,v,E,S){const M=Ly(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),v.angle,u.pixelToTileUnitsFactor),R=this.paint.get("circle-radius").evaluate(o,c)+this.paint.get("circle-stroke-width").evaluate(o,c);return ix(u,f,v,E,S,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",M,R)}getProgramIds(){return["circle"]}getProgramConfiguration(u){return new ch(this,u)}},heatmap:class extends hh{createBucket(u){return new sx(u)}constructor(u){super(u,qI),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=V0({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(u){return Bm("heatmap-radius",this,u)}queryIntersectsFeature(u,o,c,f,m,v,E,S){const M=this.paint.get("heatmap-radius").evaluate(o,c);return ix(u,f,v,E,S,!0,!0,new J(0,0),M)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(u){return new ch(this,u)}},hillshade:class extends hh{constructor(u){super(u,WI)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends hh{constructor(u){super(u,iT)}getProgramIds(){const u=this.paint.get("fill-pattern"),o=u&&u.constantOr(1),c=[o?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&c.push(o&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),c}getProgramConfiguration(u){return new ch(this,u)}recalculate(u,o){super.recalculate(u,o);const c=this.paint._values["fill-outline-color"];c.value.kind==="constant"&&c.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(u){return new e_(u)}queryRadius(){return My(this.paint.get("fill-translate"))}queryIntersectsFeature(u,o,c,f,m,v){return!u.queryGeometry.isAboveHorizon&&Jb(tx(u.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),v.angle,u.pixelToTileUnitsFactor),f)}isTileClipped(){return!0}},"fill-extrusion":class extends hh{constructor(u){super(u,mT)}createBucket(u){return new fr(u)}queryRadius(){return My(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(u){return new ch(this,u)}queryIntersectsFeature(u,o,c,f,m,v,E,S,M){const R=Ly(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),v.angle,u.pixelToTileUnitsFactor),U=this.paint.get("fill-extrusion-height").evaluate(o,c),H=this.paint.get("fill-extrusion-base").evaluate(o,c),q=[0,0],K=S&&v.elevation,$=v.elevation?v.elevation.exaggeration():1,ie=u.tile.getBucket(this);if(K&&ie instanceof fr){const ze=ie.centroidVertexArray,Ze=M+1;Ze<ze.length&&(q[0]=ze.geta_centroid_pos0(Ze),q[1]=ze.geta_centroid_pos1(Ze))}if(q[0]===0&&q[1]===1)return!1;v.projection.name==="globe"&&(f=xx([f],[new J(0,0),new J(Mi,Mi)],u.tileID.canonical).map(ze=>ze.polygon).flat());const me=K?S:null,[Me,Ve]=function(ze,Ze,qe,It,bt,Vt,pn,At,Yt,$t,hn){return ze.projection.name==="globe"?function(gn,Lt,Dn,Ai,jn,ai,Nn,Li,Cr,Tr,br){const Ni=[],gs=[],Ji=gn.projection.upVectorScale(br,gn.center.lat,gn.worldSize).metersToTile,Ar=[0,0,0,1],Is=[0,0,0,1],zs=(Us,Ws,Mo,hl)=>{Us[0]=Ws,Us[1]=Mo,Us[2]=hl,Us[3]=1},Os=bx();Dn>0&&(Dn+=Os),Ai+=Os;for(const Us of Lt){const Ws=[],Mo=[];for(const hl of Us){const _s=hl.x+jn.x,ua=hl.y+jn.y,Qo=gn.projection.projectTilePoint(_s,ua,br),Jr=gn.projection.upVector(br,hl.x,hl.y);let co=Dn,ba=Ai;if(Nn){const Ts=Ex(_s,ua,Dn,Ai,Nn,Li,Cr,Tr);co+=Ts.base,ba+=Ts.top}Dn!==0?zs(Ar,Qo.x+Jr[0]*Ji*co,Qo.y+Jr[1]*Ji*co,Qo.z+Jr[2]*Ji*co):zs(Ar,Qo.x,Qo.y,Qo.z),zs(Is,Qo.x+Jr[0]*Ji*ba,Qo.y+Jr[1]*Ji*ba,Qo.z+Jr[2]*Ji*ba),uo(Ar,Ar,ai),uo(Is,Is,ai),Ws.push(new Bs(Ar[0],Ar[1],Ar[2])),Mo.push(new Bs(Is[0],Is[1],Is[2]))}Ni.push(Ws),gs.push(Mo)}return[Ni,gs]}(ze,Ze,qe,It,bt,Vt,pn,At,Yt,$t,hn):pn?function(gn,Lt,Dn,Ai,jn,ai,Nn,Li,Cr){const Tr=[],br=[],Ni=[0,0,0,1];for(const gs of gn){const Ji=[],Ar=[];for(const Is of gs){const zs=Is.x+Ai.x,Os=Is.y+Ai.y,Us=Ex(zs,Os,Lt,Dn,ai,Nn,Li,Cr);Ni[0]=zs,Ni[1]=Os,Ni[2]=Us.base,Ni[3]=1,Wp(Ni,Ni,jn),Ni[3]=Math.max(Ni[3],1e-5);const Ws=new Bs(Ni[0]/Ni[3],Ni[1]/Ni[3],Ni[2]/Ni[3]);Ni[0]=zs,Ni[1]=Os,Ni[2]=Us.top,Ni[3]=1,Wp(Ni,Ni,jn),Ni[3]=Math.max(Ni[3],1e-5);const Mo=new Bs(Ni[0]/Ni[3],Ni[1]/Ni[3],Ni[2]/Ni[3]);Ji.push(Ws),Ar.push(Mo)}Tr.push(Ji),br.push(Ar)}return[Tr,br]}(Ze,qe,It,bt,Vt,pn,At,Yt,$t):function(gn,Lt,Dn,Ai,jn){const ai=[],Nn=[],Li=jn[8]*Lt,Cr=jn[9]*Lt,Tr=jn[10]*Lt,br=jn[11]*Lt,Ni=jn[8]*Dn,gs=jn[9]*Dn,Ji=jn[10]*Dn,Ar=jn[11]*Dn;for(const Is of gn){const zs=[],Os=[];for(const Us of Is){const Ws=Us.x+Ai.x,Mo=Us.y+Ai.y,hl=jn[0]*Ws+jn[4]*Mo+jn[12],_s=jn[1]*Ws+jn[5]*Mo+jn[13],ua=jn[2]*Ws+jn[6]*Mo+jn[14],Qo=jn[3]*Ws+jn[7]*Mo+jn[15],Jr=hl+Li,co=_s+Cr,ba=ua+Tr,Ts=Math.max(Qo+br,1e-5),Vo=hl+Ni,$l=_s+gs,fl=ua+Ji,dl=Math.max(Qo+Ar,1e-5);zs.push(new Bs(Jr/Ts,co/Ts,ba/Ts)),Os.push(new Bs(Vo/dl,$l/dl,fl/dl))}ai.push(zs),Nn.push(Os)}return[ai,Nn]}(Ze,qe,It,bt,Vt)}(v,f,H,U,R,E,me,q,$,v.center.lat,u.tileID.canonical),Se=u.queryGeometry;return function(ze,Ze,qe){let It=1/0;Jb(qe,Ze)&&(It=X0(qe,Ze[0]));for(let bt=0;bt<Ze.length;bt++){const Vt=Ze[bt],pn=ze[bt];for(let At=0;At<Vt.length-1;At++){const Yt=Vt[At],$t=[Yt,Vt[At+1],pn[At+1],pn[At],Yt];Kb(qe,$t)&&(It=Math.min(It,X0(qe,$t)))}}return It!==1/0&&It}(Me,Ve,Se.isPointQuery()?Se.screenBounds:Se.screenGeometry)}},line:class extends hh{constructor(u){super(u,Tx),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(u){if(u==="line-gradient"){const o=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=o._styleExpression&&o._styleExpression.expression instanceof Na,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(u,o){super.recalculate(u,o),this.paint._values["line-floorwidth"]=Y0.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)}createBucket(u){return new Yd(u)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(u){return new ch(this,u)}queryRadius(u){const o=u,c=i_(Bm("line-width",this,o),Bm("line-gap-width",this,o)),f=Bm("line-offset",this,o);return c/2+Math.abs(f)+My(this.paint.get("line-translate"))}queryIntersectsFeature(u,o,c,f,m,v){if(u.queryGeometry.isAboveHorizon)return!1;const E=tx(u.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),v.angle,u.pixelToTileUnitsFactor),S=u.pixelToTileUnitsFactor/2*i_(this.paint.get("line-width").evaluate(o,c),this.paint.get("line-gap-width").evaluate(o,c)),M=this.paint.get("line-offset").evaluate(o,c);return M&&(f=function(R,U){const H=[],q=new J(0,0);for(let K=0;K<R.length;K++){const $=R[K],ie=[];for(let me=0;me<$.length;me++){const Me=$[me-1],Ve=$[me],Se=$[me+1],ze=me===0?q:Ve.sub(Me)._unit()._perp(),Ze=me===$.length-1?q:Se.sub(Ve)._unit()._perp(),qe=ze._add(Ze)._unit();qe._mult(1/(qe.x*Ze.x+qe.y*Ze.y)),ie.push(qe._mult(U)._add(Ve))}H.push(ie)}return H}(f,M*u.pixelToTileUnitsFactor)),function(R,U,H){for(let q=0;q<U.length;q++){const K=U[q];if(R.length>=3){for(let $=0;$<K.length;$++)if(Kp(R,K[$]))return!0}if(BI(R,K,H))return!0}return!1}(E,f,S)}isTileClipped(){return!0}},symbol:sv,background:class extends hh{constructor(u){super(u,rw)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends hh{constructor(u){super(u,sw)}getProgramIds(){return["raster"]}},sky:class extends hh{constructor(u){super(u,aw),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="sky-gradient"?this._updateColorRamp():u!=="sky-atmosphere-sun"&&u!=="sky-atmosphere-halo-color"&&u!=="sky-atmosphere-color"&&u!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=V0({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(u){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const o=u.style.light.properties.get("position");return this._lightPosition.azimuthal!==o.azimuthal||this._lightPosition.polar!==o.polar}return!1}getCenter(u,o){if(this.paint.get("sky-type")==="atmosphere"){const f=this.paint.get("sky-atmosphere-sun"),m=!f,v=u.style.light,E=v.properties.get("position");return m&&v.properties.get("anchor")==="viewport"&&Zn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),m?f1(E.azimuthal,90-E.polar,o):f1(f[0],90-f[1],o)}const c=this.paint.get("sky-gradient-center");return f1(c[0],90-c[1],o)}is3D(){return!1}isSky(){return!0}markSkyboxValid(u){this._skyboxInvalidated=!1,this._lightPosition=u.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const u=this.paint.get("sky-type");return u==="atmosphere"?["skyboxCapture","skybox"]:u==="gradient"?["skyboxGradient"]:null}}};class _{constructor(o,c,f,m){this.context=o,this.format=f,this.texture=o.gl.createTexture(),this.update(c,m)}update(o,c,f){const{width:m,height:v}=o,{context:E}=this,{gl:S}=E,{HTMLImageElement:M,HTMLCanvasElement:R,HTMLVideoElement:U,ImageData:H,ImageBitmap:q}=d;if(S.bindTexture(S.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1),E.pixelStoreUnpackPremultiplyAlpha.set(this.format===S.RGBA&&(!c||c.premultiply!==!1)),f||this.size&&this.size[0]===m&&this.size[1]===v){const{x:K,y:$}=f||{x:0,y:0};o instanceof M||o instanceof R||o instanceof U||o instanceof H||q&&o instanceof q?S.texSubImage2D(S.TEXTURE_2D,0,K,$,S.RGBA,S.UNSIGNED_BYTE,o):S.texSubImage2D(S.TEXTURE_2D,0,K,$,m,v,S.RGBA,S.UNSIGNED_BYTE,o.data)}else this.size=[m,v],o instanceof M||o instanceof R||o instanceof U||o instanceof H||q&&o instanceof q?S.texImage2D(S.TEXTURE_2D,0,this.format,this.format,S.UNSIGNED_BYTE,o):S.texImage2D(S.TEXTURE_2D,0,this.format,m,v,0,this.format,S.UNSIGNED_BYTE,o.data);this.useMipmap=!!(c&&c.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&S.generateMipmap(S.TEXTURE_2D)}bind(o,c){const{context:f}=this,{gl:m}=f;m.bindTexture(m.TEXTURE_2D,this.texture),o!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,o),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap?o===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_NEAREST:o),this.filter=o),c!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,c),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,c),this.wrap=c)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}class T{constructor(o){this._callback=o,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class D{constructor(){this.tasks={},this.taskQueue=[],xn(["process"],this),this.invoker=new T(this.process),this.nextId=0}add(o,c){const f=this.nextId++,m=function({type:v,isSymbolTile:E,zoom:S}){return S=S||0,v==="message"?0:v!=="maybePrepare"||E?v!=="parseTile"||E?v==="parseTile"&&E?300-S:v==="maybePrepare"&&E?400-S:500:200-S:100-S}(c);if(m===0){Pt();try{o()}finally{}return{cancel:()=>{}}}return this.tasks[f]={fn:o,metadata:c,priority:m,id:f},this.taskQueue.push(f),this.invoker.trigger(),{cancel:()=>{delete this.tasks[f]}}}process(){Pt();try{if(this.taskQueue=this.taskQueue.filter(f=>!!this.tasks[f]),!this.taskQueue.length)return;const o=this.pick();if(o===null)return;const c=this.tasks[o];if(delete this.tasks[o],this.taskQueue.length&&this.invoker.trigger(),!c)return;c.fn()}finally{}}pick(){let o=null,c=1/0;for(let m=0;m<this.taskQueue.length;m++){const v=this.tasks[this.taskQueue[m]];v.priority<c&&(c=v.priority,o=m)}if(o===null)return null;const f=this.taskQueue[o];return this.taskQueue.splice(o,1),f}remove(){this.invoker.remove()}}class Z{constructor(o){this._stringToNumber={},this._numberToString=[];for(let c=0;c<o.length;c++){const f=o[c];this._stringToNumber[f]=c,this._numberToString[c]=f}}encode(o){return this._stringToNumber[o]}decode(o){return this._numberToString[o]}}const oe=["tile","layer","source","sourceLayer","state"];class Ee{constructor(o,c,f,m,v){this.type="Feature",this._vectorTileFeature=o,this._z=c,this._x=f,this._y=m,this.properties=o.properties,this.id=v}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(o){this._geometry=o}toJSON(){const o={type:"Feature",geometry:this.geometry,properties:this.properties};this.id!==void 0&&(o.id=this.id);for(const c of oe)this[c]!==void 0&&(o[c]=this[c]);return o}}const Ge=32,rt=33,pt=new Uint16Array(8184);for(let u=0;u<2046;u++){let o=u+2,c=0,f=0,m=0,v=0,E=0,S=0;for(1&o?m=v=E=Ge:c=f=S=Ge;(o>>=1)>1;){const R=c+m>>1,U=f+v>>1;1&o?(m=c,v=f,c=E,f=S):(c=m,f=v,m=E,v=S),E=R,S=U}const M=4*u;pt[M+0]=c,pt[M+1]=f,pt[M+2]=m,pt[M+3]=v}const rn=new Uint16Array(2178),cn=new Uint8Array(1089),wn=new Uint16Array(1089);function ri(u){return u===0?-.03125:u===32?.03125:0}var Ci=di([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const er={type:2,extent:Mi,loadGeometry:()=>[[new J(0,0),new J(8193,0),new J(8193,8193),new J(0,8193),new J(0,0)]]};class Sr{constructor(o,c,f,m,v){this.tileID=o,this.uid=Cn(),this.uses=0,this.tileSize=c,this.tileZoom=f,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=v,this.expiredRequestCount=0,this.state="loading",m&&m.transform&&(this.projection=m.transform.projection)}registerFadeDuration(o){const c=o+this.timeAdded;c<xr.now()||this.fadeEndTime&&c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=$p(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(o,c,f){if(this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(m,v){const E={};if(!v)return E;for(const S of m){const M=S.layerIds.map(R=>v.getLayer(R)).filter(Boolean);if(M.length!==0){S.layers=M,S.stateDependentLayerIds&&(S.stateDependentLayers=S.stateDependentLayerIds.map(R=>M.filter(U=>U.id===R)[0]));for(const R of M)E[R.id]=S}}return E}(o.buckets,c.style),this.hasSymbolBuckets=!1;for(const m in this.buckets){const v=this.buckets[m];if(v instanceof Qd){if(this.hasSymbolBuckets=!0,!f)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const m in this.buckets){const v=this.buckets[m];if(v instanceof Qd&&v.hasRTLText){this.hasRTLText=!0,Ke.isLoading()||Ke.isLoaded()||Xe()!=="deferred"||je();break}}this.queryPadding=0;for(const m in this.buckets){const v=this.buckets[m];this.queryPadding=Math.max(this.queryPadding,c.style.getLayer(m).queryRadius(v))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage),o.lineAtlas&&(this.lineAtlas=o.lineAtlas)}else this.collisionBoxArray=new m0}unloadVectorData(){if(this.hasData()){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(o){return this.buckets[o.id]}upload(o){for(const f in this.buckets){const m=this.buckets[f];m.uploadPending()&&m.upload(o)}const c=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new _(o,this.imageAtlas.image,c.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new _(o,this.glyphAtlasImage,c.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new _(o,this.lineAtlas.image,c.ALPHA),this.lineAtlas.uploaded=!0)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,c,f,m,v,E,S,M){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:m,pixelPosMatrix:S,transform:E,params:v,tileTransform:this.tileTransform},o,c,f):{}}querySourceFeatures(o,c){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const m=f.loadVTLayers(),v=c?c.sourceLayer:"",E=m._geojsonTileLayer||m[v];if(!E)return;const S=bo(c&&c.filter),{z:M,x:R,y:U}=this.tileID.canonical,H={z:M,x:R,y:U};for(let q=0;q<E.length;q++){const K=E.feature(q);if(S.needGeometry){const me=Yp(K,!0);if(!S.filter(new ft(this.tileID.overscaledZ),me,this.tileID.canonical))continue}else if(!S.filter(new ft(this.tileID.overscaledZ),K))continue;const $=f.getId(K,v),ie=new Ee(K,M,R,U,$);ie.tile=H,o.push(ie)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const c=this.expirationTime;if(o.cacheControl){const f=Yn(o.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const f=Date.now();let m=!1;if(this.expirationTime>f)m=!1;else if(c)if(this.expirationTime<c)m=!0;else{const v=this.expirationTime-c;v?this.expirationTime=f+Math.max(v,3e4):m=!0}else m=!0;m?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(o,c){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(o).length===0||!c)return;const f=this.latestFeatureIndex.loadVTLayers(),m=c.style.listImages();for(const v in this.buckets){if(!c.style.hasLayer(v))continue;const E=this.buckets[v],S=E.layers[0].sourceLayer||"_geojsonTileLayer",M=f[S],R=o[S];if(!M||!R||Object.keys(R).length===0)continue;if(E.update(R,M,m,this.imageAtlas&&this.imageAtlas.patternPositions||{}),E instanceof Yd||E instanceof e_){const H=c.style._getSourceCache(E.layers[0].source);c._terrain&&c._terrain.enabled&&H&&E.programConfigurations.needsUpload&&c._terrain._clearRenderCacheForTile(H.id,this.tileID)}const U=c&&c.style&&c.style.getLayer(v);U&&(this.queryPadding=Math.max(this.queryPadding,U.queryRadius(E)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<xr.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=xr.now()+o}setTexture(o,c){const f=c.context,m=f.gl;this.texture=this.texture||c.getTileTexture(o.width),this.texture?this.texture.update(o,{useMipmap:!0}):(this.texture=new _(f,o,m.RGBA,{useMipmap:!0}),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE),f.extTextureFilterAnisotropic&&m.texParameterf(m.TEXTURE_2D,f.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,f.extTextureFilterAnisotropicMax))}setDependencies(o,c){const f={};for(const m of c)f[m]=!0;this.dependencies[o]=f}hasDependency(o,c){for(const f of o){const m=this.dependencies[f];if(m){for(const v of c)if(m[v])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(o,c){if(!c||c.name==="mercator"||this._tileDebugBuffer)return;const f=td(er,this.tileID.canonical,this.tileTransform)[0],m=new bi,v=new mu;for(let E=0;E<f.length;E++){const{x:S,y:M}=f[E];m.emplaceBack(S,M),v.emplaceBack(E)}v.emplaceBack(0),this._tileDebugIndexBuffer=o.createIndexBuffer(v),this._tileDebugBuffer=o.createVertexBuffer(m,ed.members),this._tileDebugSegments=Qs.simpleSegment(0,0,m.length,v.length)}_makeTileBoundsBuffers(o,c){if(this._tileBoundsBuffer||!c||c.name==="mercator")return;const f=td(er,this.tileID.canonical,this.tileTransform)[0];let m,v;if(this.isRaster){const E=function(S,M){const R=$p(S,M),U=Math.pow(2,S.z);for(let me=0;me<rt;me++)for(let Me=0;Me<rt;Me++){const Ve=Zu((S.x+(Me+ri(Me))/Ge)/U),Se=Fa((S.y+(me+ri(me))/Ge)/U),ze=M.project(Ve,Se),Ze=me*rt+Me;rn[2*Ze+0]=Math.round((ze.x*R.scale-R.x)*Mi),rn[2*Ze+1]=Math.round((ze.y*R.scale-R.y)*Mi)}cn.fill(0),wn.fill(0);for(let me=2045;me>=0;me--){const Me=4*me,Ve=pt[Me+0],Se=pt[Me+1],ze=pt[Me+2],Ze=pt[Me+3],qe=Ve+ze>>1,It=Se+Ze>>1,bt=qe+It-Se,Vt=It+Ve-qe,pn=Se*rt+Ve,At=Ze*rt+ze,Yt=It*rt+qe,$t=Math.hypot((rn[2*pn+0]+rn[2*At+0])/2-rn[2*Yt+0],(rn[2*pn+1]+rn[2*At+1])/2-rn[2*Yt+1])>=16;if(cn[Yt]=cn[Yt]||($t?1:0),me<1022){const hn=(Se+Vt>>1)*rt+(Ve+bt>>1),gn=(Ze+Vt>>1)*rt+(ze+bt>>1);cn[Yt]=cn[Yt]||cn[hn]||cn[gn]}}const H=new $r,q=new _a;let K=0;function $(me,Me){const Ve=Me*rt+me;return wn[Ve]===0&&(H.emplaceBack(rn[2*Ve+0],rn[2*Ve+1],me*Mi/Ge,Me*Mi/Ge),wn[Ve]=++K),wn[Ve]-1}function ie(me,Me,Ve,Se,ze,Ze){const qe=me+Ve>>1,It=Me+Se>>1;if(Math.abs(me-ze)+Math.abs(Me-Ze)>1&&cn[It*rt+qe])ie(ze,Ze,me,Me,qe,It),ie(Ve,Se,ze,Ze,qe,It);else{const bt=$(me,Me),Vt=$(Ve,Se),pn=$(ze,Ze);q.emplaceBack(bt,Vt,pn)}}return ie(0,0,Ge,Ge,Ge,0),ie(Ge,Ge,0,0,0,Ge),{vertices:H,indices:q}}(this.tileID.canonical,c);m=E.vertices,v=E.indices}else{m=new $r,v=new _a;for(const{x:S,y:M}of f)m.emplaceBack(S,M,0,0);const E=zm(m.int16,void 0,4);for(let S=0;S<E.length;S+=3)v.emplaceBack(E[S],E[S+1],E[S+2])}this._tileBoundsBuffer=o.createVertexBuffer(m,Ci.members),this._tileBoundsIndexBuffer=o.createIndexBuffer(v),this._tileBoundsSegments=Qs.simpleSegment(0,0,m.length,v.length)}_makeGlobeTileDebugBuffers(o,c){const f=c.projection;if(!f||f.name!=="globe"||c.freezeTileCoverage)return;const m=this.tileID.canonical,v=Xg(C0(m,c)),E=km(c.zoom);let S;E>0&&(S=yy(new Float64Array(16),c.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(o,m,c,v,S,E),this._makeGlobeTileDebugTextBuffer(o,m,c,v,S,E)}_globePoint(o,c,f,m,v,E,S){let M=Wg(o,c,f);if(E){const R=1<<f.z,U=lf(m.center.lng),H=uf(m.center.lat),q=(f.x+.5)/R-U;let K=0;q>.5?K=-1:q<-.5&&(K=1);let $=(o/Mi+f.x)/R+K,ie=(c/Mi+f.y)/R;$=($-U)*m._pixelsPerMercatorPixel+U,ie=(ie-H)*m._pixelsPerMercatorPixel+H;const me=[$*m.worldSize,ie*m.worldSize,0];uo(me,me,E),M=af(M,me,S)}return uo(M,M,v)}_makeGlobeTileDebugBorderBuffer(o,c,f,m,v,E){const S=new bi,M=new mu,R=new Wr,U=(q,K,$,ie,me)=>{const Me=($-q)/(me-1),Ve=(ie-K)/(me-1),Se=S.length;for(let ze=0;ze<me;ze++){const Ze=q+ze*Me,qe=K+ze*Ve;S.emplaceBack(Ze,qe);const It=this._globePoint(Ze,qe,c,f,m,v,E);R.emplaceBack(It[0],It[1],It[2]),M.emplaceBack(Se+ze)}},H=Mi;U(0,0,H,0,16),U(H,0,H,H,16),U(H,H,0,H,16),U(0,H,0,0,16),this._tileDebugIndexBuffer=o.createIndexBuffer(M),this._tileDebugBuffer=o.createVertexBuffer(S,ed.members),this._globeTileDebugBorderBuffer=o.createVertexBuffer(R,Ub.members),this._tileDebugSegments=Qs.simpleSegment(0,0,S.length,M.length)}_makeGlobeTileDebugTextBuffer(o,c,f,m,v,E){const S=new bi,M=new _a,R=new Wr,U=25;M.reserve(32),S.reserve(U),R.reserve(U);const H=(q,K)=>U*q+K;for(let q=0;q<U;q++){const K=2048*q;for(let $=0;$<U;$++){const ie=2048*$;S.emplaceBack(ie,K);const me=this._globePoint(ie,K,c,f,m,v,E);R.emplaceBack(me[0],me[1],me[2])}}for(let q=0;q<4;q++)for(let K=0;K<4;K++){const $=H(q,K),ie=H(q,K+1),me=H(q+1,K),Me=H(q+1,K+1);M.emplaceBack($,ie,me),M.emplaceBack(me,ie,Me)}this._tileDebugTextIndexBuffer=o.createIndexBuffer(M),this._tileDebugTextBuffer=o.createVertexBuffer(S,ed.members),this._globeTileDebugTextBuffer=o.createVertexBuffer(R,Ub.members),this._tileDebugTextSegments=Qs.simpleSegment(0,0,U,32)}}class ir{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,c,f){const m=String(c);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][m]=this.stateChanges[o][m]||{},Dt(this.stateChanges[o][m],f),this.deletedStates[o]===null){this.deletedStates[o]={};for(const v in this.state[o])v!==m&&(this.deletedStates[o][v]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][m]===null){this.deletedStates[o][m]={};for(const v in this.state[o][m])f[v]||(this.deletedStates[o][m][v]=null)}else for(const v in f)this.deletedStates[o]&&this.deletedStates[o][m]&&this.deletedStates[o][m][v]===null&&delete this.deletedStates[o][m][v]}removeFeatureState(o,c,f){if(this.deletedStates[o]===null)return;const m=String(c);if(this.deletedStates[o]=this.deletedStates[o]||{},f&&c!==void 0)this.deletedStates[o][m]!==null&&(this.deletedStates[o][m]=this.deletedStates[o][m]||{},this.deletedStates[o][m][f]=null);else if(c!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][m])for(f in this.deletedStates[o][m]={},this.stateChanges[o][m])this.deletedStates[o][m][f]=null;else this.deletedStates[o][m]=null;else this.deletedStates[o]=null}getState(o,c){const f=String(c),m=Dt({},(this.state[o]||{})[f],(this.stateChanges[o]||{})[f]);if(this.deletedStates[o]===null)return{};if(this.deletedStates[o]){const v=this.deletedStates[o][c];if(v===null)return{};for(const E in v)delete m[E]}return m}initializeTileState(o,c){o.setFeatureState(this.state,c)}coalesceChanges(o,c){const f={};for(const m in this.stateChanges){this.state[m]=this.state[m]||{};const v={};for(const E in this.stateChanges[m])this.state[m][E]||(this.state[m][E]={}),Dt(this.state[m][E],this.stateChanges[m][E]),v[E]=this.state[m][E];f[m]=v}for(const m in this.deletedStates){this.state[m]=this.state[m]||{};const v={};if(this.deletedStates[m]===null)for(const E in this.state[m])v[E]={},this.state[m][E]={};else for(const E in this.deletedStates[m]){if(this.deletedStates[m][E]===null)this.state[m][E]={};else if(this.state[m][E])for(const S of Object.keys(this.deletedStates[m][E]))delete this.state[m][E][S];v[E]=this.state[m][E]}f[m]=f[m]||{},Dt(f[m],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const m in o)o[m].setFeatureState(f,c)}}class Gr{constructor(o){this.size=o,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(o,c){const f=this.toIdx(o,c);return{min:this.minimums[f],max:this.maximums[f]}}isLeaf(o,c){return this.leaves[this.toIdx(o,c)]}toIdx(o,c){return c*this.size+o}}function Kr(u,o,c,f){let m=0,v=Number.MAX_VALUE;for(let E=0;E<3;E++)if(Math.abs(f[E])<1e-15){if(c[E]<u[E]||c[E]>o[E])return null}else{const S=1/f[E];let M=(u[E]-c[E])*S,R=(o[E]-c[E])*S;if(M>R){const U=M;M=R,R=U}if(M>m&&(m=M),R<v&&(v=R),m>v)return null}return m}function xu(u,o,c,f,m,v,E,S,M,R,U){const H=f-u,q=m-o,K=v-c,$=E-u,ie=S-o,me=M-c,Me=U[1]*me-U[2]*ie,Ve=U[2]*$-U[0]*me,Se=U[0]*ie-U[1]*$,ze=H*Me+q*Ve+K*Se;if(Math.abs(ze)<1e-15)return null;const Ze=1/ze,qe=R[0]-u,It=R[1]-o,bt=R[2]-c,Vt=(qe*Me+It*Ve+bt*Se)*Ze;if(Vt<0||Vt>1)return null;const pn=It*K-bt*q,At=bt*H-qe*K,Yt=qe*q-It*H,$t=(U[0]*pn+U[1]*At+U[2]*Yt)*Ze;return $t<0||Vt+$t>1?null:($*pn+ie*At+me*Yt)*Ze}function Sl(u,o,c){return(u-o)/(c-o)}function Eu(u,o,c,f,m,v,E,S,M){const R=1<<c,U=v-f,H=E-m,q=(u+1)/R*U+f,K=(o+0)/R*H+m,$=(o+1)/R*H+m;S[0]=(u+0)/R*U+f,S[1]=K,M[0]=q,M[1]=$}class Uo{constructor(o){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=o,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const c=function(v){const E=Math.ceil(Math.log2(v.dim/8)),S=[];let M=Math.ceil(Math.pow(2,E));const R=1/M,U=(K,$,ie,me,Me)=>{const Ve=me?1:0,Se=(K+1)*ie-Ve,ze=$*ie,Ze=($+1)*ie-Ve;Me[0]=K*ie,Me[1]=ze,Me[2]=Se,Me[3]=Ze};let H=new Gr(M);const q=[];for(let K=0;K<M*M;K++){U(K%M,Math.floor(K/M),R,!1,q);const $=Cl(q[0],q[1],v),ie=Cl(q[2],q[1],v),me=Cl(q[2],q[3],v),Me=Cl(q[0],q[3],v);H.minimums.push(Math.min($,ie,me,Me)),H.maximums.push(Math.max($,ie,me,Me)),H.leaves.push(1)}for(S.push(H),M/=2;M>=1;M/=2){const K=S[S.length-1];H=new Gr(M);for(let $=0;$<M*M;$++){U($%M,Math.floor($/M),2,!0,q);const ie=K.getElevation(q[0],q[1]),me=K.getElevation(q[2],q[1]),Me=K.getElevation(q[2],q[3]),Ve=K.getElevation(q[0],q[3]),Se=K.isLeaf(q[0],q[1]),ze=K.isLeaf(q[2],q[1]),Ze=K.isLeaf(q[2],q[3]),qe=K.isLeaf(q[0],q[3]),It=Math.min(ie.min,me.min,Me.min,Ve.min),bt=Math.max(ie.max,me.max,Me.max,Ve.max),Vt=Se&&ze&&Ze&&qe;H.maximums.push(bt),H.minimums.push(It),H.leaves.push(bt-It<=5&&Vt?1:0)}S.push(H)}return S}(this.dem),f=c.length-1,m=c[f];this._addNode(m.minimums[0],m.maximums[0],m.leaves[0]),this._construct(c,0,0,f,0)}raycastRoot(o,c,f,m,v,E,S=1){return Kr([o,c,-100],[f,m,this.maximums[0]*S],v,E)}raycast(o,c,f,m,v,E,S=1){if(!this.nodeCount)return null;const M=this.raycastRoot(o,c,f,m,v,E,S);if(M==null)return null;const R=[],U=[],H=[],q=[],K=[{idx:0,t:M,nodex:0,nodey:0,depth:0}];for(;K.length>0;){const{idx:$,t:ie,nodex:me,nodey:Me,depth:Ve}=K.pop();if(this.leaves[$]){Eu(me,Me,Ve,o,c,f,m,H,q);const ze=1<<Ve,Ze=(me+0)/ze,qe=(me+1)/ze,It=(Me+0)/ze,bt=(Me+1)/ze,Vt=Cl(Ze,It,this.dem)*S,pn=Cl(qe,It,this.dem)*S,At=Cl(qe,bt,this.dem)*S,Yt=Cl(Ze,bt,this.dem)*S,$t=xu(H[0],H[1],Vt,q[0],H[1],pn,q[0],q[1],At,v,E),hn=xu(q[0],q[1],At,H[0],q[1],Yt,H[0],H[1],Vt,v,E),gn=Math.min($t!==null?$t:Number.MAX_VALUE,hn!==null?hn:Number.MAX_VALUE);if(gn!==Number.MAX_VALUE)return gn;{const Lt=qp([],v,E,ie);if(Pc(Vt,pn,Yt,At,Sl(Lt[0],H[0],q[0]),Sl(Lt[1],H[1],q[1]))>=Lt[2])return ie}continue}let Se=0;for(let ze=0;ze<this._siblingOffset.length;ze++){Eu((me<<1)+this._siblingOffset[ze][0],(Me<<1)+this._siblingOffset[ze][1],Ve+1,o,c,f,m,H,q),H[2]=-100,q[2]=this.maximums[this.childOffsets[$]+ze]*S;const Ze=Kr(H,q,v,E);if(Ze!=null){const qe=Ze;R[ze]=qe;let It=!1;for(let bt=0;bt<Se&&!It;bt++)qe>=R[U[bt]]&&(U.splice(bt,0,ze),It=!0);It||(U[Se]=ze),Se++}}for(let ze=0;ze<Se;ze++){const Ze=U[ze];K.push({idx:this.childOffsets[$]+Ze,t:R[Ze],nodex:(me<<1)+this._siblingOffset[Ze][0],nodey:(Me<<1)+this._siblingOffset[Ze][1],depth:Ve+1})}}return null}_addNode(o,c,f){return this.minimums.push(o),this.maximums.push(c),this.leaves.push(f),this.childOffsets.push(0),this.nodeCount++}_construct(o,c,f,m,v){if(o[m].isLeaf(c,f)===1)return;this.childOffsets[v]||(this.childOffsets[v]=this.nodeCount);const E=m-1,S=o[E];let M=0,R=0;for(let U=0;U<this._siblingOffset.length;U++){const H=2*c+this._siblingOffset[U][0],q=2*f+this._siblingOffset[U][1],K=S.getElevation(H,q),$=S.isLeaf(H,q),ie=this._addNode(K.min,K.max,$);$&&(M|=1<<U),R||(R=ie)}for(let U=0;U<this._siblingOffset.length;U++)M&1<<U||this._construct(o,2*c+this._siblingOffset[U][0],2*f+this._siblingOffset[U][1],E,R+U)}}function Pc(u,o,c,f,m,v){return Zi(Zi(u,c,v),Zi(o,f,v),m)}function Cl(u,o,c){const f=c.dim,m=it(u*f-.5,0,f-1),v=it(o*f-.5,0,f-1),E=Math.floor(m),S=Math.floor(v),M=Math.min(E+1,f-1),R=Math.min(S+1,f-1);return Pc(c.get(E,S),c.get(M,S),c.get(E,R),c.get(M,R),m-E,v-S)}const d1={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class iE{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(o,c,f,m=!1,v=!1){if(this.uid=o,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(f&&f!=="mapbox"&&f!=="terrarium")return Zn(`"${f}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=c.height;const E=this.dim=c.height-2,S=new Uint32Array(c.data.buffer);if(this.pixels=new Uint8Array(c.data.buffer),this.encoding=f||"mapbox",this.borderReady=m,!m){for(let M=0;M<E;M++)S[this._idx(-1,M)]=S[this._idx(0,M)],S[this._idx(E,M)]=S[this._idx(E-1,M)],S[this._idx(M,-1)]=S[this._idx(M,0)],S[this._idx(M,E)]=S[this._idx(M,E-1)];S[this._idx(-1,-1)]=S[this._idx(0,0)],S[this._idx(E,-1)]=S[this._idx(E-1,0)],S[this._idx(-1,E)]=S[this._idx(0,E-1)],S[this._idx(E,E)]=S[this._idx(E-1,E-1)],v&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Uo(this)}get(o,c,f=!1){f&&(o=it(o,-1,this.dim),c=it(c,-1,this.dim));const m=4*this._idx(o,c);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(this.pixels[m],this.pixels[m+1],this.pixels[m+2])}static getUnpackVector(o){return d1[o]}get unpackVector(){return d1[this.encoding]}_idx(o,c){if(o<-1||o>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(o+1)}_unpackMapbox(o,c,f){return(256*o*256+256*c+f)/10-1e4}_unpackTerrarium(o,c,f){return 256*o+c+f/256-32768}static pack(o,c){const f=[0,0,0,0],m=iE.getUnpackVector(c);let v=Math.floor((o+m[3])/m[2]);return f[2]=v%256,v=Math.floor(v/256),f[1]=v%256,v=Math.floor(v/256),f[0]=v,f}getPixels(){return new yu({width:this.stride,height:this.stride},this.pixels)}backfillBorder(o,c,f){if(this.dim!==o.dim)throw new Error("dem dimension mismatch");let m=c*this.dim,v=c*this.dim+this.dim,E=f*this.dim,S=f*this.dim+this.dim;switch(c){case-1:m=v-1;break;case 1:v=m+1}switch(f){case-1:E=S-1;break;case 1:S=E+1}const M=-c*this.dim,R=-f*this.dim;for(let U=E;U<S;U++)for(let H=m;H<v;H++){const q=4*this._idx(H,U),K=4*this._idx(H+M,U+R);this.pixels[q+0]=o.pixels[K+0],this.pixels[q+1]=o.pixels[K+1],this.pixels[q+2]=o.pixels[K+2],this.pixels[q+3]=o.pixels[K+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Gn(iE,"DEMData"),Gn(Uo,"DemMinMaxQuadTree",{omit:["dem"]});class IP{constructor(o,c){this.max=o,this.onRemove=c,this.reset()}reset(){for(const o in this.data)for(const c of this.data[o])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(o,c,f){const m=o.wrapped().key;this.data[m]===void 0&&(this.data[m]=[]);const v={value:c,timeout:void 0};if(f!==void 0&&(v.timeout=setTimeout(()=>{this.remove(o,v)},f)),this.data[m].push(v),this.order.push(m),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const c=this.data[o].shift();return c.timeout&&clearTimeout(c.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),c.value}getByKey(o){const c=this.data[o];return c?c[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,c){if(!this.has(o))return this;const f=o.wrapped().key,m=c===void 0?0:this.data[f].indexOf(c),v=this.data[f][m];return this.data[f].splice(m,1),v.timeout&&clearTimeout(v.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(v.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(o){const c=[];for(const f in this.data)for(const m of this.data[f])o(m.value)||c.push(m);for(const f of c)this.remove(f.value.tileID,f)}}class ov{constructor(o,c,f){this.func=o,this.mask=c,this.range=f}}ov.ReadOnly=!1,ov.ReadWrite=!0,ov.disabled=new ov(519,ov.ReadOnly,[0,1]);const uw=7680;class cw{constructor(o,c,f,m,v,E){this.test=o,this.ref=c,this.mask=f,this.fail=m,this.depthFail=v,this.pass=E}}cw.disabled=new cw({func:519,mask:0},0,0,uw,uw,uw);class $d{constructor(o,c,f){this.blendFunction=o,this.blendColor=c,this.mask=f}}$d.Replace=[1,0],$d.disabled=new $d($d.Replace,qi.transparent,[!1,!1,!1,!1]),$d.unblended=new $d($d.Replace,qi.transparent,[!0,!0,!0,!0]),$d.alphaBlended=new $d([1,771],qi.transparent,[!0,!0,!0,!0]);const hw=1029,fw=2305;class od{constructor(o,c,f){this.enable=o,this.mode=c,this.frontFace=f}}od.disabled=new od(!1,hw,fw),od.backCCW=new od(!0,hw,fw),od.backCW=new od(!0,hw,2304),od.frontCW=new od(!0,1028,2304),od.frontCCW=new od(!0,1028,fw);class h_ extends fa{constructor(o,c,f){super(),this.id=o,this._onlySymbols=f,c.on("data",m=>{m.dataType==="source"&&m.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&m.dataType==="source"&&m.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),c.on("error",()=>{this._sourceErrored=!0}),this._source=c,this._tiles={},this._cache=new IP(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=c.minTileCacheSize,this._maxTileCacheSize=c.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new ir,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(o){this.map=o,this._minTileCacheSize=this._minTileCacheSize===void 0&&o?o._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&o?o._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const o in this._tiles){const c=this._tiles[o];if(c.state!=="loaded"&&c.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(o,c){return o.isSymbolTile=this._onlySymbols,this._source.loadTile(o,c)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o,()=>{})}_abortTile(o){if(this._source.abortTile)return this._source.abortTile(o,()=>{})}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const c in this._tiles){const f=this._tiles[c];f.upload(o),f.prepare(this.map.style.imageManager)}}getIds(){return ke(this._tiles).map(o=>o.tileID).sort(cC).map(o=>o.key)}getRenderableIds(o){const c=[];for(const f in this._tiles)this._isIdRenderable(+f,o)&&c.push(this._tiles[f]);return o?c.sort((f,m)=>{const v=f.tileID,E=m.tileID,S=new J(v.canonical.x,v.canonical.y)._rotate(this.transform.angle),M=new J(E.canonical.x,E.canonical.y)._rotate(this.transform.angle);return v.overscaledZ-E.overscaledZ||M.y-S.y||M.x-S.x}).map(f=>f.tileID.key):c.map(f=>f.tileID).sort(cC).map(f=>f.key)}hasRenderableParent(o){const c=this.findLoadedParent(o,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(o,c){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(c||!this._tiles[o].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(+o,"reloading")}}_reloadTile(o,c){const f=this._tiles[o];f&&(f.state!=="loading"&&(f.state=c),this._loadTile(f,this._tileLoaded.bind(this,f,o,c)))}_tileLoaded(o,c,f,m){if(m)if(o.state="errored",m.status!==404)this._source.fire(new Gl(m,{tile:o}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const v=this.map.painter.terrain;this.update(this.transform,v.getScaledDemTileSize(),!0),v.resetTileLookupCache(this.id)}else this.update(this.transform);else o.timeAdded=xr.now(),f==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(c,o),this._source.type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new yr("data",{dataType:"source",tile:o,coord:o.tileID,sourceCacheId:this.id}))}_backfillDEM(o){const c=this.getRenderableIds();for(let m=0;m<c.length;m++){const v=c[m];if(o.neighboringTiles&&o.neighboringTiles[v]){const E=this.getTileByID(v);f(o,E),f(E,o)}}function f(m,v){if(!m.dem||m.dem.borderReady)return;m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0;let E=v.tileID.canonical.x-m.tileID.canonical.x;const S=v.tileID.canonical.y-m.tileID.canonical.y,M=Math.pow(2,m.tileID.canonical.z),R=v.tileID.key;E===0&&S===0||Math.abs(S)>1||(Math.abs(E)>1&&(Math.abs(E+M)===1?E+=M:Math.abs(E-M)===1&&(E-=M)),v.dem&&m.dem&&(m.dem.backfillBorder(v.dem,E,S),m.neighboringTiles&&m.neighboringTiles[R]&&(m.neighboringTiles[R].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,c,f,m){for(const v in this._tiles){let E=this._tiles[v];if(m[v]||!E.hasData()||E.tileID.overscaledZ<=c||E.tileID.overscaledZ>f)continue;let S=E.tileID;for(;E&&E.tileID.overscaledZ>c+1;){const R=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[R.key],E&&E.hasData()&&(S=R)}let M=S;for(;M.overscaledZ>c;)if(M=M.scaledTo(M.overscaledZ-1),o[M.key]){m[S.key]=S;break}}}findLoadedParent(o,c){if(o.key in this._loadedParentTiles){const f=this._loadedParentTiles[o.key];return f&&f.tileID.overscaledZ>=c?f:null}for(let f=o.overscaledZ-1;f>=c;f--){const m=o.scaledTo(f),v=this._getLoadedTile(m);if(v)return v}}_getLoadedTile(o){const c=this._tiles[o.key];return c&&c.hasData()?c:this._cache.getByKey(this._source.reparseOverscaled?o.wrapped().key:o.canonical.key)}updateCacheSize(o,c){c=c||this._source.tileSize;const f=Math.ceil(o.width/c)+1,m=Math.ceil(o.height/c)+1,v=Math.floor(f*m*5),E=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,v):v,S=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,E):E;this._cache.setMaxSize(S)}handleWrapJump(o){const c=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,c){const f={};for(const m in this._tiles){const v=this._tiles[m];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+c),f[v.tileID.key]=v}this._tiles=f;for(const m in this._timers)clearTimeout(this._timers[m]),delete this._timers[m];for(const m in this._tiles)this._setTileReloadTimer(+m,this._tiles[m])}}update(o,c,f){if(this.transform=o,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!f)return;let m;this.updateCacheSize(o,c),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?m=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(S=>new ul(S.canonical.z,S.wrap,S.canonical.z,S.canonical.x,S.canonical.y)):(m=o.coveringTiles({tileSize:c||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!f,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(m=m.filter(S=>this._source.hasTile(S)))):m=[];const v=this._updateRetainedTiles(m);if(hC(this._source.type)&&m.length!==0){const S={},M={},R=Object.keys(v);for(const H of R){const q=v[H],K=this._tiles[H];if(!K||K.fadeEndTime&&K.fadeEndTime<=xr.now())continue;const $=this.findLoadedParent(q,Math.max(q.overscaledZ-h_.maxOverzooming,this._source.minzoom));$&&(this._addTile($.tileID),S[$.tileID.key]=$.tileID),M[H]=q}const U=m[m.length-1].overscaledZ;for(const H in this._tiles){const q=this._tiles[H];if(v[H]||!q.hasData())continue;let K=q.tileID;for(;K.overscaledZ>U;){K=K.scaledTo(K.overscaledZ-1);const $=this._tiles[K.key];if($&&$.hasData()&&M[K.key]){v[H]=q.tileID;break}}}for(const H in S)v[H]||(this._coveredTiles[H]=!0,v[H]=S[H])}for(const S in v)this._tiles[S].clearFadeHold();const E=function(S,M){const R=[];for(const U in S)U in M||R.push(U);return R}(this._tiles,v);for(const S of E){const M=this._tiles[S];M.hasSymbolBuckets&&!M.holdingForFade()?M.setHoldDuration(this.map._fadeDuration):M.hasSymbolBuckets&&!M.symbolFadeFinished()||this._removeTile(+S)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(+o)}_updateRetainedTiles(o){const c={};if(o.length===0)return c;const f={},m=o.reduce((R,U)=>Math.min(R,U.overscaledZ),1/0),v=o[0].overscaledZ,E=Math.max(v-h_.maxOverzooming,this._source.minzoom),S=Math.max(v+h_.maxUnderzooming,this._source.minzoom),M={};for(const R of o){const U=this._addTile(R);c[R.key]=R,U.hasData()||m<this._source.maxzoom&&(M[R.key]=R)}this._retainLoadedChildren(M,m,S,c);for(const R of o){let U=this._tiles[R.key];if(U.hasData())continue;if(R.canonical.z>=this._source.maxzoom){const q=R.children(this._source.maxzoom)[0],K=this.getTile(q);if(K&&K.hasData()){c[q.key]=q;continue}}else{const q=R.children(this._source.maxzoom);if(c[q[0].key]&&c[q[1].key]&&c[q[2].key]&&c[q[3].key])continue}let H=U.wasRequested();for(let q=R.overscaledZ-1;q>=E;--q){const K=R.scaledTo(q);if(f[K.key]||(f[K.key]=!0,U=this.getTile(K),!U&&H&&(U=this._addTile(K)),U&&(c[K.key]=K,H=U.wasRequested(),U.hasData())))break}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const c=[];let f,m=this._tiles[o].tileID;for(;m.overscaledZ>0;){if(m.key in this._loadedParentTiles){f=this._loadedParentTiles[m.key];break}c.push(m.key);const v=m.scaledTo(m.overscaledZ-1);if(f=this._getLoadedTile(v),f)break;m=v}for(const v of c)this._loadedParentTiles[v]=f}}_addTile(o){let c=this._tiles[o.key];if(c)return c;c=this._cache.getAndRemove(o),c&&(this._setTileReloadTimer(o.key,c),c.tileID=o,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,c)));const f=!!c;if(!f){const m=this.map?this.map.painter:null;c=new Sr(o,this._source.tileSize*o.overscaleFactor(),this.transform.tileZoom,m,this._isRaster),this._loadTile(c,this._tileLoaded.bind(this,c,o.key,c.state))}return c?(c.uses++,this._tiles[o.key]=c,f||this._source.fire(new yr("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null}_setTileReloadTimer(o,c){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const f=c.getExpiryTimeout();f&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},f))}_removeTile(o){const c=this._tiles[o];c&&(c.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),c.uses>0||(c.hasData()&&c.state!=="reloading"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(+o);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(o,c,f){const m=[],v=this.transform;if(!v)return m;const E=v.projection.name==="globe",S=lf(v.center.lng);for(const M in this._tiles){const R=this._tiles[M];if(f&&R.clearQueryDebugViz(),R.holdingForFade())continue;let U;if(E){const H=R.tileID.canonical;if(H.z===0){const q=[Math.abs(it(S,...p1(H,-1))-S),Math.abs(it(S,...p1(H,1))-S)];U=[0,2*q.indexOf(Math.min(...q))-1]}else{const q=[Math.abs(it(S,...p1(H,-1))-S),Math.abs(it(S,...p1(H,0))-S),Math.abs(it(S,...p1(H,1))-S)];U=[q.indexOf(Math.min(...q))-1]}}else U=[0];for(const H of U){const q=o.containsTile(R,v,c,H);q&&m.push(q)}}return m}getVisibleCoordinates(o){const c=this.getRenderableIds(o).map(f=>this._tiles[f].tileID);for(const f of c)f.projMatrix=this.transform.calculateProjMatrix(f.toUnwrapped());return c}hasTransition(){if(this._source.hasTransition())return!0;if(hC(this._source.type))for(const o in this._tiles){const c=this._tiles[o];if(c.fadeEndTime!==void 0&&c.fadeEndTime>=xr.now())return!0}return!1}setFeatureState(o,c,f){this._state.updateState(o=o||"_geojsonTileLayer",c,f)}removeFeatureState(o,c,f){this._state.removeFeatureState(o=o||"_geojsonTileLayer",c,f)}getFeatureState(o,c){return this._state.getState(o=o||"_geojsonTileLayer",c)}setDependencies(o,c,f){const m=this._tiles[o];m&&m.setDependencies(c,f)}reloadTilesForDependencies(o,c){for(const f in this._tiles)this._tiles[f].hasDependency(o,c)&&this._reloadTile(+f,"reloading");this._cache.filter(f=>!f.hasDependency(o,c))}_preloadTiles(o,c){const f=new Map,m=Array.isArray(o)?o:[o],v=this.map.painter.terrain,E=this.usedForTerrain&&v?v.getScaledDemTileSize():this._source.tileSize;for(const S of m){const M=S.coveringTiles({tileSize:E,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const R of M)f.set(R.key,R);this.usedForTerrain&&S.updateElevation(!1)}at(Array.from(f.values()),(S,M)=>{const R=new Sr(S,this._source.tileSize*S.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(R,U=>{this._source.type==="raster-dem"&&R.dem&&this._backfillDEM(R),M(U,R)})},c)}}function cC(u,o){const c=Math.abs(2*u.wrap)-+(u.wrap<0),f=Math.abs(2*o.wrap)-+(o.wrap<0);return u.overscaledZ-o.overscaledZ||f-c||o.canonical.y-u.canonical.y||o.canonical.x-u.canonical.x}function hC(u){return u==="raster"||u==="image"||u==="video"||u==="custom"}function p1(u,o){const c=1<<u.z;return[u.x/c+o,(u.x+1)/c+o]}h_.maxOverzooming=10,h_.maxUnderzooming=3;class rE{constructor(o,c,f){this._demTile=o,this._dem=this._demTile.dem,this._scale=c,this._offset=f}static create(o,c,f){const m=f||o.findDEMTileFor(c);if(!m||!m.dem)return;const v=m.dem,E=m.tileID,S=1<<c.canonical.z-E.canonical.z;return new rE(m,m.tileSize/Mi/S,[(c.canonical.x/S-E.canonical.x)*v.dim,(c.canonical.y/S-E.canonical.y)*v.dim])}tileCoordToPixel(o,c){const f=c*this._scale+this._offset[1],m=Math.floor(o*this._scale+this._offset[0]),v=Math.floor(f);return new J(m,v)}getElevationAt(o,c,f,m){const v=o*this._scale+this._offset[0],E=c*this._scale+this._offset[1],S=Math.floor(v),M=Math.floor(E),R=this._dem;return m=!!m,f?Zi(Zi(R.get(S,M,m),R.get(S,M+1,m),E-M),Zi(R.get(S+1,M,m),R.get(S+1,M+1,m),E-M),v-S):R.get(S,M,m)}getElevationAtPixel(o,c,f){return this._dem.get(o,c,!!f)}getMeterToDEM(o){return(1<<this._demTile.tileID.canonical.z)*yh(1,o)*this._dem.stride}}class fC{constructor(o,c){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new Bd(Mi,16,0),this.featureIndexArray=new Jf,this.promoteId=c}insert(o,c,f,m,v,E=0){const S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,m,v,E);const M=this.grid;for(let R=0;R<c.length;R++){const U=c[R],H=[1/0,1/0,-1/0,-1/0];for(let q=0;q<U.length;q++){const K=U[q];H[0]=Math.min(H[0],K.x),H[1]=Math.min(H[1],K.y),H[2]=Math.max(H[2],K.x),H[3]=Math.max(H[3],K.y)}H[0]<Mi&&H[1]<Mi&&H[2]>=0&&H[3]>=0&&M.insert(S,H[0],H[1],H[2],H[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new W0(new Kd(this.rawTileData)).layers,this.sourceLayerCoder=new Z(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const o in this.vtLayers)this.vtFeatures[o]=[]}return this.vtLayers}query(o,c,f,m){this.loadVTLayers();const v=o.params||{},E=bo(v.filter),S=o.tileResult,M=o.transform,R=S.bufferedTilespaceBounds,U=this.grid.query(R.min.x,R.min.y,R.max.x,R.max.y,($,ie,me,Me)=>ex(S.bufferedTilespaceGeometry,$,ie,me,Me));U.sort(TP);let H=null;M.elevation&&U.length>0&&(H=rE.create(M.elevation,this.tileID));const q={};let K;for(let $=0;$<U.length;$++){const ie=U[$];if(ie===K)continue;K=ie;const me=this.featureIndexArray.get(ie);let Me=null;this.loadMatchingFeature(q,me,E,v.layers,v.availableImages,c,f,m,(Ve,Se,ze,Ze=0)=>(Me||(Me=td(Ve,this.tileID.canonical,o.tileTransform)),Se.queryIntersectsFeature(S,Ve,ze,Me,this.z,o.transform,o.pixelPosMatrix,H,Ze)))}return q}loadMatchingFeature(o,c,f,m,v,E,S,M,R){const{featureIndex:U,bucketIndex:H,sourceLayerIndex:q,layoutVertexArrayOffset:K}=c,$=this.bucketLayerIDs[H];if(m&&!function(Ve,Se){for(let ze=0;ze<Ve.length;ze++)if(Se.indexOf(Ve[ze])>=0)return!0;return!1}(m,$))return;const ie=this.sourceLayerCoder.decode(q),me=this.vtLayers[ie].feature(U);if(f.needGeometry){const Ve=Yp(me,!0);if(!f.filter(new ft(this.tileID.overscaledZ),Ve,this.tileID.canonical))return}else if(!f.filter(new ft(this.tileID.overscaledZ),me))return;const Me=this.getId(me,ie);for(let Ve=0;Ve<$.length;Ve++){const Se=$[Ve];if(m&&m.indexOf(Se)<0)continue;const ze=E[Se];if(!ze)continue;let Ze={};Me!==void 0&&M&&(Ze=M.getState(ze.sourceLayer||"_geojsonTileLayer",Me));const qe=Dt({},S[Se]);qe.paint=dC(qe.paint,ze.paint,me,Ze,v),qe.layout=dC(qe.layout,ze.layout,me,Ze,v);const It=!R||R(me,ze,Ze,K);if(!It)continue;const bt=new Ee(me,this.z,this.x,this.y,Me);bt.layer=qe;let Vt=o[Se];Vt===void 0&&(Vt=o[Se]=[]),Vt.push({featureIndex:U,feature:bt,intersectionZ:It})}}lookupSymbolFeatures(o,c,f,m,v,E,S,M){const R={};this.loadVTLayers();const U=bo(v);for(const H of o)this.loadMatchingFeature(R,{bucketIndex:f,sourceLayerIndex:m,featureIndex:H,layoutVertexArrayOffset:0},U,E,S,M,c);return R}loadFeature(o){const{featureIndex:c,sourceLayerIndex:f}=o;this.loadVTLayers();const m=this.sourceLayerCoder.decode(f),v=this.vtFeatures[m];if(v[c])return v[c];const E=this.vtLayers[m].feature(c);return v[c]=E,E}hasLayer(o){for(const c of this.bucketLayerIDs)for(const f of c)if(o===f)return!0;return!1}getId(o,c){let f=o.id;if(this.promoteId){const m=typeof this.promoteId=="string"?this.promoteId:this.promoteId[c];m!=null&&(f=o.properties[m]),typeof f=="boolean"&&(f=Number(f))}return f}}function dC(u,o,c,f,m){return _t(u,(v,E)=>{const S=o instanceof yt?o.get(E):null;return S&&S.evaluate?S.evaluate(c,f,m):S})}function TP(u,o){return o-u}Gn(fC,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class pC{constructor(o,c){this.width=o,this.height=c,this.nextRow=0,this.image=new Rc({width:o,height:c}),this.positions={},this.uploaded=!1}getDash(o,c){const f=this.getKey(o,c);return this.positions[f]}trim(){const o=this.width,c=this.height=Mt(this.nextRow);this.image.resize({width:o,height:c})}getKey(o,c){return o.join(",")+c}getDashRanges(o,c,f){const m=[];let v=o.length%2==1?-o[o.length-1]*f:0,E=o[0]*f,S=!0;m.push({left:v,right:E,isDash:S,zeroLength:o[0]===0});let M=o[0];for(let R=1;R<o.length;R++){S=!S;const U=o[R];v=M*f,M+=U,E=M*f,m.push({left:v,right:E,isDash:S,zeroLength:U===0})}return m}addRoundDash(o,c,f){const m=c/2;for(let v=-f;v<=f;v++){const E=this.width*(this.nextRow+f+v);let S=0,M=o[S];for(let R=0;R<this.width;R++){R/M.right>1&&(M=o[++S]);const U=Math.abs(R-M.left),H=Math.abs(R-M.right),q=Math.min(U,H);let K;const $=v/f*(m+1);if(M.isDash){const ie=m-Math.abs($);K=Math.sqrt(q*q+ie*ie)}else K=m-Math.sqrt(q*q+$*$);this.image.data[E+R]=Math.max(0,Math.min(255,K+128))}}}addRegularDash(o,c){for(let M=o.length-1;M>=0;--M){const R=o[M],U=o[M+1];R.zeroLength?o.splice(M,1):U&&U.isDash===R.isDash&&(U.left=R.left,o.splice(M,1))}const f=o[0],m=o[o.length-1];f.isDash===m.isDash&&(f.left=m.left-this.width,m.right=f.right+this.width);const v=this.width*this.nextRow;let E=0,S=o[E];for(let M=0;M<this.width;M++){M/S.right>1&&(S=o[++E]);const R=Math.abs(M-S.left),U=Math.abs(M-S.right),H=Math.min(R,U);this.image.data[v+M]=Math.max(0,Math.min(255,(S.isDash?H:-H)+c+128))}}addDash(o,c){const f=this.getKey(o,c);if(this.positions[f])return this.positions[f];const m=c==="round",v=m?7:0,E=2*v+1;if(this.nextRow+E>this.height)return Zn("LineAtlas out of space"),null;o.length===0&&o.push(1);let S=0;for(let U=0;U<o.length;U++)o[U]<0&&(Zn("Negative value is found in line dasharray, replacing values with 0"),o[U]=0),S+=o[U];if(S!==0){const U=this.width/S,H=this.getDashRanges(o,this.width,U);m?this.addRoundDash(H,U,v):this.addRegularDash(H,c==="square"?.5*U:0)}const M=this.nextRow+v;this.nextRow+=E;const R={tl:[M,v],br:[S,0]};return this.positions[f]=R,R}}Gn(pC,"LineAtlas");class mC{constructor(o){const c={},f=[];for(const S in o){const M=o[S],R=c[S]={};for(const U in M.glyphs){const H=M.glyphs[+U];if(!H||H.bitmap.width===0||H.bitmap.height===0)continue;const q=H.metrics.localGlyph?2:1,K={x:0,y:0,w:H.bitmap.width+2*q,h:H.bitmap.height+2*q};f.push(K),R[U]=K}}const{w:m,h:v}=Xy(f),E=new Rc({width:m||1,height:v||1});for(const S in o){const M=o[S];for(const R in M.glyphs){const U=M.glyphs[+R];if(!U||U.bitmap.width===0||U.bitmap.height===0)continue;const H=c[S][R],q=U.metrics.localGlyph?2:1;Rc.copy(U.bitmap,E,{x:0,y:0},{x:H.x+q,y:H.y+q},U.bitmap)}}this.image=E,this.positions=c}}Gn(mC,"GlyphAtlas");class wP{constructor(o){this.tileID=new ul(o.tileID.overscaledZ,o.tileID.wrap,o.tileID.canonical.z,o.tileID.canonical.x,o.tileID.canonical.y),this.tileZoom=o.tileZoom,this.uid=o.uid,this.zoom=o.zoom,this.canonical=o.tileID.canonical,this.pixelRatio=o.pixelRatio,this.tileSize=o.tileSize,this.source=o.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=o.showCollisionBoxes,this.collectResourceTiming=!!o.collectResourceTiming,this.returnDependencies=!!o.returnDependencies,this.promoteId=o.promoteId,this.enableTerrain=!!o.enableTerrain,this.isSymbolTile=o.isSymbolTile,this.tileTransform=$p(o.tileID.canonical,o.projection),this.projection=o.projection}parse(o,c,f,m,v){this.status="parsing",this.data=o,this.collisionBoxArray=new m0;const E=new Z(Object.keys(o.layers).sort()),S=new fC(this.tileID,this.promoteId);S.bucketLayerIDs=[];const M={},R=new pC(256,256),U={featureIndex:S,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:R,availableImages:f},H=c.familiesBySource[this.source];for(const Ze in H){const qe=o.layers[Ze];if(!qe)continue;let It=!1,bt=!1;for(const At of H[Ze])At[0].type==="symbol"?It=!0:bt=!0;if(this.isSymbolTile===!0&&!It||this.isSymbolTile===!1&&!bt)continue;qe.version===1&&Zn(`Vector tile source "${this.source}" layer "${Ze}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Vt=E.encode(Ze),pn=[];for(let At=0;At<qe.length;At++){const Yt=qe.feature(At),$t=S.getId(Yt,Ze);pn.push({feature:Yt,id:$t,index:At,sourceLayerIndex:Vt})}for(const At of H[Ze]){const Yt=At[0];this.isSymbolTile!==void 0&&Yt.type==="symbol"!==this.isSymbolTile||Yt.minzoom&&this.zoom<Math.floor(Yt.minzoom)||Yt.maxzoom&&this.zoom>=Yt.maxzoom||Yt.visibility!=="none"&&(dw(At,this.zoom,f),(M[Yt.id]=Yt.createBucket({index:S.bucketLayerIDs.length,layers:At,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Vt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:f})).populate(pn,U,this.tileID.canonical,this.tileTransform),S.bucketLayerIDs.push(At.map($t=>$t.id)))}}let q,K,$,ie;R.trim();const me={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Me=_t(U.glyphDependencies,Ze=>Object.keys(Ze).map(Number));Object.keys(Me).length?m.send("getGlyphs",{uid:this.uid,stacks:Me},(Ze,qe)=>{q||(q=Ze,K=qe,ze.call(this))},void 0,!1,me):K={};const Ve=Object.keys(U.iconDependencies);Ve.length?m.send("getImages",{icons:Ve,source:this.source,tileID:this.tileID,type:"icons"},(Ze,qe)=>{q||(q=Ze,$=qe,ze.call(this))},void 0,!1,me):$={};const Se=Object.keys(U.patternDependencies);function ze(){if(q)return v(q);if(K&&$&&ie){const Ze=new mC(K),qe=new Dx($,ie);for(const It in M){const bt=M[It];bt instanceof Qd?(dw(bt.layers,this.zoom,f),XT(bt,K,Ze.positions,$,qe.iconPositions,this.showCollisionBoxes,f,this.tileID.canonical,this.tileZoom,this.projection)):bt.hasPattern&&(bt instanceof Yd||bt instanceof e_||bt instanceof fr)&&(dw(bt.layers,this.zoom,f),bt.addFeatures(U,this.tileID.canonical,qe.patternPositions,f,this.tileTransform))}this.status="done",v(null,{buckets:ke(M).filter(It=>!It.isEmpty()),featureIndex:S,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ze.image,lineAtlas:R,imageAtlas:qe,glyphMap:this.returnDependencies?K:null,iconMap:this.returnDependencies?$:null,glyphPositions:this.returnDependencies?Ze.positions:null})}}Se.length?m.send("getImages",{icons:Se,source:this.source,tileID:this.tileID,type:"patterns"},(Ze,qe)=>{q||(q=Ze,ie=qe,ze.call(this))},void 0,!1,me):ie={},ze.call(this)}}function dw(u,o,c){const f=new ft(o);for(const m of u)m.recalculate(f,c)}class gC{constructor(o){this.entries={},this.scheduler=o}request(o,c,f,m){const v=this.entries[o]=this.entries[o]||{callbacks:[]};if(v.result){const[E,S]=v.result;return this.scheduler?this.scheduler.add(()=>{m(E,S)},c):m(E,S),()=>{}}return v.callbacks.push(m),v.cancel||(v.cancel=f((E,S)=>{v.result=[E,S];for(const M of v.callbacks)this.scheduler?this.scheduler.add(()=>{M(E,S)},c):M(E,S);setTimeout(()=>delete this.entries[o],3e3)})),()=>{v.result||(v.callbacks=v.callbacks.filter(E=>E!==m),v.callbacks.length||(v.cancel(),delete this.entries[o]))}}}function _C(u,o,c){const f=JSON.stringify(u.request);return u.data&&(this.deduped.entries[f]={result:[null,u.data]}),this.deduped.request(f,{type:"parseTile",isSymbolTile:u.isSymbolTile,zoom:u.tileZoom},m=>{const v=js(u.request,(E,S,M,R)=>{E?m(E):S&&m(null,{vectorTile:c?void 0:new W0(new Kd(S)),rawData:S,cacheControl:M,expires:R})});return()=>{v.cancel(),m()}},o)}s.ARRAY_TYPE=al,s.AUTH_ERR_MSG=Ja,s.Aabb=wl,s.Actor=class{constructor(u,o,c){this.target=u,this.parent=o,this.mapId=c,this.callbacks={},this.cancelCallbacks={},xn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Pt()?u:d,this.scheduler=new D}send(u,o,c,f,m=!1,v){const E=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(c.metadata=v,this.callbacks[E]=c);const S=Dr(this.globalScope)?void 0:[];return this.target.postMessage({id:E,type:u,hasCallback:!!c,targetMapId:f,mustQueue:m,sourceMapId:this.mapId,data:Up(o,S)},S),{cancel:()=>{c&&delete this.callbacks[E],this.target.postMessage({id:E,type:"<cancel>",targetMapId:f,sourceMapId:this.mapId})}}}receive(u){const o=u.data,c=o.id;if(c&&(!o.targetMapId||this.mapId===o.targetMapId))if(o.type==="<cancel>"){const f=this.cancelCallbacks[c];delete this.cancelCallbacks[c],f&&f.cancel()}else if(o.mustQueue||Pt()){const f=this.callbacks[c];this.cancelCallbacks[c]=this.scheduler.add(()=>this.processTask(c,o),f&&f.metadata||{type:"message"})}else this.processTask(c,o)}processTask(u,o){if(o.type==="<response>"){const c=this.callbacks[u];delete this.callbacks[u],c&&(o.error?c(Vp(o.error)):c(null,Vp(o.data)))}else{const c=Dr(this.globalScope)?void 0:[],f=o.hasCallback?(v,E)=>{delete this.cancelCallbacks[u],this.target.postMessage({id:u,type:"<response>",sourceMapId:this.mapId,error:v?Up(v):null,data:Up(E,c)},c)}:v=>{},m=Vp(o.data);if(this.parent[o.type])this.parent[o.type](o.sourceMapId,m,f);else if(this.parent.getWorkerSource){const v=o.type.split(".");this.parent.getWorkerSource(o.sourceMapId,v[0],m.source)[v[1]](m,f)}else f(new Error(`Could not find function ${o.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},s.CanonicalTileID=qy,s.Color=qi,s.ColorMode=$d,s.CullFaceMode=od,s.DEMData=iE,s.DataConstantProperty=ht,s.DedupedRequest=gC,s.DepthMode=ov,s.EXTENT=Mi,s.Elevation=class{isDataAvailableAtPoint(u){const o=this._source();if(this.isUsingMockSource()||!o||u.y<0||u.y>1)return!1;const c=o.getSource().maxzoom,f=1<<c,m=Math.floor(u.x),v=Math.floor((u.x-m)*f),E=Math.floor(u.y*f),S=this.findDEMTileFor(new ul(c,m,c,v,E));return!(!S||!S.dem)}getAtPointOrZero(u,o=0){return this.getAtPoint(u,o)||0}getAtPoint(u,o,c=!0){if(this.isUsingMockSource())return null;o==null&&(o=null);const f=this._source();if(!f||u.y<0||u.y>1)return o;const m=f.getSource().maxzoom,v=1<<m,E=Math.floor(u.x),S=u.x-E,M=new ul(m,E,m,Math.floor(S*v),Math.floor(u.y*v)),R=this.findDEMTileFor(M);if(!R||!R.dem)return o;const U=R.dem,H=1<<R.tileID.canonical.z,q=(S*H-R.tileID.canonical.x)*U.dim,K=(u.y*H-R.tileID.canonical.y)*U.dim,$=Math.floor(q),ie=Math.floor(K);return(c?this.exaggeration():1)*Zi(Zi(U.get($,ie),U.get($,ie+1),K-ie),Zi(U.get($+1,ie),U.get($+1,ie+1),K-ie),q-$)}getAtTileOffset(u,o,c){const f=1<<u.canonical.z;return this.getAtPointOrZero(new Fm(u.wrap+(u.canonical.x+o/Mi)/f,(u.canonical.y+c/Mi)/f))}getAtTileOffsetFunc(u,o,c,f){return m=>{const v=this.getAtTileOffset(u,m.x,m.y),E=f.upVector(u.canonical,m.x,m.y);return Il(E,E,v*f.upVectorScale(u.canonical,o,c).metersToTile),E}}getForTilePoints(u,o,c,f){if(this.isUsingMockSource())return!1;const m=rE.create(this,u,f);return!!m&&(o.forEach(v=>{v[2]=this.exaggeration()*m.getElevationAt(v[0],v[1],c)}),!0)}getMinMaxForTile(u){if(this.isUsingMockSource())return null;const o=this.findDEMTileFor(u);if(!o||!o.dem)return null;const c=o.dem.tree,f=o.tileID,m=1<<u.canonical.z-f.canonical.z;let v=u.canonical.x/m-f.canonical.x,E=u.canonical.y/m-f.canonical.y,S=0;for(let M=0;M<u.canonical.z-f.canonical.z&&!c.leaves[S];M++){v*=2,E*=2;const R=2*Math.floor(E)+Math.floor(v);S=c.childOffsets[S]+R,v%=1,E%=1}return{min:this.exaggeration()*c.minimums[S],max:this.exaggeration()*c.maximums[S]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(u,o,c){throw new Error("Pure virtual method called.")}pointCoordinate(u){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(u){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},s.ErrorEvent=Gl,s.EvaluationParameters=ft,s.Event=yr,s.Evented=fa,s.FillExtrusionBucket=fr,s.Frustum=T0,s.FrustumCorners=xy,s.GLOBE_RADIUS=of,s.GLOBE_SCALE_MATCH_LATITUDE=45,s.GLOBE_ZOOM_THRESHOLD_MAX=6,s.GLOBE_ZOOM_THRESHOLD_MIN=5,s.GlobeSharedBuffers=class{constructor(u){this._createGrid(u),this._createPoles(u)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const u of this._poleSegments)u.destroy();for(const u of this._gridSegments)u.withSkirts.destroy(),u.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const u of this._wireframeSegments)u.destroy()}}_fillGridMeshWithLods(u,o){const c=new bi,f=new _a,m=[],v=u+1+2,E=o[0]+1,S=o[0]+1+(1+o.length),M=(R,U,H)=>{let q=R===v-1?R-2:R===0?R:R-1;return q+=H?24575:0,[q,U]};for(let R=0;R<v;++R)c.emplaceBack(...M(R,0,!0));for(let R=0;R<E;++R)for(let U=0;U<v;++U)c.emplaceBack(...M(U,R,(U===0||U===v-1)&&!0));for(let R=0;R<o.length;++R){const U=o[R];for(let H=0;H<v;++H)c.emplaceBack(...M(H,U,!0))}for(let R=0;R<o.length;++R){const U=f.length,H=o[R]+1+2,q=new _a;for(let ie=0;ie<H-1;ie++){const me=ie===H-2,Me=me?v*(S-o.length+R-ie):v;for(let Ve=0;Ve<v-1;Ve++){const Se=ie*v+Ve;ie===0||me||Ve===0||Ve===v-2?(q.emplaceBack(Se+1,Se,Se+Me),q.emplaceBack(Se+Me,Se+Me+1,Se+1)):(f.emplaceBack(Se+1,Se,Se+Me),f.emplaceBack(Se+Me,Se+Me+1,Se+1))}}const K=Qs.simpleSegment(0,U,c.length,f.length-U);for(let ie=0;ie<q.uint16.length;ie+=3)f.emplaceBack(q.uint16[ie],q.uint16[ie+1],q.uint16[ie+2]);const $=Qs.simpleSegment(0,U,c.length,f.length-U);m.push({withoutSkirts:K,withSkirts:$})}return{vertices:c,indices:f,segments:m}}_createGrid(u){const o=this._fillGridMeshWithLods(Xp,Pm);this._gridSegments=o.segments,this._gridBuffer=u.createVertexBuffer(o.vertices,ed.members),this._gridIndexBuffer=u.createIndexBuffer(o.indices,!0)}_createPoles(u){const o=new _a;for(let m=0;m<=Xp;m++)o.emplaceBack(0,m+1,m+2);this._poleIndexBuffer=u.createIndexBuffer(o,!0);const c=new Ki,f=new Ki;this._poleSegments=[];for(let m=0,v=0;m<5;m++){const E=360/(1<<m);c.emplaceBack(0,-of,0,.5,0),f.emplaceBack(0,-of,0,.5,1);for(let S=0;S<=Xp;S++){const M=S/Xp,R=Zi(0,E,M),[U,H,q]=Om(jb,qb,R,of);c.emplaceBack(U,H,q,M,0),f.emplaceBack(U,H,q,M,1)}this._poleSegments.push(Qs.simpleSegment(v,0,66,64)),v+=66}this._poleNorthVertexBuffer=u.createVertexBuffer(c,zb,!1),this._poleSouthVertexBuffer=u.createVertexBuffer(f,zb,!1)}getGridBuffers(u,o){return[this._gridBuffer,this._gridIndexBuffer,o?this._gridSegments[u].withSkirts:this._gridSegments[u].withoutSkirts]}getPoleBuffers(u){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[u]]}getWirefameBuffers(u,o){if(!this._wireframeSegments){const c=new nf,f=Xp,m=f+1+2,v=1;this._wireframeSegments=[];for(let E=0,S=0;E<Pm.length;E++){const M=Pm[E];for(let U=v;U<M+v;U++)for(let H=v;H<f+v;H++){const q=U*m+H;c.emplaceBack(q,q+1),c.emplaceBack(q,q+m),c.emplaceBack(q,q+m+1)}const R=M*f*3;this._wireframeSegments.push(Qs.simpleSegment(0,S,(M+1)*m,R)),S+=R}this._wireframeIndexBuffer=u.createIndexBuffer(c)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[o]]}},s.GlyphManager=qm,s.ImagePosition=$0,s.LivePerformanceUtils=nt,s.LngLat=kr,s.LngLatBounds=fh,s.LocalGlyphMode=r1,s.MAX_MERCATOR_LATITUDE=Ds,s.MercatorCoordinate=Fm,s.ONE_EM=va,s.OverscaledTileID=ul,s.PerformanceMarkers=pe,s.Properties=ln,s.RGBAImage=yu,s.Ray=by,s.RequestManager=class{constructor(u,o,c){this._transformRequestFn=u,this._customAccessToken=o,this._silenceAuthErrors=!!c,this._createSkuToken()}_createSkuToken(){const u=function(){let o="";for(let c=0;c<10;c++)o+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",V,o].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=u.token,this._skuTokenExpiresAt=u.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(u,o){return this._transformRequestFn&&this._transformRequestFn(u,o)||{url:u}}normalizeStyleURL(u,o){if(!go(u))return u;const c=Zs(u);return c.path=`/styles/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||o)}normalizeGlyphsURL(u,o){if(!go(u))return u;const c=Zs(u);return c.path=`/fonts/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||o)}normalizeSourceURL(u,o,c,f){if(!go(u))return u;const m=Zs(u);return m.path=`/v4/${m.authority}.json`,m.params.push("secure"),c&&m.params.push(`language=${c}`),f&&m.params.push(`worldview=${f}`),this._makeAPIURL(m,this._customAccessToken||o)}normalizeSpriteURL(u,o,c,f){const m=Zs(u);return go(u)?(m.path=`/styles/v1${m.path}/sprite${o}${c}`,this._makeAPIURL(m,this._customAccessToken||f)):(m.path+=`${o}${c}`,La(m))}normalizeTileURL(u,o,c){if(this._isSkuTokenExpired()&&this._createSkuToken(),u&&!go(u))return u;const f=Zs(u);f.path=f.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${o||c&&f.authority!=="raster"&&c===512?"@2x":""}${A.supported?".webp":"$1"}`),f.authority==="raster"?f.path=`/${I.RASTER_URL_PREFIX}${f.path}`:(f.path=f.path.replace(/^.+\/v4\//,"/"),f.path=`/${I.TILE_URL_VERSION}${f.path}`);const m=this._customAccessToken||function(v){for(const E of v){const S=E.match(/^access_token=(.*)$/);if(S)return S[1]}return null}(f.params)||I.ACCESS_TOKEN;return I.REQUIRE_ACCESS_TOKEN&&m&&this._skuToken&&f.params.push(`sku=${this._skuToken}`),this._makeAPIURL(f,m)}canonicalizeTileURL(u,o){const c=Zs(u);if(!c.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!c.path.match(/\.[\w]+$/))return u;let f="mapbox://";c.path.match(/^\/raster\/v1\//)?f+=`raster/${c.path.replace(`/${I.RASTER_URL_PREFIX}/`,"")}`:f+=`tiles/${c.path.replace(`/${I.TILE_URL_VERSION}/`,"")}`;let m=c.params;return o&&(m=m.filter(v=>!v.match(/^access_token=/))),m.length&&(f+=`?${m.join("&")}`),f}canonicalizeTileset(u,o){const c=!!o&&go(o),f=[];for(const m of u.tiles||[])Ma(m)?f.push(this.canonicalizeTileURL(m,c)):f.push(m);return f}_makeAPIURL(u,o){const c="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",f=Zs(I.API_URL);if(u.protocol=f.protocol,u.authority=f.authority,u.protocol==="http"){const m=u.params.indexOf("secure");m>=0&&u.params.splice(m,1)}if(f.path!=="/"&&(u.path=`${f.path}${u.path}`),!I.REQUIRE_ACCESS_TOKEN)return La(u);if(o=o||I.ACCESS_TOKEN,!this._silenceAuthErrors){if(!o)throw new Error(`An API access token is required to use Mapbox GL. ${c}`);if(o[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${c}`)}return u.params=u.params.filter(m=>m.indexOf("access_token")===-1),u.params.push(`access_token=${o||""}`),La(u)}},s.ResourceType=Xt,s.SegmentVector=Qs,s.SourceCache=h_,s.StencilMode=cw,s.StructArrayLayout1ui2=mu,s.StructArrayLayout2f1f2i16=ga,s.StructArrayLayout2i4=bi,s.StructArrayLayout2ui4=nf,s.StructArrayLayout3f12=la,s.StructArrayLayout3ui6=_a,s.StructArrayLayout4i8=$r,s.StructArrayLayout5f20=Ki,s.Texture=_,s.Tile=Sr,s.Transitionable=Tn,s.Uniform1f=gy,s.Uniform1i=class extends lh{constructor(u){super(u),this.current=0}set(u,o,c){this.fetchUniformLocation(u,o)&&this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},s.Uniform2f=class extends lh{constructor(u){super(u),this.current=[0,0]}set(u,o,c){this.fetchUniformLocation(u,o)&&(c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1])))}},s.Uniform3f=class extends lh{constructor(u){super(u),this.current=[0,0,0]}set(u,o,c){this.fetchUniformLocation(u,o)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2])))}},s.Uniform4f=Ib,s.UniformColor=Tb,s.UniformMatrix2f=class extends lh{constructor(u){super(u),this.current=PI}set(u,o,c){if(this.fetchUniformLocation(u,o)){for(let f=0;f<4;f++)if(c[f]!==this.current[f]){this.current=c,this.gl.uniformMatrix2fv(this.location,!1,c);break}}}},s.UniformMatrix3f=class extends lh{constructor(u){super(u),this.current=Sb}set(u,o,c){if(this.fetchUniformLocation(u,o)){for(let f=0;f<9;f++)if(c[f]!==this.current[f]){this.current=c,this.gl.uniformMatrix3fv(this.location,!1,c);break}}}},s.UniformMatrix4f=class extends lh{constructor(u){super(u),this.current=wb}set(u,o,c){if(this.fetchUniformLocation(u,o)){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let f=1;f<16;f++)if(c[f]!==this.current[f]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}}},s.UnwrappedTileID=cf,s.ValidationError=Vn,s.VectorTileFeature=Gy,s.VectorTileWorkerSource=class extends fa{constructor(u,o,c,f,m){super(),this.actor=u,this.layerIndex=o,this.availableImages=c,this.loadVectorData=m||_C,this.loading={},this.loaded={},this.deduped=new gC(u.scheduler),this.isSpriteLoaded=f,this.scheduler=u.scheduler}loadTile(u,o){const c=u.uid,f=u&&u.request,m=f&&f.collectResourceTiming,v=this.loading[c]=new wP(u);v.abort=this.loadVectorData(u,(E,S)=>{const M=!this.loading[c];if(delete this.loading[c],M||E||!S)return v.status="done",M||(this.loaded[c]=v),o(E);const R=S.rawData,U={};S.expires&&(U.expires=S.expires),S.cacheControl&&(U.cacheControl=S.cacheControl),v.vectorTile=S.vectorTile||new W0(new Kd(R));const H=()=>{v.parse(v.vectorTile,this.layerIndex,this.availableImages,this.actor,(q,K)=>{if(q||!K)return o(q);const $={};if(m){const ie=On(f);ie.length>0&&($.resourceTiming=JSON.parse(JSON.stringify(ie)))}o(null,Dt({rawTileData:R.slice(0)},K,U,$))})};this.isSpriteLoaded?H():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(H,{type:"parseTile",isSymbolTile:u.isSymbolTile,zoom:u.tileZoom}):H()}),this.loaded=this.loaded||{},this.loaded[c]=v})}reloadTile(u,o){const c=this.loaded,f=u.uid,m=this;if(c&&c[f]){const v=c[f];v.showCollisionBoxes=u.showCollisionBoxes,v.enableTerrain=!!u.enableTerrain,v.projection=u.projection,v.tileTransform=$p(u.tileID.canonical,u.projection);const E=(S,M)=>{const R=v.reloadCallback;R&&(delete v.reloadCallback,v.parse(v.vectorTile,m.layerIndex,this.availableImages,m.actor,R)),o(S,M)};v.status==="parsing"?v.reloadCallback=E:v.status==="done"&&(v.vectorTile?v.parse(v.vectorTile,this.layerIndex,this.availableImages,this.actor,E):E())}}abortTile(u,o){const c=u.uid,f=this.loading[c];f&&(f.abort&&f.abort(),delete this.loading[c]),o()}removeTile(u,o){const c=this.loaded,f=u.uid;c&&c[f]&&delete c[f],o()}},s.WritingMode=Ku,s.ZoomDependentExpression=ju,s.add=ph,s.addDynamicAttributes=rv,s.adjoint=function(u,o){var c=o[0],f=o[1],m=o[2],v=o[3],E=o[4],S=o[5],M=o[6],R=o[7],U=o[8];return u[0]=E*U-S*R,u[1]=m*R-f*U,u[2]=f*S-m*E,u[3]=S*M-v*U,u[4]=c*U-m*M,u[5]=m*v-c*S,u[6]=v*R-E*M,u[7]=f*M-c*R,u[8]=c*E-f*v,u},s.asyncAll=at,s.bezier=Pe,s.bindAll=xn,s.boundsAttributes=Ci,s.bufferConvexPolygon=function(u,o){const c=[];for(let f=0;f<u.length;f++){const m=Ue(f-1,-1,u.length-1),v=Ue(f+1,-1,u.length-1),E=u[f],S=u[v],M=u[m].sub(E).unit(),R=S.sub(E).unit(),U=R.angleWithSep(M.x,M.y),H=M.add(R).unit().mult(-1*o/Math.sin(U/2));c.push(E.add(H))}return c},s.cacheEntryPossiblyAdded=function(u){Hs++,Hs>Ei&&(u.getActor().send("enforceCacheSizeLimit",kn),Hs=0)},s.calculateGlobeLabelMatrix=function(u,o){const{x:c,y:f}=u.point,m=Gb(c,f,u.worldSize/u._pixelsPerMercatorPixel,0,0);return $f(m,m,A0(gh(o)))},s.calculateGlobeMatrix=function(u){const{x:o,y:c}=u.point,{lng:f,lat:m}=u._center;return Gb(o,c,u.worldSize,f,m)},s.calculateGlobeMercatorMatrix=function(u){const o=u.pixelsPerMeter,c=o/yh(1,u.center.lat),f=_u(new Float64Array(16));return zg(f,f,[u.point.x,u.point.y,0]),qd(f,f,[c,c,o]),Float32Array.from(f)},s.circumferenceAtLatitude=Sy,s.clamp=it,s.clearTileCache=function(u){if(!ni())return;const o=d.caches.delete(Jt);u&&o.catch(u).then(()=>u())},s.clipLine=Hx,s.clone=function(u){var o=new al(16);return o[0]=u[0],o[1]=u[1],o[2]=u[2],o[3]=u[3],o[4]=u[4],o[5]=u[5],o[6]=u[6],o[7]=u[7],o[8]=u[8],o[9]=u[9],o[10]=u[10],o[11]=u[11],o[12]=u[12],o[13]=u[13],o[14]=u[14],o[15]=u[15],o},s.clone$1=Ct,s.collisionCircleLayout=TT,s.config=I,s.conjugate=function(u,o){return u[0]=-o[0],u[1]=-o[1],u[2]=-o[2],u[3]=o[3],u},s.create=function(){var u=new al(16);return al!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u},s.create$1=Pb,s.createExpression=ih,s.createLayout=di,s.createStyleLayer=function(u){return u.type==="custom"?new ow(u):new lw[u.type](u)},s.cross=Hg,s.degToRad=De,s.distance=function(u,o){return Math.hypot(o[0]-u[0],o[1]-u[1],o[2]-u[2])},s.div=function(u,o,c){return u[0]=o[0]/c[0],u[1]=o[1]/c[1],u[2]=o[2]/c[2],u},s.dot=Mc,s.earthRadius=Zg,s.ease=Ce,s.easeCubicInOut=Be,s.ecefToLatLng=function([u,o,c]){const f=Math.hypot(u,o,c),m=Math.atan2(u,c),v=.5*Math.PI-Math.acos(-o/f);return new kr(fe(m),fe(v))},s.emitValidationErrors=ey,s.endsWith=En,s.enforceCacheSizeLimit=function(u){Ln(),ui&&ui.then(o=>{o.keys().then(c=>{for(let f=0;f<c.length-u;f++)o.delete(c[f])})})},s.evaluateSizeForFeature=r_,s.evaluateSizeForZoom=cl,s.evaluateVariableOffset=Zx,s.evented=Re,s.exactEquals=function(u,o){return u[0]===o[0]&&u[1]===o[1]&&u[2]===o[2]&&u[3]===o[3]},s.exactEquals$1=function(u,o){return u[0]===o[0]&&u[1]===o[1]&&u[2]===o[2]},s.exported=xr,s.exported$1=A,s.extend=Dt,s.extend$1=Hl,s.fillExtrusionHeightLift=bx,s.filterObject=kt,s.fromMat4=function(u,o){return u[0]=o[0],u[1]=o[1],u[2]=o[2],u[3]=o[4],u[4]=o[5],u[5]=o[6],u[6]=o[8],u[7]=o[9],u[8]=o[10],u},s.fromQuat=function(u,o){var c=o[0],f=o[1],m=o[2],v=o[3],E=c+c,S=f+f,M=m+m,R=c*E,U=f*E,H=f*S,q=m*E,K=m*S,$=m*M,ie=v*E,me=v*S,Me=v*M;return u[0]=1-H-$,u[1]=U+Me,u[2]=q-me,u[3]=0,u[4]=U-Me,u[5]=1-R-$,u[6]=K+ie,u[7]=0,u[8]=q+me,u[9]=K-ie,u[10]=1-R-H,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},s.fromRotation=function(u,o){var c=Math.sin(o),f=Math.cos(o);return u[0]=f,u[1]=c,u[2]=0,u[3]=-c,u[4]=f,u[5]=0,u[6]=0,u[7]=0,u[8]=1,u},s.fromScaling=b0,s.furthestTileCorner=function(u){const o=Math.round((u+45+360)%360/90)%4;return le[o]},s.getAABBPointSquareDist=function(u,o,c){let f=0;for(let m=0;m<2;++m){const v=c?c[m]:0;u[m]>v&&(f+=(u[m]-v)*(u[m]-v)),o[m]<v&&(f+=(v-o[m])*(v-o[m]))}return f},s.getAnchorAlignment=Jd,s.getAnchorJustification=o_,s.getBounds=function(u){let o=1/0,c=1/0,f=-1/0,m=-1/0;for(const v of u)o=Math.min(o,v.x),c=Math.min(c,v.y),f=Math.max(f,v.x),m=Math.max(m,v.y);return{min:new J(o,c),max:new J(f,m)}},s.getColumn=He,s.getGridMatrix=function(u,o,c,f){const m=o.getNorth(),v=o.getSouth(),E=o.getWest(),S=o.getEast(),M=1<<u.z,R=S-E,U=m-v,H=R/Xp,q=-U/Pm[c],K=[0,H,0,q,0,0,m,E,0];if(u.z>0){const $=180/f;v0(K,K,[$/R+1,0,0,0,$/U+1,0,-.5*$/H,.5*$/q,1])}return K[2]=M,K[5]=u.x,K[8]=u.y,K},s.getImage=No,s.getJSON=function(u,o){return tr(Dt(u,{type:"json"}),o)},s.getLatitudinalLod=function(u){const o=Ds-5;u=it(u,-o,o)/o*90;const c=Math.pow(Math.abs(Math.sin(De(u))),3);return Math.round(c*(Pm.length-1))},s.getMapSessionAPI=ot,s.getPerformanceMeasurement=On,s.getProjection=tE,s.getRTLTextPluginStatus=Xe,s.getReferrer=ti,s.getTilePoint=function(u,{x:o,y:c},f=0){return new J(((o-f)*u.scale-u.x)*Mi,(c*u.scale-u.y)*Mi)},s.getTileVec3=function(u,o,c=0){return Wd(((o.x-c)*u.scale-u.x)*Mi,(o.y*u.scale-u.y)*Mi,Xb(o.z,o.y))},s.getVideo=function(u,o){const c=d.document.createElement("video");c.muted=!0,c.onloadstart=function(){o(null,c)};for(let f=0;f<u.length;f++){const m=d.document.createElement("source");mo(u[f])||(c.crossOrigin="Anonymous"),m.src=u[f],c.appendChild(m)}return{cancel:()=>{}}},s.globeCenterToScreenPoint=function(u){const o=[0,0,0],c=_u(new Float64Array(16));return $f(c,u.pixelMatrix,u.globeMatrix),uo(o,o,c),new J(o[0],o[1])},s.globeDenormalizeECEF=A0,s.globeECEFOrigin=function(u,o){const c=[0,0,0];return uo(c,c,Xg(gh(o.canonical))),uo(c,c,u),c},s.globeMetersToEcef=qg,s.globeNormalizeECEF=Xg,s.globePixelsToTileUnits=function(u,o){return Mi/(512*Math.pow(2,u))*wy(gh(o))},s.globePoleMatrixForTile=function(u,o,c){const f=_u(new Float64Array(16)),m=(o/(1<<u)-.5)*Math.PI*2;return Ug(f,c.globeMatrix,m),Float32Array.from(f)},s.globeTileBounds=gh,s.globeTiltAtLngLat=Hb,s.globeToMercatorTransition=km,s.globeUseCustomAntiAliasing=function(u,o,c){const f=km(c.zoom),m=u.style.map._antialias,v=!!o.extStandardDerivatives,E=o.extStandardDerivativesForceOff||u.terrain&&u.terrain.exaggeration()>0;return f===0&&!m&&!E&&v},s.identity=_u,s.identity$1=sf,s.invert=yy,s.isFullscreen=function(){return!!d.document.fullscreenElement||!!d.document.webkitFullscreenElement},s.isLngLatBehindGlobe=M0,s.isMapAuthenticated=function(u){return Je.has(u)},s.isMapboxURL=go,s.isSafariWithAntialiasingBug=function(u){const o=u.navigator?u.navigator.userAgent:null;return!!Dr(u)&&o&&(o.match("Version/15.4")||o.match("Version/15.5")||o.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},s.latFromMercatorY=Fa,s.latLngToECEF=Nm,s.len=OI,s.length=Wu,s.length$1=function(u){return Math.hypot(u[0],u[1],u[2],u[3])},s.lngFromMercatorX=Zu,s.loadVectorTile=_C,s.makeRequest=tr,s.mapValue=function(u,o,c,f,m){return it((u-o)/(c-o)*(m-f)+f,f,m)},s.mercatorScale=Zb,s.mercatorXfromLng=lf,s.mercatorYfromLat=uf,s.mercatorZfromAltitude=yh,s.mul=Ob,s.mul$1=kb,s.multiply=$f,s.multiply$1=v0,s.multiply$2=Gg,s.nextPowerOfTwo=Mt,s.normalize=Bo,s.normalize$1=NI,s.normalize$2=Fb,s.number=Zi,s.ortho=function(u,o,c,f,m,v,E){var S=1/(o-c),M=1/(f-m),R=1/(v-E);return u[0]=-2*S,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*M,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*R,u[11]=0,u[12]=(o+c)*S,u[13]=(m+f)*M,u[14]=(E+v)*R,u[15]=1,u},s.pbf=Kd,s.perspective=function(u,o,c,f,m){var v,E=1/Math.tan(o/2);return u[0]=E/c,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=E,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,m!=null&&m!==1/0?(u[10]=(m+f)*(v=1/(f-m)),u[14]=2*m*f*v):(u[10]=-1,u[14]=-2*f),u},s.pick=function(u,o){const c={};for(let f=0;f<o.length;f++){const m=o[f];m in u&&(c[m]=u[m])}return c},s.plugin=Ke,s.pointGeometry=J,s.polesInViewport=function(u){const o=_u(new Float64Array(16));$f(o,u.pixelMatrix,u.globeMatrix);const c=[0,Xu,0],f=[0,Lc,0];return uo(c,c,o),uo(f,f,o),[c[0]>0&&c[0]<=u.width&&c[1]>0&&c[1]<=u.height&&!M0(u,new kr(u.center.lat,90)),f[0]>0&&f[0]<=u.width&&f[1]>0&&f[1]<=u.height&&!M0(u,new kr(u.center.lat,-90))]},s.polygonContainsPoint=Kp,s.polygonIntersectsBox=ex,s.polygonIntersectsPolygon=Kb,s.polygonizeBounds=function(u,o,c=0,f=!0){const m=new J(c,c),v=u.sub(m),E=o.add(m),S=[v,new J(E.x,v.y),E,new J(v.x,E.y)];return f&&S.push(v.clone()),S},s.posAttributes=ed,s.postMapLoadEvent=Ie,s.postPerformanceEvent=We,s.postTurnstileEvent=te,s.potpack=Xy,s.prevPowerOfTwo=function(u){return u<=1?1:Math.pow(2,Math.floor(Math.log(u)/Math.LN2))},s.radToDeg=fe,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.registerForPluginStateChange=function(u){return u({pluginStatus:xe,pluginURL:se}),Re.on("pluginStateChange",u),u},s.removeAuthState=function(u){Je.delete(u)},s.renderColorRamp=V0,s.resample=P0,s.rotateX=dh,s.rotateX$1=Tl,s.rotateY=Ug,s.rotateY$1=vy,s.rotateZ=function(u,o,c){var f=Math.sin(c),m=Math.cos(c),v=o[0],E=o[1],S=o[2],M=o[3],R=o[4],U=o[5],H=o[6],q=o[7];return o!==u&&(u[8]=o[8],u[9]=o[9],u[10]=o[10],u[11]=o[11],u[12]=o[12],u[13]=o[13],u[14]=o[14],u[15]=o[15]),u[0]=v*m+R*f,u[1]=E*m+U*f,u[2]=S*m+H*f,u[3]=M*m+q*f,u[4]=R*m-v*f,u[5]=U*m-E*f,u[6]=H*m-S*f,u[7]=q*m-M*f,u},s.rotateZ$1=function(u,o,c){c*=.5;var f=o[0],m=o[1],v=o[2],E=o[3],S=Math.sin(c),M=Math.cos(c);return u[0]=f*M+m*S,u[1]=m*M-f*S,u[2]=v*M+E*S,u[3]=E*M-v*S,u},s.scale=qd,s.scale$1=E0,s.scale$2=Il,s.scaleAndAdd=qp,s.set=function(u,o,c,f){return u[0]=o,u[1]=c,u[2]=f,u},s.setCacheLimits=function(u,o){kn=u,Ei=o},s.setColumn=function(u,o,c){u[4*o+0]=c[0],u[4*o+1]=c[1],u[4*o+2]=c[2],u[4*o+3]=c[3]},s.setRTLTextPlugin=function(u,o,c=!1){if(xe===ce||xe===ye||xe===_e)throw new Error("setRTLTextPlugin cannot be called multiple times.");se=xr.resolveURL(u),xe=ce,ve=o,Ae(),c||je()},s.smoothstep=Et,s.spec=Rt,s.squaredLength=function(u){var o=u[0],c=u[1],f=u[2];return o*o+c*c+f*f},s.storeAuthState=function(u,o){o?Je.add(u):Je.delete(u)},s.sub=mh,s.subtract=Vg,s.symbolSize=Sx,s.tileAABB=function(u,o,c,f,m,v,E,S,M){if(M.name==="globe")return Zp(u,o,new qy(c,f,m));const R=$p({z:c,x:f,y:m},M);return new wl([(v+R.x/R.scale)*o,o*(R.y/R.scale),E],[(v+R.x2/R.scale)*o,o*(R.y2/R.scale),S])},s.tileCornersToBounds=Iy,s.tileTransform=$p,s.transformMat3=function(u,o,c){var f=o[0],m=o[1],v=o[2];return u[0]=f*c[0]+m*c[3]+v*c[6],u[1]=f*c[1]+m*c[4]+v*c[7],u[2]=f*c[2]+m*c[5]+v*c[8],u},s.transformMat4=uo,s.transformMat4$1=Wp,s.transformQuat=ll,s.transitionTileAABBinECEF=C0,s.translate=zg,s.transpose=function(u,o){if(u===o){var c=o[1],f=o[2],m=o[5];u[1]=o[3],u[2]=o[6],u[3]=c,u[5]=o[7],u[6]=f,u[7]=m}else u[0]=o[0],u[1]=o[3],u[2]=o[6],u[3]=o[1],u[4]=o[4],u[5]=o[7],u[6]=o[2],u[7]=o[5],u[8]=o[8];return u},s.triggerPluginCompletionEvent=Le,s.uniqueId=Cn,s.updateGlobeVertexNormal=function(u,o,c,f,m){const v=5*o+2;u.float32[v+0]=c,u.float32[v+1]=f,u.float32[v+2]=m},s.validateCustomStyleLayer=function(u){const o=[],c=u.id;return c===void 0&&o.push({message:`layers.${c}: missing required property "id"`}),u.render===void 0&&o.push({message:`layers.${c}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&o.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),o},s.validateFilter=u=>oh(kd(u)),s.validateFog=u=>oh(Bp(u)),s.validateLayer=u=>oh(Mg(u)),s.validateLight=u=>oh(ge(u)),s.validateSource=u=>oh(sh(u)),s.validateStyle=$_,s.validateTerrain=u=>oh(Qh(u)),s.values=ke,s.vectorTile=Uy,s.version=g,s.warnOnce=Zn,s.window=d,s.wrap=Ue}),a(["./shared"],function(s){function d(we){if(typeof we=="number"||typeof we=="boolean"||typeof we=="string"||we==null)return JSON.stringify(we);if(Array.isArray(we)){let re="[";for(const Ie of we)re+=`${d(Ie)},`;return`${re}]`}let te="{";for(const re of Object.keys(we).sort())te+=`${re}:${d(we[re])},`;return`${te}}`}function g(we){let te="";for(const re of s.refProperties)te+=`/${d(we[re])}`;return te}class x{constructor(te){this.keyCache={},te&&this.replace(te)}replace(te){this._layerConfigs={},this._layers={},this.update(te,[])}update(te,re){for(const Oe of te)this._layerConfigs[Oe.id]=Oe,(this._layers[Oe.id]=s.createStyleLayer(Oe)).compileFilter(),this.keyCache[Oe.id]&&delete this.keyCache[Oe.id];for(const Oe of re)delete this.keyCache[Oe],delete this._layerConfigs[Oe],delete this._layers[Oe];this.familiesBySource={};const Ie=function(Oe,We){const ut={};for(let Je=0;Je<Oe.length;Je++){const pe=We&&We[Oe[Je].id]||g(Oe[Je]);We&&(We[Oe[Je].id]=pe);let nt=ut[pe];nt||(nt=ut[pe]=[]),nt.push(Oe[Je])}const ot=[];for(const Je in ut)ot.push(ut[Je]);return ot}(s.values(this._layerConfigs),this.keyCache);for(const Oe of Ie){const We=Oe.map(be=>this._layers[be.id]),ut=We[0];if(ut.visibility==="none")continue;const ot=ut.source||"";let Je=this.familiesBySource[ot];Je||(Je=this.familiesBySource[ot]={});const pe=ut.sourceLayer||"_geojsonTileLayer";let nt=Je[pe];nt||(nt=Je[pe]=[]),nt.push(We)}}}class I{loadTile(te,re){const{uid:Ie,encoding:Oe,rawImageData:We,padding:ut,buildQuadTree:ot}=te,Je=s.window.ImageBitmap&&We instanceof s.window.ImageBitmap?this.getImageData(We,ut):We;re(null,new s.DEMData(Ie,Je,Oe,ut<1,ot))}getImageData(te,re){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(te.width,te.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=te.width,this.offscreenCanvas.height=te.height,this.offscreenCanvasContext.drawImage(te,0,0,te.width,te.height);const Ie=this.offscreenCanvasContext.getImageData(-re,-re,te.width+2*re,te.height+2*re);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Ie}}var A=function we(te,re){var Ie,Oe=te&&te.type;if(Oe==="FeatureCollection")for(Ie=0;Ie<te.features.length;Ie++)we(te.features[Ie],re);else if(Oe==="GeometryCollection")for(Ie=0;Ie<te.geometries.length;Ie++)we(te.geometries[Ie],re);else if(Oe==="Feature")we(te.geometry,re);else if(Oe==="Polygon")L(te.coordinates,re);else if(Oe==="MultiPolygon")for(Ie=0;Ie<te.coordinates.length;Ie++)L(te.coordinates[Ie],re);return te};function L(we,te){if(we.length!==0){N(we[0],te);for(var re=1;re<we.length;re++)N(we[re],!te)}}function N(we,te){for(var re=0,Ie=0,Oe=0,We=we.length,ut=We-1;Oe<We;ut=Oe++){var ot=(we[Oe][0]-we[ut][0])*(we[ut][1]+we[Oe][1]),Je=re+ot;Ie+=Math.abs(re)>=Math.abs(ot)?re-Je+ot:ot-Je+re,re=Je}re+Ie>=0!=!!te&&we.reverse()}const B=s.VectorTileFeature.prototype.toGeoJSON;class F{constructor(te){this._feature=te,this.extent=s.EXTENT,this.type=te.type,this.properties=te.tags,"id"in te&&!isNaN(te.id)&&(this.id=parseInt(te.id,10))}loadGeometry(){if(this._feature.type===1){const te=[];for(const re of this._feature.geometry)te.push([new s.pointGeometry(re[0],re[1])]);return te}{const te=[];for(const re of this._feature.geometry){const Ie=[];for(const Oe of re)Ie.push(new s.pointGeometry(Oe[0],Oe[1]));te.push(Ie)}return te}}toGeoJSON(te,re,Ie){return B.call(this,te,re,Ie)}}class z{constructor(te){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=te.length,this._features=te}feature(te){return new F(this._features[te])}}var V={},Y={get exports(){return V},set exports(we){V=we}},Q=s.pointGeometry,J=s.vectorTile.VectorTileFeature,he=ee;function ee(we,te){this.options=te||{},this.features=we,this.length=we.length}function ae(we,te){this.id=typeof we.id=="number"?we.id:void 0,this.type=we.type,this.rawGeometry=we.type===1?[we.geometry]:we.geometry,this.properties=we.tags,this.extent=te||4096}ee.prototype.feature=function(we){return new ae(this.features[we],this.options.extent)},ae.prototype.loadGeometry=function(){var we=this.rawGeometry;this.geometry=[];for(var te=0;te<we.length;te++){for(var re=we[te],Ie=[],Oe=0;Oe<re.length;Oe++)Ie.push(new Q(re[Oe][0],re[Oe][1]));this.geometry.push(Ie)}return this.geometry},ae.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var we=this.geometry,te=1/0,re=-1/0,Ie=1/0,Oe=-1/0,We=0;We<we.length;We++)for(var ut=we[We],ot=0;ot<ut.length;ot++){var Je=ut[ot];te=Math.min(te,Je.x),re=Math.max(re,Je.x),Ie=Math.min(Ie,Je.y),Oe=Math.max(Oe,Je.y)}return[te,Ie,re,Oe]},ae.prototype.toGeoJSON=J.prototype.toGeoJSON;var De=s.pbf,fe=he;function le(we){var te=new De;return function(re,Ie){for(var Oe in re.layers)Ie.writeMessage(3,Be,re.layers[Oe])}(we,te),te.finish()}function Be(we,te){var re;te.writeVarintField(15,we.version||1),te.writeStringField(1,we.name||""),te.writeVarintField(5,we.extent||4096);var Ie={keys:[],values:[],keycache:{},valuecache:{}};for(re=0;re<we.length;re++)Ie.feature=we.feature(re),te.writeMessage(2,Pe,Ie);var Oe=Ie.keys;for(re=0;re<Oe.length;re++)te.writeStringField(3,Oe[re]);var We=Ie.values;for(re=0;re<We.length;re++)te.writeMessage(4,at,We[re])}function Pe(we,te){var re=we.feature;re.id!==void 0&&te.writeVarintField(1,re.id),te.writeMessage(2,Ce,we),te.writeVarintField(3,re.type),te.writeMessage(4,Ue,re)}function Ce(we,te){var re=we.feature,Ie=we.keys,Oe=we.values,We=we.keycache,ut=we.valuecache;for(var ot in re.properties){var Je=re.properties[ot],pe=We[ot];if(Je!==null){pe===void 0&&(Ie.push(ot),We[ot]=pe=Ie.length-1),te.writeVarint(pe);var nt=typeof Je;nt!=="string"&&nt!=="boolean"&&nt!=="number"&&(Je=JSON.stringify(Je));var be=nt+":"+Je,Ot=ut[be];Ot===void 0&&(Oe.push(Je),ut[be]=Ot=Oe.length-1),te.writeVarint(Ot)}}}function it(we,te){return(te<<3)+(7&we)}function Et(we){return we<<1^we>>31}function Ue(we,te){for(var re=we.loadGeometry(),Ie=we.type,Oe=0,We=0,ut=re.length,ot=0;ot<ut;ot++){var Je=re[ot],pe=1;Ie===1&&(pe=Je.length),te.writeVarint(it(1,pe));for(var nt=Ie===3?Je.length-1:Je.length,be=0;be<nt;be++){be===1&&Ie!==1&&te.writeVarint(it(2,nt-1));var Ot=Je[be].x-Oe,On=Je[be].y-We;te.writeVarint(Et(Ot)),te.writeVarint(Et(On)),Oe+=Ot,We+=On}Ie===3&&te.writeVarint(it(7,1))}}function at(we,te){var re=typeof we;re==="string"?te.writeStringField(1,we):re==="boolean"?te.writeBooleanField(7,we):re==="number"&&(we%1!=0?te.writeDoubleField(3,we):we<0?te.writeSVarintField(6,we):te.writeVarintField(5,we))}function ke(we,te,re,Ie,Oe,We){if(Oe-Ie<=re)return;const ut=Ie+Oe>>1;Dt(we,te,ut,Ie,Oe,We%2),ke(we,te,re,Ie,ut-1,We+1),ke(we,te,re,ut+1,Oe,We+1)}function Dt(we,te,re,Ie,Oe,We){for(;Oe>Ie;){if(Oe-Ie>600){const pe=Oe-Ie+1,nt=re-Ie+1,be=Math.log(pe),Ot=.5*Math.exp(2*be/3),On=.5*Math.sqrt(be*Ot*(pe-Ot)/pe)*(nt-pe/2<0?-1:1);Dt(we,te,re,Math.max(Ie,Math.floor(re-nt*Ot/pe+On)),Math.min(Oe,Math.floor(re+(pe-nt)*Ot/pe+On)),We)}const ut=te[2*re+We];let ot=Ie,Je=Oe;for(fn(we,te,Ie,re),te[2*Oe+We]>ut&&fn(we,te,Ie,Oe);ot<Je;){for(fn(we,te,ot,Je),ot++,Je--;te[2*ot+We]<ut;)ot++;for(;te[2*Je+We]>ut;)Je--}te[2*Ie+We]===ut?fn(we,te,Ie,Je):(Je++,fn(we,te,Je,Oe)),Je<=re&&(Ie=Je+1),re<=Je&&(Oe=Je-1)}}function fn(we,te,re,Ie){Cn(we,re,Ie),Cn(te,2*re,2*Ie),Cn(te,2*re+1,2*Ie+1)}function Cn(we,te,re){const Ie=we[te];we[te]=we[re],we[re]=Ie}function Gt(we,te,re,Ie){const Oe=we-re,We=te-Ie;return Oe*Oe+We*We}Y.exports=le,V.fromVectorTileJs=le,V.fromGeojsonVt=function(we,te){te=te||{};var re={};for(var Ie in we)re[Ie]=new fe(we[Ie].features,te),re[Ie].name=Ie,re[Ie].version=te.version,re[Ie].extent=te.extent;return le({layers:re})},V.GeoJSONWrapper=fe;const Mt=we=>we[0],vt=we=>we[1];class xn{constructor(te,re=Mt,Ie=vt,Oe=64,We=Float64Array){this.nodeSize=Oe,this.points=te;const ut=te.length<65536?Uint16Array:Uint32Array,ot=this.ids=new ut(te.length),Je=this.coords=new We(2*te.length);for(let pe=0;pe<te.length;pe++)ot[pe]=pe,Je[2*pe]=re(te[pe]),Je[2*pe+1]=Ie(te[pe]);ke(ot,Je,Oe,0,ot.length-1,0)}range(te,re,Ie,Oe){return function(We,ut,ot,Je,pe,nt,be){const Ot=[0,We.length-1,0],On=[];let ii,ei;for(;Ot.length;){const Ye=Ot.pop(),Qn=Ot.pop(),xr=Ot.pop();if(Qn-xr<=be){for(let yr=xr;yr<=Qn;yr++)ii=ut[2*yr],ei=ut[2*yr+1],ii>=ot&&ii<=pe&&ei>=Je&&ei<=nt&&On.push(We[yr]);continue}const Ti=Math.floor((xr+Qn)/2);ii=ut[2*Ti],ei=ut[2*Ti+1],ii>=ot&&ii<=pe&&ei>=Je&&ei<=nt&&On.push(We[Ti]);const mr=(Ye+1)%2;(Ye===0?ot<=ii:Je<=ei)&&(Ot.push(xr),Ot.push(Ti-1),Ot.push(mr)),(Ye===0?pe>=ii:nt>=ei)&&(Ot.push(Ti+1),Ot.push(Qn),Ot.push(mr))}return On}(this.ids,this.coords,te,re,Ie,Oe,this.nodeSize)}within(te,re,Ie){return function(Oe,We,ut,ot,Je,pe){const nt=[0,Oe.length-1,0],be=[],Ot=Je*Je;for(;nt.length;){const On=nt.pop(),ii=nt.pop(),ei=nt.pop();if(ii-ei<=pe){for(let mr=ei;mr<=ii;mr++)Gt(We[2*mr],We[2*mr+1],ut,ot)<=Ot&&be.push(Oe[mr]);continue}const Ye=Math.floor((ei+ii)/2),Qn=We[2*Ye],xr=We[2*Ye+1];Gt(Qn,xr,ut,ot)<=Ot&&be.push(Oe[Ye]);const Ti=(On+1)%2;(On===0?ut-Je<=Qn:ot-Je<=xr)&&(nt.push(ei),nt.push(Ye-1),nt.push(Ti)),(On===0?ut+Je>=Qn:ot+Je>=xr)&&(nt.push(Ye+1),nt.push(ii),nt.push(Ti))}return be}(this.ids,this.coords,te,re,Ie,this.nodeSize)}}const En={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:we=>we},_t=Math.fround||(kt=new Float32Array(1),we=>(kt[0]=+we,kt[0]));var kt;class Ct{constructor(te){this.options=Dr(Object.create(En),te),this.trees=new Array(this.options.maxZoom+1)}load(te){const{log:re,minZoom:Ie,maxZoom:Oe,nodeSize:We}=this.options;re&&console.time("total time");const ut=`prepare ${te.length} points`;re&&console.time(ut),this.points=te;let ot=[];for(let Je=0;Je<te.length;Je++)te[Je].geometry&&ot.push(Zn(te[Je],Je));this.trees[Oe+1]=new xn(ot,Ur,He,We,Float32Array),re&&console.timeEnd(ut);for(let Je=Oe;Je>=Ie;Je--){const pe=+Date.now();ot=this._cluster(ot,Je),this.trees[Je]=new xn(ot,Ur,He,We,Float32Array),re&&console.log("z%d: %d clusters in %dms",Je,ot.length,+Date.now()-pe)}return re&&console.timeEnd("total time"),this}getClusters(te,re){let Ie=((te[0]+180)%360+360)%360-180;const Oe=Math.max(-90,Math.min(90,te[1]));let We=te[2]===180?180:((te[2]+180)%360+360)%360-180;const ut=Math.max(-90,Math.min(90,te[3]));if(te[2]-te[0]>=360)Ie=-180,We=180;else if(Ie>We){const nt=this.getClusters([Ie,Oe,180,ut],re),be=this.getClusters([-180,Oe,We,ut],re);return nt.concat(be)}const ot=this.trees[this._limitZoom(re)],Je=ot.range(Pt(Ie),Yn(ut),Pt(We),Yn(Oe)),pe=[];for(const nt of Je){const be=ot.points[nt];pe.push(be.numPoints?mi(be):this.points[be.index])}return pe}getChildren(te){const re=this._getOriginId(te),Ie=this._getOriginZoom(te),Oe="No cluster with the specified id.",We=this.trees[Ie];if(!We)throw new Error(Oe);const ut=We.points[re];if(!ut)throw new Error(Oe);const ot=this.options.radius/(this.options.extent*Math.pow(2,Ie-1)),Je=We.within(ut.x,ut.y,ot),pe=[];for(const nt of Je){const be=We.points[nt];be.parentId===te&&pe.push(be.numPoints?mi(be):this.points[be.index])}if(pe.length===0)throw new Error(Oe);return pe}getLeaves(te,re,Ie){const Oe=[];return this._appendLeaves(Oe,te,re=re||10,Ie=Ie||0,0),Oe}getTile(te,re,Ie){const Oe=this.trees[this._limitZoom(te)],We=Math.pow(2,te),{extent:ut,radius:ot}=this.options,Je=ot/ut,pe=(Ie-Je)/We,nt=(Ie+1+Je)/We,be={features:[]};return this._addTileFeatures(Oe.range((re-Je)/We,pe,(re+1+Je)/We,nt),Oe.points,re,Ie,We,be),re===0&&this._addTileFeatures(Oe.range(1-Je/We,pe,1,nt),Oe.points,We,Ie,We,be),re===We-1&&this._addTileFeatures(Oe.range(0,pe,Je/We,nt),Oe.points,-1,Ie,We,be),be.features.length?be:null}getClusterExpansionZoom(te){let re=this._getOriginZoom(te)-1;for(;re<=this.options.maxZoom;){const Ie=this.getChildren(te);if(re++,Ie.length!==1)break;te=Ie[0].properties.cluster_id}return re}_appendLeaves(te,re,Ie,Oe,We){const ut=this.getChildren(re);for(const ot of ut){const Je=ot.properties;if(Je&&Je.cluster?We+Je.point_count<=Oe?We+=Je.point_count:We=this._appendLeaves(te,Je.cluster_id,Ie,Oe,We):We<Oe?We++:te.push(ot),te.length===Ie)break}return We}_addTileFeatures(te,re,Ie,Oe,We,ut){for(const ot of te){const Je=re[ot],pe=Je.numPoints;let nt,be,Ot;if(pe)nt=yn(Je),be=Je.x,Ot=Je.y;else{const ei=this.points[Je.index];nt=ei.properties,be=Pt(ei.geometry.coordinates[0]),Ot=Yn(ei.geometry.coordinates[1])}const On={type:1,geometry:[[Math.round(this.options.extent*(be*We-Ie)),Math.round(this.options.extent*(Ot*We-Oe))]],tags:nt};let ii;pe?ii=Je.id:this.options.generateId?ii=Je.index:this.points[Je.index].id&&(ii=this.points[Je.index].id),ii!==void 0&&(On.id=ii),ut.features.push(On)}}_limitZoom(te){return Math.max(this.options.minZoom,Math.min(Math.floor(+te),this.options.maxZoom+1))}_cluster(te,re){const Ie=[],{radius:Oe,extent:We,reduce:ut,minPoints:ot}=this.options,Je=Oe/(We*Math.pow(2,re));for(let pe=0;pe<te.length;pe++){const nt=te[pe];if(nt.zoom<=re)continue;nt.zoom=re;const be=this.trees[re+1],Ot=be.within(nt.x,nt.y,Je),On=nt.numPoints||1;let ii=On;for(const ei of Ot){const Ye=be.points[ei];Ye.zoom>re&&(ii+=Ye.numPoints||1)}if(ii>On&&ii>=ot){let ei=nt.x*On,Ye=nt.y*On,Qn=ut&&On>1?this._map(nt,!0):null;const xr=(pe<<5)+(re+1)+this.points.length;for(const Ti of Ot){const mr=be.points[Ti];if(mr.zoom<=re)continue;mr.zoom=re;const yr=mr.numPoints||1;ei+=mr.x*yr,Ye+=mr.y*yr,mr.parentId=xr,ut&&(Qn||(Qn=this._map(nt,!0)),ut(Qn,this._map(mr)))}nt.parentId=xr,Ie.push(Bt(ei/ii,Ye/ii,xr,ii,Qn))}else if(Ie.push(nt),ii>1)for(const ei of Ot){const Ye=be.points[ei];Ye.zoom<=re||(Ye.zoom=re,Ie.push(Ye))}}return Ie}_getOriginId(te){return te-this.points.length>>5}_getOriginZoom(te){return(te-this.points.length)%32}_map(te,re){if(te.numPoints)return re?Dr({},te.properties):te.properties;const Ie=this.points[te.index].properties,Oe=this.options.map(Ie);return re&&Oe===Ie?Dr({},Oe):Oe}}function Bt(we,te,re,Ie,Oe){return{x:_t(we),y:_t(te),zoom:1/0,id:re,parentId:-1,numPoints:Ie,properties:Oe}}function Zn(we,te){const[re,Ie]=we.geometry.coordinates;return{x:_t(Pt(re)),y:_t(Yn(Ie)),zoom:1/0,index:te,parentId:-1}}function mi(we){return{type:"Feature",id:we.id,properties:yn(we),geometry:{type:"Point",coordinates:[(te=we.x,360*(te-.5)),si(we.y)]}};var te}function yn(we){const te=we.numPoints,re=te>=1e4?`${Math.round(te/1e3)}k`:te>=1e3?Math.round(te/100)/10+"k":te;return Dr(Dr({},we.properties),{cluster:!0,cluster_id:we.id,point_count:te,point_count_abbreviated:re})}function Pt(we){return we/360+.5}function Yn(we){const te=Math.sin(we*Math.PI/180),re=.5-.25*Math.log((1+te)/(1-te))/Math.PI;return re<0?0:re>1?1:re}function si(we){const te=(180-360*we)*Math.PI/180;return 360*Math.atan(Math.exp(te))/Math.PI-90}function Dr(we,te){for(const re in te)we[re]=te[re];return we}function Ur(we){return we.x}function He(we){return we.y}function Jt(we,te,re,Ie){for(var Oe,We=Ie,ut=re-te>>1,ot=re-te,Je=we[te],pe=we[te+1],nt=we[re],be=we[re+1],Ot=te+3;Ot<re;Ot+=3){var On=ui(we[Ot],we[Ot+1],Je,pe,nt,be);if(On>We)Oe=Ot,We=On;else if(On===We){var ii=Math.abs(Ot-ut);ii<ot&&(Oe=Ot,ot=ii)}}We>Ie&&(Oe-te>3&&Jt(we,te,Oe,Ie),we[Oe+2]=We,re-Oe>3&&Jt(we,Oe,re,Ie))}function ui(we,te,re,Ie,Oe,We){var ut=Oe-re,ot=We-Ie;if(ut!==0||ot!==0){var Je=((we-re)*ut+(te-Ie)*ot)/(ut*ut+ot*ot);Je>1?(re=Oe,Ie=We):Je>0&&(re+=ut*Je,Ie+=ot*Je)}return(ut=we-re)*ut+(ot=te-Ie)*ot}function $e(we,te,re,Ie){var Oe={id:we===void 0?null:we,type:te,geometry:re,tags:Ie,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(We){var ut=We.geometry,ot=We.type;if(ot==="Point"||ot==="MultiPoint"||ot==="LineString")kn(We,ut);else if(ot==="Polygon"||ot==="MultiLineString")for(var Je=0;Je<ut.length;Je++)kn(We,ut[Je]);else if(ot==="MultiPolygon")for(Je=0;Je<ut.length;Je++)for(var pe=0;pe<ut[Je].length;pe++)kn(We,ut[Je][pe])}(Oe),Oe}function kn(we,te){for(var re=0;re<te.length;re+=3)we.minX=Math.min(we.minX,te[re]),we.minY=Math.min(we.minY,te[re+1]),we.maxX=Math.max(we.maxX,te[re]),we.maxY=Math.max(we.maxY,te[re+1])}function Ei(we,te,re,Ie){if(te.geometry){var Oe=te.geometry.coordinates,We=te.geometry.type,ut=Math.pow(re.tolerance/((1<<re.maxZoom)*re.extent),2),ot=[],Je=te.id;if(re.promoteId?Je=te.properties[re.promoteId]:re.generateId&&(Je=Ie||0),We==="Point")ni(Oe,ot);else if(We==="MultiPoint")for(var pe=0;pe<Oe.length;pe++)ni(Oe[pe],ot);else if(We==="LineString")Ln(Oe,ot,ut,!1);else if(We==="MultiLineString"){if(re.lineMetrics){for(pe=0;pe<Oe.length;pe++)Ln(Oe[pe],ot=[],ut,!1),we.push($e(Je,"LineString",ot,te.properties));return}ki(Oe,ot,ut,!1)}else if(We==="Polygon")ki(Oe,ot,ut,!0);else{if(We!=="MultiPolygon"){if(We==="GeometryCollection"){for(pe=0;pe<te.geometry.geometries.length;pe++)Ei(we,{id:Je,geometry:te.geometry.geometries[pe],properties:te.properties},re,Ie);return}throw new Error("Input data is not a valid GeoJSON object.")}for(pe=0;pe<Oe.length;pe++){var nt=[];ki(Oe[pe],nt,ut,!0),ot.push(nt)}}we.push($e(Je,We,ot,te.properties))}}function ni(we,te){te.push(Hs(we[0])),te.push(Xt(we[1])),te.push(0)}function Ln(we,te,re,Ie){for(var Oe,We,ut=0,ot=0;ot<we.length;ot++){var Je=Hs(we[ot][0]),pe=Xt(we[ot][1]);te.push(Je),te.push(pe),te.push(0),ot>0&&(ut+=Ie?(Oe*pe-Je*We)/2:Math.sqrt(Math.pow(Je-Oe,2)+Math.pow(pe-We,2))),Oe=Je,We=pe}var nt=te.length-3;te[2]=1,Jt(te,0,nt,re),te[nt+2]=1,te.size=Math.abs(ut),te.start=0,te.end=te.size}function ki(we,te,re,Ie){for(var Oe=0;Oe<we.length;Oe++){var We=[];Ln(we[Oe],We,re,Ie),te.push(We)}}function Hs(we){return we/360+.5}function Xt(we){var te=Math.sin(we*Math.PI/180),re=.5-.25*Math.log((1+te)/(1-te))/Math.PI;return re<0?0:re>1?1:re}function Rn(we,te,re,Ie,Oe,We,ut,ot){if(Ie/=te,We>=(re/=te)&&ut<Ie)return we;if(ut<re||We>=Ie)return null;for(var Je=[],pe=0;pe<we.length;pe++){var nt=we[pe],be=nt.geometry,Ot=nt.type,On=Oe===0?nt.minX:nt.minY,ii=Oe===0?nt.maxX:nt.maxY;if(On>=re&&ii<Ie)Je.push(nt);else if(!(ii<re||On>=Ie)){var ei=[];if(Ot==="Point"||Ot==="MultiPoint")ti(be,ei,re,Ie,Oe);else if(Ot==="LineString")tr(be,ei,re,Ie,Oe,!1,ot.lineMetrics);else if(Ot==="MultiLineString")mo(be,ei,re,Ie,Oe,!1);else if(Ot==="Polygon")mo(be,ei,re,Ie,Oe,!0);else if(Ot==="MultiPolygon")for(var Ye=0;Ye<be.length;Ye++){var Qn=[];mo(be[Ye],Qn,re,Ie,Oe,!0),Qn.length&&ei.push(Qn)}if(ei.length){if(ot.lineMetrics&&Ot==="LineString"){for(Ye=0;Ye<ei.length;Ye++)Je.push($e(nt.id,Ot,ei[Ye],nt.tags));continue}Ot!=="LineString"&&Ot!=="MultiLineString"||(ei.length===1?(Ot="LineString",ei=ei[0]):Ot="MultiLineString"),Ot!=="Point"&&Ot!=="MultiPoint"||(Ot=ei.length===3?"Point":"MultiPoint"),Je.push($e(nt.id,Ot,ei,nt.tags))}}}return Je.length?Je:null}function ti(we,te,re,Ie,Oe){for(var We=0;We<we.length;We+=3){var ut=we[We+Oe];ut>=re&&ut<=Ie&&(te.push(we[We]),te.push(we[We+1]),te.push(we[We+2]))}}function tr(we,te,re,Ie,Oe,We,ut){for(var ot,Je,pe=js(we),nt=Oe===0?Xo:qs,be=we.start,Ot=0;Ot<we.length-3;Ot+=3){var On=we[Ot],ii=we[Ot+1],ei=we[Ot+2],Ye=we[Ot+3],Qn=we[Ot+4],xr=Oe===0?On:ii,Ti=Oe===0?Ye:Qn,mr=!1;ut&&(ot=Math.sqrt(Math.pow(On-Ye,2)+Math.pow(ii-Qn,2))),xr<re?Ti>re&&(Je=nt(pe,On,ii,Ye,Qn,re),ut&&(pe.start=be+ot*Je)):xr>Ie?Ti<Ie&&(Je=nt(pe,On,ii,Ye,Qn,Ie),ut&&(pe.start=be+ot*Je)):ca(pe,On,ii,ei),Ti<re&&xr>=re&&(Je=nt(pe,On,ii,Ye,Qn,re),mr=!0),Ti>Ie&&xr<=Ie&&(Je=nt(pe,On,ii,Ye,Qn,Ie),mr=!0),!We&&mr&&(ut&&(pe.end=be+ot*Je),te.push(pe),pe=js(we)),ut&&(be+=ot)}var yr=we.length-3;On=we[yr],ii=we[yr+1],ei=we[yr+2],(xr=Oe===0?On:ii)>=re&&xr<=Ie&&ca(pe,On,ii,ei),yr=pe.length-3,We&&yr>=3&&(pe[yr]!==pe[0]||pe[yr+1]!==pe[1])&&ca(pe,pe[0],pe[1],pe[2]),pe.length&&te.push(pe)}function js(we){var te=[];return te.size=we.size,te.start=we.start,te.end=we.end,te}function mo(we,te,re,Ie,Oe,We){for(var ut=0;ut<we.length;ut++)tr(we[ut],te,re,Ie,Oe,We,!1)}function ca(we,te,re,Ie){we.push(te),we.push(re),we.push(Ie)}function Xo(we,te,re,Ie,Oe,We){var ut=(We-te)/(Ie-te);return we.push(We),we.push(re+(Oe-re)*ut),we.push(1),ut}function qs(we,te,re,Ie,Oe,We){var ut=(We-re)/(Oe-re);return we.push(te+(Ie-te)*ut),we.push(We),we.push(1),ut}function No(we,te){for(var re=[],Ie=0;Ie<we.length;Ie++){var Oe,We=we[Ie],ut=We.type;if(ut==="Point"||ut==="MultiPoint"||ut==="LineString")Oe=Ja(We.geometry,te);else if(ut==="MultiLineString"||ut==="Polygon"){Oe=[];for(var ot=0;ot<We.geometry.length;ot++)Oe.push(Ja(We.geometry[ot],te))}else if(ut==="MultiPolygon")for(Oe=[],ot=0;ot<We.geometry.length;ot++){for(var Je=[],pe=0;pe<We.geometry[ot].length;pe++)Je.push(Ja(We.geometry[ot][pe],te));Oe.push(Je)}re.push($e(We.id,ut,Oe,We.tags))}return re}function Ja(we,te){var re=[];re.size=we.size,we.start!==void 0&&(re.start=we.start,re.end=we.end);for(var Ie=0;Ie<we.length;Ie+=3)re.push(we[Ie]+te,we[Ie+1],we[Ie+2]);return re}function go(we,te){if(we.transformed)return we;var re,Ie,Oe,We=1<<we.z,ut=we.x,ot=we.y;for(re=0;re<we.features.length;re++){var Je=we.features[re],pe=Je.geometry,nt=Je.type;if(Je.geometry=[],nt===1)for(Ie=0;Ie<pe.length;Ie+=2)Je.geometry.push(Ma(pe[Ie],pe[Ie+1],te,We,ut,ot));else for(Ie=0;Ie<pe.length;Ie++){var be=[];for(Oe=0;Oe<pe[Ie].length;Oe+=2)be.push(Ma(pe[Ie][Oe],pe[Ie][Oe+1],te,We,ut,ot));Je.geometry.push(be)}}return we.transformed=!0,we}function Ma(we,te,re,Ie,Oe,We){return[Math.round(re*(we*Ie-Oe)),Math.round(re*(te*Ie-We))]}function Vl(we,te,re,Ie,Oe){for(var We=te===Oe.maxZoom?0:Oe.tolerance/((1<<te)*Oe.extent),ut={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:re,y:Ie,z:te,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ot=0;ot<we.length;ot++){ut.numFeatures++,Qa(ut,we[ot],We,Oe);var Je=we[ot].minX,pe=we[ot].minY,nt=we[ot].maxX,be=we[ot].maxY;Je<ut.minX&&(ut.minX=Je),pe<ut.minY&&(ut.minY=pe),nt>ut.maxX&&(ut.maxX=nt),be>ut.maxY&&(ut.maxY=be)}return ut}function Qa(we,te,re,Ie){var Oe=te.geometry,We=te.type,ut=[];if(We==="Point"||We==="MultiPoint")for(var ot=0;ot<Oe.length;ot+=3)ut.push(Oe[ot]),ut.push(Oe[ot+1]),we.numPoints++,we.numSimplified++;else if(We==="LineString")ha(ut,Oe,we,re,!1,!1);else if(We==="MultiLineString"||We==="Polygon")for(ot=0;ot<Oe.length;ot++)ha(ut,Oe[ot],we,re,We==="Polygon",ot===0);else if(We==="MultiPolygon")for(var Je=0;Je<Oe.length;Je++){var pe=Oe[Je];for(ot=0;ot<pe.length;ot++)ha(ut,pe[ot],we,re,!0,ot===0)}if(ut.length){var nt=te.tags||null;if(We==="LineString"&&Ie.lineMetrics){for(var be in nt={},te.tags)nt[be]=te.tags[be];nt.mapbox_clip_start=Oe.start/Oe.size,nt.mapbox_clip_end=Oe.end/Oe.size}var Ot={geometry:ut,type:We==="Polygon"||We==="MultiPolygon"?3:We==="LineString"||We==="MultiLineString"?2:1,tags:nt};te.id!==null&&(Ot.id=te.id),we.features.push(Ot)}}function ha(we,te,re,Ie,Oe,We){var ut=Ie*Ie;if(Ie>0&&te.size<(Oe?ut:Ie))re.numPoints+=te.length/3;else{for(var ot=[],Je=0;Je<te.length;Je+=3)(Ie===0||te[Je+2]>ut)&&(re.numSimplified++,ot.push(te[Je]),ot.push(te[Je+1])),re.numPoints++;Oe&&function(pe,nt){for(var be=0,Ot=0,On=pe.length,ii=On-2;Ot<On;ii=Ot,Ot+=2)be+=(pe[Ot]-pe[ii])*(pe[Ot+1]+pe[ii+1]);if(be>0===nt)for(Ot=0,On=pe.length;Ot<On/2;Ot+=2){var ei=pe[Ot],Ye=pe[Ot+1];pe[Ot]=pe[On-2-Ot],pe[Ot+1]=pe[On-1-Ot],pe[On-2-Ot]=ei,pe[On-1-Ot]=Ye}}(ot,We),we.push(ot)}}function $a(we,te){var re=(te=this.options=function(Oe,We){for(var ut in We)Oe[ut]=We[ut];return Oe}(Object.create(this.options),te)).debug;if(re&&console.time("preprocess data"),te.maxZoom<0||te.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(te.promoteId&&te.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ie=function(Oe,We){var ut=[];if(Oe.type==="FeatureCollection")for(var ot=0;ot<Oe.features.length;ot++)Ei(ut,Oe.features[ot],We,ot);else Ei(ut,Oe.type==="Feature"?Oe:{geometry:Oe},We);return ut}(we,te);this.tiles={},this.tileCoords=[],re&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",te.indexMaxZoom,te.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ie=function(Oe,We){var ut=We.buffer/We.extent,ot=Oe,Je=Rn(Oe,1,-1-ut,ut,0,-1,2,We),pe=Rn(Oe,1,1-ut,2+ut,0,-1,2,We);return(Je||pe)&&(ot=Rn(Oe,1,-ut,1+ut,0,-1,2,We)||[],Je&&(ot=No(Je,1).concat(ot)),pe&&(ot=ot.concat(No(pe,-1)))),ot}(Ie,te),Ie.length&&this.splitTile(Ie,0,0,0),re&&(Ie.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Zs(we,te,re){return 32*((1<<we)*re+te)+we}function La(we,te){const re=we.tileID.canonical;if(!this._geoJSONIndex)return te(null,null);const Ie=this._geoJSONIndex.getTile(re.z,re.x,re.y);if(!Ie)return te(null,null);const Oe=new z(Ie.features);let We=V(Oe);We.byteOffset===0&&We.byteLength===We.buffer.byteLength||(We=new Uint8Array(We)),te(null,{vectorTile:Oe,rawData:We.buffer})}$a.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},$a.prototype.splitTile=function(we,te,re,Ie,Oe,We,ut){for(var ot=[we,te,re,Ie],Je=this.options,pe=Je.debug;ot.length;){Ie=ot.pop(),re=ot.pop(),te=ot.pop(),we=ot.pop();var nt=1<<te,be=Zs(te,re,Ie),Ot=this.tiles[be];if(!Ot&&(pe>1&&console.time("creation"),Ot=this.tiles[be]=Vl(we,te,re,Ie,Je),this.tileCoords.push({z:te,x:re,y:Ie}),pe)){pe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",te,re,Ie,Ot.numFeatures,Ot.numPoints,Ot.numSimplified),console.timeEnd("creation"));var On="z"+te;this.stats[On]=(this.stats[On]||0)+1,this.total++}if(Ot.source=we,Oe){if(te===Je.maxZoom||te===Oe)continue;var ii=1<<Oe-te;if(re!==Math.floor(We/ii)||Ie!==Math.floor(ut/ii))continue}else if(te===Je.indexMaxZoom||Ot.numPoints<=Je.indexMaxPoints)continue;if(Ot.source=null,we.length!==0){pe>1&&console.time("clipping");var ei,Ye,Qn,xr,Ti,mr,yr=.5*Je.buffer/Je.extent,Gl=.5-yr,fa=.5+yr,Rt=1+yr;ei=Ye=Qn=xr=null,Ti=Rn(we,nt,re-yr,re+fa,0,Ot.minX,Ot.maxX,Je),mr=Rn(we,nt,re+Gl,re+Rt,0,Ot.minX,Ot.maxX,Je),we=null,Ti&&(ei=Rn(Ti,nt,Ie-yr,Ie+fa,1,Ot.minY,Ot.maxY,Je),Ye=Rn(Ti,nt,Ie+Gl,Ie+Rt,1,Ot.minY,Ot.maxY,Je),Ti=null),mr&&(Qn=Rn(mr,nt,Ie-yr,Ie+fa,1,Ot.minY,Ot.maxY,Je),xr=Rn(mr,nt,Ie+Gl,Ie+Rt,1,Ot.minY,Ot.maxY,Je),mr=null),pe>1&&console.timeEnd("clipping"),ot.push(ei||[],te+1,2*re,2*Ie),ot.push(Ye||[],te+1,2*re,2*Ie+1),ot.push(Qn||[],te+1,2*re+1,2*Ie),ot.push(xr||[],te+1,2*re+1,2*Ie+1)}}},$a.prototype.getTile=function(we,te,re){var Ie=this.options,Oe=Ie.extent,We=Ie.debug;if(we<0||we>24)return null;var ut=1<<we,ot=Zs(we,te=(te%ut+ut)%ut,re);if(this.tiles[ot])return go(this.tiles[ot],Oe);We>1&&console.log("drilling down to z%d-%d-%d",we,te,re);for(var Je,pe=we,nt=te,be=re;!Je&&pe>0;)pe--,nt=Math.floor(nt/2),be=Math.floor(be/2),Je=this.tiles[Zs(pe,nt,be)];return Je&&Je.source?(We>1&&console.log("found parent tile z%d-%d-%d",pe,nt,be),We>1&&console.time("drilling down"),this.splitTile(Je.source,pe,nt,be,we,te,re),We>1&&console.timeEnd("drilling down"),this.tiles[ot]?go(this.tiles[ot],Oe):null):null};class so extends s.VectorTileWorkerSource{constructor(te,re,Ie,Oe,We){super(te,re,Ie,Oe,La),We&&(this.loadGeoJSON=We)}loadData(te,re){const Ie=te&&te.request,Oe=Ie&&Ie.collectResourceTiming;this.loadGeoJSON(te,(We,ut)=>{if(We||!ut)return re(We);if(typeof ut!="object")return re(new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`));{A(ut,!0);try{if(te.filter){const Je=s.createExpression(te.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Je.result==="error")throw new Error(Je.value.map(nt=>`${nt.key}: ${nt.message}`).join(", "));ut={type:"FeatureCollection",features:ut.features.filter(nt=>Je.value.evaluate({zoom:0},nt))}}this._geoJSONIndex=te.cluster?new Ct(function({superclusterOptions:Je,clusterProperties:pe}){if(!pe||!Je)return Je;const nt={},be={},Ot={accumulated:null,zoom:0},On={properties:null},ii=Object.keys(pe);for(const ei of ii){const[Ye,Qn]=pe[ei],xr=s.createExpression(Qn),Ti=s.createExpression(typeof Ye=="string"?[Ye,["accumulated"],["get",ei]]:Ye);nt[ei]=xr.value,be[ei]=Ti.value}return Je.map=ei=>{On.properties=ei;const Ye={};for(const Qn of ii)Ye[Qn]=nt[Qn].evaluate(Ot,On);return Ye},Je.reduce=(ei,Ye)=>{On.properties=Ye;for(const Qn of ii)Ot.accumulated=ei[Qn],ei[Qn]=be[Qn].evaluate(Ot,On)},Je}(te)).load(ut.features):function(Je,pe){return new $a(Je,pe)}(ut,te.geojsonVtOptions)}catch(Je){return re(Je)}this.loaded={};const ot={};if(Oe){const Je=s.getPerformanceMeasurement(Ie);Je&&(ot.resourceTiming={},ot.resourceTiming[te.source]=JSON.parse(JSON.stringify(Je)))}re(null,ot)}})}reloadTile(te,re){const Ie=this.loaded;return Ie&&Ie[te.uid]?super.reloadTile(te,re):this.loadTile(te,re)}loadGeoJSON(te,re){if(te.request)s.getJSON(te.request,re);else{if(typeof te.data!="string")return re(new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`));try{return re(null,JSON.parse(te.data))}catch{return re(new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(te,re){try{re(null,this._geoJSONIndex.getClusterExpansionZoom(te.clusterId))}catch(Ie){re(Ie)}}getClusterChildren(te,re){try{re(null,this._geoJSONIndex.getChildren(te.clusterId))}catch(Ie){re(Ie)}}getClusterLeaves(te,re){try{re(null,this._geoJSONIndex.getLeaves(te.clusterId,te.limit,te.offset))}catch(Ie){re(Ie)}}}class Ra{constructor(te){this.self=te,this.actor=new s.Actor(te,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=s.getProjection({name:"mercator"}),this.workerSourceTypes={vector:s.VectorTileWorkerSource,geojson:so},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(re,Ie)=>{if(this.workerSourceTypes[re])throw new Error(`Worker source with name "${re}" already registered.`);this.workerSourceTypes[re]=Ie},this.self.registerRTLTextPlugin=re=>{if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=re.applyArabicShaping,s.plugin.processBidirectionalText=re.processBidirectionalText,s.plugin.processStyledBidirectionalText=re.processStyledBidirectionalText}}clearCaches(te,re,Ie){delete this.layerIndexes[te],delete this.availableImages[te],delete this.workerSources[te],delete this.demWorkerSources[te],Ie()}checkIfReady(te,re,Ie){Ie()}setReferrer(te,re){this.referrer=re}spriteLoaded(te,re){this.isSpriteLoaded[te]=re;for(const Ie in this.workerSources[te]){const Oe=this.workerSources[te][Ie];for(const We in Oe)Oe[We]instanceof s.VectorTileWorkerSource&&(Oe[We].isSpriteLoaded=re,Oe[We].fire(new s.Event("isSpriteLoaded")))}}setImages(te,re,Ie){this.availableImages[te]=re;for(const Oe in this.workerSources[te]){const We=this.workerSources[te][Oe];for(const ut in We)We[ut].availableImages=re}Ie()}enableTerrain(te,re,Ie){this.terrain=re,Ie()}setProjection(te,re){this.projections[te]=s.getProjection(re)}setLayers(te,re,Ie){this.getLayerIndex(te).replace(re),Ie()}updateLayers(te,re,Ie){this.getLayerIndex(te).update(re.layers,re.removedIds),Ie()}loadTile(te,re,Ie){const Oe=this.enableTerrain?s.extend({enableTerrain:this.terrain},re):re;Oe.projection=this.projections[te]||this.defaultProjection,this.getWorkerSource(te,re.type,re.source).loadTile(Oe,Ie)}loadDEMTile(te,re,Ie){const Oe=this.enableTerrain?s.extend({buildQuadTree:this.terrain},re):re;this.getDEMWorkerSource(te,re.source).loadTile(Oe,Ie)}reloadTile(te,re,Ie){const Oe=this.enableTerrain?s.extend({enableTerrain:this.terrain},re):re;Oe.projection=this.projections[te]||this.defaultProjection,this.getWorkerSource(te,re.type,re.source).reloadTile(Oe,Ie)}abortTile(te,re,Ie){this.getWorkerSource(te,re.type,re.source).abortTile(re,Ie)}removeTile(te,re,Ie){this.getWorkerSource(te,re.type,re.source).removeTile(re,Ie)}removeSource(te,re,Ie){if(!this.workerSources[te]||!this.workerSources[te][re.type]||!this.workerSources[te][re.type][re.source])return;const Oe=this.workerSources[te][re.type][re.source];delete this.workerSources[te][re.type][re.source],Oe.removeSource!==void 0?Oe.removeSource(re,Ie):Ie()}loadWorkerSource(te,re,Ie){try{this.self.importScripts(re.url),Ie()}catch(Oe){Ie(Oe.toString())}}syncRTLPluginState(te,re,Ie){try{s.plugin.setState(re);const Oe=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&Oe!=null){this.self.importScripts(Oe);const We=s.plugin.isParsed();Ie(We?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Oe}`),We)}}catch(Oe){Ie(Oe.toString())}}getAvailableImages(te){let re=this.availableImages[te];return re||(re=[]),re}getLayerIndex(te){let re=this.layerIndexes[te];return re||(re=this.layerIndexes[te]=new x),re}getWorkerSource(te,re,Ie){if(this.workerSources[te]||(this.workerSources[te]={}),this.workerSources[te][re]||(this.workerSources[te][re]={}),!this.workerSources[te][re][Ie]){const Oe={send:(We,ut,ot,Je,pe,nt)=>{this.actor.send(We,ut,ot,te,pe,nt)},scheduler:this.actor.scheduler};this.workerSources[te][re][Ie]=new this.workerSourceTypes[re](Oe,this.getLayerIndex(te),this.getAvailableImages(te),this.isSpriteLoaded[te])}return this.workerSources[te][re][Ie]}getDEMWorkerSource(te,re){return this.demWorkerSources[te]||(this.demWorkerSources[te]={}),this.demWorkerSources[te][re]||(this.demWorkerSources[te][re]=new I),this.demWorkerSources[te][re]}enforceCacheSizeLimit(te,re){s.enforceCacheSizeLimit(re)}getWorkerPerformanceMetrics(te,re,Ie){Ie(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Ra(self)),Ra}),a(["./shared"],function(s){function d(y,h){if(Array.isArray(y)){if(!Array.isArray(h)||y.length!==h.length)return!1;for(let p=0;p<y.length;p++)if(!d(y[p],h[p]))return!1;return!0}if(typeof y=="object"&&y!==null&&h!==null){if(typeof h!="object"||Object.keys(y).length!==Object.keys(h).length)return!1;for(const p in y)if(!d(y[p],h[p]))return!1;return!0}return y===h}var g=x;function x(y){return!function(h){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var b,w,C=new Blob([""],{type:"text/javascript"}),P=URL.createObjectURL(C);try{w=new Worker(P),b=!0}catch{b=!1}return w&&w.terminate(),URL.revokeObjectURL(P),b}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var b=document.createElement("canvas");b.width=b.height=1;var w=b.getContext("2d");if(!w)return!1;var C=w.getImageData(0,0,1,1);return C&&C.width===b.width}()?(I[p=h&&h.failIfMajorPerformanceCaveat]===void 0&&(I[p]=function(b){var w,C=function(P){var k=document.createElement("canvas"),G=Object.create(x.webGLContextAttributes);return G.failIfMajorPerformanceCaveat=P,k.getContext("webgl",G)||k.getContext("experimental-webgl",G)}(b);if(!C)return!1;try{w=C.createShader(C.VERTEX_SHADER)}catch{return!1}return!(!w||C.isContextLost())&&(C.shaderSource(w,"void main() {}"),C.compileShader(w),C.getShaderParameter(w,C.COMPILE_STATUS)===!0)}(p)),I[p]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var p}(y)}var I={};function A(y,h,p){const b=s.window.document.createElement(y);return h!==void 0&&(b.className=h),p&&p.appendChild(b),b}function L(y,h,p){const b=s.window.document.createElementNS("http://www.w3.org/2000/svg",y);for(const w of Object.keys(h))b.setAttributeNS(null,w,h[w]);return p&&p.appendChild(b),b}x.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const N=s.window.document&&s.window.document.documentElement.style,B=N&&N.userSelect!==void 0?"userSelect":"WebkitUserSelect";let F;function z(){N&&B&&(F=N[B],N[B]="none")}function V(){N&&B&&(N[B]=F)}function Y(y){y.preventDefault(),y.stopPropagation(),s.window.removeEventListener("click",Y,!0)}function Q(){s.window.addEventListener("click",Y,!0),s.window.setTimeout(()=>{s.window.removeEventListener("click",Y,!0)},0)}function J(y,h){const p=y.getBoundingClientRect();return ae(y,p,h)}function he(y,h){const p=y.getBoundingClientRect(),b=[];for(let w=0;w<h.length;w++)b.push(ae(y,p,h[w]));return b}function ee(y){return s.window.InstallTrigger!==void 0&&y.button===2&&y.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:y.button}function ae(y,h,p){const b=y.offsetWidth===h.width?1:y.offsetWidth/h.width;return new s.pointGeometry((p.clientX-h.left)*b,(p.clientY-h.top)*b)}function De(y,h){var p=h[0],b=h[1],w=h[2],C=h[3],P=p*C-w*b;return P?(y[0]=C*(P=1/P),y[1]=-b*P,y[2]=-w*P,y[3]=p*P,y):null}function fe(y){const{userImage:h}=y;return!!(h&&h.render&&h.render())&&(y.data.replace(new Uint8Array(h.data.buffer)),!0)}class le extends s.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(h){if(this.loaded!==h&&(this.loaded=h,h)){for(const{ids:p,callback:b}of this.requestors)this._notify(p,b);this.requestors=[]}}hasImage(h){return!!this.getImage(h)}getImage(h){return this.images[h]}addImage(h,p){this._validate(h,p)&&(this.images[h]=p)}_validate(h,p){let b=!0;return this._validateStretch(p.stretchX,p.data&&p.data.width)||(this.fire(new s.ErrorEvent(new Error(`Image "${h}" has invalid "stretchX" value`))),b=!1),this._validateStretch(p.stretchY,p.data&&p.data.height)||(this.fire(new s.ErrorEvent(new Error(`Image "${h}" has invalid "stretchY" value`))),b=!1),this._validateContent(p.content,p)||(this.fire(new s.ErrorEvent(new Error(`Image "${h}" has invalid "content" value`))),b=!1),b}_validateStretch(h,p){if(!h)return!0;let b=0;for(const w of h){if(w[0]<b||w[1]<w[0]||p<w[1])return!1;b=w[1]}return!0}_validateContent(h,p){return!(h&&(h.length!==4||h[0]<0||p.data.width<h[0]||h[1]<0||p.data.height<h[1]||h[2]<0||p.data.width<h[2]||h[3]<0||p.data.height<h[3]||h[2]<h[0]||h[3]<h[1]))}updateImage(h,p){p.version=this.images[h].version+1,this.images[h]=p,this.updatedImages[h]=!0}removeImage(h){const p=this.images[h];delete this.images[h],delete this.patterns[h],p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(h,p){let b=!0;if(!this.isLoaded())for(const w of h)this.images[w]||(b=!1);this.isLoaded()||b?this._notify(h,p):this.requestors.push({ids:h,callback:p})}_notify(h,p){const b={};for(const w of h){this.images[w]||this.fire(new s.Event("styleimagemissing",{id:w}));const C=this.images[w];C?b[w]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,hasRenderCallback:!!(C.userImage&&C.userImage.render)}:s.warnOnce(`Image "${w}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}p(null,b)}getPixelSize(){const{width:h,height:p}=this.atlasImage;return{width:h,height:p}}getPattern(h){const p=this.patterns[h],b=this.getImage(h);if(!b)return null;if(p&&p.position.version===b.version)return p.position;if(p)p.position.version=b.version;else{const w={w:b.data.width+2,h:b.data.height+2,x:0,y:0},C=new s.ImagePosition(w,b);this.patterns[h]={bin:w,position:C}}return this._updatePatternAtlas(),this.patterns[h].position}bind(h){const p=h.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(h,this.atlasImage,p.RGBA),this.atlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE)}_updatePatternAtlas(){const h=[];for(const C in this.patterns)h.push(this.patterns[C].bin);const{w:p,h:b}=s.potpack(h),w=this.atlasImage;w.resize({width:p||1,height:b||1});for(const C in this.patterns){const{bin:P}=this.patterns[C],k=P.x+1,G=P.y+1,W=this.images[C].data,X=W.width,ne=W.height;s.RGBAImage.copy(W,w,{x:0,y:0},{x:k,y:G},{width:X,height:ne}),s.RGBAImage.copy(W,w,{x:0,y:ne-1},{x:k,y:G-1},{width:X,height:1}),s.RGBAImage.copy(W,w,{x:0,y:0},{x:k,y:G+ne},{width:X,height:1}),s.RGBAImage.copy(W,w,{x:X-1,y:0},{x:k-1,y:G},{width:1,height:ne}),s.RGBAImage.copy(W,w,{x:0,y:0},{x:k+X,y:G},{width:1,height:ne})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(h){for(const p of h){if(this.callbackDispatchedThisFrame[p])continue;this.callbackDispatchedThisFrame[p]=!0;const b=this.images[p];fe(b)&&this.updateImage(p,b)}}}const Be=new s.Properties({anchor:new s.DataConstantProperty(s.spec.light.anchor),position:new class{constructor(){this.specification=s.spec.light.position}possiblyEvaluate(y,h){return function([p,b,w]){const C=s.degToRad(b+90),P=s.degToRad(w);return{x:p*Math.cos(C)*Math.sin(P),y:p*Math.sin(C)*Math.sin(P),z:p*Math.cos(P),azimuthal:b,polar:w}}(y.expression.evaluate(h))}interpolate(y,h,p){return{x:s.number(y.x,h.x,p),y:s.number(y.y,h.y,p),z:s.number(y.z,h.z,p),azimuthal:s.number(y.azimuthal,h.azimuthal,p),polar:s.number(y.polar,h.polar,p)}}},color:new s.DataConstantProperty(s.spec.light.color),intensity:new s.DataConstantProperty(s.spec.light.intensity)}),Pe="-transition";class Ce extends s.Evented{constructor(h){super(),this._transitionable=new s.Transitionable(Be),this.setLight(h),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(h,p={}){if(!this._validate(s.validateLight,h,p))for(const b in h){const w=h[b];s.endsWith(b,Pe)?this._transitionable.setTransition(b.slice(0,-Pe.length),w):this._transitionable.setValue(b,w)}}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,p,b){return(!b||b.validate!==!1)&&s.emitValidationErrors(this,h.call(s.validateStyle,s.extend({value:p,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}const it=new s.Properties({source:new s.DataConstantProperty(s.spec.terrain.source),exaggeration:new s.DataConstantProperty(s.spec.terrain.exaggeration)}),Et="-transition";class Ue extends s.Evented{constructor(h,p){super(),this._transitionable=new s.Transitionable(it),this.set(h),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=p}get(){return this._transitionable.serialize()}set(h){for(const p in h){const b=h[p];s.endsWith(p,Et)?this._transitionable.setTransition(p.slice(0,-Et.length),b):this._transitionable.setValue(p,b)}}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}}function at(y,h,p,b){const w=s.smoothstep(45,65,p),[C,P]=ke(y,b),k=s.length(h);let G=1-Math.min(1,Math.exp((k-C)/(P-C)*-6));return G*=G*G,G=Math.min(1,1.00747*G),G*w*y.alpha}function ke(y,h){const p=.5/Math.tan(.5*h);return[y.range[0]+p,y.range[1]+p]}const Dt=new s.Properties({range:new s.DataConstantProperty(s.spec.fog.range),color:new s.DataConstantProperty(s.spec.fog.color),"high-color":new s.DataConstantProperty(s.spec.fog["high-color"]),"space-color":new s.DataConstantProperty(s.spec.fog["space-color"]),"horizon-blend":new s.DataConstantProperty(s.spec.fog["horizon-blend"]),"star-intensity":new s.DataConstantProperty(s.spec.fog["star-intensity"])}),fn="-transition";class Cn extends s.Evented{constructor(h,p){super(),this._transitionable=new s.Transitionable(Dt),this.set(h),this._transitioning=this._transitionable.untransitioned(),this._transform=p}get state(){const h=this._transform,p=h.projection.name==="globe",b=s.globeToMercatorTransition(h.zoom),w=this.properties.get("range"),C=[.5,3];return{range:p?[s.number(C[0],w[0],b),s.number(C[1],w[1],b)]:w,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(h,p={}){if(!this._validate(s.validateFog,h,p)){for(const b of Object.keys(s.spec.fog))h&&h[b]===void 0&&(h[b]=s.spec.fog[b].default);for(const b in h){const w=h[b];s.endsWith(b,fn)?this._transitionable.setTransition(b.slice(0,-fn.length),w):this._transitionable.setValue(b,w)}}}getOpacity(h){if(!this._transform.projection.supportsFog)return 0;const p=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:s.smoothstep(45,65,h))*p.a}getOpacityAtLatLng(h,p){return this._transform.projection.supportsFog?function(b,w,C){const P=s.MercatorCoordinate.fromLngLat(w),k=C.elevation?C.elevation.getAtPointOrZero(P):0,G=[P.x,P.y,k];return s.transformMat4(G,G,C.mercatorFogMatrix),at(b,G,C.pitch,C._fov)}(this.state,h,p):0}getFovAdjustedRange(h){return this._transform.projection.supportsFog?ke(this.state,h):[0,1]}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,p,b){return(!b||b.validate!==!1)&&s.emitValidationErrors(this,h.call(s.validateStyle,s.extend({value:p,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}class Gt{constructor(h,p){this.workerPool=h,this.actors=[],this.currentActor=0,this.id=s.uniqueId();const b=this.workerPool.acquire(this.id);for(let w=0;w<b.length;w++){const C=new Gt.Actor(b[w],p,this.id);C.name=`Worker ${w}`,this.actors.push(C)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(h,p,b){s.asyncAll(this.actors,(w,C)=>{w.send(h,p,C)},b=b||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(h=>{h.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Mt(y,h,p){return h*(s.EXTENT/(y.tileSize*Math.pow(2,p-y.tileID.overscaledZ)))}Gt.Actor=s.Actor;class vt{constructor(h,p,b,w){this.screenBounds=h,this.cameraPoint=p,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=b,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,w)}static createFromScreenPoints(h,p){let b,w;if(h instanceof s.pointGeometry||typeof h[0]=="number"){const C=s.pointGeometry.convert(h);b=[C],w=p.isPointAboveHorizon(C)}else{const C=s.pointGeometry.convert(h[0]),P=s.pointGeometry.convert(h[1]);b=[C,P],w=s.polygonizeBounds(C,P).every(k=>p.isPointAboveHorizon(k))}return new vt(b,p.getCameraPoint(),w,p)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(h){return s.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],h)}bufferedCameraGeometry(h){const p=this.screenBounds[0],b=this.screenBounds.length===1?this.screenBounds[0].add(new s.pointGeometry(1,1)):this.screenBounds[1],w=s.polygonizeBounds(p,b,0,!1);return this.cameraPoint.y>b.y&&(this.cameraPoint.x>p.x&&this.cameraPoint.x<b.x?w.splice(3,0,this.cameraPoint):this.cameraPoint.x>=b.x?w[2]=this.cameraPoint:this.cameraPoint.x<=p.x&&(w[3]=this.cameraPoint)),s.bufferConvexPolygon(w,h)}bufferedCameraGeometryGlobe(h){const p=this.screenBounds[0],b=this.screenBounds.length===1?this.screenBounds[0].add(new s.pointGeometry(1,1)):this.screenBounds[1],w=s.polygonizeBounds(p,b,h),C=this.cameraPoint.clone();switch(3*((C.y>p.y)+(C.y>b.y))+((C.x>p.x)+(C.x>b.x))){case 0:w[0]=C,w[4]=C.clone();break;case 1:w.splice(1,0,C);break;case 2:w[1]=C;break;case 3:w.splice(4,0,C);break;case 5:w.splice(2,0,C);break;case 6:w[3]=C;break;case 7:w.splice(3,0,C);break;case 8:w[2]=C}return w}containsTile(h,p,b,w=0){const C=h.queryPadding/p._pixelsPerMercatorPixel+1,P=b?this._bufferedCameraMercator(C,p):this._bufferedScreenMercator(C,p);let k=h.tileID.wrap+(P.unwrapped?w:0);const G=P.polygon.map(xe=>s.getTilePoint(h.tileTransform,xe,k));if(!s.polygonIntersectsBox(G,0,0,s.EXTENT,s.EXTENT))return;k=h.tileID.wrap+(this.screenGeometryMercator.unwrapped?w:0);const W=this.screenGeometryMercator.polygon.map(xe=>s.getTileVec3(h.tileTransform,xe,k)),X=W.map(xe=>new s.pointGeometry(xe[0],xe[1])),ne=p.getFreeCameraOptions().position||new s.MercatorCoordinate(0,0,0),ce=s.getTileVec3(h.tileTransform,ne,k),ye=W.map(xe=>{const se=s.sub(xe,xe,ce);return s.normalize(se,se),new s.Ray(ce,se)}),_e=Mt(h,1,p.zoom)*p._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:X,tilespaceRays:ye,bufferedTilespaceGeometry:G,bufferedTilespaceBounds:(ve=s.getBounds(G),ve.min.x=s.clamp(ve.min.x,0,s.EXTENT),ve.min.y=s.clamp(ve.min.y,0,s.EXTENT),ve.max.x=s.clamp(ve.max.x,0,s.EXTENT),ve.max.y=s.clamp(ve.max.y,0,s.EXTENT),ve),tile:h,tileID:h.tileID,pixelToTileUnitsFactor:_e};var ve}_bufferedScreenMercator(h,p){const b=_t(h);if(this._screenRaycastCache[b])return this._screenRaycastCache[b];{let w;return w=p.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(h),p):{polygon:this.bufferedScreenGeometry(h).map(C=>p.pointCoordinate3D(C)),unwrapped:!0},this._screenRaycastCache[b]=w,w}}_bufferedCameraMercator(h,p){const b=_t(h);if(this._cameraRaycastCache[b])return this._cameraRaycastCache[b];{let w;return w=p.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(h),p):{polygon:this.bufferedCameraGeometry(h).map(C=>p.pointCoordinate3D(C)),unwrapped:!0},this._cameraRaycastCache[b]=w,w}}_projectAndResample(h,p){const b=function(C,P){const k=s.multiply([],P.pixelMatrix,P.globeMatrix),G=[0,-s.GLOBE_RADIUS,0,1],W=[0,s.GLOBE_RADIUS,0,1],X=[0,0,0,1];s.transformMat4$1(G,G,k),s.transformMat4$1(W,W,k),s.transformMat4$1(X,X,k);const ne=new s.pointGeometry(G[0]/G[3],G[1]/G[3]),ce=new s.pointGeometry(W[0]/W[3],W[1]/W[3]),ye=s.polygonContainsPoint(C,ne)&&G[3]<X[3],_e=s.polygonContainsPoint(C,ce)&&W[3]<X[3];if(!ye&&!_e)return null;const ve=function(Ke,ft,dt){for(let xt=1;xt<Ke.length;xt++){const Tn=En(ft.pointCoordinate3D(Ke[xt-1]).x),gt=En(ft.pointCoordinate3D(Ke[xt]).x);if(dt<0){if(Tn<gt)return{idx:xt,t:-Tn/(gt-1-Tn)}}else if(gt<Tn)return{idx:xt,t:(1-Tn)/(gt+1-Tn)}}return null}(C,P,ye?-1:1);if(!ve)return null;const{idx:xe,t:se}=ve;let Le=xe>1?xn(C.slice(0,xe),P):[],Ae=xe<C.length?xn(C.slice(xe),P):[];Le=Le.map(Ke=>new s.pointGeometry(En(Ke.x),Ke.y)),Ae=Ae.map(Ke=>new s.pointGeometry(En(Ke.x),Ke.y));const Re=[...Le];Re.length===0&&Re.push(Ae[Ae.length-1]);const Xe=s.number(Re[Re.length-1].y,(Ae.length===0?Le[0]:Ae[0]).y,se);let je;return je=ye?[new s.pointGeometry(0,Xe),new s.pointGeometry(0,0),new s.pointGeometry(1,0),new s.pointGeometry(1,Xe)]:[new s.pointGeometry(1,Xe),new s.pointGeometry(1,1),new s.pointGeometry(0,1),new s.pointGeometry(0,Xe)],Re.push(...je),Ae.length===0?Re.push(Le[0]):Re.push(...Ae),{polygon:Re.map(Ke=>new s.MercatorCoordinate(Ke.x,Ke.y)),unwrapped:!1}}(h,p);if(b)return b;const w=function(C,P){let k=!1,G=-1/0,W=0;for(let ne=0;ne<C.length-1;ne++)C[ne].x>G&&(G=C[ne].x,W=ne);for(let ne=0;ne<C.length-1;ne++){const ce=(W+ne)%(C.length-1),ye=C[ce],_e=C[ce+1];Math.abs(ye.x-_e.x)>.5&&(ye.x<_e.x?(ye.x+=1,ce===0&&(C[C.length-1].x+=1)):(_e.x+=1,ce+1===C.length-1&&(C[0].x+=1)),k=!0)}const X=s.mercatorXfromLng(P.center.lng);return k&&X<Math.abs(X-1)&&C.forEach(ne=>{ne.x-=1}),{polygon:C,unwrapped:k}}(xn(h,p).map(C=>new s.pointGeometry(En(C.x),C.y)),p);return{polygon:w.polygon.map(C=>new s.MercatorCoordinate(C.x,C.y)),unwrapped:w.unwrapped}}}function xn(y,h){return s.resample(y,p=>{const b=h.pointCoordinate3D(p);p.x=b.x,p.y=b.y},1/256)}function En(y){return y<0?1+y%1:y%1}function _t(y){return 100*y|0}function kt(y,h,p,b,w){const C=function(P,k){if(P)return w(P);if(k){y.url&&k.tiles&&y.tiles&&delete y.tiles;const G=s.pick(s.extend(k,y),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);k.vector_layers&&(G.vectorLayers=k.vector_layers,G.vectorLayerIds=G.vectorLayers.map(W=>W.id)),G.tiles=h.canonicalizeTileset(G,y.url),w(null,G)}};return y.url?s.getJSON(h.transformRequest(h.normalizeSourceURL(y.url,null,p,b),s.ResourceType.Source),C):s.exported.frame(()=>C(null,y))}class Ct{constructor(h,p,b){this.bounds=s.LngLatBounds.convert(this.validateBounds(h)),this.minzoom=p||0,this.maxzoom=b||24}validateBounds(h){return Array.isArray(h)&&h.length===4?[Math.max(-180,h[0]),Math.max(-90,h[1]),Math.min(180,h[2]),Math.min(90,h[3])]:[-180,-90,180,90]}contains(h){const p=Math.pow(2,h.z),b=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*p),w=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*p),C=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*p),P=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*p);return h.x>=b&&h.x<C&&h.y>=w&&h.y<P}}class Bt{constructor(h,p,b){this.context=h;const w=h.gl;this.buffer=w.createBuffer(),this.dynamicDraw=!!b,this.context.unbindVAO(),h.bindElementBuffer.set(this.buffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||p.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(h){const p=this.context.gl;this.context.unbindVAO(),this.bind(),p.bufferSubData(p.ELEMENT_ARRAY_BUFFER,0,h.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Zn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class mi{constructor(h,p,b,w){this.length=p.length,this.attributes=b,this.itemSize=p.bytesPerElement,this.dynamicDraw=w,this.context=h;const C=h.gl;this.buffer=C.createBuffer(),h.bindVertexBuffer.set(this.buffer),C.bufferData(C.ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||p.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(h){const p=this.context.gl;this.bind(),p.bufferSubData(p.ARRAY_BUFFER,0,h.arrayBuffer)}enableAttributes(h,p){for(let b=0;b<this.attributes.length;b++){const w=p.attributes[this.attributes[b].name];w!==void 0&&h.enableVertexAttribArray(w)}}setVertexAttribPointers(h,p,b){for(let w=0;w<this.attributes.length;w++){const C=this.attributes[w],P=p.attributes[C.name];P!==void 0&&h.vertexAttribPointer(P,C.components,h[Zn[C.type]],!1,this.itemSize,C.offset+this.itemSize*(b||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class yn{constructor(h){this.gl=h.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(h){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Pt extends yn{getDefault(){return s.Color.transparent}set(h){const p=this.current;(h.r!==p.r||h.g!==p.g||h.b!==p.b||h.a!==p.a||this.dirty)&&(this.gl.clearColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)}}class Yn extends yn{getDefault(){return 1}set(h){(h!==this.current||this.dirty)&&(this.gl.clearDepth(h),this.current=h,this.dirty=!1)}}class si extends yn{getDefault(){return 0}set(h){(h!==this.current||this.dirty)&&(this.gl.clearStencil(h),this.current=h,this.dirty=!1)}}class Dr extends yn{getDefault(){return[!0,!0,!0,!0]}set(h){const p=this.current;(h[0]!==p[0]||h[1]!==p[1]||h[2]!==p[2]||h[3]!==p[3]||this.dirty)&&(this.gl.colorMask(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)}}class Ur extends yn{getDefault(){return!0}set(h){(h!==this.current||this.dirty)&&(this.gl.depthMask(h),this.current=h,this.dirty=!1)}}class He extends yn{getDefault(){return 255}set(h){(h!==this.current||this.dirty)&&(this.gl.stencilMask(h),this.current=h,this.dirty=!1)}}class Jt extends yn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(h){const p=this.current;(h.func!==p.func||h.ref!==p.ref||h.mask!==p.mask||this.dirty)&&(this.gl.stencilFunc(h.func,h.ref,h.mask),this.current=h,this.dirty=!1)}}class ui extends yn{getDefault(){const h=this.gl;return[h.KEEP,h.KEEP,h.KEEP]}set(h){const p=this.current;(h[0]!==p[0]||h[1]!==p[1]||h[2]!==p[2]||this.dirty)&&(this.gl.stencilOp(h[0],h[1],h[2]),this.current=h,this.dirty=!1)}}class $e extends yn{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const p=this.gl;h?p.enable(p.STENCIL_TEST):p.disable(p.STENCIL_TEST),this.current=h,this.dirty=!1}}class kn extends yn{getDefault(){return[0,1]}set(h){const p=this.current;(h[0]!==p[0]||h[1]!==p[1]||this.dirty)&&(this.gl.depthRange(h[0],h[1]),this.current=h,this.dirty=!1)}}class Ei extends yn{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const p=this.gl;h?p.enable(p.DEPTH_TEST):p.disable(p.DEPTH_TEST),this.current=h,this.dirty=!1}}class ni extends yn{getDefault(){return this.gl.LESS}set(h){(h!==this.current||this.dirty)&&(this.gl.depthFunc(h),this.current=h,this.dirty=!1)}}class Ln extends yn{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const p=this.gl;h?p.enable(p.BLEND):p.disable(p.BLEND),this.current=h,this.dirty=!1}}class ki extends yn{getDefault(){const h=this.gl;return[h.ONE,h.ZERO]}set(h){const p=this.current;(h[0]!==p[0]||h[1]!==p[1]||this.dirty)&&(this.gl.blendFunc(h[0],h[1]),this.current=h,this.dirty=!1)}}class Hs extends yn{getDefault(){return s.Color.transparent}set(h){const p=this.current;(h.r!==p.r||h.g!==p.g||h.b!==p.b||h.a!==p.a||this.dirty)&&(this.gl.blendColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)}}class Xt extends yn{getDefault(){return this.gl.FUNC_ADD}set(h){(h!==this.current||this.dirty)&&(this.gl.blendEquation(h),this.current=h,this.dirty=!1)}}class Rn extends yn{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const p=this.gl;h?p.enable(p.CULL_FACE):p.disable(p.CULL_FACE),this.current=h,this.dirty=!1}}class ti extends yn{getDefault(){return this.gl.BACK}set(h){(h!==this.current||this.dirty)&&(this.gl.cullFace(h),this.current=h,this.dirty=!1)}}class tr extends yn{getDefault(){return this.gl.CCW}set(h){(h!==this.current||this.dirty)&&(this.gl.frontFace(h),this.current=h,this.dirty=!1)}}class js extends yn{getDefault(){return null}set(h){(h!==this.current||this.dirty)&&(this.gl.useProgram(h),this.current=h,this.dirty=!1)}}class mo extends yn{getDefault(){return this.gl.TEXTURE0}set(h){(h!==this.current||this.dirty)&&(this.gl.activeTexture(h),this.current=h,this.dirty=!1)}}class ca extends yn{getDefault(){const h=this.gl;return[0,0,h.drawingBufferWidth,h.drawingBufferHeight]}set(h){const p=this.current;(h[0]!==p[0]||h[1]!==p[1]||h[2]!==p[2]||h[3]!==p[3]||this.dirty)&&(this.gl.viewport(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)}}class Xo extends yn{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const p=this.gl;p.bindFramebuffer(p.FRAMEBUFFER,h),this.current=h,this.dirty=!1}}class qs extends yn{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const p=this.gl;p.bindRenderbuffer(p.RENDERBUFFER,h),this.current=h,this.dirty=!1}}class No extends yn{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const p=this.gl;p.bindTexture(p.TEXTURE_2D,h),this.current=h,this.dirty=!1}}class Ja extends yn{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const p=this.gl;p.bindBuffer(p.ARRAY_BUFFER,h),this.current=h,this.dirty=!1}}class go extends yn{getDefault(){return null}set(h){const p=this.gl;p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,h),this.current=h,this.dirty=!1}}class Ma extends yn{constructor(h){super(h),this.vao=h.extVertexArrayObject}getDefault(){return null}set(h){this.vao&&(h!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(h),this.current=h,this.dirty=!1)}}class Vl extends yn{getDefault(){return 4}set(h){if(h===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_ALIGNMENT,h),this.current=h,this.dirty=!1}}class Qa extends yn{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,h),this.current=h,this.dirty=!1}}class ha extends yn{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,h),this.current=h,this.dirty=!1}}class $a extends yn{constructor(h,p){super(h),this.context=h,this.parent=p}getDefault(){return null}}class Zs extends $a{setDirty(){this.dirty=!0}set(h){if(h===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,h,0),this.current=h,this.dirty=!1}}class La extends $a{attachment(){return this.gl.DEPTH_ATTACHMENT}set(h){if(h===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferRenderbuffer(p.FRAMEBUFFER,this.attachment(),p.RENDERBUFFER,h),this.current=h,this.dirty=!1}}class so extends La{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Ra{constructor(h,p,b,w){this.context=h,this.width=p,this.height=b;const C=this.framebuffer=h.gl.createFramebuffer();this.colorAttachment=new Zs(h,C),w&&(this.depthAttachment=new La(h,C))}destroy(){const h=this.context.gl,p=this.colorAttachment.get();if(p&&h.deleteTexture(p),this.depthAttachment){const b=this.depthAttachment.get();b&&h.deleteRenderbuffer(b)}h.deleteFramebuffer(this.framebuffer)}}class we{constructor(h,p=!1){if(this.gl=h,this.isWebGL2=p,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),p){const b=h;this.extVertexArrayObject={createVertexArrayOES:b.createVertexArray.bind(h),deleteVertexArrayOES:b.deleteVertexArray.bind(h),bindVertexArrayOES:b.bindVertexArray.bind(h)}}this.clearColor=new Pt(this),this.clearDepth=new Yn(this),this.clearStencil=new si(this),this.colorMask=new Dr(this),this.depthMask=new Ur(this),this.stencilMask=new He(this),this.stencilFunc=new Jt(this),this.stencilOp=new ui(this),this.stencilTest=new $e(this),this.depthRange=new kn(this),this.depthTest=new Ei(this),this.depthFunc=new ni(this),this.blend=new Ln(this),this.blendFunc=new ki(this),this.blendColor=new Hs(this),this.blendEquation=new Xt(this),this.cullFace=new Rn(this),this.cullFaceSide=new ti(this),this.frontFace=new tr(this),this.program=new js(this),this.activeTexture=new mo(this),this.viewport=new ca(this),this.bindFramebuffer=new Xo(this),this.bindRenderbuffer=new qs(this),this.bindTexture=new No(this),this.bindVertexBuffer=new Ja(this),this.bindElementBuffer=new go(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Ma(this),this.pixelStoreUnpack=new Vl(this),this.pixelStoreUnpackPremultiplyAlpha=new Qa(this),this.pixelStoreUnpackFlipY=new ha(this),this.extTextureFilterAnisotropic=h.getExtension("EXT_texture_filter_anisotropic")||h.getExtension("MOZ_EXT_texture_filter_anisotropic")||h.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=h.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=h.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=h.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=h.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),p||(this.extTextureHalfFloat=h.getExtension("OES_texture_half_float")),(p||this.extTextureHalfFloat&&h.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=h.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=p||h.getExtension("OES_standard_derivatives"),this.extTimerQuery=h.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=h.getParameter(h.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(h,p){return new Bt(this,h,p)}createVertexBuffer(h,p,b){return new mi(this,h,p,b)}createRenderbuffer(h,p,b){const w=this.gl,C=w.createRenderbuffer();return this.bindRenderbuffer.set(C),w.renderbufferStorage(w.RENDERBUFFER,h,p,b),this.bindRenderbuffer.set(null),C}createFramebuffer(h,p,b){return new Ra(this,h,p,b)}clear({color:h,depth:p,stencil:b}){const w=this.gl;let C=0;h&&(C|=w.COLOR_BUFFER_BIT,this.clearColor.set(h),this.colorMask.set([!0,!0,!0,!0])),p!==void 0&&(C|=w.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(p),this.depthMask.set(!0)),b!==void 0&&(C|=w.STENCIL_BUFFER_BIT,this.clearStencil.set(b),this.stencilMask.set(255)),w.clear(C)}setCullFace(h){h.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(h.mode),this.frontFace.set(h.frontFace))}setDepthMode(h){h.func!==this.gl.ALWAYS||h.mask?(this.depthTest.set(!0),this.depthFunc.set(h.func),this.depthMask.set(h.mask),this.depthRange.set(h.range)):this.depthTest.set(!1)}setStencilMode(h){h.test.func!==this.gl.ALWAYS||h.mask?(this.stencilTest.set(!0),this.stencilMask.set(h.mask),this.stencilOp.set([h.fail,h.depthFail,h.pass]),this.stencilFunc.set({func:h.test.func,ref:h.ref,mask:h.test.mask})):this.stencilTest.set(!1)}setColorMode(h){d(h.blendFunction,s.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(h.blendFunction),this.blendColor.set(h.blendColor)),this.colorMask.set(h.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class te extends s.Evented{constructor(h,p,b,w){if(super(),this.id=h,this.dispatcher=b,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(p,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},p),this._collectResourceTiming=p.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w),this._tileWorkers={},this._deduped=new s.DedupedRequest}load(h){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"}));const p=Array.isArray(this.map._language)?this.map._language.join():this.map._language,b=this.map._worldview;this._tileJSONRequest=kt(this._options,this.map._requestManager,p,b,(w,C)=>{this._tileJSONRequest=null,this._loaded=!0,w?(p&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${p}`),b&&b.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${b}`),this.fire(new s.ErrorEvent(w))):C&&(s.extend(this,C),C.bounds&&(this.tileBounds=new Ct(C.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(C.tiles,this.map._requestManager._customAccessToken),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),h&&h(w)})}loaded(){return this._loaded}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}onAdd(h){this.map=h,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(h){return this._options.tiles=h,this.reload(),this}setUrl(h){return this.url=h,this._options.url=h,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}loadTile(h,p){const b=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(b,s.ResourceType.Tile),data:void 0,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,tileSize:this.tileSize*h.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:h.isSymbolTile};if(w.request.collectResourceTiming=this._collectResourceTiming,h.actor&&h.state!=="expired")h.state==="loading"?h.reloadCallback=p:h.request=h.actor.send("reloadTile",w,C.bind(this));else if(h.actor=this._tileWorkers[b]=this._tileWorkers[b]||this.dispatcher.getActor(),this.dispatcher.ready)h.request=h.actor.send("loadTile",w,C.bind(this),void 0,!0);else{const P=s.loadVectorTile.call({deduped:this._deduped},w,(k,G)=>{k||!G?C.call(this,k):(w.data={cacheControl:G.cacheControl,expires:G.expires,rawData:G.rawData.slice(0)},h.actor&&h.actor.send("loadTile",w,C.bind(this),void 0,!0))},!0);h.request={cancel:P}}function C(P,k){return delete h.request,h.aborted?p(null):P&&P.status!==404?p(P):(k&&k.resourceTiming&&(h.resourceTiming=k.resourceTiming),this.map._refreshExpiredTiles&&k&&h.setExpiryData(k),h.loadVectorData(k,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),p(null),void(h.reloadCallback&&(this.loadTile(h,h.reloadCallback),h.reloadCallback=null)))}}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.actor&&h.actor.send("abortTile",{uid:h.uid,type:this.type,source:this.id})}unloadTile(h){h.unloadVectorData(),h.actor&&h.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class re extends s.Evented{constructor(h,p,b,w){super(),this.id=h,this.dispatcher=b,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},p),s.extend(this,s.pick(p,["url","scheme","tileSize"]))}load(h){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=kt(this._options,this.map._requestManager,null,null,(p,b)=>{this._tileJSONRequest=null,this._loaded=!0,p?this.fire(new s.ErrorEvent(p)):b&&(s.extend(this,b),b.bounds&&(this.tileBounds=new Ct(b.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(b.tiles),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),h&&h(p)})}loaded(){return this._loaded}onAdd(h){this.map=h,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(h){return this._options.tiles=h,this.reload(),this}setUrl(h){return this.url=h,this._options.url=h,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}loadTile(h,p){const b=s.exported.devicePixelRatio>=2,w=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),b,this.tileSize);h.request=s.getImage(this.map._requestManager.transformRequest(w,s.ResourceType.Tile),(C,P,k,G)=>(delete h.request,h.aborted?(h.state="unloaded",p(null)):C?(h.state="errored",p(C)):P?(this.map._refreshExpiredTiles&&h.setExpiryData({cacheControl:k,expires:G}),h.setTexture(P,this.map.painter),h.state="loaded",s.cacheEntryPossiblyAdded(this.dispatcher),void p(null)):p(null)))}static loadTileData(h,p,b){h.setTexture(p,b)}static unloadTileData(h,p){h.texture&&p.saveTileTexture(h.texture)}abortTile(h,p){h.request&&(h.request.cancel(),delete h.request),p()}unloadTile(h,p){h.texture&&this.map.painter.saveTileTexture(h.texture),p()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let Ie;function Oe(y,h,p,b,w,C,P,k){const G=[y,p,w,h,b,C,1,1,1],W=[P,k,1],X=s.adjoint([],G),[ne,ce,ye]=s.transformMat3(W,W,s.transpose(X,X));return s.multiply$1(G,[ne,0,0,0,ce,0,0,0,ye],G)}class We extends s.Evented{constructor(h,p,b,w){super(),this.id=h,this.dispatcher=b,this.coordinates=p.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=p,this._dirty=!1}load(h,p){this._loaded=p||!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),(b,w)=>{if(this._imageRequest=null,this._loaded=!0,b)this.fire(new s.ErrorEvent(b));else if(w){const{HTMLImageElement:C}=s.window;this.image=w instanceof C?s.exported.getImageData(w):w,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,h&&(this.coordinates=h),this._finishLoading()}})}loaded(){return this._loaded}updateImage(h){return this.image&&h.url?(this._imageRequest&&h.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=h.url,this.load(h.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(h){this.map=h,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(h){this.coordinates=h,this._boundsArray=void 0;const p=h.map(s.MercatorCoordinate.fromLngLat);return this.tileID=function(b){let w=1/0,C=1/0,P=-1/0,k=-1/0;for(const ne of b)w=Math.min(w,ne.x),C=Math.min(C,ne.y),P=Math.max(P,ne.x),k=Math.max(k,ne.y);const G=Math.max(P-w,k-C),W=Math.max(0,Math.floor(-Math.log(G)/Math.LN2)),X=Math.pow(2,W);return new s.CanonicalTileID(W,Math.floor((w+P)/2*X),Math.floor((C+k)/2*X))}(p),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(h){for(const G in this.tiles){const W=this.tiles[G];W.state!=="loaded"&&(W.state="loaded",W.texture=this.texture)}if(this._boundsArray)return;const p=s.tileTransform(this.tileID,this.map.transform.projection),[b,w,C,P]=this.coordinates.map(G=>{const W=p.projection.project(G[0],G[1]);return s.getTilePoint(p,W)._round()});this.perspectiveTransform=function(G,W,X,ne,ce,ye,_e,ve,xe,se){const Le=Oe(0,0,G,0,0,W,G,W),Ae=Oe(X,ne,ce,ye,_e,ve,xe,se);return s.multiply$1(Ae,s.adjoint(Le,Le),Ae),[Ae[6]/Ae[8]*G/s.EXTENT,Ae[7]/Ae[8]*W/s.EXTENT]}(this.width,this.height,b.x,b.y,w.x,w.y,P.x,P.y,C.x,C.y);const k=this._boundsArray=new s.StructArrayLayout4i8;k.emplaceBack(b.x,b.y,0,0),k.emplaceBack(w.x,w.y,s.EXTENT,0),k.emplaceBack(P.x,P.y,0,s.EXTENT),k.emplaceBack(C.x,C.y,s.EXTENT,s.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=h.createVertexBuffer(k,s.boundsAttributes.members),this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const h=this.map.painter.context,p=h.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new s.Texture(h,this.image,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(h)}loadTile(h,p){this.tileID&&this.tileID.equals(h.tileID.canonical)?(this.tiles[String(h.tileID.wrap)]=h,h.buckets={},p(null)):(h.state="errored",p(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const ut={vector:te,raster:re,"raster-dem":class extends re{constructor(y,h,p,b){super(y,h,p,b),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},h),this.encoding=h.encoding||"mapbox"}loadTile(y,h){const p=this.map._requestManager.normalizeTileURL(y.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function b(w,C){w&&(y.state="errored",h(w)),C&&(y.dem=C,y.dem.onDeserialize(),y.needsHillshadePrepare=!0,y.needsDEMTextureUpload=!0,y.state="loaded",h(null))}y.request=s.getImage(this.map._requestManager.transformRequest(p,s.ResourceType.Tile),function(w,C,P,k){if(delete y.request,y.aborted)y.state="unloaded",h(null);else if(w)y.state="errored",h(w);else if(C){this.map._refreshExpiredTiles&&y.setExpiryData({cacheControl:P,expires:k});const G=s.window.ImageBitmap&&C instanceof s.window.ImageBitmap&&(Ie==null&&(Ie=s.window.OffscreenCanvas&&new s.window.OffscreenCanvas(1,1).getContext("2d")&&typeof s.window.createImageBitmap=="function"),Ie),W=1-(C.width-s.prevPowerOfTwo(C.width))/2;W<1||y.neighboringTiles||(y.neighboringTiles=this._getNeighboringTiles(y.tileID));const X=G?C:s.exported.getImageData(C,W),ne={uid:y.uid,coord:y.tileID,source:this.id,rawImageData:X,encoding:this.encoding,padding:W};y.actor&&y.state!=="expired"||(y.actor=this.dispatcher.getActor(),y.actor.send("loadDEMTile",ne,b.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(y){const h=y.canonical,p=Math.pow(2,h.z),b=(h.x-1+p)%p,w=h.x===0?y.wrap-1:y.wrap,C=(h.x+1+p)%p,P=h.x+1===p?y.wrap+1:y.wrap,k={};return k[new s.OverscaledTileID(y.overscaledZ,w,h.z,b,h.y).key]={backfilled:!1},k[new s.OverscaledTileID(y.overscaledZ,P,h.z,C,h.y).key]={backfilled:!1},h.y>0&&(k[new s.OverscaledTileID(y.overscaledZ,w,h.z,b,h.y-1).key]={backfilled:!1},k[new s.OverscaledTileID(y.overscaledZ,y.wrap,h.z,h.x,h.y-1).key]={backfilled:!1},k[new s.OverscaledTileID(y.overscaledZ,P,h.z,C,h.y-1).key]={backfilled:!1}),h.y+1<p&&(k[new s.OverscaledTileID(y.overscaledZ,w,h.z,b,h.y+1).key]={backfilled:!1},k[new s.OverscaledTileID(y.overscaledZ,y.wrap,h.z,h.x,h.y+1).key]={backfilled:!1},k[new s.OverscaledTileID(y.overscaledZ,P,h.z,C,h.y+1).key]={backfilled:!1}),k}unloadTile(y){y.demTexture&&this.map.painter.saveTileTexture(y.demTexture),y.fbo&&(y.fbo.destroy(),delete y.fbo),y.dem&&delete y.dem,delete y.neighboringTiles,y.state="unloaded"}},geojson:class extends s.Evented{constructor(y,h,p,b){super(),this.id=y,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=p.getActor(),this.setEventedParent(b),this._data=h.data,this._options=s.extend({},h),this._collectResourceTiming=h.collectResourceTiming,h.maxzoom!==void 0&&(this.maxzoom=h.maxzoom),h.type&&(this.type=h.type),h.attribution&&(this.attribution=h.attribution),this.promoteId=h.promoteId;const w=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:h.cluster||!1,geojsonVtOptions:{buffer:(h.buffer!==void 0?h.buffer:128)*w,tolerance:(h.tolerance!==void 0?h.tolerance:.375)*w,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:h.lineMetrics||!1,generateId:h.generateId||!1},superclusterOptions:{maxZoom:h.clusterMaxZoom!==void 0?h.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,h.clusterMinPoints||2),extent:s.EXTENT,radius:(h.clusterRadius!==void 0?h.clusterRadius:50)*w,log:!1,generateId:h.generateId||!1},clusterProperties:h.clusterProperties,filter:h.filter},h.workerOptions)}onAdd(y){this.map=y,this.setData(this._data)}setData(y){return this._data=y,this._updateWorkerData(),this}getClusterExpansionZoom(y,h){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:y,source:this.id},h),this}getClusterChildren(y,h){return this.actor.send("geojson.getClusterChildren",{clusterId:y,source:this.id},h),this}getClusterLeaves(y,h,p,b){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:y,limit:h,offset:p},b),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.Event("dataloading",{dataType:"source"})),this._loaded=!1;const y=s.extend({},this.workerOptions),h=this._data;typeof h=="string"?(y.request=this.map._requestManager.transformRequest(s.exported.resolveURL(h),s.ResourceType.Source),y.request.collectResourceTiming=this._collectResourceTiming):y.data=JSON.stringify(h),this._pendingLoad=this.actor.send(`${this.type}.loadData`,y,(p,b)=>{if(this._loaded=!0,this._pendingLoad=null,p)this.fire(new s.ErrorEvent(p));else{const w={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&b&&b.resourceTiming&&b.resourceTiming[this.id]&&(w.resourceTiming=b.resourceTiming[this.id]),this.fire(new s.Event("data",w)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(y,h){const p=y.actor?"reloadTile":"loadTile";y.actor=this.actor,y.request=this.actor.send(p,{type:this.type,uid:y.uid,tileID:y.tileID,tileZoom:y.tileZoom,zoom:y.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(b,w)=>(delete y.request,y.unloadVectorData(),y.aborted?h(null):b?h(b):(y.loadVectorData(w,this.map.painter,p==="reloadTile"),h(null))),void 0,p==="loadTile")}abortTile(y){y.request&&(y.request.cancel(),delete y.request),y.aborted=!0}unloadTile(y){y.unloadVectorData(),this.actor.send("removeTile",{uid:y.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends We{constructor(y,h,p,b){super(y,h,p,b),this.roundZoom=!0,this.type="video",this.options=h}load(){this._loaded=!1;const y=this.options;this.urls=[];for(const h of y.urls)this.urls.push(this.map._requestManager.transformRequest(h,s.ResourceType.Source).url);s.getVideo(this.urls,(h,p)=>{this._loaded=!0,h?this.fire(new s.ErrorEvent(h)):p&&(this.video=p,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(y){if(this.video){const h=this.video.seekable;y<h.start(0)||y>h.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${h.start(0)} and ${h.end(0)}-second mark.`))):this.video.currentTime=y}}getVideo(){return this.video}onAdd(y){this.map||(this.map=y,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const y=this.map.painter.context,h=y.gl;this.texture?this.video.paused||(this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),h.texSubImage2D(h.TEXTURE_2D,0,0,0,h.RGBA,h.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(y,this.video,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(y)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:We,canvas:class extends We{constructor(y,h,p,b){super(y,h,p,b),h.coordinates?Array.isArray(h.coordinates)&&h.coordinates.length===4&&!h.coordinates.some(w=>!Array.isArray(w)||w.length!==2||w.some(C=>typeof C!="number"))||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${y}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${y}`,null,'missing required property "coordinates"'))),h.animate&&typeof h.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${y}`,null,'optional "animate" property must be a boolean value'))),h.canvas?typeof h.canvas=="string"||h.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${y}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${y}`,null,'missing required property "canvas"'))),this.options=h,this.animate=h.animate===void 0||h.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(y){this.map=y,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let y=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,y=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,y=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const h=this.map.painter.context;this.texture?(y||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(h,this.canvas,h.gl.RGBA,{premultiply:!0}),this._prepareData(h)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const y of[this.canvas.width,this.canvas.height])if(isNaN(y)||y<=0)return!0;return!1}},custom:class extends s.Evented{constructor(y,h,p,b){super(),this.id=y,this.type="custom",this._dataType="raster",this._dispatcher=p,this._implementation=h,this.setEventedParent(b),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ct(this._implementation.bounds,this.minzoom,this.maxzoom)),h.update=this._update.bind(this),h.clearTiles=this._clearTiles.bind(this),h.coveringTiles=this._coveringTiles.bind(this),s.extend(this,s.pick(h,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(y){this._map=y,this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(y),this.load()}onRemove(y){this._implementation.onRemove&&this._implementation.onRemove(y)}hasTile(y){if(this._implementation.hasTile){const{x:h,y:p,z:b}=y.canonical;return this._implementation.hasTile({x:h,y:p,z:b})}return!this.tileBounds||this.tileBounds.contains(y.canonical)}loadTile(y,h){const{x:p,y:b,z:w}=y.tileID.canonical,C=new s.window.AbortController;y.request=Promise.resolve(this._implementation.loadTile({x:p,y:b,z:w},{signal:C.signal})).then(function(P){return delete y.request,y.aborted?(y.state="unloaded",h(null)):P===void 0?(y.state="errored",h(null)):P===null?(this.loadTileData(y,{width:this.tileSize,height:this.tileSize,data:null}),y.state="loaded",h(null)):function(k){return k instanceof s.window.ImageData||k instanceof s.window.HTMLCanvasElement||k instanceof s.window.ImageBitmap||k instanceof s.window.HTMLImageElement}(P)?(this.loadTileData(y,P),y.state="loaded",void h(null)):(y.state="errored",h(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch(P=>{P.code!==20&&(y.state="errored",h(P))}),y.request.cancel=()=>C.abort()}loadTileData(y,h){re.loadTileData(y,h,this._map.painter)}unloadTileData(y){re.unloadTileData(y,this._map.painter)}unloadTile(y,h){if(this.unloadTileData(y),this._implementation.unloadTile){const{x:p,y:b,z:w}=y.tileID.canonical;this._implementation.unloadTile({x:p,y:b,z:w})}h()}abortTile(y,h){y.request&&y.request.cancel&&(y.request.cancel(),delete y.request),h()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(y=>({x:y.canonical.x,y:y.canonical.y,z:y.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}}},ot=function(y,h,p,b){const w=new ut[h.type](y,h,p,b);if(w.id!==y)throw new Error(`Expected Source id to be ${y} instead of ${w.id}`);return s.bindAll(["load","abort","unload","serialize","prepare"],w),w};function Je(y,h){const p=s.identity([]);return s.scale(p,p,[.5*y.width,.5*-y.height,1]),s.translate(p,p,[1,-1,0]),s.multiply(p,p,y.calculateProjMatrix(h.toUnwrapped())),Float32Array.from(p)}function pe(y,h,p,b,w,C,P,k=!1){const G=y.tilesIn(b,P,k);G.sort(be);const W=[];for(const ne of G)W.push({wrappedTileID:ne.tile.tileID.wrapped().key,queryResults:ne.tile.queryRenderedFeatures(h,p,y._state,ne,w,C,Je(y.transform,ne.tile.tileID),k)});const X=function(ne){const ce={},ye={};for(const _e of ne){const ve=_e.queryResults,xe=_e.wrappedTileID,se=ye[xe]=ye[xe]||{};for(const Le in ve){const Ae=ve[Le],Re=se[Le]=se[Le]||{},Xe=ce[Le]=ce[Le]||[];for(const je of Ae)Re[je.featureIndex]||(Re[je.featureIndex]=!0,Xe.push(je))}}return ce}(W);for(const ne in X)X[ne].forEach(ce=>{const ye=ce.feature,_e=ye.layer;_e&&_e.type!=="background"&&_e.type!=="sky"&&(ye.source=_e.source,_e["source-layer"]&&(ye.sourceLayer=_e["source-layer"]),ye.state=ye.id!==void 0?y.getFeatureState(_e["source-layer"],ye.id):{})});return X}function nt(y,h){const p=y.getRenderableIds().map(C=>y.getTileByID(C)),b=[],w={};for(let C=0;C<p.length;C++){const P=p[C],k=P.tileID.canonical.key;w[k]||(w[k]=!0,P.querySourceFeatures(b,h))}return b}function be(y,h){const p=y.tileID,b=h.tileID;return p.overscaledZ-b.overscaledZ||p.canonical.y-b.canonical.y||p.wrap-b.wrap||p.canonical.x-b.canonical.x}function Ot(){return tf.workerClass!=null?new tf.workerClass:new s.window.Worker(tf.workerUrl)}const On="mapboxgl_preloaded_worker_pool";class ii{constructor(){this.active={}}acquire(h){if(!this.workers)for(this.workers=[];this.workers.length<ii.workerCount;)this.workers.push(new Ot);return this.active[h]=!0,this.workers.slice()}release(h){delete this.active[h],this.numActive()===0&&(this.workers.forEach(p=>{p.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[On]}numActive(){return Object.keys(this.active).length}}let ei;function Ye(){return ei||(ei=new ii),ei}function Qn(y,h){const p={};for(const b in y)b!=="ref"&&(p[b]=y[b]);return s.refProperties.forEach(b=>{b in h&&(p[b]=h[b])}),p}function xr(y){y=y.slice();const h=Object.create(null);for(let p=0;p<y.length;p++)h[y[p].id]=y[p];for(let p=0;p<y.length;p++)"ref"in y[p]&&(y[p]=Qn(y[p],h[y[p].ref]));return y}ii.workerCount=2;const Ti={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function mr(y,h,p){p.push({command:Ti.addSource,args:[y,h[y]]})}function yr(y,h,p){h.push({command:Ti.removeSource,args:[y]}),p[y]=!0}function Gl(y,h,p,b){yr(y,p,b),mr(y,h,p)}function fa(y,h,p){let b;for(b in y[p])if(y[p].hasOwnProperty(b)&&b!=="data"&&!d(y[p][b],h[p][b]))return!1;for(b in h[p])if(h[p].hasOwnProperty(b)&&b!=="data"&&!d(y[p][b],h[p][b]))return!1;return!0}function Rt(y,h,p,b,w,C){let P;for(P in h=h||{},y=y||{})y.hasOwnProperty(P)&&(d(y[P],h[P])||p.push({command:C,args:[b,P,h[P],w]}));for(P in h)h.hasOwnProperty(P)&&!y.hasOwnProperty(P)&&(d(y[P],h[P])||p.push({command:C,args:[b,P,h[P],w]}))}function Hl(y){return y.id}function Ys(y,h){return y[h.id]=h,y}class dc{constructor(h,p){this.reset(h,p)}reset(h,p){this.points=h||[],this._distances=[0];for(let b=1;b<this.points.length;b++)this._distances[b]=this._distances[b-1]+this.points[b].dist(this.points[b-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(p||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(h){if(this.points.length===1)return this.points[0];h=s.clamp(h,0,1);let p=1,b=this._distances[p];const w=h*this.paddedLength+this.padding;for(;b<w&&p<this._distances.length;)b=this._distances[++p];const C=p-1,P=this._distances[C],k=b-P,G=k>0?(w-P)/k:0;return this.points[C].mult(1-G).add(this.points[p].mult(G))}}class xm{constructor(h,p,b){const w=this.boxCells=[],C=this.circleCells=[];this.xCellCount=Math.ceil(h/b),this.yCellCount=Math.ceil(p/b);for(let P=0;P<this.xCellCount*this.yCellCount;P++)w.push([]),C.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=h,this.height=p,this.xScale=this.xCellCount/h,this.yScale=this.yCellCount/p,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(h,p,b,w,C){this._forEachCell(p,b,w,C,this._insertBoxCell,this.boxUid++),this.boxKeys.push(h),this.bboxes.push(p),this.bboxes.push(b),this.bboxes.push(w),this.bboxes.push(C)}insertCircle(h,p,b,w){this._forEachCell(p-w,b-w,p+w,b+w,this._insertCircleCell,this.circleUid++),this.circleKeys.push(h),this.circles.push(p),this.circles.push(b),this.circles.push(w)}_insertBoxCell(h,p,b,w,C,P){this.boxCells[C].push(P)}_insertCircleCell(h,p,b,w,C,P){this.circleCells[C].push(P)}_query(h,p,b,w,C,P){if(b<0||h>this.width||w<0||p>this.height)return!C&&[];const k=[];if(h<=0&&p<=0&&this.width<=b&&this.height<=w){if(C)return!0;for(let G=0;G<this.boxKeys.length;G++)k.push({key:this.boxKeys[G],x1:this.bboxes[4*G],y1:this.bboxes[4*G+1],x2:this.bboxes[4*G+2],y2:this.bboxes[4*G+3]});for(let G=0;G<this.circleKeys.length;G++){const W=this.circles[3*G],X=this.circles[3*G+1],ne=this.circles[3*G+2];k.push({key:this.circleKeys[G],x1:W-ne,y1:X-ne,x2:W+ne,y2:X+ne})}return P?k.filter(P):k}return this._forEachCell(h,p,b,w,this._queryCell,k,{hitTest:C,seenUids:{box:{},circle:{}}},P),C?k.length>0:k}_queryCircle(h,p,b,w,C){const P=h-b,k=h+b,G=p-b,W=p+b;if(k<0||P>this.width||W<0||G>this.height)return!w&&[];const X=[];return this._forEachCell(P,G,k,W,this._queryCellCircle,X,{hitTest:w,circle:{x:h,y:p,radius:b},seenUids:{box:{},circle:{}}},C),w?X.length>0:X}query(h,p,b,w,C){return this._query(h,p,b,w,!1,C)}hitTest(h,p,b,w,C){return this._query(h,p,b,w,!0,C)}hitTestCircle(h,p,b,w){return this._queryCircle(h,p,b,!0,w)}_queryCell(h,p,b,w,C,P,k,G){const W=k.seenUids,X=this.boxCells[C];if(X!==null){const ce=this.bboxes;for(const ye of X)if(!W.box[ye]){W.box[ye]=!0;const _e=4*ye;if(h<=ce[_e+2]&&p<=ce[_e+3]&&b>=ce[_e+0]&&w>=ce[_e+1]&&(!G||G(this.boxKeys[ye]))){if(k.hitTest)return P.push(!0),!0;P.push({key:this.boxKeys[ye],x1:ce[_e],y1:ce[_e+1],x2:ce[_e+2],y2:ce[_e+3]})}}}const ne=this.circleCells[C];if(ne!==null){const ce=this.circles;for(const ye of ne)if(!W.circle[ye]){W.circle[ye]=!0;const _e=3*ye;if(this._circleAndRectCollide(ce[_e],ce[_e+1],ce[_e+2],h,p,b,w)&&(!G||G(this.circleKeys[ye]))){if(k.hitTest)return P.push(!0),!0;{const ve=ce[_e],xe=ce[_e+1],se=ce[_e+2];P.push({key:this.circleKeys[ye],x1:ve-se,y1:xe-se,x2:ve+se,y2:xe+se})}}}}}_queryCellCircle(h,p,b,w,C,P,k,G){const W=k.circle,X=k.seenUids,ne=this.boxCells[C];if(ne!==null){const ye=this.bboxes;for(const _e of ne)if(!X.box[_e]){X.box[_e]=!0;const ve=4*_e;if(this._circleAndRectCollide(W.x,W.y,W.radius,ye[ve+0],ye[ve+1],ye[ve+2],ye[ve+3])&&(!G||G(this.boxKeys[_e])))return P.push(!0),!0}}const ce=this.circleCells[C];if(ce!==null){const ye=this.circles;for(const _e of ce)if(!X.circle[_e]){X.circle[_e]=!0;const ve=3*_e;if(this._circlesCollide(ye[ve],ye[ve+1],ye[ve+2],W.x,W.y,W.radius)&&(!G||G(this.circleKeys[_e])))return P.push(!0),!0}}}_forEachCell(h,p,b,w,C,P,k,G){const W=this._convertToXCellCoord(h),X=this._convertToYCellCoord(p),ne=this._convertToXCellCoord(b),ce=this._convertToYCellCoord(w);for(let ye=W;ye<=ne;ye++)for(let _e=X;_e<=ce;_e++)if(C.call(this,h,p,b,w,this.xCellCount*_e+ye,P,k,G))return}_convertToXCellCoord(h){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(h*this.xScale)))}_convertToYCellCoord(h){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(h*this.yScale)))}_circlesCollide(h,p,b,w,C,P){const k=w-h,G=C-p,W=b+P;return W*W>k*k+G*G}_circleAndRectCollide(h,p,b,w,C,P,k){const G=(P-w)/2,W=Math.abs(h-(w+G));if(W>G+b)return!1;const X=(k-C)/2,ne=Math.abs(p-(C+X));if(ne>X+b)return!1;if(W<=G||ne<=X)return!0;const ce=W-G,ye=ne-X;return ce*ce+ye*ye<=b*b}}const jl=Math.tan(85*Math.PI/180);function Pu(y,h,p,b,w,C,P){const k=s.create();if(p)if(C.name==="globe"){const G=s.calculateGlobeLabelMatrix(w,h);s.multiply(k,k,G)}else{const G=De([],P);k[0]=G[0],k[1]=G[1],k[4]=G[2],k[5]=G[3],b||s.rotateZ(k,k,w.angle)}else s.multiply(k,w.labelPlaneMatrix,y);return k}function Ip(y,h,p,b,w,C,P){const k=Pu(y,h,p,b,w,C,P);return C.name==="globe"&&p||(k[2]=k[6]=k[10]=k[14]=0),k}function pc(y,h,p,b,w,C,P){if(p){if(C.name==="globe"){const k=Pu(y,h,p,b,w,C,P);return s.invert(k,k),s.multiply(k,y,k),k}{const k=s.clone(y),G=s.identity([]);return G[0]=P[0],G[1]=P[1],G[4]=P[2],G[5]=P[3],s.multiply(k,k,G),b||s.rotateZ(k,k,-w.angle),k}}return w.glCoordMatrix}function An(y,h,p,b){const w=[y,h,p,1];p?s.transformMat4$1(w,w,b):_n(w,w,b);const C=w[3];return w[0]/=C,w[1]/=C,w[2]/=C,w}function hr(y,h){return Math.min(.5+y/h*.5,1.5)}function pr(y,h){const p=y[0]/y[3],b=y[1]/y[3];return p>=-h[0]&&p<=h[0]&&b>=-h[1]&&b<=h[1]}function Pa(y,h,p,b,w,C,P,k,G,W){const X=p.transform,ne=b?y.textSizeData:y.iconSizeData,ce=s.evaluateSizeForZoom(ne,p.transform.zoom),ye=X.projection.name==="globe",_e=[256/p.width*2+1,256/p.height*2+1],ve=b?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;ve.clear();let xe=null;ye&&(xe=b?y.text.globeExtVertexArray:y.icon.globeExtVertexArray);const se=y.lineVertexArray,Le=b?y.text.placedSymbolArray:y.icon.placedSymbolArray,Ae=p.transform.width/p.transform.height;let Re,Xe=!1;for(let je=0;je<Le.length;je++){const Ke=Le.get(je),{numGlyphs:ft,writingMode:dt}=Ke;if(dt!==s.WritingMode.vertical||Xe||Re===s.WritingMode.horizontal||(Xe=!0),Re=dt,(Ke.hidden||dt===s.WritingMode.vertical)&&!Xe){st(ft,ve);continue}Xe=!1;const xt=new s.pointGeometry(Ke.tileAnchorX,Ke.tileAnchorY);let{x:Tn,y:gt,z:Zt}=X.projection.projectTilePoint(xt.x,xt.y,W.canonical);if(G){const[ur,$n,Hn]=G(xt);Tn+=ur,gt+=$n,Zt+=Hn}const St=[Tn,gt,Zt,1];if(s.transformMat4$1(St,St,h),!pr(St,_e)){st(ft,ve);continue}const un=hr(p.transform.cameraToCenterDistance,St[3]),yt=s.evaluateSizeForFeature(ne,ce,Ke),ht=P?yt/un:yt*un,Tt=An(Tn,gt,Zt,w);if(Tt[3]<=0){st(ft,ve);continue}let en={};const ln=P?null:G,ci=ue(Ke,ht,!1,k,h,w,C,y.glyphOffsetArray,se,ve,xe,Tt,xt,en,Ae,ln,X.projection,W,P);Xe=ci.useVertical,ln&&ci.needsFlipping&&(en={}),(ci.notEnoughRoom||Xe||ci.needsFlipping&&ue(Ke,ht,!0,k,h,w,C,y.glyphOffsetArray,se,ve,xe,Tt,xt,en,Ae,ln,X.projection,W,P).notEnoughRoom)&&st(ft,ve)}b?(y.text.dynamicLayoutVertexBuffer.updateData(ve),xe&&y.text.globeExtVertexBuffer.updateData(xe)):(y.icon.dynamicLayoutVertexBuffer.updateData(ve),xe&&y.icon.globeExtVertexBuffer.updateData(xe))}function O(y,h,p,b,w,C,P,k,G,W,X,ne,ce,ye,_e,ve){const{lineStartIndex:xe,glyphStartIndex:se,segment:Le}=k,Ae=se+k.numGlyphs,Re=xe+k.lineLength,Xe=h.getoffsetX(se),je=h.getoffsetX(Ae-1),Ke=Qe(y*Xe,p,b,w,C,P,Le,xe,Re,G,W,X,ne,ce,!0,ye,_e,ve);if(!Ke)return null;const ft=Qe(y*je,p,b,w,C,P,Le,xe,Re,G,W,X,ne,ce,!0,ye,_e,ve);return ft?{first:Ke,last:ft}:null}function j(y,h,p,b){return y===s.WritingMode.horizontal&&Math.abs(b)>Math.abs(p)?{useVertical:!0}:y===s.WritingMode.vertical?b>0?{needsFlipping:!0}:null:h!==0&&function(w,C){return w===0||Math.abs(C/w)>jl}(p,b)?h===1?{needsFlipping:!0}:null:p<0?{needsFlipping:!0}:null}function ue(y,h,p,b,w,C,P,k,G,W,X,ne,ce,ye,_e,ve,xe,se,Le){const Ae=h/24,Re=y.lineOffsetX*Ae,Xe=y.lineOffsetY*Ae,{lineStartIndex:je,glyphStartIndex:Ke,numGlyphs:ft,segment:dt,writingMode:xt,flipState:Tn}=y,gt=je+y.lineLength,Zt=St=>{if(X){const[Tt,en,ln]=St.up,ci=W.length;s.updateGlobeVertexNormal(X,ci+0,Tt,en,ln),s.updateGlobeVertexNormal(X,ci+1,Tt,en,ln),s.updateGlobeVertexNormal(X,ci+2,Tt,en,ln),s.updateGlobeVertexNormal(X,ci+3,Tt,en,ln)}const[un,yt,ht]=St.point;s.addDynamicAttributes(W,un,yt,ht,St.angle)};if(ft>1){const St=O(Ae,k,Re,Xe,p,ne,ce,y,G,C,ye,ve,!1,xe,se,Le);if(!St)return{notEnoughRoom:!0};if(b&&!p){let[un,yt,ht]=St.first.point,[Tt,en,ln]=St.last.point;[un,yt]=An(un,yt,ht,P),[Tt,en]=An(Tt,en,ln,P);const ci=j(xt,Tn,(Tt-un)*_e,en-yt);if(y.flipState=ci&&ci.needsFlipping?1:2,ci)return ci}Zt(St.first);for(let un=Ke+1;un<Ke+ft-1;un++){const yt=Qe(Ae*k.getoffsetX(un),Re,Xe,p,ne,ce,dt,je,gt,G,C,ye,ve,!1,!1,xe,se,Le);if(!yt)return W.length-=4*(un-Ke),{notEnoughRoom:!0};Zt(yt)}Zt(St.last)}else{if(b&&!p){const un=An(ce.x,ce.y,0,w),yt=je+dt+1,ht=new s.pointGeometry(G.getx(yt),G.gety(yt)),Tt=An(ht.x,ht.y,0,w),en=Tt[3]>0?Tt:et(ce,ht,un,1,w,void 0,xe,se.canonical),ln=j(xt,Tn,(en[0]-un[0])*_e,en[1]-un[1]);if(y.flipState=ln&&ln.needsFlipping?1:2,ln)return ln}const St=Qe(Ae*k.getoffsetX(Ke),Re,Xe,p,ne,ce,dt,je,gt,G,C,ye,ve,!1,!1,xe,se,Le);if(!St)return{notEnoughRoom:!0};Zt(St)}return{}}function Fe(y,h,p,b,w){const{x:C,y:P,z:k}=b.projectTilePoint(y.x,y.y,h);if(!w)return An(C,P,k,p);const[G,W,X]=w(y);return An(C+G,P+W,k+X,p)}function et(y,h,p,b,w,C,P,k){const G=Fe(y.sub(h)._unit()._add(y),k,w,P,C);return s.sub(G,p,G),s.normalize(G,G),s.scaleAndAdd(G,p,G,b)}function Qe(y,h,p,b,w,C,P,k,G,W,X,ne,ce,ye,_e,ve,xe,se){const Le=b?y-h:y+h;let Ae=Le>0?1:-1,Re=0;b&&(Ae*=-1,Re=Math.PI),Ae<0&&(Re+=Math.PI);let Xe=k+P+(Ae>0?0:1)|0,je=w,Ke=w,ft=0,dt=0;const xt=Math.abs(Le),Tn=[],gt=[];let Zt=C,St=Zt;const un=()=>et(St,Zt,Ke,xt-ft+1,X,ce,ve,xe.canonical);for(;ft+dt<=xt;){if(Xe+=Ae,Xe<k||Xe>=G)return null;if(Ke=je,St=Zt,Tn.push(Ke),ye&&gt.push(St),Zt=new s.pointGeometry(W.getx(Xe),W.gety(Xe)),je=ne[Xe],!je){const Hn=Fe(Zt,xe.canonical,X,ve,ce);je=Hn[3]>0?ne[Xe]=Hn:un()}ft+=dt,dt=s.distance(Ke,je)}_e&&ce&&(ne[Xe]&&(je=un(),dt=s.distance(Ke,je)),ne[Xe]=je);const yt=(xt-ft)/dt,ht=Zt.sub(St)._mult(yt)._add(St),Tt=s.sub([],je,Ke),en=s.scaleAndAdd([],Ke,Tt,yt);let ln=[0,0,1],ci=Tt[0],ur=Tt[1];if(se&&(ln=ve.upVector(xe.canonical,ht.x,ht.y),ln[0]!==0||ln[1]!==0||ln[2]!==1)){const Hn=[ln[2],0,-ln[0]],di=s.cross([],ln,Hn);s.normalize(Hn,Hn),s.normalize(di,di),ci=s.dot(Tt,Hn),ur=s.dot(Tt,di)}if(p){const Hn=s.cross([],ln,Tt);s.normalize(Hn,Hn),s.scaleAndAdd(en,en,Hn,p*Ae)}const $n=Re+Math.atan2(ur,ci);return Tn.push(en),ye&&gt.push(ht),{point:en,angle:$n,path:Tn,tilePath:gt,up:ln}}function st(y,h){const p=h.length,b=p+4*y;h.resize(b),h.float32.fill(-1/0,4*p,4*b)}function _n(y,h,p){const b=h[0],w=h[1];return y[0]=p[0]*b+p[4]*w+p[12],y[1]=p[1]*b+p[5]*w+p[13],y[3]=p[3]*b+p[7]*w+p[15],y}const mn=100;class Wn{constructor(h,p,b=new xm(h.width+200,h.height+200,25),w=new xm(h.width+200,h.height+200,25)){this.transform=h,this.grid=b,this.ignoredGrid=w,this.pitchfactor=Math.cos(h._pitch)*h.cameraToCenterDistance,this.screenRightBoundary=h.width+mn,this.screenBottomBoundary=h.height+mn,this.gridRightBoundary=h.width+200,this.gridBottomBoundary=h.height+200,this.fogState=p}placeCollisionBox(h,p,b,w,C,P,k,G){let W=b.projectedAnchorX,X=b.projectedAnchorY,ne=b.projectedAnchorZ;const ce=b.elevation,ye=b.tileID,_e=h.getProjection();if(ce&&ye){const[je,Ke,ft]=_e.upVector(ye.canonical,b.tileAnchorX,b.tileAnchorY),dt=_e.upVectorScale(ye.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;W+=je*ce*dt,X+=Ke*ce*dt,ne+=ft*ce*dt}const ve=this.projectAndGetPerspectiveRatio(k,W,X,ne,b.tileID,_e.name==="globe"||!!ce||this.transform.pitch>0,_e),xe=P*ve.perspectiveRatio,se=(b.x1*p+w.x-b.padding)*xe+ve.point.x,Le=(b.y1*p+w.y-b.padding)*xe+ve.point.y,Ae=(b.x2*p+w.x+b.padding)*xe+ve.point.x,Re=(b.y2*p+w.y+b.padding)*xe+ve.point.y,Xe=ve.perspectiveRatio<=.55||ve.occluded;return!this.isInsideGrid(se,Le,Ae,Re)||!C&&this.grid.hitTest(se,Le,Ae,Re,G)||Xe?{box:[],offscreen:!1,occluded:ve.occluded}:{box:[se,Le,Ae,Re],offscreen:this.isOffscreen(se,Le,Ae,Re),occluded:!1}}placeCollisionCircles(h,p,b,w,C,P,k,G,W,X,ne,ce,ye,_e,ve){const xe=[],se=this.transform.elevation,Le=h.getProjection(),Ae=se?se.getAtTileOffsetFunc(ve,this.transform.center.lat,this.transform.worldSize,Le):null,Re=new s.pointGeometry(b.tileAnchorX,b.tileAnchorY);let{x:Xe,y:je,z:Ke}=Le.projectTilePoint(Re.x,Re.y,ve.canonical);if(Ae){const[ht,Tt,en]=Ae(Re);Xe+=ht,je+=Tt,Ke+=en}const ft=Le.name==="globe",dt=this.projectAndGetPerspectiveRatio(k,Xe,je,Ke,ve,ft||!!se||this.transform.pitch>0,Le),{perspectiveRatio:xt}=dt,Tn=(ne?P/xt:P*xt)/s.ONE_EM,gt=An(Xe,je,Ke,G),Zt=dt.signedDistanceFromCamera>0?O(Tn,C,b.lineOffsetX*Tn,b.lineOffsetY*Tn,!1,gt,Re,b,w,G,{},se&&!ne?Ae:null,ne&&!!se,Le,ve,ne):null;let St=!1,un=!1,yt=!0;if(Zt&&!dt.occluded){const ht=.5*ye*xt+_e,Tt=new s.pointGeometry(-100,-100),en=new s.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),ln=new dc,{first:ci,last:ur}=Zt,$n=ci.path.length;let Hn=[];for(let bi=$n-1;bi>=1;bi--)Hn.push(ci.path[bi]);for(let bi=1;bi<ur.path.length;bi++)Hn.push(ur.path[bi]);const di=2.5*ht;W&&(Hn=Hn.map(([bi,Wr,$r],xs)=>(Ae&&!ft&&($r=Ae(xs<$n-1?ci.tilePath[$n-1-xs]:ur.tilePath[xs-$n+2])[2]),An(bi,Wr,$r,W))),Hn.some(bi=>bi[3]<=0)&&(Hn=[]));let vr=[];if(Hn.length>0){let bi=1/0,Wr=-1/0,$r=1/0,xs=-1/0;for(const ss of Hn)bi=Math.min(bi,ss[0]),$r=Math.min($r,ss[1]),Wr=Math.max(Wr,ss[0]),xs=Math.max(xs,ss[1]);Wr>=Tt.x&&bi<=en.x&&xs>=Tt.y&&$r<=en.y&&(vr=[Hn.map(ss=>new s.pointGeometry(ss[0],ss[1]))],(bi<Tt.x||Wr>en.x||$r<Tt.y||xs>en.y)&&(vr=s.clipLine(vr,Tt.x,Tt.y,en.x,en.y)))}for(const bi of vr){ln.reset(bi,.25*ht);let Wr=0;Wr=ln.length<=.5*ht?1:Math.ceil(ln.paddedLength/di)+1;for(let $r=0;$r<Wr;$r++){const xs=$r/Math.max(Wr-1,1),ss=ln.lerp(xs),xo=ss.x+mn,sl=ss.y+mn;xe.push(xo,sl,ht,0);const du=xo-ht,pu=sl-ht,Ps=xo+ht,cs=sl+ht;if(yt=yt&&this.isOffscreen(du,pu,Ps,cs),un=un||this.isInsideGrid(du,pu,Ps,cs),!p&&this.grid.hitTestCircle(xo,sl,ht,ce)&&(St=!0,!X))return{circles:[],offscreen:!1,collisionDetected:St,occluded:!1}}}}return{circles:!X&&St||!un?[]:xe,offscreen:yt,collisionDetected:St,occluded:dt.occluded}}queryRenderedSymbols(h){if(h.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const p=[];let b=1/0,w=1/0,C=-1/0,P=-1/0;for(const X of h){const ne=new s.pointGeometry(X.x+mn,X.y+mn);b=Math.min(b,ne.x),w=Math.min(w,ne.y),C=Math.max(C,ne.x),P=Math.max(P,ne.y),p.push(ne)}const k=this.grid.query(b,w,C,P).concat(this.ignoredGrid.query(b,w,C,P)),G={},W={};for(const X of k){const ne=X.key;if(G[ne.bucketInstanceId]===void 0&&(G[ne.bucketInstanceId]={}),G[ne.bucketInstanceId][ne.featureIndex])continue;const ce=[new s.pointGeometry(X.x1,X.y1),new s.pointGeometry(X.x2,X.y1),new s.pointGeometry(X.x2,X.y2),new s.pointGeometry(X.x1,X.y2)];s.polygonIntersectsPolygon(p,ce)&&(G[ne.bucketInstanceId][ne.featureIndex]=!0,W[ne.bucketInstanceId]===void 0&&(W[ne.bucketInstanceId]=[]),W[ne.bucketInstanceId].push(ne.featureIndex))}return W}insertCollisionBox(h,p,b,w,C){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:b,featureIndex:w,collisionGroupID:C},h[0],h[1],h[2],h[3])}insertCollisionCircles(h,p,b,w,C){const P=p?this.ignoredGrid:this.grid,k={bucketInstanceId:b,featureIndex:w,collisionGroupID:C};for(let G=0;G<h.length;G+=4)P.insertCircle(k,h[G],h[G+1],h[G+2])}projectAndGetPerspectiveRatio(h,p,b,w,C,P,k){const G=[p,b,w,1];let W=!1;if(w||this.transform.pitch>0){s.transformMat4$1(G,G,h);const ne=k.name==="globe";this.fogState&&C&&!ne&&(W=function(ye,_e,ve,xe,se,Le){const Ae=Le.calculateFogTileMatrix(se),Re=[_e,ve,xe];return s.transformMat4(Re,Re,Ae),at(ye,Re,Le.pitch,Le._fov)}(this.fogState,p,b,w,C.toUnwrapped(),this.transform)>.9)}else _n(G,G,h);const X=G[3];return{point:new s.pointGeometry((G[0]/X+1)/2*this.transform.width+mn,(-G[1]/X+1)/2*this.transform.height+mn),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(k)/X*.5,1.5),signedDistanceFromCamera:X,occluded:P&&G[2]>X||W}}isOffscreen(h,p,b,w){return b<mn||h>=this.screenRightBoundary||w<mn||p>this.screenBottomBoundary}isInsideGrid(h,p,b,w){return b>=0&&h<this.gridRightBoundary&&w>=0&&p<this.gridBottomBoundary}getViewportMatrix(){const h=s.identity([]);return s.translate(h,h,[-100,-100,0]),h}}function Pn(y,h,p){const b=h.createTileMatrix(y,y.worldSize,p.toUnwrapped());return s.multiply(new Float32Array(16),y.projMatrix,b)}function Fn(y,h,p){if(h.projection.name===p.projection.name)return y.projMatrix;const b=p.clone();return b.setProjection(h.projection),Pn(b,h.getProjection(),y)}function Fi(y,h,p){return h.name===p.projection.name?y.projMatrix:Pn(p,h,y)}class vs{constructor(h,p,b,w){this.opacity=h?Math.max(0,Math.min(1,h.opacity+(h.placed?p:-p))):w&&b?1:0,this.placed=b}isHidden(){return this.opacity===0&&!this.placed}}class zi{constructor(h,p,b,w,C,P=!1){this.text=new vs(h?h.text:null,p,b,C),this.icon=new vs(h?h.icon:null,p,w,C),this.clipped=P}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Cs{constructor(h,p,b,w=!1){this.text=h,this.icon=p,this.skipFade=b,this.clipped=w}}class nn{constructor(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]}}class Kn{constructor(h,p,b,w,C){this.bucketInstanceId=h,this.featureIndex=p,this.sourceLayerIndex=b,this.bucketIndex=w,this.tileID=C}}class qi{constructor(h){this.crossSourceCollisions=h,this.maxGroupID=0,this.collisionGroups={}}get(h){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[h]){const p=++this.maxGroupID;this.collisionGroups[h]={ID:p,predicate:b=>b.collisionGroupID===p}}return this.collisionGroups[h]}}function oo(y,h,p,b,w){const{horizontalAlign:C,verticalAlign:P}=s.getAnchorAlignment(y),k=-(C-.5)*h,G=-(P-.5)*p,W=s.evaluateVariableOffset(y,b);return new s.pointGeometry(k+W[0]*w,G+W[1]*w)}function Fs(y,h,p,b,w){const C=new s.pointGeometry(y,h);return p&&C._rotate(b?w:-w),C}class Zo{constructor(h,p,b,w,C){this.transform=h.clone(),this.projection=h.projection.name,this.collisionIndex=new Wn(this.transform,C),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new qi(b),this.collisionCircleArrays={},this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(h,p,b,w){const C=b.getBucket(p),P=b.latestFeatureIndex;if(!C||!P||p.id!==C.layerIds[0])return;const k=C.layers[0].layout,G=b.collisionBoxArray,W=Math.pow(2,this.transform.zoom-b.tileID.overscaledZ),X=b.tileSize/s.EXTENT,ne=b.tileID.toUnwrapped();this.transform.setProjection(C.projection);const ce=(ye=b.tileID,_e=C.getProjection(),ve=this.transform,_e.name===this.projection?ve.calculateProjMatrix(ye.toUnwrapped()):Pn(ve,_e,ye));var ye,_e,ve;const xe=k.get("text-pitch-alignment")==="map",se=k.get("text-rotation-alignment")==="map";p.compileFilter();const Le=p.dynamicFilter(),Ae=p.dynamicFilterNeedsFeature(),Re=this.transform.calculatePixelsToTileUnitsMatrix(b),Xe=Ip(ce,b.tileID.canonical,xe,se,this.transform,C.getProjection(),Re);let je=null;if(xe){const dt=pc(ce,b.tileID.canonical,xe,se,this.transform,C.getProjection(),Re);je=s.multiply([],this.transform.labelPlaneMatrix,dt)}let Ke=null;Le&&b.latestFeatureIndex&&(Ke={unwrappedTileID:ne,dynamicFilter:Le,dynamicFilterNeedsFeature:Ae,featureIndex:b.latestFeatureIndex}),this.retainedQueryData[C.bucketInstanceId]=new Kn(C.bucketInstanceId,P,C.sourceLayerIndex,C.index,b.tileID);const ft={bucket:C,layout:k,posMatrix:ce,textLabelPlaneMatrix:Xe,labelToScreenMatrix:je,clippingData:Ke,scale:W,textPixelRatio:X,holdingForFade:b.holdingForFade(),collisionBoxArray:G,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(C.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:s.evaluateSizeForZoom(C.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(C.sourceID)};if(w)for(const dt of C.sortKeyRanges){const{sortKey:xt,symbolInstanceStart:Tn,symbolInstanceEnd:gt}=dt;h.push({sortKey:xt,symbolInstanceStart:Tn,symbolInstanceEnd:gt,parameters:ft})}else h.push({symbolInstanceStart:0,symbolInstanceEnd:C.symbolInstances.length,parameters:ft})}attemptAnchorPlacement(h,p,b,w,C,P,k,G,W,X,ne,ce,ye,_e,ve,xe,se,Le){const{textOffset0:Ae,textOffset1:Re,crossTileID:Xe}=ce,je=[Ae,Re],Ke=oo(h,b,w,je,C),ft=this.collisionIndex.placeCollisionBox(_e,C,p,Fs(Ke.x,Ke.y,P,k,this.transform.angle),ne,G,W,X.predicate);if(xe){const dt=_e.getSymbolInstanceIconSize(Le,this.transform.zoom,ce.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(_e,dt,xe,Fs(Ke.x,Ke.y,P,k,this.transform.angle),ne,G,W,X.predicate).box.length===0)return}if(ft.box.length>0){let dt;return this.prevPlacement&&this.prevPlacement.variableOffsets[Xe]&&this.prevPlacement.placements[Xe]&&this.prevPlacement.placements[Xe].text&&(dt=this.prevPlacement.variableOffsets[Xe].anchor),this.variableOffsets[Xe]={textOffset:je,width:b,height:w,anchor:h,textScale:C,prevAnchor:dt},this.markUsedJustification(_e,h,ce,ve),_e.allowVerticalPlacement&&(this.markUsedOrientation(_e,ve,ce),this.placedOrientations[Xe]=ve),{shift:Ke,placedGlyphBoxes:ft}}}placeLayerBucketPart(h,p,b,w){const{bucket:C,layout:P,posMatrix:k,textLabelPlaneMatrix:G,labelToScreenMatrix:W,clippingData:X,textPixelRatio:ne,holdingForFade:ce,collisionBoxArray:ye,partiallyEvaluatedTextSize:_e,partiallyEvaluatedIconSize:ve,collisionGroup:xe}=h.parameters,se=P.get("text-optional"),Le=P.get("icon-optional"),Ae=P.get("text-allow-overlap"),Re=P.get("icon-allow-overlap"),Xe=P.get("text-rotation-alignment")==="map",je=P.get("text-pitch-alignment")==="map",Ke=P.get("icon-text-fit")!=="none",ft=P.get("symbol-z-order")==="viewport-y";this.transform.setProjection(C.projection);let dt=Ae&&(Re||!C.hasIconData()||Le),xt=Re&&(Ae||!C.hasTextData()||se);!C.collisionArrays&&ye&&C.deserializeCollisionBoxes(ye),b&&w&&C.updateCollisionDebugBuffers(this.transform.zoom,ye);const Tn=(gt,Zt,St)=>{const{crossTileID:un,numVerticalGlyphVertices:yt}=gt;if(X){const Ps={zoom:this.transform.zoom,pitch:this.transform.pitch};let cs=null;if(X.dynamicFilterNeedsFeature){const Nr=this.retainedQueryData[C.bucketInstanceId];cs=X.featureIndex.loadFeature({featureIndex:gt.featureIndex,bucketIndex:Nr.bucketIndex,sourceLayerIndex:Nr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,X.dynamicFilter)(Ps,cs,this.retainedQueryData[C.bucketInstanceId].tileID.canonical,new s.pointGeometry(gt.tileAnchorX,gt.tileAnchorY),this.transform.calculateDistanceTileData(X.unwrappedTileID)))return this.placements[un]=new Cs(!1,!1,!1,!0),void(p[un]=!0)}if(p[un])return;if(ce)return void(this.placements[un]=new Cs(!1,!1,!1));let ht=!1,Tt=!1,en=!0,ln=!1,ci=!1,ur=null,$n={box:null,offscreen:null,occluded:null},Hn={box:null,offscreen:null,occluded:null},di=null,vr=null,bi=null,Wr=0,$r=0,xs=0;St.textFeatureIndex?Wr=St.textFeatureIndex:gt.useRuntimeCollisionCircles&&(Wr=gt.featureIndex),St.verticalTextFeatureIndex&&($r=St.verticalTextFeatureIndex);const ss=Ps=>{Ps.tileID=this.retainedQueryData[C.bucketInstanceId].tileID;const cs=this.transform.elevation;(cs||Ps.elevation)&&(Ps.elevation=cs?cs.getAtTileOffset(Ps.tileID,Ps.tileAnchorX,Ps.tileAnchorY):0)},xo=St.textBox;if(xo){ss(xo);const Ps=Nr=>{let lo=s.WritingMode.horizontal;if(C.allowVerticalPlacement&&!Nr&&this.prevPlacement){const ga=this.prevPlacement.placedOrientations[un];ga&&(this.placedOrientations[un]=ga,lo=ga,this.markUsedOrientation(C,lo,gt))}return lo},cs=(Nr,lo)=>{if(C.allowVerticalPlacement&&yt>0&&St.verticalTextBox){for(const ga of C.writingModes)if(ga===s.WritingMode.vertical?($n=lo(),Hn=$n):$n=Nr(),$n&&$n.box&&$n.box.length)break}else $n=Nr()};if(P.get("text-variable-anchor")){let Nr=P.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[un]){const Ms=this.prevPlacement.variableOffsets[un];Nr.indexOf(Ms.anchor)>0&&(Nr=Nr.filter(la=>la!==Ms.anchor),Nr.unshift(Ms.anchor))}const lo=(Ms,la,_a)=>{const Cc=C.getSymbolInstanceTextSize(_e,gt,this.transform.zoom,Zt),Ud=(Ms.x2-Ms.x1)*Cc+2*Ms.padding,ol=(Ms.y2-Ms.y1)*Cc+2*Ms.padding,Ki=Ke&&!Re?la:null;Ki&&ss(Ki);let ah={box:[],offscreen:!1,occluded:!1};const nf=Ae?2*Nr.length:Nr.length;for(let mu=0;mu<nf;++mu){const Kf=this.attemptAnchorPlacement(Nr[mu%Nr.length],Ms,Ud,ol,Cc,Xe,je,ne,k,xe,mu>=Nr.length,gt,Zt,C,_a,Ki,_e,ve);if(Kf&&(ah=Kf.placedGlyphBoxes,ah&&ah.box&&ah.box.length)){ht=!0,ur=Kf.shift;break}}return ah};cs(()=>lo(xo,St.iconBox,s.WritingMode.horizontal),()=>{const Ms=St.verticalTextBox;return Ms&&ss(Ms),C.allowVerticalPlacement&&!($n&&$n.box&&$n.box.length)&&yt>0&&Ms?lo(Ms,St.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),$n&&(ht=$n.box,en=$n.offscreen,ln=$n.occluded);const ga=Ps($n&&$n.box);if(!ht&&this.prevPlacement){const Ms=this.prevPlacement.variableOffsets[un];Ms&&(this.variableOffsets[un]=Ms,this.markUsedJustification(C,Ms.anchor,gt,ga))}}else{const Nr=(lo,ga)=>{const Ms=C.getSymbolInstanceTextSize(_e,gt,this.transform.zoom,Zt),la=this.collisionIndex.placeCollisionBox(C,Ms,lo,new s.pointGeometry(0,0),Ae,ne,k,xe.predicate);return la&&la.box&&la.box.length&&(this.markUsedOrientation(C,ga,gt),this.placedOrientations[un]=ga),la};cs(()=>Nr(xo,s.WritingMode.horizontal),()=>{const lo=St.verticalTextBox;return C.allowVerticalPlacement&&yt>0&&lo?(ss(lo),Nr(lo,s.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Ps($n&&$n.box&&$n.box.length)}}if(di=$n,ht=di&&di.box&&di.box.length>0,en=di&&di.offscreen,ln=di&&di.occluded,gt.useRuntimeCollisionCircles){const Ps=C.text.placedSymbolArray.get(gt.centerJustifiedTextSymbolIndex>=0?gt.centerJustifiedTextSymbolIndex:gt.verticalPlacedTextSymbolIndex),cs=s.evaluateSizeForFeature(C.textSizeData,_e,Ps),Nr=P.get("text-padding");vr=this.collisionIndex.placeCollisionCircles(C,Ae,Ps,C.lineVertexArray,C.glyphOffsetArray,cs,k,G,W,b,je,xe.predicate,gt.collisionCircleDiameter*cs/s.ONE_EM,Nr,this.retainedQueryData[C.bucketInstanceId].tileID),ht=Ae||vr.circles.length>0&&!vr.collisionDetected,en=en&&vr.offscreen,ln=vr.occluded}if(St.iconFeatureIndex&&(xs=St.iconFeatureIndex),St.iconBox){const Ps=cs=>{ss(cs);const Nr=Ke&&ur?Fs(ur.x,ur.y,Xe,je,this.transform.angle):new s.pointGeometry(0,0),lo=C.getSymbolInstanceIconSize(ve,this.transform.zoom,gt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(C,lo,cs,Nr,Re,ne,k,xe.predicate)};Hn&&Hn.box&&Hn.box.length&&St.verticalIconBox?(bi=Ps(St.verticalIconBox),Tt=bi.box.length>0):(bi=Ps(St.iconBox),Tt=bi.box.length>0),en=en&&bi.offscreen,ci=bi.occluded}const sl=se||gt.numHorizontalGlyphVertices===0&&yt===0,du=Le||gt.numIconVertices===0;if(sl||du?du?sl||(Tt=Tt&&ht):ht=Tt&&ht:Tt=ht=Tt&&ht,ht&&di&&di.box&&this.collisionIndex.insertCollisionBox(di.box,P.get("text-ignore-placement"),C.bucketInstanceId,Hn&&Hn.box&&$r?$r:Wr,xe.ID),Tt&&bi&&this.collisionIndex.insertCollisionBox(bi.box,P.get("icon-ignore-placement"),C.bucketInstanceId,xs,xe.ID),vr&&(ht&&this.collisionIndex.insertCollisionCircles(vr.circles,P.get("text-ignore-placement"),C.bucketInstanceId,Wr,xe.ID),b)){const Ps=C.bucketInstanceId;let cs=this.collisionCircleArrays[Ps];cs===void 0&&(cs=this.collisionCircleArrays[Ps]=new nn);for(let Nr=0;Nr<vr.circles.length;Nr+=4)cs.circles.push(vr.circles[Nr+0]),cs.circles.push(vr.circles[Nr+1]),cs.circles.push(vr.circles[Nr+2]),cs.circles.push(vr.collisionDetected?1:0)}const pu=C.projection.name!=="globe";dt=dt&&(pu||!ln),xt=xt&&(pu||!ci),this.placements[un]=new Cs(ht||dt,Tt||xt,en||C.justReloaded),p[un]=!0};if(ft){const gt=C.getSortedSymbolIndexes(this.transform.angle);for(let Zt=gt.length-1;Zt>=0;--Zt){const St=gt[Zt];Tn(C.symbolInstances.get(St),St,C.collisionArrays[St])}}else for(let gt=h.symbolInstanceStart;gt<h.symbolInstanceEnd;gt++)Tn(C.symbolInstances.get(gt),gt,C.collisionArrays[gt]);if(b&&C.bucketInstanceId in this.collisionCircleArrays){const gt=this.collisionCircleArrays[C.bucketInstanceId];s.invert(gt.invProjMatrix,k),gt.viewportMatrix=this.collisionIndex.getViewportMatrix()}C.justReloaded=!1}markUsedJustification(h,p,b,w){const{leftJustifiedTextSymbolIndex:C,centerJustifiedTextSymbolIndex:P,rightJustifiedTextSymbolIndex:k,verticalPlacedTextSymbolIndex:G,crossTileID:W}=b,X=s.getAnchorJustification(p),ne=w===s.WritingMode.vertical?G:X==="left"?C:X==="center"?P:X==="right"?k:-1;C>=0&&(h.text.placedSymbolArray.get(C).crossTileID=ne>=0&&C!==ne?0:W),P>=0&&(h.text.placedSymbolArray.get(P).crossTileID=ne>=0&&P!==ne?0:W),k>=0&&(h.text.placedSymbolArray.get(k).crossTileID=ne>=0&&k!==ne?0:W),G>=0&&(h.text.placedSymbolArray.get(G).crossTileID=ne>=0&&G!==ne?0:W)}markUsedOrientation(h,p,b){const w=p===s.WritingMode.horizontal||p===s.WritingMode.horizontalOnly?p:0,C=p===s.WritingMode.vertical?p:0,{leftJustifiedTextSymbolIndex:P,centerJustifiedTextSymbolIndex:k,rightJustifiedTextSymbolIndex:G,verticalPlacedTextSymbolIndex:W}=b,X=h.text.placedSymbolArray;P>=0&&(X.get(P).placedOrientation=w),k>=0&&(X.get(k).placedOrientation=w),G>=0&&(X.get(G).placedOrientation=w),W>=0&&(X.get(W).placedOrientation=C)}commit(h){this.commitTime=h,this.zoomAtLastRecencyCheck=this.transform.zoom;const p=this.prevPlacement;let b=!1;this.prevZoomAdjustment=p?p.zoomAdjustment(this.transform.zoom):0;const w=p?p.symbolFadeChange(h):1,C=p?p.opacities:{},P=p?p.variableOffsets:{},k=p?p.placedOrientations:{};for(const G in this.placements){const W=this.placements[G],X=C[G];X?(this.opacities[G]=new zi(X,w,W.text,W.icon,null,W.clipped),b=b||W.text!==X.text.placed||W.icon!==X.icon.placed):(this.opacities[G]=new zi(null,w,W.text,W.icon,W.skipFade,W.clipped),b=b||W.text||W.icon)}for(const G in C){const W=C[G];if(!this.opacities[G]){const X=new zi(W,w,!1,!1);X.isHidden()||(this.opacities[G]=X,b=b||W.text.placed||W.icon.placed)}}for(const G in P)this.variableOffsets[G]||!this.opacities[G]||this.opacities[G].isHidden()||(this.variableOffsets[G]=P[G]);for(const G in k)this.placedOrientations[G]||!this.opacities[G]||this.opacities[G].isHidden()||(this.placedOrientations[G]=k[G]);b?this.lastPlacementChangeTime=h:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=p?p.lastPlacementChangeTime:h)}updateLayerOpacities(h,p){const b={};for(const w of p){const C=w.getBucket(h);C&&w.latestFeatureIndex&&h.id===C.layerIds[0]&&this.updateBucketOpacities(C,b,w.collisionBoxArray)}}updateBucketOpacities(h,p,b){h.hasTextData()&&h.text.opacityVertexArray.clear(),h.hasIconData()&&h.icon.opacityVertexArray.clear(),h.hasIconCollisionBoxData()&&h.iconCollisionBox.collisionVertexArray.clear(),h.hasTextCollisionBoxData()&&h.textCollisionBox.collisionVertexArray.clear();const w=h.layers[0].layout,C=!!h.layers[0].dynamicFilter(),P=new zi(null,0,!1,!1,!0),k=w.get("text-allow-overlap"),G=w.get("icon-allow-overlap"),W=w.get("text-variable-anchor"),X=w.get("text-rotation-alignment")==="map",ne=w.get("text-pitch-alignment")==="map",ce=w.get("icon-text-fit")!=="none",ye=new zi(null,0,k&&(G||!h.hasIconData()||w.get("icon-optional")),G&&(k||!h.hasTextData()||w.get("text-optional")),!0);!h.collisionArrays&&b&&(h.hasIconCollisionBoxData()||h.hasTextCollisionBoxData())&&h.deserializeCollisionBoxes(b);const _e=(xe,se,Le)=>{for(let Ae=0;Ae<se/4;Ae++)xe.opacityVertexArray.emplaceBack(Le)};let ve=0;for(let xe=0;xe<h.symbolInstances.length;xe++){const se=h.symbolInstances.get(xe),{numHorizontalGlyphVertices:Le,numVerticalGlyphVertices:Ae,crossTileID:Re,numIconVertices:Xe}=se;let je=this.opacities[Re];p[Re]?je=P:je||(je=ye,this.opacities[Re]=je),p[Re]=!0;const Ke=Le>0||Ae>0,ft=Xe>0,dt=this.placedOrientations[Re],xt=dt===s.WritingMode.vertical,Tn=dt===s.WritingMode.horizontal||dt===s.WritingMode.horizontalOnly;if(!Ke&&!ft||je.isHidden()||ve++,Ke){const gt=Fh(je.text);_e(h.text,Le,xt?Qc:gt),_e(h.text,Ae,Tn?Qc:gt);const Zt=je.text.isHidden(),{leftJustifiedTextSymbolIndex:St,centerJustifiedTextSymbolIndex:un,rightJustifiedTextSymbolIndex:yt,verticalPlacedTextSymbolIndex:ht}=se,Tt=h.text.placedSymbolArray,en=Zt||xt?1:0;St>=0&&(Tt.get(St).hidden=en),un>=0&&(Tt.get(un).hidden=en),yt>=0&&(Tt.get(yt).hidden=en),ht>=0&&(Tt.get(ht).hidden=Zt||Tn?1:0);const ln=this.variableOffsets[Re];ln&&this.markUsedJustification(h,ln.anchor,se,dt);const ci=this.placedOrientations[Re];ci&&(this.markUsedJustification(h,"left",se,ci),this.markUsedOrientation(h,ci,se))}if(ft){const gt=Fh(je.icon),{placedIconSymbolIndex:Zt,verticalPlacedIconSymbolIndex:St}=se,un=h.icon.placedSymbolArray,yt=je.icon.isHidden()?1:0;Zt>=0&&(_e(h.icon,Xe,xt?Qc:gt),un.get(Zt).hidden=yt),St>=0&&(_e(h.icon,se.numVerticalIconVertices,Tn?Qc:gt),un.get(St).hidden=yt)}if(h.hasIconCollisionBoxData()||h.hasTextCollisionBoxData()){const gt=h.collisionArrays[xe];if(gt){let Zt=new s.pointGeometry(0,0),St=!0;if(gt.textBox||gt.verticalTextBox){if(W){const yt=this.variableOffsets[Re];yt?(Zt=oo(yt.anchor,yt.width,yt.height,yt.textOffset,yt.textScale),X&&Zt._rotate(ne?this.transform.angle:-this.transform.angle)):St=!1}C&&(St=!je.clipped),gt.textBox&&da(h.textCollisionBox.collisionVertexArray,je.text.placed,!St||xt,Zt.x,Zt.y),gt.verticalTextBox&&da(h.textCollisionBox.collisionVertexArray,je.text.placed,!St||Tn,Zt.x,Zt.y)}const un=St&&!!(!Tn&&gt.verticalIconBox);gt.iconBox&&da(h.iconCollisionBox.collisionVertexArray,je.icon.placed,un,ce?Zt.x:0,ce?Zt.y:0),gt.verticalIconBox&&da(h.iconCollisionBox.collisionVertexArray,je.icon.placed,!un,ce?Zt.x:0,ce?Zt.y:0)}}}if(h.fullyClipped=ve===0,h.sortFeatures(this.transform.angle),this.retainedQueryData[h.bucketInstanceId]&&(this.retainedQueryData[h.bucketInstanceId].featureSortOrder=h.featureSortOrder),h.hasTextData()&&h.text.opacityVertexBuffer&&h.text.opacityVertexBuffer.updateData(h.text.opacityVertexArray),h.hasIconData()&&h.icon.opacityVertexBuffer&&h.icon.opacityVertexBuffer.updateData(h.icon.opacityVertexArray),h.hasIconCollisionBoxData()&&h.iconCollisionBox.collisionVertexBuffer&&h.iconCollisionBox.collisionVertexBuffer.updateData(h.iconCollisionBox.collisionVertexArray),h.hasTextCollisionBoxData()&&h.textCollisionBox.collisionVertexBuffer&&h.textCollisionBox.collisionVertexBuffer.updateData(h.textCollisionBox.collisionVertexArray),h.bucketInstanceId in this.collisionCircleArrays){const xe=this.collisionCircleArrays[h.bucketInstanceId];h.placementInvProjMatrix=xe.invProjMatrix,h.placementViewportMatrix=xe.viewportMatrix,h.collisionCircleArray=xe.circles,delete this.collisionCircleArrays[h.bucketInstanceId]}}symbolFadeChange(h){return this.fadeDuration===0?1:(h-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(h){return Math.max(0,(this.transform.zoom-h)/1.5)}hasTransitions(h){return this.stale||h-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(h,p){const b=this.zoomAtLastRecencyCheck===p?1-this.zoomAdjustment(p):1;return this.zoomAtLastRecencyCheck=p,this.commitTime+this.fadeDuration*b>h}setStale(){this.stale=!0}}function da(y,h,p,b,w){y.emplaceBack(h?1:0,p?1:0,b||0,w||0),y.emplaceBack(h?1:0,p?1:0,b||0,w||0),y.emplaceBack(h?1:0,p?1:0,b||0,w||0),y.emplaceBack(h?1:0,p?1:0,b||0,w||0)}const As=Math.pow(2,25),Bf=Math.pow(2,24),_o=Math.pow(2,17),pa=Math.pow(2,16),Cd=Math.pow(2,9),kh=Math.pow(2,8),ko=Math.pow(2,1);function Fh(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const h=y.placed?1:0,p=Math.floor(127*y.opacity);return p*As+h*Bf+p*_o+h*pa+p*Cd+h*kh+p*ko+h}const Qc=0;class Vr{constructor(h){this._sortAcrossTiles=h.layout.get("symbol-z-order")!=="viewport-y"&&h.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(h,p,b,w,C){const P=this._bucketParts;for(;this._currentTileIndex<h.length;)if(p.getBucketParts(P,w,h[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,C())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort((k,G)=>k.sortKey-G.sortKey));this._currentPartIndex<P.length;){const k=P[this._currentPartIndex];if(p.placeLayerBucketPart(k,this._seenCrossTileIDs,b,k.symbolInstanceStart===0),this._currentPartIndex++,C())return!0}return!1}}class rs{constructor(h,p,b,w,C,P,k,G){this.placement=new Zo(h,C,P,k,G),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=b,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(h,p,b){const w=s.exported.now(),C=()=>{const P=s.exported.now()-w;return!this._forceFullPlacement&&P>2};for(;this._currentPlacementIndex>=0;){const P=p[h[this._currentPlacementIndex]],k=this.placement.collisionIndex.transform.zoom;if(P.type==="symbol"&&(!P.minzoom||P.minzoom<=k)&&(!P.maxzoom||P.maxzoom>k)){if(this._inProgressLayer||(this._inProgressLayer=new Vr(P)),this._inProgressLayer.continuePlacement(b[P.source],this.placement,this._showCollisionBoxes,P,C))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(h){return this.placement.commit(h),this.placement}}const Ad=512/s.EXTENT/2;class wg{constructor(h,p,b){this.tileID=h,this.indexedSymbolInstances={},this.bucketInstanceId=b;for(let w=0;w<p.length;w++){const C=p.get(w),P=C.key;this.indexedSymbolInstances[P]||(this.indexedSymbolInstances[P]=[]),this.indexedSymbolInstances[P].push({crossTileID:C.crossTileID,coord:this.getScaledCoordinates(C,h)})}}getScaledCoordinates(h,p){const b=Ad/Math.pow(2,p.canonical.z-this.tileID.canonical.z);return{x:Math.floor((p.canonical.x*s.EXTENT+h.tileAnchorX)*b),y:Math.floor((p.canonical.y*s.EXTENT+h.tileAnchorY)*b)}}findMatches(h,p,b){const w=this.tileID.canonical.z<p.canonical.z?1:Math.pow(2,this.tileID.canonical.z-p.canonical.z);for(let C=0;C<h.length;C++){const P=h.get(C);if(P.crossTileID)continue;const k=this.indexedSymbolInstances[P.key];if(!k)continue;const G=this.getScaledCoordinates(P,p);for(const W of k)if(Math.abs(W.coord.x-G.x)<=w&&Math.abs(W.coord.y-G.y)<=w&&!b[W.crossTileID]){b[W.crossTileID]=!0,P.crossTileID=W.crossTileID;break}}}}class Md{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class $c{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(h){const p=Math.round((h-this.lng)/360);if(p!==0)for(const b in this.indexes){const w=this.indexes[b],C={};for(const P in w){const k=w[P];k.tileID=k.tileID.unwrapTo(k.tileID.wrap+p),C[k.tileID.key]=k}this.indexes[b]=C}this.lng=h}addBucket(h,p,b){if(this.indexes[h.overscaledZ]&&this.indexes[h.overscaledZ][h.key]){if(this.indexes[h.overscaledZ][h.key].bucketInstanceId===p.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(h.overscaledZ,this.indexes[h.overscaledZ][h.key])}for(let C=0;C<p.symbolInstances.length;C++)p.symbolInstances.get(C).crossTileID=0;this.usedCrossTileIDs[h.overscaledZ]||(this.usedCrossTileIDs[h.overscaledZ]={});const w=this.usedCrossTileIDs[h.overscaledZ];for(const C in this.indexes){const P=this.indexes[C];if(Number(C)>h.overscaledZ)for(const k in P){const G=P[k];G.tileID.isChildOf(h)&&G.findMatches(p.symbolInstances,h,w)}else{const k=P[h.scaledTo(Number(C)).key];k&&k.findMatches(p.symbolInstances,h,w)}}for(let C=0;C<p.symbolInstances.length;C++){const P=p.symbolInstances.get(C);P.crossTileID||(P.crossTileID=b.generate(),w[P.crossTileID]=!0)}return this.indexes[h.overscaledZ]===void 0&&(this.indexes[h.overscaledZ]={}),this.indexes[h.overscaledZ][h.key]=new wg(h,p.symbolInstances,p.bucketInstanceId),!0}removeBucketCrossTileIDs(h,p){for(const b in p.indexedSymbolInstances)for(const w of p.indexedSymbolInstances[b])delete this.usedCrossTileIDs[h][w.crossTileID]}removeStaleBuckets(h){let p=!1;for(const b in this.indexes){const w=this.indexes[b];for(const C in w)h[w[C].bucketInstanceId]||(this.removeBucketCrossTileIDs(b,w[C]),delete w[C],p=!0)}return p}}class Tp{constructor(){this.layerIndexes={},this.crossTileIDs=new Md,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(h,p,b,w){let C=this.layerIndexes[h.id];C===void 0&&(C=this.layerIndexes[h.id]=new $c);let P=!1;const k={};w.name!=="globe"&&C.handleWrapJump(b);for(const G of p){const W=G.getBucket(h);W&&h.id===W.layerIds[0]&&(W.bucketInstanceId||(W.bucketInstanceId=++this.maxBucketInstanceId),C.addBucket(G.tileID,W,this.crossTileIDs)&&(P=!0),k[W.bucketInstanceId]=!0)}return C.removeStaleBuckets(k)&&(P=!0),P}pruneUnusedLayers(h){const p={};h.forEach(b=>{p[b]=!0});for(const b in this.layerIndexes)p[b]||delete this.layerIndexes[b]}}const zf=(y,h)=>s.emitValidationErrors(y,h&&h.filter(p=>p.identifier!=="source.canvas")),eh=s.pick(Ti,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),ql=s.pick(Ti,["setCenter","setZoom","setBearing","setPitch"]),Ks={version:8,layers:[],sources:{}},Wl={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class bs extends s.Evented{constructor(h,p={}){super(),this.map=h,this.dispatcher=new Gt(Ye(),this),this.imageManager=new le,this.imageManager.setEventedParent(this),this.glyphManager=new s.GlyphManager(h._requestManager,p.localFontFamily?s.LocalGlyphMode.all:p.localIdeographFontFamily?s.LocalGlyphMode.ideographs:s.LocalGlyphMode.none,p.localFontFamily||p.localIdeographFontFamily),this.crossTileSymbolIndex=new Tp,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());const b=this;this._rtlTextPluginCallback=bs.registerForPluginStateChange(w=>{b.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:w.pluginStatus,pluginURL:w.pluginURL},(C,P)=>{if(s.triggerPluginCompletionEvent(C),P&&P.every(k=>k))for(const k in b._sourceCaches){const G=b._sourceCaches[k],W=G.getSource().type;W!=="vector"&&W!=="geojson"||G.reload()}})}),this.on("data",w=>{if(w.dataType!=="source"||w.sourceDataType!=="metadata")return;const C=this.getSource(w.sourceId);if(C&&C.vectorLayerIds)for(const P in this._layers){const k=this._layers[P];k.source===C.id&&this._validateLayer(k)}})}loadURL(h,p={}){this.fire(new s.Event("dataloading",{dataType:"style"}));const b=typeof p.validate=="boolean"?p.validate:!s.isMapboxURL(h);h=this.map._requestManager.normalizeStyleURL(h,p.accessToken);const w=this.map._requestManager.transformRequest(h,s.ResourceType.Style);this._request=s.getJSON(w,(C,P)=>{this._request=null,C?this.fire(new s.ErrorEvent(C)):P&&this._load(P,b)})}loadJSON(h,p={}){this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.exported.frame(()=>{this._request=null,this._load(h,p.validate!==!1)})}loadEmpty(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(Ks,!1)}_updateLayerCount(h,p){const b=p?1:-1;h.is3D()&&(this._num3DLayers+=b),h.type==="circle"&&(this._numCircleLayers+=b),h.type==="symbol"&&(this._numSymbolLayers+=b)}_load(h,p){if(p&&zf(this,s.validateStyle(h)))return;this._loaded=!0,this.stylesheet=s.clone$1(h),this._updateMapProjection();for(const w in h.sources)this.addSource(w,h.sources[w],{validate:!1});this._changed=!1,h.sprite?this._loadSprite(h.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(h.glyphs);const b=xr(this.stylesheet.layers);this._order=b.map(w=>w.id),this._layers={},this._serializedLayers={};for(let w of b)w=s.createStyleLayer(w),w.setEventedParent(this,{layer:{id:w.id}}),this._layers[w.id]=w,this._serializedLayers[w.id]=w.serialize(),this._updateLayerCount(w,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ce(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(h){h?this.stylesheet.projection=h:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(h){this._spriteRequest=function(p,b,w){let C,P,k;const G=s.exported.devicePixelRatio>1?"@2x":"";let W=s.getJSON(b.transformRequest(b.normalizeSpriteURL(p,G,".json"),s.ResourceType.SpriteJSON),(ce,ye)=>{W=null,k||(k=ce,C=ye,ne())}),X=s.getImage(b.transformRequest(b.normalizeSpriteURL(p,G,".png"),s.ResourceType.SpriteImage),(ce,ye)=>{X=null,k||(k=ce,P=ye,ne())});function ne(){if(k)w(k);else if(C&&P){const ce=s.exported.getImageData(P),ye={};for(const _e in C){const{width:ve,height:xe,x:se,y:Le,sdf:Ae,pixelRatio:Re,stretchX:Xe,stretchY:je,content:Ke}=C[_e],ft=new s.RGBAImage({width:ve,height:xe});s.RGBAImage.copy(ce,ft,{x:se,y:Le},{x:0,y:0},{width:ve,height:xe}),ye[_e]={data:ft,pixelRatio:Re,sdf:Ae,stretchX:Xe,stretchY:je,content:Ke}}w(null,ye)}}return{cancel(){W&&(W.cancel(),W=null),X&&(X.cancel(),X=null)}}}(h,this.map._requestManager,(p,b)=>{if(this._spriteRequest=null,p)this.fire(new s.ErrorEvent(p));else if(b)for(const w in b)this.imageManager.addImage(w,b[w]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new s.Event("data",{dataType:"style"}))})}_validateLayer(h){const p=this.getSource(h.source);if(!p)return;const b=h.sourceLayer;b&&(p.type==="geojson"||p.vectorLayerIds&&p.vectorLayerIds.indexOf(b)===-1)&&this.fire(new s.ErrorEvent(new Error(`Source layer "${b}" does not exist on source "${p.id}" as specified by style layer "${h.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const h in this._sourceCaches)if(!this._sourceCaches[h].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(h){const p=[];for(const b of h){const w=this._layers[b];w.type!=="custom"&&p.push(w.serialize())}return p}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const h in this._sourceCaches)if(this._sourceCaches[h].hasTransition())return!0;for(const h in this._layers)if(this._layers[h].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(h){return!!this.terrain&&(typeof h.isLayerDraped=="function"?h.isLayerDraped():Wl[h.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(h){if(!this._loaded)return;const p=this._changed;if(this._changed){const w=Object.keys(this._updatedLayers),C=Object.keys(this._removedLayers);(w.length||C.length)&&this._updateWorkerLayers(w,C);for(const P in this._updatedSources){const k=this._updatedSources[P];k==="reload"?this._reloadSource(P):k==="clear"&&this._clearSource(P)}this._updateTilesForChangedImages();for(const P in this._updatedPaintProps)this._layers[P].updateTransitions(h);this.light.updateTransitions(h),this.fog&&this.fog.updateTransitions(h),this._resetUpdates()}const b={};for(const w in this._sourceCaches){const C=this._sourceCaches[w];b[w]=C.used,C.used=!1}for(const w of this._order){const C=this._layers[w];if(C.recalculate(h,this._availableImages),!C.isHidden(h.zoom)){const k=this._getLayerSourceCache(C);k&&(k.used=!0)}const P=this.map.painter;if(P){const k=C.getProgramIds();if(!k)continue;const G=C.getProgramConfiguration(h.zoom);for(const W of k)P.useProgram(W,G)}}for(const w in b){const C=this._sourceCaches[w];b[w]!==C.used&&C.getSource().fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:C.getSource().id}))}this.light.recalculate(h),this.terrain&&this.terrain.recalculate(h),this.fog&&this.fog.recalculate(h),this.z=h.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),p&&this.fire(new s.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const h=Object.keys(this._changedImages);if(h.length){for(const p in this._sourceCaches)this._sourceCaches[p].reloadTilesForDependencies(["icons","patterns"],h);this._changedImages={}}}_updateWorkerLayers(h,p){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(h),removedIds:p})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(h){if(this._checkLoaded(),zf(this,s.validateStyle(h)))return!1;(h=s.clone$1(h)).layers=xr(h.layers);const p=function(w,C){if(!w)return[{command:Ti.setStyle,args:[C]}];let P=[];try{if(!d(w.version,C.version))return[{command:Ti.setStyle,args:[C]}];d(w.center,C.center)||P.push({command:Ti.setCenter,args:[C.center]}),d(w.zoom,C.zoom)||P.push({command:Ti.setZoom,args:[C.zoom]}),d(w.bearing,C.bearing)||P.push({command:Ti.setBearing,args:[C.bearing]}),d(w.pitch,C.pitch)||P.push({command:Ti.setPitch,args:[C.pitch]}),d(w.sprite,C.sprite)||P.push({command:Ti.setSprite,args:[C.sprite]}),d(w.glyphs,C.glyphs)||P.push({command:Ti.setGlyphs,args:[C.glyphs]}),d(w.transition,C.transition)||P.push({command:Ti.setTransition,args:[C.transition]}),d(w.light,C.light)||P.push({command:Ti.setLight,args:[C.light]}),d(w.fog,C.fog)||P.push({command:Ti.setFog,args:[C.fog]}),d(w.projection,C.projection)||P.push({command:Ti.setProjection,args:[C.projection]});const k={},G=[];(function(ne,ce,ye,_e){let ve;for(ve in ce=ce||{},ne=ne||{})ne.hasOwnProperty(ve)&&(ce.hasOwnProperty(ve)||yr(ve,ye,_e));for(ve in ce)ce.hasOwnProperty(ve)&&(ne.hasOwnProperty(ve)?d(ne[ve],ce[ve])||(ne[ve].type==="geojson"&&ce[ve].type==="geojson"&&fa(ne,ce,ve)?ye.push({command:Ti.setGeoJSONSourceData,args:[ve,ce[ve].data]}):Gl(ve,ce,ye,_e)):mr(ve,ce,ye))})(w.sources,C.sources,G,k);const W=[];w.layers&&w.layers.forEach(ne=>{ne.source&&k[ne.source]?P.push({command:Ti.removeLayer,args:[ne.id]}):W.push(ne)});let X=w.terrain;X&&k[X.source]&&(P.push({command:Ti.setTerrain,args:[void 0]}),X=void 0),P=P.concat(G),d(X,C.terrain)||P.push({command:Ti.setTerrain,args:[C.terrain]}),function(ne,ce,ye){ce=ce||[];const _e=(ne=ne||[]).map(Hl),ve=ce.map(Hl),xe=ne.reduce(Ys,{}),se=ce.reduce(Ys,{}),Le=_e.slice(),Ae=Object.create(null);let Re,Xe,je,Ke,ft,dt,xt;for(Re=0,Xe=0;Re<_e.length;Re++)je=_e[Re],se.hasOwnProperty(je)?Xe++:(ye.push({command:Ti.removeLayer,args:[je]}),Le.splice(Le.indexOf(je,Xe),1));for(Re=0,Xe=0;Re<ve.length;Re++)je=ve[ve.length-1-Re],Le[Le.length-1-Re]!==je&&(xe.hasOwnProperty(je)?(ye.push({command:Ti.removeLayer,args:[je]}),Le.splice(Le.lastIndexOf(je,Le.length-Xe),1)):Xe++,dt=Le[Le.length-Re],ye.push({command:Ti.addLayer,args:[se[je],dt]}),Le.splice(Le.length-Re,0,je),Ae[je]=!0);for(Re=0;Re<ve.length;Re++)if(je=ve[Re],Ke=xe[je],ft=se[je],!Ae[je]&&!d(Ke,ft))if(d(Ke.source,ft.source)&&d(Ke["source-layer"],ft["source-layer"])&&d(Ke.type,ft.type)){for(xt in Rt(Ke.layout,ft.layout,ye,je,null,Ti.setLayoutProperty),Rt(Ke.paint,ft.paint,ye,je,null,Ti.setPaintProperty),d(Ke.filter,ft.filter)||ye.push({command:Ti.setFilter,args:[je,ft.filter]}),d(Ke.minzoom,ft.minzoom)&&d(Ke.maxzoom,ft.maxzoom)||ye.push({command:Ti.setLayerZoomRange,args:[je,ft.minzoom,ft.maxzoom]}),Ke)Ke.hasOwnProperty(xt)&&xt!=="layout"&&xt!=="paint"&&xt!=="filter"&&xt!=="metadata"&&xt!=="minzoom"&&xt!=="maxzoom"&&(xt.indexOf("paint.")===0?Rt(Ke[xt],ft[xt],ye,je,xt.slice(6),Ti.setPaintProperty):d(Ke[xt],ft[xt])||ye.push({command:Ti.setLayerProperty,args:[je,xt,ft[xt]]}));for(xt in ft)ft.hasOwnProperty(xt)&&!Ke.hasOwnProperty(xt)&&xt!=="layout"&&xt!=="paint"&&xt!=="filter"&&xt!=="metadata"&&xt!=="minzoom"&&xt!=="maxzoom"&&(xt.indexOf("paint.")===0?Rt(Ke[xt],ft[xt],ye,je,xt.slice(6),Ti.setPaintProperty):d(Ke[xt],ft[xt])||ye.push({command:Ti.setLayerProperty,args:[je,xt,ft[xt]]}))}else ye.push({command:Ti.removeLayer,args:[je]}),dt=Le[Le.lastIndexOf(je)+1],ye.push({command:Ti.addLayer,args:[ft,dt]})}(W,C.layers,P)}catch(k){console.warn("Unable to compute style diff:",k),P=[{command:Ti.setStyle,args:[C]}]}return P}(this.serialize(),h).filter(w=>!(w.command in ql));if(p.length===0)return!1;const b=p.filter(w=>!(w.command in eh));if(b.length>0)throw new Error(`Unimplemented: ${b.map(w=>w.command).join(", ")}.`);return p.forEach(w=>{w.command!=="setTransition"&&w.command!=="setProjection"&&this[w.command].apply(this,w.args)}),this.stylesheet=h,this._updateMapProjection(),!0}addImage(h,p){return this.getImage(h)?this.fire(new s.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(h,p),this._afterImageUpdated(h),this)}updateImage(h,p){this.imageManager.updateImage(h,p)}getImage(h){return this.imageManager.getImage(h)}removeImage(h){return this.getImage(h)?(this.imageManager.removeImage(h),this._afterImageUpdated(h),this):this.fire(new s.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(h){this._availableImages=this.imageManager.listImages(),this._changedImages[h]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(h,p,b={}){if(this._checkLoaded(),this.getSource(h)!==void 0)throw new Error("There is already a source with this ID");if(!p.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(p).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(p.type)>=0&&this._validate(s.validateSource,`sources.${h}`,p,null,b))return;this.map&&this.map._collectResourceTiming&&(p.collectResourceTiming=!0);const w=ot(h,p,this.dispatcher,this);w.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(h),source:w.serialize(),sourceId:h}));const C=P=>{const k=(P?"symbol:":"other:")+h,G=this._sourceCaches[k]=new s.SourceCache(k,w,P);(P?this._symbolSourceCaches:this._otherSourceCaches)[h]=G,G.style=this,G.onAdd(this.map)};C(!1),p.type!=="vector"&&p.type!=="geojson"||C(!0),w.onAdd&&w.onAdd(this.map),this._changed=!0}removeSource(h){this._checkLoaded();const p=this.getSource(h);if(!p)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===h)return this.fire(new s.ErrorEvent(new Error(`Source "${h}" cannot be removed while layer "${w}" is using it.`)));if(this.terrain&&this.terrain.get().source===h)return this.fire(new s.ErrorEvent(new Error(`Source "${h}" cannot be removed while terrain is using it.`)));const b=this._getSourceCaches(h);for(const w of b)delete this._sourceCaches[w.id],delete this._updatedSources[w.id],w.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:w.getSource().id})),w.setEventedParent(null),w.clearTiles();return delete this._otherSourceCaches[h],delete this._symbolSourceCaches[h],p.setEventedParent(null),p.onRemove&&p.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(h,p){this._checkLoaded(),this.getSource(h).setData(p),this._changed=!0}getSource(h){const p=this._getSourceCache(h);return p&&p.getSource()}_getSources(){const h=[];for(const p in this._otherSourceCaches){const b=this._getSourceCache(p);b&&h.push(b.getSource())}return h}addLayer(h,p,b={}){this._checkLoaded();const w=h.id;if(this.getLayer(w))return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${w}" already exists on this map`)));let C;if(h.type==="custom"){if(zf(this,s.validateCustomStyleLayer(h)))return;C=s.createStyleLayer(h)}else{if(typeof h.source=="object"&&(this.addSource(w,h.source),h=s.clone$1(h),h=s.extend(h,{source:w})),this._validate(s.validateLayer,`layers.${w}`,h,{arrayIndex:-1},b))return;C=s.createStyleLayer(h),this._validateLayer(C),C.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[C.id]=C.serialize(),this._updateLayerCount(C,!0)}const P=p?this._order.indexOf(p):this._order.length;if(p&&P===-1)return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${p}" does not exist on this map.`)));this._order.splice(P,0,w),this._layerOrderChanged=!0,this._layers[w]=C;const k=this._getLayerSourceCache(C);if(this._removedLayers[w]&&C.source&&k&&C.type!=="custom"){const G=this._removedLayers[w];delete this._removedLayers[w],G.type!==C.type?this._updatedSources[C.source]="clear":(this._updatedSources[C.source]="reload",k.pause())}this._updateLayer(C),C.onAdd&&C.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(h,p){if(this._checkLoaded(),this._changed=!0,!this._layers[h])return void this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be moved.`)));if(h===p)return;const b=this._order.indexOf(h);this._order.splice(b,1);const w=p?this._order.indexOf(p):this._order.length;p&&w===-1?this.fire(new s.ErrorEvent(new Error(`Layer with id "${p}" does not exist on this map.`))):(this._order.splice(w,0,h),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(h){this._checkLoaded();const p=this._layers[h];if(!p)return void this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be removed.`)));p.setEventedParent(null),this._updateLayerCount(p,!1);const b=this._order.indexOf(h);this._order.splice(b,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[h]=p,delete this._layers[h],delete this._serializedLayers[h],delete this._updatedLayers[h],delete this._updatedPaintProps[h],p.onRemove&&p.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(h){return this._layers[h]}hasLayer(h){return h in this._layers}hasLayerType(h){for(const p in this._layers)if(this._layers[p].type===h)return!0;return!1}setLayerZoomRange(h,p,b){this._checkLoaded();const w=this.getLayer(h);w?w.minzoom===p&&w.maxzoom===b||(p!=null&&(w.minzoom=p),b!=null&&(w.maxzoom=b),this._updateLayer(w)):this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(h,p,b={}){this._checkLoaded();const w=this.getLayer(h);if(w){if(!d(w.filter,p))return p==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(s.validateFilter,`layers.${w.id}.filter`,p,{layerType:w.type},b)||(w.filter=s.clone$1(p),this._updateLayer(w)))}else this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be filtered.`)))}getFilter(h){const p=this.getLayer(h);return p&&s.clone$1(p.filter)}setLayoutProperty(h,p,b,w={}){this._checkLoaded();const C=this.getLayer(h);C?d(C.getLayoutProperty(p),b)||(C.setLayoutProperty(p,b,w),this._updateLayer(C)):this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(h,p){const b=this.getLayer(h);if(b)return b.getLayoutProperty(p);this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style.`)))}setPaintProperty(h,p,b,w={}){this._checkLoaded();const C=this.getLayer(h);C?d(C.getPaintProperty(p),b)||(C.setPaintProperty(p,b,w)&&this._updateLayer(C),this._changed=!0,this._updatedPaintProps[h]=!0):this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(h,p){const b=this.getLayer(h);return b&&b.getPaintProperty(p)}setFeatureState(h,p){this._checkLoaded();const b=h.source,w=h.sourceLayer,C=this.getSource(b);if(!C)return void this.fire(new s.ErrorEvent(new Error(`The source '${b}' does not exist in the map's style.`)));const P=C.type;if(P==="geojson"&&w)return void this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(P==="vector"&&!w)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));h.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided.")));const k=this._getSourceCaches(b);for(const G of k)G.setFeatureState(w,h.id,p)}removeFeatureState(h,p){this._checkLoaded();const b=h.source,w=this.getSource(b);if(!w)return void this.fire(new s.ErrorEvent(new Error(`The source '${b}' does not exist in the map's style.`)));const C=w.type,P=C==="vector"?h.sourceLayer:void 0;if(C==="vector"&&!P)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(p&&typeof h.id!="string"&&typeof h.id!="number")return void this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const k=this._getSourceCaches(b);for(const G of k)G.removeFeatureState(P,h.id,p)}getFeatureState(h){this._checkLoaded();const p=h.source,b=h.sourceLayer,w=this.getSource(p);if(w){if(w.type!=="vector"||b)return h.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(p)[0].getFeatureState(b,h.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)))}getTransition(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const h={};for(const p in this._sourceCaches){const b=this._sourceCaches[p].getSource();h[b.id]||(h[b.id]=b.serialize())}return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:h,layers:this._serializeLayers(this._order)},p=>p!==void 0)}_updateLayer(h){this._updatedLayers[h.id]=!0;const p=this._getLayerSourceCache(h);h.source&&!this._updatedSources[h.source]&&p&&p.getSource().type!=="raster"&&(this._updatedSources[h.source]="reload",p.pause()),this._changed=!0,h.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(h){const p=P=>this._layers[P].type==="fill-extrusion",b={},w=[];for(let P=this._order.length-1;P>=0;P--){const k=this._order[P];if(p(k)){b[k]=P;for(const G of h){const W=G[k];if(W)for(const X of W)w.push(X)}}}w.sort((P,k)=>k.intersectionZ-P.intersectionZ);const C=[];for(let P=this._order.length-1;P>=0;P--){const k=this._order[P];if(p(k))for(let G=w.length-1;G>=0;G--){const W=w[G].feature;if(b[W.layer.id]<P)break;C.push(W),w.pop()}else for(const G of h){const W=G[k];if(W)for(const X of W)C.push(X.feature)}}return C}queryRenderedFeatures(h,p,b){p&&p.filter&&this._validate(s.validateFilter,"queryRenderedFeatures.filter",p.filter,null,p);const w={};if(p&&p.layers){if(!Array.isArray(p.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const G of p.layers){const W=this._layers[G];if(!W)return this.fire(new s.ErrorEvent(new Error(`The layer '${G}' does not exist in the map's style and cannot be queried for features.`))),[];w[W.source]=!0}}const C=[];p.availableImages=this._availableImages;const P=p&&p.layers?p.layers.some(G=>{const W=this.getLayer(G);return W&&W.is3D()}):this.has3DLayers(),k=vt.createFromScreenPoints(h,b);for(const G in this._sourceCaches){const W=this._sourceCaches[G].getSource().id;p.layers&&!w[W]||C.push(pe(this._sourceCaches[G],this._layers,this._serializedLayers,k,p,b,P,!!this.map._showQueryGeometry))}return this.placement&&C.push(function(G,W,X,ne,ce,ye,_e){const ve={},xe=ye.queryRenderedSymbols(ne),se=[];for(const Le of Object.keys(xe).map(Number))se.push(_e[Le]);se.sort(be);for(const Le of se){const Ae=Le.featureIndex.lookupSymbolFeatures(xe[Le.bucketInstanceId],W,Le.bucketIndex,Le.sourceLayerIndex,ce.filter,ce.layers,ce.availableImages,G);for(const Re in Ae){const Xe=ve[Re]=ve[Re]||[],je=Ae[Re];je.sort((Ke,ft)=>{const dt=Le.featureSortOrder;if(dt){const xt=dt.indexOf(Ke.featureIndex);return dt.indexOf(ft.featureIndex)-xt}return ft.featureIndex-Ke.featureIndex});for(const Ke of je)Xe.push(Ke)}}for(const Le in ve)ve[Le].forEach(Ae=>{const Re=Ae.feature,Xe=X(G[Le]).getFeatureState(Re.layer["source-layer"],Re.id);Re.source=Re.layer.source,Re.layer["source-layer"]&&(Re.sourceLayer=Re.layer["source-layer"]),Re.state=Xe});return ve}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),k.screenGeometry,p,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(C)}querySourceFeatures(h,p){p&&p.filter&&this._validate(s.validateFilter,"querySourceFeatures.filter",p.filter,null,p);const b=this._getSourceCaches(h);let w=[];for(const C of b)w=w.concat(nt(C,p));return w}addSourceType(h,p,b){return bs.getSourceType(h)?b(new Error(`A source type called "${h}" already exists.`)):(bs.setSourceType(h,p),p.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:h,url:p.workerSourceURL},b):b(null,null))}getLight(){return this.light.getLight()}setLight(h,p={}){this._checkLoaded();const b=this.light.getLight();let w=!1;for(const P in h)if(!d(h[P],b[P])){w=!0;break}if(!w)return;const C=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(h,p),this.light.updateTransitions(C)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(h,p=1){if(this._checkLoaded(),!h)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(p===1){if(typeof h.source=="object"){const b="terrain-dem-src";this.addSource(b,h.source),h=s.clone$1(h),h=s.extend(h,{source:b})}if(this._validate(s.validateTerrain,"terrain",h))return}if(!this.terrain||this.terrain&&p!==this.terrain.drapeRenderMode)this._createTerrain(h,p);else{const b=this.terrain,w=b.get();for(const C of Object.keys(s.spec.terrain))!h.hasOwnProperty(C)&&s.spec.terrain[C].default&&(h[C]=s.spec.terrain[C].default);for(const C in h)if(!d(h[C],w[C])){b.set(h),this.stylesheet.terrain=h;const P=this._setTransitionParameters({duration:0});b.updateTransitions(P);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(h){const p=this.fog=new Cn(h,this.map.transform);this.stylesheet.fog=h;const b=this._setTransitionParameters({duration:0});p.updateTransitions(b)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const h of this.map._markers)h._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(h){if(this._checkLoaded(),!h)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const p=this.fog,b=p.get();Object.keys(h).length===0&&p.set(h);for(const w in h)if(!d(h[w],b[w])){p.set(h),this.stylesheet.fog=h;const C=this._setTransitionParameters({duration:0});p.updateTransitions(C);break}}else this._createFog(h);this._markersNeedUpdate=!0}_setTransitionParameters(h){return{now:s.exported.now(),transition:s.extend(h,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const h=this._order.filter(b=>this.isLayerDraped(this._layers[b])),p=this._order.filter(b=>!this.isLayerDraped(this._layers[b]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...h),this._drapedFirstOrder.push(...p)}_createTerrain(h,p){const b=this.terrain=new Ue(h,p);this.stylesheet.terrain=h,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const w=this._setTransitionParameters({duration:0});b.updateTransitions(w)}_force3DLayerUpdate(){for(const h in this._layers){const p=this._layers[h];p.type==="fill-extrusion"&&this._updateLayer(p)}}_forceSymbolLayerUpdate(){for(const h in this._layers){const p=this._layers[h];p.type==="symbol"&&this._updateLayer(p)}}_validate(h,p,b,w,C={}){return(!C||C.validate!==!1)&&zf(this,h.call(s.validateStyle,s.extend({key:p,style:this.serialize(),value:b,styleSpec:s.spec},w)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const h in this._layers)this._layers[h].setEventedParent(null);for(const h in this._sourceCaches)this._sourceCaches[h].clearTiles(),this._sourceCaches[h].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(h){const p=this._getSourceCaches(h);for(const b of p)b.clearTiles()}_reloadSource(h){const p=this._getSourceCaches(h);for(const b of p)b.resume(),b.reload()}_reloadSources(){for(const h of this._getSources())h.reload&&h.reload()}_updateSources(h){for(const p in this._sourceCaches)this._sourceCaches[p].update(h)}_generateCollisionBoxes(){for(const h in this._sourceCaches){const p=this._sourceCaches[h];p.resume(),p.reload()}}_updatePlacement(h,p,b,w,C=!1){let P=!1,k=!1;const G={};for(const W of this._order){const X=this._layers[W];if(X.type!=="symbol")continue;if(!G[X.source]){const ce=this._getLayerSourceCache(X);if(!ce)continue;G[X.source]=ce.getRenderableIds(!0).map(ye=>ce.getTileByID(ye)).sort((ye,_e)=>_e.tileID.overscaledZ-ye.tileID.overscaledZ||(ye.tileID.isLessThan(_e.tileID)?-1:1))}const ne=this.crossTileSymbolIndex.addLayer(X,G[X.source],h.center.lng,h.projection);P=P||ne}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),C=C||this._layerOrderChanged||b===0,this._layerOrderChanged&&this.fire(new s.Event("neworder")),(C||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.exported.now(),h.zoom))&&(this.pauseablePlacement=new rs(h,this._order,C,p,b,w,this.placement,this.fog&&h.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,G),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.exported.now()),k=!0),P&&this.pauseablePlacement.placement.setStale()),k||P)for(const W of this._order){const X=this._layers[W];X.type==="symbol"&&this.placement.updateLayerOpacities(X,G[X.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.exported.now())}_releaseSymbolFadeTiles(){for(const h in this._sourceCaches)this._sourceCaches[h].releaseSymbolFadeTiles()}getImages(h,p,b){this.imageManager.getImages(p.icons,b),this._updateTilesForChangedImages();const w=C=>{C&&C.setDependencies(p.tileID.key,p.type,p.icons)};w(this._otherSourceCaches[p.source]),w(this._symbolSourceCaches[p.source])}getGlyphs(h,p,b){this.glyphManager.getGlyphs(p.stacks,b)}getResource(h,p,b){return s.makeRequest(p,b)}_getSourceCache(h){return this._otherSourceCaches[h]}_getLayerSourceCache(h){return h.type==="symbol"?this._symbolSourceCaches[h.source]:this._otherSourceCaches[h.source]}_getSourceCaches(h){const p=[];return this._otherSourceCaches[h]&&p.push(this._otherSourceCaches[h]),this._symbolSourceCaches[h]&&p.push(this._symbolSourceCaches[h]),p}_isSourceCacheLoaded(h){const p=this._getSourceCaches(h);return p.length===0?(this.fire(new s.ErrorEvent(new Error(`There is no source with ID '${h}'`))),!1):p.every(b=>b.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}bs.getSourceType=function(y){return ut[y]},bs.setSourceType=function(y,h){ut[y]=h},bs.registerForPluginStateChange=s.registerForPluginStateChange;var th=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Uf="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",el=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,Bh=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,zh=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let Vf={},Gf={};const nh=[];Ou(th,nh),Ou(el,nh),Ou(Bh,nh),Ou(zh,nh),Vf=Er("",el),Gf=Er(zh,Bh);const Du=Er(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Yo=th,Ld=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Da={background:Er(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Er(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Er(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Er("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Er(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Er(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Er("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Er("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Er("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Er(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Er(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Er(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Er(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Er(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Er(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Er(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Er(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Er(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Er(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Er(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Er(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Er(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Er(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Er(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Er(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Er(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Uf),skyboxGradient:Er(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Uf),skyboxCapture:Er(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Er(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Er(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function Ou(y,h){const p=y.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let b of p)if(b=b.trim(),b[0]==="#"&&b.includes("if")&&!b.includes("endif")){b=b.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const w=b.split(" ");for(const C of w)h.includes(C)||h.push(C)}}function Er(y,h){const p=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,b=h.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),w={},C=[...nh];return Ou(y,C),Ou(h,C),{fragmentSource:y=y.replace(p,(P,k,G,W,X)=>(w[X]=!0,k==="define"?`
#ifndef HAS_UNIFORM_u_${X}
varying ${G} ${W} ${X};
#else
uniform ${G} ${W} u_${X};
#endif
`:`
#ifdef HAS_UNIFORM_u_${X}
    ${G} ${W} ${X} = u_${X};
#endif
`)),vertexSource:h=h.replace(p,(P,k,G,W,X)=>{const ne=W==="float"?"vec2":"vec4",ce=X.match(/color/)?"color":ne;return w[X]?k==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
attribute ${G} ${ne} a_${X};
varying ${G} ${W} ${X};
#else
uniform ${G} ${W} u_${X};
#endif
`:ce==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = a_${X};
#else
    ${G} ${W} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = unpack_mix_${ce}(a_${X}, u_${X}_t);
#else
    ${G} ${W} ${X} = u_${X};
#endif
`:k==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
attribute ${G} ${ne} a_${X};
#else
uniform ${G} ${W} u_${X};
#endif
`:ce==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${G} ${W} ${X} = a_${X};
#else
    ${G} ${W} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${G} ${W} ${X} = unpack_mix_${ce}(a_${X}, u_${X}_t);
#else
    ${G} ${W} ${X} = u_${X};
#endif
`}),staticAttributes:b,usedDefines:C}}class Oa{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(h,p,b,w,C,P,k){this.context=h;let G=this.boundPaintVertexBuffers.length!==w.length;for(let X=0;!G&&X<w.length;X++)this.boundPaintVertexBuffers[X]!==w[X]&&(G=!0);let W=this.boundDynamicVertexBuffers.length!==k.length;for(let X=0;!W&&X<k.length;X++)this.boundDynamicVertexBuffers[X]!==k[X]&&(W=!0);if(!h.extVertexArrayObject||!this.vao||this.boundProgram!==p||this.boundLayoutVertexBuffer!==b||G||W||this.boundIndexBuffer!==C||this.boundVertexOffset!==P)this.freshBind(p,b,w,C,P,k);else{h.bindVertexArrayOES.set(this.vao);for(const X of k)X&&X.bind();C&&C.dynamicDraw&&C.bind()}}freshBind(h,p,b,w,C,P){let k;const G=h.numAttributes,W=this.context,X=W.gl;if(W.extVertexArrayObject)this.vao&&this.destroy(),this.vao=W.extVertexArrayObject.createVertexArrayOES(),W.bindVertexArrayOES.set(this.vao),k=0,this.boundProgram=h,this.boundLayoutVertexBuffer=p,this.boundPaintVertexBuffers=b,this.boundIndexBuffer=w,this.boundVertexOffset=C,this.boundDynamicVertexBuffers=P;else{k=W.currentNumAttributes||0;for(let ne=G;ne<k;ne++)X.disableVertexAttribArray(ne)}p.enableAttributes(X,h),p.bind(),p.setVertexAttribPointers(X,h,C);for(const ne of b)ne.enableAttributes(X,h),ne.bind(),ne.setVertexAttribPointers(X,h,C);for(const ne of P)ne&&(ne.enableAttributes(X,h),ne.bind(),ne.setVertexAttribPointers(X,h,C));w&&w.bind(),W.currentNumAttributes=G}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function mc(y,h){const p=Math.pow(2,h.canonical.z),b=h.canonical.y;return[new s.MercatorCoordinate(0,b/p).toLngLat().lat,new s.MercatorCoordinate(0,(b+1)/p).toLngLat().lat]}function Nu(y,h,p,b,w,C,P){const k=y.context,G=k.gl,W=p.fbo;if(!W)return;y.prepareDrawTile();const X=y.useProgram("hillshade");k.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,W.colorAttachment.get());const ne=((ve,xe,se,Le)=>{const Ae=se.paint.get("hillshade-shadow-color"),Re=se.paint.get("hillshade-highlight-color"),Xe=se.paint.get("hillshade-accent-color");let je=se.paint.get("hillshade-illumination-direction")*(Math.PI/180);se.paint.get("hillshade-illumination-anchor")==="viewport"&&(je-=ve.transform.angle);const Ke=!ve.options.moving;return{u_matrix:Le||ve.transform.calculateProjMatrix(xe.tileID.toUnwrapped(),Ke),u_image:0,u_latrange:mc(0,xe.tileID),u_light:[se.paint.get("hillshade-exaggeration"),je],u_shadow:Ae,u_highlight:Re,u_accent:Xe}})(y,p,b,y.terrain?h.projMatrix:null);y.prepareDrawProgram(k,X,h.toUnwrapped());const{tileBoundsBuffer:ce,tileBoundsIndexBuffer:ye,tileBoundsSegments:_e}=y.getTileBoundsBuffers(p);X.draw(k,G.TRIANGLES,w,C,P,s.CullFaceMode.disabled,ne,b.id,ce,ye,_e)}function Zr(y,h,p){if(!h.needsDEMTextureUpload)return;const b=y.context,w=b.gl;b.pixelStoreUnpackPremultiplyAlpha.set(!1),h.demTexture=h.demTexture||y.getTileTexture(p.stride);const C=p.getPixels();h.demTexture?h.demTexture.update(C,{premultiply:!1}):h.demTexture=new s.Texture(b,C,w.RGBA,{premultiply:!1}),h.needsDEMTextureUpload=!1}function Xl(y,h,p,b,w,C){const P=y.context,k=P.gl;if(!h.dem)return;const G=h.dem;if(P.activeTexture.set(k.TEXTURE1),Zr(y,h,G),!h.demTexture)return;h.demTexture.bind(k.NEAREST,k.CLAMP_TO_EDGE);const W=G.dim;P.activeTexture.set(k.TEXTURE0);let X=h.fbo;if(!X){const _e=new s.Texture(P,{width:W,height:W,data:null},k.RGBA);_e.bind(k.LINEAR,k.CLAMP_TO_EDGE),X=h.fbo=P.createFramebuffer(W,W,!0),X.colorAttachment.set(_e.texture)}P.bindFramebuffer.set(X.framebuffer),P.viewport.set([0,0,W,W]);const{tileBoundsBuffer:ne,tileBoundsIndexBuffer:ce,tileBoundsSegments:ye}=y.getMercatorTileBoundsBuffers();y.useProgram("hillshadePrepare").draw(P,k.TRIANGLES,b,w,C,s.CullFaceMode.disabled,((_e,ve)=>{const xe=ve.stride,se=s.create();return s.ortho(se,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(se,se,[0,-s.EXTENT,0]),{u_matrix:se,u_image:1,u_dimension:[xe,xe],u_zoom:_e.overscaledZ,u_unpack:ve.unpackVector}})(h.tileID,G),p.id,ne,ce,ye),h.needsHillshadePrepare=!1}const Uh=y=>({u_matrix:new s.UniformMatrix4f(y),u_image0:new s.Uniform1i(y),u_skirt_height:new s.Uniform1f(y)}),wp=(y,h)=>({u_matrix:y,u_image0:0,u_skirt_height:h}),Vh=(y,h,p,b,w,C,P,k,G,W,X,ne,ce,ye,_e)=>({u_proj_matrix:Float32Array.from(y),u_globe_matrix:h,u_normalize_matrix:Float32Array.from(b),u_merc_matrix:p,u_zoom_transition:w,u_merc_center:C,u_image0:0,u_frustum_tl:P,u_frustum_tr:k,u_frustum_br:G,u_frustum_bl:W,u_globe_pos:X,u_globe_radius:ne,u_viewport:ce,u_grid_matrix:_e?Float32Array.from(_e):new Float32Array(9),u_skirt_height:ye});function Sp(y,h){return y!=null&&h!=null&&!(!y.hasData()||!h.hasData())&&y.demTexture!=null&&h.demTexture!=null&&y.tileID.key!==h.tileID.key}const ku=new class{constructor(){this.operations={}}newMorphing(y,h,p,b,w){if(y in this.operations){const C=this.operations[y];C.to.tileID.key!==p.tileID.key&&(C.queued=p)}else this.operations[y]={startTime:b,phase:0,duration:w,from:h,to:p,queued:null}}getMorphValuesForProxy(y){if(!(y in this.operations))return null;const h=this.operations[y];return{from:h.from,to:h.to,phase:h.phase}}update(y){for(const h in this.operations){const p=this.operations[h];for(p.phase=(y-p.startTime)/p.duration;p.phase>=1||!this._validOp(p);)if(!this._nextOp(p,y)){delete this.operations[h];break}}}_nextOp(y,h){return!!y.queued&&(y.from=y.to,y.to=y.queued,y.queued=null,y.phase=0,y.startTime=h,!0)}_validOp(y){return y.from.hasData()&&y.to.hasData()}},Fu={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Zl(y){return 6*Math.pow(1.5,22-y)}function Na(y,h){const p=1<<y.z;return!h&&(y.x===0||y.x===p-1)||y.y===0||y.y===p-1}const Zi=y=>({u_matrix:y});function gc(y,h,p,b,w){if(w>0){const C=s.exported.now(),P=(C-y.timeAdded)/w,k=h?(C-h.timeAdded)/w:-1,G=p.getSource(),W=b.coveringZoomLevel({tileSize:G.tileSize,roundZoom:G.roundZoom}),X=!h||Math.abs(h.tileID.overscaledZ-W)>Math.abs(y.tileID.overscaledZ-W),ne=X&&y.refreshedUponExpiration?1:s.clamp(X?P:1-k,0,1);return y.refreshedUponExpiration&&P>=1&&(y.refreshedUponExpiration=!1),h?{opacity:1,mix:1-ne}:{opacity:ne,mix:0}}return{opacity:1,mix:0}}class lu extends s.SourceCache{constructor(h){const p={type:"raster-dem",maxzoom:h.transform.maxZoom},b=new Gt(Ye(),null),w=ot("mock-dem",p,b,h.style);super("mock-dem",w,!1),w.setEventedParent(this),this._sourceLoaded=!0}_loadTile(h,p){h.state="loaded",p(null)}}class Cp extends s.SourceCache{constructor(h){const p=ot("proxy",{type:"geojson",maxzoom:h.transform.maxZoom},new Gt(Ye(),null),h.style);super("proxy",p,!1),p.setEventedParent(this),this.map=this.getSource().map=h,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(h,p,b){if(h.freezeTileCoverage)return;this.transform=h;const w=h.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((C,P)=>{if(C[P.key]="",!this._tiles[P.key]){const k=new s.Tile(P,this._source.tileSize*P.overscaleFactor(),h.tileZoom);k.state="loaded",this._tiles[P.key]=k}return C},{});for(const C in this._tiles)C in w||(this.freeFBO(C),this._tiles[C].unloadVectorData(),delete this._tiles[C])}freeFBO(h){const p=this.proxyCachedFBO[h];if(p!==void 0){const b=Object.values(p);this.renderCachePool.push(...b),delete this.proxyCachedFBO[h]}}deallocRenderCache(){this.renderCache.forEach(h=>h.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class _c extends s.OverscaledTileID{constructor(h,p,b){super(h.overscaledZ,h.wrap,h.canonical.z,h.canonical.x,h.canonical.y),this.proxyTileKey=p,this.projMatrix=b}}class Bu extends s.Elevation{constructor(h,p){super(),this.painter=h,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[b,w,C]=function(G){const W=new s.StructArrayLayout2i4,X=new s.StructArrayLayout3ui6,ne=131;W.reserve(17161),X.reserve(33800);const ce=s.EXTENT/128,ye=s.EXTENT+ce/2,_e=ye+ce;for(let xe=-ce;xe<_e;xe+=ce)for(let se=-ce;se<_e;se+=ce){const Le=se<0||se>ye||xe<0||xe>ye?24575:0,Ae=s.clamp(Math.round(se),0,s.EXTENT),Re=s.clamp(Math.round(xe),0,s.EXTENT);W.emplaceBack(Ae+Le,Re)}const ve=(xe,se)=>{const Le=se*ne+xe;X.emplaceBack(Le+1,Le,Le+ne),X.emplaceBack(Le+ne,Le+ne+1,Le+1)};for(let xe=1;xe<129;xe++)for(let se=1;se<129;se++)ve(se,xe);return[0,129].forEach(xe=>{for(let se=0;se<130;se++)ve(se,xe),ve(xe,se)}),[W,X,32768]}(),P=h.context;this.gridBuffer=P.createVertexBuffer(b,s.posAttributes.members),this.gridIndexBuffer=P.createIndexBuffer(w),this.gridSegments=s.SegmentVector.simpleSegment(0,0,b.length,w.length),this.gridNoSkirtSegments=s.SegmentVector.simpleSegment(0,0,b.length,C),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Cp(p.map),this.orthoMatrix=s.create(),s.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,s.EXTENT,0,s.EXTENT,0,1);const k=P.gl;this._overlapStencilMode=new s.StencilMode({func:k.GEQUAL,mask:255},0,255,k.KEEP,k.KEEP,k.REPLACE),this._previousZoom=h.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=p,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new lu(p.map)}set style(h){h.on("data",this._onStyleDataEvent.bind(this)),h.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=h,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(h,p,b){if(h&&h.terrain){this._style!==h&&(this.style=h),this.enabled=!0;const w=h.terrain.properties;this.sourceCache=h.terrain.drapeRenderMode===0?this._mockSourceCache:h._getSourceCache(w.get("source")),this._exaggeration=w.get("exaggeration");const C=()=>{this.sourceCache.used&&s.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const P=this.getScaledDemTileSize();this.sourceCache.update(p,P,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,C(),this._initializing=!0),C(),p.updateElevation(!0,b),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(p),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(h){this._findCoveringTileCache[h]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const h=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||h.efficiency!==100&&s.warnOnce(`Terrain render cache efficiency is not optimal (${h.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${h.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(h){h.coord&&h.dataType==="source"?this._clearRenderCacheForTile(h.sourceCacheId,h.coord):h.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const h in this._style._sourceCaches)this._style._sourceCaches[h].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(h=>h.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const h=2*this.proxySourceCache.getSource().tileSize;return[h,h]}set useVertexMorphing(h){this._useVertexMorphing=h}updateTileBinding(h){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const p=this.proxySourceCache,b=this.painter.transform;this._initializing&&(this._initializing=b._centerAltitude===0&&this.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(b.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const w=this.proxyCoords=p.getIds().map(G=>{const W=p.getTileByID(G).tileID;return W.projMatrix=b.calculateProjMatrix(W.toUnwrapped()),W});(function(G,W){const X=W.transform.pointCoordinate(W.transform.getCameraPoint()),ne=new s.pointGeometry(X.x,X.y);G.sort((ce,ye)=>{if(ye.overscaledZ-ce.overscaledZ)return ye.overscaledZ-ce.overscaledZ;const _e=new s.pointGeometry(ce.canonical.x+(1<<ce.canonical.z)*ce.wrap,ce.canonical.y),ve=new s.pointGeometry(ye.canonical.x+(1<<ye.canonical.z)*ye.wrap,ye.canonical.y),xe=ne.mult(1<<ce.canonical.z);return xe.x-=.5,xe.y-=.5,xe.distSqr(_e)-xe.distSqr(ve)})})(w,this.painter),this._previousZoom=b.zoom;const C=this.proxyToSource||{};this.proxyToSource={},w.forEach(G=>{this.proxyToSource[G.key]={}}),this.terrainTileForTile={};const P=this._style._sourceCaches;for(const G in P){const W=P[G];if(!W.used||(W!==this.sourceCache&&this.resetTileLookupCache(W.id),this._setupProxiedCoordsForOrtho(W,h[G],C),W.usedForTerrain))continue;const X=h[G];W.getSource().reparseOverscaled&&this._assignTerrainTiles(X)}this.proxiedCoords[p.id]=w.map(G=>new _c(G,G.key,this.orthoMatrix)),this._assignTerrainTiles(w),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(C),this.renderingToTexture=!1,this._updateTimestamp=s.exported.now();const k={};this._visibleDemTiles=[];for(const G of this.proxyCoords){const W=this.terrainTileForTile[G.key];if(!W)continue;const X=W.tileID.key;X in k||(this._visibleDemTiles.push(W),k[X]=X)}}_assignTerrainTiles(h){this._initializing||h.forEach(p=>{if(this.terrainTileForTile[p.key])return;const b=this._findTileCoveringTileID(p,this.sourceCache);b&&(this.terrainTileForTile[p.key]=b)})}_prepareDEMTextures(){const h=this.painter.context,p=h.gl;for(const b in this.terrainTileForTile){const w=this.terrainTileForTile[b],C=w.dem;!C||w.demTexture&&!w.needsDEMTextureUpload||(h.activeTexture.set(p.TEXTURE1),Zr(this.painter,w,C))}}_prepareDemTileUniforms(h,p,b,w){if(!p||p.demTexture==null)return!1;const C=h.tileID.canonical,P=Math.pow(2,p.tileID.canonical.z-C.z),k=w||"";return b[`u_dem_tl${k}`]=[C.x*P%1,C.y*P%1],b[`u_dem_scale${k}`]=P,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const h=this.painter.context,p=h.gl;if(!this._emptyDepthBufferTexture){const b=new s.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new s.Texture(h,b,p.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let h=0;const p=this._visibleDemTiles.reduce((b,w)=>{if(!w.dem)return b;const C=w.dem.tree.minimums[0];return C>0&&h++,b+C},0);return h?p/h:0}_updateEmptyDEMTexture(){const h=this.painter.context,p=h.gl;h.activeTexture.set(p.TEXTURE2);const b=this._getLoadedAreaMinimum(),w=new s.RGBAImage({width:1,height:1},new Uint8Array(s.DEMData.pack(b,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let C=this._emptyDEMTexture;return C?C.update(w,{premultiply:!1}):C=this._emptyDEMTexture=new s.Texture(h,w,p.RGBA,{premultiply:!1}),C}setupElevationDraw(h,p,b){const w=this.painter.context,C=w.gl,P=(k=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:s.DEMData.getUnpackVector(k),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var k;P.u_dem_size=this.sourceCache.getSource().tileSize,P.u_exaggeration=this.exaggeration();let G=null,W=null,X=1;if(b&&b.morphing&&this._useVertexMorphing){const ne=b.morphing.srcDemTile,ce=b.morphing.dstDemTile;X=b.morphing.phase,ne&&ce&&(this._prepareDemTileUniforms(h,ne,P,"_prev")&&(W=ne),this._prepareDemTileUniforms(h,ce,P)&&(G=ce))}if(W&&G?(w.activeTexture.set(C.TEXTURE2),G.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE,C.NEAREST),w.activeTexture.set(C.TEXTURE4),W.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE,C.NEAREST),P.u_dem_lerp=X):(G=this.terrainTileForTile[h.tileID.key],w.activeTexture.set(C.TEXTURE2),(this._prepareDemTileUniforms(h,G,P)?G.demTexture:this.emptyDEMTexture).bind(C.NEAREST,C.CLAMP_TO_EDGE)),w.activeTexture.set(C.TEXTURE3),b&&b.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE),this._depthFBO&&(P.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE),P.u_depth_size_inv=[1,1]),b&&b.useMeterToDem&&G){const ne=(1<<G.tileID.canonical.z)*s.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;P.u_meter_to_dem=ne}if(b&&b.labelPlaneMatrixInv&&(P.u_label_plane_matrix_inv=b.labelPlaneMatrixInv),p.setTerrainUniformValues(w,P),this.painter.transform.projection.name==="globe"){const ne=this.globeUniformValues(this.painter.transform,h.tileID.canonical,b&&b.useDenormalizedUpVectorScale);p.setGlobeUniformValues(w,ne)}}globeUniformValues(h,p,b){const w=h.projection;return{u_tile_tl_up:w.upVector(p,0,0),u_tile_tr_up:w.upVector(p,s.EXTENT,0),u_tile_br_up:w.upVector(p,s.EXTENT,s.EXTENT),u_tile_bl_up:w.upVector(p,0,s.EXTENT),u_tile_up_scale:b?s.globeMetersToEcef(1):w.upVectorScale(p,h.center.lat,h.worldSize).metersToTile}}renderToBackBuffer(h){const p=this.painter,b=this.painter.context;h.length!==0&&(b.bindFramebuffer.set(null),b.viewport.set([0,0,p.width,p.height]),p.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(w,C,P,k,G){if(w.transform.projection.name==="globe")(function(W,X,ne,ce,ye){const _e=W.context,ve=_e.gl;let xe,se;const Le=W.options.showTerrainWireframe?2:0,Ae=W.transform,Re=s.globeUseCustomAntiAliasing(W,_e,Ae),Xe=(un,yt)=>{if(se===un)return;const ht=[Fu[un],"PROJECTION_GLOBE_VIEW"];Re&&ht.push("CUSTOM_ANTIALIASING"),yt&&ht.push(Fu[Le]),xe=W.useProgram("globeRaster",null,ht),se=un},je=W.colorModeForRenderPass(),Ke=new s.DepthMode(ve.LEQUAL,s.DepthMode.ReadWrite,W.depthRangeFor3D);ku.update(ye);const ft=s.calculateGlobeMercatorMatrix(Ae),dt=[s.mercatorXfromLng(Ae.center.lng),s.mercatorYfromLat(Ae.center.lat)],xt=Le?[!1,!0]:[!1],Tn=W.globeSharedBuffers,gt=[Ae.width*s.exported.devicePixelRatio,Ae.height*s.exported.devicePixelRatio],Zt=Float32Array.from(Ae.globeMatrix),St={useDenormalizedUpVectorScale:!0};if(xt.forEach(un=>{const yt=W.transform,ht=Zl(yt.zoom)*X.exaggeration();se=-1;const Tt=un?ve.LINES:ve.TRIANGLES;for(const en of ce){const ln=ne.getTile(en),ci=s.StencilMode.disabled,ur=X.prevTerrainTileForTile[en.key],$n=X.terrainTileForTile[en.key];Sp(ur,$n)&&ku.newMorphing(en.key,ur,$n,ye,250),_e.activeTexture.set(ve.TEXTURE0),ln.texture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE);const Hn=ku.getMorphValuesForProxy(en.key),di=Hn?1:0;Hn&&s.extend$1(St,{morphing:{srcDemTile:Hn.from,dstDemTile:Hn.to,phase:s.easeCubicInOut(Hn.phase)}});const vr=s.tileCornersToBounds(en.canonical),bi=s.getLatitudinalLod(vr.getCenter().lat),Wr=s.getGridMatrix(en.canonical,vr,bi,yt.worldSize/yt._pixelsPerMercatorPixel),$r=s.globeNormalizeECEF(s.globeTileBounds(en.canonical)),xs=Vh(yt.projMatrix,Zt,ft,$r,s.globeToMercatorTransition(yt.zoom),dt,yt.frustumCorners.TL,yt.frustumCorners.TR,yt.frustumCorners.BR,yt.frustumCorners.BL,yt.globeCenterInViewSpace,yt.globeRadius,gt,ht,Wr);if(Xe(di,un),X.setupElevationDraw(ln,xe,St),W.prepareDrawProgram(_e,xe,en.toUnwrapped()),Tn){const[ss,xo,sl]=un?Tn.getWirefameBuffers(W.context,bi):Tn.getGridBuffers(bi,ht!==0);xe.draw(_e,Tt,Ke,ci,je,s.CullFaceMode.backCCW,xs,"globe_raster",ss,xo,sl)}}}),Tn){const un=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Re&&un.push("CUSTOM_ANTIALIASING"),xe=W.useProgram("globeRaster",null,un);for(const yt of ce){const{x:ht,y:Tt,z:en}=yt.canonical,ln=Tt===0,ci=Tt===(1<<en)-1,[ur,$n,Hn,di]=Tn.getPoleBuffers(en);if(di&&(ln||ci)){const vr=ne.getTile(yt);_e.activeTexture.set(ve.TEXTURE0),vr.texture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE);let bi=s.globePoleMatrixForTile(en,ht,Ae);const Wr=s.globeNormalizeECEF(s.globeTileBounds(yt.canonical)),$r=(xs,ss)=>xs.draw(_e,ve.TRIANGLES,Ke,s.StencilMode.disabled,je,s.CullFaceMode.disabled,Vh(Ae.projMatrix,bi,bi,Wr,0,dt,Ae.frustumCorners.TL,Ae.frustumCorners.TR,Ae.frustumCorners.BR,Ae.frustumCorners.BL,Ae.globeCenterInViewSpace,Ae.globeRadius,gt,0),"globe_pole_raster",ss,Hn,di);X.setupElevationDraw(vr,xe,St),W.prepareDrawProgram(_e,xe,yt.toUnwrapped()),ln&&$r(xe,ur),ci&&(bi=s.scale(s.create(),bi,[1,-1,1]),$r(xe,$n))}}}})(w,C,P,k,G);else{const W=w.context,X=W.gl;let ne,ce;const ye=w.options.showTerrainWireframe?2:0,_e=(Ae,Re)=>{if(ce===Ae)return;const Xe=[Fu[Ae]];Re&&Xe.push(Fu[ye]),ne=w.useProgram("terrainRaster",null,Xe),ce=Ae},ve=w.colorModeForRenderPass(),xe=new s.DepthMode(X.LEQUAL,s.DepthMode.ReadWrite,w.depthRangeFor3D);ku.update(G);const se=w.transform,Le=Zl(se.zoom)*C.exaggeration();(ye?[!1,!0]:[!1]).forEach(Ae=>{ce=-1;const Re=Ae?X.LINES:X.TRIANGLES,[Xe,je]=Ae?C.getWirefameBuffer():[C.gridIndexBuffer,C.gridSegments];for(const Ke of k){const ft=P.getTile(Ke),dt=s.StencilMode.disabled,xt=C.prevTerrainTileForTile[Ke.key],Tn=C.terrainTileForTile[Ke.key];Sp(xt,Tn)&&ku.newMorphing(Ke.key,xt,Tn,G,250),W.activeTexture.set(X.TEXTURE0),ft.texture.bind(X.LINEAR,X.CLAMP_TO_EDGE,X.LINEAR_MIPMAP_NEAREST);const gt=ku.getMorphValuesForProxy(Ke.key),Zt=gt?1:0;let St;gt&&(St={morphing:{srcDemTile:gt.from,dstDemTile:gt.to,phase:s.easeCubicInOut(gt.phase)}});const un=wp(Ke.projMatrix,Na(Ke.canonical,se.renderWorldCopies)?Le/10:Le);_e(Zt,Ae),C.setupElevationDraw(ft,ne,St),w.prepareDrawProgram(W,ne,Ke.toUnwrapped()),ne.draw(W,Re,xe,dt,ve,s.CullFaceMode.backCCW,un,"terrain_raster",C.gridBuffer,Xe,je)}})}}(p,this,this.proxySourceCache,h,this._updateTimestamp),this.renderingToTexture=!0,p.gpuTimingDeferredRenderEnd(),h.splice(0,h.length))}renderBatch(h){if(this._drapedRenderBatches.length===0)return h+1;this.renderingToTexture=!0;const p=this.painter,b=this.painter.context,w=this.proxySourceCache,C=this.proxiedCoords[w.id],P=this._drapedRenderBatches.shift(),k=[],G=p.style.order;let W=0;for(const X of C){const ne=w.getTileByID(X.proxyTileKey),ce=w.proxyCachedFBO[X.key]?w.proxyCachedFBO[X.key][h]:void 0,ye=ce!==void 0?w.renderCache[ce]:this.pool[W++],_e=ce!==void 0;if(ne.texture=ye.tex,_e&&!ye.dirty){k.push(ne.tileID);continue}let ve;b.bindFramebuffer.set(ye.fb.framebuffer),this.renderedToTile=!1,ye.dirty&&(b.clear({color:s.Color.transparent,stencil:0}),ye.dirty=!1);for(let xe=P.start;xe<=P.end;++xe){const se=p.style._layers[G[xe]];if(se.isHidden(p.transform.zoom))continue;const Le=p.style._getLayerSourceCache(se),Ae=Le?this.proxyToSource[X.key][Le.id]:[X];if(!Ae)continue;const Re=Ae;b.viewport.set([0,0,ye.fb.width,ye.fb.height]),ve!==(Le?Le.id:null)&&(this._setupStencil(ye,Ae,se,Le),ve=Le?Le.id:null),p.renderLayer(p,Le,se,Re)}this.renderedToTile?(ye.dirty=!0,k.push(ne.tileID)):_e||--W,W===5&&(W=0,this.renderToBackBuffer(k))}return this.renderToBackBuffer(k),this.renderingToTexture=!1,b.bindFramebuffer.set(null),b.viewport.set([0,0,p.width,p.height]),P.end+1}postRender(){}renderCacheEfficiency(h){const p=h.order.length;if(p===0)return{efficiency:100};let b,w=0,C=0,P=!1;for(let k=0;k<p;++k){const G=h._layers[h.order[k]];this._style.isLayerDraped(G)?(P&&++w,++C):P||(P=!0,b=G.id)}return C===0?{efficiency:100}:{efficiency:100*(1-w/C),firstUndrapedLayer:b}}getMinElevationBelowMSL(){let h=0;return this._visibleDemTiles.filter(p=>p.dem).forEach(p=>{h=Math.min(h,p.dem.tree.minimums[0])}),h===0?h:(h-30)*this._exaggeration}raycast(h,p,b){if(!this._visibleDemTiles)return null;const w=this._visibleDemTiles.filter(C=>C.dem).map(C=>{const P=C.tileID,k=1<<P.overscaledZ,{x:G,y:W}=P.canonical,X=G/k,ne=(G+1)/k,ce=W/k,ye=(W+1)/k;return{minx:X,miny:ce,maxx:ne,maxy:ye,t:C.dem.tree.raycastRoot(X,ce,ne,ye,h,p,b),tile:C}});w.sort((C,P)=>(C.t!==null?C.t:Number.MAX_VALUE)-(P.t!==null?P.t:Number.MAX_VALUE));for(const C of w){if(C.t==null)return null;const P=C.tile.dem.tree.raycast(C.minx,C.miny,C.maxx,C.maxy,h,p,b);if(P!=null)return P}return null}_createFBO(){const h=this.painter.context,p=h.gl,b=this.drapeBufferSize;h.activeTexture.set(p.TEXTURE0);const w=new s.Texture(h,{width:b[0],height:b[1],data:null},p.RGBA);w.bind(p.LINEAR,p.CLAMP_TO_EDGE);const C=h.createFramebuffer(b[0],b[1],!1);return C.colorAttachment.set(w.texture),C.depthAttachment=new so(h,C.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=h.createRenderbuffer(h.gl.DEPTH_STENCIL,b[0],b[1]),this._stencilRef=0,C.depthAttachment.set(this._sharedDepthStencil),h.clear({stencil:0})):C.depthAttachment.set(this._sharedDepthStencil),h.extTextureFilterAnisotropic&&!h.extTextureFilterAnisotropicForceOff&&p.texParameterf(p.TEXTURE_2D,h.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,h.extTextureFilterAnisotropicMax),{fb:C,tex:w,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const h in this._style._sourceCaches)if(this._style._sourceCaches[h].hasTransition())return!0;return this._style.order.some(h=>{const p=this._style._layers[h],b=p.isHidden(this.painter.transform.zoom);return p.type==="custom"?!b&&p.shouldRedrape():!b&&p.hasTransition()})}_clearLineLayersFromRenderCache(){let h=!1;for(const b of this._style._getSources())if(b instanceof te){h=!0;break}if(!h)return;const p={};for(let b=0;b<this._style.order.length;++b){const w=this._style._layers[this._style.order[b]],C=this._style._getLayerSourceCache(w);if(C&&!p[C.id]&&!w.isHidden(this.painter.transform.zoom)&&w.type==="line"&&w.widthExpression()instanceof s.ZoomDependentExpression){p[C.id]=!0;for(const P of this.proxyCoords){const k=this.proxyToSource[P.key][C.id];if(k)for(const G of k)this._clearRenderCacheForTile(C.id,G)}}}}_clearRasterLayersFromRenderCache(){let h=!1;for(const b in this._style._sourceCaches)if(this._style._sourceCaches[b]._source instanceof re){h=!0;break}if(!h)return;const p={};for(let b=0;b<this._style.order.length;++b){const w=this._style._layers[this._style.order[b]],C=this._style._getLayerSourceCache(w);if(!C||p[C.id]||w.isHidden(this.painter.transform.zoom)||w.type!=="raster")continue;const P=w.paint.get("raster-fade-duration");for(const k of this.proxyCoords){const G=this.proxyToSource[k.key][C.id];if(G)for(const W of G){const X=gc(C.getTile(W),C.findLoadedParent(W,0),C,this.painter.transform,P);(X.opacity!==1||X.mix!==0)&&this._clearRenderCacheForTile(C.id,W)}}}}_setupDrapedRenderBatches(){const h=this._style.order,p=h.length;if(p===0)return;const b=[];let w,C=0,P=this._style._layers[h[C]];for(;!this._style.isLayerDraped(P)&&P.isHidden(this.painter.transform.zoom)&&++C<p;)P=this._style._layers[h[C]];for(;C<p;++C){const k=this._style._layers[h[C]];k.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(k)?w===void 0&&(w=C):w!==void 0&&(b.push({start:w,end:C-1}),w=void 0))}w!==void 0&&b.push({start:w,end:C-1}),this._drapedRenderBatches=b}_setupRenderCache(h){const p=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,p.renderCache.length>p.renderCachePool.length){const P=Object.values(p.proxyCachedFBO);p.proxyCachedFBO={};for(let k=0;k<P.length;++k){const G=Object.values(P[k]);p.renderCachePool.push(...G)}}return}this._clearRasterLayersFromRenderCache();const b=this.proxyCoords,w=this._tilesDirty;for(let P=b.length-1;P>=0;P--){const k=b[P];if(p.getTileByID(k.key),p.proxyCachedFBO[k.key]!==void 0){const G=h[k.key],W=this.proxyToSource[k.key];let X=0;for(const ne in W){const ce=W[ne],ye=G[ne];if(!ye||ye.length!==ce.length||ce.some((_e,ve)=>_e!==ye[ve]||w[ne]&&w[ne].hasOwnProperty(_e.key))){X=-1;break}++X}for(const ne in p.proxyCachedFBO[k.key])p.renderCache[p.proxyCachedFBO[k.key][ne]].dirty=X<0||X!==Object.values(G).length}}const C=[...this._drapedRenderBatches];C.sort((P,k)=>k.end-k.start-(P.end-P.start));for(const P of C)for(const k of b){if(p.proxyCachedFBO[k.key])continue;let G=p.renderCachePool.pop();G===void 0&&p.renderCache.length<50&&(G=p.renderCache.length,p.renderCache.push(this._createFBO())),G!==void 0&&(p.proxyCachedFBO[k.key]={},p.proxyCachedFBO[k.key][P.start]=G,p.renderCache[G].dirty=!0)}this._tilesDirty={}}_setupStencil(h,p,b,w){if(!w||!this._sourceTilesOverlap[w.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const C=this.painter.context,P=C.gl;if(p.length<=1)return void(this._overlapStencilType=!1);let k;if(b.isTileClipped())k=p.length,this._overlapStencilMode.test={func:P.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(p[0].overscaledZ>p[p.length-1].overscaledZ))return void(this._overlapStencilType=!1);k=1,this._overlapStencilMode.test={func:P.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+k>255&&(C.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=k,this._overlapStencilMode.ref=this._stencilRef,b.isTileClipped()&&this._renderTileClippingMasks(p,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(h){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[h.key]),this._overlapStencilMode):s.StencilMode.disabled}_renderTileClippingMasks(h,p){const b=this.painter,w=this.painter.context,C=w.gl;b._tileClippingMaskIDs={},w.setColorMode(s.ColorMode.disabled),w.setDepthMode(s.DepthMode.disabled);const P=b.useProgram("clippingMask");for(const k of h){const G=b._tileClippingMaskIDs[k.key]=--p;P.draw(w,C.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:C.ALWAYS,mask:0},G,255,C.KEEP,C.KEEP,C.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,Zi(k.projMatrix),"$clipping",b.tileExtentBuffer,b.quadTriangleIndexBuffer,b.tileExtentSegments)}}pointCoordinate(h){const p=this.painter.transform;if(h.x<0||h.x>p.width||h.y<0||h.y>p.height)return null;const b=[h.x,h.y,1,1];s.transformMat4$1(b,b,p.pixelMatrixInverse),s.scale$1(b,b,1/b[3]),b[0]/=p.worldSize,b[1]/=p.worldSize;const w=p._camera.position,C=s.mercatorZfromAltitude(1,p.center.lat),P=[w[0],w[1],w[2]/C,0],k=s.subtract([],b.slice(0,3),P);s.normalize(k,k);const G=this.raycast(P,k,this._exaggeration);return G!==null&&G?(s.scaleAndAdd(P,P,k,G),P[3]=P[2],P[2]*=C,P):null}drawDepth(){const h=this.painter,p=h.context,b=this.proxySourceCache,w=Math.ceil(h.width),C=Math.ceil(h.height);if(!this._depthFBO||this._depthFBO.width===w&&this._depthFBO.height===C||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const P=p.gl,k=p.createFramebuffer(w,C,!0);p.activeTexture.set(P.TEXTURE0);const G=new s.Texture(p,{width:w,height:C,data:null},P.RGBA);G.bind(P.NEAREST,P.CLAMP_TO_EDGE),k.colorAttachment.set(G.texture);const W=p.createRenderbuffer(p.gl.DEPTH_COMPONENT16,w,C);k.depthAttachment.set(W),this._depthFBO=k,this._depthTexture=G}p.bindFramebuffer.set(this._depthFBO.framebuffer),p.viewport.set([0,0,w,C]),function(P,k,G,W){if(P.transform.projection.name==="globe")return;const X=P.context,ne=X.gl;X.clear({depth:1});const ce=P.useProgram("terrainDepth"),ye=new s.DepthMode(ne.LESS,s.DepthMode.ReadWrite,P.depthRangeFor3D);for(const _e of W){const ve=G.getTile(_e),xe=wp(_e.projMatrix,0);k.setupElevationDraw(ve,ce),ce.draw(X,ne.TRIANGLES,ye,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.backCCW,xe,"terrain_depth",k.gridBuffer,k.gridIndexBuffer,k.gridNoSkirtSegments)}}(h,this,b,this.proxyCoords)}_setupProxiedCoordsForOrtho(h,p,b){if(h.getSource()instanceof We)return this._setupProxiedCoordsForImageSource(h,p,b);this._findCoveringTileCache[h.id]=this._findCoveringTileCache[h.id]||{};const w=this.proxiedCoords[h.id]=[],C=this.proxyCoords;for(let k=0;k<C.length;k++){const G=C[k],W=this._findTileCoveringTileID(G,h);if(W){const X=this._createProxiedId(G,W,b[G.key]&&b[G.key][h.id]);w.push(X),this.proxyToSource[G.key][h.id]=[X]}}let P=!1;for(let k=0;k<p.length;k++){const G=h.getTile(p[k]);if(!G||!G.hasData())continue;const W=this._findTileCoveringTileID(G.tileID,this.proxySourceCache);if(W&&W.tileID.canonical.z!==G.tileID.canonical.z){const X=this.proxyToSource[W.tileID.key][h.id],ne=this._createProxiedId(W.tileID,G,b[W.tileID.key]&&b[W.tileID.key][h.id]);X?X.splice(X.length-1,0,ne):this.proxyToSource[W.tileID.key][h.id]=[ne],w.push(ne),P=!0}}this._sourceTilesOverlap[h.id]=P}_setupProxiedCoordsForImageSource(h,p,b){if(!h.getSource().loaded())return;const w=this.proxiedCoords[h.id]=[],C=this.proxyCoords,P=h.getSource(),k=new s.pointGeometry(P.tileID.x,P.tileID.y)._div(1<<P.tileID.z),G=P.coordinates.map(s.MercatorCoordinate.fromLngLat).reduce((X,ne)=>(X.min.x=Math.min(X.min.x,ne.x-k.x),X.min.y=Math.min(X.min.y,ne.y-k.y),X.max.x=Math.max(X.max.x,ne.x-k.x),X.max.y=Math.max(X.max.y,ne.y-k.y),X),{min:new s.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),W=(X,ne)=>{const ce=X.wrap+X.canonical.x/(1<<X.canonical.z),ye=X.canonical.y/(1<<X.canonical.z),_e=s.EXTENT/(1<<X.canonical.z),ve=ne.wrap+ne.canonical.x/(1<<ne.canonical.z),xe=ne.canonical.y/(1<<ne.canonical.z);return ce+_e<ve+G.min.x||ce>ve+G.max.x||ye+_e<xe+G.min.y||ye>xe+G.max.y};for(let X=0;X<C.length;X++){const ne=C[X];for(let ce=0;ce<p.length;ce++){const ye=h.getTile(p[ce]);if(!ye||!ye.hasData()||W(ne,ye.tileID))continue;const _e=this._createProxiedId(ne,ye,b[ne.key]&&b[ne.key][h.id]),ve=this.proxyToSource[ne.key][h.id];ve?ve.push(_e):this.proxyToSource[ne.key][h.id]=[_e],w.push(_e)}}}_createProxiedId(h,p,b){let w=this.orthoMatrix;if(b){const C=b.find(P=>P.key===p.tileID.key);if(C)return C}if(p.tileID.key!==h.key){const C=h.canonical.z-p.tileID.canonical.z;let P,k,G;w=s.create();const W=p.tileID.wrap-h.wrap<<h.overscaledZ;C>0?(P=s.EXTENT>>C,k=P*((p.tileID.canonical.x<<C)-h.canonical.x+W),G=P*((p.tileID.canonical.y<<C)-h.canonical.y)):(P=s.EXTENT<<-C,k=s.EXTENT*(p.tileID.canonical.x-(h.canonical.x+W<<-C)),G=s.EXTENT*(p.tileID.canonical.y-(h.canonical.y<<-C))),s.ortho(w,0,P,0,P,0,1),s.translate(w,w,[k,G,0])}return new _c(p.tileID,h.key,w)}_findTileCoveringTileID(h,p){let b=p.getTile(h);if(b&&b.hasData())return b;const w=this._findCoveringTileCache[p.id],C=w[h.key];if(b=C?p.getTileByID(C):null,b&&b.hasData()||C===null)return b;let P=b?b.tileID:h,k=P.overscaledZ;const G=p.getSource().minzoom,W=[];if(!C){const ne=p.getSource().maxzoom;if(h.canonical.z>=ne){const ce=h.canonical.z-ne;p.getSource().reparseOverscaled?(k=Math.max(h.canonical.z+2,p.transform.tileZoom),P=new s.OverscaledTileID(k,h.wrap,ne,h.canonical.x>>ce,h.canonical.y>>ce)):ce!==0&&(k=ne,P=new s.OverscaledTileID(k,h.wrap,ne,h.canonical.x>>ce,h.canonical.y>>ce))}P.key!==h.key&&(W.push(P.key),b=p.getTile(P))}const X=ne=>{W.forEach(ce=>{w[ce]=ne}),W.length=0};for(k-=1;k>=G&&(!b||!b.hasData());k--){b&&X(b.tileID.key);const ne=P.calculateScaledKey(k);if(b=p.getTileByID(ne),b&&b.hasData())break;const ce=w[ne];if(ce===null)break;ce===void 0?W.push(ne):b=p.getTileByID(ce)}return X(b?b.tileID.key:null),b&&b.hasData()?b:null}findDEMTileFor(h){return this.enabled?this._findTileCoveringTileID(h,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(h,p){let b=this._tilesDirty[h];b||(b=this._tilesDirty[h]={}),b[p.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const h=function(p){let b=0;const w=new s.StructArrayLayout2ui4,C=131;for(let P=1;P<129;P++){for(let k=1;k<129;k++)b=P*C+k,w.emplaceBack(b,b+1),w.emplaceBack(b,b+C),w.emplaceBack(b+1,b+C),P===128&&w.emplaceBack(b+C,b+C+1);w.emplaceBack(b+1,b+1+C)}return w}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(h),this.wireframeSegments=s.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,h.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Hf{static cacheKey(h,p,b,w){let C=`${p}${w?w.cacheKey:""}`;for(const P of b)h.usedDefines.includes(P)&&(C+=`/${P}`);return C}constructor(h,p,b,w,C,P){const k=h.gl;this.program=k.createProgram();const G=function(se){const Le=[];for(let Ae=0;Ae<se.length;Ae++){if(se[Ae]===null)continue;const Re=se[Ae].split(" ");Le.push(Re.pop())}return Le}(b.staticAttributes),W=w?w.getBinderAttributes():[],X=G.concat(W);let ne=w?w.defines():[];ne=ne.concat(P.map(se=>`#define ${se}`));const ce=h.isWebGL2?`#version 300 es
`:"",ye=ce+ne.concat(h.extStandardDerivatives&&ce.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(Ld):Ld,Ld,Yo,Du.fragmentSource,Gf.fragmentSource,b.fragmentSource).join(`
`),_e=ce+ne.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Yo,Du.vertexSource,Gf.vertexSource,Vf.vertexSource,b.vertexSource).join(`
`),ve=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);k.shaderSource(ve,ye),k.compileShader(ve),k.attachShader(this.program,ve);const xe=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())this.failedToCreate=!0;else{k.shaderSource(xe,_e),k.compileShader(xe),k.attachShader(this.program,xe),this.attributes={},this.numAttributes=X.length;for(let se=0;se<this.numAttributes;se++)X[se]&&(k.bindAttribLocation(this.program,se,X[se]),this.attributes[X[se]]=se);k.linkProgram(this.program),k.deleteShader(xe),k.deleteShader(ve),this.fixedUniforms=C(h),this.binderUniforms=w?w.getUniforms(h):[],P.includes("TERRAIN")&&(this.terrainUniforms=(se=>({u_dem:new s.Uniform1i(se),u_dem_prev:new s.Uniform1i(se),u_dem_unpack:new s.Uniform4f(se),u_dem_tl:new s.Uniform2f(se),u_dem_scale:new s.Uniform1f(se),u_dem_tl_prev:new s.Uniform2f(se),u_dem_scale_prev:new s.Uniform1f(se),u_dem_size:new s.Uniform1f(se),u_dem_lerp:new s.Uniform1f(se),u_exaggeration:new s.Uniform1f(se),u_depth:new s.Uniform1i(se),u_depth_size_inv:new s.Uniform2f(se),u_meter_to_dem:new s.Uniform1f(se),u_label_plane_matrix_inv:new s.UniformMatrix4f(se)}))(h)),P.includes("GLOBE")&&(this.globeUniforms=(se=>({u_tile_tl_up:new s.Uniform3f(se),u_tile_tr_up:new s.Uniform3f(se),u_tile_br_up:new s.Uniform3f(se),u_tile_bl_up:new s.Uniform3f(se),u_tile_up_scale:new s.Uniform1f(se)}))(h)),P.includes("FOG")&&(this.fogUniforms=(se=>({u_fog_matrix:new s.UniformMatrix4f(se),u_fog_range:new s.Uniform2f(se),u_fog_color:new s.Uniform4f(se),u_fog_horizon_blend:new s.Uniform1f(se),u_fog_temporal_offset:new s.Uniform1f(se),u_frustum_tl:new s.Uniform3f(se),u_frustum_tr:new s.Uniform3f(se),u_frustum_br:new s.Uniform3f(se),u_frustum_bl:new s.Uniform3f(se),u_globe_pos:new s.Uniform3f(se),u_globe_radius:new s.Uniform1f(se),u_globe_transition:new s.Uniform1f(se),u_is_globe:new s.Uniform1i(se),u_viewport:new s.Uniform2f(se)}))(h))}}setTerrainUniformValues(h,p){if(!this.terrainUniforms)return;const b=this.terrainUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const w in p)b[w]&&b[w].set(this.program,w,p[w])}}setGlobeUniformValues(h,p){if(!this.globeUniforms)return;const b=this.globeUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const w in p)b[w]&&b[w].set(this.program,w,p[w])}}setFogUniformValues(h,p){if(!this.fogUniforms)return;const b=this.fogUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const w in p)b[w].set(this.program,w,p[w])}}draw(h,p,b,w,C,P,k,G,W,X,ne,ce,ye,_e,ve){const xe=h.gl;if(this.failedToCreate)return;h.program.set(this.program),h.setDepthMode(b),h.setStencilMode(w),h.setColorMode(C),h.setCullFace(P);for(const Le of Object.keys(this.fixedUniforms))this.fixedUniforms[Le].set(this.program,Le,k[Le]);_e&&_e.setUniforms(this.program,h,this.binderUniforms,ce,{zoom:ye});const se={[xe.LINES]:2,[xe.TRIANGLES]:3,[xe.LINE_STRIP]:1}[p];for(const Le of ne.get()){const Ae=Le.vaos||(Le.vaos={});(Ae[G]||(Ae[G]=new Oa)).bind(h,this,W,_e?_e.getPaintVertexBuffers():[],X,Le.vertexOffset,ve||[]),xe.drawElements(p,Le.primitiveLength*se,xe.UNSIGNED_SHORT,Le.primitiveOffset*se*2)}}}function Ap(y,h){const p=Math.pow(2,h.tileID.overscaledZ),b=h.tileSize*Math.pow(2,y.transform.tileZoom)/p,w=b*(h.tileID.canonical.x+h.tileID.wrap*p),C=b*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_tile_units_to_pixels:1/Mt(h,1,y.transform.tileZoom),u_pixel_coord_upper:[w>>16,C>>16],u_pixel_coord_lower:[65535&w,65535&C]}}const Mp=s.create(),Gh=(y,h,p,b,w,C,P,k,G,W,X)=>{const ne=h.style.light,ce=ne.properties.get("position"),ye=[ce.x,ce.y,ce.z],_e=s.create$1();ne.properties.get("anchor")==="viewport"&&(s.fromRotation(_e,-h.transform.angle),s.transformMat3(ye,ye,_e));const ve=ne.properties.get("color"),xe=h.transform,se={u_matrix:y,u_lightpos:ye,u_lightintensity:ne.properties.get("intensity"),u_lightcolor:[ve.r,ve.g,ve.b],u_vertical_gradient:+p,u_opacity:b,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Mp,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:w,u_edge_radius:C};return xe.projection.name==="globe"&&(se.u_tile_id=[P.canonical.x,P.canonical.y,1<<P.canonical.z],se.u_zoom_transition=G,se.u_inv_rot_matrix=X,se.u_merc_center=W,se.u_up_dir=xe.projection.upVector(new s.CanonicalTileID(0,0,0),W[0]*s.EXTENT,W[1]*s.EXTENT),se.u_height_lift=k),se},Rd=(y,h,p,b,w,C,P,k,G,W,X,ne)=>{const ce=Gh(y,h,p,b,w,C,P,G,W,X,ne),ye={u_height_factor:-Math.pow(2,P.overscaledZ)/k.tileSize/8};return s.extend(ce,Ap(h,k),ye)},Hh=y=>({u_matrix:y}),wo=(y,h,p)=>s.extend(Hh(y),Ap(h,p)),zu=(y,h)=>({u_matrix:y,u_world:h}),jh=(y,h,p,b)=>s.extend(wo(y,h,p),{u_world:b}),Uu=s.create(),qh=(y,h,p,b,w,C)=>{const P=y.transform,k=P.projection.name==="globe";let G;if(C.paint.get("circle-pitch-alignment")==="map")if(k){const X=s.globePixelsToTileUnits(P.zoom,h.canonical)*P._pixelsPerMercatorPixel;G=Float32Array.from([X,0,0,X])}else G=P.calculatePixelsToTileUnitsMatrix(p);else G=new Float32Array([P.pixelsToGLUnits[0],0,0,P.pixelsToGLUnits[1]]);const W={u_camera_to_center_distance:P.cameraToCenterDistance,u_matrix:y.translatePosMatrix(h.projMatrix,p,C.paint.get("circle-translate"),C.paint.get("circle-translate-anchor")),u_device_pixel_ratio:s.exported.devicePixelRatio,u_extrude_scale:G,u_inv_rot_matrix:Uu,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(k){W.u_inv_rot_matrix=b,W.u_merc_center=w,W.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],W.u_zoom_transition=s.globeToMercatorTransition(P.zoom);const X=w[0]*s.EXTENT,ne=w[1]*s.EXTENT;W.u_up_dir=P.projection.upVector(new s.CanonicalTileID(0,0,0),X,ne)}return W},Yl=y=>{const h=[];return y.paint.get("circle-pitch-alignment")==="map"&&h.push("PITCH_WITH_MAP"),y.paint.get("circle-pitch-scale")==="map"&&h.push("SCALE_WITH_MAP"),h},Lp=(y,h,p,b)=>{const w=s.EXTENT/p.tileSize;return{u_matrix:y,u_camera_to_center_distance:h.getCameraToCenterDistance(b),u_extrude_scale:[h.pixelsToGLUnits[0]/w,h.pixelsToGLUnits[1]/w]}},jf=(y,h,p=1)=>({u_matrix:y,u_color:h,u_overlay:0,u_overlay_scale:p}),Wh=s.create(),El=(y,h,p,b,w,C,P)=>{const k=y.transform,G=k.projection.name==="globe",W=G?s.globePixelsToTileUnits(k.zoom,h.canonical)*k._pixelsPerMercatorPixel:Mt(p,1,C),X={u_matrix:h.projMatrix,u_extrude_scale:W,u_intensity:P,u_inv_rot_matrix:Wh,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(G){X.u_inv_rot_matrix=b,X.u_merc_center=w,X.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],X.u_zoom_transition=s.globeToMercatorTransition(k.zoom);const ne=w[0]*s.EXTENT,ce=w[1]*s.EXTENT;X.u_up_dir=k.projection.upVector(new s.CanonicalTileID(0,0,0),ne,ce)}return X},Vu=(y,h,p,b,w,C,P)=>{const k=y.transform,G=k.calculatePixelsToTileUnitsMatrix(h);return{u_matrix:Gu(y,h,p,b),u_pixels_to_tile_units:G,u_device_pixel_ratio:C,u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:w,u_texsize:Xh(p)?h.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:qf(h,y.transform),u_alpha_discard_threshold:0,u_trim_offset:P}},Rp=(y,h,p,b,w)=>{const C=y.transform;return{u_matrix:Gu(y,h,p,b),u_texsize:h.imageAtlasTexture.size,u_pixels_to_tile_units:C.calculatePixelsToTileUnitsMatrix(h),u_device_pixel_ratio:w,u_image:0,u_tile_units_to_pixels:qf(h,C),u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function qf(y,h){return 1/Mt(y,1,h.tileZoom)}function Gu(y,h,p,b){return y.translatePosMatrix(b||h.tileID.projMatrix,h,p.paint.get("line-translate"),p.paint.get("line-translate-anchor"))}function Xh(y){const h=y.paint.get("line-dasharray").value;return h.value||h.kind!=="constant"}const yc=(y,h,p,b,w,C)=>{return{u_matrix:y,u_tl_parent:h,u_scale_parent:p,u_fade_t:b.mix,u_opacity:b.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(k=w.paint.get("raster-saturation"),k>0?1-1/(1.001-k):-k),u_contrast_factor:(P=w.paint.get("raster-contrast"),P>0?1/(1-P):1+P),u_spin_weights:ct(w.paint.get("raster-hue-rotate")),u_perspective_transform:C};var P,k};function ct(y){y*=Math.PI/180;const h=Math.sin(y),p=Math.cos(y);return[(2*p+1)/3,(-Math.sqrt(3)*h-p+1)/3,(Math.sqrt(3)*h-p+1)/3]}const Ut=s.create(),zn=(y,h,p,b,w,C,P,k,G,W,X,ne,ce,ye,_e,ve)=>{const xe=w.transform,se={u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:h?h.uSizeT:0,u_size:h?h.uSize:0,u_camera_to_center_distance:xe.cameraToCenterDistance,u_rotate_symbol:+p,u_aspect_ratio:xe.width/xe.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:C,u_label_plane_matrix:P,u_coord_matrix:k,u_is_text:+G,u_pitch_with_map:+b,u_texsize:W,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ut,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Ut,u_up_vector:[0,-1,0]};return ve.name==="globe"&&(se.u_tile_id=[X.canonical.x,X.canonical.y,1<<X.canonical.z],se.u_zoom_transition=ne,se.u_inv_rot_matrix=ye,se.u_merc_center=ce,se.u_camera_forward=xe._camera.forward(),se.u_ecef_origin=s.globeECEFOrigin(xe.globeMatrix,X.toUnwrapped()),se.u_tile_matrix=Float32Array.from(xe.globeMatrix),se.u_up_vector=_e),se},Si=(y,h,p,b,w,C,P,k,G,W,X,ne,ce,ye,_e,ve,xe)=>s.extend(zn(y,h,p,b,w,C,P,k,G,W,ne,ce,ye,_e,ve,xe),{u_gamma_scale:b?w.transform.cameraToCenterDistance*Math.cos(w.terrain?0:w.transform._pitch):1,u_device_pixel_ratio:s.exported.devicePixelRatio,u_is_halo:+X}),Yr=(y,h,p,b,w,C,P,k,G,W,X,ne,ce,ye,_e,ve)=>s.extend(Si(y,h,p,b,w,C,P,k,!0,G,!0,X,ne,ce,ye,_e,ve),{u_texsize_icon:W,u_texture_icon:1}),nr=(y,h,p)=>({u_matrix:y,u_opacity:h,u_color:p}),Rs=(y,h,p,b,w)=>s.extend(function(C,P,k){const G=P.imageManager.getPattern(C.toString()),{width:W,height:X}=P.imageManager.getPixelSize(),ne=Math.pow(2,k.tileID.overscaledZ),ce=k.tileSize*Math.pow(2,P.transform.tileZoom)/ne,ye=ce*(k.tileID.canonical.x+k.tileID.wrap*ne),_e=ce*k.tileID.canonical.y;return{u_image:0,u_pattern_tl:G.tl,u_pattern_br:G.br,u_texsize:[W,X],u_pattern_size:G.displaySize,u_tile_units_to_pixels:1/Mt(k,1,P.transform.tileZoom),u_pixel_coord_upper:[ye>>16,_e>>16],u_pixel_coord_lower:[65535&ye,65535&_e]}}(b,p,w),{u_matrix:y,u_opacity:h}),yo={fillExtrusion:y=>({u_matrix:new s.UniformMatrix4f(y),u_lightpos:new s.Uniform3f(y),u_lightintensity:new s.Uniform1f(y),u_lightcolor:new s.Uniform3f(y),u_vertical_gradient:new s.Uniform1f(y),u_opacity:new s.Uniform1f(y),u_edge_radius:new s.Uniform1f(y),u_ao:new s.Uniform2f(y),u_tile_id:new s.Uniform3f(y),u_zoom_transition:new s.Uniform1f(y),u_inv_rot_matrix:new s.UniformMatrix4f(y),u_merc_center:new s.Uniform2f(y),u_up_dir:new s.Uniform3f(y),u_height_lift:new s.Uniform1f(y)}),fillExtrusionPattern:y=>({u_matrix:new s.UniformMatrix4f(y),u_lightpos:new s.Uniform3f(y),u_lightintensity:new s.Uniform1f(y),u_lightcolor:new s.Uniform3f(y),u_vertical_gradient:new s.Uniform1f(y),u_height_factor:new s.Uniform1f(y),u_edge_radius:new s.Uniform1f(y),u_ao:new s.Uniform2f(y),u_tile_id:new s.Uniform3f(y),u_zoom_transition:new s.Uniform1f(y),u_inv_rot_matrix:new s.UniformMatrix4f(y),u_merc_center:new s.Uniform2f(y),u_up_dir:new s.Uniform3f(y),u_height_lift:new s.Uniform1f(y),u_image:new s.Uniform1i(y),u_texsize:new s.Uniform2f(y),u_pixel_coord_upper:new s.Uniform2f(y),u_pixel_coord_lower:new s.Uniform2f(y),u_tile_units_to_pixels:new s.Uniform1f(y),u_opacity:new s.Uniform1f(y)}),fill:y=>({u_matrix:new s.UniformMatrix4f(y)}),fillPattern:y=>({u_matrix:new s.UniformMatrix4f(y),u_image:new s.Uniform1i(y),u_texsize:new s.Uniform2f(y),u_pixel_coord_upper:new s.Uniform2f(y),u_pixel_coord_lower:new s.Uniform2f(y),u_tile_units_to_pixels:new s.Uniform1f(y)}),fillOutline:y=>({u_matrix:new s.UniformMatrix4f(y),u_world:new s.Uniform2f(y)}),fillOutlinePattern:y=>({u_matrix:new s.UniformMatrix4f(y),u_world:new s.Uniform2f(y),u_image:new s.Uniform1i(y),u_texsize:new s.Uniform2f(y),u_pixel_coord_upper:new s.Uniform2f(y),u_pixel_coord_lower:new s.Uniform2f(y),u_tile_units_to_pixels:new s.Uniform1f(y)}),circle:y=>({u_camera_to_center_distance:new s.Uniform1f(y),u_extrude_scale:new s.UniformMatrix2f(y),u_device_pixel_ratio:new s.Uniform1f(y),u_matrix:new s.UniformMatrix4f(y),u_inv_rot_matrix:new s.UniformMatrix4f(y),u_merc_center:new s.Uniform2f(y),u_tile_id:new s.Uniform3f(y),u_zoom_transition:new s.Uniform1f(y),u_up_dir:new s.Uniform3f(y)}),collisionBox:y=>({u_matrix:new s.UniformMatrix4f(y),u_camera_to_center_distance:new s.Uniform1f(y),u_extrude_scale:new s.Uniform2f(y)}),collisionCircle:y=>({u_matrix:new s.UniformMatrix4f(y),u_inv_matrix:new s.UniformMatrix4f(y),u_camera_to_center_distance:new s.Uniform1f(y),u_viewport_size:new s.Uniform2f(y)}),debug:y=>({u_color:new s.UniformColor(y),u_matrix:new s.UniformMatrix4f(y),u_overlay:new s.Uniform1i(y),u_overlay_scale:new s.Uniform1f(y)}),clippingMask:y=>({u_matrix:new s.UniformMatrix4f(y)}),heatmap:y=>({u_extrude_scale:new s.Uniform1f(y),u_intensity:new s.Uniform1f(y),u_matrix:new s.UniformMatrix4f(y),u_inv_rot_matrix:new s.UniformMatrix4f(y),u_merc_center:new s.Uniform2f(y),u_tile_id:new s.Uniform3f(y),u_zoom_transition:new s.Uniform1f(y),u_up_dir:new s.Uniform3f(y)}),heatmapTexture:y=>({u_image:new s.Uniform1i(y),u_color_ramp:new s.Uniform1i(y),u_opacity:new s.Uniform1f(y)}),hillshade:y=>({u_matrix:new s.UniformMatrix4f(y),u_image:new s.Uniform1i(y),u_latrange:new s.Uniform2f(y),u_light:new s.Uniform2f(y),u_shadow:new s.UniformColor(y),u_highlight:new s.UniformColor(y),u_accent:new s.UniformColor(y)}),hillshadePrepare:y=>({u_matrix:new s.UniformMatrix4f(y),u_image:new s.Uniform1i(y),u_dimension:new s.Uniform2f(y),u_zoom:new s.Uniform1f(y),u_unpack:new s.Uniform4f(y)}),line:y=>({u_matrix:new s.UniformMatrix4f(y),u_pixels_to_tile_units:new s.UniformMatrix2f(y),u_device_pixel_ratio:new s.Uniform1f(y),u_units_to_pixels:new s.Uniform2f(y),u_dash_image:new s.Uniform1i(y),u_gradient_image:new s.Uniform1i(y),u_image_height:new s.Uniform1f(y),u_texsize:new s.Uniform2f(y),u_tile_units_to_pixels:new s.Uniform1f(y),u_alpha_discard_threshold:new s.Uniform1f(y),u_trim_offset:new s.Uniform2f(y)}),linePattern:y=>({u_matrix:new s.UniformMatrix4f(y),u_texsize:new s.Uniform2f(y),u_pixels_to_tile_units:new s.UniformMatrix2f(y),u_device_pixel_ratio:new s.Uniform1f(y),u_image:new s.Uniform1i(y),u_units_to_pixels:new s.Uniform2f(y),u_tile_units_to_pixels:new s.Uniform1f(y),u_alpha_discard_threshold:new s.Uniform1f(y)}),raster:y=>({u_matrix:new s.UniformMatrix4f(y),u_tl_parent:new s.Uniform2f(y),u_scale_parent:new s.Uniform1f(y),u_fade_t:new s.Uniform1f(y),u_opacity:new s.Uniform1f(y),u_image0:new s.Uniform1i(y),u_image1:new s.Uniform1i(y),u_brightness_low:new s.Uniform1f(y),u_brightness_high:new s.Uniform1f(y),u_saturation_factor:new s.Uniform1f(y),u_contrast_factor:new s.Uniform1f(y),u_spin_weights:new s.Uniform3f(y),u_perspective_transform:new s.Uniform2f(y)}),symbolIcon:y=>({u_is_size_zoom_constant:new s.Uniform1i(y),u_is_size_feature_constant:new s.Uniform1i(y),u_size_t:new s.Uniform1f(y),u_size:new s.Uniform1f(y),u_camera_to_center_distance:new s.Uniform1f(y),u_rotate_symbol:new s.Uniform1i(y),u_aspect_ratio:new s.Uniform1f(y),u_fade_change:new s.Uniform1f(y),u_matrix:new s.UniformMatrix4f(y),u_label_plane_matrix:new s.UniformMatrix4f(y),u_coord_matrix:new s.UniformMatrix4f(y),u_is_text:new s.Uniform1i(y),u_pitch_with_map:new s.Uniform1i(y),u_texsize:new s.Uniform2f(y),u_tile_id:new s.Uniform3f(y),u_zoom_transition:new s.Uniform1f(y),u_inv_rot_matrix:new s.UniformMatrix4f(y),u_merc_center:new s.Uniform2f(y),u_camera_forward:new s.Uniform3f(y),u_tile_matrix:new s.UniformMatrix4f(y),u_up_vector:new s.Uniform3f(y),u_ecef_origin:new s.Uniform3f(y),u_texture:new s.Uniform1i(y)}),symbolSDF:y=>({u_is_size_zoom_constant:new s.Uniform1i(y),u_is_size_feature_constant:new s.Uniform1i(y),u_size_t:new s.Uniform1f(y),u_size:new s.Uniform1f(y),u_camera_to_center_distance:new s.Uniform1f(y),u_rotate_symbol:new s.Uniform1i(y),u_aspect_ratio:new s.Uniform1f(y),u_fade_change:new s.Uniform1f(y),u_matrix:new s.UniformMatrix4f(y),u_label_plane_matrix:new s.UniformMatrix4f(y),u_coord_matrix:new s.UniformMatrix4f(y),u_is_text:new s.Uniform1i(y),u_pitch_with_map:new s.Uniform1i(y),u_texsize:new s.Uniform2f(y),u_texture:new s.Uniform1i(y),u_gamma_scale:new s.Uniform1f(y),u_device_pixel_ratio:new s.Uniform1f(y),u_tile_id:new s.Uniform3f(y),u_zoom_transition:new s.Uniform1f(y),u_inv_rot_matrix:new s.UniformMatrix4f(y),u_merc_center:new s.Uniform2f(y),u_camera_forward:new s.Uniform3f(y),u_tile_matrix:new s.UniformMatrix4f(y),u_up_vector:new s.Uniform3f(y),u_ecef_origin:new s.Uniform3f(y),u_is_halo:new s.Uniform1i(y)}),symbolTextAndIcon:y=>({u_is_size_zoom_constant:new s.Uniform1i(y),u_is_size_feature_constant:new s.Uniform1i(y),u_size_t:new s.Uniform1f(y),u_size:new s.Uniform1f(y),u_camera_to_center_distance:new s.Uniform1f(y),u_rotate_symbol:new s.Uniform1i(y),u_aspect_ratio:new s.Uniform1f(y),u_fade_change:new s.Uniform1f(y),u_matrix:new s.UniformMatrix4f(y),u_label_plane_matrix:new s.UniformMatrix4f(y),u_coord_matrix:new s.UniformMatrix4f(y),u_is_text:new s.Uniform1i(y),u_pitch_with_map:new s.Uniform1i(y),u_texsize:new s.Uniform2f(y),u_texsize_icon:new s.Uniform2f(y),u_texture:new s.Uniform1i(y),u_texture_icon:new s.Uniform1i(y),u_gamma_scale:new s.Uniform1f(y),u_device_pixel_ratio:new s.Uniform1f(y),u_is_halo:new s.Uniform1i(y)}),background:y=>({u_matrix:new s.UniformMatrix4f(y),u_opacity:new s.Uniform1f(y),u_color:new s.UniformColor(y)}),backgroundPattern:y=>({u_matrix:new s.UniformMatrix4f(y),u_opacity:new s.Uniform1f(y),u_image:new s.Uniform1i(y),u_pattern_tl:new s.Uniform2f(y),u_pattern_br:new s.Uniform2f(y),u_texsize:new s.Uniform2f(y),u_pattern_size:new s.Uniform2f(y),u_pixel_coord_upper:new s.Uniform2f(y),u_pixel_coord_lower:new s.Uniform2f(y),u_tile_units_to_pixels:new s.Uniform1f(y)}),terrainRaster:Uh,terrainDepth:Uh,skybox:y=>({u_matrix:new s.UniformMatrix4f(y),u_sun_direction:new s.Uniform3f(y),u_cubemap:new s.Uniform1i(y),u_opacity:new s.Uniform1f(y),u_temporal_offset:new s.Uniform1f(y)}),skyboxGradient:y=>({u_matrix:new s.UniformMatrix4f(y),u_color_ramp:new s.Uniform1i(y),u_center_direction:new s.Uniform3f(y),u_radius:new s.Uniform1f(y),u_opacity:new s.Uniform1f(y),u_temporal_offset:new s.Uniform1f(y)}),skyboxCapture:y=>({u_matrix_3f:new s.UniformMatrix3f(y),u_sun_direction:new s.Uniform3f(y),u_sun_intensity:new s.Uniform1f(y),u_color_tint_r:new s.Uniform4f(y),u_color_tint_m:new s.Uniform4f(y),u_luminance:new s.Uniform1f(y)}),globeRaster:y=>({u_proj_matrix:new s.UniformMatrix4f(y),u_globe_matrix:new s.UniformMatrix4f(y),u_normalize_matrix:new s.UniformMatrix4f(y),u_merc_matrix:new s.UniformMatrix4f(y),u_zoom_transition:new s.Uniform1f(y),u_merc_center:new s.Uniform2f(y),u_image0:new s.Uniform1i(y),u_grid_matrix:new s.UniformMatrix3f(y),u_skirt_height:new s.Uniform1f(y),u_frustum_tl:new s.Uniform3f(y),u_frustum_tr:new s.Uniform3f(y),u_frustum_br:new s.Uniform3f(y),u_frustum_bl:new s.Uniform3f(y),u_globe_pos:new s.Uniform3f(y),u_globe_radius:new s.Uniform1f(y),u_viewport:new s.Uniform2f(y)}),globeAtmosphere:y=>({u_frustum_tl:new s.Uniform3f(y),u_frustum_tr:new s.Uniform3f(y),u_frustum_br:new s.Uniform3f(y),u_frustum_bl:new s.Uniform3f(y),u_horizon:new s.Uniform1f(y),u_transition:new s.Uniform1f(y),u_fadeout_range:new s.Uniform1f(y),u_color:new s.Uniform4f(y),u_high_color:new s.Uniform4f(y),u_space_color:new s.Uniform4f(y),u_star_intensity:new s.Uniform1f(y),u_star_density:new s.Uniform1f(y),u_star_size:new s.Uniform1f(y),u_temporal_offset:new s.Uniform1f(y),u_horizon_angle:new s.Uniform1f(y),u_rotation_matrix:new s.UniformMatrix4f(y)})};let Ko;function vo(y,h,p,b,w,C,P){const k=y.context,G=k.gl,W=y.transform,X=y.useProgram("collisionBox"),ne=[];let ce=0,ye=0;for(let Re=0;Re<b.length;Re++){const Xe=b[Re],je=h.getTile(Xe),Ke=je.getBucket(p);if(!Ke)continue;const ft=Fn(Xe,Ke,W);let dt=ft;w[0]===0&&w[1]===0||(dt=y.translatePosMatrix(ft,je,w,C));const xt=P?Ke.textCollisionBox:Ke.iconCollisionBox,Tn=Ke.collisionCircleArray;if(Tn.length>0){const gt=s.create(),Zt=dt;s.mul(gt,Ke.placementInvProjMatrix,W.glCoordMatrix),s.mul(gt,gt,Ke.placementViewportMatrix),ne.push({circleArray:Tn,circleOffset:ye,transform:Zt,invTransform:gt,projection:Ke.getProjection()}),ce+=Tn.length/4,ye=ce}xt&&(y.terrain&&y.terrain.setupElevationDraw(je,X),X.draw(k,G.LINES,s.DepthMode.disabled,s.StencilMode.disabled,y.colorModeForRenderPass(),s.CullFaceMode.disabled,Lp(dt,W,je,Ke.getProjection()),p.id,xt.layoutVertexBuffer,xt.indexBuffer,xt.segments,null,W.zoom,null,[xt.collisionVertexBuffer,xt.collisionVertexBufferExt]))}if(!P||!ne.length)return;const _e=y.useProgram("collisionCircle"),ve=new s.StructArrayLayout2f1f2i16;ve.resize(4*ce),ve._trim();let xe=0;for(const Re of ne)for(let Xe=0;Xe<Re.circleArray.length/4;Xe++){const je=4*Xe,Ke=Re.circleArray[je+0],ft=Re.circleArray[je+1],dt=Re.circleArray[je+2],xt=Re.circleArray[je+3];ve.emplace(xe++,Ke,ft,dt,xt,0),ve.emplace(xe++,Ke,ft,dt,xt,1),ve.emplace(xe++,Ke,ft,dt,xt,2),ve.emplace(xe++,Ke,ft,dt,xt,3)}(!Ko||Ko.length<2*ce)&&(Ko=function(Re){const Xe=2*Re,je=new s.StructArrayLayout3ui6;je.resize(Xe),je._trim();for(let Ke=0;Ke<Xe;Ke++){const ft=6*Ke;je.uint16[ft+0]=4*Ke+0,je.uint16[ft+1]=4*Ke+1,je.uint16[ft+2]=4*Ke+2,je.uint16[ft+3]=4*Ke+2,je.uint16[ft+4]=4*Ke+3,je.uint16[ft+5]=4*Ke+0}return je}(ce));const se=k.createIndexBuffer(Ko,!0),Le=k.createVertexBuffer(ve,s.collisionCircleLayout.members,!0);for(const Re of ne){const Xe={u_matrix:Re.transform,u_inv_matrix:Re.invTransform,u_camera_to_center_distance:(Ae=W).getCameraToCenterDistance(Re.projection),u_viewport_size:[Ae.width,Ae.height]};_e.draw(k,G.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,y.colorModeForRenderPass(),s.CullFaceMode.disabled,Xe,p.id,Le,se,s.SegmentVector.simpleSegment(0,2*Re.circleOffset,Re.circleArray.length,Re.circleArray.length/2),null,W.zoom)}var Ae;Le.destroy(),se.destroy()}const ao=s.create();function Kl({width:y,height:h,anchor:p,textOffset:b,textScale:w},C){const{horizontalAlign:P,verticalAlign:k}=s.getAnchorAlignment(p),G=-(P-.5)*y,W=-(k-.5)*h,X=s.evaluateVariableOffset(p,b);return new s.pointGeometry((G/w+X[0])*C,(W/w+X[1])*C)}function So(y,h,p,b,w,C,P,k,G,W,X){const ne=y.text.placedSymbolArray,ce=y.text.dynamicLayoutVertexArray,ye=y.icon.dynamicLayoutVertexArray,_e={},ve=y.getProjection(),xe=Fi(k,ve,C),se=C.elevation,Le=ve.upVectorScale(k.canonical,C.center.lat,C.worldSize).metersToTile;ce.clear();for(let Ae=0;Ae<ne.length;Ae++){const Re=ne.get(Ae),{tileAnchorX:Xe,tileAnchorY:je,numGlyphs:Ke}=Re,ft=y.allowVerticalPlacement&&!Re.placedOrientation,dt=Re.hidden||!Re.crossTileID||ft?null:b[Re.crossTileID];if(dt){let xt=0,Tn=0,gt=0;if(se){const ci=se?se.getAtTileOffset(k,Xe,je):0,[ur,$n,Hn]=ve.upVector(k.canonical,Xe,je);xt=ci*ur*Le,Tn=ci*$n*Le,gt=ci*Hn*Le}let[Zt,St,un,yt]=An(Re.projectedAnchorX+xt,Re.projectedAnchorY+Tn,Re.projectedAnchorZ+gt,p?xe:P);const ht=hr(C.getCameraToCenterDistance(ve),yt);let Tt=w.evaluateSizeForFeature(y.textSizeData,W,Re)*ht/s.ONE_EM;p&&(Tt*=y.tilePixelRatio/G);const en=Kl(dt,Tt);p?({x:Zt,y:St,z:un}=ve.projectTilePoint(Xe+en.x,je+en.y,k.canonical),[Zt,St,un]=An(Zt+xt,St+Tn,un+gt,P)):(h&&en._rotate(-C.angle),Zt+=en.x,St+=en.y,un=0);const ln=y.allowVerticalPlacement&&Re.placedOrientation===s.WritingMode.vertical?Math.PI/2:0;for(let ci=0;ci<Ke;ci++)s.addDynamicAttributes(ce,Zt,St,un,ln);X&&Re.associatedIconIndex>=0&&(_e[Re.associatedIconIndex]={x:Zt,y:St,z:un,angle:ln})}else st(Ke,ce)}if(X){ye.clear();const Ae=y.icon.placedSymbolArray;for(let Re=0;Re<Ae.length;Re++){const Xe=Ae.get(Re),{numGlyphs:je}=Xe,Ke=_e[Re];if(Xe.hidden||!Ke)st(je,ye);else{const{x:ft,y:dt,z:xt,angle:Tn}=Ke;for(let gt=0;gt<je;gt++)s.addDynamicAttributes(ye,ft,dt,xt,Tn)}}y.icon.dynamicLayoutVertexBuffer.updateData(ye)}y.text.dynamicLayoutVertexBuffer.updateData(ce)}function lt(y,h,p){return p.iconsInText&&h?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function Ht(y,h,p,b,w,C,P,k,G,W,X,ne){const ce=y.context,ye=ce.gl,_e=y.transform,ve=k==="map",xe=G==="map",se=ve&&p.layout.get("symbol-placement")!=="point",Le=ve&&!xe&&!se,Ae=p.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Re=!1;const Xe=y.depthModeForSublayer(0,s.DepthMode.ReadOnly),je=[s.mercatorXfromLng(_e.center.lng),s.mercatorYfromLat(_e.center.lat)],Ke=p.layout.get("text-variable-anchor"),ft=_e.projection.name==="globe",dt=[],xt=[0,-1,0];let Tn=xt;!ft&&!_e.mercatorFromTransition||ve||(Tn=function(gt){const Zt=gt._camera.getWorldToCamera(gt.worldSize,1),St=s.multiply([],Zt,gt.globeMatrix);s.invert(St,St);const un=[0,0,0],yt=[0,1,0,0];return s.transformMat4$1(yt,yt,St),un[0]=yt[0],un[1]=yt[1],un[2]=yt[2],s.normalize(un,un),un}(_e));for(const gt of b){const Zt=h.getTile(gt),St=Zt.getBucket(p);if(!St||St.projection.name==="mercator"&&ft)continue;const un=w?St.text:St.icon;if(!un||St.fullyClipped||!un.segments.get().length)continue;const yt=un.programConfigurations.get(p.id),ht=w||St.sdfIcons,Tt=w?St.textSizeData:St.iconSizeData,en=xe||_e.pitch!==0,ln=s.evaluateSizeForZoom(Tt,_e.zoom);let ci,ur,$n,Hn,di=[0,0],vr=null;if(w){if(ur=Zt.glyphAtlasTexture,$n=ye.LINEAR,ci=Zt.glyphAtlasTexture.size,St.iconsInText){di=Zt.imageAtlasTexture.size,vr=Zt.imageAtlasTexture;const ol=Tt.kind==="composite"||Tt.kind==="camera";Hn=en||y.options.rotating||y.options.zooming||ol?ye.LINEAR:ye.NEAREST}}else{const ol=p.layout.get("icon-size").constantOr(0)!==1||St.iconsNeedLinear;ur=Zt.imageAtlasTexture,$n=ht||y.options.rotating||y.options.zooming||ol||en?ye.LINEAR:ye.NEAREST,ci=Zt.imageAtlasTexture.size}const bi=St.projection.name==="globe",Wr=bi?Tn:xt,$r=bi?s.globeToMercatorTransition(_e.zoom):0,xs=Fi(gt,St.getProjection(),_e),ss=_e.calculatePixelsToTileUnitsMatrix(Zt),xo=Pu(xs,Zt.tileID.canonical,xe,ve,_e,St.getProjection(),ss),sl=y.terrain&&xe&&se?s.invert(s.create(),xo):ao,du=pc(xs,Zt.tileID.canonical,xe,ve,_e,St.getProjection(),ss),pu=Ke&&St.hasTextData(),Ps=p.layout.get("icon-text-fit")!=="none"&&pu&&St.hasIconData();if(se){const ol=_e.elevation,Ki=ol?ol.getAtTileOffsetFunc(gt,_e.center.lat,_e.worldSize,St.getProjection()):null,ah=Ip(xs,Zt.tileID.canonical,xe,ve,_e,St.getProjection(),ss);Pa(St,xs,y,w,ah,du,xe,W,Ki,gt)}const cs=se||w&&Ke||Ps,Nr=y.translatePosMatrix(xs,Zt,C,P),lo=cs?ao:xo,ga=y.translatePosMatrix(du,Zt,C,P,!0),Ms=St.getProjection().createInversionMatrix(_e,gt.canonical),la=[];y.terrainRenderModeElevated()&&xe&&la.push("PITCH_WITH_MAP_TERRAIN"),bi&&la.push("PROJECTION_GLOBE_VIEW"),cs&&la.push("PROJECTED_POS_ON_VIEWPORT");const _a=ht&&p.paint.get(w?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Cc;Cc=ht?St.iconsInText?Yr(Tt.kind,ln,Le,xe,y,Nr,lo,ga,ci,di,gt,$r,je,Ms,Wr,St.getProjection()):Si(Tt.kind,ln,Le,xe,y,Nr,lo,ga,w,ci,!0,gt,$r,je,Ms,Wr,St.getProjection()):zn(Tt.kind,ln,Le,xe,y,Nr,lo,ga,w,ci,gt,$r,je,Ms,Wr,St.getProjection());const Ud={program:y.useProgram(lt(ht,w,St),yt,la),buffers:un,uniformValues:Cc,atlasTexture:ur,atlasTextureIcon:vr,atlasInterpolation:$n,atlasInterpolationIcon:Hn,isSDF:ht,hasHalo:_a,tile:Zt,labelPlaneMatrixInv:sl};if(Ae&&St.canOverlap){Re=!0;const ol=un.segments.get();for(const Ki of ol)dt.push({segments:new s.SegmentVector([Ki]),sortKey:Ki.sortKey,state:Ud})}else dt.push({segments:un.segments,sortKey:0,state:Ud})}Re&&dt.sort((gt,Zt)=>gt.sortKey-Zt.sortKey);for(const gt of dt){const Zt=gt.state;if(y.terrain&&y.terrain.setupElevationDraw(Zt.tile,Zt.program,{useDepthForOcclusion:!ft,labelPlaneMatrixInv:Zt.labelPlaneMatrixInv}),ce.activeTexture.set(ye.TEXTURE0),Zt.atlasTexture.bind(Zt.atlasInterpolation,ye.CLAMP_TO_EDGE),Zt.atlasTextureIcon&&(ce.activeTexture.set(ye.TEXTURE1),Zt.atlasTextureIcon&&Zt.atlasTextureIcon.bind(Zt.atlasInterpolationIcon,ye.CLAMP_TO_EDGE)),Zt.isSDF){const St=Zt.uniformValues;Zt.hasHalo&&(St.u_is_halo=1,Nt(Zt.buffers,gt.segments,p,y,Zt.program,Xe,X,ne,St)),St.u_is_halo=0}Nt(Zt.buffers,gt.segments,p,y,Zt.program,Xe,X,ne,Zt.uniformValues)}}function Nt(y,h,p,b,w,C,P,k,G){const W=b.context,X=[y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer,y.globeExtVertexBuffer];w.draw(W,W.gl.TRIANGLES,C,P,k,s.CullFaceMode.disabled,G,p.id,y.layoutVertexBuffer,y.indexBuffer,h,p.paint,b.transform.zoom,y.programConfigurations.get(p.id),X)}function oi(y,h,p,b,w,C,P){const k=y.context.gl,G=p.paint.get("fill-pattern"),W=G&&G.constantOr(1);let X,ne,ce,ye,_e;P?(ne=W&&!p.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",X=k.LINES):(ne=W?"fillPattern":"fill",X=k.TRIANGLES);for(const ve of b){const xe=h.getTile(ve);if(W&&!xe.patternsLoaded())continue;const se=xe.getBucket(p);if(!se)continue;y.prepareDrawTile();const Le=se.programConfigurations.get(p.id),Ae=y.useProgram(ne,Le);W&&(y.context.activeTexture.set(k.TEXTURE0),xe.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),Le.updatePaintBuffers());const Re=G.constantOr(null);if(Re&&xe.imageAtlas){const je=xe.imageAtlas.patternPositions[Re.toString()];je&&Le.setConstantPatternPositions(je)}const Xe=y.translatePosMatrix(ve.projMatrix,xe,p.paint.get("fill-translate"),p.paint.get("fill-translate-anchor"));if(P){ye=se.indexBuffer2,_e=se.segments2;const je=y.terrain&&y.terrain.renderingToTexture?y.terrain.drapeBufferSize:[k.drawingBufferWidth,k.drawingBufferHeight];ce=ne==="fillOutlinePattern"&&W?jh(Xe,y,xe,je):zu(Xe,je)}else ye=se.indexBuffer,_e=se.segments,ce=W?wo(Xe,y,xe):Hh(Xe);y.prepareDrawProgram(y.context,Ae,ve.toUnwrapped()),Ae.draw(y.context,X,w,y.stencilModeForClipping(ve),C,s.CullFaceMode.disabled,ce,p.id,se.layoutVertexBuffer,ye,_e,p.paint,y.transform.zoom,Le)}}function Ui(y,h,p,b,w,C,P){const k=y.context,G=k.gl,W=y.transform,X=p.paint.get("fill-extrusion-pattern"),ne=X.constantOr(1),ce=p.paint.get("fill-extrusion-opacity"),ye=[p.paint.get("fill-extrusion-ambient-occlusion-intensity"),p.paint.get("fill-extrusion-ambient-occlusion-radius")],_e=p.layout.get("fill-extrusion-edge-radius"),ve=W.projection.name==="globe"?s.fillExtrusionHeightLift():0,xe=W.projection.name==="globe",se=xe?s.globeToMercatorTransition(W.zoom):0,Le=[s.mercatorXfromLng(W.center.lng),s.mercatorYfromLat(W.center.lat)],Ae=[];xe&&Ae.push("PROJECTION_GLOBE_VIEW"),ye[0]>0&&Ae.push("FAUX_AO");for(const Re of b){const Xe=h.getTile(Re),je=Xe.getBucket(p);if(!je||je.projection.name!==W.projection.name)continue;const Ke=je.programConfigurations.get(p.id),ft=y.useProgram(ne?"fillExtrusionPattern":"fillExtrusion",Ke,Ae);if(y.terrain){const un=y.terrain;if(y.style.terrainSetForDrapingOnly())un.setupElevationDraw(Xe,ft,{useMeterToDem:!0});else{if(!je.enableTerrain)continue;if(un.setupElevationDraw(Xe,ft,{useMeterToDem:!0}),Or(k,h,Re,je,p,un),!je.centroidVertexBuffer){const yt=ft.attributes.a_centroid_pos;yt!==void 0&&G.vertexAttrib2f(yt,0,0)}}}ne&&(y.context.activeTexture.set(G.TEXTURE0),Xe.imageAtlasTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE),Ke.updatePaintBuffers());const dt=X.constantOr(null);if(dt&&Xe.imageAtlas){const un=Xe.imageAtlas.patternPositions[dt.toString()];un&&Ke.setConstantPatternPositions(un)}const xt=y.translatePosMatrix(Re.projMatrix,Xe,p.paint.get("fill-extrusion-translate"),p.paint.get("fill-extrusion-translate-anchor")),Tn=W.projection.createInversionMatrix(W,Re.canonical),gt=p.paint.get("fill-extrusion-vertical-gradient"),Zt=ne?Rd(xt,y,gt,ce,ye,_e,Re,Xe,ve,se,Le,Tn):Gh(xt,y,gt,ce,ye,_e,Re,ve,se,Le,Tn);y.prepareDrawProgram(k,ft,Re.toUnwrapped());const St=[];y.terrain&&St.push(je.centroidVertexBuffer),xe&&St.push(je.layoutVertexExtBuffer),ft.draw(k,k.gl.TRIANGLES,w,C,P,s.CullFaceMode.backCCW,Zt,p.id,je.layoutVertexBuffer,je.indexBuffer,je.segments,p.paint,y.transform.zoom,Ke,St)}}function Or(y,h,p,b,w,C){const P=[se=>{let Le=se.canonical.x-1,Ae=se.wrap;return Le<0&&(Le=(1<<se.canonical.z)-1,Ae--),new s.OverscaledTileID(se.overscaledZ,Ae,se.canonical.z,Le,se.canonical.y)},se=>{let Le=se.canonical.x+1,Ae=se.wrap;return Le===1<<se.canonical.z&&(Le=0,Ae++),new s.OverscaledTileID(se.overscaledZ,Ae,se.canonical.z,Le,se.canonical.y)},se=>new s.OverscaledTileID(se.overscaledZ,se.wrap,se.canonical.z,se.canonical.x,(se.canonical.y===0?1<<se.canonical.z:se.canonical.y)-1),se=>new s.OverscaledTileID(se.overscaledZ,se.wrap,se.canonical.z,se.canonical.x,se.canonical.y===(1<<se.canonical.z)-1?0:se.canonical.y+1)],k=se=>{const Le=h.getSource().minzoom,Ae=Xe=>{const je=h.getTileByID(Xe);if(je&&je.hasData())return je.getBucket(w)},Re=[0,-1,1];for(const Xe of Re){if(se.overscaledZ+Xe<Le)continue;const je=Ae(se.calculateScaledKey(se.overscaledZ+Xe));if(je)return je}},G=[0,0,0],W=(se,Le)=>(G[0]=Math.min(se.min.y,Le.min.y),G[1]=Math.max(se.max.y,Le.max.y),G[2]=s.EXTENT-Le.min.x>se.max.x?Le.min.x-s.EXTENT:se.max.x,G),X=(se,Le)=>(G[0]=Math.min(se.min.x,Le.min.x),G[1]=Math.max(se.max.x,Le.max.x),G[2]=s.EXTENT-Le.min.y>se.max.y?Le.min.y-s.EXTENT:se.max.y,G),ne=[(se,Le)=>W(se,Le),(se,Le)=>W(Le,se),(se,Le)=>X(se,Le),(se,Le)=>X(Le,se)],ce=new s.pointGeometry(0,0);let ye,_e,ve;const xe=(se,Le,Ae,Re,Xe)=>{const je=[[Re?Ae:se,Re?se:Ae,0],[Re?Ae:Le,Re?Le:Ae,0]],Ke=Xe<0?s.EXTENT+Xe:Xe,ft=[Re?Ke:(se+Le)/2,Re?(se+Le)/2:Ke,0];return Ae===0&&Xe<0||Ae!==0&&Xe>0?C.getForTilePoints(ve,[ft],!0,_e):je.push(ft),C.getForTilePoints(p,je,!0,ye),Math.max(je[0][2],je[1][2],ft[2])/C.exaggeration()};for(let se=0;se<4;se++){const Le=(se<2?1:5)-se,Ae=b.borders[se];if(Ae.length===0)continue;const Re=ve=P[se](p),Xe=k(Re);if(!(Xe&&Xe instanceof s.FillExtrusionBucket&&Xe.enableTerrain)||b.borderDoneWithNeighborZ[se]===Xe.canonical.z&&Xe.borderDoneWithNeighborZ[Le]===b.canonical.z||(_e=C.findDEMTileFor(Re),!_e||!_e.dem))continue;if(!ye){const dt=C.findDEMTileFor(p);if(!dt||!dt.dem)return;ye=dt}const je=Xe.borders[Le];let Ke=0;const ft=Xe.borderDoneWithNeighborZ[Le]!==b.canonical.z;if(b.canonical.z===Xe.canonical.z){for(let dt=0;dt<Ae.length;dt++){const xt=b.featuresOnBorder[Ae[dt]],Tn=xt.borders[se];let gt;for(;Ke<je.length&&(gt=Xe.featuresOnBorder[je[Ke]],!(gt.borders[Le][1]>Tn[0]+3));)ft&&Xe.encodeCentroid(void 0,gt,!1),Ke++;if(gt&&Ke<je.length){const Zt=Ke;let St=0;for(;!(gt.borders[Le][0]>Tn[1]-3)&&(St++,++Ke!==je.length);)gt=Xe.featuresOnBorder[je[Ke]];if(gt=Xe.featuresOnBorder[je[Zt]],xt.intersectsCount()>1||gt.intersectsCount()>1||St!==1){St!==1&&(Ke=Zt),b.encodeCentroid(void 0,xt,!1),ft&&Xe.encodeCentroid(void 0,gt,!1);continue}const un=ne[se](xt,gt),yt=se%2?s.EXTENT-1:0;ce.x=xe(un[0],Math.min(s.EXTENT-1,un[1]),yt,se<2,un[2]),ce.y=0,b.encodeCentroid(ce,xt,!1),ft&&Xe.encodeCentroid(ce,gt,!1)}else b.encodeCentroid(void 0,xt,!1)}b.borderDoneWithNeighborZ[se]=Xe.canonical.z,b.needsCentroidUpdate=!0,ft&&(Xe.borderDoneWithNeighborZ[Le]=b.canonical.z,Xe.needsCentroidUpdate=!0)}else{for(const dt of Ae)b.encodeCentroid(void 0,b.featuresOnBorder[dt],!1);if(ft){for(const dt of je)Xe.encodeCentroid(void 0,Xe.featuresOnBorder[dt],!1);Xe.borderDoneWithNeighborZ[Le]=b.canonical.z,Xe.needsCentroidUpdate=!0}b.borderDoneWithNeighborZ[se]=Xe.canonical.z,b.needsCentroidUpdate=!0}}(b.needsCentroidUpdate||!b.centroidVertexBuffer&&b.centroidVertexArray.length!==0)&&b.uploadCentroid(y)}const Js=new s.Color(1,0,0,1),us=new s.Color(0,1,0,1),Pd=new s.Color(0,0,1,1),ms=new s.Color(1,0,1,1),gr=new s.Color(0,1,1,1);function Hu(y,h,p){const b=y.context,w=y.transform,C=b.gl,P=w.projection.name==="globe",k=P?["PROJECTION_GLOBE_VIEW"]:null;let G=p.projMatrix;if(P&&s.globeToMercatorTransition(w.zoom)>0){const xt=s.transitionTileAABBinECEF(p.canonical,w),Tn=s.globeDenormalizeECEF(xt);G=s.multiply(new Float32Array(16),w.globeMatrix,Tn),s.multiply(G,w.projMatrix,G)}const W=y.useProgram("debug",null,k),X=h.getTileByID(p.key);y.terrain&&y.terrain.setupElevationDraw(X,W);const ne=s.DepthMode.disabled,ce=s.StencilMode.disabled,ye=y.colorModeForRenderPass(),_e="$debug";b.activeTexture.set(C.TEXTURE0),y.emptyTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),P?X._makeGlobeTileDebugBuffers(y.context,w):X._makeDebugTileBoundsBuffers(y.context,w.projection);const ve=X._tileDebugBuffer||y.debugBuffer,xe=X._tileDebugIndexBuffer||y.debugIndexBuffer,se=X._tileDebugSegments||y.debugSegments;W.draw(b,C.LINE_STRIP,ne,ce,ye,s.CullFaceMode.disabled,jf(G,s.Color.red),_e,ve,xe,se,null,null,null,[X._globeTileDebugBorderBuffer]);const Le=X.latestRawTileData,Ae=Math.floor((Le&&Le.byteLength||0)/1024),Re=h.getTile(p).tileSize,Xe=512/Math.min(Re,512)*(p.overscaledZ/w.zoom)*.5;let je=p.canonical.toString();p.overscaledZ!==p.canonical.z&&(je+=` => ${p.overscaledZ}`),je+=` ${Ae}kb`,function(xt,Tn){xt.initDebugOverlayCanvas();const gt=xt.debugOverlayCanvas,Zt=xt.context.gl,St=xt.debugOverlayCanvas.getContext("2d");St.clearRect(0,0,gt.width,gt.height),St.shadowColor="white",St.shadowBlur=2,St.lineWidth=1.5,St.strokeStyle="white",St.textBaseline="top",St.font="bold 36px Open Sans, sans-serif",St.fillText(Tn,5,5),St.strokeText(Tn,5,5),xt.debugOverlayTexture.update(gt),xt.debugOverlayTexture.bind(Zt.LINEAR,Zt.CLAMP_TO_EDGE)}(y,je);const Ke=X._tileDebugTextBuffer||y.debugBuffer,ft=X._tileDebugTextIndexBuffer||y.quadTriangleIndexBuffer,dt=X._tileDebugTextSegments||y.debugSegments;W.draw(b,C.TRIANGLES,ne,ce,s.ColorMode.alphaBlended,s.CullFaceMode.disabled,jf(G,s.Color.transparent,Xe),_e,Ke,ft,dt,null,null,null,[X._globeTileDebugTextBuffer])}function ma(y,h,p,b){Co(y,0,h+p/2,y.transform.width,p,b)}function tl(y,h,p,b){Co(y,h-p/2,0,p,y.transform.height,b)}function Co(y,h,p,b,w,C){const P=y.context,k=P.gl;k.enable(k.SCISSOR_TEST),k.scissor(h*s.exported.devicePixelRatio,p*s.exported.devicePixelRatio,b*s.exported.devicePixelRatio,w*s.exported.devicePixelRatio),P.clear({color:C}),k.disable(k.SCISSOR_TEST)}const Jo=s.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:_r}=Jo;function nl(y,h,p,b){y.emplaceBack(h,p,b)}class vc{constructor(h){this.vertexArray=new s.StructArrayLayout3f12,this.indices=new s.StructArrayLayout3ui6,nl(this.vertexArray,-1,-1,1),nl(this.vertexArray,1,-1,1),nl(this.vertexArray,-1,1,1),nl(this.vertexArray,1,1,1),nl(this.vertexArray,-1,-1,-1),nl(this.vertexArray,1,-1,-1),nl(this.vertexArray,-1,1,-1),nl(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=h.createVertexBuffer(this.vertexArray,_r),this.indexBuffer=h.createIndexBuffer(this.indices),this.segment=s.SegmentVector.simpleSegment(0,0,36,12)}}function $i(y,h,p,b,w,C){const P=y.gl,k=h.paint.get("sky-atmosphere-color"),G=h.paint.get("sky-atmosphere-halo-color"),W=h.paint.get("sky-atmosphere-sun-intensity"),X=((ne,ce,ye,_e,ve)=>({u_matrix_3f:ne,u_sun_direction:ce,u_sun_intensity:ye,u_color_tint_r:[_e.r,_e.g,_e.b,_e.a],u_color_tint_m:[ve.r,ve.g,ve.b,ve.a],u_luminance:5e-5}))(s.fromMat4(s.create$1(),b),w,W,k,G);P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,P.TEXTURE_CUBE_MAP_POSITIVE_X+C,h.skyboxTexture,0),p.draw(y,P.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.frontCW,X,"skyboxCapture",h.skyboxGeometry.vertexBuffer,h.skyboxGeometry.indexBuffer,h.skyboxGeometry.segment)}const uu=s.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Em{constructor(h){const p=new s.StructArrayLayout5f20;p.emplaceBack(-1,1,1,0,0),p.emplaceBack(1,1,1,1,0),p.emplaceBack(1,-1,1,1,1),p.emplaceBack(-1,-1,1,0,1);const b=new s.StructArrayLayout3ui6;b.emplaceBack(0,1,2),b.emplaceBack(2,3,0),this.vertexBuffer=h.createVertexBuffer(p,uu.members),this.indexBuffer=h.createIndexBuffer(b),this.segments=s.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Zh={symbol:function(y,h,p,b,w){if(y.renderPass!=="translucent")return;const C=s.StencilMode.disabled,P=y.colorModeForRenderPass();p.layout.get("text-variable-anchor")&&function(k,G,W,X,ne,ce,ye){const _e=G.transform,ve=ne==="map",xe=ce==="map";for(const se of k){const Le=X.getTile(se),Ae=Le.getBucket(W);if(!Ae||!Ae.text||!Ae.text.segments.get().length)continue;const Re=s.evaluateSizeForZoom(Ae.textSizeData,_e.zoom),Xe=Fi(se,Ae.getProjection(),_e),je=_e.calculatePixelsToTileUnitsMatrix(Le),Ke=Pu(Xe,Le.tileID.canonical,xe,ve,_e,Ae.getProjection(),je),ft=W.layout.get("icon-text-fit")!=="none"&&Ae.hasIconData();if(Re){const dt=Math.pow(2,_e.zoom-Le.tileID.overscaledZ);So(Ae,ve,xe,ye,s.symbolSize,_e,Ke,se,dt,Re,ft)}}}(b,y,p,h,p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),w),p.paint.get("icon-opacity").constantOr(1)!==0&&Ht(y,h,p,b,!1,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),p.layout.get("icon-rotation-alignment"),p.layout.get("icon-pitch-alignment"),p.layout.get("icon-keep-upright"),C,P),p.paint.get("text-opacity").constantOr(1)!==0&&Ht(y,h,p,b,!0,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),p.layout.get("text-keep-upright"),C,P),h.map.showCollisionBoxes&&(vo(y,h,p,b,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),!0),vo(y,h,p,b,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),!1))},circle:function(y,h,p,b){if(y.renderPass!=="translucent")return;const w=p.paint.get("circle-opacity"),C=p.paint.get("circle-stroke-width"),P=p.paint.get("circle-stroke-opacity"),k=p.layout.get("circle-sort-key").constantOr(1)!==void 0;if(w.constantOr(1)===0&&(C.constantOr(1)===0||P.constantOr(1)===0))return;const G=y.context,W=G.gl,X=y.transform,ne=y.depthModeForSublayer(0,s.DepthMode.ReadOnly),ce=s.StencilMode.disabled,ye=y.colorModeForRenderPass(),_e=X.projection.name==="globe",ve=[s.mercatorXfromLng(X.center.lng),s.mercatorYfromLat(X.center.lat)],xe=[];for(let Le=0;Le<b.length;Le++){const Ae=b[Le],Re=h.getTile(Ae),Xe=Re.getBucket(p);if(!Xe||Xe.projection.name!==X.projection.name)continue;const je=Xe.programConfigurations.get(p.id),Ke=Yl(p);_e&&Ke.push("PROJECTION_GLOBE_VIEW");const ft=y.useProgram("circle",je,Ke),dt=Xe.layoutVertexBuffer,xt=Xe.globeExtVertexBuffer,Tn=Xe.indexBuffer,gt=X.projection.createInversionMatrix(X,Ae.canonical),Zt={programConfiguration:je,program:ft,layoutVertexBuffer:dt,globeExtVertexBuffer:xt,indexBuffer:Tn,uniformValues:qh(y,Ae,Re,gt,ve,p),tile:Re};if(k){const St=Xe.segments.get();for(const un of St)xe.push({segments:new s.SegmentVector([un]),sortKey:un.sortKey,state:Zt})}else xe.push({segments:Xe.segments,sortKey:0,state:Zt})}k&&xe.sort((Le,Ae)=>Le.sortKey-Ae.sortKey);const se={useDepthForOcclusion:!_e};for(const Le of xe){const{programConfiguration:Ae,program:Re,layoutVertexBuffer:Xe,globeExtVertexBuffer:je,indexBuffer:Ke,uniformValues:ft,tile:dt}=Le.state,xt=Le.segments;y.terrain&&y.terrain.setupElevationDraw(dt,Re,se),y.prepareDrawProgram(G,Re,dt.tileID.toUnwrapped()),Re.draw(G,W.TRIANGLES,ne,ce,ye,s.CullFaceMode.disabled,ft,p.id,Xe,Ke,xt,p.paint,X.zoom,Ae,[je])}},heatmap:function(y,h,p,b){if(p.paint.get("heatmap-opacity")!==0)if(y.renderPass==="offscreen"){const w=y.context,C=w.gl,P=s.StencilMode.disabled,k=new s.ColorMode([C.ONE,C.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(ye,_e,ve,xe){const se=ye.gl,Le=_e.width*xe,Ae=_e.height*xe;ye.activeTexture.set(se.TEXTURE1),ye.viewport.set([0,0,Le,Ae]);let Re=ve.heatmapFbo;if(!Re||Re&&(Re.width!==Le||Re.height!==Ae)){Re&&Re.destroy();const Xe=se.createTexture();se.bindTexture(se.TEXTURE_2D,Xe),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_WRAP_S,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_WRAP_T,se.CLAMP_TO_EDGE),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MIN_FILTER,se.LINEAR),se.texParameteri(se.TEXTURE_2D,se.TEXTURE_MAG_FILTER,se.LINEAR),Re=ve.heatmapFbo=ye.createFramebuffer(Le,Ae,!1),function(je,Ke,ft,dt,xt,Tn){const gt=je.gl;gt.texImage2D(gt.TEXTURE_2D,0,je.isWebGL2&&je.extRenderToTextureHalfFloat?gt.RGBA16F:gt.RGBA,xt,Tn,0,gt.RGBA,je.extRenderToTextureHalfFloat?je.isWebGL2?gt.HALF_FLOAT:je.extTextureHalfFloat.HALF_FLOAT_OES:gt.UNSIGNED_BYTE,null),dt.colorAttachment.set(ft)}(ye,0,Xe,Re,Le,Ae)}else se.bindTexture(se.TEXTURE_2D,Re.colorAttachment.get()),ye.bindFramebuffer.set(Re.framebuffer)})(w,y,p,y.transform.projection.name==="globe"?.5:.25),w.clear({color:s.Color.transparent});const G=y.transform,W=G.projection.name==="globe",X=W?["PROJECTION_GLOBE_VIEW"]:null,ne=W?s.CullFaceMode.frontCCW:s.CullFaceMode.disabled,ce=[s.mercatorXfromLng(G.center.lng),s.mercatorYfromLat(G.center.lat)];for(let ye=0;ye<b.length;ye++){const _e=b[ye];if(h.hasRenderableParent(_e))continue;const ve=h.getTile(_e),xe=ve.getBucket(p);if(!xe||xe.projection.name!==G.projection.name)continue;const se=xe.programConfigurations.get(p.id),Le=y.useProgram("heatmap",se,X),{zoom:Ae}=y.transform;y.terrain&&y.terrain.setupElevationDraw(ve,Le),y.prepareDrawProgram(w,Le,_e.toUnwrapped());const Re=G.projection.createInversionMatrix(G,_e.canonical);Le.draw(w,C.TRIANGLES,s.DepthMode.disabled,P,k,ne,El(y,_e,ve,Re,ce,Ae,p.paint.get("heatmap-intensity")),p.id,xe.layoutVertexBuffer,xe.indexBuffer,xe.segments,p.paint,y.transform.zoom,se,W?[xe.globeExtVertexBuffer]:null)}w.viewport.set([0,0,y.width,y.height])}else y.renderPass==="translucent"&&(y.context.setColorMode(y.colorModeForRenderPass()),function(w,C){const P=w.context,k=P.gl,G=C.heatmapFbo;if(!G)return;P.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,G.colorAttachment.get()),P.activeTexture.set(k.TEXTURE1);let W=C.colorRampTexture;W||(W=C.colorRampTexture=new s.Texture(P,C.colorRamp,k.RGBA)),W.bind(k.LINEAR,k.CLAMP_TO_EDGE),w.useProgram("heatmapTexture").draw(P,k.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,w.colorModeForRenderPass(),s.CullFaceMode.disabled,((X,ne,ce,ye)=>({u_image:0,u_color_ramp:1,u_opacity:ne.paint.get("heatmap-opacity")}))(0,C),C.id,w.viewportBuffer,w.quadTriangleIndexBuffer,w.viewportSegments,C.paint,w.transform.zoom)}(y,p))},line:function(y,h,p,b){if(y.renderPass!=="translucent")return;const w=p.paint.get("line-opacity"),C=p.paint.get("line-width");if(w.constantOr(1)===0||C.constantOr(1)===0)return;const P=y.depthModeForSublayer(0,s.DepthMode.ReadOnly),k=y.colorModeForRenderPass(),G=y.terrain&&y.terrain.renderingToTexture?1:s.exported.devicePixelRatio,W=p.paint.get("line-dasharray"),X=W.constantOr(1),ne=p.layout.get("line-cap"),ce=p.paint.get("line-pattern"),ye=ce.constantOr(1),_e=p.paint.get("line-gradient"),ve=ye?"linePattern":"line",xe=y.context,se=xe.gl,Le=(Re=>{const Xe=[];Xh(Re)&&Xe.push("RENDER_LINE_DASH"),Re.paint.get("line-gradient")&&Xe.push("RENDER_LINE_GRADIENT");const je=Re.paint.get("line-trim-offset");je[0]===0&&je[1]===0||Xe.push("RENDER_LINE_TRIM_OFFSET");const Ke=Re.paint.get("line-pattern").constantOr(1),ft=Re.paint.get("line-opacity").constantOr(1)!==1;return!Ke&&ft&&Xe.push("RENDER_LINE_ALPHA_DISCARD"),Xe})(p);let Ae=Le.includes("RENDER_LINE_ALPHA_DISCARD");y.terrain&&y.terrain.clipOrMaskOverlapStencilType()&&(Ae=!1);for(const Re of b){const Xe=h.getTile(Re);if(ye&&!Xe.patternsLoaded())continue;const je=Xe.getBucket(p);if(!je)continue;y.prepareDrawTile();const Ke=je.programConfigurations.get(p.id),ft=y.useProgram(ve,Ke,Le),dt=ce.constantOr(null);if(dt&&Xe.imageAtlas){const ht=Xe.imageAtlas.patternPositions[dt.toString()];ht&&Ke.setConstantPatternPositions(ht)}const xt=W.constantOr(null),Tn=ne.constantOr(null);if(!ye&&xt&&Tn&&Xe.lineAtlas){const ht=Xe.lineAtlas.getDash(xt,Tn);ht&&Ke.setConstantPatternPositions(ht)}let[gt,Zt]=p.paint.get("line-trim-offset");(Tn==="round"||Tn==="square")&&gt!==Zt&&(gt===0&&(gt-=1),Zt===1&&(Zt+=1));const St=y.terrain?Re.projMatrix:null,un=ye?Rp(y,Xe,p,St,G):Vu(y,Xe,p,St,je.lineClipsArray.length,G,[gt,Zt]);if(_e){const ht=je.gradients[p.id];let Tt=ht.texture;if(p.gradientVersion!==ht.version){let en=256;if(p.stepInterpolant){const ln=h.getSource().maxzoom,ci=Re.canonical.z===ln?Math.ceil(1<<y.transform.maxZoom-Re.canonical.z):1;en=s.clamp(s.nextPowerOfTwo(je.maxLineLength/s.EXTENT*1024*ci),256,xe.maxTextureSize)}ht.gradient=s.renderColorRamp({expression:p.gradientExpression(),evaluationKey:"lineProgress",resolution:en,image:ht.gradient||void 0,clips:je.lineClipsArray}),ht.texture?ht.texture.update(ht.gradient):ht.texture=new s.Texture(xe,ht.gradient,se.RGBA),ht.version=p.gradientVersion,Tt=ht.texture}xe.activeTexture.set(se.TEXTURE1),Tt.bind(p.stepInterpolant?se.NEAREST:se.LINEAR,se.CLAMP_TO_EDGE)}X&&(xe.activeTexture.set(se.TEXTURE0),Xe.lineAtlasTexture.bind(se.LINEAR,se.REPEAT),Ke.updatePaintBuffers()),ye&&(xe.activeTexture.set(se.TEXTURE0),Xe.imageAtlasTexture.bind(se.LINEAR,se.CLAMP_TO_EDGE),Ke.updatePaintBuffers()),y.prepareDrawProgram(xe,ft,Re.toUnwrapped());const yt=ht=>{ft.draw(xe,se.TRIANGLES,P,ht,k,s.CullFaceMode.disabled,un,p.id,je.layoutVertexBuffer,je.indexBuffer,je.segments,p.paint,y.transform.zoom,Ke,[je.layoutVertexBuffer2])};if(Ae){const ht=y.stencilModeForClipping(Re).ref;ht===0&&y.terrain&&xe.clear({stencil:0});const Tt={func:se.EQUAL,mask:255};un.u_alpha_discard_threshold=.8,yt(new s.StencilMode(Tt,ht,255,se.KEEP,se.KEEP,se.INVERT)),un.u_alpha_discard_threshold=0,yt(new s.StencilMode(Tt,ht,255,se.KEEP,se.KEEP,se.KEEP))}else yt(y.stencilModeForClipping(Re))}Ae&&(y.resetStencilClippingMasks(),y.terrain&&xe.clear({stencil:0}))},fill:function(y,h,p,b){const w=p.paint.get("fill-color"),C=p.paint.get("fill-opacity");if(C.constantOr(1)===0)return;const P=y.colorModeForRenderPass(),k=p.paint.get("fill-pattern"),G=y.opaquePassEnabledForLayer()&&!k.constantOr(1)&&w.constantOr(s.Color.transparent).a===1&&C.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===G){const W=y.depthModeForSublayer(1,y.renderPass==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly);oi(y,h,p,b,W,P,!1)}if(y.renderPass==="translucent"&&p.paint.get("fill-antialias")){const W=y.depthModeForSublayer(p.getPaintProperty("fill-outline-color")?2:0,s.DepthMode.ReadOnly);oi(y,h,p,b,W,P,!0)}},"fill-extrusion":function(y,h,p,b){const w=p.paint.get("fill-extrusion-opacity");if(w!==0&&y.renderPass==="translucent"){const C=new s.DepthMode(y.context.gl.LEQUAL,s.DepthMode.ReadWrite,y.depthRangeFor3D);if(w!==1||p.paint.get("fill-extrusion-pattern").constantOr(1))Ui(y,h,p,b,C,s.StencilMode.disabled,s.ColorMode.disabled),Ui(y,h,p,b,C,y.stencilModeFor3D(),y.colorModeForRenderPass()),y.resetStencilClippingMasks();else{const P=y.colorModeForRenderPass();Ui(y,h,p,b,C,s.StencilMode.disabled,P)}}},hillshade:function(y,h,p,b){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;const w=y.context,C=y.depthModeForSublayer(0,s.DepthMode.ReadOnly),P=y.colorModeForRenderPass(),k=y.terrain&&y.terrain.renderingToTexture,[G,W]=y.renderPass!=="translucent"||k?[{},b]:y.stencilConfigForOverlap(b);for(const X of W){const ne=h.getTile(X);if(ne.needsHillshadePrepare&&y.renderPass==="offscreen")Xl(y,ne,p,C,s.StencilMode.disabled,P);else if(y.renderPass==="translucent"){const ce=k&&y.terrain?y.terrain.stencilModeForRTTOverlap(X):G[X.overscaledZ];Nu(y,X,ne,p,C,ce,P)}}w.viewport.set([0,0,y.width,y.height]),y.resetStencilClippingMasks()},raster:function(y,h,p,b,w,C){if(y.renderPass!=="translucent"||p.paint.get("raster-opacity")===0||!b.length)return;const P=y.context,k=P.gl,G=h.getSource(),W=y.useProgram("raster"),X=y.colorModeForRenderPass(),ne=y.terrain&&y.terrain.renderingToTexture,[ce,ye]=G instanceof We||ne?[{},b]:y.stencilConfigForOverlap(b),_e=ye[ye.length-1].overscaledZ,ve=!y.options.moving;for(const xe of ye){const se=ne?s.DepthMode.disabled:y.depthModeForSublayer(xe.overscaledZ-_e,p.paint.get("raster-opacity")===1?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly,k.LESS),Le=xe.toUnwrapped(),Ae=h.getTile(xe);if(ne&&(!Ae||!Ae.hasData()))continue;const Re=ne?xe.projMatrix:y.transform.calculateProjMatrix(Le,ve),Xe=y.terrain&&ne?y.terrain.stencilModeForRTTOverlap(xe):ce[xe.overscaledZ],je=C?0:p.paint.get("raster-fade-duration");Ae.registerFadeDuration(je);const Ke=h.findLoadedParent(xe,0),ft=gc(Ae,Ke,h,y.transform,je);let dt,xt;y.terrain&&y.terrain.prepareDrawTile();const Tn=p.paint.get("raster-resampling")==="nearest"?k.NEAREST:k.LINEAR;P.activeTexture.set(k.TEXTURE0),Ae.texture.bind(Tn,k.CLAMP_TO_EDGE),P.activeTexture.set(k.TEXTURE1),Ke?(Ke.texture.bind(Tn,k.CLAMP_TO_EDGE),dt=Math.pow(2,Ke.tileID.overscaledZ-Ae.tileID.overscaledZ),xt=[Ae.tileID.canonical.x*dt%1,Ae.tileID.canonical.y*dt%1]):Ae.texture.bind(Tn,k.CLAMP_TO_EDGE);const gt=yc(Re,xt||[0,0],dt||1,ft,p,G instanceof We?G.perspectiveTransform:[0,0]);if(y.prepareDrawProgram(P,W,Le),G instanceof We)G.boundsBuffer&&G.boundsSegments&&W.draw(P,k.TRIANGLES,se,s.StencilMode.disabled,X,s.CullFaceMode.disabled,gt,p.id,G.boundsBuffer,y.quadTriangleIndexBuffer,G.boundsSegments);else{const{tileBoundsBuffer:Zt,tileBoundsIndexBuffer:St,tileBoundsSegments:un}=y.getTileBoundsBuffers(Ae);W.draw(P,k.TRIANGLES,se,Xe,X,s.CullFaceMode.disabled,gt,p.id,Zt,St,un)}}y.resetStencilClippingMasks()},background:function(y,h,p,b){const w=p.paint.get("background-color"),C=p.paint.get("background-opacity");if(C===0)return;const P=y.context,k=P.gl,G=y.transform,W=G.tileSize,X=p.paint.get("background-pattern");if(y.isPatternMissing(X))return;const ne=!X&&w.a===1&&C===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==ne)return;const ce=s.StencilMode.disabled,ye=y.depthModeForSublayer(0,ne==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly),_e=y.colorModeForRenderPass(),ve=y.useProgram(X?"backgroundPattern":"background");let xe,se=b;se||(xe=y.getBackgroundTiles(),se=Object.values(xe).map(Le=>Le.tileID)),X&&(P.activeTexture.set(k.TEXTURE0),y.imageManager.bind(y.context));for(const Le of se){const Ae=Le.toUnwrapped(),Re=b?Le.projMatrix:y.transform.calculateProjMatrix(Ae);y.prepareDrawTile();const Xe=h?h.getTile(Le):xe?xe[Le.key]:new s.Tile(Le,W,G.zoom,y),je=X?Rs(Re,C,y,X,{tileID:Le,tileSize:W}):nr(Re,C,w);y.prepareDrawProgram(P,ve,Ae);const{tileBoundsBuffer:Ke,tileBoundsIndexBuffer:ft,tileBoundsSegments:dt}=y.getTileBoundsBuffers(Xe);ve.draw(P,k.TRIANGLES,ye,ce,_e,s.CullFaceMode.disabled,je,p.id,Ke,ft,dt)}},sky:function(y,h,p){const b=y.transform,w=b.projection.name==="mercator"||b.projection.name==="globe"?1:s.smoothstep(7,8,b.zoom),C=p.paint.get("sky-opacity")*w;if(C===0)return;const P=y.context,k=p.paint.get("sky-type"),G=new s.DepthMode(P.gl.LEQUAL,s.DepthMode.ReadOnly,[0,1]),W=y.frameCounter/1e3%1;k==="atmosphere"?y.renderPass==="offscreen"?p.needsSkyboxCapture(y)&&(function(X,ne,ce,ye){const _e=X.context,ve=_e.gl;let xe=ne.skyboxFbo;if(!xe){xe=ne.skyboxFbo=_e.createFramebuffer(32,32,!1),ne.skyboxGeometry=new vc(_e),ne.skyboxTexture=_e.gl.createTexture(),ve.bindTexture(ve.TEXTURE_CUBE_MAP,ne.skyboxTexture),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_WRAP_S,ve.CLAMP_TO_EDGE),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_WRAP_T,ve.CLAMP_TO_EDGE),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_MIN_FILTER,ve.LINEAR),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_MAG_FILTER,ve.LINEAR);for(let Re=0;Re<6;++Re)ve.texImage2D(ve.TEXTURE_CUBE_MAP_POSITIVE_X+Re,0,ve.RGBA,32,32,0,ve.RGBA,ve.UNSIGNED_BYTE,null)}_e.bindFramebuffer.set(xe.framebuffer),_e.viewport.set([0,0,32,32]);const se=ne.getCenter(X,!0),Le=X.useProgram("skyboxCapture"),Ae=new Float64Array(16);s.identity(Ae),s.rotateY(Ae,Ae,.5*-Math.PI),$i(_e,ne,Le,Ae,se,0),s.identity(Ae),s.rotateY(Ae,Ae,.5*Math.PI),$i(_e,ne,Le,Ae,se,1),s.identity(Ae),s.rotateX(Ae,Ae,.5*-Math.PI),$i(_e,ne,Le,Ae,se,2),s.identity(Ae),s.rotateX(Ae,Ae,.5*Math.PI),$i(_e,ne,Le,Ae,se,3),s.identity(Ae),$i(_e,ne,Le,Ae,se,4),s.identity(Ae),s.rotateY(Ae,Ae,Math.PI),$i(_e,ne,Le,Ae,se,5),_e.viewport.set([0,0,X.width,X.height])}(y,p),p.markSkyboxValid(y)):y.renderPass==="sky"&&function(X,ne,ce,ye,_e){const ve=X.context,xe=ve.gl,se=X.transform,Le=X.useProgram("skybox");ve.activeTexture.set(xe.TEXTURE0),xe.bindTexture(xe.TEXTURE_CUBE_MAP,ne.skyboxTexture);const Ae=((Re,Xe,je,Ke,ft)=>({u_matrix:Re,u_sun_direction:Xe,u_cubemap:0,u_opacity:Ke,u_temporal_offset:ft}))(se.skyboxMatrix,ne.getCenter(X,!1),0,ye,_e);X.prepareDrawProgram(ve,Le),Le.draw(ve,xe.TRIANGLES,ce,s.StencilMode.disabled,X.colorModeForRenderPass(),s.CullFaceMode.backCW,Ae,"skybox",ne.skyboxGeometry.vertexBuffer,ne.skyboxGeometry.indexBuffer,ne.skyboxGeometry.segment)}(y,p,G,C,W):k==="gradient"&&y.renderPass==="sky"&&function(X,ne,ce,ye,_e){const ve=X.context,xe=ve.gl,se=X.transform,Le=X.useProgram("skyboxGradient");ne.skyboxGeometry||(ne.skyboxGeometry=new vc(ve)),ve.activeTexture.set(xe.TEXTURE0);let Ae=ne.colorRampTexture;Ae||(Ae=ne.colorRampTexture=new s.Texture(ve,ne.colorRamp,xe.RGBA)),Ae.bind(xe.LINEAR,xe.CLAMP_TO_EDGE);const Re=((Xe,je,Ke,ft,dt)=>({u_matrix:Xe,u_color_ramp:0,u_center_direction:je,u_radius:s.degToRad(Ke),u_opacity:ft,u_temporal_offset:dt}))(se.skyboxMatrix,ne.getCenter(X,!1),ne.paint.get("sky-gradient-radius"),ye,_e);X.prepareDrawProgram(ve,Le),Le.draw(ve,xe.TRIANGLES,ce,s.StencilMode.disabled,X.colorModeForRenderPass(),s.CullFaceMode.backCW,Re,"skyboxGradient",ne.skyboxGeometry.vertexBuffer,ne.skyboxGeometry.indexBuffer,ne.skyboxGeometry.segment)}(y,p,G,C,W)},debug:function(y,h,p){for(let b=0;b<p.length;b++)Hu(y,h,p[b])},custom:function(y,h,p,b){const w=y.context,C=p.implementation;if(!y.transform.projection.unsupportedLayers||!y.transform.projection.unsupportedLayers.includes("custom")||y.terrain&&(y.terrain.renderingToTexture||y.renderPass==="offscreen")&&p.isLayerDraped()){if(y.renderPass==="offscreen"){const P=C.prerender;if(P){if(y.setCustomLayerDefaults(),w.setColorMode(y.colorModeForRenderPass()),y.transform.projection.name==="globe"){const k=y.transform.pointMerc;P.call(C,w.gl,y.transform.customLayerMatrix(),y.transform.getProjection(),y.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(y.transform.zoom),[k.x,k.y],y.transform.pixelsPerMeterRatio)}else P.call(C,w.gl,y.transform.customLayerMatrix());w.setDirty(),y.setBaseState()}}else if(y.renderPass==="translucent"){if(y.terrain&&y.terrain.renderingToTexture){const k=C.renderToTile;if(k){const G=b[0].canonical,W=new s.MercatorCoordinate(G.x+b[0].wrap*(1<<G.z),G.y,G.z);w.setDepthMode(s.DepthMode.disabled),w.setStencilMode(s.StencilMode.disabled),w.setColorMode(y.colorModeForRenderPass()),y.setCustomLayerDefaults(),k.call(C,w.gl,W),w.setDirty(),y.setBaseState()}return}y.setCustomLayerDefaults(),w.setColorMode(y.colorModeForRenderPass()),w.setStencilMode(s.StencilMode.disabled);const P=C.renderingMode==="3d"?new s.DepthMode(y.context.gl.LEQUAL,s.DepthMode.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,s.DepthMode.ReadOnly);if(w.setDepthMode(P),y.transform.projection.name==="globe"){const k=y.transform.pointMerc;C.render(w.gl,y.transform.customLayerMatrix(),y.transform.getProjection(),y.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(y.transform.zoom),[k.x,k.y],y.transform.pixelsPerMeterRatio)}else C.render(w.gl,y.transform.customLayerMatrix());w.setDirty(),y.setBaseState(),w.bindFramebuffer.set(null)}}else s.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class cu{constructor(h,p,b=!1){this.context=new we(h,b),this.transform=p,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=s.SourceCache.maxUnderzooming+s.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Tp,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(h,p){const b=!!h&&!!h.terrain&&this.transform.projection.supportsTerrain;if(!(b||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Bu(this,h));const w=this._terrain;this.transform.elevation=b?w:null,w.update(h,this.transform,p)}_updateFog(h){const p=h.fog;if(!p||this.transform.projection.name==="globe"||p.getOpacity(this.transform.pitch)<1||p.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[b,w]=p.getFovAdjustedRange(this.transform._fov);if(b>w)return void(this.transform.fogCullDistSq=null);const C=b+.78*(w-b);this.transform.fogCullDistSq=C*C}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(h,p){if(this.width=h*s.exported.devicePixelRatio,this.height=p*s.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const b of this.style.order)this.style._layers[b].resize()}setup(){const h=this.context,p=new s.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(s.EXTENT,0),p.emplaceBack(0,s.EXTENT),p.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=h.createVertexBuffer(p,s.posAttributes.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);const b=new s.StructArrayLayout2i4;b.emplaceBack(0,0),b.emplaceBack(s.EXTENT,0),b.emplaceBack(0,s.EXTENT),b.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=h.createVertexBuffer(b,s.posAttributes.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);const w=new s.StructArrayLayout2i4;w.emplaceBack(-1,-1),w.emplaceBack(1,-1),w.emplaceBack(-1,1),w.emplaceBack(1,1),this.viewportBuffer=h.createVertexBuffer(w,s.posAttributes.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);const C=new s.StructArrayLayout4i8;C.emplaceBack(0,0,0,0),C.emplaceBack(s.EXTENT,0,s.EXTENT,0),C.emplaceBack(0,s.EXTENT,0,s.EXTENT),C.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.mercatorBoundsBuffer=h.createVertexBuffer(C,s.boundsAttributes.members),this.mercatorBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);const P=new s.StructArrayLayout3ui6;P.emplaceBack(0,1,2),P.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=h.createIndexBuffer(P);const k=new s.StructArrayLayout1ui2;for(const W of[0,1,3,2,0])k.emplaceBack(W);this.debugIndexBuffer=h.createIndexBuffer(k),this.emptyTexture=new s.Texture(h,new s.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),h.gl.RGBA),this.identityMat=s.create();const G=this.context.gl;this.stencilClearMode=new s.StencilMode({func:G.ALWAYS,mask:0},0,255,G.ZERO,G.ZERO,G.ZERO),this.loadTimeStamps.push(s.window.performance.now()),this.atmosphereBuffer=new Em(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(h){return h._makeTileBoundsBuffers(this.context,this.transform.projection),h._tileBoundsBuffer?{tileBoundsBuffer:h._tileBoundsBuffer,tileBoundsIndexBuffer:h._tileBoundsIndexBuffer,tileBoundsSegments:h._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const h=this.context,p=h.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(h,p.TRIANGLES,s.DepthMode.disabled,this.stencilClearMode,s.ColorMode.disabled,s.CullFaceMode.disabled,Zi(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(h,p,b){if(!p||this.currentStencilSource===p.id||!h.isTileClipped()||!b||b.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let k=!1;for(const G of b)if(this._tileClippingMaskIDs[G.key]===void 0){k=!0;break}if(!k)return}this.currentStencilSource=p.id;const w=this.context,C=w.gl;this.nextStencilID+b.length>256&&this.clearStencil(),w.setColorMode(s.ColorMode.disabled),w.setDepthMode(s.DepthMode.disabled);const P=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const k of b){const G=p.getTile(k),W=this._tileClippingMaskIDs[k.key]=this.nextStencilID++,{tileBoundsBuffer:X,tileBoundsIndexBuffer:ne,tileBoundsSegments:ce}=this.getTileBoundsBuffers(G);P.draw(w,C.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:C.ALWAYS,mask:0},W,255,C.KEEP,C.KEEP,C.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,Zi(k.projMatrix),"$clipping",X,ne,ce)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const h=this.nextStencilID++,p=this.context.gl;return new s.StencilMode({func:p.NOTEQUAL,mask:255},h,255,p.KEEP,p.KEEP,p.REPLACE)}stencilModeForClipping(h){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(h);const p=this.context.gl;return new s.StencilMode({func:p.EQUAL,mask:255},this._tileClippingMaskIDs[h.key],0,p.KEEP,p.KEEP,p.REPLACE)}stencilConfigForOverlap(h){const p=this.context.gl,b=h.sort((P,k)=>k.overscaledZ-P.overscaledZ),w=b[b.length-1].overscaledZ,C=b[0].overscaledZ-w+1;if(C>1){this.currentStencilSource=void 0,this.nextStencilID+C>256&&this.clearStencil();const P={};for(let k=0;k<C;k++)P[k+w]=new s.StencilMode({func:p.GEQUAL,mask:255},k+this.nextStencilID,255,p.KEEP,p.KEEP,p.REPLACE);return this.nextStencilID+=C,[P,b]}return[{[w]:s.StencilMode.disabled},b]}colorModeForRenderPass(){const h=this.context.gl;return this._showOverdrawInspector?new s.ColorMode([h.CONSTANT_COLOR,h.ONE],new s.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?s.ColorMode.unblended:s.ColorMode.alphaBlended}depthModeForSublayer(h,p,b){if(!this.opaquePassEnabledForLayer())return s.DepthMode.disabled;const w=1-((1+this.currentLayer)*this.numSublayers+h)*this.depthEpsilon;return new s.DepthMode(b||this.context.gl.LEQUAL,p,[w,w])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(h,p){this.style=h,this.options=p,this.imageManager=h.imageManager,this.glyphManager=h.glyphManager,this.symbolFadeChange=h.placement.symbolFadeChange(s.exported.now()),this.imageManager.beginFrame();const b=this.style.order,w=this.style._sourceCaches;for(const G in w){const W=w[G];W.used&&W.prepare(this.context)}const C={},P={},k={};for(const G in w){const W=w[G];C[G]=W.getVisibleCoordinates(),P[G]=C[G].slice().reverse(),k[G]=W.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let G=0;G<b.length;G++)if(this.style._layers[b[G]].is3D()){this.opaquePassCutoff=G;break}if(this.terrain&&(this.terrain.updateTileBinding(k),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.GlobeSharedBuffers(this.context)),s.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const G of b){const W=this.style._layers[G],X=h._getLayerSourceCache(W);if(!W.hasOffscreenPass()||W.isHidden(this.transform.zoom))continue;const ne=X?P[X.id]:void 0;(W.type==="custom"||W.isSky()||ne&&ne.length)&&this.renderLayer(this,X,W,ne)}if(this.depthRangeFor3D=[0,1-(h.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:p.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=p.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=b.length-1;this.currentLayer>=0;this.currentLayer--){const G=this.style._layers[b[this.currentLayer]],W=h._getLayerSourceCache(G);if(G.isSky())continue;const X=W?P[W.id]:void 0;this._renderTileClippingMasks(G,W,X),this.renderLayer(this,W,G,X)}if(this.style.fog&&this.transform.projection.supportsFog&&function(G,W){const X=G.context,ne=X.gl,ce=G.transform,ye=new s.DepthMode(ne.LEQUAL,s.DepthMode.ReadOnly,[0,1]),_e=G.useProgram("globeAtmosphere",null,ce.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),ve=s.globeToMercatorTransition(ce.zoom),xe=W.properties.get("color").toArray01(),se=W.properties.get("high-color").toArray01(),Le=W.properties.get("space-color").toArray01PremultipliedAlpha(),Ae=s.identity$1([]);s.rotateY$1(Ae,Ae,-s.degToRad(ce._center.lng)),s.rotateX$1(Ae,Ae,s.degToRad(ce._center.lat)),s.rotateZ$1(Ae,Ae,ce.angle),s.rotateX$1(Ae,Ae,-ce._pitch);const Re=s.fromQuat(new Float32Array(16),Ae),Xe=s.mapValue(W.properties.get("star-intensity"),0,1,0,.25),je=5e-4,Ke=s.mapValue(W.properties.get("horizon-blend"),0,1,je,.25),ft=s.globeUseCustomAntiAliasing(G,X,ce)&&Ke===je?ce.worldSize/(2*Math.PI*1.025)-1:ce.globeRadius,dt=G.frameCounter/1e3%1,xt=s.length(ce.globeCenterInViewSpace),Tn=Math.sqrt(Math.pow(xt,2)-Math.pow(ft,2)),gt=Math.acos(Tn/xt),Zt=((un,yt,ht,Tt,en,ln,ci,ur,$n,Hn,di,vr,bi,Wr)=>({u_frustum_tl:un,u_frustum_tr:yt,u_frustum_br:ht,u_frustum_bl:Tt,u_horizon:en,u_transition:ln,u_fadeout_range:ci,u_color:ur,u_high_color:$n,u_space_color:Hn,u_star_intensity:di,u_star_size:5*s.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:vr,u_horizon_angle:bi,u_rotation_matrix:Wr}))(ce.frustumCorners.TL,ce.frustumCorners.TR,ce.frustumCorners.BR,ce.frustumCorners.BL,ce.frustumCorners.horizon,ve,Ke,xe,se,Le,Xe,dt,gt,Re);G.prepareDrawProgram(X,_e);const St=G.atmosphereBuffer;St&&_e.draw(X,ne.TRIANGLES,ye,s.StencilMode.disabled,s.ColorMode.alphaBlended,s.CullFaceMode.backCW,Zt,"skybox",St.vertexBuffer,St.indexBuffer,St.segments)}(this,this.style.fog),this.renderPass="sky",(s.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<b.length;this.currentLayer++){const G=this.style._layers[b[this.currentLayer]],W=h._getLayerSourceCache(G);G.isSky()&&this.renderLayer(this,W,G,W?P[W.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<b.length;){const G=this.style._layers[b[this.currentLayer]],W=h._getLayerSourceCache(G);if(G.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(G)){if(G.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const X=W?(G.type==="symbol"?k:P)[W.id]:void 0;this._renderTileClippingMasks(G,W,W?C[W.id]:void 0),this.renderLayer(this,W,G,X),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let G=null;s.values(this.style._layers).forEach(W=>{const X=h._getLayerSourceCache(W);X&&!W.isHidden(this.transform.zoom)&&(!G||G.getSource().maxzoom<X.getSource().maxzoom)&&(G=X)}),G&&this.options.showTileBoundaries&&Zh.debug(this,G,G.getVisibleCoordinates())}this.options.showPadding&&function(G){const W=G.transform.padding;ma(G,G.transform.height-(W.top||0),3,Js),ma(G,W.bottom||0,3,us),tl(G,W.left||0,3,Pd),tl(G,G.transform.width-(W.right||0),3,ms);const X=G.transform.centerPoint;(function(ne,ce,ye,_e){Co(ne,ce-1,ye-10,2,20,_e),Co(ne,ce-10,ye-1,20,2,_e)})(G,X.x,G.transform.height-X.y,gr)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(s.window.performance.now()),this.saveCanvasCopy())}}renderLayer(h,p,b,w){b.isHidden(this.transform.zoom)||(b.type==="background"||b.type==="sky"||b.type==="custom"||w&&w.length)&&(this.id=b.id,this.gpuTimingStart(b),(!h.transform.projection.unsupportedLayers||!h.transform.projection.unsupportedLayers.includes(b.type)||h.terrain&&b.type==="custom")&&Zh[b.type](h,p,b,w,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(h){if(!this.options.gpuTiming)return;const p=this.context.extTimerQuery;let b=this.gpuTimers[h.id];b||(b=this.gpuTimers[h.id]={calls:0,cpuTime:0,query:p.createQueryEXT()}),b.calls++,p.beginQueryEXT(p.TIME_ELAPSED_EXT,b.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const h=this.context.extTimerQuery,p=h.createQueryEXT();this.deferredRenderGpuTimeQueries.push(p),h.beginQueryEXT(h.TIME_ELAPSED_EXT,p)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const h=this.context.extTimerQuery;h.endQueryEXT(h.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery;h.endQueryEXT(h.TIME_ELAPSED_EXT)}collectGpuTimers(){const h=this.gpuTimers;return this.gpuTimers={},h}collectDeferredRenderGpuQueries(){const h=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],h}queryGpuTimers(h){const p={};for(const b in h){const w=h[b],C=this.context.extTimerQuery,P=C.getQueryObjectEXT(w.query,C.QUERY_RESULT_EXT)/1e6;C.deleteQueryEXT(w.query),p[b]=P}return p}queryGpuTimeDeferredRender(h){if(!this.options.gpuTimingDeferredRender)return 0;const p=this.context.extTimerQuery;let b=0;for(const w of h)b+=p.getQueryObjectEXT(w,p.QUERY_RESULT_EXT)/1e6,p.deleteQueryEXT(w);return b}translatePosMatrix(h,p,b,w,C){if(!b[0]&&!b[1])return h;const P=C?w==="map"?this.transform.angle:0:w==="viewport"?-this.transform.angle:0;if(P){const W=Math.sin(P),X=Math.cos(P);b=[b[0]*X-b[1]*W,b[0]*W+b[1]*X]}const k=[C?b[0]:Mt(p,b[0],this.transform.zoom),C?b[1]:Mt(p,b[1],this.transform.zoom),0],G=new Float32Array(16);return s.translate(G,h,k),G}saveTileTexture(h){const p=this._tileTextures[h.size[0]];p?p.push(h):this._tileTextures[h.size[0]]=[h]}getTileTexture(h){const p=this._tileTextures[h];return p&&p.length>0?p.pop():null}isPatternMissing(h){return h===null||h!==void 0&&!this.imageManager.getPattern(h.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const h=this.terrain&&this.terrain.renderingToTexture,p=this.terrain&&this.terrain.exaggeration()===0,b=this.style&&this.style.fog,w=[];return this.terrainRenderModeElevated()&&w.push("TERRAIN"),this.transform.projection.name==="globe"&&w.push("GLOBE"),p&&w.push("ZERO_EXAGGERATION"),b&&!h&&b.getOpacity(this.transform.pitch)!==0&&w.push("FOG"),h&&w.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&w.push("OVERDRAW_INSPECTOR"),w}useProgram(h,p,b){this.cache=this.cache||{};const w=b||[],C=this.currentGlobalDefines().concat(w),P=Hf.cacheKey(Da[h],h,C,p);return this.cache[P]||(this.cache[P]=new Hf(this.context,h,Da[h],p,yo[h],C)),this.cache[P]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const h=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(h.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(h,p,b){if(this.terrain&&this.terrain.renderingToTexture)return;const w=this.style.fog;if(w){const C=w.getOpacity(this.transform.pitch),P=((k,G,W,X,ne,ce,ye,_e,ve,xe,se)=>{const Le=k.transform,Ae=G.properties.get("color").toArray01();Ae[3]=X;const Re=k.frameCounter/1e3%1;return{u_fog_matrix:W?Le.calculateFogTileMatrix(W):k.identityMat,u_fog_range:G.getFovAdjustedRange(Le._fov),u_fog_color:Ae,u_fog_horizon_blend:G.properties.get("horizon-blend"),u_fog_temporal_offset:Re,u_frustum_tl:ne,u_frustum_tr:ce,u_frustum_br:ye,u_frustum_bl:_e,u_globe_pos:ve,u_globe_radius:xe,u_viewport:se,u_globe_transition:s.globeToMercatorTransition(Le.zoom),u_is_globe:+(Le.projection.name==="globe")}})(this,w,b,C,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.exported.devicePixelRatio,this.transform.height*s.exported.devicePixelRatio]);p.setFogUniformValues(h,P)}}setTileLoadedFlag(h){this.tileLoaded=h}saveCanvasCopy(){const h=this.canvasCopy();h&&(this.frameCopies.push(h),this.tileLoaded=!1)}canvasCopy(){const h=this.context.gl,p=h.createTexture();return h.bindTexture(h.TEXTURE_2D,p),h.copyTexImage2D(h.TEXTURE_2D,0,h.RGBA,0,0,h.drawingBufferWidth,h.drawingBufferHeight,0),p}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const h=this.style&&this.style.fog;return!!h&&h.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const h=this._backgroundTiles,p=this._backgroundTiles={},b=this.transform.coveringTiles({tileSize:512});for(const w of b)p[w.key]=h[w.key]||new s.Tile(w,512,this.transform.tileZoom,this);return p}clearBackgroundTiles(){this._backgroundTiles={}}}class il{constructor(h=0,p=0,b=0,w=0){if(isNaN(h)||h<0||isNaN(p)||p<0||isNaN(b)||b<0||isNaN(w)||w<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=h,this.bottom=p,this.left=b,this.right=w}interpolate(h,p,b){return p.top!=null&&h.top!=null&&(this.top=s.number(h.top,p.top,b)),p.bottom!=null&&h.bottom!=null&&(this.bottom=s.number(h.bottom,p.bottom,b)),p.left!=null&&h.left!=null&&(this.left=s.number(h.left,p.left,b)),p.right!=null&&h.right!=null&&(this.right=s.number(h.right,p.right,b)),this}getCenter(h,p){const b=s.clamp((this.left+h-this.right)/2,0,h),w=s.clamp((this.top+p-this.bottom)/2,0,p);return new s.pointGeometry(b,w)}equals(h){return this.top===h.top&&this.bottom===h.bottom&&this.left===h.left&&this.right===h.right}clone(){return new il(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function bc(y,h){const p=s.getColumn(y,3);s.fromQuat(y,h),s.setColumn(y,3,p)}function Yh(y,h){const p=s.identity$1([]);return s.rotateZ$1(p,p,-h),s.rotateX$1(p,p,-y),p}function xc(y,h){const p=[y[0],y[1],0],b=[h[0],h[1],0];if(s.length(p)>=1e-15){const P=s.normalize([],p);s.scale$2(b,P,s.dot(b,P)),h[0]=b[0],h[1]=b[1]}const w=s.cross([],h,y);if(s.len(w)<1e-15)return null;const C=Math.atan2(-w[1],w[0]);return Yh(Math.atan2(Math.sqrt(y[0]*y[0]+y[1]*y[1]),-y[2]),C)}class Ec{constructor(h,p){this.position=h,this.orientation=p}get position(){return this._position}set position(h){if(h){const p=h instanceof s.MercatorCoordinate?h:new s.MercatorCoordinate(h[0],h[1],h[2]);this._renderWorldCopies&&(p.x=s.wrap(p.x,0,1)),this._position=p}else this._position=null}lookAtPoint(h,p){if(this.orientation=null,!this.position)return;const b=this._elevation?this._elevation.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(h)):0,w=this.position,C=s.MercatorCoordinate.fromLngLat(h,b),P=[C.x-w.x,C.y-w.y,C.z-w.z];p||(p=[0,0,1]),p[2]=Math.abs(p[2]),this.orientation=xc(P,p)}setPitchBearing(h,p){this.orientation=Yh(s.degToRad(h),s.degToRad(-p))}}class Wf{constructor(h,p){this._transform=s.identity([]),this.orientation=p,this.position=h}get mercatorPosition(){const h=this.position;return new s.MercatorCoordinate(h[0],h[1],h[2])}get position(){const h=s.getColumn(this._transform,3);return[h[0],h[1],h[2]]}set position(h){var p;h&&s.setColumn(this._transform,3,[(p=h)[0],p[1],p[2],1])}get orientation(){return this._orientation}set orientation(h){this._orientation=h||s.identity$1([]),h&&bc(this._transform,this._orientation)}getPitchBearing(){const h=this.forward(),p=this.right();return{bearing:Math.atan2(-p[1],p[0]),pitch:Math.atan2(Math.sqrt(h[0]*h[0]+h[1]*h[1]),-h[2])}}setPitchBearing(h,p){this._orientation=Yh(h,p),bc(this._transform,this._orientation)}forward(){const h=s.getColumn(this._transform,2);return[-h[0],-h[1],-h[2]]}up(){const h=s.getColumn(this._transform,1);return[-h[0],-h[1],-h[2]]}right(){const h=s.getColumn(this._transform,0);return[h[0],h[1],h[2]]}getCameraToWorld(h,p){const b=new Float64Array(16);return s.invert(b,this.getWorldToCamera(h,p)),b}getWorldToCameraPosition(h,p,b){const w=this.position;s.scale$2(w,w,-h);const C=new Float64Array(16);return s.fromScaling(C,[b,b,b]),s.translate(C,C,w),C[10]*=p,C}getWorldToCamera(h,p){const b=new Float64Array(16),w=new Float64Array(4),C=this.position;return s.conjugate(w,this._orientation),s.scale$2(C,C,-h),s.fromQuat(b,w),s.translate(b,b,C),b[1]*=-1,b[5]*=-1,b[9]*=-1,b[13]*=-1,b[8]*=p,b[9]*=p,b[10]*=p,b[11]*=p,b}getCameraToClipPerspective(h,p,b,w){const C=new Float64Array(16);return s.perspective(C,h,p,b,w),C}getDistanceToElevation(h,p=!1){const b=h===0?0:s.mercatorZfromAltitude(h,p?s.latFromMercatorY(this.position[1]):this.position[1]),w=this.forward();return(b-this.position[2])/w[2]}clone(){return new Wf([...this.position],[...this.orientation])}}function ih(y,h){const p=ju(y.projection,y.zoom,y.width,y.height),b=function(C,P,k,G,W){const X=new s.LngLat(k.lng-180*Jl,k.lat),ne=new s.LngLat(k.lng+180*Jl,k.lat),ce=C.project(X.lng,X.lat),ye=C.project(ne.lng,ne.lat),_e=-Math.atan2(ye.y-ce.y,ye.x-ce.x),ve=s.MercatorCoordinate.fromLngLat(k);ve.y=s.clamp(ve.y,-.999975,.999975);const xe=ve.toLngLat(),se=C.project(xe.lng,xe.lat),Le=s.MercatorCoordinate.fromLngLat(xe);Le.x+=Jl;const Ae=Le.toLngLat(),Re=C.project(Ae.lng,Ae.lat),Xe=Dp(Re.x-se.x,Re.y-se.y,_e),je=s.MercatorCoordinate.fromLngLat(xe);je.y+=Jl;const Ke=je.toLngLat(),ft=C.project(Ke.lng,Ke.lat),dt=Dp(ft.x-se.x,ft.y-se.y,_e),xt=Math.abs(Xe.x)/Math.abs(dt.y),Tn=s.identity([]);s.rotateZ(Tn,Tn,-_e*(1-(W?0:G)));const gt=s.identity([]);return s.scale(gt,gt,[1,1-(1-xt)*G,1]),gt[4]=-dt.x/dt.y*G,s.rotateZ(gt,gt,_e),s.multiply(gt,Tn,gt),gt}(y.projection,0,y.center,p,h),w=Pp(y);return s.scale(b,b,[w,w,1]),b}function Pp(y){const h=y.projection,p=ju(y.projection,y.zoom,y.width,y.height),b=Kh(h,y.center),w=Kh(h,s.LngLat.convert(h.center));return Math.pow(2,b*p+(1-p)*w)}function ju(y,h,p,b,w=1/0){const C=y.range;if(!C)return 0;const P=Math.min(w,Math.max(p,b)),k=Math.log(P/1024)/Math.LN2;return s.smoothstep(C[0]+k,C[1]+k,h)}const Jl=1/4e4;function Kh(y,h){const p=s.clamp(h.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),b=new s.LngLat(h.lng-180*Jl,p),w=new s.LngLat(h.lng+180*Jl,p),C=y.project(b.lng,p),P=y.project(w.lng,p),k=s.MercatorCoordinate.fromLngLat(b),G=s.MercatorCoordinate.fromLngLat(w),W=P.x-C.x,X=P.y-C.y,ne=G.x-k.x,ce=G.y-k.y,ye=Math.sqrt((ne*ne+ce*ce)/(W*W+X*X));return Math.log(ye)/Math.LN2}function Dp(y,h,p){const b=Math.cos(p),w=Math.sin(p);return{x:y*b-h*w,y:y*w+h*b}}class Vn{constructor(h,p,b,w,C,P,k){this.tileSize=512,this._renderWorldCopies=C===void 0||C,this._minZoom=h||0,this._maxZoom=p||22,this._minPitch=b??0,this._maxPitch=w??60,this.setProjection(P),this.setMaxBounds(k),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new il,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Wf,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const h=new Vn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return h._elevation=this._elevation,h._centerAltitude=this._centerAltitude,h._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,h.tileSize=this.tileSize,h.mercatorFromTransition=this.mercatorFromTransition,h.width=this.width,h.height=this.height,h.cameraElevationReference=this.cameraElevationReference,h._center=this._center,h._setZoom(this.zoom),h._seaLevelZoom=this._seaLevelZoom,h.angle=this.angle,h._fov=this._fov,h._pitch=this._pitch,h._nearZ=this._nearZ,h._farZ=this._farZ,h._averageElevation=this._averageElevation,h._unmodified=this._unmodified,h._edgeInsets=this._edgeInsets.clone(),h._camera=this._camera.clone(),h._calcMatrices(),h.freezeTileCoverage=this.freezeTileCoverage,h.frustumCorners=this.frustumCorners,h}get elevation(){return this._elevation}set elevation(h){this._elevation!==h&&(this._elevation=h,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(h,p=!1){const b=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||b)&&this._updateCameraOnTerrain(),(h||b)&&this._constrainCamera(p),this._calcMatrices()}getProjection(){return s.pick(this.projection,["name","center","parallels"])}setProjection(h){this.projectionOptions=h||{name:"mercator"};const p=this.projection?this.getProjection():void 0;this.projection=s.getProjection(this.projectionOptions);const b=!d(p,this.getProjection());return b&&this._calcMatrices(),this.mercatorFromTransition=!1,b}setMercatorFromTransition(){const h=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.getProjection({name:"mercator"});const p=h!==this.projection.name;return p&&this._calcMatrices(),p}get minZoom(){return this._minZoom}set minZoom(h){this._minZoom!==h&&(this._minZoom=h,this.zoom=Math.max(this.zoom,h))}get maxZoom(){return this._maxZoom}set maxZoom(h){this._maxZoom!==h&&(this._maxZoom=h,this.zoom=Math.min(this.zoom,h))}get minPitch(){return this._minPitch}set minPitch(h){this._minPitch!==h&&(this._minPitch=h,this.pitch=Math.max(this.pitch,h))}get maxPitch(){return this._maxPitch}set maxPitch(h){this._maxPitch!==h&&(this._maxPitch=h,this.pitch=Math.min(this.pitch,h))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(h){h===void 0?h=!0:h===null&&(h=!1),this._renderWorldCopies=h}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const h=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(h))}get cameraWorldSize(){const h=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(h))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.pointGeometry(this.width,this.height)}get bearing(){return s.wrap(this.rotation,-180,180)}set bearing(h){this.rotation=h}get rotation(){return-this.angle/Math.PI*180}set rotation(h){const p=-h*Math.PI/180;var b;this.angle!==p&&(this._unmodified=!1,this.angle=p,this._calcMatrices(),this.rotationMatrix=(b=new s.ARRAY_TYPE(4),s.ARRAY_TYPE!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b),function(w,C,P){var k=C[0],G=C[1],W=C[2],X=C[3],ne=Math.sin(P),ce=Math.cos(P);w[0]=k*ce+W*ne,w[1]=G*ce+X*ne,w[2]=k*-ne+W*ce,w[3]=G*-ne+X*ce}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(h){const p=s.clamp(h,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==p&&(this._unmodified=!1,this._pitch=p,this._calcMatrices())}get aspect(){return this.width/this.height}get fovX(){return this._fov}get fovY(){const h=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/h)}set fov(h){h=Math.max(.01,Math.min(60,h)),this._fov!==h&&(this._unmodified=!1,this._fov=s.degToRad(h),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(h){this._averageElevation=h,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(h){const p=Math.min(Math.max(h,this.minZoom),this.maxZoom);this._zoom!==p&&(this._unmodified=!1,this._setZoom(p),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(h){this._zoom=h,this.scale=this.zoomScale(h),this.tileZoom=Math.floor(h),this.zoomFraction=h-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const h=this._elevation;this._centerAltitude=h.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=h.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const h=this._elevation,p=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],b=this.horizonLineFromTop();let w=0,C=0;for(let P=0;P<p.length;P++){const k=new s.pointGeometry(p[P][0]*this.width,b+p[P][1]*(this.height-b)),G=h.pointCoordinate(k);if(!G)continue;const W=1/Math.hypot(G[0]-this._camera.position[0],G[1]-this._camera.position[1]);w+=G[3]*W,C+=W}return C===0?NaN:w/C}get center(){return this._center}set center(h){h.lat===this._center.lat&&h.lng===this._center.lng||(this._unmodified=!1,this._center=h,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const h=this._seaLevelZoom,p=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),b=this.pixelsPerMeter/this.worldSize*p,w=this._mercatorZfromZoom(h),C=this._mercatorZfromZoom(this._maxZoom),P=Math.max(w-b,C);this._setZoom(this._zoomFromMercatorZ(P))}get padding(){return this._edgeInsets.toJSON()}set padding(h){this._edgeInsets.equals(h)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,h,1),this._calcMatrices())}computeZoomRelativeTo(h){const p=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,h.toAltitude()));let b;b=h.z<this._camera.position[2]?[p.x,p.y,p.z]:[h.x,h.y,h.z];const w=s.length(s.sub([],this._camera.position,b));return s.clamp(this._zoomFromMercatorZ(w),this._minZoom,this._maxZoom)}setFreeCameraOptions(h){if(!this.height||!h.position&&!h.orientation)return;this._updateCameraState();let p=!1;if(h.orientation&&!s.exactEquals(h.orientation,this._camera.orientation)&&(p=this._setCameraOrientation(h.orientation)),h.position){const b=[h.position.x,h.position.y,h.position.z];s.exactEquals$1(b,this._camera.position)||(this._setCameraPosition(b),p=!0)}p&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const h=this._camera.position,p=new Ec;return p.position=new s.MercatorCoordinate(h[0],h[1],h[2]),p.orientation=this._camera.orientation,p._elevation=this.elevation,p._renderWorldCopies=this.renderWorldCopies,p}_setCameraOrientation(h){if(!s.length$1(h))return!1;s.normalize$1(h,h);const p=s.transformQuat([],[0,0,-1],h),b=s.transformQuat([],[0,-1,0],h);if(b[2]<0)return!1;const w=xc(p,b);return!!w&&(this._camera.orientation=w,!0)}_setCameraPosition(h){const p=this.zoomScale(this.minZoom)*this.tileSize,b=this.zoomScale(this.maxZoom)*this.tileSize,w=this.cameraToCenterDistance;h[2]=s.clamp(h[2],w/b,w/p),this._camera.position=h}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(h){return this._edgeInsets.equals(h)}interpolatePadding(h,p,b){this._unmodified=!1,this._edgeInsets.interpolate(h,p,b),this._constrain(),this._calcMatrices()}coveringZoomLevel(h){const p=(h.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/h.tileSize));return Math.max(0,p)}getVisibleUnwrappedCoordinates(h){const p=[new s.UnwrappedTileID(0,h)];if(this.renderWorldCopies){const b=this.pointCoordinate(new s.pointGeometry(0,0)),w=this.pointCoordinate(new s.pointGeometry(this.width,0)),C=this.pointCoordinate(new s.pointGeometry(this.width,this.height)),P=this.pointCoordinate(new s.pointGeometry(0,this.height)),k=Math.floor(Math.min(b.x,w.x,C.x,P.x)),G=Math.floor(Math.max(b.x,w.x,C.x,P.x)),W=1;for(let X=k-W;X<=G+W;X++)X!==0&&p.push(new s.UnwrappedTileID(X,h))}return p}coveringTiles(h){let p=this.coveringZoomLevel(h);const b=p,w=this.elevation&&!h.isTerrainDEM,C=this.projection.name==="mercator";if(h.minzoom!==void 0&&p<h.minzoom)return[];h.maxzoom!==void 0&&p>h.maxzoom&&(p=h.maxzoom);const P=this.locationCoordinate(this.center),k=this.center.lat,G=1<<p,W=[G*P.x,G*P.y,0],X=this.projection.name==="globe",ne=!X,ce=s.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,p,ne),ye=X?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),_e=G*s.mercatorZfromAltitude(1,this.center.lat),ve=this._camera.position[2]/s.mercatorZfromAltitude(1,this.center.lat),xe=[G*ye.x,G*ye.y,ve*(ne?1:_e)],se=this.cameraToCenterDistance/h.tileSize*(h.roundZoom?1:.502),Le=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?p:0,Ae=h.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Re=h.isTerrainDEM?-Ae:this._elevation?this._elevation.getMinElevationBelowMSL():0,Xe=this.projection.isReprojectedInTileSpace?Pp(this):1,je=yt=>{const Tt=new s.MercatorCoordinate(yt.x+25e-6,yt.y,yt.z),en=new s.MercatorCoordinate(yt.x,yt.y+25e-6,yt.z),ln=yt.toLngLat(),ci=Tt.toLngLat(),ur=en.toLngLat(),$n=this.locationCoordinate(ln),Hn=this.locationCoordinate(ci),di=this.locationCoordinate(ur),vr=Math.hypot(Hn.x-$n.x,Hn.y-$n.y),bi=Math.hypot(di.x-$n.x,di.y-$n.y);return Math.sqrt(vr*bi)*Xe/25e-6},Ke=yt=>{const ht=Ae,Tt=Re;return{aabb:s.tileAABB(this,G,0,0,0,yt,Tt,ht,this.projection),zoom:0,x:0,y:0,minZ:Tt,maxZ:ht,wrap:yt,fullyVisible:!1}},ft=[];let dt=[];const xt=p,Tn=h.reparseOverscaled?b:p,gt=yt=>yt*yt,Zt=gt((ve-this._centerAltitude)*_e),St=yt=>{if(!this._elevation||!yt.tileID||!C)return;const ht=this._elevation.getMinMaxForTile(yt.tileID),Tt=yt.aabb;ht?(Tt.min[2]=ht.min,Tt.max[2]=ht.max,Tt.center[2]=(Tt.min[2]+Tt.max[2])/2):(yt.shouldSplit=un(yt),yt.shouldSplit||(Tt.min[2]=Tt.max[2]=Tt.center[2]=this._centerAltitude))},un=yt=>{if(yt.zoom<Le)return!0;if(yt.zoom===xt)return!1;if(yt.shouldSplit!=null)return yt.shouldSplit;const ht=yt.aabb.distanceX(xe),Tt=yt.aabb.distanceY(xe);let en=Zt,ln=1;if(X){en=gt(yt.aabb.distanceZ(xe));const $n=Math.pow(2,yt.zoom),Hn=s.latFromMercatorY((yt.y+1)/$n),di=s.latFromMercatorY(yt.y/$n),vr=Math.min(Math.max(k,Hn),di),bi=s.circumferenceAtLatitude(vr)/s.circumferenceAtLatitude(k);if(ln=vr===k?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,bi/this._mercatorScaleRatio),this.zoom<=s.GLOBE_ZOOM_THRESHOLD_MIN&&yt.zoom===xt-1&&bi>=.9)return!0}else if(w&&(en=gt(yt.aabb.distanceZ(xe)*_e)),this.projection.isReprojectedInTileSpace&&b<=5){const $n=Math.pow(2,yt.zoom),Hn=je(new s.MercatorCoordinate((yt.x+.5)/$n,(yt.y+.5)/$n));ln=Hn>.85?1:Hn}const ci=ht*ht+Tt*Tt+en,ur=gt((1<<xt-yt.zoom)*se*ln*(($n,Hn)=>{if(Hn*gt(.707)<$n)return 1;const di=Math.sqrt(Hn/$n);return di/(1.4144271570014144+(Math.pow(1.1,di-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(en,Zt),ci));return ci<ur};if(this.renderWorldCopies)for(let yt=1;yt<=3;yt++)ft.push(Ke(-yt)),ft.push(Ke(yt));for(ft.push(Ke(0));ft.length>0;){const yt=ft.pop(),ht=yt.x,Tt=yt.y;let en=yt.fullyVisible;if(!en){const ln=yt.aabb.intersects(ce);if(ln===0)continue;en=ln===2}if(yt.zoom!==xt&&un(yt))for(let ln=0;ln<4;ln++){const ci=(ht<<1)+ln%2,ur=(Tt<<1)+(ln>>1),$n={aabb:C?yt.aabb.quadrant(ln):s.tileAABB(this,G,yt.zoom+1,ci,ur,yt.wrap,yt.minZ,yt.maxZ,this.projection),zoom:yt.zoom+1,x:ci,y:ur,wrap:yt.wrap,fullyVisible:en,tileID:void 0,shouldSplit:void 0,minZ:yt.minZ,maxZ:yt.maxZ};w&&!X&&($n.tileID=new s.OverscaledTileID(yt.zoom+1===xt?Tn:yt.zoom+1,yt.wrap,yt.zoom+1,ci,ur),St($n)),ft.push($n)}else{const ln=yt.zoom===xt?Tn:yt.zoom;if(h.minzoom&&h.minzoom>ln)continue;const ci=W[0]-(.5+ht+(yt.wrap<<yt.zoom))*(1<<p-yt.zoom),ur=W[1]-.5-Tt,$n=yt.tileID?yt.tileID:new s.OverscaledTileID(ln,yt.wrap,yt.zoom,ht,Tt);dt.push({tileID:$n,distanceSq:ci*ci+ur*ur})}}if(this.fogCullDistSq){const yt=this.fogCullDistSq,ht=this.horizonLineFromTop();dt=dt.filter(Tt=>{const en=[0,0,0,1],ln=[s.EXTENT,s.EXTENT,0,1],ci=this.calculateFogTileMatrix(Tt.tileID.toUnwrapped());s.transformMat4$1(en,en,ci),s.transformMat4$1(ln,ln,ci);const ur=s.getAABBPointSquareDist(en,ln);if(ur===0)return!0;let $n=!1;const Hn=this._elevation;if(Hn&&ur>yt&&ht!==0){const di=this.calculateProjMatrix(Tt.tileID.toUnwrapped());let vr;h.isTerrainDEM||(vr=Hn.getMinMaxForTile(Tt.tileID)),vr||(vr={min:Re,max:Ae});const bi=s.furthestTileCorner(this.rotation),Wr=[bi[0]*s.EXTENT,bi[1]*s.EXTENT,vr.max];s.transformMat4(Wr,Wr,di),$n=(1-Wr[1])*this.height*.5<ht}return ur<yt||$n})}return dt.sort((yt,ht)=>yt.distanceSq-ht.distanceSq).map(yt=>yt.tileID)}resize(h,p){this.width=h,this.height=p,this.pixelsToGLUnits=[2/h,-2/p],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(h){return Math.pow(2,h)}scaleZoom(h){return Math.log(h)/Math.LN2}project(h){const p=s.clamp(h.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),b=this.projection.project(h.lng,p);return new s.pointGeometry(b.x*this.worldSize,b.y*this.worldSize)}unproject(h){return this.projection.unproject(h.x/this.worldSize,h.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/s.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(h,p){let b,w;const C=this.centerPoint;if(this.projection.name==="globe"){const k=this.worldSize;b=(p.x-C.x)/k,w=(p.y-C.y)/k}else{const k=this.pointCoordinate(p),G=this.pointCoordinate(C);b=k.x-G.x,w=k.y-G.y}const P=this.locationCoordinate(h);this.setLocation(new s.MercatorCoordinate(P.x-b,P.y-w))}setLocation(h){this.center=this.coordinateLocation(h),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(h){return this.projection.locationPoint(this,h)}locationPoint3D(h){return this.projection.locationPoint(this,h,!0)}pointLocation(h){return this.coordinateLocation(this.pointCoordinate(h))}pointLocation3D(h){return this.coordinateLocation(this.pointCoordinate3D(h))}locationCoordinate(h,p){const b=p?s.mercatorZfromAltitude(p,h.lat):void 0,w=this.projection.project(h.lng,h.lat);return new s.MercatorCoordinate(w.x,w.y,b)}coordinateLocation(h){return this.projection.unproject(h.x,h.y)}pointRayIntersection(h,p){const b=p??this._centerAltitude,w=[h.x,h.y,0,1],C=[h.x,h.y,1,1];s.transformMat4$1(w,w,this.pixelMatrixInverse),s.transformMat4$1(C,C,this.pixelMatrixInverse);const P=C[3];s.scale$1(w,w,1/w[3]),s.scale$1(C,C,1/P);const k=w[2],G=C[2];return{p0:w,p1:C,t:k===G?0:(b-k)/(G-k)}}screenPointToMercatorRay(h){const p=[h.x,h.y,0,1],b=[h.x,h.y,1,1];return s.transformMat4$1(p,p,this.pixelMatrixInverse),s.transformMat4$1(b,b,this.pixelMatrixInverse),s.scale$1(p,p,1/p[3]),s.scale$1(b,b,1/b[3]),p[2]=s.mercatorZfromAltitude(p[2],this._center.lat)*this.worldSize,b[2]=s.mercatorZfromAltitude(b[2],this._center.lat)*this.worldSize,s.scale$1(p,p,1/this.worldSize),s.scale$1(b,b,1/this.worldSize),new s.Ray([p[0],p[1],p[2]],s.normalize([],s.sub([],b,p)))}rayIntersectionCoordinate(h){const{p0:p,p1:b,t:w}=h,C=s.mercatorZfromAltitude(p[2],this._center.lat),P=s.mercatorZfromAltitude(b[2],this._center.lat);return new s.MercatorCoordinate(s.number(p[0],b[0],w)/this.worldSize,s.number(p[1],b[1],w)/this.worldSize,s.number(C,P,w))}pointCoordinate(h,p=this._centerAltitude){return this.projection.pointCoordinate(this,h.x,h.y,p)}pointCoordinate3D(h){if(!this.elevation)return this.pointCoordinate(h);let p=this.projection.pointCoordinate3D(this,h.x,h.y);if(p)return new s.MercatorCoordinate(p[0],p[1],p[2]);let b=0,w=this.horizonLineFromTop();if(h.y>w)return this.pointCoordinate(h);const C=.02*w,P=h.clone();for(let k=0;k<10&&w-b>C;k++){P.y=s.number(b,w,.66);const G=this.projection.pointCoordinate3D(this,P.x,P.y);G?(w=P.y,p=G):b=P.y}return p?new s.MercatorCoordinate(p[0],p[1],p[2]):this.pointCoordinate(h)}isPointAboveHorizon(h){return this.projection.isPointAboveHorizon(this,h)}_coordinatePoint(h,p){const b=p&&this.elevation?this.elevation.getAtPointOrZero(h,this._centerAltitude):this._centerAltitude,w=[h.x*this.worldSize,h.y*this.worldSize,b+h.toAltitude(),1];return s.transformMat4$1(w,w,this.pixelMatrix),w[3]>0?new s.pointGeometry(w[0]/w[3],w[1]/w[3]):new s.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:h,left:p}=this._edgeInsets,b=this.height-this._edgeInsets.bottom,w=this.width-this._edgeInsets.right,C=this.pointLocation3D(new s.pointGeometry(p,h)),P=this.pointLocation3D(new s.pointGeometry(w,h)),k=this.pointLocation3D(new s.pointGeometry(w,b)),G=this.pointLocation3D(new s.pointGeometry(p,b));let W=Math.min(C.lng,P.lng,k.lng,G.lng),X=Math.max(C.lng,P.lng,k.lng,G.lng),ne=Math.min(C.lat,P.lat,k.lat,G.lat),ce=Math.max(C.lat,P.lat,k.lat,G.lat);const ye=Math.pow(2,-this.zoom)/16*270,_e=this.projection.name==="globe"?1:4,ve=(xe,se,Le,Ae,Re)=>{const Xe=(xe+Le)/2,je=(se+Ae)/2,Ke=new s.pointGeometry(Xe,je),{lng:ft,lat:dt}=this.pointLocation3D(Ke),xt=Math.max(0,W-ft,ne-dt,ft-X,dt-ce);W=Math.min(W,ft),X=Math.max(X,ft),ne=Math.min(ne,dt),ce=Math.max(ce,dt),(Re<_e||xt>ye)&&(ve(xe,se,Xe,je,Re+1),ve(Xe,je,Le,Ae,Re+1))};if(ve(p,h,w,h,1),ve(w,h,w,b,1),ve(w,b,p,b,1),ve(p,b,p,h,1),this.projection.name==="globe"){const[xe,se]=s.polesInViewport(this);xe?(ce=90,X=180,W=-180):se&&(ne=-90,X=180,W=-180)}return new s.LngLatBounds(new s.LngLat(W,ne),new s.LngLat(X,ce))}_getBoundsRectangular(h,p){const{top:b,left:w}=this._edgeInsets,C=this.height-this._edgeInsets.bottom,P=this.width-this._edgeInsets.right,k=new s.pointGeometry(w,b),G=new s.pointGeometry(P,b),W=new s.pointGeometry(P,C),X=new s.pointGeometry(w,C);let ne=this.pointCoordinate(k,h),ce=this.pointCoordinate(G,h);const ye=this.pointCoordinate(W,p),_e=this.pointCoordinate(X,p),ve=(xe,se)=>(se.y-xe.y)/(se.x-xe.x);return ne.y>1&&ce.y>=0?ne=new s.MercatorCoordinate((1-_e.y)/ve(_e,ne)+_e.x,1):ne.y<0&&ce.y<=1&&(ne=new s.MercatorCoordinate(-_e.y/ve(_e,ne)+_e.x,0)),ce.y>1&&ne.y>=0?ce=new s.MercatorCoordinate((1-ye.y)/ve(ye,ce)+ye.x,1):ce.y<0&&ne.y<=1&&(ce=new s.MercatorCoordinate(-ye.y/ve(ye,ce)+ye.x,0)),new s.LngLatBounds().extend(this.coordinateLocation(ne)).extend(this.coordinateLocation(ce)).extend(this.coordinateLocation(_e)).extend(this.coordinateLocation(ye))}_getBoundsRectangularTerrain(){const h=this.elevation;if(!h.visibleDemTiles.length||h.isUsingMockSource())return this._getBoundsRectangular(0,0);const p=h.visibleDemTiles.reduce((b,w)=>{if(w.dem){const C=w.dem.tree;b.min=Math.min(b.min,C.minimums[0]),b.max=Math.max(b.max,C.maximums[0])}return b},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(p.min*h.exaggeration(),p.max*h.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(h=!0){const p=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,b=this.height/2-p*(1-this._horizonShift);return h?Math.max(0,b):b}getMaxBounds(){return this.maxBounds}setMaxBounds(h){this.maxBounds=h,this.minLat=-s.MAX_MERCATOR_LATITUDE,this.maxLat=s.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,h&&(this.minLat=h.getSouth(),this.maxLat=h.getNorth(),this.minLng=h.getWest(),this.maxLng=h.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=s.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=s.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=s.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(h,p){return this.projection.createTileMatrix(this,p,h)}calculateDistanceTileData(h){const p=h.key,b=this._distanceTileDataCache;if(b[p])return b[p];const w=h.canonical,C=1/this.height,P=this.cameraWorldSize,k=P/this.zoomScale(w.z),G=(w.x+Math.pow(2,w.z)*h.wrap)*k,W=w.y*k,X=this.point;X.x*=P/this.worldSize,X.y*=P/this.worldSize;const ne=this.angle,ce=Math.sin(-ne),ye=-Math.cos(-ne);return b[p]={bearing:[ce,ye],center:[(X.x-G)*C,(X.y-W)*C],scale:k/s.EXTENT*C},b[p]}calculateFogTileMatrix(h){const p=h.key,b=this._fogTileMatrixCache;if(b[p])return b[p];const w=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,h);return s.multiply(w,this.worldToFogMatrix,w),b[p]=new Float32Array(w),b[p]}calculateProjMatrix(h,p=!1){const b=h.key,w=p?this._alignedProjMatrixCache:this._projMatrixCache;if(w[b])return w[b];const C=this.calculatePosMatrix(h,this.worldSize);return s.multiply(C,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:p?this.alignedProjMatrix:this.projMatrix,C),w[b]=new Float32Array(C),w[b]}calculatePixelsToTileUnitsMatrix(h){const p=h.tileID.key,b=this._pixelsToTileUnitsCache;if(b[p])return b[p];const w=function(C,P){const{scale:k}=C.tileTransform,G=k*s.EXTENT/(C.tileSize*Math.pow(2,P.zoom-C.tileID.overscaledZ+C.tileID.canonical.z));return W=new Float32Array(4),ce=(X=P.inverseAdjustmentMatrix)[1],ye=X[2],_e=X[3],xe=(ne=[G,G])[1],W[0]=X[0]*(ve=ne[0]),W[1]=ce*ve,W[2]=ye*xe,W[3]=_e*xe,W;var W,X,ne,ce,ye,_e,ve,xe}(h,this);return b[p]=w,b[p]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const h=1/this.worldSize,p=s.fromScaling([],[h,h,h]);return s.multiply(p,p,this.globeMatrix),p}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const h=this._elevation;this._updateCameraState();const p=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,b=this._computeCameraPosition(p),w=this._camera.forward(),C=s.mercatorZfromAltitude(1,this._center.lat);b[2]/=C,w[2]/=C,s.normalize(w,w);const P=h.raycast(b,w,h.exaggeration());if(P){const k=s.scaleAndAdd([],b,w,P),G=new s.MercatorCoordinate(k[0],k[1],s.mercatorZfromAltitude(k[2],s.latFromMercatorY(k[1]))),W=(G.z+s.length([G.x-b[0],G.y-b[1],G.z-b[2]*C]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(W),this._centerAltitude=G.toAltitude(),this._center=this.coordinateLocation(G),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(h=!1){if(!this._elevation)return;const p=this._elevation,b=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,w=this._computeCameraPosition(b),C=p.getAtPointOrZero(new s.MercatorCoordinate(...w)),P=this.pixelsPerMeter/this.worldSize*C,k=this._minimumHeightOverTerrain(),G=w[2]-P;if(G<=k)if(G<0||h){const W=this.locationCoordinate(this._center,this._centerAltitude),X=[w[0],w[1],W.z-w[2]],ne=s.length(X);X[2]-=(k-G)/this._pixelsPerMercatorPixel;const ce=s.length(X);if(ce===0)return;s.scale$2(X,X,ne/ce*this._pixelsPerMercatorPixel),this._camera.position=[w[0],w[1],W.z*this._pixelsPerMercatorPixel-X[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const h=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||h){const ce=this.center;return ce.lat=s.clamp(ce.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!h)&&(ce.lng=s.clamp(ce.lng,this.minLng,this.maxLng)),this.center=ce,void(this._constraining=!1)}const p=this._unmodified,{x:b,y:w}=this.point;let C=0,P=b,k=w;const G=this.width/2,W=this.height/2,X=this.worldMinY*this.scale,ne=this.worldMaxY*this.scale;if(w-W<X&&(k=X+W),w+W>ne&&(k=ne-W),ne-X<this.height&&(C=Math.max(C,this.height/(ne-X)),k=(ne+X)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ce=this.worldMinX*this.scale,ye=this.worldMaxX*this.scale,_e=this.worldSize/2-(ce+ye)/2;P=(b+_e+this.worldSize)%this.worldSize-_e,P-G<ce&&(P=ce+G),P+G>ye&&(P=ye-G),ye-ce<this.width&&(C=Math.max(C,this.width/(ye-ce)),P=(ye+ce)/2)}P===b&&k===w||(this.center=this.unproject(new s.pointGeometry(P,k))),C&&(this.zoom+=this.scaleZoom(C)),this._constrainCamera(),this._unmodified=p,this._constraining=!1}_minZoomForBounds(){let h=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(h=Math.max(h,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),h}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const h=this.centerOffset,p=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=s.mercatorZfromAltitude(1,this.center.lat)/s.mercatorZfromAltitude(1,s.GLOBE_SCALE_MATCH_LATITUDE));const b=ju(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,b),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const w=this.projection.zAxisUnit==="meters"?p:1,C=this._camera.getWorldToCamera(this.worldSize,w),P=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);P[8]=2*-h.x/this.width,P[9]=2*h.y/this.height;let k=s.mul([],P,C);if(this.projection.isReprojectedInTileSpace){const je=this.locationCoordinate(this.center),Ke=s.identity([]);s.translate(Ke,Ke,[je.x*this.worldSize,je.y*this.worldSize,0]),s.multiply(Ke,Ke,ih(this)),s.translate(Ke,Ke,[-je.x*this.worldSize,-je.y*this.worldSize,0]),s.multiply(k,k,Ke),this.inverseAdjustmentMatrix=function(ft){const dt=ih(ft,!0);return De([],[dt[0],dt[1],dt[4],dt[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=s.scale([],k,[this.worldSize,this.worldSize,this.worldSize/w,1]),this.projMatrix=k,this.invProjMatrix=s.invert(new Float64Array(16),this.projMatrix);const G=s.invert([],P);this.frustumCorners=s.FrustumCorners.fromInvProjectionMatrix(G,this.horizonLineFromTop(),this.height);const W=new Float32Array(16);s.identity(W),s.scale(W,W,[1,-1,1]),s.rotateX(W,W,this._pitch),s.rotateZ(W,W,this.angle);const X=s.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),ne=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;X[8]=2*-h.x/this.width,X[9]=2*(h.y+ne)/this.height,this.skyboxMatrix=s.multiply(W,X,W);const ce=this.point,ye=ce.x,_e=ce.y,ve=this.width%2/2,xe=this.height%2/2,se=Math.cos(this.angle),Le=Math.sin(this.angle),Ae=ye-Math.round(ye)+se*ve+Le*xe,Re=_e-Math.round(_e)+se*xe+Le*ve,Xe=new Float64Array(k);if(s.translate(Xe,Xe,[Ae>.5?Ae-1:Ae,Re>.5?Re-1:Re,0]),this.alignedProjMatrix=Xe,k=s.create(),s.scale(k,k,[this.width/2,-this.height/2,1]),s.translate(k,k,[1,-1,0]),this.labelPlaneMatrix=k,k=s.create(),s.scale(k,k,[1,-1,1]),s.translate(k,k,[-1,-1,0]),s.scale(k,k,[2/this.width,2/this.height,1]),this.glCoordMatrix=k,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},k=s.invert(new Float64Array(16),this.pixelMatrix),!k)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=k,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=s.calculateGlobeMatrix(this);const je=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.transformMat4(je,je,C),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=k;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const h=this.cameraWorldSizeForFog,p=this.cameraPixelsPerMeter,b=this._camera.position,w=1/this.height/this._pixelsPerMercatorPixel,C=[h,h,p];s.scale$2(C,C,w),s.scale$2(b,b,-1),s.multiply$2(b,b,C);const P=s.create();s.translate(P,P,b),s.scale(P,P,C),this.mercatorFogMatrix=P,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(h,p,w)}_computeCameraPosition(h){const p=(h=h||this.pixelsPerMeter)/this.pixelsPerMeter,b=this._camera.forward(),w=this.point,C=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*p-h/this.worldSize*this._centerAltitude;return[w.x/this.worldSize-b[0]*C,w.y/this.worldSize-b[1]*C,h/this.worldSize*this._centerAltitude-b[2]*C]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(h){const p=this._maxCameraBoundsDistance()*Math.cos(this._pitch),b=this._camera.position[2],w=h[2];let C=1;this.projection.wrap&&(this.center=this.center.wrap()),w>0&&(C=Math.min((p-b)/w,1)),this._camera.position=s.scaleAndAdd([],this._camera.position,h,C),this._updateStateFromCamera()}_updateStateFromCamera(){const h=this._camera.position,p=this._camera.forward(),{pitch:b,bearing:w}=this._camera.getPitchBearing(),C=s.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,P=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.degToRad(this._maxPitch)),k=Math.max((h[2]-C)/Math.cos(b),P),G=this._zoomFromMercatorZ(k);s.scaleAndAdd(h,h,p,k),this._pitch=s.clamp(b,s.degToRad(this.minPitch),s.degToRad(this.maxPitch)),this.angle=s.wrap(w,-Math.PI,Math.PI),this._setZoom(s.clamp(G,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.MercatorCoordinate(h[0],h[1],h[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(h){return Math.pow(2,h)*this.tileSize}_mercatorZfromZoom(h){return this.cameraToCenterDistance/this._worldSizeFromZoom(h)}_minimumHeightOverTerrain(){const h=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(h)}_zoomFromMercatorZ(h){return this.scaleZoom(this.cameraToCenterDistance/(h*this.tileSize))}zoomFromMercatorZAdjusted(h){let p=0,b=s.GLOBE_ZOOM_THRESHOLD_MAX,w=0,C=1/0;for(;b-p>1e-6&&b>p;){const P=p+.5*(b-p),k=this.tileSize*Math.pow(2,P),G=this.getCameraToCenterDistance(this.projection,P,k),W=this.scaleZoom(G/(h*this.tileSize)),X=Math.abs(P-W);X<C&&(C=X,w=P),P<W?p=P:b=P}return w}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(h,p){const b=Math.min(h.x,p.x),w=Math.max(h.x,p.x),C=Math.min(h.y,p.y),P=Math.max(h.y,p.y);if(C<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const k=[new s.pointGeometry(b,C),new s.pointGeometry(w,P),new s.pointGeometry(b,P),new s.pointGeometry(w,C)],G=this.renderWorldCopies?-3:0,W=this.renderWorldCopies?4:1;for(const X of k){const ne=this.pointRayIntersection(X);if(ne.t<0)return!0;const ce=this.rayIntersectionCoordinate(ne);if(ce.x<G||ce.y<0||ce.x>W||ce.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.pointGeometry(0,0),new s.pointGeometry(this.width,this.height))}zoomDeltaToMovement(h,p){const b=s.length(s.sub([],this._camera.position,h)),w=this._zoomFromMercatorZ(b)+p;return b-this._mercatorZfromZoom(w)}getCameraPoint(){if(this.projection.name==="globe"){const h=function([p,b,w],C){const P=[p,b,w,1];s.transformMat4$1(P,P,C);const k=P[3]=Math.max(P[3],1e-6);return P[0]/=k,P[1]/=k,P[2]/=k,P}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.pointGeometry(h[0],h[1])}{const h=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.pointGeometry(0,h))}}getCameraToCenterDistance(h,p=this.zoom,b=this.worldSize){const w=ju(h,p,this.width,this.height,1024),C=h.pixelSpaceConversion(this.center.lat,b,w);return .5/Math.tan(.5*this._fov)*this.height*C}getWorldToCameraMatrix(){const h=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&s.multiply(h,h,this.globeMatrix),h}}function hu(y,h){let p=!1,b=null;const w=()=>{b=null,p&&(y(),b=setTimeout(w,h),p=!1)};return()=>(p=!0,b||w(),b)}class Op{constructor(h){this._hashName=h&&encodeURIComponent(h),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=hu(this._updateHashUnthrottled.bind(this),300)}addTo(h){return this._map=h,s.window.addEventListener("hashchange",this._onHashChange,!1),h.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),s.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const h=this._map;if(!h)return"";const p=Dd(h);if(this._hashName){const b=this._hashName;let w=!1;const C=s.window.location.hash.slice(1).split("&").map(P=>{const k=P.split("=")[0];return k===b?(w=!0,`${k}=${p}`):P}).filter(P=>P);return w||C.push(`${b}=${p}`),`#${C.join("&")}`}return`#${p}`}_getCurrentHash(){const h=s.window.location.hash.replace("#","");if(this._hashName){let p;return h.split("&").map(b=>b.split("=")).forEach(b=>{b[0]===this._hashName&&(p=b)}),(p&&p[1]||"").split("/")}return h.split("/")}_onHashChange(){const h=this._map;if(!h)return!1;const p=this._getCurrentHash();if(p.length>=3&&!p.some(b=>isNaN(b))){const b=h.dragRotate.isEnabled()&&h.touchZoomRotate.isEnabled()?+(p[3]||0):h.getBearing();return h.jumpTo({center:[+p[2],+p[1]],zoom:+p[0],bearing:b,pitch:+(p[4]||0)}),!0}return!1}_updateHashUnthrottled(){const h=s.window.location.href.replace(/(#.+)?$/,this.getHashString());s.window.history.replaceState(s.window.history.state,null,h)}}function Dd(y,h){const p=y.getCenter(),b=Math.round(100*y.getZoom())/100,w=Math.ceil((b*Math.LN2+Math.log(512/360/.5))/Math.LN10),C=Math.pow(10,w),P=Math.round(p.lng*C)/C,k=Math.round(p.lat*C)/C,G=y.getBearing(),W=y.getPitch();let X=h?`/${P}/${k}/${b}`:`${b}/${k}/${P}`;return(G||W)&&(X+="/"+Math.round(10*G)/10),W&&(X+=`/${Math.round(W)}`),X}const Xf={linearity:.3,easing:s.bezier(0,0,.3,1)},Od=s.extend({deceleration:2500,maxSpeed:1400},Xf),Sg=s.extend({deceleration:20,maxSpeed:1400},Xf),Im=s.extend({deceleration:1e3,maxSpeed:360},Xf),Cg=s.extend({deceleration:1e3,maxSpeed:90},Xf);class bo{constructor(h){this._map=h,this.clear()}clear(){this._inertiaBuffer=[]}record(h){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.exported.now(),settings:h})}_drainInertiaBuffer(){const h=this._inertiaBuffer,p=s.exported.now();for(;h.length>0&&p-h[0].time>160;)h.shift()}_onMoveEnd(h){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const p={zoom:0,bearing:0,pitch:0,pan:new s.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:C}of this._inertiaBuffer)p.zoom+=C.zoomDelta||0,p.bearing+=C.bearingDelta||0,p.pitch+=C.pitchDelta||0,C.panDelta&&p.pan._add(C.panDelta),C.around&&(p.around=C.around),C.pinchAround&&(p.pinchAround=C.pinchAround);const b=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,w={};if(p.pan.mag()){const C=Np(p.pan.mag(),b,s.extend({},Od,h||{}));w.offset=p.pan.mult(C.amount/p.pan.mag()),w.center=this._map.transform.center,Fo(w,C)}if(p.zoom){const C=Np(p.zoom,b,Sg);w.zoom=this._map.transform.zoom+C.amount,Fo(w,C)}if(p.bearing){const C=Np(p.bearing,b,Im);w.bearing=this._map.transform.bearing+s.clamp(C.amount,-179,179),Fo(w,C)}if(p.pitch){const C=Np(p.pitch,b,Cg);w.pitch=this._map.transform.pitch+C.amount,Fo(w,C)}if(w.zoom||w.bearing){const C=p.pinchAround===void 0?p.around:p.pinchAround;w.around=C?this._map.unproject(C):this._map.getCenter()}return this.clear(),w.noMoveStart=!0,w}}function Fo(y,h){(!y.duration||y.duration<h.duration)&&(y.duration=h.duration,y.easing=h.easing)}function Np(y,h,p){const{maxSpeed:b,linearity:w,deceleration:C}=p,P=s.clamp(y*w/(h/1e3),-b,b),k=Math.abs(P)/(C*w);return{easing:p.easing,duration:1e3*k,amount:P*(k/2)}}class aa extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,p,b,w={}){const C=J(p.getCanvasContainer(),b),P=p.unproject(C);super(h,s.extend({point:C,lngLat:P,originalEvent:b},w)),this._defaultPrevented=!1,this.target=p}}class kp extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,p,b){const w=h==="touchend"?b.changedTouches:b.touches,C=he(p.getCanvasContainer(),w),P=C.map(G=>p.unproject(G)),k=C.reduce((G,W,X,ne)=>G.add(W.div(ne.length)),new s.pointGeometry(0,0));super(h,{points:C,point:k,lngLats:P,lngLat:p.unproject(k),originalEvent:b}),this._defaultPrevented=!1}}class f0 extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,p,b){super(h,{originalEvent:b}),this._defaultPrevented=!1}}class Tm{constructor(h,p){this._map=h,this._clickTolerance=p.clickTolerance}reset(){this._mousedownPos=void 0}wheel(h){return this._firePreventable(new f0(h.type,this._map,h))}mousedown(h,p){return this._mousedownPos=p,this._firePreventable(new aa(h.type,this._map,h))}mouseup(h){this._map.fire(new aa(h.type,this._map,h))}preclick(h){const p=s.extend({},h);p.type="preclick",this._map.fire(new aa(p.type,this._map,p))}click(h,p){this._mousedownPos&&this._mousedownPos.dist(p)>=this._clickTolerance||(this.preclick(h),this._map.fire(new aa(h.type,this._map,h)))}dblclick(h){return this._firePreventable(new aa(h.type,this._map,h))}mouseover(h){this._map.fire(new aa(h.type,this._map,h))}mouseout(h){this._map.fire(new aa(h.type,this._map,h))}touchstart(h){return this._firePreventable(new kp(h.type,this._map,h))}touchmove(h){this._map.fire(new kp(h.type,this._map,h))}touchend(h){this._map.fire(new kp(h.type,this._map,h))}touchcancel(h){this._map.fire(new kp(h.type,this._map,h))}_firePreventable(h){if(this._map.fire(h),h.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Jh{constructor(h){this._map=h}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(h){this._map.fire(new aa(h.type,this._map,h))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new aa("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(h){this._delayContextMenu?this._contextMenuEvent=h:this._map.fire(new aa(h.type,this._map,h)),this._map.listens("contextmenu")&&h.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Fp{constructor(h,p){this._map=h,this._el=h.getCanvasContainer(),this._container=h.getContainer(),this._clickTolerance=p.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(h,p){this.isEnabled()&&h.shiftKey&&h.button===0&&(z(),this._startPos=this._lastPos=p,this._active=!0)}mousemoveWindow(h,p){if(!this._active)return;const b=p,w=this._startPos,C=this._lastPos;if(!w||!C||C.equals(b)||!this._box&&b.dist(w)<this._clickTolerance)return;this._lastPos=b,this._box||(this._box=A("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",h));const P=Math.min(w.x,b.x),k=Math.max(w.x,b.x),G=Math.min(w.y,b.y),W=Math.max(w.y,b.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${P}px,${G}px)`,this._box.style.width=k-P+"px",this._box.style.height=W-G+"px")})}mouseupWindow(h,p){if(!this._active)return;const b=this._startPos,w=p;if(b&&h.button===0){if(this.reset(),Q(),b.x!==w.x||b.y!==w.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:h})),{cameraAnimation:C=>C.fitScreenCoordinates(b,w,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",h)}}keydown(h){this._active&&h.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",h))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),V(),delete this._startPos,delete this._lastPos}_fireEvent(h,p){return this._map.fire(new s.Event(h,{originalEvent:p}))}}function rh(y,h){const p={};for(let b=0;b<y.length;b++)p[y[b].identifier]=h[b];return p}class Nd{constructor(h){this.reset(),this.numTouches=h.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(h,p,b){(this.centroid||b.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=h.timeStamp),b.length===this.numTouches&&(this.centroid=function(w){const C=new s.pointGeometry(0,0);for(const P of w)C._add(P);return C.div(w.length)}(p),this.touches=rh(b,p)))}touchmove(h,p,b){if(this.aborted||!this.centroid)return;const w=rh(b,p);for(const C in this.touches){const P=this.touches[C],k=w[C];(!k||k.dist(P)>30)&&(this.aborted=!0)}}touchend(h,p,b){if((!this.centroid||h.timeStamp-this.startTime>500)&&(this.aborted=!0),b.length===0){const w=!this.aborted&&this.centroid;if(this.reset(),w)return w}}}class Ic{constructor(h){this.singleTap=new Nd(h),this.numTaps=h.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(h,p,b){this.singleTap.touchstart(h,p,b)}touchmove(h,p,b){this.singleTap.touchmove(h,p,b)}touchend(h,p,b){const w=this.singleTap.touchend(h,p,b);if(w){const C=h.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(w)<30;if(C&&P||this.reset(),this.count++,this.lastTime=h.timeStamp,this.lastTap=w,this.count===this.numTaps)return this.reset(),w}}}class kd{constructor(){this._zoomIn=new Ic({numTouches:1,numTaps:2}),this._zoomOut=new Ic({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(h,p,b){this._zoomIn.touchstart(h,p,b),this._zoomOut.touchstart(h,p,b)}touchmove(h,p,b){this._zoomIn.touchmove(h,p,b),this._zoomOut.touchmove(h,p,b)}touchend(h,p,b){const w=this._zoomIn.touchend(h,p,b),C=this._zoomOut.touchend(h,p,b);return w?(this._active=!0,h.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()+1,around:P.unproject(w)},{originalEvent:h})}):C?(this._active=!0,h.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()-1,around:P.unproject(C)},{originalEvent:h})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Zf={0:1,2:2};class wm{constructor(h){this.reset(),this._clickTolerance=h.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(h,p){return!1}_move(h,p){return{}}mousedown(h,p){if(this._lastPoint)return;const b=ee(h);this._correctButton(h,b)&&(this._lastPoint=p,this._eventButton=b)}mousemoveWindow(h,p){const b=this._lastPoint;if(b){if(h.preventDefault(),this._eventButton!=null&&function(w,C){const P=Zf[C];return w.buttons===void 0||(w.buttons&P)!==P}(h,this._eventButton))this.reset();else if(this._moved||!(p.dist(b)<this._clickTolerance))return this._moved=!0,this._lastPoint=p,this._move(b,p)}}mouseupWindow(h){this._lastPoint&&ee(h)===this._eventButton&&(this._moved&&Q(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Q_ extends wm{mousedown(h,p){super.mousedown(h,p),this._lastPoint&&(this._active=!0)}_correctButton(h,p){return p===0&&!h.ctrlKey}_move(h,p){return{around:p,panDelta:p.sub(h)}}}class Ag extends wm{_correctButton(h,p){return p===0&&h.ctrlKey||p===2}_move(h,p){const b=.8*(p.x-h.x);if(b)return this._active=!0,{bearingDelta:b}}contextmenu(h){h.preventDefault()}}class Mg extends wm{_correctButton(h,p){return p===0&&h.ctrlKey||p===2}_move(h,p){const b=-.5*(p.y-h.y);if(b)return this._active=!0,{pitchDelta:b}}contextmenu(h){h.preventDefault()}}class Fd{constructor(h,p){this._map=h,this._el=h.getCanvasContainer(),this._minTouches=1,this._clickTolerance=p.clickTolerance||1,this.reset(),s.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.pointGeometry(0,0)}touchstart(h,p,b){return this._calculateTransform(h,p,b)}touchmove(h,p,b){if(this._active&&!(b.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(b.length===1&&!s.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return h.cancelable&&h.preventDefault(),this._calculateTransform(h,p,b)}}touchend(h,p,b){this._calculateTransform(h,p,b),this._active&&b.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(h,p,b){b.length>0&&(this._active=!0);const w=rh(b,p),C=new s.pointGeometry(0,0),P=new s.pointGeometry(0,0);let k=0;for(const W in w){const X=w[W],ne=this._touches[W];ne&&(C._add(X),P._add(X.sub(ne)),k++,w[W]=X)}if(this._touches=w,k<this._minTouches||!P.mag())return;const G=P.div(k);return this._sum._add(G),this._sum.mag()<this._clickTolerance?void 0:{around:C.div(k),panDelta:G}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=A("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Yf{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(h){}_move(h,p,b){return{}}touchstart(h,p,b){this._firstTwoTouches||b.length<2||(this._firstTwoTouches=[b[0].identifier,b[1].identifier],this._start([p[0],p[1]]))}touchmove(h,p,b){const w=this._firstTwoTouches;if(!w)return;h.preventDefault();const[C,P]=w,k=sh(b,p,C),G=sh(b,p,P);if(!k||!G)return;const W=this._aroundCenter?null:k.add(G).div(2);return this._move([k,G],W,h)}touchend(h,p,b){if(!this._firstTwoTouches)return;const[w,C]=this._firstTwoTouches,P=sh(b,p,w),k=sh(b,p,C);P&&k||(this._active&&Q(),this.reset())}touchcancel(){this.reset()}enable(h){this._enabled=!0,this._aroundCenter=!!h&&h.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function sh(y,h,p){for(let b=0;b<y.length;b++)if(y[b].identifier===p)return h[b]}function Lg(y,h){return Math.log(y/h)/Math.LN2}class ge extends Yf{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(h){this._startDistance=this._distance=h[0].dist(h[1])}_move(h,p){const b=this._distance;if(this._distance=h[0].dist(h[1]),this._active||!(Math.abs(Lg(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Lg(this._distance,b),pinchAround:p}}}function Qh(y,h){return 180*y.angleWith(h)/Math.PI}class Bp extends Yf{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(h){this._startVector=this._vector=h[0].sub(h[1]),this._minDiameter=h[0].dist(h[1])}_move(h,p){const b=this._vector;if(this._vector=h[0].sub(h[1]),b&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Qh(this._vector,b),pinchAround:p}}_isBelowThreshold(h){this._minDiameter=Math.min(this._minDiameter,h.mag());const p=25/(Math.PI*this._minDiameter)*360,b=this._startVector;if(!b)return!1;const w=Qh(h,b);return Math.abs(w)<p}}function rl(y){return Math.abs(y.y)>Math.abs(y.x)}class Yi extends Yf{constructor(h){super(),this._map=h}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(h){this._lastPoints=h,rl(h[0].sub(h[1]))&&(this._valid=!1)}_move(h,p,b){const w=this._lastPoints;if(!w)return;const C=h[0].sub(w[0]),P=h[1].sub(w[1]);return this._map._cooperativeGestures&&!s.isFullscreen()&&b.touches.length<3||(this._valid=this.gestureBeginsVertically(C,P,b.timeStamp),!this._valid)?void 0:(this._lastPoints=h,this._active=!0,{pitchDelta:(C.y+P.y)/2*-.5})}gestureBeginsVertically(h,p,b){if(this._valid!==void 0)return this._valid;const w=h.mag()>=2,C=p.mag()>=2;if(!w&&!C)return;if(!w||!C)return this._firstMove==null&&(this._firstMove=b),b-this._firstMove<100&&void 0;const P=h.y>0==p.y>0;return rl(h)&&rl(p)&&P}}const d0={panStep:100,bearingStep:15,pitchStep:10};class $_{constructor(){const h=d0;this._panStep=h.panStep,this._bearingStep=h.bearingStep,this._pitchStep=h.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(h){if(h.altKey||h.ctrlKey||h.metaKey)return;let p=0,b=0,w=0,C=0,P=0;switch(h.keyCode){case 61:case 107:case 171:case 187:p=1;break;case 189:case 109:case 173:p=-1;break;case 37:h.shiftKey?b=-1:(h.preventDefault(),C=-1);break;case 39:h.shiftKey?b=1:(h.preventDefault(),C=1);break;case 38:h.shiftKey?w=1:(h.preventDefault(),P=-1);break;case 40:h.shiftKey?w=-1:(h.preventDefault(),P=1);break;default:return}return this._rotationDisabled&&(b=0,w=0),{cameraAnimation:k=>{const G=k.getZoom();k.easeTo({duration:300,easeId:"keyboardHandler",easing:p0,zoom:p?Math.round(G)+p*(h.shiftKey?2:1):G,bearing:k.getBearing()+b*this._bearingStep,pitch:k.getPitch()+w*this._pitchStep,offset:[-C*this._panStep,-P*this._panStep],center:k.getCenter()},{originalEvent:h})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function p0(y){return y*(2-y)}const $h=4.000244140625;class oh{constructor(h,p){this._map=h,this._el=h.getCanvasContainer(),this._handler=p,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,s.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(h){this._defaultZoomRate=h}setWheelZoomRate(h){this._wheelZoomRate=h}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(h){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!h&&h.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(h){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(h.ctrlKey||h.metaKey||this.isZooming()||s.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let p=h.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*h.deltaY:h.deltaY;const b=s.exported.now(),w=b-(this._lastWheelEventTime||0);this._lastWheelEventTime=b,p!==0&&p%$h==0?this._type="wheel":p!==0&&Math.abs(p)<4?this._type="trackpad":w>400?(this._type=null,this._lastValue=p,this._timeout=setTimeout(this._onTimeout,40,h)):this._type||(this._type=Math.abs(w*p)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,p+=this._lastValue)),h.shiftKey&&p&&(p/=4),this._type&&(this._lastWheelEvent=h,this._delta-=p,this._active||this._start(h)),h.preventDefault()}_onTimeout(h){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(h)}_start(h){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const p=J(this._el,h);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:p,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const h=this._map.transform;this._type==="wheel"&&h.projection.wrap&&(h._center.lng>=180||h._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const p=()=>h._terrainEnabled()&&this._aroundCoord?h.computeZoomRelativeTo(this._aroundCoord):h.zoom;if(this._delta!==0){const G=this._type==="wheel"&&Math.abs(this._delta)>$h?this._wheelZoomRate:this._defaultZoomRate;let W=2/(1+Math.exp(-Math.abs(this._delta*G)));this._delta<0&&W!==0&&(W=1/W);const X=p(),ne=Math.pow(2,X),ce=typeof this._targetZoom=="number"?h.zoomScale(this._targetZoom):ne;this._targetZoom=Math.min(h.maxZoom,Math.max(h.minZoom,h.scaleZoom(ce*W))),this._type==="wheel"&&(this._startZoom=X,this._easing=this._smoothOutEasing(200)),this._delta=0}const b=typeof this._targetZoom=="number"?this._targetZoom:p(),w=this._startZoom,C=this._easing;let P,k=!1;if(this._type==="wheel"&&w&&C){const G=Math.min((s.exported.now()-this._lastWheelEventTime)/200,1),W=C(G);P=s.number(w,b,W),G<1?this._frameId||(this._frameId=!0):k=!0}else P=b,k=!0;return this._active=!0,k&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!k,zoomDelta:P-p(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(h){let p=s.ease;if(this._prevEase){const b=this._prevEase,w=(s.exported.now()-b.start)/b.duration,C=b.easing(w+.01)-b.easing(w),P=.27/Math.sqrt(C*C+1e-4)*.01,k=Math.sqrt(.0729-P*P);p=s.bezier(P,k,.25,1)}return this._prevEase={start:s.exported.now(),duration:h,easing:p},p}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=A("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(s.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class ey{constructor(h,p){this._clickZoom=h,this._tapZoom=p}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Bd{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(h,p){return h.preventDefault(),{cameraAnimation:b=>{b.easeTo({duration:300,zoom:b.getZoom()+(h.shiftKey?-1:1),around:b.unproject(p)},{originalEvent:h})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Tc{constructor(){this._tap=new Ic({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(h,p,b){this._swipePoint||(this._tapTime&&h.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?b.length>0&&(this._swipePoint=p[0],this._swipeTouch=b[0].identifier):this._tap.touchstart(h,p,b))}touchmove(h,p,b){if(this._tapTime){if(this._swipePoint){if(b[0].identifier!==this._swipeTouch)return;const w=p[0],C=w.y-this._swipePoint.y;return this._swipePoint=w,h.preventDefault(),this._active=!0,{zoomDelta:C/128}}}else this._tap.touchmove(h,p,b)}touchend(h,p,b){this._tapTime?this._swipePoint&&b.length===0&&this.reset():this._tap.touchend(h,p,b)&&(this._tapTime=h.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Sm{constructor(h,p,b){this._el=h,this._mousePan=p,this._touchPan=b}enable(h){this._inertiaOptions=h||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Gn{constructor(h,p,b){this._pitchWithRotate=h.pitchWithRotate,this._mouseRotate=p,this._mousePitch=b}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ty{constructor(h,p,b,w){this._el=h,this._touchZoom=p,this._touchRotate=b,this._tapDragZoom=w,this._rotationDisabled=!1,this._enabled=!0}enable(h){this._touchZoom.enable(h),this._rotationDisabled||this._touchRotate.enable(h),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const zp=y=>y.zoom||y.drag||y.pitch||y.rotate;class Up extends s.Event{}class Vp{constructor(){this.constants=[1,1,.01],this.radius=0}setup(h,p){const b=s.sub([],p,h);this.radius=s.length(b[2]<0?s.div([],b,this.constants):[b[0],b[1],0])}projectRay(h){s.div(h,h,this.constants),s.normalize(h,h),s.mul$1(h,h,this.constants);const p=s.scale$2([],h,this.radius);if(p[2]>0){const b=s.scale$2([],[0,0,1],s.dot(p,[0,0,1])),w=s.scale$2([],s.normalize([],[p[0],p[1],0]),this.radius),C=s.add([],p,s.scale$2([],s.sub([],s.add([],w,b),p),2));p[0]=C[0],p[1]=C[1]}return p}}function Gp(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}class wc{constructor(h,p){this._map=h,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new bo(h),this._bearingSnap=p.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Vp,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(p),s.bindAll(["handleEvent","handleWindowEvent"],this);const b=this._el;this._listeners=[[b,"touchstart",{passive:!0}],[b,"touchmove",{passive:!1}],[b,"touchend",void 0],[b,"touchcancel",void 0],[b,"mousedown",void 0],[b,"mousemove",void 0],[b,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[b,"mouseover",void 0],[b,"mouseout",void 0],[b,"dblclick",void 0],[b,"click",void 0],[b,"keydown",{capture:!1}],[b,"keyup",void 0],[b,"wheel",{passive:!1}],[b,"contextmenu",void 0],[s.window,"blur",void 0]];for(const[w,C,P]of this._listeners)w.addEventListener(C,w===s.window.document?this.handleWindowEvent:this.handleEvent,P)}destroy(){for(const[h,p,b]of this._listeners)h.removeEventListener(p,h===s.window.document?this.handleWindowEvent:this.handleEvent,b)}_addDefaultHandlers(h){const p=this._map,b=p.getCanvasContainer();this._add("mapEvent",new Tm(p,h));const w=p.boxZoom=new Fp(p,h);this._add("boxZoom",w);const C=new kd,P=new Bd;p.doubleClickZoom=new ey(P,C),this._add("tapZoom",C),this._add("clickZoom",P);const k=new Tc;this._add("tapDragZoom",k);const G=p.touchPitch=new Yi(p);this._add("touchPitch",G);const W=new Ag(h),X=new Mg(h);p.dragRotate=new Gn(h,W,X),this._add("mouseRotate",W,["mousePitch"]),this._add("mousePitch",X,["mouseRotate"]);const ne=new Q_(h),ce=new Fd(p,h);p.dragPan=new Sm(b,ne,ce),this._add("mousePan",ne),this._add("touchPan",ce,["touchZoom","touchRotate"]);const ye=new Bp,_e=new ge;p.touchZoomRotate=new ty(b,_e,ye,k),this._add("touchRotate",ye,["touchPan","touchZoom"]),this._add("touchZoom",_e,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Jh(p));const ve=p.scrollZoom=new oh(p,this);this._add("scrollZoom",ve,["mousePan"]);const xe=p.keyboard=new $_;this._add("keyboard",xe);for(const se of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])h.interactive&&h[se]&&p[se].enable(h[se])}_add(h,p,b){this._handlers.push({handlerName:h,handler:p,allowed:b}),this._handlersById[h]=p}stop(h){if(!this._updatingCamera){for(const{handler:p}of this._handlers)p.reset();this._inertia.clear(),this._fireEvents({},{},h),this._changes=[]}}isActive(){for(const{handler:h}of this._handlers)if(h.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!zp(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(h,p,b){for(const w in h)if(w!==b&&(!p||p.indexOf(w)<0))return!0;return!1}handleWindowEvent(h){this.handleEvent(h,`${h.type}Window`)}_getMapTouches(h){const p=[];for(const b of h)this._el.contains(b.target)&&p.push(b);return p}handleEvent(h,p){this._updatingCamera=!0;const b=h.type==="renderFrame",w=b?void 0:h,C={needsRenderFrame:!1},P={},k={},G=h.touches?this._getMapTouches(h.touches):void 0,W=G?he(this._el,G):b?void 0:J(this._el,h);for(const{handlerName:ce,handler:ye,allowed:_e}of this._handlers){if(!ye.isEnabled())continue;let ve;this._blockedByActive(k,_e,ce)?ye.reset():ye[p||h.type]&&(ve=ye[p||h.type](h,W,G),this.mergeHandlerResult(C,P,ve,ce,w),ve&&ve.needsRenderFrame&&this._triggerRenderFrame()),(ve||ye.isActive())&&(k[ce]=ye)}const X={};for(const ce in this._previousActiveHandlers)k[ce]||(X[ce]=w);this._previousActiveHandlers=k,(Object.keys(X).length||Gp(C))&&(this._changes.push([C,P,X]),this._triggerRenderFrame()),(Object.keys(k).length||Gp(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ne}=C;ne&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ne(this._map))}mergeHandlerResult(h,p,b,w,C){if(!b)return;s.extend(h,b);const P={handlerName:w,originalEvent:b.originalEvent||C};b.zoomDelta!==void 0&&(p.zoom=P),b.panDelta!==void 0&&(p.drag=P),b.pitchDelta!==void 0&&(p.pitch=P),b.bearingDelta!==void 0&&(p.rotate=P)}_applyChanges(){const h={},p={},b={};for(const[w,C,P]of this._changes)w.panDelta&&(h.panDelta=(h.panDelta||new s.pointGeometry(0,0))._add(w.panDelta)),w.zoomDelta&&(h.zoomDelta=(h.zoomDelta||0)+w.zoomDelta),w.bearingDelta&&(h.bearingDelta=(h.bearingDelta||0)+w.bearingDelta),w.pitchDelta&&(h.pitchDelta=(h.pitchDelta||0)+w.pitchDelta),w.around!==void 0&&(h.around=w.around),w.aroundCoord!==void 0&&(h.aroundCoord=w.aroundCoord),w.pinchAround!==void 0&&(h.pinchAround=w.pinchAround),w.noInertia&&(h.noInertia=w.noInertia),s.extend(p,C),s.extend(b,P);this._updateMapTransform(h,p,b),this._changes=[]}_updateMapTransform(h,p,b){const w=this._map,C=w.transform,P=Le=>[Le.x,Le.y,Le.z];if((Le=>{const Ae=this._eventsInProgress.drag;return Ae&&!this._handlersById[Ae.handlerName].isActive()})()&&!Gp(h)){const Le=C.zoom;C.cameraElevationReference="sea",C.recenterOnTerrain(),C.cameraElevationReference="ground",Le!==C.zoom&&this._map._update(!0)}if(C._isCameraConstrained&&w._stop(!0),!Gp(h))return void this._fireEvents(p,b,!0);let{panDelta:k,zoomDelta:G,bearingDelta:W,pitchDelta:X,around:ne,aroundCoord:ce,pinchAround:ye}=h;C._isCameraConstrained&&(G>0&&(G=0),C._isCameraConstrained=!1),ye!==void 0&&(ne=ye),(G||(Le=>p.drag&&!this._eventsInProgress.drag)())&&ne&&(this._dragOrigin=P(C.pointCoordinate3D(ne)),this._trackingEllipsoid.setup(C._camera.position,this._dragOrigin)),C.cameraElevationReference="sea",w._stop(!0),ne=ne||w.transform.centerPoint,W&&(C.bearing+=W),X&&(C.pitch+=X),C._updateCameraState();const _e=[0,0,0];if(k)if(C.projection.name==="mercator"){const Le=this._trackingEllipsoid.projectRay(C.screenPointToMercatorRay(ne).dir),Ae=this._trackingEllipsoid.projectRay(C.screenPointToMercatorRay(ne.sub(k)).dir);_e[0]=Ae[0]-Le[0],_e[1]=Ae[1]-Le[1]}else{const Le=C.pointCoordinate(ne);if(C.projection.name==="globe"){k=k.rotate(-C.angle);const Ae=C._pixelsPerMercatorPixel/C.worldSize;_e[0]=-k.x*s.mercatorScale(s.latFromMercatorY(Le.y))*Ae,_e[1]=-k.y*s.mercatorScale(C.center.lat)*Ae}else{const Ae=C.pointCoordinate(ne.sub(k));Le&&Ae&&(_e[0]=Ae.x-Le.x,_e[1]=Ae.y-Le.y)}}const ve=C.zoom,xe=[0,0,0];if(G){const Le=P(ce||C.pointCoordinate3D(ne)),Ae={dir:s.normalize([],s.sub([],Le,C._camera.position))};if(Ae.dir[2]<0){const Re=C.zoomDeltaToMovement(Le,G);s.scale$2(xe,Ae.dir,Re)}}const se=s.add(_e,_e,xe);C._translateCameraConstrained(se),G&&Math.abs(C.zoom-ve)>1e-4&&C.recenterOnTerrain(),C.cameraElevationReference="ground",this._map._update(),h.noInertia||this._inertia.record(h),this._fireEvents(p,b,!0)}_fireEvents(h,p,b){const w=zp(this._eventsInProgress),C=zp(h),P={};for(const X in h){const{originalEvent:ne}=h[X];this._eventsInProgress[X]||(P[`${X}start`]=ne),this._eventsInProgress[X]=h[X]}!w&&C&&this._fireEvent("movestart",C.originalEvent);for(const X in P)this._fireEvent(X,P[X]);C&&this._fireEvent("move",C.originalEvent);for(const X in h){const{originalEvent:ne}=h[X];this._fireEvent(X,ne)}const k={};let G;for(const X in this._eventsInProgress){const{handlerName:ne,originalEvent:ce}=this._eventsInProgress[X];this._handlersById[ne].isActive()||(delete this._eventsInProgress[X],G=p[ne]||ce,k[`${X}end`]=G)}for(const X in k)this._fireEvent(X,k[X]);const W=zp(this._eventsInProgress);if(b&&(w||C)&&!W){this._updatingCamera=!0;const X=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ne=ce=>ce!==0&&-this._bearingSnap<ce&&ce<this._bearingSnap;X?(ne(X.bearing||this._map.getBearing())&&(X.bearing=0),this._map.easeTo(X,{originalEvent:G})):(this._map.fire(new s.Event("moveend",{originalEvent:G})),ne(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(h,p){this._map.fire(new s.Event(h,p?{originalEvent:p}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(h=>{this._frameId=void 0,this.handleEvent(new Up("renderFrame",{timeStamp:h})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Rg="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class ny extends s.Evented{constructor(h,p){super(),this._moving=!1,this._zooming=!1,this.transform=h,this._bearingSnap=p.bearingSnap,s.bindAll(["_renderFrameCallback"],this)}getCenter(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(h,p){return this.jumpTo({center:h},p)}panBy(h,p,b){return h=s.pointGeometry.convert(h).mult(-1),this.panTo(this.transform.center,s.extend({offset:h},p),b)}panTo(h,p,b){return this.easeTo(s.extend({center:h},p),b)}getZoom(){return this.transform.zoom}setZoom(h,p){return this.jumpTo({zoom:h},p),this}zoomTo(h,p,b){return this.easeTo(s.extend({zoom:h},p),b)}zoomIn(h,p){return this.zoomTo(this.getZoom()+1,h,p),this}zoomOut(h,p){return this.zoomTo(this.getZoom()-1,h,p),this}getBearing(){return this.transform.bearing}setBearing(h,p){return this.jumpTo({bearing:h},p),this}getPadding(){return this.transform.padding}setPadding(h,p){return this.jumpTo({padding:h},p),this}rotateTo(h,p,b){return this.easeTo(s.extend({bearing:h},p),b)}resetNorth(h,p){return this.rotateTo(0,s.extend({duration:1e3},h),p),this}resetNorthPitch(h,p){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},h),p),this}snapToNorth(h,p){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(h,p):this}getPitch(){return this.transform.pitch}setPitch(h,p){return this.jumpTo({pitch:h},p),this}cameraForBounds(h,p){h=s.LngLatBounds.convert(h);const b=p&&p.bearing||0,w=p&&p.pitch||0,C=h.getNorthWest(),P=h.getSouthEast();return this._cameraForBounds(this.transform,C,P,b,w,p)}_extendCameraOptions(h){const p={top:0,bottom:0,right:0,left:0};if(typeof(h=s.extend({padding:p,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=="number"){const b=h.padding;h.padding={top:b,bottom:b,right:b,left:b}}return h.padding=s.extend(p,h.padding),h}_minimumAABBFrustumDistance(h,p){const b=p.max[0]-p.min[0],w=p.max[1]-p.min[1];return b/w>h.aspect?b/(2*Math.tan(.5*h.fovX)*h.aspect):w/(2*Math.tan(.5*h.fovY)*h.aspect)}_cameraForBoundsOnGlobe(h,p,b,w,C,P){const k=h.clone(),G=this._extendCameraOptions(P);k.bearing=w,k.pitch=C;const W=s.LngLat.convert(p),X=s.LngLat.convert(b),ne=.5*(W.lat+X.lat),ce=.5*(W.lng+X.lng),ye=s.latLngToECEF(ne,ce),_e=s.normalize([],ye),ve=s.normalize([],s.cross([],_e,[0,1,0])),xe=s.cross([],ve,_e),se=[ve[0],ve[1],ve[2],0,xe[0],xe[1],xe[2],0,_e[0],_e[1],_e[2],0,0,0,0,1],Le=[ye,s.latLngToECEF(W.lat,W.lng),s.latLngToECEF(X.lat,W.lng),s.latLngToECEF(X.lat,X.lng),s.latLngToECEF(W.lat,X.lng),s.latLngToECEF(ne,W.lng),s.latLngToECEF(ne,X.lng),s.latLngToECEF(W.lat,ce),s.latLngToECEF(X.lat,ce)];let Ae=s.Aabb.fromPoints(Le.map(en=>[s.dot(ve,en),s.dot(xe,en),s.dot(_e,en)]));const Re=s.transformMat4([],Ae.center,se);s.squaredLength(Re)===0&&s.set(Re,0,0,1),s.normalize(Re,Re),s.scale$2(Re,Re,s.GLOBE_RADIUS),k.center=s.ecefToLatLng(Re);const Xe=k.getWorldToCameraMatrix(),je=s.invert(new Float64Array(16),Xe);Ae=s.Aabb.applyTransform(Ae,s.multiply([],Xe,se)),s.transformMat4(Re,Re,Xe);const Ke=.5*(Ae.max[2]-Ae.min[2]),ft=this._minimumAABBFrustumDistance(k,Ae),dt=s.scale$2([],[0,0,1],Ke),xt=s.add(dt,Re,dt),Tn=ft+(k.pitch===0?0:s.distance(Re,xt)),gt=k.globeCenterInViewSpace,Zt=s.sub([],Re,[gt[0],gt[1],gt[2]]);s.normalize(Zt,Zt),s.scale$2(Zt,Zt,Tn);const St=s.add([],Re,Zt);s.transformMat4(St,St,je);const un=s.earthRadius/s.GLOBE_RADIUS,yt=s.length(St),ht=s.mercatorZfromAltitude(Math.max(yt*un-s.earthRadius,Number.EPSILON),0),Tt=Math.min(k.zoomFromMercatorZAdjusted(ht),G.maxZoom);return Tt>.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(k.setProjection({name:"mercator"}),k.zoom=Tt,this._cameraForBounds(k,p,b,w,C,P)):{center:k.center,zoom:Tt,bearing:w,pitch:C}}queryTerrainElevation(h,p){const b=this.transform.elevation;return b?(p=s.extend({},{exaggerated:!0},p),b.getAtPoint(s.MercatorCoordinate.fromLngLat(h),null,p.exaggerated)):null}_cameraForBounds(h,p,b,w,C,P){if(h.projection.name==="globe")return this._cameraForBoundsOnGlobe(h,p,b,w,C,P);const k=h.clone(),G=this._extendCameraOptions(P),W=k.padding;k.bearing=w,k.pitch=C;const X=s.LngLat.convert(p),ne=s.LngLat.convert(b),ce=new s.LngLat(X.lng,ne.lat),ye=new s.LngLat(ne.lng,X.lat),_e=k.project(X),ve=k.project(ne),xe=this.queryTerrainElevation(X),se=this.queryTerrainElevation(ne),Le=this.queryTerrainElevation(ce),Ae=this.queryTerrainElevation(ye),Re=[[_e.x,_e.y,Math.min(xe||0,se||0,Le||0,Ae||0)],[ve.x,ve.y,Math.max(xe||0,se||0,Le||0,Ae||0)]];let Xe=s.Aabb.fromPoints(Re);const je=k.getWorldToCameraMatrix(),Ke=s.invert(new Float64Array(16),je);Xe=s.Aabb.applyTransform(Xe,je);const ft=s.sub([],Xe.max,Xe.min),dt=W.left||0,xt=W.right||0,Tn=W.bottom||0,gt=W.top||0,{left:Zt,right:St,top:un,bottom:yt}=G.padding,ht=.5*(dt+xt),Tt=.5*(gt+Tn),en=Math.min(k.scaleZoom(k.scale*Math.min((k.width-(dt+xt+Zt+St))/ft[0],(k.height-(Tn+gt+yt+un))/ft[1])),G.maxZoom),ln=k.scale/k.zoomScale(en);Xe=new s.Aabb([Xe.min[0]-(Zt+ht)*ln,Xe.min[1]-(yt+Tt)*ln,Xe.min[2]],[Xe.max[0]+(St+ht)*ln,Xe.max[1]+(un+Tt)*ln,Xe.max[2]]);const ci=.5*ft[2],ur=this._minimumAABBFrustumDistance(k,Xe),$n=[0,0,1,0];s.transformMat4$1($n,$n,je),s.normalize$2($n,$n);const Hn=s.scale$2([],$n,ur+ci),di=s.add([],Xe.center,Hn),vr=(typeof G.offset.x=="number"&&typeof G.offset.y=="number"?new s.pointGeometry(G.offset.x,G.offset.y):s.pointGeometry.convert(G.offset)).rotate(-s.degToRad(w));Xe.center[0]-=vr.x*ln,Xe.center[1]+=vr.y*ln,s.transformMat4(Xe.center,Xe.center,Ke),s.transformMat4(di,di,Ke);const bi=[Xe.center[0],Xe.center[1],di[2]*k.pixelsPerMeter];s.scale$2(bi,bi,1/k.worldSize);const Wr=s.lngFromMercatorX(bi[0]),$r=s.latFromMercatorY(bi[1]),xs=Math.min(k._zoomFromMercatorZ(bi[2]),G.maxZoom),ss=new s.LngLat(Wr,$r);return k.mercatorFromTransition&&xs<.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(k.setProjection({name:"globe"}),k.zoom=xs,this._cameraForBounds(k,p,b,w,C,P)):{center:ss,zoom:xs,bearing:w,pitch:C}}fitBounds(h,p,b){const w=this.cameraForBounds(h,p);return this._fitInternal(w,p,b)}fitScreenCoordinates(h,p,b,w,C){const P=s.pointGeometry.convert(h),k=s.pointGeometry.convert(p),G=new s.pointGeometry(Math.min(P.x,k.x),Math.min(P.y,k.y)),W=new s.pointGeometry(Math.max(P.x,k.x),Math.max(P.y,k.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(P,k))return this;const X=this.transform.pointLocation3D(G),ne=this.transform.pointLocation3D(W),ce=this.transform.pointLocation3D(new s.pointGeometry(G.x,W.y)),ye=this.transform.pointLocation3D(new s.pointGeometry(W.x,G.y)),_e=[Math.min(X.lng,ne.lng,ce.lng,ye.lng),Math.min(X.lat,ne.lat,ce.lat,ye.lat)],ve=[Math.max(X.lng,ne.lng,ce.lng,ye.lng),Math.max(X.lat,ne.lat,ce.lat,ye.lat)],xe=w&&w.pitch?w.pitch:this.getPitch(),se=this._cameraForBounds(this.transform,_e,ve,b,xe,w);return this._fitInternal(se,w,C)}_fitInternal(h,p,b){return h?(delete(p=s.extend(h,p)).padding,p.linear?this.easeTo(p,b):this.flyTo(p,b)):this}jumpTo(h,p){this.stop();const b=h.preloadOnly?this.transform.clone():this.transform;let w=!1,C=!1,P=!1;return"zoom"in h&&b.zoom!==+h.zoom&&(w=!0,b.zoom=+h.zoom),h.center!==void 0&&(b.center=s.LngLat.convert(h.center)),"bearing"in h&&b.bearing!==+h.bearing&&(C=!0,b.bearing=+h.bearing),"pitch"in h&&b.pitch!==+h.pitch&&(P=!0,b.pitch=+h.pitch),h.padding==null||b.isPaddingEqual(h.padding)||(b.padding=h.padding),h.preloadOnly?(this._preloadTiles(b),this):(this.fire(new s.Event("movestart",p)).fire(new s.Event("move",p)),w&&this.fire(new s.Event("zoomstart",p)).fire(new s.Event("zoom",p)).fire(new s.Event("zoomend",p)),C&&this.fire(new s.Event("rotatestart",p)).fire(new s.Event("rotate",p)).fire(new s.Event("rotateend",p)),P&&this.fire(new s.Event("pitchstart",p)).fire(new s.Event("pitch",p)).fire(new s.Event("pitchend",p)),this.fire(new s.Event("moveend",p)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.warnOnce(Rg),this.transform.getFreeCameraOptions()}setFreeCameraOptions(h,p){const b=this.transform;if(!b.projection.supportsFreeCamera)return s.warnOnce(Rg),this;this.stop();const w=b.zoom,C=b.pitch,P=b.bearing;b.setFreeCameraOptions(h);const k=w!==b.zoom,G=C!==b.pitch,W=P!==b.bearing;return this.fire(new s.Event("movestart",p)).fire(new s.Event("move",p)),k&&this.fire(new s.Event("zoomstart",p)).fire(new s.Event("zoom",p)).fire(new s.Event("zoomend",p)),W&&this.fire(new s.Event("rotatestart",p)).fire(new s.Event("rotate",p)).fire(new s.Event("rotateend",p)),G&&this.fire(new s.Event("pitchstart",p)).fire(new s.Event("pitch",p)).fire(new s.Event("pitchend",p)),this.fire(new s.Event("moveend",p)),this}easeTo(h,p){this._stop(!1,h.easeId),((h=s.extend({offset:[0,0],duration:500,easing:s.ease},h)).animate===!1||!h.essential&&s.exported.prefersReducedMotion)&&(h.duration=0);const b=this.transform,w=this.getZoom(),C=this.getBearing(),P=this.getPitch(),k=this.getPadding(),G="zoom"in h?+h.zoom:w,W="bearing"in h?this._normalizeBearing(h.bearing,C):C,X="pitch"in h?+h.pitch:P,ne="padding"in h?h.padding:b.padding,ce=s.pointGeometry.convert(h.offset);let ye,_e,ve;if(b.projection.name==="globe"){const dt=s.MercatorCoordinate.fromLngLat(b.center),xt=ce.rotate(-b.angle);dt.x+=xt.x/b.worldSize,dt.y+=xt.y/b.worldSize;const Tn=dt.toLngLat(),gt=s.LngLat.convert(h.center||Tn);this._normalizeCenter(gt),ye=b.centerPoint.add(xt),_e=new s.pointGeometry(dt.x,dt.y).mult(b.worldSize),ve=new s.pointGeometry(s.mercatorXfromLng(gt.lng),s.mercatorYfromLat(gt.lat)).mult(b.worldSize).sub(_e)}else{ye=b.centerPoint.add(ce);const dt=b.pointLocation(ye),xt=s.LngLat.convert(h.center||dt);this._normalizeCenter(xt),_e=b.project(dt),ve=b.project(xt).sub(_e)}const xe=b.zoomScale(G-w);let se,Le;h.around&&(se=s.LngLat.convert(h.around),Le=b.locationPoint(se));const Ae=this._zooming||G!==w,Re=this._rotating||C!==W,Xe=this._pitching||X!==P,je=!b.isPaddingEqual(ne),Ke=dt=>xt=>{if(Ae&&(dt.zoom=s.number(w,G,xt)),Re&&(dt.bearing=s.number(C,W,xt)),Xe&&(dt.pitch=s.number(P,X,xt)),je&&(dt.interpolatePadding(k,ne,xt),ye=dt.centerPoint.add(ce)),se)dt.setLocationAtPoint(se,Le);else{const Tn=dt.zoomScale(dt.zoom-w),gt=G>w?Math.min(2,xe):Math.max(.5,xe),Zt=Math.pow(gt,1-xt),St=dt.unproject(_e.add(ve.mult(xt*Zt)).mult(Tn));dt.setLocationAtPoint(dt.renderWorldCopies?St.wrap():St,ye)}return h.preloadOnly||this._fireMoveEvents(p),dt};if(h.preloadOnly){const dt=this._emulate(Ke,h.duration,b);return this._preloadTiles(dt),this}const ft={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ae,this._rotating=Re,this._pitching=Xe,this._padding=je,this._easeId=h.easeId,this._prepareEase(p,h.noMoveStart,ft),this._ease(Ke(b),dt=>{b.recenterOnTerrain(),this._afterEase(p,dt)},h),this}_prepareEase(h,p,b={}){this._moving=!0,this.transform.cameraElevationReference="sea",p||b.moving||this.fire(new s.Event("movestart",h)),this._zooming&&!b.zooming&&this.fire(new s.Event("zoomstart",h)),this._rotating&&!b.rotating&&this.fire(new s.Event("rotatestart",h)),this._pitching&&!b.pitching&&this.fire(new s.Event("pitchstart",h))}_fireMoveEvents(h){this.fire(new s.Event("move",h)),this._zooming&&this.fire(new s.Event("zoom",h)),this._rotating&&this.fire(new s.Event("rotate",h)),this._pitching&&this.fire(new s.Event("pitch",h))}_afterEase(h,p){if(this._easeId&&p&&this._easeId===p)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const b=this._zooming,w=this._rotating,C=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,b&&this.fire(new s.Event("zoomend",h)),w&&this.fire(new s.Event("rotateend",h)),C&&this.fire(new s.Event("pitchend",h)),this.fire(new s.Event("moveend",h))}flyTo(h,p){if(!h.essential&&s.exported.prefersReducedMotion){const en=s.pick(h,["center","zoom","bearing","pitch","around"]);return this.jumpTo(en,p)}this.stop(),h=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},h);const b=this.transform,w=this.getZoom(),C=this.getBearing(),P=this.getPitch(),k=this.getPadding(),G="zoom"in h?s.clamp(+h.zoom,b.minZoom,b.maxZoom):w,W="bearing"in h?this._normalizeBearing(h.bearing,C):C,X="pitch"in h?+h.pitch:P,ne="padding"in h?h.padding:b.padding,ce=b.zoomScale(G-w),ye=s.pointGeometry.convert(h.offset);let _e=b.centerPoint.add(ye);const ve=b.pointLocation(_e),xe=s.LngLat.convert(h.center||ve);this._normalizeCenter(xe);const se=b.project(ve),Le=b.project(xe).sub(se);let Ae=h.curve;const Re=Math.max(b.width,b.height),Xe=Re/ce,je=Le.mag();if("minZoom"in h){const en=s.clamp(Math.min(h.minZoom,w,G),b.minZoom,b.maxZoom),ln=Re/b.zoomScale(en-w);Ae=Math.sqrt(ln/je*2)}const Ke=Ae*Ae;function ft(en){const ln=(Xe*Xe-Re*Re+(en?-1:1)*Ke*Ke*je*je)/(2*(en?Xe:Re)*Ke*je);return Math.log(Math.sqrt(ln*ln+1)-ln)}function dt(en){return(Math.exp(en)-Math.exp(-en))/2}function xt(en){return(Math.exp(en)+Math.exp(-en))/2}const Tn=ft(0);let gt=function(en){return xt(Tn)/xt(Tn+Ae*en)},Zt=function(en){return Re*((xt(Tn)*(dt(ln=Tn+Ae*en)/xt(ln))-dt(Tn))/Ke)/je;var ln},St=(ft(1)-Tn)/Ae;if(Math.abs(je)<1e-6||!isFinite(St)){if(Math.abs(Re-Xe)<1e-6)return this.easeTo(h,p);const en=Xe<Re?-1:1;St=Math.abs(Math.log(Xe/Re))/Ae,Zt=function(){return 0},gt=function(ln){return Math.exp(en*Ae*ln)}}h.duration="duration"in h?+h.duration:1e3*St/("screenSpeed"in h?+h.screenSpeed/Ae:+h.speed),h.maxDuration&&h.duration>h.maxDuration&&(h.duration=0);const un=C!==W,yt=X!==P,ht=!b.isPaddingEqual(ne),Tt=en=>ln=>{const ci=ln*St,ur=1/gt(ci);en.zoom=ln===1?G:w+en.scaleZoom(ur),un&&(en.bearing=s.number(C,W,ln)),yt&&(en.pitch=s.number(P,X,ln)),ht&&(en.interpolatePadding(k,ne,ln),_e=en.centerPoint.add(ye));const $n=ln===1?xe:en.unproject(se.add(Le.mult(Zt(ci))).mult(ur));return en.setLocationAtPoint(en.renderWorldCopies?$n.wrap():$n,_e),en._updateCameraOnTerrain(),h.preloadOnly||this._fireMoveEvents(p),en};if(h.preloadOnly){const en=this._emulate(Tt,h.duration,b);return this._preloadTiles(en),this}return this._zooming=!0,this._rotating=un,this._pitching=yt,this._padding=ht,this._prepareEase(p,!1),this._ease(Tt(b),()=>this._afterEase(p),h),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(h,p){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const b=this._onEaseEnd;this._onEaseEnd=void 0,b.call(this,p)}if(!h){const b=this.handlers;b&&b.stop(!1)}return this}_ease(h,p,b){b.animate===!1||b.duration===0?(h(1),p()):(this._easeStart=s.exported.now(),this._easeOptions=b,this._onEaseFrame=h,this._onEaseEnd=p,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const h=Math.min((s.exported.now()-this._easeStart)/this._easeOptions.duration,1),p=this._onEaseFrame;p&&p(this._easeOptions.easing(h)),h<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(h,p){h=s.wrap(h,-180,180);const b=Math.abs(h-p);return Math.abs(h-360-p)<b&&(h-=360),Math.abs(h+360-p)<b&&(h+=360),h}_normalizeCenter(h){const p=this.transform;if(!p.renderWorldCopies||p.maxBounds)return;const b=h.lng-p.center.lng;h.lng+=b>180?-360:b<-180?360:0}_emulate(h,p,b){const w=Math.ceil(15*p/1e3),C=[],P=h(b.clone());for(let k=0;k<=w;k++){const G=P(k/w);C.push(G.clone())}return C}}class Pg{constructor(h={}){this.options=h,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(h){const p=this.options&&this.options.compact;return this._map=h,this._container=A("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=A("button","mapboxgl-ctrl-attrib-button",this._container),A("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=A("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),p&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),p===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(h,p){const b=this._map._getUIString(`AttributionControl.${p}`);h.setAttribute("aria-label",b),h.removeAttribute("title"),h.firstElementChild&&h.firstElementChild.setAttribute("title",b)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let h=this._editLink;h||(h=this._editLink=this._container.querySelector(".mapbox-improve-map"));const p=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(h){const b=p.reduce((w,C,P)=>(C.value&&(w+=`${C.key}=${C.value}${P<p.length-1?"&":""}`),w),"?");h.href=`${s.config.FEEDBACK_URL}/${b}#${Dd(this._map,!0)}`,h.rel="noopener nofollow",this._setElementTitle(h,"MapFeedback")}}_updateData(h){!h||h.sourceDataType!=="metadata"&&h.sourceDataType!=="visibility"&&h.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let h=[];if(this._map.style.stylesheet){const w=this._map.style.stylesheet;this.styleOwner=w.owner,this.styleId=w.id}const p=this._map.style._sourceCaches;for(const w in p){const C=p[w];if(C.used){const P=C.getSource();P.attribution&&h.indexOf(P.attribution)<0&&h.push(P.attribution)}}h.sort((w,C)=>w.length-C.length),h=h.filter((w,C)=>{for(let P=C+1;P<h.length;P++)if(h[P].indexOf(w)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?h=[...this.options.customAttribution,...h]:h.unshift(this.options.customAttribution));const b=h.join(" | ");b!==this._attribHTML&&(this._attribHTML=b,h.length?(this._innerContainer.innerHTML=b,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Dg{constructor(){s.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(h){this._map=h,this._container=A("div","mapboxgl-ctrl");const p=A("a","mapboxgl-ctrl-logo");return p.target="_blank",p.rel="noopener nofollow",p.href="https://www.mapbox.com/",p.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),p.setAttribute("rel","noopener nofollow"),this._container.appendChild(p),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(h){h&&h.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const h=this._map.style._sourceCaches;if(Object.entries(h).length===0)return!0;for(const p in h){const b=h[p].getSource();if(b.hasOwnProperty("mapbox_logo")&&!b.mapbox_logo)return!1}return!0}_updateCompact(){const h=this._container.children;if(h.length){const p=h[0];this._map.getCanvasContainer().offsetWidth<250?p.classList.add("mapboxgl-compact"):p.classList.remove("mapboxgl-compact")}}}class Hp{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(h){const p=++this._id;return this._queue.push({callback:h,id:p,cancelled:!1}),p}remove(h){const p=this._currentlyRunning,b=p?this._queue.concat(p):this._queue;for(const w of b)if(w.id===h)return void(w.cancelled=!0)}run(h=0){const p=this._currentlyRunning=this._queue;this._queue=[];for(const b of p)if(!b.cancelled&&(b.callback(h),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Sc(y,h,p){if(y=new s.LngLat(y.lng,y.lat),h){const b=new s.LngLat(y.lng-360,y.lat),w=new s.LngLat(y.lng+360,y.lat),C=360*Math.ceil(Math.abs(y.lng-p.center.lng)/360),P=p.locationPoint(y).distSqr(h),k=h.x<0||h.y<0||h.x>p.width||h.y>p.height;p.locationPoint(b).distSqr(h)<P&&(k||Math.abs(b.lng-p.center.lng)<C)?y=b:p.locationPoint(w).distSqr(h)<P&&(k||Math.abs(w.lng-p.center.lng)<C)&&(y=w)}for(;Math.abs(y.lng-p.center.lng)>180;){const b=p.locationPoint(y);if(b.x>=0&&b.y>=0&&b.x<=p.width&&b.y<=p.height)break;y.lng>p.center.lng?y.lng-=360:y.lng+=360}return y}const zd={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Cm extends s.Evented{constructor(h,p){if(super(),(h instanceof s.window.HTMLElement||p)&&(h=s.extend({element:h},p)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=h&&h.anchor||"center",this._color=h&&h.color||"#3FB1CE",this._scale=h&&h.scale||1,this._draggable=h&&h.draggable||!1,this._clickTolerance=h&&h.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=h&&h.rotation||0,this._rotationAlignment=h&&h.rotationAlignment||"auto",this._pitchAlignment=h&&h.pitchAlignment&&h.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=h&&h.occludedOpacity||.2,h&&h.element)this._element=h.element,this._offset=s.pointGeometry.convert(h&&h.offset||[0,0]);else{this._defaultMarker=!0,this._element=A("div");const w=41,C=27,P=L("svg",{display:"block",height:w*this._scale+"px",width:C*this._scale+"px",viewBox:`0 0 ${C} ${w}`},this._element),k=L("radialGradient",{id:"shadowGradient"},L("defs",{},P));L("stop",{offset:"10%","stop-opacity":.4},k),L("stop",{offset:"100%","stop-opacity":.05},k),L("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},P),L("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},P),L("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},P),L("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},P),this._offset=s.pointGeometry.convert(h&&h.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",w=>{w.preventDefault()}),this._element.addEventListener("mousedown",w=>{w.preventDefault()});const b=this._element.classList;for(const w in zd)b.remove(`mapboxgl-marker-anchor-${w}`);b.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(h){return h===this._map||(this.remove(),this._map=h,h.getCanvasContainer().appendChild(this._element),h.on("move",this._updateMoving),h.on("moveend",this._update),h.on("remove",this._clearFadeTimer),h._addMarker(this),this.setDraggable(this._draggable),this._update(),h.on("click",this._onMapClick)),this}remove(){const h=this._map;return h&&(h.off("click",this._onMapClick),h.off("move",this._updateMoving),h.off("moveend",this._update),h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler),h.off("mouseup",this._onUp),h.off("touchend",this._onUp),h.off("mousemove",this._onMove),h.off("touchmove",this._onMove),h.off("remove",this._clearFadeTimer),h._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(h){return this._lngLat=s.LngLat.convert(h),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(h){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),h){if(!("offset"in h.options)){const w=Math.sqrt(Math.pow(13.5,2)/2);h.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[w,-1*(38.1-13.5+w)],"bottom-right":[-w,-1*(38.1-13.5+w)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=h,h._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(h){const p=h.code,b=h.charCode||h.keyCode;p!=="Space"&&p!=="Enter"&&b!==32&&b!==13||this.togglePopup()}_onMapClick(h){const p=h.originalEvent.target,b=this._element;this._popup&&(p===b||b.contains(p))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const h=this._popup;return h?(h.isOpen()?(h.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(h.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const h=this._map,p=this._pos;if(!h||!p)return!1;const b=h.unproject(p),w=h.getFreeCameraOptions();if(!w.position)return!1;const C=w.position.toLngLat();return C.distanceTo(b)<.9*C.distanceTo(this._lngLat)}_evaluateOpacity(){const h=this._map;if(!h)return;const p=this._pos;if(!p||p.x<0||p.x>h.transform.width||p.y<0||p.y>h.transform.height)return void this._clearFadeTimer();const b=h.unproject(p);let w;h._showingGlobe()&&s.isLngLatBehindGlobe(h.transform,this._lngLat)?w=0:(w=1-h._queryFogOpacity(b),h.transform._terrainEnabled()&&h.getTerrain()&&this._behindTerrain()&&(w*=this._occludedOpacity)),this._element.style.opacity=`${w}`,this._element.style.pointerEvents=w>0?"auto":"none",this._popup&&this._popup._setOpacity(w),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const h=this._pos;if(!h||!this._map)return;const p=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${h.x}px,${h.y}px)
            ${zd[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${p.x}px,${p.y}px)
        `}_calculateXYTransform(){const h=this._pos,p=this._map,b=this.getPitchAlignment();if(!p||!h||b!=="map")return"";if(!p._showingGlobe()){const G=p.getPitch();return G?`rotateX(${G}deg)`:""}const w=s.radToDeg(s.globeTiltAtLngLat(p.transform,this._lngLat)),C=h.sub(s.globeCenterToScreenPoint(p.transform)),P=Math.abs(C.x)+Math.abs(C.y);if(P===0)return"";const k=w/P;return`rotateX(${-C.y*k}deg) rotateY(${C.x*k}deg)`}_calculateZTransform(){const h=this._pos,p=this._map;if(!p||!h)return"";let b=0;const w=this.getRotationAlignment();if(w==="map")if(p._showingGlobe()){const C=p.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),P=p.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(C);b=s.radToDeg(Math.atan2(P.y,P.x))-90}else b=-p.getBearing();else if(w==="horizon"){const C=s.smoothstep(4,6,p.getZoom()),P=s.globeCenterToScreenPoint(p.transform);P.y+=C*p.transform.height;const k=h.sub(P),G=s.radToDeg(Math.atan2(k.y,k.x));b=(G>90?G-270:G+90)*(1-C)}return b+=this._rotation,b?`rotateZ(${b}deg)`:""}_update(h){s.window.cancelAnimationFrame(this._updateFrameId);const p=this._map;p&&(p.transform.renderWorldCopies&&(this._lngLat=Sc(this._lngLat,this._pos,p.transform)),this._pos=p.project(this._lngLat),h===!0?this._updateFrameId=s.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),p._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(p._showingGlobe()||p.getTerrain()||p.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(h){return this._offset=s.pointGeometry.convert(h),this._update(),this}_onMove(h){const p=this._map;if(!p)return;const b=this._pointerdownPos,w=this._positionDelta;if(b&&w){if(!this._isDragging){const C=this._clickTolerance||p._clickTolerance;if(h.point.dist(b)<C)return;this._isDragging=!0}this._pos=h.point.sub(w),this._lngLat=p.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const h=this._map;h&&(h.off("mousemove",this._onMove),h.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"}_addDragHandler(h){const p=this._map,b=this._pos;p&&b&&this._element.contains(h.originalEvent.target)&&(h.preventDefault(),this._positionDelta=h.point.sub(b),this._pointerdownPos=h.point,this._state="pending",p.on("mousemove",this._onMove),p.on("touchmove",this._onMove),p.once("mouseup",this._onUp),p.once("touchend",this._onUp))}setDraggable(h){this._draggable=!!h;const p=this._map;return p&&(h?(p.on("mousedown",this._addDragHandler),p.on("touchstart",this._addDragHandler)):(p.off("mousedown",this._addDragHandler),p.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(h){return this._rotation=h||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(h){return this._rotationAlignment=h||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(h){return this._pitchAlignment=h||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(h){return this._occludedOpacity=h||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const fu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},iy=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Og(y=new s.pointGeometry(0,0),h="bottom"){if(typeof y=="number"){const p=Math.round(Math.sqrt(.5*Math.pow(y,2)));switch(h){case"top":return new s.pointGeometry(0,y);case"top-left":return new s.pointGeometry(p,p);case"top-right":return new s.pointGeometry(-p,p);case"bottom":return new s.pointGeometry(0,-y);case"bottom-left":return new s.pointGeometry(p,-p);case"bottom-right":return new s.pointGeometry(-p,-p);case"left":return new s.pointGeometry(y,0);case"right":return new s.pointGeometry(-y,0)}return new s.pointGeometry(0,0)}return y instanceof s.pointGeometry||Array.isArray(y)?s.pointGeometry.convert(y):s.pointGeometry.convert(y[h]||[0,0])}class ry{constructor(h){this.jumpTo(h)}getValue(h){if(h<=this._startTime)return this._start;if(h>=this._endTime)return this._end;const p=s.easeCubicInOut((h-this._startTime)/(this._endTime-this._startTime));return this._start*(1-p)+this._end*p}isEasing(h){return h>=this._startTime&&h<=this._endTime}jumpTo(h){this._startTime=-1/0,this._endTime=-1/0,this._start=h,this._end=h}easeTo(h,p,b){this._start=this.getValue(p),this._end=h,this._startTime=p,this._endTime=p+b}}const sy={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},oy={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Am={showCompass:!0,showZoom:!0,visualizePitch:!1};class Ng{constructor(h,p,b=!1){this._clickTolerance=10,this.element=p,this.mouseRotate=new Ag({clickTolerance:h.dragRotate._mouseRotate._clickTolerance}),this.map=h,b&&(this.mousePitch=new Mg({clickTolerance:h.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),p.addEventListener("mousedown",this.mousedown),p.addEventListener("touchstart",this.touchstart,{passive:!1}),p.addEventListener("touchmove",this.touchmove),p.addEventListener("touchend",this.touchend),p.addEventListener("touchcancel",this.reset)}down(h,p){this.mouseRotate.mousedown(h,p),this.mousePitch&&this.mousePitch.mousedown(h,p),z()}move(h,p){const b=this.map,w=this.mouseRotate.mousemoveWindow(h,p),C=w&&w.bearingDelta;if(C&&b.setBearing(b.getBearing()+C),this.mousePitch){const P=this.mousePitch.mousemoveWindow(h,p),k=P&&P.pitchDelta;k&&b.setPitch(b.getPitch()+k)}}off(){const h=this.element;h.removeEventListener("mousedown",this.mousedown),h.removeEventListener("touchstart",this.touchstart,{passive:!1}),h.removeEventListener("touchmove",this.touchmove),h.removeEventListener("touchend",this.touchend),h.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){V(),s.window.removeEventListener("mousemove",this.mousemove),s.window.removeEventListener("mouseup",this.mouseup)}mousedown(h){this.down(s.extend({},h,{ctrlKey:!0,preventDefault:()=>h.preventDefault()}),J(this.element,h)),s.window.addEventListener("mousemove",this.mousemove),s.window.addEventListener("mouseup",this.mouseup)}mousemove(h){this.move(h,J(this.element,h))}mouseup(h){this.mouseRotate.mouseupWindow(h),this.mousePitch&&this.mousePitch.mouseupWindow(h),this.offTemp()}touchstart(h){h.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=he(this.element,h.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>h.preventDefault()},this._startPos))}touchmove(h){h.targetTouches.length!==1?this.reset():(this._lastPos=he(this.element,h.targetTouches)[0],this.move({preventDefault:()=>h.preventDefault()},this._lastPos))}touchend(h){h.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const ay={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},ly={maxWidth:100,unit:"metric"};function Mm(y,h,p){const b=ef(h),w=b/h,C={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[p];this._map._requestDomTask(()=>{this._container.style.width=y*w+"px",this._container.innerHTML=`${b}&nbsp;${C}`})}function ef(y){const h=Math.pow(10,`${Math.floor(y)}`.length-1);let p=y/h;return p=p>=10?10:p>=5?5:p>=3?3:p>=2?2:p>=1?1:function(b){const w=Math.pow(10,Math.ceil(-Math.log(b)/Math.LN10));return Math.round(b*w)/w}(p),h*p}const tf={version:s.version,supported:g,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:class extends ny{constructor(y){if(s.LivePerformanceUtils.mark(s.PerformanceMarkers.create),(y=s.extend({},oy,y)).minZoom!=null&&y.maxZoom!=null&&y.minZoom>y.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(y.minPitch!=null&&y.maxPitch!=null&&y.minPitch>y.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(y.minPitch!=null&&y.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(y.maxPitch!=null&&y.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(y.antialias&&s.isSafariWithAntialiasingBug(s.window)&&(y.antialias=!1,s.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Vn(y.minZoom,y.maxZoom,y.minPitch,y.maxPitch,y.renderWorldCopies),y),this._interactive=y.interactive,this._minTileCacheSize=y.minTileCacheSize,this._maxTileCacheSize=y.maxTileCacheSize,this._failIfMajorPerformanceCaveat=y.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=y.preserveDrawingBuffer,this._antialias=y.antialias,this._useWebGL2=y.useWebGL2,this._trackResize=y.trackResize,this._bearingSnap=y.bearingSnap,this._refreshExpiredTiles=y.refreshExpiredTiles,this._fadeDuration=y.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=y.crossSourceCollisions,this._collectResourceTiming=y.collectResourceTiming,this._optimizeForTerrain=y.optimizeForTerrain,this._language=this._parseLanguage(y.language),this._worldview=y.worldview,this._renderTaskQueue=new Hp,this._domRenderTaskQueue=new Hp,this._controls=[],this._markers=[],this._popups=[],this._mapId=s.uniqueId(),this._locale=s.extend({},sy,y.locale),this._clickTolerance=y.clickTolerance,this._cooperativeGestures=y.cooperativeGestures,this._performanceMetricsCollection=y.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new ry(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new s.RequestManager(y.transformRequest,y.accessToken,y.testMode),this._silenceAuthErrors=!!y.testMode,typeof y.container=="string"){if(this._container=s.window.document.getElementById(y.container),!this._container)throw new Error(`Container '${y.container}' not found.`)}else{if(!(y.container instanceof s.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=y.container}if(this._container.childNodes.length>0&&s.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),y.maxBounds&&this.setMaxBounds(y.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),s.window!==void 0&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1),s.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new wc(this,y),this._localFontFamily=y.localFontFamily,this._localIdeographFontFamily=y.localIdeographFontFamily,y.style&&this.setStyle(y.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),y.projection&&this.setProjection(y.projection),this._hash=y.hash&&new Op(typeof y.hash=="string"&&y.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch}),y.bounds&&(this.resize(),this.fitBounds(y.bounds,s.extend({},y.fitBoundsOptions,{duration:0})))),this.resize(),y.attributionControl&&this.addControl(new Pg({customAttribution:y.customAttribution})),this._logoControl=new Dg,this.addControl(this._logoControl,y.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",h=>{this._update(h.dataType==="style"),this.fire(new s.Event(`${h.dataType}data`,h))}),this.on("dataloading",h=>{this.fire(new s.Event(`${h.dataType}dataloading`,h))})}_getMapId(){return this._mapId}addControl(y,h){if(h===void 0&&(h=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const p=y.onAdd(this);this._controls.push(y);const b=this._controlPositions[h];return h.indexOf("bottom")!==-1?b.insertBefore(p,b.firstChild):b.appendChild(p),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const h=this._controls.indexOf(y);return h>-1&&this._controls.splice(h,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(y){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const h=!this._moving;return h&&this.fire(new s.Event("movestart",y)).fire(new s.Event("move",y)),this.fire(new s.Event("resize",y)),h&&this.fire(new s.Event("moveend",y)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(y){return this.transform.setMaxBounds(s.LngLatBounds.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this._update(),this.getZoom()<y?this.setZoom(y):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.maxZoom=y,this._update(),this.getZoom()>y?this.setZoom(y):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this._update(),this.getPitch()<y?this.setPitch(y):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this._update(),this.getPitch()>y?this.setPitch(y):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.renderWorldCopies=y,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(y){return y==="auto"?s.window.navigator.language:Array.isArray(y)?y.length===0?void 0:y.map(h=>h==="auto"?s.window.navigator.language:h):y}setLanguage(y){const h=this._parseLanguage(y);if(!this.style||h===this._language)return this;this._language=h,this.style._reloadSources();for(const p of this._controls)p._setLanguage&&p._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(y){return this.style&&y!==this._worldview?(this._worldview=y,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(y){return this._lazyInitEmptyStyle(),y?typeof y=="string"&&(y={name:y}):y=null,this._useExplicitProjection=!!y,this._prioritizeAndUpdateProjection(y,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const y=this.transform,h=y.projection.name;let p;h==="globe"&&y.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?(y.setMercatorFromTransition(),p=!0):h==="mercator"&&y.zoom<s.GLOBE_ZOOM_THRESHOLD_MAX&&(y.setProjection({name:"globe"}),p=!0),p&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(y,h){return this._updateProjection(y||h||{name:"mercator"})}_updateProjection(y){let h;if(h=y.name==="globe"&&this.transform.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(y),this.style.applyProjectionUpdate(),h){this.painter.clearBackgroundTiles();for(const p in this.style._sourceCaches)this.style._sourceCaches[p].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(y){return this.transform.locationPoint3D(s.LngLat.convert(y))}unproject(y){return this.transform.pointLocation3D(s.pointGeometry.convert(y))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(y,h,p){if(y==="mouseenter"||y==="mouseover"){let b=!1;const w=P=>{const k=h.filter(W=>this.getLayer(W)),G=k.length?this.queryRenderedFeatures(P.point,{layers:k}):[];G.length?b||(b=!0,p.call(this,new aa(y,this,P.originalEvent,{features:G}))):b=!1},C=()=>{b=!1};return{layers:new Set(h),listener:p,delegates:{mousemove:w,mouseout:C}}}if(y==="mouseleave"||y==="mouseout"){let b=!1;const w=P=>{const k=h.filter(G=>this.getLayer(G));(k.length?this.queryRenderedFeatures(P.point,{layers:k}):[]).length?b=!0:b&&(b=!1,p.call(this,new aa(y,this,P.originalEvent)))},C=P=>{b&&(b=!1,p.call(this,new aa(y,this,P.originalEvent)))};return{layers:new Set(h),listener:p,delegates:{mousemove:w,mouseout:C}}}{const b=w=>{const C=h.filter(k=>this.getLayer(k)),P=C.length?this.queryRenderedFeatures(w.point,{layers:C}):[];P.length&&(w.features=P,p.call(this,w),delete w.features)};return{layers:new Set(h),listener:p,delegates:{[y]:b}}}}on(y,h,p){if(p===void 0)return super.on(y,h);Array.isArray(h)||(h=[h]);const b=this._createDelegatedListener(y,h,p);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(b);for(const w in b.delegates)this.on(w,b.delegates[w]);return this}once(y,h,p){if(p===void 0)return super.once(y,h);Array.isArray(h)||(h=[h]);const b=this._createDelegatedListener(y,h,p);for(const w in b.delegates)this.once(w,b.delegates[w]);return this}off(y,h,p){if(p===void 0)return super.off(y,h);h=new Set(Array.isArray(h)?h:[h]);const b=(C,P)=>{if(C.size!==P.size)return!1;for(const k of C)if(!P.has(k))return!1;return!0},w=this._delegatedListeners?this._delegatedListeners[y]:void 0;return w&&(C=>{for(let P=0;P<C.length;P++){const k=C[P];if(k.listener===p&&b(k.layers,h)){for(const G in k.delegates)this.off(G,k.delegates[G]);return C.splice(P,1),this}}})(w),this}queryRenderedFeatures(y,h){return this.style?(h!==void 0||y===void 0||y instanceof s.pointGeometry||Array.isArray(y)||(h=y,y=void 0),this.style.queryRenderedFeatures(y=y||[[0,0],[this.transform.width,this.transform.height]],h=h||{},this.transform)):[]}querySourceFeatures(y,h){return this.style.querySourceFeatures(y,h)}setStyle(y,h){return(h=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},h)).diff!==!1&&h.localIdeographFontFamily===this._localIdeographFontFamily&&h.localFontFamily===this._localFontFamily&&this.style&&y?(this._diffStyle(y,h),this):(this._localIdeographFontFamily=h.localIdeographFontFamily,this._localFontFamily=h.localFontFamily,this._updateStyle(y,h))}_getUIString(y){const h=this._locale[y];if(h==null)throw new Error(`Missing UI string '${y}'`);return h}_updateStyle(y,h){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),y&&(this.style=new bs(this,h||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y):this.style.loadJSON(y)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new bs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,h){if(typeof y=="string"){const p=this._requestManager.normalizeStyleURL(y),b=this._requestManager.transformRequest(p,s.ResourceType.Style);s.getJSON(b,(w,C)=>{w?this.fire(new s.ErrorEvent(w)):C&&this._updateDiff(C,h)})}else typeof y=="object"&&this._updateDiff(y,h)}_updateDiff(y,h){try{this.style.setState(y)&&this._update(!0)}catch(p){s.warnOnce(`Unable to perform style diff: ${p.message||p.error||p}.  Rebuilding the style from scratch.`),this._updateStyle(y,h)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.warnOnce("There is no style added to the map."),!1)}addSource(y,h){return this._lazyInitEmptyStyle(),this.style.addSource(y,h),this._update(!0)}isSourceLoaded(y){return!!this.style&&this.style._isSourceCacheLoaded(y)}areTilesLoaded(){const y=this.style&&this.style._sourceCaches;for(const h in y){const p=y[h]._tiles;for(const b in p){const w=p[b];if(w.state!=="loaded"&&w.state!=="errored")return!1}}return!0}addSourceType(y,h,p){this._lazyInitEmptyStyle(),this.style.addSourceType(y,h,p)}removeSource(y){return this.style.removeSource(y),this._updateTerrain(),this._update(!0)}getSource(y){return this.style.getSource(y)}addImage(y,h,{pixelRatio:p=1,sdf:b=!1,stretchX:w,stretchY:C,content:P}={}){if(this._lazyInitEmptyStyle(),h instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&h instanceof s.window.ImageBitmap){const{width:k,height:G,data:W}=s.exported.getImageData(h);this.style.addImage(y,{data:new s.RGBAImage({width:k,height:G},W),pixelRatio:p,stretchX:w,stretchY:C,content:P,sdf:b,version:0})}else if(h.width===void 0||h.height===void 0)this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:k,height:G}=h,W=h;this.style.addImage(y,{data:new s.RGBAImage({width:k,height:G},new Uint8Array(W.data)),pixelRatio:p,stretchX:w,stretchY:C,content:P,sdf:b,version:0,userImage:W}),W.onAdd&&W.onAdd(this,y)}}updateImage(y,h){const p=this.style.getImage(y);if(!p)return void this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const b=h instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&h instanceof s.window.ImageBitmap?s.exported.getImageData(h):h,{width:w,height:C}=b;w!==void 0&&C!==void 0?w===p.data.width&&C===p.data.height?(p.data.replace(b.data,!(h instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&h instanceof s.window.ImageBitmap)),this.style.updateImage(y,p)):this.fire(new s.ErrorEvent(new Error(`The width and height of the updated image (${w}, ${C})
                must be that same as the previous version of the image
                (${p.data.width}, ${p.data.height})`))):this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y,h){s.getImage(this._requestManager.transformRequest(y,s.ResourceType.Image),(p,b)=>{h(p,b instanceof s.window.HTMLImageElement?s.exported.getImageData(b):b)})}listImages(){return this.style.listImages()}addLayer(y,h){return this._lazyInitEmptyStyle(),this.style.addLayer(y,h),this._update(!0)}moveLayer(y,h){return this.style.moveLayer(y,h),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}setLayerZoomRange(y,h,p){return this.style.setLayerZoomRange(y,h,p),this._update(!0)}setFilter(y,h,p={}){return this.style.setFilter(y,h,p),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,h,p,b={}){return this.style.setPaintProperty(y,h,p,b),this._update(!0)}getPaintProperty(y,h){return this.style.getPaintProperty(y,h)}setLayoutProperty(y,h,p,b={}){return this.style.setLayoutProperty(y,h,p,b),this._update(!0)}getLayoutProperty(y,h){return this.style.getLayoutProperty(y,h)}setLight(y,h={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,h),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(y){return this._lazyInitEmptyStyle(),!y&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(y),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(y){return this._lazyInitEmptyStyle(),this.style.setFog(y),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(y){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.LngLat.convert(y),this.transform):0}setFeatureState(y,h){return this.style.setFeatureState(y,h),this._update()}removeFeatureState(y,h){return this.style.removeFeatureState(y,h),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}_updateContainerDimensions(){if(!this._container)return;const y=this._container.getBoundingClientRect().width||400,h=this._container.getBoundingClientRect().height||300;let p,b,w,C=this._container;for(;C&&(!b||!w);){const P=s.window.getComputedStyle(C).transform;P&&P!=="none"&&(p=P.match(/matrix.*\((.+)\)/)[1].split(", "),p[0]&&p[0]!=="0"&&p[0]!=="1"&&(b=p[0]),p[3]&&p[3]!=="0"&&p[3]!=="1"&&(w=p[3])),C=C.parentElement}this._containerWidth=b?Math.abs(y/b):y,this._containerHeight=w?Math.abs(h/w):h}_detectMissingCSS(){s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const y=this._container;y.classList.add("mapboxgl-map"),(this._missingCSSCanary=A("div","mapboxgl-canary",y)).style.visibility="hidden",this._detectMissingCSS();const h=this._canvasContainer=A("div","mapboxgl-canvas-container",y);this._interactive&&h.classList.add("mapboxgl-interactive"),this._canvas=A("canvas","mapboxgl-canvas",h),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const p=this._controlContainer=A("div","mapboxgl-control-container",y),b=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{b[w]=A("div",`mapboxgl-ctrl-${w}`,p)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,h){const p=s.exported.devicePixelRatio||1;this._canvas.width=p*Math.ceil(y),this._canvas.height=p*Math.ceil(h),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${h}px`}_addMarker(y){this._markers.push(y)}_removeMarker(y){const h=this._markers.indexOf(y);h!==-1&&this._markers.splice(h,1)}_addPopup(y){this._popups.push(y)}_removePopup(y){const h=this._popups.indexOf(y);h!==-1&&this._popups.splice(h,1)}_setupPainter(){const y=s.extend({},g.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),h=this._useWebGL2&&this._canvas.getContext("webgl2",y),p=h||this._canvas.getContext("webgl",y)||this._canvas.getContext("experimental-webgl",y);p?(this._useWebGL2&&!h&&s.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),s.storeAuthState(p,!0),this.painter=new cu(p,this.transform,!!h),this.on("data",b=>{b.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),s.exported$1.testSupport(p)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(y){y.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:y}))}_contextRestored(y){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:y}))}_onMapScroll(y){if(y.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_requestDomTask(y){!this.loaded()||this.loaded()&&!this.isMoving()?y():this._domRenderTaskQueue.add(y)}_render(y){let h;const p=this.painter.context.extTimerQuery,b=s.exported.now();if(this.listens("gpu-timing-frame")&&(h=p.createQueryEXT(),p.beginQueryEXT(p.TIME_ELAPSED_EXT,h)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],s.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],s.window.performance.now())),this._renderTaskQueue.run(y),this._domRenderTaskQueue.run(y),this._removed)return;this._updateProjectionTransition();const w=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const k=this.transform.zoom,G=this.transform.pitch,W=s.exported.now(),X=new s.EvaluationParameters(k,{now:W,fadeDuration:w,pitch:G,transition:this.style.getTransition()});this.style.update(X)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let C=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),C=this._updateAverageElevation(b),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):C=this._updateAverageElevation(b),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,w,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:w,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),h){const k=s.exported.now()-b;p.endQueryEXT(p.TIME_ELAPSED_EXT,h),setTimeout(()=>{const G=p.getQueryObjectEXT(h,p.QUERY_RESULT_EXT)/1e6;p.deleteQueryEXT(h),this.fire(new s.Event("gpu-timing-frame",{cpuTime:k,gpuTime:G})),s.window.performance.mark("frame-gpu",{startTime:b,detail:{gpuTime:G}})},50)}if(this.listens("gpu-timing-layer")){const k=this.painter.collectGpuTimers();setTimeout(()=>{const G=this.painter.queryGpuTimers(k);this.fire(new s.Event("gpu-timing-layer",{layerTimes:G}))},50)}if(this.listens("gpu-timing-deferred-render")){const k=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const G=this.painter.queryGpuTimeDeferredRender(k);this.fire(new s.Event("gpu-timing-deferred-render",{gpuTime:G}))},50)}const P=this._sourcesDirty||this._styleDirty||this._placementDirty||C;if(P||this._repaint)this.triggerRepaint();else{const k=!this.isMoving()&&this.loaded();if(k&&(C=this._updateAverageElevation(b,!0)),C)this.triggerRepaint();else if(this._triggerFrame(!1),k&&(this.fire(new s.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const G=this._calculateSpeedIndex();this.fire(new s.Event("speedindexcompleted",{speedIndex:G})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||P||(this._fullyLoaded=!0,s.LivePerformanceUtils.mark(s.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&s.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(y){for(const h of this._markers)y&&!this.getRenderWorldCopies()&&(h._lngLat=h._lngLat.wrap()),h._update();for(const h of this._popups)!y||this.getRenderWorldCopies()||h._trackPointer||(h._lngLat=h._lngLat.wrap()),h._update()}_updateAverageElevation(y,h=!1){const p=b=>(this.transform.averageElevation=b,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&p(0);if((h||y-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(y)){const b=this.transform.averageElevation;let w=this.transform.sampleAverageElevation(),C=!1;this.transform.elevation&&(C=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(w)?w=0:this._averageElevationLastSampledAt=y;const P=Math.abs(b-w);if(P>1){if(this._isInitialLoad||C)return this._averageElevation.jumpTo(w),p(w);this._averageElevation.easeTo(w,y,300)}else if(P>1e-4)return this._averageElevation.jumpTo(w),p(w)}return!!this._averageElevation.isEasing(y)&&p(this._averageElevation.getValue(y))}_authenticate(){s.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,y=>{if(y&&(y.message===s.AUTH_ERR_MSG||y.status===401)){const h=this.painter.context.gl;s.storeAuthState(h,!1),this._logoControl instanceof Dg&&this._logoControl._updateLogo(),h&&h.clear(h.DEPTH_BUFFER_BIT|h.COLOR_BUFFER_BIT|h.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),s.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const y=this._isDragging();this.painter.updateTerrain(this.style,y)}_calculateSpeedIndex(){const y=this.painter.canvasCopy(),h=this.painter.getCanvasCopiesAndTimestamps();h.timeStamps.push(performance.now());const p=this.painter.context.gl,b=p.createFramebuffer();function w(C){p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,C,0);const P=new Uint8Array(p.drawingBufferWidth*p.drawingBufferHeight*4);return p.readPixels(0,0,p.drawingBufferWidth,p.drawingBufferHeight,p.RGBA,p.UNSIGNED_BYTE,P),P}return p.bindFramebuffer(p.FRAMEBUFFER,b),this._canvasPixelComparison(w(y),h.canvasCopies.map(w),h.timeStamps)}_canvasPixelComparison(y,h,p){let b=p[1]-p[0];const w=y.length/4;for(let C=0;C<h.length;C++){const P=h[C];let k=0;for(let G=0;G<P.length;G+=4)P[G]===y[G]&&P[G+1]===y[G+1]&&P[G+2]===y[G+2]&&P[G+3]===y[G+3]&&(k+=1);b+=(p[C+2]-p[C+1])*(1-k/w)}return b}remove(){this._hash&&this._hash.remove();for(const h of this._controls)h.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),s.window!==void 0&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1),s.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const y=this.painter.context.gl.getExtension("WEBGL_lose_context");y&&y.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),s.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new s.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(y){this._renderNextFrame=this._renderNextFrame||y,this.style&&!this._frame&&(this._frame=s.exported.frame(h=>{const p=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,p&&this._render(h)}))}_preloadTiles(y){const h=this.style?Object.values(this.style._sourceCaches):[];return s.asyncAll(h,(p,b)=>p._preloadTiles(y,b),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(y){this._trackResize&&this.resize({originalEvent:y})._update()}_onVisibilityChange(){s.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(y){this._showTerrainWireframe!==y&&(this._showTerrainWireframe=y,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(y){this._speedIndexTiming!==y&&(this._speedIndexTiming=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(y){this._showTileAABBs!==y&&(this._showTileAABBs=y,y&&this._update())}_setCacheLimits(y,h){s.setCacheLimits(y,h)}get version(){return s.version}},NavigationControl:class{constructor(y){this.options=s.extend({},Am,y),this._container=A("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",h=>h.preventDefault()),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",h=>{this._map&&this._map.zoomIn({},{originalEvent:h})}),A("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",h=>{this._map&&this._map.zoomOut({},{originalEvent:h})}),A("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",h=>{const p=this._map;p&&(this.options.visualizePitch?p.resetNorthPitch({},{originalEvent:h}):p.resetNorth({},{originalEvent:h}))}),this._compassIcon=A("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const y=this._map;if(!y)return;const h=y.getZoom(),p=h===y.getMaxZoom(),b=h===y.getMinZoom();this._zoomInButton.disabled=p,this._zoomOutButton.disabled=b,this._zoomInButton.setAttribute("aria-disabled",p.toString()),this._zoomOutButton.setAttribute("aria-disabled",b.toString())}_rotateCompassArrow(){const y=this._map;if(!y)return;const h=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(y.transform.pitch*(Math.PI/180)),.5)}) rotateX(${y.transform.pitch}deg) rotateZ(${y.transform.angle*(180/Math.PI)}deg)`:`rotate(${y.transform.angle*(180/Math.PI)}deg)`;y._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=h)})}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),y.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&y.on("pitch",this._rotateCompassArrow),y.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ng(y,this._compass,this.options.visualizePitch)),this._container}onRemove(){const y=this._map;y&&(this._container.remove(),this.options.showZoom&&y.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&y.off("pitch",this._rotateCompassArrow),y.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(y,h){const p=A("button",y,this._container);return p.type="button",p.addEventListener("click",h),p}_setButtonTitle(y,h){if(!this._map)return;const p=this._map._getUIString(`NavigationControl.${h}`);y.setAttribute("aria-label",p),y.firstElementChild&&y.firstElementChild.setAttribute("title",p)}},GeolocateControl:class extends s.Evented{constructor(y){super(),this.options=s.extend({geolocation:s.window.navigator.geolocation},ay,y),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=hu(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(y){return this._map=y,this._container=A("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(y){const h=(p=!!this.options.geolocation)=>{this._supportsGeolocation=p,y(p)};this._supportsGeolocation!==void 0?y(this._supportsGeolocation):s.window.navigator.permissions!==void 0?s.window.navigator.permissions.query({name:"geolocation"}).then(p=>h(p.state!=="denied")).catch(()=>h()):h()}_isOutOfMapMaxBounds(y){const h=this._map.getMaxBounds(),p=y.coords;return!!h&&(p.longitude<h.getWest()||p.longitude>h.getEast()||p.latitude<h.getSouth()||p.latitude>h.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(y){if(this._map){if(this._isOutOfMapMaxBounds(y))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",y)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=y,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(y),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(y),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",y)),this._finish()}}_updateCamera(y){const h=new s.LngLat(y.coords.longitude,y.coords.latitude),p=y.coords.accuracy,b=this._map.getBearing(),w=s.extend({bearing:b},this.options.fitBoundsOptions);this._map.fitBounds(h.toBounds(p),w,{geolocateSource:!0})}_updateMarker(y){if(y){const h=new s.LngLat(y.coords.longitude,y.coords.latitude);this._accuracyCircleMarker.setLngLat(h).addTo(this._map),this._userLocationDotMarker.setLngLat(h).addTo(this._map),this._accuracy=y.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const y=this._map.transform,h=s.mercatorZfromAltitude(1,y._center.lat)*y.worldSize,p=Math.ceil(2*this._accuracy*h);this._circleElement.style.width=`${p}px`,this._circleElement.style.height=`${p}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(y){if(this._map){if(this.options.trackUserLocation)if(y.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(y.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",y)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(y){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",h=>h.preventDefault()),this._geolocateButton=A("button","mapboxgl-ctrl-geolocate",this._container),A("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",y===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h)}else{const h=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=A("div","mapboxgl-user-location"),this._dotElement.appendChild(A("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(A("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Cm({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=A("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Cm({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",h=>{h.geolocateSource||this._watchState!=="ACTIVE_LOCK"||h.originalEvent&&h.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.Event("trackuserlocationend")))})}}_onDeviceOrientation(y){this._userLocationDotMarker&&(y.webkitCompassHeading?this._heading=y.webkitCompassHeading:y.absolute===!0&&(this._heading=-1*y.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(y={maximumAge:6e5,timeout:0},this._noTimeout=!0):(y=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,y),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const y=()=>{s.window.addEventListener("ondeviceorientationabsolute"in s.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};s.window.DeviceMotionEvent!==void 0&&typeof s.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(h=>{h==="granted"&&y()}).catch(console.error):y()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),s.window.removeEventListener("deviceorientation",this._onDeviceOrientation),s.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Pg,ScaleControl:class{constructor(y){this.options=s.extend({},ly,y),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=Mm.bind(this)),s.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const y=this.options.maxWidth||100,h=this._map,p=h._containerHeight/2,b=h._containerWidth/2-y/2,w=h.unproject([b,p]),C=h.unproject([b+y,p]),P=w.distanceTo(C);if(this.options.unit==="imperial"){const k=3.2808*P;k>5280?this._setScale(y,k/5280,"mile"):this._setScale(y,k,"foot")}else this.options.unit==="nautical"?this._setScale(y,P/1852,"nautical-mile"):P>=1e3?this._setScale(y,P/1e3,"kilometer"):this._setScale(y,P,"meter")}_setScale(y,h,p){const b=ef(h),w=b/h;this._map._requestDomTask(()=>{this._container.style.width=y*w+"px",this._container.innerHTML=p!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:p}).format(b):`${b}&nbsp;nm`})}onAdd(y){return this._map=y,this._language=y.getLanguage(),this._container=A("div","mapboxgl-ctrl mapboxgl-ctrl-scale",y.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(y){this._language=y,this._update()}setUnit(y){this.options.unit=y,this._update()}},FullscreenControl:class{constructor(y){this._fullscreen=!1,y&&y.container&&(y.container instanceof s.window.HTMLElement?this._container=y.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in s.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=A("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!s.window.document.fullscreenEnabled&&!s.window.document.webkitFullscreenEnabled)}_setupUI(){const y=this._fullscreenButton=A("button","mapboxgl-ctrl-fullscreen",this._controlContainer);A("span","mapboxgl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",y)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(s.window.document.fullscreenElement||s.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.Evented{constructor(y){super(),this.options=s.extend(Object.create(fu),y),s.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(y&&y.className?y.className.trim().split(/\s+/):[])}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&y.on("preclick",this._onClose),this.options.closeOnMove&&y.on("move",this._onClose),y.on("remove",this.remove),this._update(),y._addPopup(this),this._focusFirstElement(),this._trackPointer?(y.on("mousemove",this._onMouseEvent),y.on("mouseup",this._onMouseEvent),y._canvasContainer.classList.add("mapboxgl-track-pointer")):y.on("move",this._update),this.fire(new s.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const y=this._map;return y&&(y.off("move",this._update),y.off("move",this._onClose),y.off("preclick",this._onClose),y.off("click",this._onClose),y.off("remove",this.remove),y.off("mousemove",this._onMouseEvent),y.off("mouseup",this._onMouseEvent),y.off("drag",this._onMouseEvent),y._canvasContainer&&y._canvasContainer.classList.remove("mapboxgl-track-pointer"),y._removePopup(this),this._map=void 0),this.fire(new s.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(y){this._lngLat=s.LngLat.convert(y),this._pos=null,this._trackPointer=!1,this._update();const h=this._map;return h&&(h.on("move",this._update),h.off("mousemove",this._onMouseEvent),h._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const y=this._map;return y&&(y.off("move",this._update),y.on("mousemove",this._onMouseEvent),y.on("drag",this._onMouseEvent),y._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(s.window.document.createTextNode(y))}setHTML(y){const h=s.window.document.createDocumentFragment(),p=s.window.document.createElement("body");let b;for(p.innerHTML=y;b=p.firstChild,b;)h.appendChild(b);return this.setDOMContent(h)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){let h=this._content;if(h)for(;h.hasChildNodes();)h.firstChild&&h.removeChild(h.firstChild);else h=this._content=A("div","mapboxgl-popup-content",this._container||void 0);if(h.appendChild(y),this.options.closeButton){const p=this._closeButton=A("button","mapboxgl-popup-close-button",h);p.type="button",p.setAttribute("aria-label","Close popup"),p.setAttribute("aria-hidden","true"),p.innerHTML="&#215;",p.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(y){return this._classList.add(y),this._updateClassList(),this}removeClassName(y){return this._classList.delete(y),this._updateClassList(),this}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){let h;return this._classList.delete(y)?h=!1:(this._classList.add(y),h=!0),this._updateClassList(),h}_onMouseEvent(y){this._update(y.point)}_getAnchor(y){if(this.options.anchor)return this.options.anchor;const h=this._map,p=this._container,b=this._pos;if(!h||!p||!b)return"bottom";const w=p.offsetWidth,C=p.offsetHeight,P=b.x<w/2,k=b.x>h.transform.width-w/2;if(b.y+y<C)return P?"top-left":k?"top-right":"top";if(b.y>h.transform.height-C){if(P)return"bottom-left";if(k)return"bottom-right"}return P?"left":k?"right":"bottom"}_updateClassList(){const y=this._container;if(!y)return;const h=[...this._classList];h.push("mapboxgl-popup"),this._anchor&&h.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&h.push("mapboxgl-popup-track-pointer"),y.className=h.join(" ")}_update(y){const h=this._map,p=this._content;if(!h||!this._lngLat&&!this._trackPointer||!p)return;let b=this._container;if(b||(b=this._container=A("div","mapboxgl-popup",h.getContainer()),this._tip=A("div","mapboxgl-popup-tip",b),b.appendChild(p)),this.options.maxWidth&&b.style.maxWidth!==this.options.maxWidth&&(b.style.maxWidth=this.options.maxWidth),h.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Sc(this._lngLat,this._pos,h.transform)),!this._trackPointer||y){const w=this._pos=this._trackPointer&&y?y:h.project(this._lngLat),C=Og(this.options.offset),P=this._anchor=this._getAnchor(C.y),k=Og(this.options.offset,P),G=w.add(k).round();h._requestDomTask(()=>{this._container&&P&&(this._container.style.transform=`${zd[P]} translate(${G.x}px,${G.y}px)`)})}if(!this._marker&&h._showingGlobe()){const w=s.isLngLatBehindGlobe(h.transform,this._lngLat)?0:1;this._setOpacity(w)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(iy);y&&y.focus()}_onClose(){this.remove()}_setOpacity(y){this._container&&(this._container.style.opacity=`${y}`),this._content&&(this._content.style.pointerEvents=y?"auto":"none")}},Marker:Cm,Style:bs,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.pointGeometry,MercatorCoordinate:s.MercatorCoordinate,FreeCameraOptions:Ec,Evented:s.Evented,config:s.config,prewarm:function(){Ye().acquire(On)},clearPrewarmedResources:function(){const y=ei;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(On),ei=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(y){s.config.ACCESS_TOKEN=y},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(y){s.config.API_URL=y},get workerCount(){return ii.workerCount},set workerCount(y){ii.workerCount=y},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(y){s.config.MAX_PARALLEL_IMAGE_REQUESTS=y},clearStorage(y){s.clearTileCache(y)},workerUrl:"",workerClass:null,setNow:s.exported.setNow,restoreNow:s.exported.restoreNow};return tf});var l=r;return l})})(cL);var BP=cL.exports;const wC=ES(BP);var fL={exports:{}};(function(n,e){(function(t,i){n.exports=i()})(ld,function(){var t=function(O,j){var ue={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},Fe={on:function(Qe,st,_n){if(ue[Qe]===void 0)throw new Error("Invalid event type: "+Qe);ue[Qe].push({selector:st,fn:_n})},render:function(Qe){j.store.featureChanged(Qe)}},et=function(Qe,st){for(var _n=ue[Qe],mn=_n.length;mn--;){var Wn=_n[mn];if(Wn.selector(st)){Wn.fn.call(Fe,st)||j.store.render(),j.ui.updateMapClasses();break}}};return O.start.call(Fe),{render:O.render,stop:function(){O.stop&&O.stop()},trash:function(){O.trash&&(O.trash(),j.store.render())},combineFeatures:function(){O.combineFeatures&&O.combineFeatures()},uncombineFeatures:function(){O.uncombineFeatures&&O.uncombineFeatures()},drag:function(Qe){et("drag",Qe)},click:function(Qe){et("click",Qe)},mousemove:function(Qe){et("mousemove",Qe)},mousedown:function(Qe){et("mousedown",Qe)},mouseup:function(Qe){et("mouseup",Qe)},mouseout:function(Qe){et("mouseout",Qe)},keydown:function(Qe){et("keydown",Qe)},keyup:function(Qe){et("keyup",Qe)},touchstart:function(Qe){et("touchstart",Qe)},touchmove:function(Qe){et("touchmove",Qe)},touchend:function(Qe){et("touchend",Qe)},tap:function(Qe){et("tap",Qe)}}};function i(O){if(O.__esModule)return O;var j=O.default;if(typeof j=="function"){var ue=function Fe(){if(this instanceof Fe){var et=[null];et.push.apply(et,arguments);var Qe=Function.bind.apply(j,et);return new Qe}return j.apply(this,arguments)};ue.prototype=j.prototype}else ue={};return Object.defineProperty(ue,"__esModule",{value:!0}),Object.keys(O).forEach(function(Fe){var et=Object.getOwnPropertyDescriptor(O,Fe);Object.defineProperty(ue,Fe,et.get?et:{enumerable:!0,get:function(){return O[Fe]}})}),ue}var r={},a={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:63567523142e-4},l=a;function s(O){var j=0;if(O&&O.length>0){j+=Math.abs(d(O[0]));for(var ue=1;ue<O.length;ue++)j-=Math.abs(d(O[ue]))}return j}function d(O){var j,ue,Fe,et,Qe,st,_n=0,mn=O.length;if(mn>2){for(st=0;st<mn;st++)st===mn-2?(Fe=mn-2,et=mn-1,Qe=0):st===mn-1?(Fe=mn-1,et=0,Qe=1):(Fe=st,et=st+1,Qe=st+2),j=O[Fe],ue=O[et],_n+=(g(O[Qe][0])-g(j[0]))*Math.sin(g(ue[1]));_n=_n*l.RADIUS*l.RADIUS/2}return _n}function g(O){return O*Math.PI/180}r.geometry=function O(j){var ue,Fe=0;switch(j.type){case"Polygon":return s(j.coordinates);case"MultiPolygon":for(ue=0;ue<j.coordinates.length;ue++)Fe+=s(j.coordinates[ue]);return Fe;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(ue=0;ue<j.geometries.length;ue++)Fe+=O(j.geometries[ue]);return Fe}},r.ring=d;var x={CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},I={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},A={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},L={POLYGON:"polygon",LINE:"line_string",POINT:"point"},N={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},B={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},F={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},z={MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},V={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},Y={ACTIVE:"true",INACTIVE:"false"},Q=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],J=-85,he=Object.freeze({__proto__:null,classes:x,sources:I,cursors:A,types:L,geojsonTypes:N,modes:B,events:F,updateActions:z,meta:V,activeStates:Y,interactions:Q,LAT_MIN:-90,LAT_RENDERED_MIN:J,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270}),ee={Point:0,LineString:1,MultiLineString:1,Polygon:2};function ae(O,j){var ue=ee[O.geometry.type]-ee[j.geometry.type];return ue===0&&O.geometry.type===N.POLYGON?O.area-j.area:ue}function De(O){return O.map(function(j){return j.geometry.type===N.POLYGON&&(j.area=r.geometry({type:N.FEATURE,property:{},geometry:j.geometry})),j}).sort(ae).map(function(j){return delete j.area,j})}function fe(O,j){return j===void 0&&(j=0),[[O.point.x-j,O.point.y-j],[O.point.x+j,O.point.y+j]]}function le(O){if(this._items={},this._nums={},this._length=O?O.length:0,O)for(var j=0,ue=O.length;j<ue;j++)this.add(O[j]),O[j]!==void 0&&(typeof O[j]=="string"?this._items[O[j]]=j:this._nums[O[j]]=j)}le.prototype.add=function(O){return this.has(O)||(this._length++,typeof O=="string"?this._items[O]=this._length:this._nums[O]=this._length),this},le.prototype.delete=function(O){return this.has(O)===!1||(this._length--,delete this._items[O],delete this._nums[O]),this},le.prototype.has=function(O){return(typeof O=="string"||typeof O=="number")&&(this._items[O]!==void 0||this._nums[O]!==void 0)},le.prototype.values=function(){var O=this,j=[];return Object.keys(this._items).forEach(function(ue){j.push({k:ue,v:O._items[ue]})}),Object.keys(this._nums).forEach(function(ue){j.push({k:JSON.parse(ue),v:O._nums[ue]})}),j.sort(function(ue,Fe){return ue.v-Fe.v}).map(function(ue){return ue.k})},le.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var Be=[V.FEATURE,V.MIDPOINT,V.VERTEX],Pe={click:function(O,j,ue){return Ce(O,j,ue,ue.options.clickBuffer)},touch:function(O,j,ue){return Ce(O,j,ue,ue.options.touchBuffer)}};function Ce(O,j,ue,Fe){if(ue.map===null)return[];var et=O?fe(O,Fe):j,Qe={};ue.options.styles&&(Qe.layers=ue.options.styles.map(function(Wn){return Wn.id}));var st=ue.map.queryRenderedFeatures(et,Qe).filter(function(Wn){return Be.indexOf(Wn.properties.meta)!==-1}),_n=new le,mn=[];return st.forEach(function(Wn){var Pn=Wn.properties.id;_n.has(Pn)||(_n.add(Pn),mn.push(Wn))}),De(mn)}function it(O,j){var ue=Pe.click(O,null,j),Fe={mouse:A.NONE};return ue[0]&&(Fe.mouse=ue[0].properties.active===Y.ACTIVE?A.MOVE:A.POINTER,Fe.feature=ue[0].properties.meta),j.events.currentModeName().indexOf("draw")!==-1&&(Fe.mouse=A.ADD),j.ui.queueMapClasses(Fe),j.ui.updateMapClasses(),ue[0]}function Et(O,j){var ue=O.x-j.x,Fe=O.y-j.y;return Math.sqrt(ue*ue+Fe*Fe)}function Ue(O,j,ue){ue===void 0&&(ue={});var Fe=ue.fineTolerance!=null?ue.fineTolerance:4,et=ue.grossTolerance!=null?ue.grossTolerance:12,Qe=ue.interval!=null?ue.interval:500;O.point=O.point||j.point,O.time=O.time||j.time;var st=Et(O.point,j.point);return st<Fe||st<et&&j.time-O.time<Qe}function at(O,j,ue){ue===void 0&&(ue={});var Fe=ue.tolerance!=null?ue.tolerance:25,et=ue.interval!=null?ue.interval:250;return O.point=O.point||j.point,O.time=O.time||j.time,Et(O.point,j.point)<Fe&&j.time-O.time<et}var ke={},Dt={get exports(){return ke},set exports(O){ke=O}}.exports=function(O,j){if(j||(j=16),O===void 0&&(O=128),O<=0)return"0";for(var ue=Math.log(Math.pow(2,O))/Math.log(j),Fe=2;ue===1/0;Fe*=2)ue=Math.log(Math.pow(2,O/Fe))/Math.log(j)*Fe;var et=ue-Math.floor(ue),Qe="";for(Fe=0;Fe<Math.floor(ue);Fe++)Qe=Math.floor(Math.random()*j).toString(j)+Qe;if(et){var st=Math.pow(j,et);Qe=Math.floor(Math.random()*st).toString(j)+Qe}var _n=parseInt(Qe,j);return _n!==1/0&&_n>=Math.pow(2,O)?Dt(O,j):Qe};Dt.rack=function(O,j,ue){var Fe=function(Qe){var st=0;do{if(st++>10){if(!ue)throw new Error("too many ID collisions, use more bits");O+=ue}var _n=Dt(O,j)}while(Object.hasOwnProperty.call(et,_n));return et[_n]=Qe,_n},et=Fe.hats={};return Fe.get=function(Qe){return Fe.hats[Qe]},Fe.set=function(Qe,st){return Fe.hats[Qe]=st,Fe},Fe.bits=O||128,Fe.base=j||16,Fe};var fn=function(O,j){this.ctx=O,this.properties=j.properties||{},this.coordinates=j.geometry.coordinates,this.id=j.id||ke(),this.type=j.geometry.type};fn.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},fn.prototype.incomingCoords=function(O){this.setCoordinates(O)},fn.prototype.setCoordinates=function(O){this.coordinates=O,this.changed()},fn.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},fn.prototype.setProperty=function(O,j){this.properties[O]=j},fn.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:N.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},fn.prototype.internal=function(O){var j={id:this.id,meta:V.FEATURE,"meta:type":this.type,active:Y.INACTIVE,mode:O};if(this.ctx.options.userProperties)for(var ue in this.properties)j["user_"+ue]=this.properties[ue];return{type:N.FEATURE,properties:j,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var Cn=function(O,j){fn.call(this,O,j)};(Cn.prototype=Object.create(fn.prototype)).isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"},Cn.prototype.updateCoordinate=function(O,j,ue){this.coordinates=arguments.length===3?[j,ue]:[O,j],this.changed()},Cn.prototype.getCoordinate=function(){return this.getCoordinates()};var Gt=function(O,j){fn.call(this,O,j)};(Gt.prototype=Object.create(fn.prototype)).isValid=function(){return this.coordinates.length>1},Gt.prototype.addCoordinate=function(O,j,ue){this.changed();var Fe=parseInt(O,10);this.coordinates.splice(Fe,0,[j,ue])},Gt.prototype.getCoordinate=function(O){var j=parseInt(O,10);return JSON.parse(JSON.stringify(this.coordinates[j]))},Gt.prototype.removeCoordinate=function(O){this.changed(),this.coordinates.splice(parseInt(O,10),1)},Gt.prototype.updateCoordinate=function(O,j,ue){var Fe=parseInt(O,10);this.coordinates[Fe]=[j,ue],this.changed()};var Mt=function(O,j){fn.call(this,O,j),this.coordinates=this.coordinates.map(function(ue){return ue.slice(0,-1)})};(Mt.prototype=Object.create(fn.prototype)).isValid=function(){return this.coordinates.length!==0&&this.coordinates.every(function(O){return O.length>2})},Mt.prototype.incomingCoords=function(O){this.coordinates=O.map(function(j){return j.slice(0,-1)}),this.changed()},Mt.prototype.setCoordinates=function(O){this.coordinates=O,this.changed()},Mt.prototype.addCoordinate=function(O,j,ue){this.changed();var Fe=O.split(".").map(function(et){return parseInt(et,10)});this.coordinates[Fe[0]].splice(Fe[1],0,[j,ue])},Mt.prototype.removeCoordinate=function(O){this.changed();var j=O.split(".").map(function(Fe){return parseInt(Fe,10)}),ue=this.coordinates[j[0]];ue&&(ue.splice(j[1],1),ue.length<3&&this.coordinates.splice(j[0],1))},Mt.prototype.getCoordinate=function(O){var j=O.split(".").map(function(Fe){return parseInt(Fe,10)}),ue=this.coordinates[j[0]];return JSON.parse(JSON.stringify(ue[j[1]]))},Mt.prototype.getCoordinates=function(){return this.coordinates.map(function(O){return O.concat([O[0]])})},Mt.prototype.updateCoordinate=function(O,j,ue){this.changed();var Fe=O.split("."),et=parseInt(Fe[0],10),Qe=parseInt(Fe[1],10);this.coordinates[et]===void 0&&(this.coordinates[et]=[]),this.coordinates[et][Qe]=[j,ue]};var vt={MultiPoint:Cn,MultiLineString:Gt,MultiPolygon:Mt},xn=function(O,j,ue,Fe,et){var Qe=ue.split("."),st=parseInt(Qe[0],10),_n=Qe[1]?Qe.slice(1).join("."):null;return O[st][j](_n,Fe,et)},En=function(O,j){if(fn.call(this,O,j),delete this.coordinates,this.model=vt[j.geometry.type],this.model===void 0)throw new TypeError(j.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(j.geometry.coordinates)};function _t(O){this.map=O.map,this.drawConfig=JSON.parse(JSON.stringify(O.options||{})),this._ctx=O}(En.prototype=Object.create(fn.prototype))._coordinatesToFeatures=function(O){var j=this,ue=this.model.bind(this);return O.map(function(Fe){return new ue(j.ctx,{id:ke(),type:N.FEATURE,properties:{},geometry:{coordinates:Fe,type:j.type.replace("Multi","")}})})},En.prototype.isValid=function(){return this.features.every(function(O){return O.isValid()})},En.prototype.setCoordinates=function(O){this.features=this._coordinatesToFeatures(O),this.changed()},En.prototype.getCoordinate=function(O){return xn(this.features,"getCoordinate",O)},En.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(function(O){return O.type===N.POLYGON?O.getCoordinates():O.coordinates})))},En.prototype.updateCoordinate=function(O,j,ue){xn(this.features,"updateCoordinate",O,j,ue),this.changed()},En.prototype.addCoordinate=function(O,j,ue){xn(this.features,"addCoordinate",O,j,ue),this.changed()},En.prototype.removeCoordinate=function(O){xn(this.features,"removeCoordinate",O),this.changed()},En.prototype.getFeatures=function(){return this.features},_t.prototype.setSelected=function(O){return this._ctx.store.setSelected(O)},_t.prototype.setSelectedCoordinates=function(O){var j=this;this._ctx.store.setSelectedCoordinates(O),O.reduce(function(ue,Fe){return ue[Fe.feature_id]===void 0&&(ue[Fe.feature_id]=!0,j._ctx.store.get(Fe.feature_id).changed()),ue},{})},_t.prototype.getSelected=function(){return this._ctx.store.getSelected()},_t.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},_t.prototype.isSelected=function(O){return this._ctx.store.isSelected(O)},_t.prototype.getFeature=function(O){return this._ctx.store.get(O)},_t.prototype.select=function(O){return this._ctx.store.select(O)},_t.prototype.deselect=function(O){return this._ctx.store.deselect(O)},_t.prototype.deleteFeature=function(O,j){return j===void 0&&(j={}),this._ctx.store.delete(O,j)},_t.prototype.addFeature=function(O){return this._ctx.store.add(O)},_t.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},_t.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},_t.prototype.setActionableState=function(O){O===void 0&&(O={});var j={trash:O.trash||!1,combineFeatures:O.combineFeatures||!1,uncombineFeatures:O.uncombineFeatures||!1};return this._ctx.events.actionable(j)},_t.prototype.changeMode=function(O,j,ue){return j===void 0&&(j={}),ue===void 0&&(ue={}),this._ctx.events.changeMode(O,j,ue)},_t.prototype.updateUIClasses=function(O){return this._ctx.ui.queueMapClasses(O)},_t.prototype.activateUIButton=function(O){return this._ctx.ui.setActiveButton(O)},_t.prototype.featuresAt=function(O,j,ue){if(ue===void 0&&(ue="click"),ue!=="click"&&ue!=="touch")throw new Error("invalid buffer type");return Pe[ue](O,j,this._ctx)},_t.prototype.newFeature=function(O){var j=O.geometry.type;return j===N.POINT?new Cn(this._ctx,O):j===N.LINE_STRING?new Gt(this._ctx,O):j===N.POLYGON?new Mt(this._ctx,O):new En(this._ctx,O)},_t.prototype.isInstanceOf=function(O,j){if(O===N.POINT)return j instanceof Cn;if(O===N.LINE_STRING)return j instanceof Gt;if(O===N.POLYGON)return j instanceof Mt;if(O==="MultiFeature")return j instanceof En;throw new Error("Unknown feature class: "+O)},_t.prototype.doRender=function(O){return this._ctx.store.featureChanged(O)},_t.prototype.onSetup=function(){},_t.prototype.onDrag=function(){},_t.prototype.onClick=function(){},_t.prototype.onMouseMove=function(){},_t.prototype.onMouseDown=function(){},_t.prototype.onMouseUp=function(){},_t.prototype.onMouseOut=function(){},_t.prototype.onKeyUp=function(){},_t.prototype.onKeyDown=function(){},_t.prototype.onTouchStart=function(){},_t.prototype.onTouchMove=function(){},_t.prototype.onTouchEnd=function(){},_t.prototype.onTap=function(){},_t.prototype.onStop=function(){},_t.prototype.onTrash=function(){},_t.prototype.onCombineFeature=function(){},_t.prototype.onUncombineFeature=function(){},_t.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var kt={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},Ct=Object.keys(kt);function Bt(O){var j=Object.keys(O);return function(ue,Fe){Fe===void 0&&(Fe={});var et={},Qe=j.reduce(function(st,_n){return st[_n]=O[_n],st},new _t(ue));return{start:function(){var st=this;et=Qe.onSetup(Fe),Ct.forEach(function(_n){var mn,Wn=kt[_n],Pn=function(){return!1};O[Wn]&&(Pn=function(){return!0}),st.on(_n,Pn,(mn=Wn,function(Fn){return Qe[mn](et,Fn)}))})},stop:function(){Qe.onStop(et)},trash:function(){Qe.onTrash(et)},combineFeatures:function(){Qe.onCombineFeatures(et)},uncombineFeatures:function(){Qe.onUncombineFeatures(et)},render:function(st,_n){Qe.toDisplayFeatures(et,st,_n)}}}}function Zn(O){return[].concat(O).filter(function(j){return j!==void 0})}function mi(){var O=this;if(!(O.ctx.map&&O.ctx.map.getSource(I.HOT)!==void 0))return mn();var j=O.ctx.events.currentModeName();O.ctx.ui.queueMapClasses({mode:j});var ue=[],Fe=[];O.isDirty?Fe=O.getAllIds():(ue=O.getChangedIds().filter(function(Wn){return O.get(Wn)!==void 0}),Fe=O.sources.hot.filter(function(Wn){return Wn.properties.id&&ue.indexOf(Wn.properties.id)===-1&&O.get(Wn.properties.id)!==void 0}).map(function(Wn){return Wn.properties.id})),O.sources.hot=[];var et=O.sources.cold.length;O.sources.cold=O.isDirty?[]:O.sources.cold.filter(function(Wn){var Pn=Wn.properties.id||Wn.properties.parent;return ue.indexOf(Pn)===-1});var Qe=et!==O.sources.cold.length||Fe.length>0;function st(Wn,Pn){var Fn=O.get(Wn).internal(j);O.ctx.events.currentModeRender(Fn,function(Fi){O.sources[Pn].push(Fi)})}if(ue.forEach(function(Wn){return st(Wn,"hot")}),Fe.forEach(function(Wn){return st(Wn,"cold")}),Qe&&O.ctx.map.getSource(I.COLD).setData({type:N.FEATURE_COLLECTION,features:O.sources.cold}),O.ctx.map.getSource(I.HOT).setData({type:N.FEATURE_COLLECTION,features:O.sources.hot}),O._emitSelectionChange&&(O.ctx.map.fire(F.SELECTION_CHANGE,{features:O.getSelected().map(function(Wn){return Wn.toGeoJSON()}),points:O.getSelectedCoordinates().map(function(Wn){return{type:N.FEATURE,properties:{},geometry:{type:N.POINT,coordinates:Wn.coordinates}}})}),O._emitSelectionChange=!1),O._deletedFeaturesToEmit.length){var _n=O._deletedFeaturesToEmit.map(function(Wn){return Wn.toGeoJSON()});O._deletedFeaturesToEmit=[],O.ctx.map.fire(F.DELETE,{features:_n})}function mn(){O.isDirty=!1,O.clearChangedIds()}mn(),O.ctx.map.fire(F.RENDER,{})}function yn(O){var j,ue=this;this._features={},this._featureIds=new le,this._selectedFeatureIds=new le,this._selectedCoordinates=[],this._changedFeatureIds=new le,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=O,this.sources={hot:[],cold:[]},this.render=function(){j||(j=requestAnimationFrame(function(){j=null,mi.call(ue)}))},this.isDirty=!1}function Pt(O,j){var ue=O._selectedCoordinates.filter(function(Fe){return O._selectedFeatureIds.has(Fe.feature_id)});O._selectedCoordinates.length===ue.length||j.silent||(O._emitSelectionChange=!0),O._selectedCoordinates=ue}yn.prototype.createRenderBatch=function(){var O=this,j=this.render,ue=0;return this.render=function(){ue++},function(){O.render=j,ue>0&&O.render()}},yn.prototype.setDirty=function(){return this.isDirty=!0,this},yn.prototype.featureChanged=function(O){return this._changedFeatureIds.add(O),this},yn.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},yn.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},yn.prototype.getAllIds=function(){return this._featureIds.values()},yn.prototype.add=function(O){return this.featureChanged(O.id),this._features[O.id]=O,this._featureIds.add(O.id),this},yn.prototype.delete=function(O,j){var ue=this;return j===void 0&&(j={}),Zn(O).forEach(function(Fe){ue._featureIds.has(Fe)&&(ue._featureIds.delete(Fe),ue._selectedFeatureIds.delete(Fe),j.silent||ue._deletedFeaturesToEmit.indexOf(ue._features[Fe])===-1&&ue._deletedFeaturesToEmit.push(ue._features[Fe]),delete ue._features[Fe],ue.isDirty=!0)}),Pt(this,j),this},yn.prototype.get=function(O){return this._features[O]},yn.prototype.getAll=function(){var O=this;return Object.keys(this._features).map(function(j){return O._features[j]})},yn.prototype.select=function(O,j){var ue=this;return j===void 0&&(j={}),Zn(O).forEach(function(Fe){ue._selectedFeatureIds.has(Fe)||(ue._selectedFeatureIds.add(Fe),ue._changedFeatureIds.add(Fe),j.silent||(ue._emitSelectionChange=!0))}),this},yn.prototype.deselect=function(O,j){var ue=this;return j===void 0&&(j={}),Zn(O).forEach(function(Fe){ue._selectedFeatureIds.has(Fe)&&(ue._selectedFeatureIds.delete(Fe),ue._changedFeatureIds.add(Fe),j.silent||(ue._emitSelectionChange=!0))}),Pt(this,j),this},yn.prototype.clearSelected=function(O){return O===void 0&&(O={}),this.deselect(this._selectedFeatureIds.values(),{silent:O.silent}),this},yn.prototype.setSelected=function(O,j){var ue=this;return j===void 0&&(j={}),O=Zn(O),this.deselect(this._selectedFeatureIds.values().filter(function(Fe){return O.indexOf(Fe)===-1}),{silent:j.silent}),this.select(O.filter(function(Fe){return!ue._selectedFeatureIds.has(Fe)}),{silent:j.silent}),this},yn.prototype.setSelectedCoordinates=function(O){return this._selectedCoordinates=O,this._emitSelectionChange=!0,this},yn.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},yn.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},yn.prototype.getSelected=function(){var O=this;return this._selectedFeatureIds.values().map(function(j){return O.get(j)})},yn.prototype.getSelectedCoordinates=function(){var O=this;return this._selectedCoordinates.map(function(j){return{coordinates:O.get(j.feature_id).getCoordinate(j.coord_path)}})},yn.prototype.isSelected=function(O){return this._selectedFeatureIds.has(O)},yn.prototype.setFeatureProperty=function(O,j,ue){this.get(O).setProperty(j,ue),this.featureChanged(O)},yn.prototype.storeMapConfig=function(){var O=this;Q.forEach(function(j){O.ctx.map[j]&&(O._mapInitialConfig[j]=O.ctx.map[j].isEnabled())})},yn.prototype.restoreMapConfig=function(){var O=this;Object.keys(this._mapInitialConfig).forEach(function(j){O._mapInitialConfig[j]?O.ctx.map[j].enable():O.ctx.map[j].disable()})},yn.prototype.getInitialConfigValue=function(O){return this._mapInitialConfig[O]===void 0||this._mapInitialConfig[O]};var Yn=function(){for(var O=arguments,j={},ue=0;ue<arguments.length;ue++){var Fe=O[ue];for(var et in Fe)si.call(Fe,et)&&(j[et]=Fe[et])}return j},si=Object.prototype.hasOwnProperty,Dr=["mode","feature","mouse"];function Ur(O){var j=null,ue=null,Fe={onRemove:function(){return O.map.off("load",Fe.connect),clearInterval(ue),Fe.removeLayers(),O.store.restoreMapConfig(),O.ui.removeButtons(),O.events.removeEventListeners(),O.ui.clearMapClasses(),O.map=null,O.container=null,O.store=null,j&&j.parentNode&&j.parentNode.removeChild(j),j=null,this},connect:function(){O.map.off("load",Fe.connect),clearInterval(ue),Fe.addLayers(),O.store.storeMapConfig(),O.events.addEventListeners()},onAdd:function(et){var Qe=et.fire;return et.fire=function(st,_n){var mn=arguments;return Qe.length===1&&arguments.length!==1&&(mn=[Yn({},{type:st},_n)]),Qe.apply(et,mn)},O.map=et,O.events=function(st){var _n=Object.keys(st.options.modes).reduce(function(nn,Kn){return nn[Kn]=Bt(st.options.modes[Kn]),nn},{}),mn={},Wn={},Pn={},Fn=null,Fi=null;Pn.drag=function(nn,Kn){Kn({point:nn.point,time:new Date().getTime()})?(st.ui.queueMapClasses({mouse:A.DRAG}),Fi.drag(nn)):nn.originalEvent.stopPropagation()},Pn.mousedrag=function(nn){Pn.drag(nn,function(Kn){return!Ue(mn,Kn)})},Pn.touchdrag=function(nn){Pn.drag(nn,function(Kn){return!at(Wn,Kn)})},Pn.mousemove=function(nn){if((nn.originalEvent.buttons!==void 0?nn.originalEvent.buttons:nn.originalEvent.which)===1)return Pn.mousedrag(nn);var Kn=it(nn,st);nn.featureTarget=Kn,Fi.mousemove(nn)},Pn.mousedown=function(nn){mn={time:new Date().getTime(),point:nn.point};var Kn=it(nn,st);nn.featureTarget=Kn,Fi.mousedown(nn)},Pn.mouseup=function(nn){var Kn=it(nn,st);nn.featureTarget=Kn,Ue(mn,{point:nn.point,time:new Date().getTime()})?Fi.click(nn):Fi.mouseup(nn)},Pn.mouseout=function(nn){Fi.mouseout(nn)},Pn.touchstart=function(nn){if(nn.originalEvent.preventDefault(),st.options.touchEnabled){Wn={time:new Date().getTime(),point:nn.point};var Kn=Pe.touch(nn,null,st)[0];nn.featureTarget=Kn,Fi.touchstart(nn)}},Pn.touchmove=function(nn){if(nn.originalEvent.preventDefault(),st.options.touchEnabled)return Fi.touchmove(nn),Pn.touchdrag(nn)},Pn.touchend=function(nn){if(nn.originalEvent.preventDefault(),st.options.touchEnabled){var Kn=Pe.touch(nn,null,st)[0];nn.featureTarget=Kn,at(Wn,{time:new Date().getTime(),point:nn.point})?Fi.tap(nn):Fi.touchend(nn)}};var vs=function(nn){return!(nn===8||nn===46||nn>=48&&nn<=57)};function zi(nn,Kn,qi){qi===void 0&&(qi={}),Fi.stop();var oo=_n[nn];if(oo===void 0)throw new Error(nn+" is not valid");Fn=nn;var Fs=oo(st,Kn);Fi=t(Fs,st),qi.silent||st.map.fire(F.MODE_CHANGE,{mode:nn}),st.store.setDirty(),st.store.render()}Pn.keydown=function(nn){(nn.srcElement||nn.target).classList[0]==="mapboxgl-canvas"&&(nn.keyCode!==8&&nn.keyCode!==46||!st.options.controls.trash?vs(nn.keyCode)?Fi.keydown(nn):nn.keyCode===49&&st.options.controls.point?zi(B.DRAW_POINT):nn.keyCode===50&&st.options.controls.line_string?zi(B.DRAW_LINE_STRING):nn.keyCode===51&&st.options.controls.polygon&&zi(B.DRAW_POLYGON):(nn.preventDefault(),Fi.trash()))},Pn.keyup=function(nn){vs(nn.keyCode)&&Fi.keyup(nn)},Pn.zoomend=function(){st.store.changeZoom()},Pn.data=function(nn){if(nn.dataType==="style"){var Kn=st.setup,qi=st.map,oo=st.options,Fs=st.store;oo.styles.some(function(Zo){return qi.getLayer(Zo.id)})||(Kn.addLayers(),Fs.setDirty(),Fs.render())}};var Cs={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){Fn=st.options.defaultMode,Fi=t(_n[Fn](st),st)},changeMode:zi,actionable:function(nn){var Kn=!1;Object.keys(nn).forEach(function(qi){if(Cs[qi]===void 0)throw new Error("Invalid action type");Cs[qi]!==nn[qi]&&(Kn=!0),Cs[qi]=nn[qi]}),Kn&&st.map.fire(F.ACTIONABLE,{actions:Cs})},currentModeName:function(){return Fn},currentModeRender:function(nn,Kn){return Fi.render(nn,Kn)},fire:function(nn,Kn){Pn[nn]&&Pn[nn](Kn)},addEventListeners:function(){st.map.on("mousemove",Pn.mousemove),st.map.on("mousedown",Pn.mousedown),st.map.on("mouseup",Pn.mouseup),st.map.on("data",Pn.data),st.map.on("touchmove",Pn.touchmove),st.map.on("touchstart",Pn.touchstart),st.map.on("touchend",Pn.touchend),st.container.addEventListener("mouseout",Pn.mouseout),st.options.keybindings&&(st.container.addEventListener("keydown",Pn.keydown),st.container.addEventListener("keyup",Pn.keyup))},removeEventListeners:function(){st.map.off("mousemove",Pn.mousemove),st.map.off("mousedown",Pn.mousedown),st.map.off("mouseup",Pn.mouseup),st.map.off("data",Pn.data),st.map.off("touchmove",Pn.touchmove),st.map.off("touchstart",Pn.touchstart),st.map.off("touchend",Pn.touchend),st.container.removeEventListener("mouseout",Pn.mouseout),st.options.keybindings&&(st.container.removeEventListener("keydown",Pn.keydown),st.container.removeEventListener("keyup",Pn.keyup))},trash:function(nn){Fi.trash(nn)},combineFeatures:function(){Fi.combineFeatures()},uncombineFeatures:function(){Fi.uncombineFeatures()},getMode:function(){return Fn}}}(O),O.ui=function(st){var _n={},mn=null,Wn={mode:null,feature:null,mouse:null},Pn={mode:null,feature:null,mouse:null};function Fn(nn){Pn=Yn(Pn,nn)}function Fi(){var nn,Kn;if(st.container){var qi=[],oo=[];Dr.forEach(function(Fs){Pn[Fs]!==Wn[Fs]&&(qi.push(Fs+"-"+Wn[Fs]),Pn[Fs]!==null&&oo.push(Fs+"-"+Pn[Fs]))}),qi.length>0&&(nn=st.container.classList).remove.apply(nn,qi),oo.length>0&&(Kn=st.container.classList).add.apply(Kn,oo),Wn=Yn(Wn,Pn)}}function vs(nn,Kn){Kn===void 0&&(Kn={});var qi=document.createElement("button");return qi.className=x.CONTROL_BUTTON+" "+Kn.className,qi.setAttribute("title",Kn.title),Kn.container.appendChild(qi),qi.addEventListener("click",function(oo){if(oo.preventDefault(),oo.stopPropagation(),oo.target===mn)return zi(),void Kn.onDeactivate();Cs(nn),Kn.onActivate()},!0),qi}function zi(){mn&&(mn.classList.remove(x.ACTIVE_BUTTON),mn=null)}function Cs(nn){zi();var Kn=_n[nn];Kn&&Kn&&nn!=="trash"&&(Kn.classList.add(x.ACTIVE_BUTTON),mn=Kn)}return{setActiveButton:Cs,queueMapClasses:Fn,updateMapClasses:Fi,clearMapClasses:function(){Fn({mode:null,feature:null,mouse:null}),Fi()},addButtons:function(){var nn=st.options.controls,Kn=document.createElement("div");return Kn.className=x.CONTROL_GROUP+" "+x.CONTROL_BASE,nn&&(nn[L.LINE]&&(_n[L.LINE]=vs(L.LINE,{container:Kn,className:x.CONTROL_BUTTON_LINE,title:"LineString tool "+(st.options.keybindings?"(l)":""),onActivate:function(){return st.events.changeMode(B.DRAW_LINE_STRING)},onDeactivate:function(){return st.events.trash()}})),nn[L.POLYGON]&&(_n[L.POLYGON]=vs(L.POLYGON,{container:Kn,className:x.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(st.options.keybindings?"(p)":""),onActivate:function(){return st.events.changeMode(B.DRAW_POLYGON)},onDeactivate:function(){return st.events.trash()}})),nn[L.POINT]&&(_n[L.POINT]=vs(L.POINT,{container:Kn,className:x.CONTROL_BUTTON_POINT,title:"Marker tool "+(st.options.keybindings?"(m)":""),onActivate:function(){return st.events.changeMode(B.DRAW_POINT)},onDeactivate:function(){return st.events.trash()}})),nn.trash&&(_n.trash=vs("trash",{container:Kn,className:x.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:function(){st.events.trash()}})),nn.combine_features&&(_n.combine_features=vs("combineFeatures",{container:Kn,className:x.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:function(){st.events.combineFeatures()}})),nn.uncombine_features&&(_n.uncombine_features=vs("uncombineFeatures",{container:Kn,className:x.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:function(){st.events.uncombineFeatures()}}))),Kn},removeButtons:function(){Object.keys(_n).forEach(function(nn){var Kn=_n[nn];Kn.parentNode&&Kn.parentNode.removeChild(Kn),delete _n[nn]})}}}(O),O.container=et.getContainer(),O.store=new yn(O),j=O.ui.addButtons(),O.options.boxSelect&&(et.boxZoom.disable(),et.dragPan.disable(),et.dragPan.enable()),et.loaded()?Fe.connect():(et.on("load",Fe.connect),ue=setInterval(function(){et.loaded()&&Fe.connect()},16)),O.events.start(),j},addLayers:function(){O.map.addSource(I.COLD,{data:{type:N.FEATURE_COLLECTION,features:[]},type:"geojson"}),O.map.addSource(I.HOT,{data:{type:N.FEATURE_COLLECTION,features:[]},type:"geojson"}),O.options.styles.forEach(function(et){O.map.addLayer(et)}),O.store.setDirty(!0),O.store.render()},removeLayers:function(){O.options.styles.forEach(function(et){O.map.getLayer(et.id)&&O.map.removeLayer(et.id)}),O.map.getSource(I.COLD)&&O.map.removeSource(I.COLD),O.map.getSource(I.HOT)&&O.map.removeSource(I.HOT)}};return O.setup=Fe,Fe}var He=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];function Jt(O){return function(j){var ue=j.featureTarget;return!!ue&&!!ue.properties&&ue.properties.meta===O}}function ui(O){return!!O.originalEvent&&!!O.originalEvent.shiftKey&&O.originalEvent.button===0}function $e(O){return!!O.featureTarget&&!!O.featureTarget.properties&&O.featureTarget.properties.active===Y.ACTIVE&&O.featureTarget.properties.meta===V.FEATURE}function kn(O){return!!O.featureTarget&&!!O.featureTarget.properties&&O.featureTarget.properties.active===Y.INACTIVE&&O.featureTarget.properties.meta===V.FEATURE}function Ei(O){return O.featureTarget===void 0}function ni(O){return!!O.featureTarget&&!!O.featureTarget.properties&&O.featureTarget.properties.meta===V.FEATURE}function Ln(O){var j=O.featureTarget;return!!j&&!!j.properties&&j.properties.meta===V.VERTEX}function ki(O){return!!O.originalEvent&&O.originalEvent.shiftKey===!0}function Hs(O){return O.keyCode===27}function Xt(O){return O.keyCode===13}var Rn=Object.freeze({__proto__:null,isOfMetaType:Jt,isShiftMousedown:ui,isActiveFeature:$e,isInactiveFeature:kn,noTarget:Ei,isFeature:ni,isVertex:Ln,isShiftDown:ki,isEscapeKey:Hs,isEnterKey:Xt,isTrue:function(){return!0}}),ti=tr;function tr(O,j){this.x=O,this.y=j}function js(O,j){var ue=j.getBoundingClientRect();return new ti(O.clientX-ue.left-(j.clientLeft||0),O.clientY-ue.top-(j.clientTop||0))}function mo(O,j,ue,Fe){return{type:N.FEATURE,properties:{meta:V.VERTEX,parent:O,coord_path:ue,active:Fe?Y.ACTIVE:Y.INACTIVE},geometry:{type:N.POINT,coordinates:j}}}function ca(O,j,ue){var Fe=j.geometry.coordinates,et=ue.geometry.coordinates;if(Fe[1]>85||Fe[1]<J||et[1]>85||et[1]<J)return null;var Qe={lng:(Fe[0]+et[0])/2,lat:(Fe[1]+et[1])/2};return{type:N.FEATURE,properties:{meta:V.MIDPOINT,parent:O,lng:Qe.lng,lat:Qe.lat,coord_path:ue.properties.coord_path},geometry:{type:N.POINT,coordinates:[Qe.lng,Qe.lat]}}}function Xo(O,j,ue){j===void 0&&(j={}),ue===void 0&&(ue=null);var Fe,et=O.geometry,Qe=et.type,st=et.coordinates,_n=O.properties&&O.properties.id,mn=[];function Wn(Fn,Fi){var vs="",zi=null;Fn.forEach(function(Cs,nn){var Kn=Fi!=null?Fi+"."+nn:String(nn),qi=mo(_n,Cs,Kn,Pn(Kn));if(j.midpoints&&zi){var oo=ca(_n,zi,qi);oo&&mn.push(oo)}zi=qi;var Fs=JSON.stringify(Cs);vs!==Fs&&mn.push(qi),nn===0&&(vs=Fs)})}function Pn(Fn){return!!j.selectedPaths&&j.selectedPaths.indexOf(Fn)!==-1}return Qe===N.POINT?mn.push(mo(_n,st,ue,Pn(ue))):Qe===N.POLYGON?st.forEach(function(Fn,Fi){Wn(Fn,ue!==null?ue+"."+Fi:String(Fi))}):Qe===N.LINE_STRING?Wn(st,ue):Qe.indexOf(N.MULTI_PREFIX)===0&&(Fe=Qe.replace(N.MULTI_PREFIX,""),st.forEach(function(Fn,Fi){var vs={type:N.FEATURE,properties:O.properties,geometry:{type:Fe,coordinates:Fn}};mn=mn.concat(Xo(vs,j,Fi))})),mn}tr.prototype={clone:function(){return new tr(this.x,this.y)},add:function(O){return this.clone()._add(O)},sub:function(O){return this.clone()._sub(O)},multByPoint:function(O){return this.clone()._multByPoint(O)},divByPoint:function(O){return this.clone()._divByPoint(O)},mult:function(O){return this.clone()._mult(O)},div:function(O){return this.clone()._div(O)},rotate:function(O){return this.clone()._rotate(O)},rotateAround:function(O,j){return this.clone()._rotateAround(O,j)},matMult:function(O){return this.clone()._matMult(O)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(O){return this.x===O.x&&this.y===O.y},dist:function(O){return Math.sqrt(this.distSqr(O))},distSqr:function(O){var j=O.x-this.x,ue=O.y-this.y;return j*j+ue*ue},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(O){return Math.atan2(this.y-O.y,this.x-O.x)},angleWith:function(O){return this.angleWithSep(O.x,O.y)},angleWithSep:function(O,j){return Math.atan2(this.x*j-this.y*O,this.x*O+this.y*j)},_matMult:function(O){var j=O[0]*this.x+O[1]*this.y,ue=O[2]*this.x+O[3]*this.y;return this.x=j,this.y=ue,this},_add:function(O){return this.x+=O.x,this.y+=O.y,this},_sub:function(O){return this.x-=O.x,this.y-=O.y,this},_mult:function(O){return this.x*=O,this.y*=O,this},_div:function(O){return this.x/=O,this.y/=O,this},_multByPoint:function(O){return this.x*=O.x,this.y*=O.y,this},_divByPoint:function(O){return this.x/=O.x,this.y/=O.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var O=this.y;return this.y=this.x,this.x=-O,this},_rotate:function(O){var j=Math.cos(O),ue=Math.sin(O),Fe=j*this.x-ue*this.y,et=ue*this.x+j*this.y;return this.x=Fe,this.y=et,this},_rotateAround:function(O,j){var ue=Math.cos(O),Fe=Math.sin(O),et=j.x+ue*(this.x-j.x)-Fe*(this.y-j.y),Qe=j.y+Fe*(this.x-j.x)+ue*(this.y-j.y);return this.x=et,this.y=Qe,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},tr.convert=function(O){return O instanceof tr?O:Array.isArray(O)?new tr(O[0],O[1]):O};var qs={enable:function(O){setTimeout(function(){O.map&&O.map.doubleClickZoom&&O._ctx&&O._ctx.store&&O._ctx.store.getInitialConfigValue&&O._ctx.store.getInitialConfigValue("doubleClickZoom")&&O.map.doubleClickZoom.enable()},0)},disable:function(O){setTimeout(function(){O.map&&O.map.doubleClickZoom&&O.map.doubleClickZoom.disable()},0)}},No={},Ja={get exports(){return No},set exports(O){No=O}},go=function(O){if(!O||!O.type)return null;var j=Ma[O.type];if(!j)return null;if(j==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:O}]};if(j==="feature")return{type:"FeatureCollection",features:[O]};if(j==="featurecollection")return O},Ma={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"},Vl=Object.freeze({__proto__:null,default:function O(j){switch(j&&j.type||null){case"FeatureCollection":return j.features=j.features.reduce(function(ue,Fe){return ue.concat(O(Fe))},[]),j;case"Feature":return j.geometry?O(j.geometry).map(function(ue){var Fe={type:"Feature",properties:JSON.parse(JSON.stringify(j.properties)),geometry:ue};return j.id!==void 0&&(Fe.id=j.id),Fe}):[j];case"MultiPoint":return j.coordinates.map(function(ue){return{type:"Point",coordinates:ue}});case"MultiPolygon":return j.coordinates.map(function(ue){return{type:"Polygon",coordinates:ue}});case"MultiLineString":return j.coordinates.map(function(ue){return{type:"LineString",coordinates:ue}});case"GeometryCollection":return j.geometries.map(O).reduce(function(ue,Fe){return ue.concat(Fe)},[]);case"Point":case"Polygon":case"LineString":return[j]}}}),Qa=go,ha=i(Vl),$a=function(O){return function j(ue){return Array.isArray(ue)&&ue.length&&typeof ue[0]=="number"?[ue]:ue.reduce(function(Fe,et){return Array.isArray(et)&&Array.isArray(et[0])?Fe.concat(j(et)):(Fe.push(et),Fe)},[])}(O)};ha instanceof Function||(ha=ha.default);var Zs={},La={get exports(){return Zs},set exports(O){Zs=O}}.exports=function(O){return new so(O)};function so(O){this.value=O}function Ra(O,j,ue){var Fe=[],et=[],Qe=!0;return function st(_n){var mn=ue?we(_n):_n,Wn={},Pn=!0,Fn={node:mn,node_:_n,path:[].concat(Fe),parent:et[et.length-1],parents:et,key:Fe.slice(-1)[0],isRoot:Fe.length===0,level:Fe.length,circular:null,update:function(zi,Cs){Fn.isRoot||(Fn.parent.node[Fn.key]=zi),Fn.node=zi,Cs&&(Pn=!1)},delete:function(zi){delete Fn.parent.node[Fn.key],zi&&(Pn=!1)},remove:function(zi){Ie(Fn.parent.node)?Fn.parent.node.splice(Fn.key,1):delete Fn.parent.node[Fn.key],zi&&(Pn=!1)},keys:null,before:function(zi){Wn.before=zi},after:function(zi){Wn.after=zi},pre:function(zi){Wn.pre=zi},post:function(zi){Wn.post=zi},stop:function(){Qe=!1},block:function(){Pn=!1}};if(!Qe)return Fn;function Fi(){if(typeof Fn.node=="object"&&Fn.node!==null){Fn.keys&&Fn.node_===Fn.node||(Fn.keys=te(Fn.node)),Fn.isLeaf=Fn.keys.length==0;for(var zi=0;zi<et.length;zi++)if(et[zi].node_===_n){Fn.circular=et[zi];break}}else Fn.isLeaf=!0,Fn.keys=null;Fn.notLeaf=!Fn.isLeaf,Fn.notRoot=!Fn.isRoot}Fi();var vs=j.call(Fn,Fn.node);return vs!==void 0&&Fn.update&&Fn.update(vs),Wn.before&&Wn.before.call(Fn,Fn.node),Pn&&(typeof Fn.node!="object"||Fn.node===null||Fn.circular||(et.push(Fn),Fi(),Oe(Fn.keys,function(zi,Cs){Fe.push(zi),Wn.pre&&Wn.pre.call(Fn,Fn.node[zi],zi);var nn=st(Fn.node[zi]);ue&&We.call(Fn.node,zi)&&(Fn.node[zi]=nn.node),nn.isLast=Cs==Fn.keys.length-1,nn.isFirst=Cs==0,Wn.post&&Wn.post.call(Fn,nn),Fe.pop()}),et.pop()),Wn.after&&Wn.after.call(Fn,Fn.node)),Fn}(O).node}function we(O){if(typeof O=="object"&&O!==null){var j;if(Ie(O))j=[];else if(re(O)==="[object Date]")j=new Date(O.getTime?O.getTime():O);else if(function(et){return re(et)==="[object RegExp]"}(O))j=new RegExp(O);else if(function(et){return re(et)==="[object Error]"}(O))j={message:O.message};else if(function(et){return re(et)==="[object Boolean]"}(O))j=new Boolean(O);else if(function(et){return re(et)==="[object Number]"}(O))j=new Number(O);else if(function(et){return re(et)==="[object String]"}(O))j=new String(O);else if(Object.create&&Object.getPrototypeOf)j=Object.create(Object.getPrototypeOf(O));else if(O.constructor===Object)j={};else{var ue=O.constructor&&O.constructor.prototype||O.__proto__||{},Fe=function(){};Fe.prototype=ue,j=new Fe}return Oe(te(O),function(et){j[et]=O[et]}),j}return O}so.prototype.get=function(O){for(var j=this.value,ue=0;ue<O.length;ue++){var Fe=O[ue];if(!j||!We.call(j,Fe)){j=void 0;break}j=j[Fe]}return j},so.prototype.has=function(O){for(var j=this.value,ue=0;ue<O.length;ue++){var Fe=O[ue];if(!j||!We.call(j,Fe))return!1;j=j[Fe]}return!0},so.prototype.set=function(O,j){for(var ue=this.value,Fe=0;Fe<O.length-1;Fe++){var et=O[Fe];We.call(ue,et)||(ue[et]={}),ue=ue[et]}return ue[O[Fe]]=j,j},so.prototype.map=function(O){return Ra(this.value,O,!0)},so.prototype.forEach=function(O){return this.value=Ra(this.value,O,!1),this.value},so.prototype.reduce=function(O,j){var ue=arguments.length===1,Fe=ue?this.value:j;return this.forEach(function(et){this.isRoot&&ue||(Fe=O.call(this,Fe,et))}),Fe},so.prototype.paths=function(){var O=[];return this.forEach(function(j){O.push(this.path)}),O},so.prototype.nodes=function(){var O=[];return this.forEach(function(j){O.push(this.node)}),O},so.prototype.clone=function(){var O=[],j=[];return function ue(Fe){for(var et=0;et<O.length;et++)if(O[et]===Fe)return j[et];if(typeof Fe=="object"&&Fe!==null){var Qe=we(Fe);return O.push(Fe),j.push(Qe),Oe(te(Fe),function(st){Qe[st]=ue(Fe[st])}),O.pop(),j.pop(),Qe}return Fe}(this.value)};var te=Object.keys||function(O){var j=[];for(var ue in O)j.push(ue);return j};function re(O){return Object.prototype.toString.call(O)}var Ie=Array.isArray||function(O){return Object.prototype.toString.call(O)==="[object Array]"},Oe=function(O,j){if(O.forEach)return O.forEach(j);for(var ue=0;ue<O.length;ue++)j(O[ue],ue,O)};Oe(te(so.prototype),function(O){La[O]=function(j){var ue=[].slice.call(arguments,1),Fe=new so(j);return Fe[O].apply(Fe,ue)}});var We=Object.hasOwnProperty||function(O,j){return j in O},ut=ot;function ot(O){if(!(this instanceof ot))return new ot(O);this._bbox=O||[1/0,1/0,-1/0,-1/0],this._valid=!!O}ot.prototype.include=function(O){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],O[0]),this._bbox[1]=Math.min(this._bbox[1],O[1]),this._bbox[2]=Math.max(this._bbox[2],O[0]),this._bbox[3]=Math.max(this._bbox[3],O[1]),this},ot.prototype.equals=function(O){var j;return j=O instanceof ot?O.bbox():O,this._bbox[0]==j[0]&&this._bbox[1]==j[1]&&this._bbox[2]==j[2]&&this._bbox[3]==j[3]},ot.prototype.center=function(O){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},ot.prototype.union=function(O){var j;return this._valid=!0,j=O instanceof ot?O.bbox():O,this._bbox[0]=Math.min(this._bbox[0],j[0]),this._bbox[1]=Math.min(this._bbox[1],j[1]),this._bbox[2]=Math.max(this._bbox[2],j[2]),this._bbox[3]=Math.max(this._bbox[3],j[3]),this},ot.prototype.bbox=function(){return this._valid?this._bbox:null},ot.prototype.contains=function(O){if(!O)return this._fastContains();if(!this._valid)return null;var j=O[0],ue=O[1];return this._bbox[0]<=j&&this._bbox[1]<=ue&&this._bbox[2]>=j&&this._bbox[3]>=ue},ot.prototype.intersect=function(O){return this._valid?(j=O instanceof ot?O.bbox():O,!(this._bbox[0]>j[2]||this._bbox[2]<j[0]||this._bbox[3]<j[1]||this._bbox[1]>j[3])):null;var j},ot.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var O="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",O)},ot.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var Je=function(O){if(!O)return[];var j=ha(Qa(O)),ue=[];return j.features.forEach(function(Fe){Fe.geometry&&(ue=ue.concat($a(Fe.geometry.coordinates)))}),ue},pe=Zs,nt=ut,be={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},Ot=Object.keys(be);function On(O){for(var j=nt(),ue=Je(O),Fe=0;Fe<ue.length;Fe++)j.include(ue[Fe]);return j}Ja.exports=function(O){return On(O).bbox()},No.polygon=function(O){return On(O).polygon()},No.bboxify=function(O){return pe(O).map(function(j){j&&Ot.some(function(ue){return!!j[ue]&&be[ue].indexOf(j.type)!==-1})&&(j.bbox=On(j).bbox(),this.update(j))})};var ii=-90;function ei(O,j){var ue=ii,Fe=90,et=ii,Qe=90,st=270,_n=-270;O.forEach(function(Wn){var Pn=No(Wn),Fn=Pn[1],Fi=Pn[3],vs=Pn[0],zi=Pn[2];Fn>ue&&(ue=Fn),Fi<Fe&&(Fe=Fi),Fi>et&&(et=Fi),Fn<Qe&&(Qe=Fn),vs<st&&(st=vs),zi>_n&&(_n=zi)});var mn=j;return ue+mn.lat>85&&(mn.lat=85-ue),et+mn.lat>90&&(mn.lat=90-et),Fe+mn.lat<-85&&(mn.lat=-85-Fe),Qe+mn.lat<ii&&(mn.lat=ii-Qe),st+mn.lng<=-270&&(mn.lng+=360*Math.ceil(Math.abs(mn.lng)/360)),_n+mn.lng>=270&&(mn.lng-=360*Math.ceil(Math.abs(mn.lng)/360)),mn}function Ye(O,j){var ue=ei(O.map(function(Fe){return Fe.toGeoJSON()}),j);O.forEach(function(Fe){var et,Qe=Fe.getCoordinates(),st=function(mn){var Wn={lng:mn[0]+ue.lng,lat:mn[1]+ue.lat};return[Wn.lng,Wn.lat]},_n=function(mn){return mn.map(function(Wn){return st(Wn)})};Fe.type===N.POINT?et=st(Qe):Fe.type===N.LINE_STRING||Fe.type===N.MULTI_POINT?et=Qe.map(st):Fe.type===N.POLYGON||Fe.type===N.MULTI_LINE_STRING?et=Qe.map(_n):Fe.type===N.MULTI_POLYGON&&(et=Qe.map(function(mn){return mn.map(function(Wn){return _n(Wn)})})),Fe.incomingCoords(et)})}var Qn={onSetup:function(O){var j=this,ue={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:O.featureIds||[]};return this.setSelected(ue.initiallySelectedFeatureIds.filter(function(Fe){return j.getFeature(Fe)!==void 0})),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),ue},fireUpdate:function(){this.map.fire(F.UPDATE,{action:z.MOVE,features:this.getSelected().map(function(O){return O.toGeoJSON()})})},fireActionable:function(){var O=this,j=this.getSelected(),ue=j.filter(function(_n){return O.isInstanceOf("MultiFeature",_n)}),Fe=!1;if(j.length>1){Fe=!0;var et=j[0].type.replace("Multi","");j.forEach(function(_n){_n.type.replace("Multi","")!==et&&(Fe=!1)})}var Qe=ue.length>0,st=j.length>0;this.setActionableState({combineFeatures:Fe,uncombineFeatures:Qe,trash:st})},getUniqueIds:function(O){return O.length?O.map(function(j){return j.properties.id}).filter(function(j){return j!==void 0}).reduce(function(j,ue){return j.add(ue),j},new le).values():[]},stopExtendedInteractions:function(O){O.boxSelectElement&&(O.boxSelectElement.parentNode&&O.boxSelectElement.parentNode.removeChild(O.boxSelectElement),O.boxSelectElement=null),this.map.dragPan.enable(),O.boxSelecting=!1,O.canBoxSelect=!1,O.dragMoving=!1,O.canDragMove=!1},onStop:function(){qs.enable(this)},onMouseMove:function(O){return this.stopExtendedInteractions(O),!0},onMouseOut:function(O){return!O.dragMoving||this.fireUpdate()}};Qn.onTap=Qn.onClick=function(O,j){return Ei(j)?this.clickAnywhere(O,j):Jt(V.VERTEX)(j)?this.clickOnVertex(O,j):ni(j)?this.clickOnFeature(O,j):void 0},Qn.clickAnywhere=function(O){var j=this,ue=this.getSelectedIds();ue.length&&(this.clearSelectedFeatures(),ue.forEach(function(Fe){return j.doRender(Fe)})),qs.enable(this),this.stopExtendedInteractions(O)},Qn.clickOnVertex=function(O,j){this.changeMode(B.DIRECT_SELECT,{featureId:j.featureTarget.properties.parent,coordPath:j.featureTarget.properties.coord_path,startPos:j.lngLat}),this.updateUIClasses({mouse:A.MOVE})},Qn.startOnActiveFeature=function(O,j){this.stopExtendedInteractions(O),this.map.dragPan.disable(),this.doRender(j.featureTarget.properties.id),O.canDragMove=!0,O.dragMoveLocation=j.lngLat},Qn.clickOnFeature=function(O,j){var ue=this;qs.disable(this),this.stopExtendedInteractions(O);var Fe=ki(j),et=this.getSelectedIds(),Qe=j.featureTarget.properties.id,st=this.isSelected(Qe);if(!Fe&&st&&this.getFeature(Qe).type!==N.POINT)return this.changeMode(B.DIRECT_SELECT,{featureId:Qe});st&&Fe?(this.deselect(Qe),this.updateUIClasses({mouse:A.POINTER}),et.length===1&&qs.enable(this)):!st&&Fe?(this.select(Qe),this.updateUIClasses({mouse:A.MOVE})):st||Fe||(et.forEach(function(_n){return ue.doRender(_n)}),this.setSelected(Qe),this.updateUIClasses({mouse:A.MOVE})),this.doRender(Qe)},Qn.onMouseDown=function(O,j){return $e(j)?this.startOnActiveFeature(O,j):this.drawConfig.boxSelect&&ui(j)?this.startBoxSelect(O,j):void 0},Qn.startBoxSelect=function(O,j){this.stopExtendedInteractions(O),this.map.dragPan.disable(),O.boxSelectStartLocation=js(j.originalEvent,this.map.getContainer()),O.canBoxSelect=!0},Qn.onTouchStart=function(O,j){if($e(j))return this.startOnActiveFeature(O,j)},Qn.onDrag=function(O,j){return O.canDragMove?this.dragMove(O,j):this.drawConfig.boxSelect&&O.canBoxSelect?this.whileBoxSelect(O,j):void 0},Qn.whileBoxSelect=function(O,j){O.boxSelecting=!0,this.updateUIClasses({mouse:A.ADD}),O.boxSelectElement||(O.boxSelectElement=document.createElement("div"),O.boxSelectElement.classList.add(x.BOX_SELECT),this.map.getContainer().appendChild(O.boxSelectElement));var ue=js(j.originalEvent,this.map.getContainer()),Fe=Math.min(O.boxSelectStartLocation.x,ue.x),et=Math.max(O.boxSelectStartLocation.x,ue.x),Qe=Math.min(O.boxSelectStartLocation.y,ue.y),st=Math.max(O.boxSelectStartLocation.y,ue.y),_n="translate("+Fe+"px, "+Qe+"px)";O.boxSelectElement.style.transform=_n,O.boxSelectElement.style.WebkitTransform=_n,O.boxSelectElement.style.width=et-Fe+"px",O.boxSelectElement.style.height=st-Qe+"px"},Qn.dragMove=function(O,j){O.dragMoving=!0,j.originalEvent.stopPropagation();var ue={lng:j.lngLat.lng-O.dragMoveLocation.lng,lat:j.lngLat.lat-O.dragMoveLocation.lat};Ye(this.getSelected(),ue),O.dragMoveLocation=j.lngLat},Qn.onTouchEnd=Qn.onMouseUp=function(O,j){var ue=this;if(O.dragMoving)this.fireUpdate();else if(O.boxSelecting){var Fe=[O.boxSelectStartLocation,js(j.originalEvent,this.map.getContainer())],et=this.featuresAt(null,Fe,"click"),Qe=this.getUniqueIds(et).filter(function(st){return!ue.isSelected(st)});Qe.length&&(this.select(Qe),Qe.forEach(function(st){return ue.doRender(st)}),this.updateUIClasses({mouse:A.MOVE}))}this.stopExtendedInteractions(O)},Qn.toDisplayFeatures=function(O,j,ue){j.properties.active=this.isSelected(j.properties.id)?Y.ACTIVE:Y.INACTIVE,ue(j),this.fireActionable(),j.properties.active===Y.ACTIVE&&j.geometry.type!==N.POINT&&Xo(j).forEach(ue)},Qn.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},Qn.onCombineFeatures=function(){var O=this.getSelected();if(!(O.length===0||O.length<2)){for(var j=[],ue=[],Fe=O[0].type.replace("Multi",""),et=0;et<O.length;et++){var Qe=O[et];if(Qe.type.replace("Multi","")!==Fe)return;Qe.type.includes("Multi")?Qe.getCoordinates().forEach(function(_n){j.push(_n)}):j.push(Qe.getCoordinates()),ue.push(Qe.toGeoJSON())}if(ue.length>1){var st=this.newFeature({type:N.FEATURE,properties:ue[0].properties,geometry:{type:"Multi"+Fe,coordinates:j}});this.addFeature(st),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([st.id]),this.map.fire(F.COMBINE_FEATURES,{createdFeatures:[st.toGeoJSON()],deletedFeatures:ue})}this.fireActionable()}},Qn.onUncombineFeatures=function(){var O=this,j=this.getSelected();if(j.length!==0){for(var ue=[],Fe=[],et=function(st){var _n=j[st];O.isInstanceOf("MultiFeature",_n)&&(_n.getFeatures().forEach(function(mn){O.addFeature(mn),mn.properties=_n.properties,ue.push(mn.toGeoJSON()),O.select([mn.id])}),O.deleteFeature(_n.id,{silent:!0}),Fe.push(_n.toGeoJSON()))},Qe=0;Qe<j.length;Qe++)et(Qe);ue.length>1&&this.map.fire(F.UNCOMBINE_FEATURES,{createdFeatures:ue,deletedFeatures:Fe}),this.fireActionable()}};var xr=Jt(V.VERTEX),Ti=Jt(V.MIDPOINT),mr={fireUpdate:function(){this.map.fire(F.UPDATE,{action:z.CHANGE_COORDINATES,features:this.getSelected().map(function(O){return O.toGeoJSON()})})},fireActionable:function(O){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:O.selectedCoordPaths.length>0})},startDragging:function(O,j){this.map.dragPan.disable(),O.canDragMove=!0,O.dragMoveLocation=j.lngLat},stopDragging:function(O){this.map.dragPan.enable(),O.dragMoving=!1,O.canDragMove=!1,O.dragMoveLocation=null},onVertex:function(O,j){this.startDragging(O,j);var ue=j.featureTarget.properties,Fe=O.selectedCoordPaths.indexOf(ue.coord_path);ki(j)||Fe!==-1?ki(j)&&Fe===-1&&O.selectedCoordPaths.push(ue.coord_path):O.selectedCoordPaths=[ue.coord_path];var et=this.pathsToCoordinates(O.featureId,O.selectedCoordPaths);this.setSelectedCoordinates(et)},onMidpoint:function(O,j){this.startDragging(O,j);var ue=j.featureTarget.properties;O.feature.addCoordinate(ue.coord_path,ue.lng,ue.lat),this.fireUpdate(),O.selectedCoordPaths=[ue.coord_path]},pathsToCoordinates:function(O,j){return j.map(function(ue){return{feature_id:O,coord_path:ue}})},onFeature:function(O,j){O.selectedCoordPaths.length===0?this.startDragging(O,j):this.stopDragging(O)},dragFeature:function(O,j,ue){Ye(this.getSelected(),ue),O.dragMoveLocation=j.lngLat},dragVertex:function(O,j,ue){for(var Fe=O.selectedCoordPaths.map(function(_n){return O.feature.getCoordinate(_n)}),et=ei(Fe.map(function(_n){return{type:N.FEATURE,properties:{},geometry:{type:N.POINT,coordinates:_n}}}),ue),Qe=0;Qe<Fe.length;Qe++){var st=Fe[Qe];O.feature.updateCoordinate(O.selectedCoordPaths[Qe],st[0]+et.lng,st[1]+et.lat)}},clickNoTarget:function(){this.changeMode(B.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(B.SIMPLE_SELECT)},clickActiveFeature:function(O){O.selectedCoordPaths=[],this.clearSelectedCoordinates(),O.feature.changed()},onSetup:function(O){var j=O.featureId,ue=this.getFeature(j);if(!ue)throw new Error("You must provide a featureId to enter direct_select mode");if(ue.type===N.POINT)throw new TypeError("direct_select mode doesn't handle point features");var Fe={featureId:j,feature:ue,dragMoveLocation:O.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:O.coordPath?[O.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(j,Fe.selectedCoordPaths)),this.setSelected(j),qs.disable(this),this.setActionableState({trash:!0}),Fe},onStop:function(){qs.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(O,j,ue){O.featureId===j.properties.id?(j.properties.active=Y.ACTIVE,ue(j),Xo(j,{map:this.map,midpoints:!0,selectedPaths:O.selectedCoordPaths}).forEach(ue)):(j.properties.active=Y.INACTIVE,ue(j)),this.fireActionable(O)},onTrash:function(O){O.selectedCoordPaths.sort(function(j,ue){return ue.localeCompare(j,"en",{numeric:!0})}).forEach(function(j){return O.feature.removeCoordinate(j)}),this.fireUpdate(),O.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(O),O.feature.isValid()===!1&&(this.deleteFeature([O.featureId]),this.changeMode(B.SIMPLE_SELECT,{}))},onMouseMove:function(O,j){var ue=$e(j),Fe=xr(j),et=O.selectedCoordPaths.length===0;return ue&&et||Fe&&!et?this.updateUIClasses({mouse:A.MOVE}):this.updateUIClasses({mouse:A.NONE}),this.stopDragging(O),!0},onMouseOut:function(O){return O.dragMoving&&this.fireUpdate(),!0}};mr.onTouchStart=mr.onMouseDown=function(O,j){return xr(j)?this.onVertex(O,j):$e(j)?this.onFeature(O,j):Ti(j)?this.onMidpoint(O,j):void 0},mr.onDrag=function(O,j){if(O.canDragMove===!0){O.dragMoving=!0,j.originalEvent.stopPropagation();var ue={lng:j.lngLat.lng-O.dragMoveLocation.lng,lat:j.lngLat.lat-O.dragMoveLocation.lat};O.selectedCoordPaths.length>0?this.dragVertex(O,j,ue):this.dragFeature(O,j,ue),O.dragMoveLocation=j.lngLat}},mr.onClick=function(O,j){return Ei(j)?this.clickNoTarget(O,j):$e(j)?this.clickActiveFeature(O,j):kn(j)?this.clickInactive(O,j):void this.stopDragging(O)},mr.onTap=function(O,j){return Ei(j)?this.clickNoTarget(O,j):$e(j)?this.clickActiveFeature(O,j):kn(j)?this.clickInactive(O,j):void 0},mr.onTouchEnd=mr.onMouseUp=function(O){O.dragMoving&&this.fireUpdate(),this.stopDragging(O)};var yr={};function Gl(O,j){return!!O.lngLat&&O.lngLat.lng===j[0]&&O.lngLat.lat===j[1]}yr.onSetup=function(){var O=this.newFeature({type:N.FEATURE,properties:{},geometry:{type:N.POINT,coordinates:[]}});return this.addFeature(O),this.clearSelectedFeatures(),this.updateUIClasses({mouse:A.ADD}),this.activateUIButton(L.POINT),this.setActionableState({trash:!0}),{point:O}},yr.stopDrawingAndRemove=function(O){this.deleteFeature([O.point.id],{silent:!0}),this.changeMode(B.SIMPLE_SELECT)},yr.onTap=yr.onClick=function(O,j){this.updateUIClasses({mouse:A.MOVE}),O.point.updateCoordinate("",j.lngLat.lng,j.lngLat.lat),this.map.fire(F.CREATE,{features:[O.point.toGeoJSON()]}),this.changeMode(B.SIMPLE_SELECT,{featureIds:[O.point.id]})},yr.onStop=function(O){this.activateUIButton(),O.point.getCoordinate().length||this.deleteFeature([O.point.id],{silent:!0})},yr.toDisplayFeatures=function(O,j,ue){var Fe=j.properties.id===O.point.id;if(j.properties.active=Fe?Y.ACTIVE:Y.INACTIVE,!Fe)return ue(j)},yr.onTrash=yr.stopDrawingAndRemove,yr.onKeyUp=function(O,j){if(Hs(j)||Xt(j))return this.stopDrawingAndRemove(O,j)};var fa={onSetup:function(){var O=this.newFeature({type:N.FEATURE,properties:{},geometry:{type:N.POLYGON,coordinates:[[]]}});return this.addFeature(O),this.clearSelectedFeatures(),qs.disable(this),this.updateUIClasses({mouse:A.ADD}),this.activateUIButton(L.POLYGON),this.setActionableState({trash:!0}),{polygon:O,currentVertexPosition:0}},clickAnywhere:function(O,j){if(O.currentVertexPosition>0&&Gl(j,O.polygon.coordinates[0][O.currentVertexPosition-1]))return this.changeMode(B.SIMPLE_SELECT,{featureIds:[O.polygon.id]});this.updateUIClasses({mouse:A.ADD}),O.polygon.updateCoordinate("0."+O.currentVertexPosition,j.lngLat.lng,j.lngLat.lat),O.currentVertexPosition++,O.polygon.updateCoordinate("0."+O.currentVertexPosition,j.lngLat.lng,j.lngLat.lat)},clickOnVertex:function(O){return this.changeMode(B.SIMPLE_SELECT,{featureIds:[O.polygon.id]})},onMouseMove:function(O,j){O.polygon.updateCoordinate("0."+O.currentVertexPosition,j.lngLat.lng,j.lngLat.lat),Ln(j)&&this.updateUIClasses({mouse:A.POINTER})}};fa.onTap=fa.onClick=function(O,j){return Ln(j)?this.clickOnVertex(O,j):this.clickAnywhere(O,j)},fa.onKeyUp=function(O,j){Hs(j)?(this.deleteFeature([O.polygon.id],{silent:!0}),this.changeMode(B.SIMPLE_SELECT)):Xt(j)&&this.changeMode(B.SIMPLE_SELECT,{featureIds:[O.polygon.id]})},fa.onStop=function(O){this.updateUIClasses({mouse:A.NONE}),qs.enable(this),this.activateUIButton(),this.getFeature(O.polygon.id)!==void 0&&(O.polygon.removeCoordinate("0."+O.currentVertexPosition),O.polygon.isValid()?this.map.fire(F.CREATE,{features:[O.polygon.toGeoJSON()]}):(this.deleteFeature([O.polygon.id],{silent:!0}),this.changeMode(B.SIMPLE_SELECT,{},{silent:!0})))},fa.toDisplayFeatures=function(O,j,ue){var Fe=j.properties.id===O.polygon.id;if(j.properties.active=Fe?Y.ACTIVE:Y.INACTIVE,!Fe)return ue(j);if(j.geometry.coordinates.length!==0){var et=j.geometry.coordinates[0].length;if(!(et<3)){if(j.properties.meta=V.FEATURE,ue(mo(O.polygon.id,j.geometry.coordinates[0][0],"0.0",!1)),et>3){var Qe=j.geometry.coordinates[0].length-3;ue(mo(O.polygon.id,j.geometry.coordinates[0][Qe],"0."+Qe,!1))}if(et<=4){var st=[[j.geometry.coordinates[0][0][0],j.geometry.coordinates[0][0][1]],[j.geometry.coordinates[0][1][0],j.geometry.coordinates[0][1][1]]];if(ue({type:N.FEATURE,properties:j.properties,geometry:{coordinates:st,type:N.LINE_STRING}}),et===3)return}return ue(j)}}},fa.onTrash=function(O){this.deleteFeature([O.polygon.id],{silent:!0}),this.changeMode(B.SIMPLE_SELECT)};var Rt={onSetup:function(O){var j,ue,Fe=(O=O||{}).featureId,et="forward";if(Fe){if(!(j=this.getFeature(Fe)))throw new Error("Could not find a feature with the provided featureId");var Qe=O.from;if(Qe&&Qe.type==="Feature"&&Qe.geometry&&Qe.geometry.type==="Point"&&(Qe=Qe.geometry),Qe&&Qe.type==="Point"&&Qe.coordinates&&Qe.coordinates.length===2&&(Qe=Qe.coordinates),!Qe||!Array.isArray(Qe))throw new Error("Please use the `from` property to indicate which point to continue the line from");var st=j.coordinates.length-1;if(j.coordinates[st][0]===Qe[0]&&j.coordinates[st][1]===Qe[1])ue=st+1,j.addCoordinate.apply(j,[ue].concat(j.coordinates[st]));else{if(j.coordinates[0][0]!==Qe[0]||j.coordinates[0][1]!==Qe[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");et="backwards",ue=0,j.addCoordinate.apply(j,[ue].concat(j.coordinates[0]))}}else j=this.newFeature({type:N.FEATURE,properties:{},geometry:{type:N.LINE_STRING,coordinates:[]}}),ue=0,this.addFeature(j);return this.clearSelectedFeatures(),qs.disable(this),this.updateUIClasses({mouse:A.ADD}),this.activateUIButton(L.LINE),this.setActionableState({trash:!0}),{line:j,currentVertexPosition:ue,direction:et}},clickAnywhere:function(O,j){if(O.currentVertexPosition>0&&Gl(j,O.line.coordinates[O.currentVertexPosition-1])||O.direction==="backwards"&&Gl(j,O.line.coordinates[O.currentVertexPosition+1]))return this.changeMode(B.SIMPLE_SELECT,{featureIds:[O.line.id]});this.updateUIClasses({mouse:A.ADD}),O.line.updateCoordinate(O.currentVertexPosition,j.lngLat.lng,j.lngLat.lat),O.direction==="forward"?(O.currentVertexPosition++,O.line.updateCoordinate(O.currentVertexPosition,j.lngLat.lng,j.lngLat.lat)):O.line.addCoordinate(0,j.lngLat.lng,j.lngLat.lat)},clickOnVertex:function(O){return this.changeMode(B.SIMPLE_SELECT,{featureIds:[O.line.id]})},onMouseMove:function(O,j){O.line.updateCoordinate(O.currentVertexPosition,j.lngLat.lng,j.lngLat.lat),Ln(j)&&this.updateUIClasses({mouse:A.POINTER})}};Rt.onTap=Rt.onClick=function(O,j){if(Ln(j))return this.clickOnVertex(O,j);this.clickAnywhere(O,j)},Rt.onKeyUp=function(O,j){Xt(j)?this.changeMode(B.SIMPLE_SELECT,{featureIds:[O.line.id]}):Hs(j)&&(this.deleteFeature([O.line.id],{silent:!0}),this.changeMode(B.SIMPLE_SELECT))},Rt.onStop=function(O){qs.enable(this),this.activateUIButton(),this.getFeature(O.line.id)!==void 0&&(O.line.removeCoordinate(""+O.currentVertexPosition),O.line.isValid()?this.map.fire(F.CREATE,{features:[O.line.toGeoJSON()]}):(this.deleteFeature([O.line.id],{silent:!0}),this.changeMode(B.SIMPLE_SELECT,{},{silent:!0})))},Rt.onTrash=function(O){this.deleteFeature([O.line.id],{silent:!0}),this.changeMode(B.SIMPLE_SELECT)},Rt.toDisplayFeatures=function(O,j,ue){var Fe=j.properties.id===O.line.id;if(j.properties.active=Fe?Y.ACTIVE:Y.INACTIVE,!Fe)return ue(j);j.geometry.coordinates.length<2||(j.properties.meta=V.FEATURE,ue(mo(O.line.id,j.geometry.coordinates[O.direction==="forward"?j.geometry.coordinates.length-2:1],""+(O.direction==="forward"?j.geometry.coordinates.length-2:1),!1)),ue(j))};var Hl={simple_select:Qn,direct_select:mr,draw_point:yr,draw_polygon:fa,draw_line_string:Rt},Ys={defaultMode:B.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:He,modes:Hl,controls:{},userProperties:!1},dc={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},xm={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function jl(O,j){return O.map(function(ue){return ue.source?ue:Yn(ue,{id:ue.id+"."+j,source:j==="hot"?I.HOT:I.COLD})})}var Pu={};(function(O,j){var ue="__lodash_hash_undefined__",Fe=9007199254740991,et="[object Arguments]",Qe="[object Array]",st="[object Boolean]",_n="[object Date]",mn="[object Error]",Wn="[object Function]",Pn="[object Map]",Fn="[object Number]",Fi="[object Object]",vs="[object Promise]",zi="[object RegExp]",Cs="[object Set]",nn="[object String]",Kn="[object Symbol]",qi="[object WeakMap]",oo="[object ArrayBuffer]",Fs="[object DataView]",Zo=/^\[object .+?Constructor\]$/,da=/^(?:0|[1-9]\d*)$/,As={};As["[object Float32Array]"]=As["[object Float64Array]"]=As["[object Int8Array]"]=As["[object Int16Array]"]=As["[object Int32Array]"]=As["[object Uint8Array]"]=As["[object Uint8ClampedArray]"]=As["[object Uint16Array]"]=As["[object Uint32Array]"]=!0,As[et]=As[Qe]=As[oo]=As[st]=As[Fs]=As[_n]=As[mn]=As[Wn]=As[Pn]=As[Fn]=As[Fi]=As[zi]=As[Cs]=As[nn]=As[qi]=!1;var Bf=typeof ld=="object"&&ld&&ld.Object===Object&&ld,_o=typeof self=="object"&&self&&self.Object===Object&&self,pa=Bf||_o||Function("return this")(),Cd=j&&!j.nodeType&&j,kh=Cd&&O&&!O.nodeType&&O,ko=kh&&kh.exports===Cd,Fh=ko&&Bf.process,Qc=function(){try{return Fh&&Fh.binding&&Fh.binding("util")}catch{}}(),Vr=Qc&&Qc.isTypedArray;function rs(ct,Ut){for(var zn=-1,Si=ct==null?0:ct.length;++zn<Si;)if(Ut(ct[zn],zn,ct))return!0;return!1}function Ad(ct){var Ut=-1,zn=Array(ct.size);return ct.forEach(function(Si,Yr){zn[++Ut]=[Yr,Si]}),zn}function wg(ct){var Ut=-1,zn=Array(ct.size);return ct.forEach(function(Si){zn[++Ut]=Si}),zn}var Md,$c,Tp,zf=Array.prototype,eh=Function.prototype,ql=Object.prototype,Ks=pa["__core-js_shared__"],Wl=eh.toString,bs=ql.hasOwnProperty,th=(Md=/[^.]+$/.exec(Ks&&Ks.keys&&Ks.keys.IE_PROTO||""))?"Symbol(src)_1."+Md:"",Uf=ql.toString,el=RegExp("^"+Wl.call(bs).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Bh=ko?pa.Buffer:void 0,zh=pa.Symbol,Vf=pa.Uint8Array,Gf=ql.propertyIsEnumerable,nh=zf.splice,Du=zh?zh.toStringTag:void 0,Yo=Object.getOwnPropertySymbols,Ld=Bh?Bh.isBuffer:void 0,Da=($c=Object.keys,Tp=Object,function(ct){return $c(Tp(ct))}),Ou=zu(pa,"DataView"),Er=zu(pa,"Map"),Oa=zu(pa,"Promise"),mc=zu(pa,"Set"),Nu=zu(pa,"WeakMap"),Zr=zu(Object,"create"),Xl=Yl(Ou),Uh=Yl(Er),wp=Yl(Oa),Vh=Yl(mc),Sp=Yl(Nu),ku=zh?zh.prototype:void 0,Fu=ku?ku.valueOf:void 0;function Zl(ct){var Ut=-1,zn=ct==null?0:ct.length;for(this.clear();++Ut<zn;){var Si=ct[Ut];this.set(Si[0],Si[1])}}function Na(ct){var Ut=-1,zn=ct==null?0:ct.length;for(this.clear();++Ut<zn;){var Si=ct[Ut];this.set(Si[0],Si[1])}}function Zi(ct){var Ut=-1,zn=ct==null?0:ct.length;for(this.clear();++Ut<zn;){var Si=ct[Ut];this.set(Si[0],Si[1])}}function gc(ct){var Ut=-1,zn=ct==null?0:ct.length;for(this.__data__=new Zi;++Ut<zn;)this.add(ct[Ut])}function lu(ct){var Ut=this.__data__=new Na(ct);this.size=Ut.size}function Cp(ct,Ut){var zn=Wh(ct),Si=!zn&&jf(ct),Yr=!zn&&!Si&&El(ct),nr=!zn&&!Si&&!Yr&&Xh(ct),Rs=zn||Si||Yr||nr,yo=Rs?function(ao,Kl){for(var So=-1,lt=Array(ao);++So<ao;)lt[So]=Kl(So);return lt}(ct.length,String):[],Ko=yo.length;for(var vo in ct)!Ut&&!bs.call(ct,vo)||Rs&&(vo=="length"||Yr&&(vo=="offset"||vo=="parent")||nr&&(vo=="buffer"||vo=="byteLength"||vo=="byteOffset")||qh(vo,Ko))||yo.push(vo);return yo}function _c(ct,Ut){for(var zn=ct.length;zn--;)if(Lp(ct[zn][0],Ut))return zn;return-1}function Bu(ct){return ct==null?ct===void 0?"[object Undefined]":"[object Null]":Du&&Du in Object(ct)?function(Ut){var zn=bs.call(Ut,Du),Si=Ut[Du];try{Ut[Du]=void 0;var Yr=!0}catch{}var nr=Uf.call(Ut);return Yr&&(zn?Ut[Du]=Si:delete Ut[Du]),nr}(ct):function(Ut){return Uf.call(Ut)}(ct)}function Hf(ct){return Gu(ct)&&Bu(ct)==et}function Ap(ct,Ut,zn,Si,Yr){return ct===Ut||(ct==null||Ut==null||!Gu(ct)&&!Gu(Ut)?ct!=ct&&Ut!=Ut:function(nr,Rs,yo,Ko,vo,ao){var Kl=Wh(nr),So=Wh(Rs),lt=Kl?Qe:Uu(nr),Ht=So?Qe:Uu(Rs),Nt=(lt=lt==et?Fi:lt)==Fi,oi=(Ht=Ht==et?Fi:Ht)==Fi,Ui=lt==Ht;if(Ui&&El(nr)){if(!El(Rs))return!1;Kl=!0,Nt=!1}if(Ui&&!Nt)return ao||(ao=new lu),Kl||Xh(nr)?Rd(nr,Rs,yo,Ko,vo,ao):function(ms,gr,Hu,ma,tl,Co,Jo){switch(Hu){case Fs:if(ms.byteLength!=gr.byteLength||ms.byteOffset!=gr.byteOffset)return!1;ms=ms.buffer,gr=gr.buffer;case oo:return!(ms.byteLength!=gr.byteLength||!Co(new Vf(ms),new Vf(gr)));case st:case _n:case Fn:return Lp(+ms,+gr);case mn:return ms.name==gr.name&&ms.message==gr.message;case zi:case nn:return ms==gr+"";case Pn:var _r=Ad;case Cs:var nl=1&ma;if(_r||(_r=wg),ms.size!=gr.size&&!nl)return!1;var vc=Jo.get(ms);if(vc)return vc==gr;ma|=2,Jo.set(ms,gr);var $i=Rd(_r(ms),_r(gr),ma,tl,Co,Jo);return Jo.delete(ms),$i;case Kn:if(Fu)return Fu.call(ms)==Fu.call(gr)}return!1}(nr,Rs,lt,yo,Ko,vo,ao);if(!(1&yo)){var Or=Nt&&bs.call(nr,"__wrapped__"),Js=oi&&bs.call(Rs,"__wrapped__");if(Or||Js){var us=Or?nr.value():nr,Pd=Js?Rs.value():Rs;return ao||(ao=new lu),vo(us,Pd,yo,Ko,ao)}}return Ui?(ao||(ao=new lu),function(ms,gr,Hu,ma,tl,Co){var Jo=1&Hu,_r=Hh(ms),nl=_r.length,vc=Hh(gr).length;if(nl!=vc&&!Jo)return!1;for(var $i=nl;$i--;){var uu=_r[$i];if(!(Jo?uu in gr:bs.call(gr,uu)))return!1}var Em=Co.get(ms);if(Em&&Co.get(gr))return Em==gr;var Zh=!0;Co.set(ms,gr),Co.set(gr,ms);for(var cu=Jo;++$i<nl;){var il=ms[uu=_r[$i]],bc=gr[uu];if(ma)var Yh=Jo?ma(bc,il,uu,gr,ms,Co):ma(il,bc,uu,ms,gr,Co);if(!(Yh===void 0?il===bc||tl(il,bc,Hu,ma,Co):Yh)){Zh=!1;break}cu||(cu=uu=="constructor")}if(Zh&&!cu){var xc=ms.constructor,Ec=gr.constructor;xc==Ec||!("constructor"in ms)||!("constructor"in gr)||typeof xc=="function"&&xc instanceof xc&&typeof Ec=="function"&&Ec instanceof Ec||(Zh=!1)}return Co.delete(ms),Co.delete(gr),Zh}(nr,Rs,yo,Ko,vo,ao)):!1}(ct,Ut,zn,Si,Ap,Yr))}function Mp(ct){return!(!qf(ct)||function(Ut){return!!th&&th in Ut}(ct))&&(Vu(ct)?el:Zo).test(Yl(ct))}function Gh(ct){if(zn=(Ut=ct)&&Ut.constructor,Si=typeof zn=="function"&&zn.prototype||ql,Ut!==Si)return Da(ct);var Ut,zn,Si,Yr=[];for(var nr in Object(ct))bs.call(ct,nr)&&nr!="constructor"&&Yr.push(nr);return Yr}function Rd(ct,Ut,zn,Si,Yr,nr){var Rs=1&zn,yo=ct.length,Ko=Ut.length;if(yo!=Ko&&!(Rs&&Ko>yo))return!1;var vo=nr.get(ct);if(vo&&nr.get(Ut))return vo==Ut;var ao=-1,Kl=!0,So=2&zn?new gc:void 0;for(nr.set(ct,Ut),nr.set(Ut,ct);++ao<yo;){var lt=ct[ao],Ht=Ut[ao];if(Si)var Nt=Rs?Si(Ht,lt,ao,Ut,ct,nr):Si(lt,Ht,ao,ct,Ut,nr);if(Nt!==void 0){if(Nt)continue;Kl=!1;break}if(So){if(!rs(Ut,function(oi,Ui){if(Or=Ui,!So.has(Or)&&(lt===oi||Yr(lt,oi,zn,Si,nr)))return So.push(Ui);var Or})){Kl=!1;break}}else if(lt!==Ht&&!Yr(lt,Ht,zn,Si,nr)){Kl=!1;break}}return nr.delete(ct),nr.delete(Ut),Kl}function Hh(ct){return function(Ut,zn,Si){var Yr=zn(Ut);return Wh(Ut)?Yr:function(nr,Rs){for(var yo=-1,Ko=Rs.length,vo=nr.length;++yo<Ko;)nr[vo+yo]=Rs[yo];return nr}(Yr,Si(Ut))}(ct,yc,jh)}function wo(ct,Ut){var zn,Si,Yr=ct.__data__;return((Si=typeof(zn=Ut))=="string"||Si=="number"||Si=="symbol"||Si=="boolean"?zn!=="__proto__":zn===null)?Yr[typeof Ut=="string"?"string":"hash"]:Yr.map}function zu(ct,Ut){var zn=function(Si,Yr){return Si==null?void 0:Si[Yr]}(ct,Ut);return Mp(zn)?zn:void 0}Zl.prototype.clear=function(){this.__data__=Zr?Zr(null):{},this.size=0},Zl.prototype.delete=function(ct){var Ut=this.has(ct)&&delete this.__data__[ct];return this.size-=Ut?1:0,Ut},Zl.prototype.get=function(ct){var Ut=this.__data__;if(Zr){var zn=Ut[ct];return zn===ue?void 0:zn}return bs.call(Ut,ct)?Ut[ct]:void 0},Zl.prototype.has=function(ct){var Ut=this.__data__;return Zr?Ut[ct]!==void 0:bs.call(Ut,ct)},Zl.prototype.set=function(ct,Ut){var zn=this.__data__;return this.size+=this.has(ct)?0:1,zn[ct]=Zr&&Ut===void 0?ue:Ut,this},Na.prototype.clear=function(){this.__data__=[],this.size=0},Na.prototype.delete=function(ct){var Ut=this.__data__,zn=_c(Ut,ct);return!(zn<0)&&(zn==Ut.length-1?Ut.pop():nh.call(Ut,zn,1),--this.size,!0)},Na.prototype.get=function(ct){var Ut=this.__data__,zn=_c(Ut,ct);return zn<0?void 0:Ut[zn][1]},Na.prototype.has=function(ct){return _c(this.__data__,ct)>-1},Na.prototype.set=function(ct,Ut){var zn=this.__data__,Si=_c(zn,ct);return Si<0?(++this.size,zn.push([ct,Ut])):zn[Si][1]=Ut,this},Zi.prototype.clear=function(){this.size=0,this.__data__={hash:new Zl,map:new(Er||Na),string:new Zl}},Zi.prototype.delete=function(ct){var Ut=wo(this,ct).delete(ct);return this.size-=Ut?1:0,Ut},Zi.prototype.get=function(ct){return wo(this,ct).get(ct)},Zi.prototype.has=function(ct){return wo(this,ct).has(ct)},Zi.prototype.set=function(ct,Ut){var zn=wo(this,ct),Si=zn.size;return zn.set(ct,Ut),this.size+=zn.size==Si?0:1,this},gc.prototype.add=gc.prototype.push=function(ct){return this.__data__.set(ct,ue),this},gc.prototype.has=function(ct){return this.__data__.has(ct)},lu.prototype.clear=function(){this.__data__=new Na,this.size=0},lu.prototype.delete=function(ct){var Ut=this.__data__,zn=Ut.delete(ct);return this.size=Ut.size,zn},lu.prototype.get=function(ct){return this.__data__.get(ct)},lu.prototype.has=function(ct){return this.__data__.has(ct)},lu.prototype.set=function(ct,Ut){var zn=this.__data__;if(zn instanceof Na){var Si=zn.__data__;if(!Er||Si.length<199)return Si.push([ct,Ut]),this.size=++zn.size,this;zn=this.__data__=new Zi(Si)}return zn.set(ct,Ut),this.size=zn.size,this};var jh=Yo?function(ct){return ct==null?[]:(ct=Object(ct),function(Ut,zn){for(var Si=-1,Yr=Ut==null?0:Ut.length,nr=0,Rs=[];++Si<Yr;){var yo=Ut[Si];zn(yo,Si,Ut)&&(Rs[nr++]=yo)}return Rs}(Yo(ct),function(Ut){return Gf.call(ct,Ut)}))}:function(){return[]},Uu=Bu;function qh(ct,Ut){return!!(Ut=Ut??Fe)&&(typeof ct=="number"||da.test(ct))&&ct>-1&&ct%1==0&&ct<Ut}function Yl(ct){if(ct!=null){try{return Wl.call(ct)}catch{}try{return ct+""}catch{}}return""}function Lp(ct,Ut){return ct===Ut||ct!=ct&&Ut!=Ut}(Ou&&Uu(new Ou(new ArrayBuffer(1)))!=Fs||Er&&Uu(new Er)!=Pn||Oa&&Uu(Oa.resolve())!=vs||mc&&Uu(new mc)!=Cs||Nu&&Uu(new Nu)!=qi)&&(Uu=function(ct){var Ut=Bu(ct),zn=Ut==Fi?ct.constructor:void 0,Si=zn?Yl(zn):"";if(Si)switch(Si){case Xl:return Fs;case Uh:return Pn;case wp:return vs;case Vh:return Cs;case Sp:return qi}return Ut});var jf=Hf(function(){return arguments}())?Hf:function(ct){return Gu(ct)&&bs.call(ct,"callee")&&!Gf.call(ct,"callee")},Wh=Array.isArray,El=Ld||function(){return!1};function Vu(ct){if(!qf(ct))return!1;var Ut=Bu(ct);return Ut==Wn||Ut=="[object GeneratorFunction]"||Ut=="[object AsyncFunction]"||Ut=="[object Proxy]"}function Rp(ct){return typeof ct=="number"&&ct>-1&&ct%1==0&&ct<=Fe}function qf(ct){var Ut=typeof ct;return ct!=null&&(Ut=="object"||Ut=="function")}function Gu(ct){return ct!=null&&typeof ct=="object"}var Xh=Vr?function(ct){return function(Ut){return ct(Ut)}}(Vr):function(ct){return Gu(ct)&&Rp(ct.length)&&!!As[Bu(ct)]};function yc(ct){return(Ut=ct)!=null&&Rp(Ut.length)&&!Vu(Ut)?Cp(ct):Gh(ct);var Ut}O.exports=function(ct,Ut){return Ap(ct,Ut)}})({get exports(){return Pu},set exports(O){Pu=O}},Pu);var Ip=Pu;function pc(O,j){return O.length===j.length&&JSON.stringify(O.map(function(ue){return ue}).sort())===JSON.stringify(j.map(function(ue){return ue}).sort())}var An={Polygon:Mt,LineString:Gt,Point:Cn,MultiPolygon:En,MultiLineString:En,MultiPoint:En},hr=Object.freeze({__proto__:null,CommonSelectors:Rn,constrainFeatureMovement:ei,createMidPoint:ca,createSupplementaryPoints:Xo,createVertex:mo,doubleClickZoom:qs,euclideanDistance:Et,featuresAt:Pe,getFeatureAtAndSetCursors:it,isClick:Ue,isEventAtCoordinates:Gl,isTap:at,mapEventToBoundingBox:fe,ModeHandler:t,moveFeatures:Ye,sortFeatures:De,stringSetsAreEqual:pc,StringSet:le,theme:He,toDenseArray:Zn}),pr=function(O,j){var ue={options:O=function(et){et===void 0&&(et={});var Qe=Yn(et);return et.controls||(Qe.controls={}),et.displayControlsDefault===!1?Qe.controls=Yn(xm,et.controls):Qe.controls=Yn(dc,et.controls),(Qe=Yn(Ys,Qe)).styles=jl(Qe.styles,"cold").concat(jl(Qe.styles,"hot")),Qe}(O)};j=function(et,Qe){return Qe.modes=B,Qe.getFeatureIdsAt=function(st){return Pe.click({point:st},null,et).map(function(_n){return _n.properties.id})},Qe.getSelectedIds=function(){return et.store.getSelectedIds()},Qe.getSelected=function(){return{type:N.FEATURE_COLLECTION,features:et.store.getSelectedIds().map(function(st){return et.store.get(st)}).map(function(st){return st.toGeoJSON()})}},Qe.getSelectedPoints=function(){return{type:N.FEATURE_COLLECTION,features:et.store.getSelectedCoordinates().map(function(st){return{type:N.FEATURE,properties:{},geometry:{type:N.POINT,coordinates:st.coordinates}}})}},Qe.set=function(st){if(st.type===void 0||st.type!==N.FEATURE_COLLECTION||!Array.isArray(st.features))throw new Error("Invalid FeatureCollection");var _n=et.store.createRenderBatch(),mn=et.store.getAllIds().slice(),Wn=Qe.add(st),Pn=new le(Wn);return(mn=mn.filter(function(Fn){return!Pn.has(Fn)})).length&&Qe.delete(mn),_n(),Wn},Qe.add=function(st){var _n=JSON.parse(JSON.stringify(go(st))).features.map(function(mn){if(mn.id=mn.id||ke(),mn.geometry===null)throw new Error("Invalid geometry: null");if(et.store.get(mn.id)===void 0||et.store.get(mn.id).type!==mn.geometry.type){var Wn=An[mn.geometry.type];if(Wn===void 0)throw new Error("Invalid geometry type: "+mn.geometry.type+".");var Pn=new Wn(et,mn);et.store.add(Pn)}else{var Fn=et.store.get(mn.id);Fn.properties=mn.properties,Ip(Fn.getCoordinates(),mn.geometry.coordinates)||Fn.incomingCoords(mn.geometry.coordinates)}return mn.id});return et.store.render(),_n},Qe.get=function(st){var _n=et.store.get(st);if(_n)return _n.toGeoJSON()},Qe.getAll=function(){return{type:N.FEATURE_COLLECTION,features:et.store.getAll().map(function(st){return st.toGeoJSON()})}},Qe.delete=function(st){return et.store.delete(st,{silent:!0}),Qe.getMode()!==B.DIRECT_SELECT||et.store.getSelectedIds().length?et.store.render():et.events.changeMode(B.SIMPLE_SELECT,void 0,{silent:!0}),Qe},Qe.deleteAll=function(){return et.store.delete(et.store.getAllIds(),{silent:!0}),Qe.getMode()===B.DIRECT_SELECT?et.events.changeMode(B.SIMPLE_SELECT,void 0,{silent:!0}):et.store.render(),Qe},Qe.changeMode=function(st,_n){return _n===void 0&&(_n={}),st===B.SIMPLE_SELECT&&Qe.getMode()===B.SIMPLE_SELECT?(pc(_n.featureIds||[],et.store.getSelectedIds())||(et.store.setSelected(_n.featureIds,{silent:!0}),et.store.render()),Qe):(st===B.DIRECT_SELECT&&Qe.getMode()===B.DIRECT_SELECT&&_n.featureId===et.store.getSelectedIds()[0]||et.events.changeMode(st,_n,{silent:!0}),Qe)},Qe.getMode=function(){return et.events.getMode()},Qe.trash=function(){return et.events.trash({silent:!0}),Qe},Qe.combineFeatures=function(){return et.events.combineFeatures({silent:!0}),Qe},Qe.uncombineFeatures=function(){return et.events.uncombineFeatures({silent:!0}),Qe},Qe.setFeatureProperty=function(st,_n,mn){return et.store.setFeatureProperty(st,_n,mn),Qe},Qe}(ue,j),ue.api=j;var Fe=Ur(ue);return j.onAdd=Fe.onAdd,j.onRemove=Fe.onRemove,j.types=L,j.options=O,j};function Pa(O){pr(O,this)}return Pa.modes=Hl,Pa.constants=he,Pa.lib=hr,Pa})})(fL);var zP=fL.exports;const SC=ES(zP);function UP(){const{subscribe:n,set:e,update:t}=Eh([]);return{subscribe:n,set:e,add:i=>t(r=>(i.forEach(a=>{if(r.map(l=>l.id).includes(a.id)){const l=r.map(s=>s.id).filter(s=>s.startsWith(a.id)).length;a.id+=`_${l}`}}),[...r,...i])),getUniqueSourceId:i=>{const r=ap(G_);if(r.map(a=>a.id).includes(i)){const a=r.map(l=>l.id).filter(l=>l.startsWith(i)).length;i+=`_${a}`}return i}}}const G_=UP();var OE={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */OE.exports;(function(n,e){(function(){var t,i="4.17.21",r=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",s="Invalid `variable` option passed into `_.template`",d="__lodash_hash_undefined__",g=500,x="__lodash_placeholder__",I=1,A=2,L=4,N=1,B=2,F=1,z=2,V=4,Y=8,Q=16,J=32,he=64,ee=128,ae=256,De=512,fe=30,le="...",Be=800,Pe=16,Ce=1,it=2,Et=3,Ue=1/0,at=9007199254740991,ke=17976931348623157e292,Dt=0/0,fn=4294967295,Cn=fn-1,Gt=fn>>>1,Mt=[["ary",ee],["bind",F],["bindKey",z],["curry",Y],["curryRight",Q],["flip",De],["partial",J],["partialRight",he],["rearg",ae]],vt="[object Arguments]",xn="[object Array]",En="[object AsyncFunction]",_t="[object Boolean]",kt="[object Date]",Ct="[object DOMException]",Bt="[object Error]",Zn="[object Function]",mi="[object GeneratorFunction]",yn="[object Map]",Pt="[object Number]",Yn="[object Null]",si="[object Object]",Dr="[object Promise]",Ur="[object Proxy]",He="[object RegExp]",Jt="[object Set]",ui="[object String]",$e="[object Symbol]",kn="[object Undefined]",Ei="[object WeakMap]",ni="[object WeakSet]",Ln="[object ArrayBuffer]",ki="[object DataView]",Hs="[object Float32Array]",Xt="[object Float64Array]",Rn="[object Int8Array]",ti="[object Int16Array]",tr="[object Int32Array]",js="[object Uint8Array]",mo="[object Uint8ClampedArray]",ca="[object Uint16Array]",Xo="[object Uint32Array]",qs=/\b__p \+= '';/g,No=/\b(__p \+=) '' \+/g,Ja=/(__e\(.*?\)|\b__t\)) \+\n'';/g,go=/&(?:amp|lt|gt|quot|#39);/g,Ma=/[&<>"']/g,Vl=RegExp(go.source),Qa=RegExp(Ma.source),ha=/<%-([\s\S]+?)%>/g,$a=/<%([\s\S]+?)%>/g,Zs=/<%=([\s\S]+?)%>/g,La=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,so=/^\w*$/,Ra=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,we=/[\\^$.*+?()[\]{}|]/g,te=RegExp(we.source),re=/^\s+/,Ie=/\s/,Oe=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,We=/\{\n\/\* \[wrapped with (.+)\] \*/,ut=/,? & /,ot=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Je=/[()=,{}\[\]\/\s]/,pe=/\\(\\)?/g,nt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,be=/\w*$/,Ot=/^[-+]0x[0-9a-f]+$/i,On=/^0b[01]+$/i,ii=/^\[object .+?Constructor\]$/,ei=/^0o[0-7]+$/i,Ye=/^(?:0|[1-9]\d*)$/,Qn=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,xr=/($^)/,Ti=/['\n\r\u2028\u2029\\]/g,mr="\\ud800-\\udfff",yr="\\u0300-\\u036f",Gl="\\ufe20-\\ufe2f",fa="\\u20d0-\\u20ff",Rt=yr+Gl+fa,Hl="\\u2700-\\u27bf",Ys="a-z\\xdf-\\xf6\\xf8-\\xff",dc="\\xac\\xb1\\xd7\\xf7",xm="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",jl="\\u2000-\\u206f",Pu=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ip="A-Z\\xc0-\\xd6\\xd8-\\xde",pc="\\ufe0e\\ufe0f",An=dc+xm+jl+Pu,hr="['’]",pr="["+mr+"]",Pa="["+An+"]",O="["+Rt+"]",j="\\d+",ue="["+Hl+"]",Fe="["+Ys+"]",et="[^"+mr+An+j+Hl+Ys+Ip+"]",Qe="\\ud83c[\\udffb-\\udfff]",st="(?:"+O+"|"+Qe+")",_n="[^"+mr+"]",mn="(?:\\ud83c[\\udde6-\\uddff]){2}",Wn="[\\ud800-\\udbff][\\udc00-\\udfff]",Pn="["+Ip+"]",Fn="\\u200d",Fi="(?:"+Fe+"|"+et+")",vs="(?:"+Pn+"|"+et+")",zi="(?:"+hr+"(?:d|ll|m|re|s|t|ve))?",Cs="(?:"+hr+"(?:D|LL|M|RE|S|T|VE))?",nn=st+"?",Kn="["+pc+"]?",qi="(?:"+Fn+"(?:"+[_n,mn,Wn].join("|")+")"+Kn+nn+")*",oo="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Fs="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Zo=Kn+nn+qi,da="(?:"+[ue,mn,Wn].join("|")+")"+Zo,As="(?:"+[_n+O+"?",O,mn,Wn,pr].join("|")+")",Bf=RegExp(hr,"g"),_o=RegExp(O,"g"),pa=RegExp(Qe+"(?="+Qe+")|"+As+Zo,"g"),Cd=RegExp([Pn+"?"+Fe+"+"+zi+"(?="+[Pa,Pn,"$"].join("|")+")",vs+"+"+Cs+"(?="+[Pa,Pn+Fi,"$"].join("|")+")",Pn+"?"+Fi+"+"+zi,Pn+"+"+Cs,Fs,oo,j,da].join("|"),"g"),kh=RegExp("["+Fn+mr+Rt+pc+"]"),ko=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Fh=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Qc=-1,Vr={};Vr[Hs]=Vr[Xt]=Vr[Rn]=Vr[ti]=Vr[tr]=Vr[js]=Vr[mo]=Vr[ca]=Vr[Xo]=!0,Vr[vt]=Vr[xn]=Vr[Ln]=Vr[_t]=Vr[ki]=Vr[kt]=Vr[Bt]=Vr[Zn]=Vr[yn]=Vr[Pt]=Vr[si]=Vr[He]=Vr[Jt]=Vr[ui]=Vr[Ei]=!1;var rs={};rs[vt]=rs[xn]=rs[Ln]=rs[ki]=rs[_t]=rs[kt]=rs[Hs]=rs[Xt]=rs[Rn]=rs[ti]=rs[tr]=rs[yn]=rs[Pt]=rs[si]=rs[He]=rs[Jt]=rs[ui]=rs[$e]=rs[js]=rs[mo]=rs[ca]=rs[Xo]=!0,rs[Bt]=rs[Zn]=rs[Ei]=!1;var Ad={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},wg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Md={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},$c={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Tp=parseFloat,zf=parseInt,eh=typeof ld=="object"&&ld&&ld.Object===Object&&ld,ql=typeof self=="object"&&self&&self.Object===Object&&self,Ks=eh||ql||Function("return this")(),Wl=e&&!e.nodeType&&e,bs=Wl&&!0&&n&&!n.nodeType&&n,th=bs&&bs.exports===Wl,Uf=th&&eh.process,el=function(){try{var lt=bs&&bs.require&&bs.require("util").types;return lt||Uf&&Uf.binding&&Uf.binding("util")}catch{}}(),Bh=el&&el.isArrayBuffer,zh=el&&el.isDate,Vf=el&&el.isMap,Gf=el&&el.isRegExp,nh=el&&el.isSet,Du=el&&el.isTypedArray;function Yo(lt,Ht,Nt){switch(Nt.length){case 0:return lt.call(Ht);case 1:return lt.call(Ht,Nt[0]);case 2:return lt.call(Ht,Nt[0],Nt[1]);case 3:return lt.call(Ht,Nt[0],Nt[1],Nt[2])}return lt.apply(Ht,Nt)}function Ld(lt,Ht,Nt,oi){for(var Ui=-1,Or=lt==null?0:lt.length;++Ui<Or;){var Js=lt[Ui];Ht(oi,Js,Nt(Js),lt)}return oi}function Da(lt,Ht){for(var Nt=-1,oi=lt==null?0:lt.length;++Nt<oi&&Ht(lt[Nt],Nt,lt)!==!1;);return lt}function Ou(lt,Ht){for(var Nt=lt==null?0:lt.length;Nt--&&Ht(lt[Nt],Nt,lt)!==!1;);return lt}function Er(lt,Ht){for(var Nt=-1,oi=lt==null?0:lt.length;++Nt<oi;)if(!Ht(lt[Nt],Nt,lt))return!1;return!0}function Oa(lt,Ht){for(var Nt=-1,oi=lt==null?0:lt.length,Ui=0,Or=[];++Nt<oi;){var Js=lt[Nt];Ht(Js,Nt,lt)&&(Or[Ui++]=Js)}return Or}function mc(lt,Ht){var Nt=lt==null?0:lt.length;return!!Nt&&Zi(lt,Ht,0)>-1}function Nu(lt,Ht,Nt){for(var oi=-1,Ui=lt==null?0:lt.length;++oi<Ui;)if(Nt(Ht,lt[oi]))return!0;return!1}function Zr(lt,Ht){for(var Nt=-1,oi=lt==null?0:lt.length,Ui=Array(oi);++Nt<oi;)Ui[Nt]=Ht(lt[Nt],Nt,lt);return Ui}function Xl(lt,Ht){for(var Nt=-1,oi=Ht.length,Ui=lt.length;++Nt<oi;)lt[Ui+Nt]=Ht[Nt];return lt}function Uh(lt,Ht,Nt,oi){var Ui=-1,Or=lt==null?0:lt.length;for(oi&&Or&&(Nt=lt[++Ui]);++Ui<Or;)Nt=Ht(Nt,lt[Ui],Ui,lt);return Nt}function wp(lt,Ht,Nt,oi){var Ui=lt==null?0:lt.length;for(oi&&Ui&&(Nt=lt[--Ui]);Ui--;)Nt=Ht(Nt,lt[Ui],Ui,lt);return Nt}function Vh(lt,Ht){for(var Nt=-1,oi=lt==null?0:lt.length;++Nt<oi;)if(Ht(lt[Nt],Nt,lt))return!0;return!1}var Sp=_c("length");function ku(lt){return lt.split("")}function Fu(lt){return lt.match(ot)||[]}function Zl(lt,Ht,Nt){var oi;return Nt(lt,function(Ui,Or,Js){if(Ht(Ui,Or,Js))return oi=Or,!1}),oi}function Na(lt,Ht,Nt,oi){for(var Ui=lt.length,Or=Nt+(oi?1:-1);oi?Or--:++Or<Ui;)if(Ht(lt[Or],Or,lt))return Or;return-1}function Zi(lt,Ht,Nt){return Ht===Ht?zn(lt,Ht,Nt):Na(lt,lu,Nt)}function gc(lt,Ht,Nt,oi){for(var Ui=Nt-1,Or=lt.length;++Ui<Or;)if(oi(lt[Ui],Ht))return Ui;return-1}function lu(lt){return lt!==lt}function Cp(lt,Ht){var Nt=lt==null?0:lt.length;return Nt?Mp(lt,Ht)/Nt:Dt}function _c(lt){return function(Ht){return Ht==null?t:Ht[lt]}}function Bu(lt){return function(Ht){return lt==null?t:lt[Ht]}}function Hf(lt,Ht,Nt,oi,Ui){return Ui(lt,function(Or,Js,us){Nt=oi?(oi=!1,Or):Ht(Nt,Or,Js,us)}),Nt}function Ap(lt,Ht){var Nt=lt.length;for(lt.sort(Ht);Nt--;)lt[Nt]=lt[Nt].value;return lt}function Mp(lt,Ht){for(var Nt,oi=-1,Ui=lt.length;++oi<Ui;){var Or=Ht(lt[oi]);Or!==t&&(Nt=Nt===t?Or:Nt+Or)}return Nt}function Gh(lt,Ht){for(var Nt=-1,oi=Array(lt);++Nt<lt;)oi[Nt]=Ht(Nt);return oi}function Rd(lt,Ht){return Zr(Ht,function(Nt){return[Nt,lt[Nt]]})}function Hh(lt){return lt&&lt.slice(0,Rs(lt)+1).replace(re,"")}function wo(lt){return function(Ht){return lt(Ht)}}function zu(lt,Ht){return Zr(Ht,function(Nt){return lt[Nt]})}function jh(lt,Ht){return lt.has(Ht)}function Uu(lt,Ht){for(var Nt=-1,oi=lt.length;++Nt<oi&&Zi(Ht,lt[Nt],0)>-1;);return Nt}function qh(lt,Ht){for(var Nt=lt.length;Nt--&&Zi(Ht,lt[Nt],0)>-1;);return Nt}function Yl(lt,Ht){for(var Nt=lt.length,oi=0;Nt--;)lt[Nt]===Ht&&++oi;return oi}var Lp=Bu(Ad),jf=Bu(wg);function Wh(lt){return"\\"+$c[lt]}function El(lt,Ht){return lt==null?t:lt[Ht]}function Vu(lt){return kh.test(lt)}function Rp(lt){return ko.test(lt)}function qf(lt){for(var Ht,Nt=[];!(Ht=lt.next()).done;)Nt.push(Ht.value);return Nt}function Gu(lt){var Ht=-1,Nt=Array(lt.size);return lt.forEach(function(oi,Ui){Nt[++Ht]=[Ui,oi]}),Nt}function Xh(lt,Ht){return function(Nt){return lt(Ht(Nt))}}function yc(lt,Ht){for(var Nt=-1,oi=lt.length,Ui=0,Or=[];++Nt<oi;){var Js=lt[Nt];(Js===Ht||Js===x)&&(lt[Nt]=x,Or[Ui++]=Nt)}return Or}function ct(lt){var Ht=-1,Nt=Array(lt.size);return lt.forEach(function(oi){Nt[++Ht]=oi}),Nt}function Ut(lt){var Ht=-1,Nt=Array(lt.size);return lt.forEach(function(oi){Nt[++Ht]=[oi,oi]}),Nt}function zn(lt,Ht,Nt){for(var oi=Nt-1,Ui=lt.length;++oi<Ui;)if(lt[oi]===Ht)return oi;return-1}function Si(lt,Ht,Nt){for(var oi=Nt+1;oi--;)if(lt[oi]===Ht)return oi;return oi}function Yr(lt){return Vu(lt)?Ko(lt):Sp(lt)}function nr(lt){return Vu(lt)?vo(lt):ku(lt)}function Rs(lt){for(var Ht=lt.length;Ht--&&Ie.test(lt.charAt(Ht)););return Ht}var yo=Bu(Md);function Ko(lt){for(var Ht=pa.lastIndex=0;pa.test(lt);)++Ht;return Ht}function vo(lt){return lt.match(pa)||[]}function ao(lt){return lt.match(Cd)||[]}var Kl=function lt(Ht){Ht=Ht==null?Ks:So.defaults(Ks.Object(),Ht,So.pick(Ks,Fh));var Nt=Ht.Array,oi=Ht.Date,Ui=Ht.Error,Or=Ht.Function,Js=Ht.Math,us=Ht.Object,Pd=Ht.RegExp,ms=Ht.String,gr=Ht.TypeError,Hu=Nt.prototype,ma=Or.prototype,tl=us.prototype,Co=Ht["__core-js_shared__"],Jo=ma.toString,_r=tl.hasOwnProperty,nl=0,vc=function(){var _=/[^.]+$/.exec(Co&&Co.keys&&Co.keys.IE_PROTO||"");return _?"Symbol(src)_1."+_:""}(),$i=tl.toString,uu=Jo.call(us),Em=Ks._,Zh=Pd("^"+Jo.call(_r).replace(we,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),cu=th?Ht.Buffer:t,il=Ht.Symbol,bc=Ht.Uint8Array,Yh=cu?cu.allocUnsafe:t,xc=Xh(us.getPrototypeOf,us),Ec=us.create,Wf=tl.propertyIsEnumerable,ih=Hu.splice,Pp=il?il.isConcatSpreadable:t,ju=il?il.iterator:t,Jl=il?il.toStringTag:t,Kh=function(){try{var _=Bo(us,"defineProperty");return _({},"",{}),_}catch{}}(),Dp=Ht.clearTimeout!==Ks.clearTimeout&&Ht.clearTimeout,Vn=oi&&oi.now!==Ks.Date.now&&oi.now,hu=Ht.setTimeout!==Ks.setTimeout&&Ht.setTimeout,Op=Js.ceil,Dd=Js.floor,Xf=us.getOwnPropertySymbols,Od=cu?cu.isBuffer:t,Sg=Ht.isFinite,Im=Hu.join,Cg=Xh(us.keys,us),bo=Js.max,Fo=Js.min,Np=oi.now,aa=Ht.parseInt,kp=Js.random,f0=Hu.reverse,Tm=Bo(Ht,"DataView"),Jh=Bo(Ht,"Map"),Fp=Bo(Ht,"Promise"),rh=Bo(Ht,"Set"),Nd=Bo(Ht,"WeakMap"),Ic=Bo(us,"create"),kd=Nd&&new Nd,Zf={},wm=Zp(Tm),Q_=Zp(Jh),Ag=Zp(Fp),Mg=Zp(rh),Fd=Zp(Nd),Yf=il?il.prototype:t,sh=Yf?Yf.valueOf:t,Lg=Yf?Yf.toString:t;function ge(_){if(eo(_)&&!fr(_)&&!(_ instanceof Yi)){if(_ instanceof rl)return _;if(_r.call(_,"__wrapped__"))return Ty(_)}return new rl(_)}var Qh=function(){function _(){}return function(T){if(!Bs(T))return{};if(Ec)return Ec(T);_.prototype=T;var D=new _;return _.prototype=t,D}}();function Bp(){}function rl(_,T){this.__wrapped__=_,this.__actions__=[],this.__chain__=!!T,this.__index__=0,this.__values__=t}ge.templateSettings={escape:ha,evaluate:$a,interpolate:Zs,variable:"",imports:{_:ge}},ge.prototype=Bp.prototype,ge.prototype.constructor=ge,rl.prototype=Qh(Bp.prototype),rl.prototype.constructor=rl;function Yi(_){this.__wrapped__=_,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=fn,this.__views__=[]}function d0(){var _=new Yi(this.__wrapped__);return _.__actions__=ya(this.__actions__),_.__dir__=this.__dir__,_.__filtered__=this.__filtered__,_.__iteratees__=ya(this.__iteratees__),_.__takeCount__=this.__takeCount__,_.__views__=ya(this.__views__),_}function $_(){if(this.__filtered__){var _=new Yi(this);_.__dir__=-1,_.__filtered__=!0}else _=this.clone(),_.__dir__*=-1;return _}function p0(){var _=this.__wrapped__.value(),T=this.__dir__,D=fr(_),Z=T<0,oe=D?_.length:0,Ee=jg(0,oe,this.__views__),Ge=Ee.start,rt=Ee.end,pt=rt-Ge,rn=Z?rt:Ge-1,cn=this.__iteratees__,wn=cn.length,ri=0,Ci=Fo(pt,this.__takeCount__);if(!D||!Z&&oe==pt&&Ci==pt)return Vd(_,this.__actions__);var er=[];e:for(;pt--&&ri<Ci;){rn+=T;for(var Sr=-1,ir=_[rn];++Sr<wn;){var Gr=cn[Sr],Kr=Gr.iteratee,xu=Gr.type,Sl=Kr(ir);if(xu==it)ir=Sl;else if(!Sl){if(xu==Ce)continue e;break e}}er[ri++]=ir}return er}Yi.prototype=Qh(Bp.prototype),Yi.prototype.constructor=Yi;function $h(_){var T=-1,D=_==null?0:_.length;for(this.clear();++T<D;){var Z=_[T];this.set(Z[0],Z[1])}}function oh(){this.__data__=Ic?Ic(null):{},this.size=0}function ey(_){var T=this.has(_)&&delete this.__data__[_];return this.size-=T?1:0,T}function Bd(_){var T=this.__data__;if(Ic){var D=T[_];return D===d?t:D}return _r.call(T,_)?T[_]:t}function Tc(_){var T=this.__data__;return Ic?T[_]!==t:_r.call(T,_)}function Sm(_,T){var D=this.__data__;return this.size+=this.has(_)?0:1,D[_]=Ic&&T===t?d:T,this}$h.prototype.clear=oh,$h.prototype.delete=ey,$h.prototype.get=Bd,$h.prototype.has=Tc,$h.prototype.set=Sm;function Gn(_){var T=-1,D=_==null?0:_.length;for(this.clear();++T<D;){var Z=_[T];this.set(Z[0],Z[1])}}function ty(){this.__data__=[],this.size=0}function zp(_){var T=this.__data__,D=tf(T,_);if(D<0)return!1;var Z=T.length-1;return D==Z?T.pop():ih.call(T,D,1),--this.size,!0}function Up(_){var T=this.__data__,D=tf(T,_);return D<0?t:T[D][1]}function Vp(_){return tf(this.__data__,_)>-1}function Gp(_,T){var D=this.__data__,Z=tf(D,_);return Z<0?(++this.size,D.push([_,T])):D[Z][1]=T,this}Gn.prototype.clear=ty,Gn.prototype.delete=zp,Gn.prototype.get=Up,Gn.prototype.has=Vp,Gn.prototype.set=Gp;function wc(_){var T=-1,D=_==null?0:_.length;for(this.clear();++T<D;){var Z=_[T];this.set(Z[0],Z[1])}}function Rg(){this.size=0,this.__data__={hash:new $h,map:new(Jh||Gn),string:new $h}}function ny(_){var T=Il(this,_).delete(_);return this.size-=T?1:0,T}function Pg(_){return Il(this,_).get(_)}function Dg(_){return Il(this,_).has(_)}function Hp(_,T){var D=Il(this,_),Z=D.size;return D.set(_,T),this.size+=D.size==Z?0:1,this}wc.prototype.clear=Rg,wc.prototype.delete=ny,wc.prototype.get=Pg,wc.prototype.has=Dg,wc.prototype.set=Hp;function Sc(_){var T=-1,D=_==null?0:_.length;for(this.__data__=new wc;++T<D;)this.add(_[T])}function zd(_){return this.__data__.set(_,d),this}function Cm(_){return this.__data__.has(_)}Sc.prototype.add=Sc.prototype.push=zd,Sc.prototype.has=Cm;function fu(_){var T=this.__data__=new Gn(_);this.size=T.size}function iy(){this.__data__=new Gn,this.size=0}function Og(_){var T=this.__data__,D=T.delete(_);return this.size=T.size,D}function ry(_){return this.__data__.get(_)}function sy(_){return this.__data__.has(_)}function oy(_,T){var D=this.__data__;if(D instanceof Gn){var Z=D.__data__;if(!Jh||Z.length<r-1)return Z.push([_,T]),this.size=++D.size,this;D=this.__data__=new wc(Z)}return D.set(_,T),this.size=D.size,this}fu.prototype.clear=iy,fu.prototype.delete=Og,fu.prototype.get=ry,fu.prototype.has=sy,fu.prototype.set=oy;function Am(_,T){var D=fr(_),Z=!D&&Xd(_),oe=!D&&!Z&&nd(_),Ee=!D&&!Z&&!oe&&Vm(_),Ge=D||Z||oe||Ee,rt=Ge?Gh(_.length,ms):[],pt=rt.length;for(var rn in _)(T||_r.call(_,rn))&&!(Ge&&(rn=="length"||oe&&(rn=="offset"||rn=="parent")||Ee&&(rn=="buffer"||rn=="byteLength"||rn=="byteOffset")||sf(rn,pt)))&&rt.push(rn);return rt}function Ng(_){var T=_.length;return T?_[Cc(0,T-1)]:t}function ay(_,T){return af(ya(_),C(T,0,_.length))}function ly(_){return af(ya(_))}function Mm(_,T,D){(D!==t&&!vh(_[T],D)||D===t&&!(T in _))&&b(_,T,D)}function ef(_,T,D){var Z=_[T];(!(_r.call(_,T)&&vh(Z,D))||D===t&&!(T in _))&&b(_,T,D)}function tf(_,T){for(var D=_.length;D--;)if(vh(_[D][0],T))return D;return-1}function y(_,T,D,Z){return ne(_,function(oe,Ee,Ge){T(Z,oe,D(oe),Ge)}),Z}function h(_,T){return _&&ka(T,Ao(T),_)}function p(_,T){return _&&ka(T,Ql(T),_)}function b(_,T,D){T=="__proto__"&&Kh?Kh(_,T,{configurable:!0,enumerable:!0,value:D,writable:!0}):_[T]=D}function w(_,T){for(var D=-1,Z=T.length,oe=Nt(Z),Ee=_==null;++D<Z;)oe[D]=Ee?t:J0(_,T[D]);return oe}function C(_,T,D){return _===_&&(D!==t&&(_=_<=D?_:D),T!==t&&(_=_>=T?_:T)),_}function P(_,T,D,Z,oe,Ee){var Ge,rt=T&I,pt=T&A,rn=T&L;if(D&&(Ge=oe?D(_,Z,oe,Ee):D(_)),Ge!==t)return Ge;if(!Bs(_))return _;var cn=fr(_);if(cn){if(Ge=OI(_),!rt)return ya(_,Ge)}else{var wn=ll(_),ri=wn==Zn||wn==mi;if(nd(_))return Bg(_,rt);if(wn==si||wn==vt||ri&&!oe){if(Ge=pt||ri?{}:E0(_),!rt)return pt?Hd(_,p(Ge,_)):uh(_,h(Ge,_))}else{if(!rs[wn])return oe?_:{};Ge=Fb(_,wn,rt)}}Ee||(Ee=new fu);var Ci=Ee.get(_);if(Ci)return Ci;Ee.set(_,Ge),Y0(_)?_.forEach(function(ir){Ge.add(P(ir,T,D,ir,_,Ee))}):X0(_)&&_.forEach(function(ir,Gr){Ge.set(Gr,P(ir,T,D,Gr,_,Ee))});var er=rn?pt?ph:Wd:pt?Ql:Ao,Sr=cn?t:er(_);return Da(Sr||_,function(ir,Gr){Sr&&(Gr=ir,ir=_[Gr]),ef(Ge,Gr,P(ir,T,D,Gr,_,Ee))}),Ge}function k(_){var T=Ao(_);return function(D){return G(D,_,T)}}function G(_,T,D){var Z=D.length;if(_==null)return!Z;for(_=us(_);Z--;){var oe=D[Z],Ee=T[oe],Ge=_[oe];if(Ge===t&&!(oe in _)||!Ee(Ge))return!1}return!0}function W(_,T,D){if(typeof _!="function")throw new gr(l);return Dm(function(){_.apply(t,D)},T)}function X(_,T,D,Z){var oe=-1,Ee=mc,Ge=!0,rt=_.length,pt=[],rn=T.length;if(!rt)return pt;D&&(T=Zr(T,wo(D))),Z?(Ee=Nu,Ge=!1):T.length>=r&&(Ee=jh,Ge=!1,T=new Sc(T));e:for(;++oe<rt;){var cn=_[oe],wn=D==null?cn:D(cn);if(cn=Z||cn!==0?cn:0,Ge&&wn===wn){for(var ri=rn;ri--;)if(T[ri]===wn)continue e;pt.push(cn)}else Ee(T,wn,Z)||pt.push(cn)}return pt}var ne=Cb(Re),ce=Cb(Xe,!0);function ye(_,T){var D=!0;return ne(_,function(Z,oe,Ee){return D=!!T(Z,oe,Ee),D}),D}function _e(_,T,D){for(var Z=-1,oe=_.length;++Z<oe;){var Ee=_[Z],Ge=T(Ee);if(Ge!=null&&(rt===t?Ge===Ge&&!Yu(Ge):D(Ge,rt)))var rt=Ge,pt=Ee}return pt}function ve(_,T,D,Z){var oe=_.length;for(D=Ir(D),D<0&&(D=-D>oe?0:oe+D),Z=Z===t||Z>oe?oe:Ir(Z),Z<0&&(Z+=oe),Z=D>Z?0:r_(Z);D<Z;)_[D++]=T;return _}function xe(_,T){var D=[];return ne(_,function(Z,oe,Ee){T(Z,oe,Ee)&&D.push(Z)}),D}function se(_,T,D,Z,oe){var Ee=-1,Ge=_.length;for(D||(D=Bb),oe||(oe=[]);++Ee<Ge;){var rt=_[Ee];T>0&&D(rt)?T>1?se(rt,T-1,D,Z,oe):Xl(oe,rt):Z||(oe[oe.length]=rt)}return oe}var Le=Ab(),Ae=Ab(!0);function Re(_,T){return _&&Le(_,T,Ao)}function Xe(_,T){return _&&Ae(_,T,Ao)}function je(_,T){return Oa(T,function(D){return cf(_[D])})}function Ke(_,T){T=Gd(T,_);for(var D=0,Z=T.length;_!=null&&D<Z;)_=_[_h(T[D++])];return D&&D==Z?_:t}function ft(_,T,D){var Z=T(_);return fr(_)?Z:Xl(Z,D(_))}function dt(_){return _==null?_===t?kn:Yn:Jl&&Jl in us(_)?Mc(_):Xp(_)}function xt(_,T){return _>T}function Tn(_,T){return _!=null&&_r.call(_,T)}function gt(_,T){return _!=null&&T in us(_)}function Zt(_,T,D){return _>=Fo(T,D)&&_<bo(T,D)}function St(_,T,D){for(var Z=D?Nu:mc,oe=_[0].length,Ee=_.length,Ge=Ee,rt=Nt(Ee),pt=1/0,rn=[];Ge--;){var cn=_[Ge];Ge&&T&&(cn=Zr(cn,wo(T))),pt=Fo(cn.length,pt),rt[Ge]=!D&&(T||oe>=120&&cn.length>=120)?new Sc(Ge&&cn):t}cn=_[0];var wn=-1,ri=rt[0];e:for(;++wn<oe&&rn.length<pt;){var Ci=cn[wn],er=T?T(Ci):Ci;if(Ci=D||Ci!==0?Ci:0,!(ri?jh(ri,er):Z(rn,er,D))){for(Ge=Ee;--Ge;){var Sr=rt[Ge];if(!(Sr?jh(Sr,er):Z(_[Ge],er,D)))continue e}ri&&ri.push(er),rn.push(Ci)}}return rn}function un(_,T,D,Z){return Re(_,function(oe,Ee,Ge){T(Z,D(oe),Ee,Ge)}),Z}function yt(_,T,D){T=Gd(T,_),_=Xu(_,T);var Z=_==null?_:_[_h(Ds(T))];return Z==null?t:Yo(Z,_,D)}function ht(_){return eo(_)&&dt(_)==vt}function Tt(_){return eo(_)&&dt(_)==Ln}function en(_){return eo(_)&&dt(_)==kt}function ln(_,T,D,Z,oe){return _===T?!0:_==null||T==null||!eo(_)&&!eo(T)?_!==_&&T!==T:ci(_,T,D,Z,ln,oe)}function ci(_,T,D,Z,oe,Ee){var Ge=fr(_),rt=fr(T),pt=Ge?xn:ll(_),rn=rt?xn:ll(T);pt=pt==vt?si:pt,rn=rn==vt?si:rn;var cn=pt==si,wn=rn==si,ri=pt==rn;if(ri&&nd(_)){if(!nd(T))return!1;Ge=!0,cn=!1}if(ri&&!cn)return Ee||(Ee=new fu),Ge||Vm(_)?Ob(_,T,D,Z,oe,Ee):x0(_,T,pt,D,Z,oe,Ee);if(!(D&N)){var Ci=cn&&_r.call(_,"__wrapped__"),er=wn&&_r.call(T,"__wrapped__");if(Ci||er){var Sr=Ci?_.value():_,ir=er?T.value():T;return Ee||(Ee=new fu),oe(Sr,ir,D,Z,Ee)}}return ri?(Ee||(Ee=new fu),Nb(_,T,D,Z,oe,Ee)):!1}function ur(_){return eo(_)&&ll(_)==yn}function $n(_,T,D,Z){var oe=D.length,Ee=oe,Ge=!Z;if(_==null)return!Ee;for(_=us(_);oe--;){var rt=D[oe];if(Ge&&rt[2]?rt[1]!==_[rt[0]]:!(rt[0]in _))return!1}for(;++oe<Ee;){rt=D[oe];var pt=rt[0],rn=_[pt],cn=rt[1];if(Ge&&rt[2]){if(rn===t&&!(pt in _))return!1}else{var wn=new fu;if(Z)var ri=Z(rn,cn,pt,_,T,wn);if(!(ri===t?ln(cn,rn,N|B,Z,wn):ri))return!1}}return!0}function Hn(_){if(!Bs(_)||zb(_))return!1;var T=cf(_)?Zh:ii;return T.test(Zp(_))}function di(_){return eo(_)&&dt(_)==He}function vr(_){return eo(_)&&ll(_)==Jt}function bi(_){return eo(_)&&Zd(_.length)&&!!Vr[dt(_)]}function Wr(_){return typeof _=="function"?_:_==null?bu:typeof _=="object"?fr(_)?du(_[0],_[1]):sl(_):a1(_)}function $r(_){if(!ed(_))return Cg(_);var T=[];for(var D in us(_))_r.call(_,D)&&D!="constructor"&&T.push(D);return T}function xs(_){if(!Bs(_))return of(_);var T=ed(_),D=[];for(var Z in _)Z=="constructor"&&(T||!_r.call(_,Z))||D.push(Z);return D}function ss(_,T){return _<T}function xo(_,T){var D=-1,Z=vu(_)?Nt(_.length):[];return ne(_,function(oe,Ee,Ge){Z[++D]=T(oe,Ee,Ge)}),Z}function sl(_){var T=qp(_);return T.length==1&&T[0][2]?xy(T[0][0],T[0][1]):function(D){return D===_||$n(D,_,T)}}function du(_,T){return vy(_)&&by(T)?xy(_h(_),T):function(D){var Z=J0(D,_);return Z===t&&Z===T?Q0(D,_):ln(T,Z,N|B)}}function pu(_,T,D,Z,oe){_!==T&&Le(T,function(Ee,Ge){if(oe||(oe=new fu),Bs(Ee))Ps(_,T,Ge,D,pu,Z,oe);else{var rt=Z?Z(w0(_,Ge),Ee,Ge+"",_,T,oe):t;rt===t&&(rt=Ee),Mm(_,Ge,rt)}},Ql)}function Ps(_,T,D,Z,oe,Ee,Ge){var rt=w0(_,D),pt=w0(T,D),rn=Ge.get(pt);if(rn){Mm(_,D,rn);return}var cn=Ee?Ee(rt,pt,D+"",_,T,Ge):t,wn=cn===t;if(wn){var ri=fr(pt),Ci=!ri&&nd(pt),er=!ri&&!Ci&&Vm(pt);cn=pt,ri||Ci||er?fr(rt)?cn=rt:zo(rt)?cn=ya(rt):Ci?(wn=!1,cn=Bg(pt,!0)):er?(wn=!1,cn=wb(pt,!0)):cn=[]:Yd(pt)||Xd(pt)?(cn=rt,Xd(rt)?cn=Sx(rt):(!Bs(rt)||cf(rt))&&(cn=E0(pt))):wn=!1}wn&&(Ge.set(pt,cn),oe(cn,pt,Z,Ee,Ge),Ge.delete(pt)),Mm(_,D,cn)}function cs(_,T){var D=_.length;if(D)return T+=T<0?D:0,sf(T,D)?_[T]:t}function Nr(_,T,D){T.length?T=Zr(T,function(Ee){return fr(Ee)?function(Ge){return Ke(Ge,Ee.length===1?Ee[0]:Ee)}:Ee}):T=[bu];var Z=-1;T=Zr(T,wo(Vi()));var oe=xo(_,function(Ee,Ge,rt){var pt=Zr(T,function(rn){return rn(Ee)});return{criteria:pt,index:++Z,value:Ee}});return Ap(oe,function(Ee,Ge){return PI(Ee,Ge,D)})}function lo(_,T){return ga(_,T,function(D,Z){return Q0(_,Z)})}function ga(_,T,D){for(var Z=-1,oe=T.length,Ee={};++Z<oe;){var Ge=T[Z],rt=Ke(_,Ge);D(rt,Ge)&&mu(Ee,Gd(Ge,_),rt)}return Ee}function Ms(_){return function(T){return Ke(T,_)}}function la(_,T,D,Z){var oe=Z?gc:Zi,Ee=-1,Ge=T.length,rt=_;for(_===T&&(T=ya(T)),D&&(rt=Zr(_,wo(D)));++Ee<Ge;)for(var pt=0,rn=T[Ee],cn=D?D(rn):rn;(pt=oe(rt,cn,pt,Z))>-1;)rt!==_&&ih.call(rt,pt,1),ih.call(_,pt,1);return _}function _a(_,T){for(var D=_?T.length:0,Z=D-1;D--;){var oe=T[D];if(D==Z||oe!==Ee){var Ee=oe;sf(oe)?ih.call(_,oe,1):cy(_,oe)}}return _}function Cc(_,T){return _+Dd(kp()*(T-_+1))}function Ud(_,T,D,Z){for(var oe=-1,Ee=bo(Op((T-_)/(D||1)),0),Ge=Nt(Ee);Ee--;)Ge[Z?Ee:++oe]=_,_+=D;return Ge}function ol(_,T){var D="";if(!_||T<1||T>at)return D;do T%2&&(D+=_),T=Dd(T/2),T&&(_+=_);while(T);return D}function Ki(_,T){return S0(Pm(_,T,bu),_+"")}function ah(_){return Ng(Jd(_))}function nf(_,T){var D=Jd(_);return af(D,C(T,0,D.length))}function mu(_,T,D,Z){if(!Bs(_))return _;T=Gd(T,_);for(var oe=-1,Ee=T.length,Ge=Ee-1,rt=_;rt!=null&&++oe<Ee;){var pt=_h(T[oe]),rn=D;if(pt==="__proto__"||pt==="constructor"||pt==="prototype")return _;if(oe!=Ge){var cn=rt[pt];rn=Z?Z(cn,pt,rt):t,rn===t&&(rn=Bs(cn)?cn:sf(T[oe+1])?[]:{})}ef(rt,pt,rn),rt=rt[pt]}return _}var Kf=kd?function(_,T){return kd.set(_,T),_}:bu,bb=Kh?function(_,T){return Kh(_,"toString",{configurable:!0,enumerable:!1,value:a_(T),writable:!0})}:bu;function m0(_){return af(Jd(_))}function qu(_,T,D){var Z=-1,oe=_.length;T<0&&(T=-T>oe?0:oe+T),D=D>oe?oe:D,D<0&&(D+=oe),oe=T>D?0:D-T>>>0,T>>>=0;for(var Ee=Nt(oe);++Z<oe;)Ee[Z]=_[Z+T];return Ee}function xb(_,T){var D;return ne(_,function(Z,oe,Ee){return D=T(Z,oe,Ee),!D}),!!D}function kg(_,T,D){var Z=0,oe=_==null?Z:_.length;if(typeof T=="number"&&T===T&&oe<=Gt){for(;Z<oe;){var Ee=Z+oe>>>1,Ge=_[Ee];Ge!==null&&!Yu(Ge)&&(D?Ge<=T:Ge<T)?Z=Ee+1:oe=Ee}return oe}return uy(_,T,bu,D)}function uy(_,T,D,Z){var oe=0,Ee=_==null?0:_.length;if(Ee===0)return 0;T=D(T);for(var Ge=T!==T,rt=T===null,pt=Yu(T),rn=T===t;oe<Ee;){var cn=Dd((oe+Ee)/2),wn=D(_[cn]),ri=wn!==t,Ci=wn===null,er=wn===wn,Sr=Yu(wn);if(Ge)var ir=Z||er;else rn?ir=er&&(Z||ri):rt?ir=er&&ri&&(Z||!Ci):pt?ir=er&&ri&&!Ci&&(Z||!Sr):Ci||Sr?ir=!1:ir=Z?wn<=T:wn<T;ir?oe=cn+1:Ee=cn}return Fo(Ee,Cn)}function g0(_,T){for(var D=-1,Z=_.length,oe=0,Ee=[];++D<Z;){var Ge=_[D],rt=T?T(Ge):Ge;if(!D||!vh(rt,pt)){var pt=rt;Ee[oe++]=Ge===0?0:Ge}}return Ee}function _0(_){return typeof _=="number"?_:Yu(_)?Dt:+_}function gu(_){if(typeof _=="string")return _;if(fr(_))return Zr(_,gu)+"";if(Yu(_))return Lg?Lg.call(_):"";var T=_+"";return T=="0"&&1/_==-Ue?"-0":T}function Jf(_,T,D){var Z=-1,oe=mc,Ee=_.length,Ge=!0,rt=[],pt=rt;if(D)Ge=!1,oe=Nu;else if(Ee>=r){var rn=T?null:zg(_);if(rn)return ct(rn);Ge=!1,oe=jh,pt=new Sc}else pt=T?[]:rt;e:for(;++Z<Ee;){var cn=_[Z],wn=T?T(cn):cn;if(cn=D||cn!==0?cn:0,Ge&&wn===wn){for(var ri=pt.length;ri--;)if(pt[ri]===wn)continue e;T&&pt.push(wn),rt.push(cn)}else oe(pt,wn,D)||(pt!==rt&&pt.push(wn),rt.push(cn))}return rt}function cy(_,T){return T=Gd(T,_),_=Xu(_,T),_==null||delete _[_h(Ds(T))]}function Eb(_,T,D,Z){return mu(_,T,D(Ke(_,T)),Z)}function hy(_,T,D,Z){for(var oe=_.length,Ee=Z?oe:-1;(Z?Ee--:++Ee<oe)&&T(_[Ee],Ee,_););return D?qu(_,Z?0:Ee,Z?Ee+1:oe):qu(_,Z?Ee+1:0,Z?oe:Ee)}function Vd(_,T){var D=_;return D instanceof Yi&&(D=D.value()),Uh(T,function(Z,oe){return oe.func.apply(oe.thisArg,Xl([Z],oe.args))},D)}function y0(_,T,D){var Z=_.length;if(Z<2)return Z?Jf(_[0]):[];for(var oe=-1,Ee=Nt(Z);++oe<Z;)for(var Ge=_[oe],rt=-1;++rt<Z;)rt!=oe&&(Ee[oe]=X(Ee[oe]||Ge,_[rt],T,D));return Jf(se(Ee,1),T,D)}function fy(_,T,D){for(var Z=-1,oe=_.length,Ee=T.length,Ge={};++Z<oe;){var rt=Z<Ee?T[Z]:t;D(Ge,_[Z],rt)}return Ge}function Fg(_){return zo(_)?_:[]}function dy(_){return typeof _=="function"?_:bu}function Gd(_,T){return fr(_)?_:vy(_,T)?[_]:C0(os(_))}var py=Ki;function Qf(_,T,D){var Z=_.length;return D=D===t?Z:D,!T&&D>=Z?_:qu(_,T,D)}var my=Dp||function(_){return Ks.clearTimeout(_)};function Bg(_,T){if(T)return _.slice();var D=_.length,Z=Yh?Yh(D):new _.constructor(D);return _.copy(Z),Z}function lh(_){var T=new _.constructor(_.byteLength);return new bc(T).set(new bc(_)),T}function gy(_,T){var D=T?lh(_.buffer):_.buffer;return new _.constructor(D,_.byteOffset,_.byteLength)}function Ib(_){var T=new _.constructor(_.source,be.exec(_));return T.lastIndex=_.lastIndex,T}function Tb(_){return sh?us(sh.call(_)):{}}function wb(_,T){var D=T?lh(_.buffer):_.buffer;return new _.constructor(D,_.byteOffset,_.length)}function Sb(_,T){if(_!==T){var D=_!==t,Z=_===null,oe=_===_,Ee=Yu(_),Ge=T!==t,rt=T===null,pt=T===T,rn=Yu(T);if(!rt&&!rn&&!Ee&&_>T||Ee&&Ge&&pt&&!rt&&!rn||Z&&Ge&&pt||!D&&pt||!oe)return 1;if(!Z&&!Ee&&!rn&&_<T||rn&&D&&oe&&!Z&&!Ee||rt&&D&&oe||!Ge&&oe||!pt)return-1}return 0}function PI(_,T,D){for(var Z=-1,oe=_.criteria,Ee=T.criteria,Ge=oe.length,rt=D.length;++Z<Ge;){var pt=Sb(oe[Z],Ee[Z]);if(pt){if(Z>=rt)return pt;var rn=D[Z];return pt*(rn=="desc"?-1:1)}}return _.index-T.index}function _y(_,T,D,Z){for(var oe=-1,Ee=_.length,Ge=D.length,rt=-1,pt=T.length,rn=bo(Ee-Ge,0),cn=Nt(pt+rn),wn=!Z;++rt<pt;)cn[rt]=T[rt];for(;++oe<Ge;)(wn||oe<Ee)&&(cn[D[oe]]=_[oe]);for(;rn--;)cn[rt++]=_[oe++];return cn}function Lm(_,T,D,Z){for(var oe=-1,Ee=_.length,Ge=-1,rt=D.length,pt=-1,rn=T.length,cn=bo(Ee-rt,0),wn=Nt(cn+rn),ri=!Z;++oe<cn;)wn[oe]=_[oe];for(var Ci=oe;++pt<rn;)wn[Ci+pt]=T[pt];for(;++Ge<rt;)(ri||oe<Ee)&&(wn[Ci+D[Ge]]=_[oe++]);return wn}function ya(_,T){var D=-1,Z=_.length;for(T||(T=Nt(Z));++D<Z;)T[D]=_[D];return T}function ka(_,T,D,Z){var oe=!D;D||(D={});for(var Ee=-1,Ge=T.length;++Ee<Ge;){var rt=T[Ee],pt=Z?Z(D[rt],_[rt],rt,D,_):t;pt===t&&(pt=_[rt]),oe?b(D,rt,pt):ef(D,rt,pt)}return D}function uh(_,T){return ka(_,Hg(_),T)}function Hd(_,T){return ka(_,uo(_),T)}function ch(_,T){return function(D,Z){var oe=fr(D)?Ld:y,Ee=T?T():{};return oe(D,_,Vi(Z,2),Ee)}}function Ac(_){return Ki(function(T,D){var Z=-1,oe=D.length,Ee=oe>1?D[oe-1]:t,Ge=oe>2?D[2]:t;for(Ee=_.length>3&&typeof Ee=="function"?(oe--,Ee):t,Ge&&Tl(D[0],D[1],Ge)&&(Ee=oe<3?t:Ee,oe=1),T=us(T);++Z<oe;){var rt=D[Z];rt&&_(T,rt,Z,Ee)}return T})}function Cb(_,T){return function(D,Z){if(D==null)return D;if(!vu(D))return _(D,Z);for(var oe=D.length,Ee=T?oe:-1,Ge=us(D);(T?Ee--:++Ee<oe)&&Z(Ge[Ee],Ee,Ge)!==!1;);return D}}function Ab(_){return function(T,D,Z){for(var oe=-1,Ee=us(T),Ge=Z(T),rt=Ge.length;rt--;){var pt=Ge[_?rt:++oe];if(D(Ee[pt],pt,Ee)===!1)break}return T}}function DI(_,T,D){var Z=T&F,oe=jd(_);function Ee(){var Ge=this&&this!==Ks&&this instanceof Ee?oe:_;return Ge.apply(Z?D:this,arguments)}return Ee}function Mb(_){return function(T){T=os(T);var D=Vu(T)?nr(T):t,Z=D?D[0]:T.charAt(0),oe=D?Qf(D,1).join(""):T.slice(1);return Z[_]()+oe}}function jp(_){return function(T){return Uh(Yx(i1(T).replace(Bf,"")),_,"")}}function jd(_){return function(){var T=arguments;switch(T.length){case 0:return new _;case 1:return new _(T[0]);case 2:return new _(T[0],T[1]);case 3:return new _(T[0],T[1],T[2]);case 4:return new _(T[0],T[1],T[2],T[3]);case 5:return new _(T[0],T[1],T[2],T[3],T[4]);case 6:return new _(T[0],T[1],T[2],T[3],T[4],T[5]);case 7:return new _(T[0],T[1],T[2],T[3],T[4],T[5],T[6])}var D=Qh(_.prototype),Z=_.apply(D,T);return Bs(Z)?Z:D}}function hh(_,T,D){var Z=jd(_);function oe(){for(var Ee=arguments.length,Ge=Nt(Ee),rt=Ee,pt=rf(oe);rt--;)Ge[rt]=arguments[rt];var rn=Ee<3&&Ge[0]!==pt&&Ge[Ee-1]!==pt?[]:yc(Ge,pt);if(Ee-=rn.length,Ee<D)return yy(_,T,Qs,oe.placeholder,t,Ge,rn,t,t,D-Ee);var cn=this&&this!==Ks&&this instanceof oe?Z:_;return Yo(cn,this,Ge)}return oe}function Lb(_){return function(T,D,Z){var oe=us(T);if(!vu(T)){var Ee=Vi(D,3);T=Ao(T),D=function(rt){return Ee(oe[rt],rt,oe)}}var Ge=_(T,D,Z);return Ge>-1?oe[Ee?T[Ge]:Ge]:t}}function Rb(_){return Wu(function(T){var D=T.length,Z=D,oe=rl.prototype.thru;for(_&&T.reverse();Z--;){var Ee=T[Z];if(typeof Ee!="function")throw new gr(l);if(oe&&!Ge&&Gg(Ee)=="wrapper")var Ge=new rl([],!0)}for(Z=Ge?Z:D;++Z<D;){Ee=T[Z];var rt=Gg(Ee),pt=rt=="wrapper"?Vg(Ee):t;pt&&I0(pt[0])&&pt[1]==(ee|Y|J|ae)&&!pt[4].length&&pt[9]==1?Ge=Ge[Gg(pt[0])].apply(Ge,pt[3]):Ge=Ee.length==1&&I0(Ee)?Ge[rt]():Ge.thru(Ee)}return function(){var rn=arguments,cn=rn[0];if(Ge&&rn.length==1&&fr(cn))return Ge.plant(cn).value();for(var wn=0,ri=D?T[wn].apply(this,rn):cn;++wn<D;)ri=T[wn].call(this,ri);return ri}})}function Qs(_,T,D,Z,oe,Ee,Ge,rt,pt,rn){var cn=T&ee,wn=T&F,ri=T&z,Ci=T&(Y|Q),er=T&De,Sr=ri?t:jd(_);function ir(){for(var Gr=arguments.length,Kr=Nt(Gr),xu=Gr;xu--;)Kr[xu]=arguments[xu];if(Ci)var Sl=rf(ir),Eu=Yl(Kr,Sl);if(Z&&(Kr=_y(Kr,Z,oe,Ci)),Ee&&(Kr=Lm(Kr,Ee,Ge,Ci)),Gr-=Eu,Ci&&Gr<rn){var Uo=yc(Kr,Sl);return yy(_,T,Qs,ir.placeholder,D,Kr,Uo,rt,pt,rn-Gr)}var Pc=wn?D:this,Cl=ri?Pc[_]:_;return Gr=Kr.length,rt?Kr=Lc(Kr,rt):er&&Gr>1&&Kr.reverse(),cn&&pt<Gr&&(Kr.length=pt),this&&this!==Ks&&this instanceof ir&&(Cl=Sr||jd(Cl)),Cl.apply(Pc,Kr)}return ir}function Mi(_,T){return function(D,Z){return un(D,_,T(Z),{})}}function fh(_,T){return function(D,Z){var oe;if(D===t&&Z===t)return T;if(D!==t&&(oe=D),Z!==t){if(oe===t)return Z;typeof D=="string"||typeof Z=="string"?(D=gu(D),Z=gu(Z)):(D=_0(D),Z=_0(Z)),oe=_(D,Z)}return oe}}function Rm(_){return Wu(function(T){return T=Zr(T,wo(Vi())),Ki(function(D){var Z=this;return _(T,function(oe){return Yo(oe,Z,D)})})})}function al(_,T){T=T===t?" ":gu(T);var D=T.length;if(D<2)return D?ol(T,_):T;var Z=ol(T,Op(_/Yr(T)));return Vu(T)?Qf(nr(Z),0,_).join(""):Z.slice(0,_)}function Pb(_,T,D,Z){var oe=T&F,Ee=jd(_);function Ge(){for(var rt=-1,pt=arguments.length,rn=-1,cn=Z.length,wn=Nt(cn+pt),ri=this&&this!==Ks&&this instanceof Ge?Ee:_;++rn<cn;)wn[rn]=Z[rn];for(;pt--;)wn[rn++]=arguments[++rt];return Yo(ri,oe?D:this,wn)}return Ge}function v0(_){return function(T,D,Z){return Z&&typeof Z!="number"&&Tl(T,D,Z)&&(D=Z=t),T=Ba(T),D===t?(D=T,T=0):D=Ba(D),Z=Z===t?T<D?1:-1:Ba(Z),Ud(T,D,Z,_)}}function _u(_){return function(T,D){return typeof T=="string"&&typeof D=="string"||(T=cl(T),D=cl(D)),_(T,D)}}function yy(_,T,D,Z,oe,Ee,Ge,rt,pt,rn){var cn=T&Y,wn=cn?Ge:t,ri=cn?t:Ge,Ci=cn?Ee:t,er=cn?t:Ee;T|=cn?J:he,T&=~(cn?he:J),T&V||(T&=~(F|z));var Sr=[_,T,oe,Ci,wn,er,ri,rt,pt,rn],ir=D.apply(t,Sr);return I0(_)&&qg(ir,Sr),ir.placeholder=Z,Ey(ir,_,T)}function $f(_){var T=Js[_];return function(D,Z){if(D=cl(D),Z=Z==null?0:Fo(Ir(Z),292),Z&&Sg(D)){var oe=(os(D)+"e").split("e"),Ee=T(oe[0]+"e"+(+oe[1]+Z));return oe=(os(Ee)+"e").split("e"),+(oe[0]+"e"+(+oe[1]-Z))}return T(D)}}var zg=rh&&1/ct(new rh([,-0]))[1]==Ue?function(_){return new rh(_)}:o1;function qd(_){return function(T){var D=ll(T);return D==yn?Gu(T):D==Jt?Ut(T):Rd(T,_(T))}}function dh(_,T,D,Z,oe,Ee,Ge,rt){var pt=T&z;if(!pt&&typeof _!="function")throw new gr(l);var rn=Z?Z.length:0;if(rn||(T&=~(J|he),Z=oe=t),Ge=Ge===t?Ge:bo(Ir(Ge),0),rt=rt===t?rt:Ir(rt),rn-=oe?oe.length:0,T&he){var cn=Z,wn=oe;Z=oe=t}var ri=pt?t:Vg(_),Ci=[_,T,D,Z,oe,cn,wn,Ee,Ge,rt];if(ri&&wl(Ci,ri),_=Ci[0],T=Ci[1],D=Ci[2],Z=Ci[3],oe=Ci[4],rt=Ci[9]=Ci[9]===t?pt?0:_.length:bo(Ci[9]-rn,0),!rt&&T&(Y|Q)&&(T&=~(Y|Q)),!T||T==F)var er=DI(_,T,D);else T==Y||T==Q?er=hh(_,T,rt):(T==J||T==(F|J))&&!oe.length?er=Pb(_,T,D,Z):er=Qs.apply(t,Ci);var Sr=ri?Kf:qg;return Ey(Sr(er,Ci),_,T)}function Ug(_,T,D,Z){return _===t||vh(_,tl[D])&&!_r.call(Z,D)?T:_}function b0(_,T,D,Z,oe,Ee){return Bs(_)&&Bs(T)&&(Ee.set(T,_),pu(_,T,t,b0,Ee),Ee.delete(T)),_}function Db(_){return Yd(_)?t:_}function Ob(_,T,D,Z,oe,Ee){var Ge=D&N,rt=_.length,pt=T.length;if(rt!=pt&&!(Ge&&pt>rt))return!1;var rn=Ee.get(_),cn=Ee.get(T);if(rn&&cn)return rn==T&&cn==_;var wn=-1,ri=!0,Ci=D&B?new Sc:t;for(Ee.set(_,T),Ee.set(T,_);++wn<rt;){var er=_[wn],Sr=T[wn];if(Z)var ir=Ge?Z(Sr,er,wn,T,_,Ee):Z(er,Sr,wn,_,T,Ee);if(ir!==t){if(ir)continue;ri=!1;break}if(Ci){if(!Vh(T,function(Gr,Kr){if(!jh(Ci,Kr)&&(er===Gr||oe(er,Gr,D,Z,Ee)))return Ci.push(Kr)})){ri=!1;break}}else if(!(er===Sr||oe(er,Sr,D,Z,Ee))){ri=!1;break}}return Ee.delete(_),Ee.delete(T),ri}function x0(_,T,D,Z,oe,Ee,Ge){switch(D){case ki:if(_.byteLength!=T.byteLength||_.byteOffset!=T.byteOffset)return!1;_=_.buffer,T=T.buffer;case Ln:return!(_.byteLength!=T.byteLength||!Ee(new bc(_),new bc(T)));case _t:case kt:case Pt:return vh(+_,+T);case Bt:return _.name==T.name&&_.message==T.message;case He:case ui:return _==T+"";case yn:var rt=Gu;case Jt:var pt=Z&N;if(rt||(rt=ct),_.size!=T.size&&!pt)return!1;var rn=Ge.get(_);if(rn)return rn==T;Z|=B,Ge.set(_,T);var cn=Ob(rt(_),rt(T),Z,oe,Ee,Ge);return Ge.delete(_),cn;case $e:if(sh)return sh.call(_)==sh.call(T)}return!1}function Nb(_,T,D,Z,oe,Ee){var Ge=D&N,rt=Wd(_),pt=rt.length,rn=Wd(T),cn=rn.length;if(pt!=cn&&!Ge)return!1;for(var wn=pt;wn--;){var ri=rt[wn];if(!(Ge?ri in T:_r.call(T,ri)))return!1}var Ci=Ee.get(_),er=Ee.get(T);if(Ci&&er)return Ci==T&&er==_;var Sr=!0;Ee.set(_,T),Ee.set(T,_);for(var ir=Ge;++wn<pt;){ri=rt[wn];var Gr=_[ri],Kr=T[ri];if(Z)var xu=Ge?Z(Kr,Gr,ri,T,_,Ee):Z(Gr,Kr,ri,_,T,Ee);if(!(xu===t?Gr===Kr||oe(Gr,Kr,D,Z,Ee):xu)){Sr=!1;break}ir||(ir=ri=="constructor")}if(Sr&&!ir){var Sl=_.constructor,Eu=T.constructor;Sl!=Eu&&"constructor"in _&&"constructor"in T&&!(typeof Sl=="function"&&Sl instanceof Sl&&typeof Eu=="function"&&Eu instanceof Eu)&&(Sr=!1)}return Ee.delete(_),Ee.delete(T),Sr}function Wu(_){return S0(Pm(_,t,qb),_+"")}function Wd(_){return ft(_,Ao,Hg)}function ph(_){return ft(_,Ql,uo)}var Vg=kd?function(_){return kd.get(_)}:o1;function Gg(_){for(var T=_.name+"",D=Zf[T],Z=_r.call(Zf,T)?D.length:0;Z--;){var oe=D[Z],Ee=oe.func;if(Ee==null||Ee==_)return oe.name}return T}function rf(_){var T=_r.call(ge,"placeholder")?ge:_;return T.placeholder}function Vi(){var _=ge.iteratee||hf;return _=_===hf?Wr:_,arguments.length?_(arguments[0],arguments[1]):_}function Il(_,T){var D=_.__data__;return NI(T)?D[typeof T=="string"?"string":"hash"]:D.map}function qp(_){for(var T=Ao(_),D=T.length;D--;){var Z=T[D],oe=_[Z];T[D]=[Z,oe,by(oe)]}return T}function Bo(_,T){var D=El(_,T);return Hn(D)?D:t}function Mc(_){var T=_r.call(_,Jl),D=_[Jl];try{_[Jl]=t;var Z=!0}catch{}var oe=$i.call(_);return Z&&(T?_[Jl]=D:delete _[Jl]),oe}var Hg=Xf?function(_){return _==null?[]:(_=us(_),Oa(Xf(_),function(T){return Wf.call(_,T)}))}:l1,uo=Xf?function(_){for(var T=[];_;)Xl(T,Hg(_)),_=xc(_);return T}:l1,ll=dt;(Tm&&ll(new Tm(new ArrayBuffer(1)))!=ki||Jh&&ll(new Jh)!=yn||Fp&&ll(Fp.resolve())!=Dr||rh&&ll(new rh)!=Jt||Nd&&ll(new Nd)!=Ei)&&(ll=function(_){var T=dt(_),D=T==si?_.constructor:t,Z=D?Zp(D):"";if(Z)switch(Z){case wm:return ki;case Q_:return yn;case Ag:return Dr;case Mg:return Jt;case Fd:return Ei}return T});function jg(_,T,D){for(var Z=-1,oe=D.length;++Z<oe;){var Ee=D[Z],Ge=Ee.size;switch(Ee.type){case"drop":_+=Ge;break;case"dropRight":T-=Ge;break;case"take":T=Fo(T,_+Ge);break;case"takeRight":_=bo(_,T-Ge);break}}return{start:_,end:T}}function mh(_){var T=_.match(We);return T?T[1].split(ut):[]}function kb(_,T,D){T=Gd(T,_);for(var Z=-1,oe=T.length,Ee=!1;++Z<oe;){var Ge=_h(T[Z]);if(!(Ee=_!=null&&D(_,Ge)))break;_=_[Ge]}return Ee||++Z!=oe?Ee:(oe=_==null?0:_.length,!!oe&&Zd(oe)&&sf(Ge,oe)&&(fr(_)||Xd(_)))}function OI(_){var T=_.length,D=new _.constructor(T);return T&&typeof _[0]=="string"&&_r.call(_,"index")&&(D.index=_.index,D.input=_.input),D}function E0(_){return typeof _.constructor=="function"&&!ed(_)?Qh(xc(_)):{}}function Fb(_,T,D){var Z=_.constructor;switch(T){case Ln:return lh(_);case _t:case kt:return new Z(+_);case ki:return gy(_,D);case Hs:case Xt:case Rn:case ti:case tr:case js:case mo:case ca:case Xo:return wb(_,D);case yn:return new Z;case Pt:case ui:return new Z(_);case He:return Ib(_);case Jt:return new Z;case $e:return Tb(_)}}function Wp(_,T){var D=T.length;if(!D)return _;var Z=D-1;return T[Z]=(D>1?"& ":"")+T[Z],T=T.join(D>2?", ":" "),_.replace(Oe,`{
/* [wrapped with `+T+`] */
`)}function Bb(_){return fr(_)||Xd(_)||!!(Pp&&_&&_[Pp])}function sf(_,T){var D=typeof _;return T=T??at,!!T&&(D=="number"||D!="symbol"&&Ye.test(_))&&_>-1&&_%1==0&&_<T}function Tl(_,T,D){if(!Bs(D))return!1;var Z=typeof T;return(Z=="number"?vu(D)&&sf(T,D.length):Z=="string"&&T in D)?vh(D[T],_):!1}function vy(_,T){if(fr(_))return!1;var D=typeof _;return D=="number"||D=="symbol"||D=="boolean"||_==null||Yu(_)?!0:so.test(_)||!La.test(_)||T!=null&&_ in us(T)}function NI(_){var T=typeof _;return T=="string"||T=="number"||T=="symbol"||T=="boolean"?_!=="__proto__":_===null}function I0(_){var T=Gg(_),D=ge[T];if(typeof D!="function"||!(T in Yi.prototype))return!1;if(_===D)return!0;var Z=Vg(D);return!!Z&&_===Z[0]}function zb(_){return!!vc&&vc in _}var Ub=Co?cf:tv;function ed(_){var T=_&&_.constructor,D=typeof T=="function"&&T.prototype||tl;return _===D}function by(_){return _===_&&!Bs(_)}function xy(_,T){return function(D){return D==null?!1:D[_]===T&&(T!==t||_ in us(D))}}function T0(_){var T=By(_,function(Z){return D.size===g&&D.clear(),Z}),D=T.cache;return T}function wl(_,T){var D=_[1],Z=T[1],oe=D|Z,Ee=oe<(F|z|ee),Ge=Z==ee&&D==Y||Z==ee&&D==ae&&_[7].length<=T[8]||Z==(ee|ae)&&T[7].length<=T[8]&&D==Y;if(!(Ee||Ge))return _;Z&F&&(_[2]=T[2],oe|=D&F?0:V);var rt=T[3];if(rt){var pt=_[3];_[3]=pt?_y(pt,rt,T[4]):rt,_[4]=pt?yc(_[3],x):T[4]}return rt=T[5],rt&&(pt=_[5],_[5]=pt?Lm(pt,rt,T[6]):rt,_[6]=pt?yc(_[5],x):T[6]),rt=T[7],rt&&(_[7]=rt),Z&ee&&(_[8]=_[8]==null?T[8]:Fo(_[8],T[8])),_[9]==null&&(_[9]=T[9]),_[0]=T[0],_[1]=oe,_}function of(_){var T=[];if(_!=null)for(var D in us(_))T.push(D);return T}function Xp(_){return $i.call(_)}function Pm(_,T,D){return T=bo(T===t?_.length-1:T,0),function(){for(var Z=arguments,oe=-1,Ee=bo(Z.length-T,0),Ge=Nt(Ee);++oe<Ee;)Ge[oe]=Z[T+oe];oe=-1;for(var rt=Nt(T+1);++oe<T;)rt[oe]=Z[oe];return rt[T]=D(Ge),Yo(_,this,rt)}}function Xu(_,T){return T.length<2?_:Ke(_,qu(T,0,-1))}function Lc(_,T){for(var D=_.length,Z=Fo(T.length,D),oe=ya(_);Z--;){var Ee=T[Z];_[Z]=sf(Ee,D)?oe[Ee]:t}return _}function w0(_,T){if(!(T==="constructor"&&typeof _[T]=="function")&&T!="__proto__")return _[T]}var qg=gh(Kf),Dm=hu||function(_,T){return Ks.setTimeout(_,T)},S0=gh(bb);function Ey(_,T,D){var Z=T+"";return S0(_,Wp(Z,Iy(mh(Z),D)))}function gh(_){var T=0,D=0;return function(){var Z=Np(),oe=Pe-(Z-D);if(D=Z,oe>0){if(++T>=Be)return arguments[0]}else T=0;return _.apply(t,arguments)}}function af(_,T){var D=-1,Z=_.length,oe=Z-1;for(T=T===t?Z:T;++D<T;){var Ee=Cc(D,oe),Ge=_[Ee];_[Ee]=_[D],_[D]=Ge}return _.length=T,_}var C0=T0(function(_){var T=[];return _.charCodeAt(0)===46&&T.push(""),_.replace(Ra,function(D,Z,oe,Ee){T.push(oe?Ee.replace(pe,"$1"):Z||D)}),T});function _h(_){if(typeof _=="string"||Yu(_))return _;var T=_+"";return T=="0"&&1/_==-Ue?"-0":T}function Zp(_){if(_!=null){try{return Jo.call(_)}catch{}try{return _+""}catch{}}return""}function Iy(_,T){return Da(Mt,function(D){var Z="_."+D[0];T&D[1]&&!mc(_,Z)&&_.push(Z)}),_.sort()}function Ty(_){if(_ instanceof Yi)return _.clone();var T=new rl(_.__wrapped__,_.__chain__);return T.__actions__=ya(_.__actions__),T.__index__=_.__index__,T.__values__=_.__values__,T}function Om(_,T,D){(D?Tl(_,T,D):T===t)?T=1:T=bo(Ir(T),0);var Z=_==null?0:_.length;if(!Z||T<1)return[];for(var oe=0,Ee=0,Ge=Nt(Op(Z/T));oe<Z;)Ge[Ee++]=qu(_,oe,oe+=T);return Ge}function Nm(_){for(var T=-1,D=_==null?0:_.length,Z=0,oe=[];++T<D;){var Ee=_[T];Ee&&(oe[Z++]=Ee)}return oe}function Wg(){var _=arguments.length;if(!_)return[];for(var T=Nt(_-1),D=arguments[0],Z=_;Z--;)T[Z-1]=arguments[Z];return Xl(fr(D)?ya(D):[D],se(T,1))}var wy=Ki(function(_,T){return zo(_)?X(_,se(T,1,zo,!0)):[]}),Vb=Ki(function(_,T){var D=Ds(T);return zo(D)&&(D=t),zo(_)?X(_,se(T,1,zo,!0),Vi(D,2)):[]}),Xg=Ki(function(_,T){var D=Ds(T);return zo(D)&&(D=t),zo(_)?X(_,se(T,1,zo,!0),t,D):[]});function A0(_,T,D){var Z=_==null?0:_.length;return Z?(T=D||T===t?1:Ir(T),qu(_,T<0?0:T,Z)):[]}function Gb(_,T,D){var Z=_==null?0:_.length;return Z?(T=D||T===t?1:Ir(T),T=Z-T,qu(_,0,T<0?0:T)):[]}function km(_,T){return _&&_.length?hy(_,Vi(T,3),!0,!0):[]}function Hb(_,T){return _&&_.length?hy(_,Vi(T,3),!0):[]}function M0(_,T,D,Z){var oe=_==null?0:_.length;return oe?(D&&typeof D!="number"&&Tl(_,T,D)&&(D=0,Z=oe),ve(_,T,D,Z)):[]}function L0(_,T,D){var Z=_==null?0:_.length;if(!Z)return-1;var oe=D==null?0:Ir(D);return oe<0&&(oe=bo(Z+oe,0)),Na(_,Vi(T,3),oe)}function jb(_,T,D){var Z=_==null?0:_.length;if(!Z)return-1;var oe=Z-1;return D!==t&&(oe=Ir(D),oe=D<0?bo(Z+oe,0):Fo(oe,Z-1)),Na(_,Vi(T,3),oe,!0)}function qb(_){var T=_==null?0:_.length;return T?se(_,1):[]}function Zg(_){var T=_==null?0:_.length;return T?se(_,Ue):[]}function Wb(_,T){var D=_==null?0:_.length;return D?(T=T===t?1:Ir(T),se(_,T)):[]}function kr(_){for(var T=-1,D=_==null?0:_.length,Z={};++T<D;){var oe=_[T];Z[oe[0]]=oe[1]}return Z}function Sy(_){return _&&_.length?_[0]:t}function lf(_,T,D){var Z=_==null?0:_.length;if(!Z)return-1;var oe=D==null?0:Ir(D);return oe<0&&(oe=bo(Z+oe,0)),Zi(_,T,oe)}function uf(_){var T=_==null?0:_.length;return T?qu(_,0,-1):[]}var yh=Ki(function(_){var T=Zr(_,Fg);return T.length&&T[0]===_[0]?St(T):[]}),Zu=Ki(function(_){var T=Ds(_),D=Zr(_,Fg);return T===Ds(D)?T=t:D.pop(),D.length&&D[0]===_[0]?St(D,Vi(T,2)):[]}),Fa=Ki(function(_){var T=Ds(_),D=Zr(_,Fg);return T=typeof T=="function"?T:t,T&&D.pop(),D.length&&D[0]===_[0]?St(D,t,T):[]});function Xb(_,T){return _==null?"":Im.call(_,T)}function Ds(_){var T=_==null?0:_.length;return T?_[T-1]:t}function Zb(_,T,D){var Z=_==null?0:_.length;if(!Z)return-1;var oe=Z;return D!==t&&(oe=Ir(D),oe=oe<0?bo(Z+oe,0):Fo(oe,Z-1)),T===T?Si(_,T,oe):Na(_,lu,oe,!0)}function Fm(_,T){return _&&_.length?cs(_,Ir(T)):t}var R0=Ki(P0);function P0(_,T){return _&&_.length&&T&&T.length?la(_,T):_}function D0(_,T,D){return _&&_.length&&T&&T.length?la(_,T,Vi(D,2)):_}function kI(_,T,D){return _&&_.length&&T&&T.length?la(_,T,t,D):_}var O0=Wu(function(_,T){var D=_==null?0:_.length,Z=w(_,T);return _a(_,Zr(T,function(oe){return sf(oe,D)?+oe:oe}).sort(Sb)),Z});function Yb(_,T){var D=[];if(!(_&&_.length))return D;var Z=-1,oe=[],Ee=_.length;for(T=Vi(T,3);++Z<Ee;){var Ge=_[Z];T(Ge,Z,_)&&(D.push(Ge),oe.push(Z))}return _a(_,oe),D}function N0(_){return _==null?_:f0.call(_)}function td(_,T,D){var Z=_==null?0:_.length;return Z?(D&&typeof D!="number"&&Tl(_,T,D)?(T=0,D=Z):(T=T==null?0:Ir(T),D=D===t?Z:Ir(D)),qu(_,T,D)):[]}function Yp(_,T){return kg(_,T)}function Cy(_,T,D){return uy(_,T,Vi(D,2))}function Ay(_,T){var D=_==null?0:_.length;if(D){var Z=kg(_,T);if(Z<D&&vh(_[Z],T))return Z}return-1}function k0(_,T){return kg(_,T,!0)}function Kb(_,T,D){return uy(_,T,Vi(D,2),!0)}function FI(_,T){var D=_==null?0:_.length;if(D){var Z=kg(_,T,!0)-1;if(vh(_[Z],T))return Z}return-1}function Jb(_){return _&&_.length?g0(_):[]}function BI(_,T){return _&&_.length?g0(_,Vi(T,2)):[]}function F0(_){var T=_==null?0:_.length;return T?qu(_,1,T):[]}function zI(_,T,D){return _&&_.length?(T=D||T===t?1:Ir(T),qu(_,0,T<0?0:T)):[]}function B0(_,T,D){var Z=_==null?0:_.length;return Z?(T=D||T===t?1:Ir(T),T=Z-T,qu(_,T<0?0:T,Z)):[]}function Qb(_,T){return _&&_.length?hy(_,Vi(T,3),!1,!0):[]}function $b(_,T){return _&&_.length?hy(_,Vi(T,3)):[]}var Kp=Ki(function(_){return Jf(se(_,1,zo,!0))}),ex=Ki(function(_){var T=Ds(_);return zo(T)&&(T=t),Jf(se(_,1,zo,!0),Vi(T,2))}),UI=Ki(function(_){var T=Ds(_);return T=typeof T=="function"?T:t,Jf(se(_,1,zo,!0),t,T)});function Bm(_){return _&&_.length?Jf(_):[]}function My(_,T){return _&&_.length?Jf(_,Vi(T,2)):[]}function tx(_,T){return T=typeof T=="function"?T:t,_&&_.length?Jf(_,t,T):[]}function Ly(_){if(!(_&&_.length))return[];var T=0;return _=Oa(_,function(D){if(zo(D))return T=bo(D.length,T),!0}),Gh(T,function(D){return Zr(_,_c(D))})}function nx(_,T){if(!(_&&_.length))return[];var D=Ly(_);return T==null?D:Zr(D,function(Z){return Yo(T,t,Z)})}var VI=Ki(function(_,T){return zo(_)?X(_,T):[]}),ix=Ki(function(_){return y0(Oa(_,zo))}),GI=Ki(function(_){var T=Ds(_);return zo(T)&&(T=t),y0(Oa(_,zo),Vi(T,2))}),rx=Ki(function(_){var T=Ds(_);return T=typeof T=="function"?T:t,y0(Oa(_,zo),t,T)}),HI=Ki(Ly);function jI(_,T){return fy(_||[],T||[],ef)}function sx(_,T){return fy(_||[],T||[],mu)}var ox=Ki(function(_){var T=_.length,D=T>1?_[T-1]:t;return D=typeof D=="function"?(_.pop(),D):t,nx(_,D)});function z0(_){var T=ge(_);return T.__chain__=!0,T}function U0(_,T){return T(_),_}function Rc(_,T){return T(_)}var yu=Wu(function(_){var T=_.length,D=T?_[0]:0,Z=this.__wrapped__,oe=function(Ee){return w(Ee,_)};return T>1||this.__actions__.length||!(Z instanceof Yi)||!sf(D)?this.thru(oe):(Z=Z.slice(D,+D+(T?1:0)),Z.__actions__.push({func:Rc,args:[oe],thisArg:t}),new rl(Z,this.__chain__).thru(function(Ee){return T&&!Ee.length&&Ee.push(t),Ee}))});function qI(){return z0(this)}function V0(){return new rl(this.value(),this.__chain__)}function WI(){this.__values__===t&&(this.__values__=va(this.value()));var _=this.__index__>=this.__values__.length,T=_?t:this.__values__[this.__index__++];return{done:_,value:T}}function XI(){return this}function ZI(_){for(var T,D=this;D instanceof Bp;){var Z=Ty(D);Z.__index__=0,Z.__values__=t,T?oe.__wrapped__=Z:T=Z;var oe=Z;D=D.__wrapped__}return oe.__wrapped__=_,T}function zm(){var _=this.__wrapped__;if(_ instanceof Yi){var T=_;return this.__actions__.length&&(T=new Yi(this)),T=T.reverse(),T.__actions__.push({func:Rc,args:[N0],thisArg:t}),new rl(T,this.__chain__)}return this.thru(N0)}function Ry(){return Vd(this.__wrapped__,this.__actions__)}var ax=ch(function(_,T,D){_r.call(_,D)?++_[D]:b(_,D,1)});function Jp(_,T,D){var Z=fr(_)?Er:ye;return D&&Tl(_,T,D)&&(T=t),Z(_,Vi(T,3))}function Yg(_,T){var D=fr(_)?Oa:xe;return D(_,Vi(T,3))}var YI=Lb(L0),KI=Lb(jb);function JI(_,T){return se($s(_,T),1)}function QI(_,T){return se($s(_,T),Ue)}function $I(_,T,D){return D=D===t?1:Ir(D),se($s(_,T),D)}function lx(_,T){var D=fr(_)?Da:ne;return D(_,Vi(T,3))}function ux(_,T){var D=fr(_)?Ou:ce;return D(_,Vi(T,3))}var G0=ch(function(_,T,D){_r.call(_,D)?_[D].push(T):b(_,D,[T])});function eT(_,T,D,Z){_=vu(_)?_:Jd(_),D=D&&!Z?Ir(D):0;var oe=_.length;return D<0&&(D=bo(oe+D,0)),i_(_)?D<=oe&&_.indexOf(T,D)>-1:!!oe&&Zi(_,T,D)>-1}var Um=Ki(function(_,T,D){var Z=-1,oe=typeof T=="function",Ee=vu(_)?Nt(_.length):[];return ne(_,function(Ge){Ee[++Z]=oe?Yo(T,Ge,D):yt(Ge,T,D)}),Ee}),tT=ch(function(_,T,D){b(_,D,T)});function $s(_,T){var D=fr(_)?Zr:xo;return D(_,Vi(T,3))}function Py(_,T,D,Z){return _==null?[]:(fr(T)||(T=T==null?[]:[T]),D=Z?t:D,fr(D)||(D=D==null?[]:[D]),Nr(_,T,D))}var cx=ch(function(_,T,D){_[D?0:1].push(T)},function(){return[[],[]]});function Dy(_,T,D){var Z=fr(_)?Uh:Hf,oe=arguments.length<3;return Z(_,Vi(T,4),D,oe,ne)}function Oy(_,T,D){var Z=fr(_)?wp:Hf,oe=arguments.length<3;return Z(_,Vi(T,4),D,oe,ce)}function Kg(_,T){var D=fr(_)?Oa:xe;return D(_,zy(Vi(T,3)))}function hx(_){var T=fr(_)?Ng:ah;return T(_)}function fx(_,T,D){(D?Tl(_,T,D):T===t)?T=1:T=Ir(T);var Z=fr(_)?ay:nf;return Z(_,T)}function Jg(_){var T=fr(_)?ly:m0;return T(_)}function H0(_){if(_==null)return 0;if(vu(_))return i_(_)?Yr(_):_.length;var T=ll(_);return T==yn||T==Jt?_.size:$r(_).length}function j0(_,T,D){var Z=fr(_)?Vh:xb;return D&&Tl(_,T,D)&&(T=t),Z(_,Vi(T,3))}var nT=Ki(function(_,T){if(_==null)return[];var D=T.length;return D>1&&Tl(_,T[0],T[1])?T=[]:D>2&&Tl(T[0],T[1],T[2])&&(T=[T[0]]),Nr(_,se(T,1),[])}),Qg=Vn||function(){return Ks.Date.now()};function $g(_,T){if(typeof T!="function")throw new gr(l);return _=Ir(_),function(){if(--_<1)return T.apply(this,arguments)}}function dx(_,T,D){return T=D?t:T,T=_&&T==null?_.length:T,dh(_,ee,t,t,t,t,T)}function Ny(_,T){var D;if(typeof T!="function")throw new gr(l);return _=Ir(_),function(){return--_>0&&(D=T.apply(this,arguments)),_<=1&&(T=t),D}}var q0=Ki(function(_,T,D){var Z=F;if(D.length){var oe=yc(D,rf(q0));Z|=J}return dh(_,Z,T,D,oe)}),ky=Ki(function(_,T,D){var Z=F|z;if(D.length){var oe=yc(D,rf(ky));Z|=J}return dh(T,Z,_,D,oe)});function Fy(_,T,D){T=D?t:T;var Z=dh(_,Y,t,t,t,t,t,T);return Z.placeholder=Fy.placeholder,Z}function e_(_,T,D){T=D?t:T;var Z=dh(_,Q,t,t,t,t,t,T);return Z.placeholder=e_.placeholder,Z}function px(_,T,D){var Z,oe,Ee,Ge,rt,pt,rn=0,cn=!1,wn=!1,ri=!0;if(typeof _!="function")throw new gr(l);T=cl(T)||0,Bs(D)&&(cn=!!D.leading,wn="maxWait"in D,Ee=wn?bo(cl(D.maxWait)||0,T):Ee,ri="trailing"in D?!!D.trailing:ri);function Ci(Uo){var Pc=Z,Cl=oe;return Z=oe=t,rn=Uo,Ge=_.apply(Cl,Pc),Ge}function er(Uo){return rn=Uo,rt=Dm(Gr,T),cn?Ci(Uo):Ge}function Sr(Uo){var Pc=Uo-pt,Cl=Uo-rn,d1=T-Pc;return wn?Fo(d1,Ee-Cl):d1}function ir(Uo){var Pc=Uo-pt,Cl=Uo-rn;return pt===t||Pc>=T||Pc<0||wn&&Cl>=Ee}function Gr(){var Uo=Qg();if(ir(Uo))return Kr(Uo);rt=Dm(Gr,Sr(Uo))}function Kr(Uo){return rt=t,ri&&Z?Ci(Uo):(Z=oe=t,Ge)}function xu(){rt!==t&&my(rt),rn=0,Z=pt=oe=rt=t}function Sl(){return rt===t?Ge:Kr(Qg())}function Eu(){var Uo=Qg(),Pc=ir(Uo);if(Z=arguments,oe=this,pt=Uo,Pc){if(rt===t)return er(pt);if(wn)return my(rt),rt=Dm(Gr,T),Ci(pt)}return rt===t&&(rt=Dm(Gr,T)),Ge}return Eu.cancel=xu,Eu.flush=Sl,Eu}var iT=Ki(function(_,T){return W(_,1,T)}),rT=Ki(function(_,T,D){return W(_,cl(T)||0,D)});function sT(_){return dh(_,De)}function By(_,T){if(typeof _!="function"||T!=null&&typeof T!="function")throw new gr(l);var D=function(){var Z=arguments,oe=T?T.apply(this,Z):Z[0],Ee=D.cache;if(Ee.has(oe))return Ee.get(oe);var Ge=_.apply(this,Z);return D.cache=Ee.set(oe,Ge)||Ee,Ge};return D.cache=new(By.Cache||wc),D}By.Cache=wc;function zy(_){if(typeof _!="function")throw new gr(l);return function(){var T=arguments;switch(T.length){case 0:return!_.call(this);case 1:return!_.call(this,T[0]);case 2:return!_.call(this,T[0],T[1]);case 3:return!_.call(this,T[0],T[1],T[2])}return!_.apply(this,T)}}function Uy(_){return Ny(2,_)}var oT=py(function(_,T){T=T.length==1&&fr(T[0])?Zr(T[0],wo(Vi())):Zr(se(T,1),wo(Vi()));var D=T.length;return Ki(function(Z){for(var oe=-1,Ee=Fo(Z.length,D);++oe<Ee;)Z[oe]=T[oe].call(this,Z[oe]);return Yo(_,this,Z)})}),Vy=Ki(function(_,T){var D=yc(T,rf(Vy));return dh(_,J,t,T,D)}),Qp=Ki(function(_,T){var D=yc(T,rf(Qp));return dh(_,he,t,T,D)}),aT=Wu(function(_,T){return dh(_,ae,t,t,t,T)});function lT(_,T){if(typeof _!="function")throw new gr(l);return T=T===t?T:Ir(T),Ki(_,T)}function uT(_,T){if(typeof _!="function")throw new gr(l);return T=T==null?0:bo(Ir(T),0),Ki(function(D){var Z=D[T],oe=Qf(D,0,T);return Z&&Xl(oe,Z),Yo(_,this,oe)})}function mx(_,T,D){var Z=!0,oe=!0;if(typeof _!="function")throw new gr(l);return Bs(D)&&(Z="leading"in D?!!D.leading:Z,oe="trailing"in D?!!D.trailing:oe),px(_,T,{leading:Z,maxWait:T,trailing:oe})}function gx(_){return dx(_,1)}function cT(_,T){return Vy(dy(T),_)}function hT(){if(!arguments.length)return[];var _=arguments[0];return fr(_)?_:[_]}function fT(_){return P(_,L)}function W0(_,T){return T=typeof T=="function"?T:t,P(_,L,T)}function Gy(_){return P(_,I|L)}function Hy(_,T){return T=typeof T=="function"?T:t,P(_,I|L,T)}function dT(_,T){return T==null||G(_,T,Ao(T))}function vh(_,T){return _===T||_!==_&&T!==T}var t_=_u(xt),n_=_u(function(_,T){return _>=T}),Xd=ht(function(){return arguments}())?ht:function(_){return eo(_)&&_r.call(_,"callee")&&!Wf.call(_,"callee")},fr=Nt.isArray,_x=Bh?wo(Bh):Tt;function vu(_){return _!=null&&Zd(_.length)&&!cf(_)}function zo(_){return eo(_)&&vu(_)}function yx(_){return _===!0||_===!1||eo(_)&&dt(_)==_t}var nd=Od||tv,vx=zh?wo(zh):en;function bx(_){return eo(_)&&_.nodeType===1&&!Yd(_)}function xx(_){if(_==null)return!0;if(vu(_)&&(fr(_)||typeof _=="string"||typeof _.splice=="function"||nd(_)||Vm(_)||Xd(_)))return!_.length;var T=ll(_);if(T==yn||T==Jt)return!_.size;if(ed(_))return!$r(_).length;for(var D in _)if(_r.call(_,D))return!1;return!0}function pT(_,T){return ln(_,T)}function mT(_,T,D){D=typeof D=="function"?D:t;var Z=D?D(_,T):t;return Z===t?ln(_,T,t,D):!!Z}function jy(_){if(!eo(_))return!1;var T=dt(_);return T==Bt||T==Ct||typeof _.message=="string"&&typeof _.name=="string"&&!Yd(_)}function qy(_){return typeof _=="number"&&Sg(_)}function cf(_){if(!Bs(_))return!1;var T=dt(_);return T==Zn||T==mi||T==En||T==Ur}function ul(_){return typeof _=="number"&&_==Ir(_)}function Zd(_){return typeof _=="number"&&_>-1&&_%1==0&&_<=at}function Bs(_){var T=typeof _;return _!=null&&(T=="object"||T=="function")}function eo(_){return _!=null&&typeof _=="object"}var X0=Vf?wo(Vf):ur;function Ex(_,T){return _===T||$n(_,T,qp(T))}function gT(_,T,D){return D=typeof D=="function"?D:t,$n(_,T,qp(T),D)}function _T(_){return Ix(_)&&_!=+_}function yT(_){if(Ub(_))throw new Ui(a);return Hn(_)}function vT(_){return _===null}function bT(_){return _==null}function Ix(_){return typeof _=="number"||eo(_)&&dt(_)==Pt}function Yd(_){if(!eo(_)||dt(_)!=si)return!1;var T=xc(_);if(T===null)return!0;var D=_r.call(T,"constructor")&&T.constructor;return typeof D=="function"&&D instanceof D&&Jo.call(D)==uu}var Z0=Gf?wo(Gf):di;function Tx(_){return ul(_)&&_>=-at&&_<=at}var Y0=nh?wo(nh):vr;function i_(_){return typeof _=="string"||!fr(_)&&eo(_)&&dt(_)==ui}function Yu(_){return typeof _=="symbol"||eo(_)&&dt(_)==$e}var Vm=Du?wo(Du):bi;function xT(_){return _===t}function ET(_){return eo(_)&&ll(_)==Ei}function IT(_){return eo(_)&&dt(_)==ni}var wx=_u(ss),TT=_u(function(_,T){return _<=T});function va(_){if(!_)return[];if(vu(_))return i_(_)?nr(_):ya(_);if(ju&&_[ju])return qf(_[ju]());var T=ll(_),D=T==yn?Gu:T==Jt?ct:Jd;return D(_)}function Ba(_){if(!_)return _===0?_:0;if(_=cl(_),_===Ue||_===-Ue){var T=_<0?-1:1;return T*ke}return _===_?_:0}function Ir(_){var T=Ba(_),D=T%1;return T===T?D?T-D:T:0}function r_(_){return _?C(Ir(_),0,fn):0}function cl(_){if(typeof _=="number")return _;if(Yu(_))return Dt;if(Bs(_)){var T=typeof _.valueOf=="function"?_.valueOf():_;_=Bs(T)?T+"":T}if(typeof _!="string")return _===0?_:+_;_=Hh(_);var D=On.test(_);return D||ei.test(_)?zf(_.slice(2),D?2:8):Ot.test(_)?Dt:+_}function Sx(_){return ka(_,Ql(_))}function wT(_){return _?C(Ir(_),-at,at):_===0?_:0}function os(_){return _==null?"":gu(_)}var ST=Ac(function(_,T){if(ed(T)||vu(T)){ka(T,Ao(T),_);return}for(var D in T)_r.call(T,D)&&ef(_,D,T[D])}),Cx=Ac(function(_,T){ka(T,Ql(T),_)}),Kd=Ac(function(_,T,D,Z){ka(T,Ql(T),_,Z)}),Ax=Ac(function(_,T,D,Z){ka(T,Ao(T),_,Z)}),Mx=Wu(w);function Es(_,T){var D=Qh(_);return T==null?D:h(D,T)}var K0=Ki(function(_,T){_=us(_);var D=-1,Z=T.length,oe=Z>2?T[2]:t;for(oe&&Tl(T[0],T[1],oe)&&(Z=1);++D<Z;)for(var Ee=T[D],Ge=Ql(Ee),rt=-1,pt=Ge.length;++rt<pt;){var rn=Ge[rt],cn=_[rn];(cn===t||vh(cn,tl[rn])&&!_r.call(_,rn))&&(_[rn]=Ee[rn])}return _}),Lx=Ki(function(_){return _.push(t,b0),Yo(Xy,t,_)});function Rx(_,T){return Zl(_,Vi(T,3),Re)}function id(_,T){return Zl(_,Vi(T,3),Xe)}function Gm(_,T){return _==null?_:Le(_,Vi(T,3),Ql)}function Px(_,T){return _==null?_:Ae(_,Vi(T,3),Ql)}function CT(_,T){return _&&Re(_,Vi(T,3))}function AT(_,T){return _&&Xe(_,Vi(T,3))}function MT(_){return _==null?[]:je(_,Ao(_))}function LT(_){return _==null?[]:je(_,Ql(_))}function J0(_,T,D){var Z=_==null?t:Ke(_,T);return Z===t?D:Z}function RT(_,T){return _!=null&&kb(_,T,Tn)}function Q0(_,T){return _!=null&&kb(_,T,gt)}var PT=Mi(function(_,T,D){T!=null&&typeof T.toString!="function"&&(T=$i.call(T)),_[T]=D},a_(bu)),DT=Mi(function(_,T,D){T!=null&&typeof T.toString!="function"&&(T=$i.call(T)),_r.call(_,T)?_[T].push(D):_[T]=[D]},Vi),Wy=Ki(yt);function Ao(_){return vu(_)?Am(_):$r(_)}function Ql(_){return vu(_)?Am(_,!0):xs(_)}function OT(_,T){var D={};return T=Vi(T,3),Re(_,function(Z,oe,Ee){b(D,T(Z,oe,Ee),Z)}),D}function NT(_,T){var D={};return T=Vi(T,3),Re(_,function(Z,oe,Ee){b(D,oe,T(Z,oe,Ee))}),D}var kT=Ac(function(_,T,D){pu(_,T,D)}),Xy=Ac(function(_,T,D,Z){pu(_,T,D,Z)}),$0=Wu(function(_,T){var D={};if(_==null)return D;var Z=!1;T=Zr(T,function(Ee){return Ee=Gd(Ee,_),Z||(Z=Ee.length>1),Ee}),ka(_,ph(_),D),Z&&(D=P(D,I|A|L,Db));for(var oe=T.length;oe--;)cy(D,T[oe]);return D});function Dx(_,T){return Hm(_,zy(Vi(T)))}var Ku=Wu(function(_,T){return _==null?{}:lo(_,T)});function Hm(_,T){if(_==null)return{};var D=Zr(ph(_),function(Z){return[Z]});return T=Vi(T),ga(_,D,function(Z,oe){return T(Z,oe[0])})}function jm(_,T,D){T=Gd(T,_);var Z=-1,oe=T.length;for(oe||(oe=1,_=t);++Z<oe;){var Ee=_==null?t:_[_h(T[Z])];Ee===t&&(Z=oe,Ee=D),_=cf(Ee)?Ee.call(_):Ee}return _}function e1(_,T,D){return _==null?_:mu(_,T,D)}function Zy(_,T,D,Z){return Z=typeof Z=="function"?Z:t,_==null?_:mu(_,T,D,Z)}var Ox=qd(Ao),t1=qd(Ql);function Nx(_,T,D){var Z=fr(_),oe=Z||nd(_)||Vm(_);if(T=Vi(T,4),D==null){var Ee=_&&_.constructor;oe?D=Z?new Ee:[]:Bs(_)?D=cf(Ee)?Qh(xc(_)):{}:D={}}return(oe?Da:Re)(_,function(Ge,rt,pt){return T(D,Ge,rt,pt)}),D}function FT(_,T){return _==null?!0:cy(_,T)}function kx(_,T,D){return _==null?_:Eb(_,T,dy(D))}function Fx(_,T,D,Z){return Z=typeof Z=="function"?Z:t,_==null?_:Eb(_,T,dy(D),Z)}function Jd(_){return _==null?[]:zu(_,Ao(_))}function Bx(_){return _==null?[]:zu(_,Ql(_))}function BT(_,T,D){return D===t&&(D=T,T=t),D!==t&&(D=cl(D),D=D===D?D:0),T!==t&&(T=cl(T),T=T===T?T:0),C(cl(_),T,D)}function zx(_,T,D){return T=Ba(T),D===t?(D=T,T=0):D=Ba(D),_=cl(_),Zt(_,T,D)}function rd(_,T,D){if(D&&typeof D!="boolean"&&Tl(_,T,D)&&(T=D=t),D===t&&(typeof T=="boolean"?(D=T,T=t):typeof _=="boolean"&&(D=_,_=t)),_===t&&T===t?(_=0,T=1):(_=Ba(_),T===t?(T=_,_=0):T=Ba(T)),_>T){var Z=_;_=T,T=Z}if(D||_%1||T%1){var oe=kp();return Fo(_+oe*(T-_+Tp("1e-"+((oe+"").length-1))),T)}return Cc(_,T)}var Ux=jp(function(_,T,D){return T=T.toLowerCase(),_+(D?n1(T):T)});function n1(_){return o_(os(_).toLowerCase())}function i1(_){return _=os(_),_&&_.replace(Qn,Lp).replace(_o,"")}function Vx(_,T,D){_=os(_),T=gu(T);var Z=_.length;D=D===t?Z:C(Ir(D),0,Z);var oe=D;return D-=T.length,D>=0&&_.slice(D,oe)==T}function zT(_){return _=os(_),_&&Qa.test(_)?_.replace(Ma,jf):_}function UT(_){return _=os(_),_&&te.test(_)?_.replace(we,"\\$&"):_}var Gx=jp(function(_,T,D){return _+(D?"-":"")+T.toLowerCase()}),Hx=jp(function(_,T,D){return _+(D?" ":"")+T.toLowerCase()}),s_=Mb("toLowerCase");function jx(_,T,D){_=os(_),T=Ir(T);var Z=T?Yr(_):0;if(!T||Z>=T)return _;var oe=(T-Z)/2;return al(Dd(oe),D)+_+al(Op(oe),D)}function qx(_,T,D){_=os(_),T=Ir(T);var Z=T?Yr(_):0;return T&&Z<T?_+al(T-Z,D):_}function r1(_,T,D){_=os(_),T=Ir(T);var Z=T?Yr(_):0;return T&&Z<T?al(T-Z,D)+_:_}function qm(_,T,D){return D||T==null?T=0:T&&(T=+T),aa(os(_).replace(re,""),T||0)}function Wx(_,T,D){return(D?Tl(_,T,D):T===t)?T=1:T=Ir(T),ol(os(_),T)}function Yy(){var _=arguments,T=os(_[0]);return _.length<3?T:T.replace(_[1],_[2])}var Xx=jp(function(_,T,D){return _+(D?"_":"")+T.toLowerCase()});function Ky(_,T,D){return D&&typeof D!="number"&&Tl(_,T,D)&&(T=D=t),D=D===t?fn:D>>>0,D?(_=os(_),_&&(typeof T=="string"||T!=null&&!Z0(T))&&(T=gu(T),!T&&Vu(_))?Qf(nr(_),0,D):_.split(T,D)):[]}var Jy=jp(function(_,T,D){return _+(D?" ":"")+o_(T)});function VT(_,T,D){return _=os(_),D=D==null?0:C(Ir(D),0,_.length),T=gu(T),_.slice(D,D+T.length)==T}function GT(_,T,D){var Z=ge.templateSettings;D&&Tl(_,T,D)&&(T=t),_=os(_),T=Kd({},T,Z,Ug);var oe=Kd({},T.imports,Z.imports,Ug),Ee=Ao(oe),Ge=zu(oe,Ee),rt,pt,rn=0,cn=T.interpolate||xr,wn="__p += '",ri=Pd((T.escape||xr).source+"|"+cn.source+"|"+(cn===Zs?nt:xr).source+"|"+(T.evaluate||xr).source+"|$","g"),Ci="//# sourceURL="+(_r.call(T,"sourceURL")?(T.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Qc+"]")+`
`;_.replace(ri,function(ir,Gr,Kr,xu,Sl,Eu){return Kr||(Kr=xu),wn+=_.slice(rn,Eu).replace(Ti,Wh),Gr&&(rt=!0,wn+=`' +
__e(`+Gr+`) +
'`),Sl&&(pt=!0,wn+=`';
`+Sl+`;
__p += '`),Kr&&(wn+=`' +
((__t = (`+Kr+`)) == null ? '' : __t) +
'`),rn=Eu+ir.length,ir}),wn+=`';
`;var er=_r.call(T,"variable")&&T.variable;if(!er)wn=`with (obj) {
`+wn+`
}
`;else if(Je.test(er))throw new Ui(s);wn=(pt?wn.replace(qs,""):wn).replace(No,"$1").replace(Ja,"$1;"),wn="function("+(er||"obj")+`) {
`+(er?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(rt?", __e = _.escape":"")+(pt?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+wn+`return __p
}`;var Sr=sd(function(){return Or(Ee,Ci+"return "+wn).apply(t,Ge)});if(Sr.source=wn,jy(Sr))throw Sr;return Sr}function HT(_){return os(_).toLowerCase()}function jT(_){return os(_).toUpperCase()}function qT(_,T,D){if(_=os(_),_&&(D||T===t))return Hh(_);if(!_||!(T=gu(T)))return _;var Z=nr(_),oe=nr(T),Ee=Uu(Z,oe),Ge=qh(Z,oe)+1;return Qf(Z,Ee,Ge).join("")}function Wm(_,T,D){if(_=os(_),_&&(D||T===t))return _.slice(0,Rs(_)+1);if(!_||!(T=gu(T)))return _;var Z=nr(_),oe=qh(Z,nr(T))+1;return Qf(Z,0,oe).join("")}function s1(_,T,D){if(_=os(_),_&&(D||T===t))return _.replace(re,"");if(!_||!(T=gu(T)))return _;var Z=nr(_),oe=Uu(Z,nr(T));return Qf(Z,oe).join("")}function WT(_,T){var D=fe,Z=le;if(Bs(T)){var oe="separator"in T?T.separator:oe;D="length"in T?Ir(T.length):D,Z="omission"in T?gu(T.omission):Z}_=os(_);var Ee=_.length;if(Vu(_)){var Ge=nr(_);Ee=Ge.length}if(D>=Ee)return _;var rt=D-Yr(Z);if(rt<1)return Z;var pt=Ge?Qf(Ge,0,rt).join(""):_.slice(0,rt);if(oe===t)return pt+Z;if(Ge&&(rt+=pt.length-rt),Z0(oe)){if(_.slice(rt).search(oe)){var rn,cn=pt;for(oe.global||(oe=Pd(oe.source,os(be.exec(oe))+"g")),oe.lastIndex=0;rn=oe.exec(cn);)var wn=rn.index;pt=pt.slice(0,wn===t?rt:wn)}}else if(_.indexOf(gu(oe),rt)!=rt){var ri=pt.lastIndexOf(oe);ri>-1&&(pt=pt.slice(0,ri))}return pt+Z}function Zx(_){return _=os(_),_&&Vl.test(_)?_.replace(go,yo):_}var XT=jp(function(_,T,D){return _+(D?" ":"")+T.toUpperCase()}),o_=Mb("toUpperCase");function Yx(_,T,D){return _=os(_),T=D?t:T,T===t?Rp(_)?ao(_):Fu(_):_.match(T)||[]}var sd=Ki(function(_,T){try{return Yo(_,t,T)}catch(D){return jy(D)?D:new Ui(D)}}),Kx=Wu(function(_,T){return Da(T,function(D){D=_h(D),b(_,D,q0(_[D],_))}),_});function Jx(_){var T=_==null?0:_.length,D=Vi();return _=T?Zr(_,function(Z){if(typeof Z[1]!="function")throw new gr(l);return[D(Z[0]),Z[1]]}):[],Ki(function(Z){for(var oe=-1;++oe<T;){var Ee=_[oe];if(Yo(Ee[0],this,Z))return Yo(Ee[1],this,Z)}})}function Qy(_){return k(P(_,I))}function a_(_){return function(){return _}}function ZT(_,T){return _==null||_!==_?T:_}var Qx=Rb(),$p=Rb(!0);function bu(_){return _}function hf(_){return Wr(typeof _=="function"?_:P(_,I))}function YT(_){return sl(P(_,I))}function l_(_,T){return du(_,P(T,I))}var u_=Ki(function(_,T){return function(D){return yt(D,_,T)}}),c_=Ki(function(_,T){return function(D){return yt(_,D,T)}});function em(_,T,D){var Z=Ao(T),oe=je(T,Z);D==null&&!(Bs(T)&&(oe.length||!Z.length))&&(D=T,T=_,_=this,oe=je(T,Ao(T)));var Ee=!(Bs(D)&&"chain"in D)||!!D.chain,Ge=cf(_);return Da(oe,function(rt){var pt=T[rt];_[rt]=pt,Ge&&(_.prototype[rt]=function(){var rn=this.__chain__;if(Ee||rn){var cn=_(this.__wrapped__),wn=cn.__actions__=ya(this.__actions__);return wn.push({func:pt,args:arguments,thisArg:_}),cn.__chain__=rn,cn}return pt.apply(_,Xl([this.value()],arguments))})}),_}function $y(){return Ks._===this&&(Ks._=Em),this}function o1(){}function KT(_){return _=Ir(_),Ki(function(T){return cs(T,_)})}var Xm=Rm(Zr),ev=Rm(Er),JT=Rm(Vh);function a1(_){return vy(_)?_c(_h(_)):Ms(_)}function $x(_){return function(T){return _==null?t:Ke(_,T)}}var QT=v0(),eE=v0(!0);function l1(){return[]}function tv(){return!1}function $T(){return{}}function tE(){return""}function ew(){return!0}function tw(_,T){if(_=Ir(_),_<1||_>at)return[];var D=fn,Z=Fo(_,fn);T=Vi(T),_-=fn;for(var oe=Gh(Z,T);++D<_;)T(D);return oe}function nv(_){return fr(_)?Zr(_,_h):Yu(_)?[_]:ya(C0(os(_)))}function iv(_){var T=++nl;return os(_)+T}var rv=fh(function(_,T){return _+T},0),nw=$f("ceil"),u1=fh(function(_,T){return _/T},1),c1=$f("floor");function Qd(_){return _&&_.length?_e(_,bu,xt):t}function iw(_,T){return _&&_.length?_e(_,Vi(T,2),xt):t}function h1(_){return Cp(_,bu)}function nE(_,T){return Cp(_,Vi(T,2))}function sv(_){return _&&_.length?_e(_,bu,ss):t}function rw(_,T){return _&&_.length?_e(_,Vi(T,2),ss):t}var sw=fh(function(_,T){return _*T},1),ow=$f("round"),aw=fh(function(_,T){return _-T},0);function f1(_){return _&&_.length?Mp(_,bu):0}function lw(_,T){return _&&_.length?Mp(_,Vi(T,2)):0}return ge.after=$g,ge.ary=dx,ge.assign=ST,ge.assignIn=Cx,ge.assignInWith=Kd,ge.assignWith=Ax,ge.at=Mx,ge.before=Ny,ge.bind=q0,ge.bindAll=Kx,ge.bindKey=ky,ge.castArray=hT,ge.chain=z0,ge.chunk=Om,ge.compact=Nm,ge.concat=Wg,ge.cond=Jx,ge.conforms=Qy,ge.constant=a_,ge.countBy=ax,ge.create=Es,ge.curry=Fy,ge.curryRight=e_,ge.debounce=px,ge.defaults=K0,ge.defaultsDeep=Lx,ge.defer=iT,ge.delay=rT,ge.difference=wy,ge.differenceBy=Vb,ge.differenceWith=Xg,ge.drop=A0,ge.dropRight=Gb,ge.dropRightWhile=km,ge.dropWhile=Hb,ge.fill=M0,ge.filter=Yg,ge.flatMap=JI,ge.flatMapDeep=QI,ge.flatMapDepth=$I,ge.flatten=qb,ge.flattenDeep=Zg,ge.flattenDepth=Wb,ge.flip=sT,ge.flow=Qx,ge.flowRight=$p,ge.fromPairs=kr,ge.functions=MT,ge.functionsIn=LT,ge.groupBy=G0,ge.initial=uf,ge.intersection=yh,ge.intersectionBy=Zu,ge.intersectionWith=Fa,ge.invert=PT,ge.invertBy=DT,ge.invokeMap=Um,ge.iteratee=hf,ge.keyBy=tT,ge.keys=Ao,ge.keysIn=Ql,ge.map=$s,ge.mapKeys=OT,ge.mapValues=NT,ge.matches=YT,ge.matchesProperty=l_,ge.memoize=By,ge.merge=kT,ge.mergeWith=Xy,ge.method=u_,ge.methodOf=c_,ge.mixin=em,ge.negate=zy,ge.nthArg=KT,ge.omit=$0,ge.omitBy=Dx,ge.once=Uy,ge.orderBy=Py,ge.over=Xm,ge.overArgs=oT,ge.overEvery=ev,ge.overSome=JT,ge.partial=Vy,ge.partialRight=Qp,ge.partition=cx,ge.pick=Ku,ge.pickBy=Hm,ge.property=a1,ge.propertyOf=$x,ge.pull=R0,ge.pullAll=P0,ge.pullAllBy=D0,ge.pullAllWith=kI,ge.pullAt=O0,ge.range=QT,ge.rangeRight=eE,ge.rearg=aT,ge.reject=Kg,ge.remove=Yb,ge.rest=lT,ge.reverse=N0,ge.sampleSize=fx,ge.set=e1,ge.setWith=Zy,ge.shuffle=Jg,ge.slice=td,ge.sortBy=nT,ge.sortedUniq=Jb,ge.sortedUniqBy=BI,ge.split=Ky,ge.spread=uT,ge.tail=F0,ge.take=zI,ge.takeRight=B0,ge.takeRightWhile=Qb,ge.takeWhile=$b,ge.tap=U0,ge.throttle=mx,ge.thru=Rc,ge.toArray=va,ge.toPairs=Ox,ge.toPairsIn=t1,ge.toPath=nv,ge.toPlainObject=Sx,ge.transform=Nx,ge.unary=gx,ge.union=Kp,ge.unionBy=ex,ge.unionWith=UI,ge.uniq=Bm,ge.uniqBy=My,ge.uniqWith=tx,ge.unset=FT,ge.unzip=Ly,ge.unzipWith=nx,ge.update=kx,ge.updateWith=Fx,ge.values=Jd,ge.valuesIn=Bx,ge.without=VI,ge.words=Yx,ge.wrap=cT,ge.xor=ix,ge.xorBy=GI,ge.xorWith=rx,ge.zip=HI,ge.zipObject=jI,ge.zipObjectDeep=sx,ge.zipWith=ox,ge.entries=Ox,ge.entriesIn=t1,ge.extend=Cx,ge.extendWith=Kd,em(ge,ge),ge.add=rv,ge.attempt=sd,ge.camelCase=Ux,ge.capitalize=n1,ge.ceil=nw,ge.clamp=BT,ge.clone=fT,ge.cloneDeep=Gy,ge.cloneDeepWith=Hy,ge.cloneWith=W0,ge.conformsTo=dT,ge.deburr=i1,ge.defaultTo=ZT,ge.divide=u1,ge.endsWith=Vx,ge.eq=vh,ge.escape=zT,ge.escapeRegExp=UT,ge.every=Jp,ge.find=YI,ge.findIndex=L0,ge.findKey=Rx,ge.findLast=KI,ge.findLastIndex=jb,ge.findLastKey=id,ge.floor=c1,ge.forEach=lx,ge.forEachRight=ux,ge.forIn=Gm,ge.forInRight=Px,ge.forOwn=CT,ge.forOwnRight=AT,ge.get=J0,ge.gt=t_,ge.gte=n_,ge.has=RT,ge.hasIn=Q0,ge.head=Sy,ge.identity=bu,ge.includes=eT,ge.indexOf=lf,ge.inRange=zx,ge.invoke=Wy,ge.isArguments=Xd,ge.isArray=fr,ge.isArrayBuffer=_x,ge.isArrayLike=vu,ge.isArrayLikeObject=zo,ge.isBoolean=yx,ge.isBuffer=nd,ge.isDate=vx,ge.isElement=bx,ge.isEmpty=xx,ge.isEqual=pT,ge.isEqualWith=mT,ge.isError=jy,ge.isFinite=qy,ge.isFunction=cf,ge.isInteger=ul,ge.isLength=Zd,ge.isMap=X0,ge.isMatch=Ex,ge.isMatchWith=gT,ge.isNaN=_T,ge.isNative=yT,ge.isNil=bT,ge.isNull=vT,ge.isNumber=Ix,ge.isObject=Bs,ge.isObjectLike=eo,ge.isPlainObject=Yd,ge.isRegExp=Z0,ge.isSafeInteger=Tx,ge.isSet=Y0,ge.isString=i_,ge.isSymbol=Yu,ge.isTypedArray=Vm,ge.isUndefined=xT,ge.isWeakMap=ET,ge.isWeakSet=IT,ge.join=Xb,ge.kebabCase=Gx,ge.last=Ds,ge.lastIndexOf=Zb,ge.lowerCase=Hx,ge.lowerFirst=s_,ge.lt=wx,ge.lte=TT,ge.max=Qd,ge.maxBy=iw,ge.mean=h1,ge.meanBy=nE,ge.min=sv,ge.minBy=rw,ge.stubArray=l1,ge.stubFalse=tv,ge.stubObject=$T,ge.stubString=tE,ge.stubTrue=ew,ge.multiply=sw,ge.nth=Fm,ge.noConflict=$y,ge.noop=o1,ge.now=Qg,ge.pad=jx,ge.padEnd=qx,ge.padStart=r1,ge.parseInt=qm,ge.random=rd,ge.reduce=Dy,ge.reduceRight=Oy,ge.repeat=Wx,ge.replace=Yy,ge.result=jm,ge.round=ow,ge.runInContext=lt,ge.sample=hx,ge.size=H0,ge.snakeCase=Xx,ge.some=j0,ge.sortedIndex=Yp,ge.sortedIndexBy=Cy,ge.sortedIndexOf=Ay,ge.sortedLastIndex=k0,ge.sortedLastIndexBy=Kb,ge.sortedLastIndexOf=FI,ge.startCase=Jy,ge.startsWith=VT,ge.subtract=aw,ge.sum=f1,ge.sumBy=lw,ge.template=GT,ge.times=tw,ge.toFinite=Ba,ge.toInteger=Ir,ge.toLength=r_,ge.toLower=HT,ge.toNumber=cl,ge.toSafeInteger=wT,ge.toString=os,ge.toUpper=jT,ge.trim=qT,ge.trimEnd=Wm,ge.trimStart=s1,ge.truncate=WT,ge.unescape=Zx,ge.uniqueId=iv,ge.upperCase=XT,ge.upperFirst=o_,ge.each=lx,ge.eachRight=ux,ge.first=Sy,em(ge,function(){var _={};return Re(ge,function(T,D){_r.call(ge.prototype,D)||(_[D]=T)}),_}(),{chain:!1}),ge.VERSION=i,Da(["bind","bindKey","curry","curryRight","partial","partialRight"],function(_){ge[_].placeholder=ge}),Da(["drop","take"],function(_,T){Yi.prototype[_]=function(D){D=D===t?1:bo(Ir(D),0);var Z=this.__filtered__&&!T?new Yi(this):this.clone();return Z.__filtered__?Z.__takeCount__=Fo(D,Z.__takeCount__):Z.__views__.push({size:Fo(D,fn),type:_+(Z.__dir__<0?"Right":"")}),Z},Yi.prototype[_+"Right"]=function(D){return this.reverse()[_](D).reverse()}}),Da(["filter","map","takeWhile"],function(_,T){var D=T+1,Z=D==Ce||D==Et;Yi.prototype[_]=function(oe){var Ee=this.clone();return Ee.__iteratees__.push({iteratee:Vi(oe,3),type:D}),Ee.__filtered__=Ee.__filtered__||Z,Ee}}),Da(["head","last"],function(_,T){var D="take"+(T?"Right":"");Yi.prototype[_]=function(){return this[D](1).value()[0]}}),Da(["initial","tail"],function(_,T){var D="drop"+(T?"":"Right");Yi.prototype[_]=function(){return this.__filtered__?new Yi(this):this[D](1)}}),Yi.prototype.compact=function(){return this.filter(bu)},Yi.prototype.find=function(_){return this.filter(_).head()},Yi.prototype.findLast=function(_){return this.reverse().find(_)},Yi.prototype.invokeMap=Ki(function(_,T){return typeof _=="function"?new Yi(this):this.map(function(D){return yt(D,_,T)})}),Yi.prototype.reject=function(_){return this.filter(zy(Vi(_)))},Yi.prototype.slice=function(_,T){_=Ir(_);var D=this;return D.__filtered__&&(_>0||T<0)?new Yi(D):(_<0?D=D.takeRight(-_):_&&(D=D.drop(_)),T!==t&&(T=Ir(T),D=T<0?D.dropRight(-T):D.take(T-_)),D)},Yi.prototype.takeRightWhile=function(_){return this.reverse().takeWhile(_).reverse()},Yi.prototype.toArray=function(){return this.take(fn)},Re(Yi.prototype,function(_,T){var D=/^(?:filter|find|map|reject)|While$/.test(T),Z=/^(?:head|last)$/.test(T),oe=ge[Z?"take"+(T=="last"?"Right":""):T],Ee=Z||/^find/.test(T);oe&&(ge.prototype[T]=function(){var Ge=this.__wrapped__,rt=Z?[1]:arguments,pt=Ge instanceof Yi,rn=rt[0],cn=pt||fr(Ge),wn=function(Gr){var Kr=oe.apply(ge,Xl([Gr],rt));return Z&&ri?Kr[0]:Kr};cn&&D&&typeof rn=="function"&&rn.length!=1&&(pt=cn=!1);var ri=this.__chain__,Ci=!!this.__actions__.length,er=Ee&&!ri,Sr=pt&&!Ci;if(!Ee&&cn){Ge=Sr?Ge:new Yi(this);var ir=_.apply(Ge,rt);return ir.__actions__.push({func:Rc,args:[wn],thisArg:t}),new rl(ir,ri)}return er&&Sr?_.apply(this,rt):(ir=this.thru(wn),er?Z?ir.value()[0]:ir.value():ir)})}),Da(["pop","push","shift","sort","splice","unshift"],function(_){var T=Hu[_],D=/^(?:push|sort|unshift)$/.test(_)?"tap":"thru",Z=/^(?:pop|shift)$/.test(_);ge.prototype[_]=function(){var oe=arguments;if(Z&&!this.__chain__){var Ee=this.value();return T.apply(fr(Ee)?Ee:[],oe)}return this[D](function(Ge){return T.apply(fr(Ge)?Ge:[],oe)})}}),Re(Yi.prototype,function(_,T){var D=ge[T];if(D){var Z=D.name+"";_r.call(Zf,Z)||(Zf[Z]=[]),Zf[Z].push({name:T,func:D})}}),Zf[Qs(t,z).name]=[{name:"wrapper",func:t}],Yi.prototype.clone=d0,Yi.prototype.reverse=$_,Yi.prototype.value=p0,ge.prototype.at=yu,ge.prototype.chain=qI,ge.prototype.commit=V0,ge.prototype.next=WI,ge.prototype.plant=ZI,ge.prototype.reverse=zm,ge.prototype.toJSON=ge.prototype.valueOf=ge.prototype.value=Ry,ge.prototype.first=ge.prototype.head,ju&&(ge.prototype[ju]=XI),ge},So=Kl();bs?((bs.exports=So)._=So,Wl._=So):Ks._=So}).call(ld)})(OE,OE.exports);var dL=OE.exports;const wh=ES(dL);function ob(n){return v_(n)||b_(n)||pL(n)||mL(n)||zc(n)||ud(n)||H_(n)}function v_(n){return n.type==="Point"}function b_(n){return n.type==="MultiPoint"}function pL(n){return n.type==="LineString"}function mL(n){return n.type==="MultiLineString"}function zc(n){return n.type==="Polygon"}function ud(n){return n.type==="MultiPolygon"}function bp(n){return n.type==="Feature"}function Ef(n){return n.type==="FeatureCollection"}function H_(n){return n.type==="GeometryCollection"}function VP(n){if(n&&typeof n=="object"){if(n.type==="FeatureCollection"&&Array.isArray(n.features))return n.features.every(e=>e&&typeof e=="object"&&e.type==="Feature"&&e.geometry&&typeof e.geometry=="object");if(n.type==="Feature"&&n.geometry&&typeof n.geometry=="object")return!0;if(n.type&&typeof n.type=="string"&&n.geometry&&typeof n.geometry=="object")return!0;if(n.type&&typeof n.type=="string"&&n.geometries&&Array.isArray(n.geometries))return!0;if(HP(n.type)&&n.coordinates)return!0}return!1}function F1(n,e){return n.type==="Point"?{...n,coordinates:e.forward(n.coordinates)}:n.type==="LineString"||n.type==="MultiPoint"?{...n,coordinates:n.coordinates.map(e.forward)}:n.type==="Polygon"||n.type==="MultiLineString"?{...n,coordinates:n.coordinates.map(t=>t.map(e.forward))}:n.type==="MultiPolygon"?{...n,coordinates:n.coordinates.map(t=>t.map(i=>i.map(e.forward)))}:n.type==="GeometryCollection"?{...n,geometries:n.geometries.map(t=>F1(t,e))}:n}const GP=()=>(...n)=>n;function HP(n){return GP()("Feature","FeatureCollection","GeometryCollection","LineString","MultiLineString","MultiPoint","MultiPolygon","Point","Polygon").some(t=>n===t)}function cI(n){if(n===void 0||dL.isString(n))throw new Error("Invalid data");return n.map(e=>Ef(e)?e.features.every(t=>zc(t.geometry)||ud(t.geometry))?{type:"MultiPolygon",coordinates:e.features.flatMap(t=>ud(t.geometry)?t.geometry.coordinates:zc(t.geometry)?[t.geometry.coordinates]:[])}:null:bp(e)?e.geometry:H_(e)?e.geometries.every(t=>zc(t)||ud(t))?{type:"MultiPolygon",coordinates:e.geometries.flatMap(t=>ud(t)?t.coordinates:zc(t)?[t.coordinates]:[])}:null:zc(e)||ud(e)?e:null)}function jP(){const{subscribe:n,set:e,update:t}=Eh([]),{subscribe:i,set:r}=Eh();return{subscribe:n,set:e,update:t,add:a=>t(l=>[a,...l]),getUniqueLayerId:a=>{const l=ap(Lo);if(l.map(s=>s.id).includes(a.id)){const s=l.map(d=>d.id).filter(d=>d.startsWith(a.id)).length;a.id+=`_${s}`,a.displayName+=`_${s}`}return a},setNewLayerIndex:r,subscribeNewLayerIndex:i,toggleVisibility:a=>t(l=>{const s=l.find(d=>d.id===a);if(!s)throw new Error("Invalid layer id");return s.isVisible=!s.isVisible,l}),deleteLayer:a=>t(l=>l.filter(s=>s.id!==a))}}const Lo=jP(),CC=["#FF5733","#F2BE22","#17BEBB","#7B68EE","#FF8C00","#00BFFF","#9932CC","#2E8B57","#FF1493","#8B4513"];let qP=0;const IS=()=>CC[qP++%CC.length];function WP(n){return typeof n=="string"}function gd(n){return n!==void 0&&!WP(n)}function TS(n,e,t){const i=e.geojson.data;if(!gd(i))throw new Error("Invalid data source");switch(i.type){case"Point":case"MultiPoint":wS(n,i,e.id,t);break;case"LineString":case"MultiLineString":SS(n,i,e.id,t);break;case"Polygon":case"MultiPolygon":CS(n,i,e.id,t);break;case"Feature":XP(n,e,t);break;case"GeometryCollection":ZP(n,e,t);break;case"FeatureCollection":YP(n,e,t);break}}function wS(n,e,t,i){let r={id:G_.getUniqueSourceId(t+"-point"),type:"circle",source:{type:"geojson",data:e,generateId:!0},paint:{"circle-color":IS()},isVisible:!0,displayName:t,...i};r=Lo.getUniqueLayerId(r),Lo.add(r),n.addLayer(r)}function SS(n,e,t,i){let r={id:G_.getUniqueSourceId(t+"-line"),type:"line",source:{type:"geojson",data:e,generateId:!0},paint:{"line-color":IS()},isVisible:!0,displayName:t,...i};r=Lo.getUniqueLayerId(r),Lo.add(r),n.addLayer(r)}function CS(n,e,t,i){let r={id:G_.getUniqueSourceId(t+"-polygon"),type:"fill",source:{type:"geojson",data:e,generateId:!0},paint:{"fill-color":IS(),"fill-opacity":.5,"fill-outline-color":"#000"},isVisible:!0,displayName:t,...i};r=Lo.getUniqueLayerId(r),Lo.add(r),n.addLayer(r)}function XP(n,e,t){const i=e.geojson.data;if(!gd(i)||!bp(i))throw new Error("Not a Feature");TS(n,{...e,geojson:{type:"geojson",data:i.geometry}},t)}function ZP(n,e,t){const i=e.geojson.data;if(!gd(i)||!H_(i))throw new Error("Not a GeometryCollection");const r=wh.groupBy(i.geometries,a=>{switch(a.type){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"GeometryCollection":throw new Error("Invalid structure")}});wh.forEach(r,(a,l)=>{const s={type:"GeometryCollection",geometries:a};switch(l){case"Point":wS(n,s,e.id,t);break;case"LineString":SS(n,s,e.id,t);break;case"Polygon":CS(n,s,e.id,t);break}})}function YP(n,e,t){const i=e.geojson.data;if(!gd(i)||!Ef(i))throw new Error("Not a FeaureCollection");const r=wh.groupBy(i.features,a=>{switch(a.geometry.type){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"GeometryCollection":throw new Error("Invalid structure")}});wh.forEach(r,(a,l)=>{const s={type:"FeatureCollection",features:a};switch(l){case"Point":wS(n,s,e.id,t);break;case"LineString":SS(n,s,e.id,t);break;case"Polygon":CS(n,s,e.id,t);break}})}var Ww=function(n,e){return Ww=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},Ww(n,e)};function Wo(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Ww(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var zr=function(){return zr=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},zr.apply(this,arguments)};function KP(n,e,t,i){function r(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function s(x){try{g(i.next(x))}catch(I){l(I)}}function d(x){try{g(i.throw(x))}catch(I){l(I)}}function g(x){x.done?a(x.value):r(x.value).then(s,d)}g((i=i.apply(n,e||[])).next())})}function JP(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,r,a,l;return l={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function s(g){return function(x){return d([g,x])}}function d(g){if(i)throw new TypeError("Generator is already executing.");for(;l&&(l=0,g[0]&&(t=0)),t;)try{if(i=1,r&&(a=g[0]&2?r.return:g[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,g[1])).done)return a;switch(r=0,a&&(g=[g[0]&2,a.value]),g[0]){case 0:case 1:a=g;break;case 4:return t.label++,{value:g[1],done:!1};case 5:t.label++,r=g[1],g=[0];continue;case 7:g=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(g[0]===6||g[0]===2)){t=0;continue}if(g[0]===3&&(!a||g[1]>a[0]&&g[1]<a[3])){t.label=g[1];break}if(g[0]===6&&t.label<a[1]){t.label=a[1],a=g;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(g);break}a[2]&&t.ops.pop(),t.trys.pop();continue}g=e.call(n,t)}catch(x){g=[6,x],r=0}finally{i=a=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}}function nu(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Xw(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var i=t.call(n),r,a=[],l;try{for(;(e===void 0||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(s){l={error:s}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(l)throw l.error}}return a}function QP(n,e,t){if(t||arguments.length===2)for(var i=0,r=e.length,a;i<r;i++)(a||!(i in e))&&(a||(a=Array.prototype.slice.call(e,0,i)),a[i]=e[i]);return n.concat(a||Array.prototype.slice.call(e))}/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var xl=function(){function n(e){e===void 0&&(e={}),this.adapter=e}return Object.defineProperty(n,"cssClasses",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(n,"strings",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(n,"numbers",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(n,"defaultAdapter",{get:function(){return{}},enumerable:!1,configurable:!0}),n.prototype.init=function(){},n.prototype.destroy=function(){},n}();/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Uc;(function(n){n.RICH="mdc-tooltip--rich",n.SHOWN="mdc-tooltip--shown",n.SHOWING="mdc-tooltip--showing",n.SHOWING_TRANSITION="mdc-tooltip--showing-transition",n.HIDE="mdc-tooltip--hide",n.HIDE_TRANSITION="mdc-tooltip--hide-transition",n.MULTILINE_TOOLTIP="mdc-tooltip--multiline",n.SURFACE="mdc-tooltip__surface",n.SURFACE_ANIMATION="mdc-tooltip__surface-animation",n.TOOLTIP_CARET_TOP="mdc-tooltip__caret-surface-top",n.TOOLTIP_CARET_BOTTOM="mdc-tooltip__caret-surface-bottom"})(Uc||(Uc={}));var Ju={BOUNDED_ANCHOR_GAP:4,UNBOUNDED_ANCHOR_GAP:8,MIN_VIEWPORT_TOOLTIP_THRESHOLD:8,HIDE_DELAY_MS:600,SHOW_DELAY_MS:500,MIN_HEIGHT:24,MAX_WIDTH:200,CARET_INDENTATION:24,ANIMATION_SCALE:.8},sE={ARIA_EXPANDED:"aria-expanded",ARIA_HASPOPUP:"aria-haspopup",PERSISTENT:"data-mdc-tooltip-persistent",SCROLLABLE_ANCESTOR:"tooltip-scrollable-ancestor",HAS_CARET:"data-mdc-tooltip-has-caret"},x_;(function(n){n[n.DETECTED=0]="DETECTED",n[n.START=1]="START",n[n.CENTER=2]="CENTER",n[n.END=3]="END"})(x_||(x_={}));var xv;(function(n){n[n.DETECTED=0]="DETECTED",n[n.ABOVE=1]="ABOVE",n[n.BELOW=2]="BELOW"})(xv||(xv={}));var NE;(function(n){n[n.BOUNDED=0]="BOUNDED",n[n.UNBOUNDED=1]="UNBOUNDED"})(NE||(NE={}));var ar={LEFT:"left",RIGHT:"right",CENTER:"center",TOP:"top",BOTTOM:"bottom"},Hr;(function(n){n[n.DETECTED=0]="DETECTED",n[n.ABOVE_START=1]="ABOVE_START",n[n.ABOVE_CENTER=2]="ABOVE_CENTER",n[n.ABOVE_END=3]="ABOVE_END",n[n.TOP_SIDE_START=4]="TOP_SIDE_START",n[n.CENTER_SIDE_START=5]="CENTER_SIDE_START",n[n.BOTTOM_SIDE_START=6]="BOTTOM_SIDE_START",n[n.TOP_SIDE_END=7]="TOP_SIDE_END",n[n.CENTER_SIDE_END=8]="CENTER_SIDE_END",n[n.BOTTOM_SIDE_END=9]="BOTTOM_SIDE_END",n[n.BELOW_START=10]="BELOW_START",n[n.BELOW_CENTER=11]="BELOW_CENTER",n[n.BELOW_END=12]="BELOW_END"})(Hr||(Hr={}));var ml;(function(n){n[n.ABOVE=1]="ABOVE",n[n.BELOW=2]="BELOW",n[n.SIDE_TOP=3]="SIDE_TOP",n[n.SIDE_CENTER=4]="SIDE_CENTER",n[n.SIDE_BOTTOM=5]="SIDE_BOTTOM"})(ml||(ml={}));var hs;(function(n){n[n.START=1]="START",n[n.CENTER=2]="CENTER",n[n.END=3]="END",n[n.SIDE_START=4]="SIDE_START",n[n.SIDE_END=5]="SIDE_END"})(hs||(hs={}));/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var AS=function(){function n(){this.rafIDs=new Map}return n.prototype.request=function(e,t){var i=this;this.cancel(e);var r=requestAnimationFrame(function(a){i.rafIDs.delete(e),t(a)});this.rafIDs.set(e,r)},n.prototype.cancel=function(e){var t=this.rafIDs.get(e);t&&(cancelAnimationFrame(t),this.rafIDs.delete(e))},n.prototype.cancelAll=function(){var e=this;this.rafIDs.forEach(function(t,i){e.cancel(i)})},n.prototype.getQueue=function(){var e=[];return this.rafIDs.forEach(function(t,i){e.push(i)}),e},n}();/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var AC={animation:{prefixed:"-webkit-animation",standard:"animation"},transform:{prefixed:"-webkit-transform",standard:"transform"},transition:{prefixed:"-webkit-transition",standard:"transition"}};function $P(n){return!!n.document&&typeof n.document.createElement=="function"}function kE(n,e){if($P(n)&&e in AC){var t=n.document.createElement("div"),i=AC[e],r=i.standard,a=i.prefixed,l=r in t.style;return l?r:a}return e}/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Pr={UNKNOWN:"Unknown",BACKSPACE:"Backspace",ENTER:"Enter",SPACEBAR:"Spacebar",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",END:"End",HOME:"Home",ARROW_LEFT:"ArrowLeft",ARROW_UP:"ArrowUp",ARROW_RIGHT:"ArrowRight",ARROW_DOWN:"ArrowDown",DELETE:"Delete",ESCAPE:"Escape",TAB:"Tab"},hc=new Set;hc.add(Pr.BACKSPACE);hc.add(Pr.ENTER);hc.add(Pr.SPACEBAR);hc.add(Pr.PAGE_UP);hc.add(Pr.PAGE_DOWN);hc.add(Pr.END);hc.add(Pr.HOME);hc.add(Pr.ARROW_LEFT);hc.add(Pr.ARROW_UP);hc.add(Pr.ARROW_RIGHT);hc.add(Pr.ARROW_DOWN);hc.add(Pr.DELETE);hc.add(Pr.ESCAPE);hc.add(Pr.TAB);var Zc={BACKSPACE:8,ENTER:13,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46,ESCAPE:27,TAB:9},fc=new Map;fc.set(Zc.BACKSPACE,Pr.BACKSPACE);fc.set(Zc.ENTER,Pr.ENTER);fc.set(Zc.SPACEBAR,Pr.SPACEBAR);fc.set(Zc.PAGE_UP,Pr.PAGE_UP);fc.set(Zc.PAGE_DOWN,Pr.PAGE_DOWN);fc.set(Zc.END,Pr.END);fc.set(Zc.HOME,Pr.HOME);fc.set(Zc.ARROW_LEFT,Pr.ARROW_LEFT);fc.set(Zc.ARROW_UP,Pr.ARROW_UP);fc.set(Zc.ARROW_RIGHT,Pr.ARROW_RIGHT);fc.set(Zc.ARROW_DOWN,Pr.ARROW_DOWN);fc.set(Zc.DELETE,Pr.DELETE);fc.set(Zc.ESCAPE,Pr.ESCAPE);fc.set(Zc.TAB,Pr.TAB);var Eg=new Set;Eg.add(Pr.PAGE_UP);Eg.add(Pr.PAGE_DOWN);Eg.add(Pr.END);Eg.add(Pr.HOME);Eg.add(Pr.ARROW_LEFT);Eg.add(Pr.ARROW_UP);Eg.add(Pr.ARROW_RIGHT);Eg.add(Pr.ARROW_DOWN);function Ia(n){var e=n.key;if(hc.has(e))return e;var t=fc.get(n.keyCode);return t||Pr.UNKNOWN}/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var eD=Uc.RICH,xw=Uc.SHOWN,Ew=Uc.SHOWING,oE=Uc.SHOWING_TRANSITION,y1=Uc.HIDE,aE=Uc.HIDE_TRANSITION,tD=Uc.MULTILINE_TOOLTIP,Zw;(function(n){n.POLL_ANCHOR="poll_anchor"})(Zw||(Zw={}));var MC=typeof window<"u",nD=function(n){Wo(e,n);function e(t){var i=n.call(this,zr(zr({},e.defaultAdapter),t))||this;return i.tooltipShown=!1,i.anchorGap=Ju.BOUNDED_ANCHOR_GAP,i.xTooltipPos=x_.DETECTED,i.yTooltipPos=xv.DETECTED,i.tooltipPositionWithCaret=Hr.DETECTED,i.minViewportTooltipThreshold=Ju.MIN_VIEWPORT_TOOLTIP_THRESHOLD,i.hideDelayMs=Ju.HIDE_DELAY_MS,i.showDelayMs=Ju.SHOW_DELAY_MS,i.anchorRect=null,i.parentRect=null,i.frameId=null,i.hideTimeout=null,i.showTimeout=null,i.addAncestorScrollEventListeners=new Array,i.removeAncestorScrollEventListeners=new Array,i.animFrame=new AS,i.anchorBlurHandler=function(r){i.handleAnchorBlur(r)},i.documentClickHandler=function(r){i.handleDocumentClick(r)},i.documentKeydownHandler=function(r){i.handleKeydown(r)},i.tooltipMouseEnterHandler=function(){i.handleTooltipMouseEnter()},i.tooltipMouseLeaveHandler=function(){i.handleTooltipMouseLeave()},i.richTooltipFocusOutHandler=function(r){i.handleRichTooltipFocusOut(r)},i.windowScrollHandler=function(){i.handleWindowScrollEvent()},i.windowResizeHandler=function(){i.handleWindowChangeEvent()},i}return Object.defineProperty(e,"defaultAdapter",{get:function(){return{getAttribute:function(){return null},setAttribute:function(){},removeAttribute:function(){},addClass:function(){},hasClass:function(){return!1},removeClass:function(){},getComputedStyleProperty:function(){return""},setStyleProperty:function(){},setSurfaceAnimationStyleProperty:function(){},getViewportWidth:function(){return 0},getViewportHeight:function(){return 0},getTooltipSize:function(){return{width:0,height:0}},getAnchorBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},getParentBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},getAnchorAttribute:function(){return null},setAnchorAttribute:function(){return null},isRTL:function(){return!1},anchorContainsElement:function(){return!1},tooltipContainsElement:function(){return!1},focusAnchorElement:function(){},registerEventHandler:function(){},deregisterEventHandler:function(){},registerAnchorEventHandler:function(){},deregisterAnchorEventHandler:function(){},registerDocumentEventHandler:function(){},deregisterDocumentEventHandler:function(){},registerWindowEventHandler:function(){},deregisterWindowEventHandler:function(){},notifyHidden:function(){},getTooltipCaretBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},setTooltipCaretStyle:function(){},clearTooltipCaretStyles:function(){},getActiveElement:function(){return null}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){this.richTooltip=this.adapter.hasClass(eD),this.persistentTooltip=this.adapter.getAttribute(sE.PERSISTENT)==="true",this.interactiveTooltip=!!this.adapter.getAnchorAttribute(sE.ARIA_EXPANDED)&&this.adapter.getAnchorAttribute(sE.ARIA_HASPOPUP)==="dialog",this.hasCaret=this.richTooltip&&this.adapter.getAttribute(sE.HAS_CARET)==="true"},e.prototype.isShown=function(){return this.tooltipShown},e.prototype.isRich=function(){return this.richTooltip},e.prototype.isPersistent=function(){return this.persistentTooltip},e.prototype.handleAnchorMouseEnter=function(){var t=this;this.tooltipShown?this.show():(this.clearHideTimeout(),this.showTimeout=setTimeout(function(){t.show()},this.showDelayMs))},e.prototype.handleAnchorTouchstart=function(){var t=this;this.showTimeout=setTimeout(function(){t.show()},this.showDelayMs),this.adapter.registerWindowEventHandler("contextmenu",this.preventContextMenuOnLongTouch)},e.prototype.preventContextMenuOnLongTouch=function(t){t.preventDefault()},e.prototype.handleAnchorTouchend=function(){this.clearShowTimeout(),this.isShown()||this.adapter.deregisterWindowEventHandler("contextmenu",this.preventContextMenuOnLongTouch)},e.prototype.handleAnchorFocus=function(t){var i=this,r=t.relatedTarget,a=r instanceof HTMLElement&&this.adapter.tooltipContainsElement(r);a||(this.showTimeout=setTimeout(function(){i.show()},this.showDelayMs))},e.prototype.handleAnchorMouseLeave=function(){var t=this;this.clearShowTimeout(),this.hideTimeout=setTimeout(function(){t.hide()},this.hideDelayMs)},e.prototype.handleAnchorClick=function(){this.tooltipShown?this.hide():this.show()},e.prototype.handleDocumentClick=function(t){var i=t.target instanceof HTMLElement&&(this.adapter.anchorContainsElement(t.target)||this.adapter.tooltipContainsElement(t.target));this.richTooltip&&this.persistentTooltip&&i||this.hide()},e.prototype.handleKeydown=function(t){var i=Ia(t);if(i===Pr.ESCAPE){var r=this.adapter.getActiveElement(),a=r instanceof HTMLElement&&this.adapter.tooltipContainsElement(r);a&&this.adapter.focusAnchorElement(),this.hide()}},e.prototype.handleAnchorBlur=function(t){if(this.richTooltip){var i=t.relatedTarget instanceof HTMLElement&&this.adapter.tooltipContainsElement(t.relatedTarget);if(i||t.relatedTarget===null&&this.interactiveTooltip)return}this.hide()},e.prototype.handleTooltipMouseEnter=function(){this.show()},e.prototype.handleTooltipMouseLeave=function(){var t=this;this.clearShowTimeout(),this.hideTimeout=setTimeout(function(){t.hide()},this.hideDelayMs)},e.prototype.handleRichTooltipFocusOut=function(t){var i=t.relatedTarget instanceof HTMLElement&&(this.adapter.anchorContainsElement(t.relatedTarget)||this.adapter.tooltipContainsElement(t.relatedTarget));i||t.relatedTarget===null&&this.interactiveTooltip||this.hide()},e.prototype.handleWindowScrollEvent=function(){if(this.persistentTooltip){this.handleWindowChangeEvent();return}this.hide()},e.prototype.handleWindowChangeEvent=function(){var t=this;this.animFrame.request(Zw.POLL_ANCHOR,function(){t.repositionTooltipOnAnchorMove()})},e.prototype.show=function(){var t,i,r=this;if(this.clearHideTimeout(),this.clearShowTimeout(),!this.tooltipShown){this.tooltipShown=!0,this.adapter.removeAttribute("aria-hidden"),this.richTooltip&&(this.interactiveTooltip&&this.adapter.setAnchorAttribute("aria-expanded","true"),this.adapter.registerEventHandler("focusout",this.richTooltipFocusOutHandler)),this.persistentTooltip||(this.adapter.registerEventHandler("mouseenter",this.tooltipMouseEnterHandler),this.adapter.registerEventHandler("mouseleave",this.tooltipMouseLeaveHandler)),this.adapter.removeClass(y1),this.adapter.addClass(Ew),this.isTooltipMultiline()&&!this.richTooltip&&this.adapter.addClass(tD),this.anchorRect=this.adapter.getAnchorBoundingRect(),this.parentRect=this.adapter.getParentBoundingRect(),this.richTooltip?this.positionRichTooltip():this.positionPlainTooltip(),this.adapter.registerAnchorEventHandler("blur",this.anchorBlurHandler),this.adapter.registerDocumentEventHandler("click",this.documentClickHandler),this.adapter.registerDocumentEventHandler("keydown",this.documentKeydownHandler),this.adapter.registerWindowEventHandler("scroll",this.windowScrollHandler),this.adapter.registerWindowEventHandler("resize",this.windowResizeHandler);try{for(var a=nu(this.addAncestorScrollEventListeners),l=a.next();!l.done;l=a.next()){var s=l.value;s()}}catch(d){t={error:d}}finally{try{l&&!l.done&&(i=a.return)&&i.call(a)}finally{if(t)throw t.error}}this.frameId=requestAnimationFrame(function(){r.clearAllAnimationClasses(),r.adapter.addClass(xw),r.adapter.addClass(oE)})}},e.prototype.hide=function(){var t,i;if(this.clearHideTimeout(),this.clearShowTimeout(),!!this.tooltipShown){this.frameId&&cancelAnimationFrame(this.frameId),this.tooltipShown=!1,this.adapter.setAttribute("aria-hidden","true"),this.adapter.deregisterEventHandler("focusout",this.richTooltipFocusOutHandler),this.richTooltip&&this.interactiveTooltip&&this.adapter.setAnchorAttribute("aria-expanded","false"),this.persistentTooltip||(this.adapter.deregisterEventHandler("mouseenter",this.tooltipMouseEnterHandler),this.adapter.deregisterEventHandler("mouseleave",this.tooltipMouseLeaveHandler)),this.clearAllAnimationClasses(),this.adapter.addClass(y1),this.adapter.addClass(aE),this.adapter.removeClass(xw),this.adapter.deregisterAnchorEventHandler("blur",this.anchorBlurHandler),this.adapter.deregisterDocumentEventHandler("click",this.documentClickHandler),this.adapter.deregisterDocumentEventHandler("keydown",this.documentKeydownHandler),this.adapter.deregisterWindowEventHandler("scroll",this.windowScrollHandler),this.adapter.deregisterWindowEventHandler("resize",this.windowResizeHandler),this.adapter.deregisterWindowEventHandler("contextmenu",this.preventContextMenuOnLongTouch);try{for(var r=nu(this.removeAncestorScrollEventListeners),a=r.next();!a.done;a=r.next()){var l=a.value;l()}}catch(s){t={error:s}}finally{try{a&&!a.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}}},e.prototype.handleTransitionEnd=function(){var t=this.adapter.hasClass(y1);this.adapter.removeClass(Ew),this.adapter.removeClass(oE),this.adapter.removeClass(y1),this.adapter.removeClass(aE),t&&this.showTimeout===null&&this.adapter.notifyHidden()},e.prototype.clearAllAnimationClasses=function(){this.adapter.removeClass(oE),this.adapter.removeClass(aE)},e.prototype.setTooltipPosition=function(t){var i=t.xPos,r=t.yPos,a=t.withCaretPos;if(this.hasCaret&&a){this.tooltipPositionWithCaret=a;return}i&&(this.xTooltipPos=i),r&&(this.yTooltipPos=r)},e.prototype.setAnchorBoundaryType=function(t){t===NE.UNBOUNDED?this.anchorGap=Ju.UNBOUNDED_ANCHOR_GAP:this.anchorGap=Ju.BOUNDED_ANCHOR_GAP},e.prototype.setShowDelay=function(t){this.showDelayMs=t},e.prototype.setHideDelay=function(t){this.hideDelayMs=t},e.prototype.isTooltipMultiline=function(){var t=this.adapter.getTooltipSize();return t.height>Ju.MIN_HEIGHT&&t.width>=Ju.MAX_WIDTH},e.prototype.positionPlainTooltip=function(){var t=this.calculateTooltipStyles(this.anchorRect),i=t.top,r=t.yTransformOrigin,a=t.left,l=t.xTransformOrigin,s=MC?kE(window,"transform"):"transform";this.adapter.setSurfaceAnimationStyleProperty(s+"-origin",l+" "+r),this.adapter.setStyleProperty("top",i+"px"),this.adapter.setStyleProperty("left",a+"px")},e.prototype.positionRichTooltip=function(){var t,i,r,a,l=this.adapter.getComputedStyleProperty("width");this.adapter.setStyleProperty("width",l);var s=this.hasCaret?this.calculateTooltipWithCaretStyles(this.anchorRect):this.calculateTooltipStyles(this.anchorRect),d=s.top,g=s.yTransformOrigin,x=s.left,I=s.xTransformOrigin,A=MC?kE(window,"transform"):"transform";this.adapter.setSurfaceAnimationStyleProperty(A+"-origin",I+" "+g);var L=x-((i=(t=this.parentRect)===null||t===void 0?void 0:t.left)!==null&&i!==void 0?i:0),N=d-((a=(r=this.parentRect)===null||r===void 0?void 0:r.top)!==null&&a!==void 0?a:0);this.adapter.setStyleProperty("top",N+"px"),this.adapter.setStyleProperty("left",L+"px")},e.prototype.calculateTooltipStyles=function(t){if(!t)return{top:0,left:0};var i=this.adapter.getTooltipSize(),r=this.calculateYTooltipDistance(t,i.height),a=this.calculateXTooltipDistance(t,i.width);return{top:r.distance,yTransformOrigin:r.yTransformOrigin,left:a.distance,xTransformOrigin:a.xTransformOrigin}},e.prototype.calculateXTooltipDistance=function(t,i){var r=!this.adapter.isRTL(),a,l,s,d,g;this.richTooltip?(a=r?t.left-i:t.right,l=r?t.right:t.left-i,d=r?ar.RIGHT:ar.LEFT,g=r?ar.LEFT:ar.RIGHT):(a=r?t.left:t.right-i,l=r?t.right-i:t.left,s=t.left+(t.width-i)/2,d=r?ar.LEFT:ar.RIGHT,g=r?ar.RIGHT:ar.LEFT);var x=this.richTooltip?this.determineValidPositionOptions(a,l):this.determineValidPositionOptions(s,a,l);if(this.xTooltipPos===x_.START&&x.has(a))return{distance:a,xTransformOrigin:d};if(this.xTooltipPos===x_.END&&x.has(l))return{distance:l,xTransformOrigin:g};if(this.xTooltipPos===x_.CENTER&&x.has(s))return{distance:s,xTransformOrigin:ar.CENTER};var I=this.richTooltip?[{distance:l,xTransformOrigin:g},{distance:a,xTransformOrigin:d}]:[{distance:s,xTransformOrigin:ar.CENTER},{distance:a,xTransformOrigin:d},{distance:l,xTransformOrigin:g}],A=I.find(function(B){var F=B.distance;return x.has(F)});if(A)return A;if(t.left<0)return{distance:this.minViewportTooltipThreshold,xTransformOrigin:ar.LEFT};var L=this.adapter.getViewportWidth(),N=L-(i+this.minViewportTooltipThreshold);return{distance:N,xTransformOrigin:ar.RIGHT}},e.prototype.determineValidPositionOptions=function(){for(var t,i,r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];var l=new Set,s=new Set;try{for(var d=nu(r),g=d.next();!g.done;g=d.next()){var x=g.value;this.positionHonorsViewportThreshold(x)?l.add(x):this.positionDoesntCollideWithViewport(x)&&s.add(x)}}catch(I){t={error:I}}finally{try{g&&!g.done&&(i=d.return)&&i.call(d)}finally{if(t)throw t.error}}return l.size?l:s},e.prototype.positionHonorsViewportThreshold=function(t){var i=this.adapter.getViewportWidth(),r=this.adapter.getTooltipSize().width;return t+r<=i-this.minViewportTooltipThreshold&&t>=this.minViewportTooltipThreshold},e.prototype.positionDoesntCollideWithViewport=function(t){var i=this.adapter.getViewportWidth(),r=this.adapter.getTooltipSize().width;return t+r<=i&&t>=0},e.prototype.calculateYTooltipDistance=function(t,i){var r=t.bottom+this.anchorGap,a=t.top-(this.anchorGap+i),l=this.determineValidYPositionOptions(a,r);return this.yTooltipPos===xv.ABOVE&&l.has(a)?{distance:a,yTransformOrigin:ar.BOTTOM}:this.yTooltipPos===xv.BELOW&&l.has(r)?{distance:r,yTransformOrigin:ar.TOP}:l.has(r)?{distance:r,yTransformOrigin:ar.TOP}:l.has(a)?{distance:a,yTransformOrigin:ar.BOTTOM}:{distance:r,yTransformOrigin:ar.TOP}},e.prototype.determineValidYPositionOptions=function(t,i){var r=new Set,a=new Set;return this.yPositionHonorsViewportThreshold(t)?r.add(t):this.yPositionDoesntCollideWithViewport(t)&&a.add(t),this.yPositionHonorsViewportThreshold(i)?r.add(i):this.yPositionDoesntCollideWithViewport(i)&&a.add(i),r.size?r:a},e.prototype.yPositionHonorsViewportThreshold=function(t){var i=this.adapter.getViewportHeight(),r=this.adapter.getTooltipSize().height;return t+r+this.minViewportTooltipThreshold<=i&&t>=this.minViewportTooltipThreshold},e.prototype.yPositionDoesntCollideWithViewport=function(t){var i=this.adapter.getViewportHeight(),r=this.adapter.getTooltipSize().height;return t+r<=i&&t>=0},e.prototype.calculateTooltipWithCaretStyles=function(t){this.adapter.clearTooltipCaretStyles();var i=this.adapter.getTooltipCaretBoundingRect();if(!t||!i)return{position:Hr.DETECTED,top:0,left:0};var r=i.width/Ju.ANIMATION_SCALE,a=i.height/Ju.ANIMATION_SCALE/2,l=this.adapter.getTooltipSize(),s=this.calculateYWithCaretDistanceOptions(t,l.height,{caretWidth:r,caretHeight:a}),d=this.calculateXWithCaretDistanceOptions(t,l.width,{caretWidth:r,caretHeight:a}),g=this.validateTooltipWithCaretDistances(s,d);g.size<1&&(g=this.generateBackupPositionOption(t,l,{caretWidth:r,caretHeight:a}));var x=this.determineTooltipWithCaretDistance(g),I=x.position,A=x.xDistance,L=x.yDistance,N=this.setCaretPositionStyles(I,{caretWidth:r,caretHeight:a}),B=N.yTransformOrigin,F=N.xTransformOrigin;return{yTransformOrigin:B,xTransformOrigin:F,top:L,left:A}},e.prototype.calculateXWithCaretDistanceOptions=function(t,i,r){var a=r.caretWidth,l=r.caretHeight,s=!this.adapter.isRTL(),d=t.left+t.width/2,g=t.left-(i+this.anchorGap+l),x=t.right+this.anchorGap+l,I=s?g:x,A=s?x:g,L=d-(Ju.CARET_INDENTATION+a/2),N=d-(i-Ju.CARET_INDENTATION-a/2),B=s?L:N,F=s?N:L,z=d-i/2,V=new Map([[hs.START,B],[hs.CENTER,z],[hs.END,F],[hs.SIDE_END,A],[hs.SIDE_START,I]]);return V},e.prototype.calculateYWithCaretDistanceOptions=function(t,i,r){var a=r.caretWidth,l=r.caretHeight,s=t.top+t.height/2,d=t.bottom+this.anchorGap+l,g=t.top-(this.anchorGap+i+l),x=s-(Ju.CARET_INDENTATION+a/2),I=s-i/2,A=s-(i-Ju.CARET_INDENTATION-a/2),L=new Map([[ml.ABOVE,g],[ml.BELOW,d],[ml.SIDE_TOP,x],[ml.SIDE_CENTER,I],[ml.SIDE_BOTTOM,A]]);return L},e.prototype.repositionTooltipOnAnchorMove=function(){var t=this.adapter.getAnchorBoundingRect();!t||!this.anchorRect||(t.top!==this.anchorRect.top||t.left!==this.anchorRect.left||t.height!==this.anchorRect.height||t.width!==this.anchorRect.width)&&(this.anchorRect=t,this.parentRect=this.adapter.getParentBoundingRect(),this.richTooltip?this.positionRichTooltip():this.positionPlainTooltip())},e.prototype.validateTooltipWithCaretDistances=function(t,i){var r,a,l,s,d,g,x=new Map,I=new Map,A=new Map([[ml.ABOVE,[hs.START,hs.CENTER,hs.END]],[ml.BELOW,[hs.START,hs.CENTER,hs.END]],[ml.SIDE_TOP,[hs.SIDE_START,hs.SIDE_END]],[ml.SIDE_CENTER,[hs.SIDE_START,hs.SIDE_END]],[ml.SIDE_BOTTOM,[hs.SIDE_START,hs.SIDE_END]]]);try{for(var L=nu(A.keys()),N=L.next();!N.done;N=L.next()){var B=N.value,F=t.get(B);if(this.yPositionHonorsViewportThreshold(F))try{for(var z=(l=void 0,nu(A.get(B))),V=z.next();!V.done;V=z.next()){var Y=V.value,Q=i.get(Y);if(this.positionHonorsViewportThreshold(Q)){var J=this.caretPositionOptionsMapping(Y,B);x.set(J,{xDistance:Q,yDistance:F})}}}catch(ae){l={error:ae}}finally{try{V&&!V.done&&(s=z.return)&&s.call(z)}finally{if(l)throw l.error}}if(this.yPositionDoesntCollideWithViewport(F))try{for(var he=(d=void 0,nu(A.get(B))),ee=he.next();!ee.done;ee=he.next()){var Y=ee.value,Q=i.get(Y);if(this.positionDoesntCollideWithViewport(Q)){var J=this.caretPositionOptionsMapping(Y,B);I.set(J,{xDistance:Q,yDistance:F})}}}catch(ae){d={error:ae}}finally{try{ee&&!ee.done&&(g=he.return)&&g.call(he)}finally{if(d)throw d.error}}}}catch(ae){r={error:ae}}finally{try{N&&!N.done&&(a=L.return)&&a.call(L)}finally{if(r)throw r.error}}return x.size?x:I},e.prototype.generateBackupPositionOption=function(t,i,r){var a=!this.adapter.isRTL(),l,s;if(t.left<0)l=this.minViewportTooltipThreshold+r.caretHeight,s=a?hs.END:hs.START;else{var d=this.adapter.getViewportWidth();l=d-(i.width+this.minViewportTooltipThreshold+r.caretHeight),s=a?hs.START:hs.END}var g,x;if(t.top<0)g=this.minViewportTooltipThreshold+r.caretHeight,x=ml.BELOW;else{var I=this.adapter.getViewportHeight();g=I-(i.height+this.minViewportTooltipThreshold+r.caretHeight),x=ml.ABOVE}var A=this.caretPositionOptionsMapping(s,x);return new Map([[A,{xDistance:l,yDistance:g}]])},e.prototype.determineTooltipWithCaretDistance=function(t){if(t.has(this.tooltipPositionWithCaret)){var i=t.get(this.tooltipPositionWithCaret);return{position:this.tooltipPositionWithCaret,xDistance:i.xDistance,yDistance:i.yDistance}}var r=[Hr.ABOVE_START,Hr.ABOVE_CENTER,Hr.ABOVE_END,Hr.TOP_SIDE_START,Hr.CENTER_SIDE_START,Hr.BOTTOM_SIDE_START,Hr.TOP_SIDE_END,Hr.CENTER_SIDE_END,Hr.BOTTOM_SIDE_END,Hr.BELOW_START,Hr.BELOW_CENTER,Hr.BELOW_END],a=r.find(function(s){return t.has(s)}),l=t.get(a);return{position:a,xDistance:l.xDistance,yDistance:l.yDistance}},e.prototype.caretPositionOptionsMapping=function(t,i){switch(i){case ml.ABOVE:if(t===hs.START)return Hr.ABOVE_START;if(t===hs.CENTER)return Hr.ABOVE_CENTER;if(t===hs.END)return Hr.ABOVE_END;break;case ml.BELOW:if(t===hs.START)return Hr.BELOW_START;if(t===hs.CENTER)return Hr.BELOW_CENTER;if(t===hs.END)return Hr.BELOW_END;break;case ml.SIDE_TOP:if(t===hs.SIDE_START)return Hr.TOP_SIDE_START;if(t===hs.SIDE_END)return Hr.TOP_SIDE_END;break;case ml.SIDE_CENTER:if(t===hs.SIDE_START)return Hr.CENTER_SIDE_START;if(t===hs.SIDE_END)return Hr.CENTER_SIDE_END;break;case ml.SIDE_BOTTOM:if(t===hs.SIDE_START)return Hr.BOTTOM_SIDE_START;if(t===hs.SIDE_END)return Hr.BOTTOM_SIDE_END;break}throw new Error("MDCTooltipFoundation: Invalid caret position of "+t+", "+i)},e.prototype.setCaretPositionStyles=function(t,i){var r,a,l=this.calculateCaretPositionOnTooltip(t,i);if(!l)return{yTransformOrigin:0,xTransformOrigin:0};this.adapter.clearTooltipCaretStyles(),this.adapter.setTooltipCaretStyle(l.yAlignment,l.yAxisPx),this.adapter.setTooltipCaretStyle(l.xAlignment,l.xAxisPx);var s=l.skew*(Math.PI/180),d=Math.cos(s);this.adapter.setTooltipCaretStyle("transform","rotate("+l.rotation+"deg) skewY("+l.skew+"deg) scaleX("+d+")"),this.adapter.setTooltipCaretStyle("transform-origin",l.xAlignment+" "+l.yAlignment);try{for(var g=nu(l.caretCorners),x=g.next();!x.done;x=g.next()){var I=x.value;this.adapter.setTooltipCaretStyle(I,"0")}}catch(A){r={error:A}}finally{try{x&&!x.done&&(a=g.return)&&a.call(g)}finally{if(r)throw r.error}}return{yTransformOrigin:l.yTransformOrigin,xTransformOrigin:l.xTransformOrigin}},e.prototype.calculateCaretPositionOnTooltip=function(t,i){var r=!this.adapter.isRTL(),a=this.adapter.getComputedStyleProperty("width"),l=this.adapter.getComputedStyleProperty("height");if(!(!a||!l||!i)){var s="calc(("+a+" - "+i.caretWidth+"px) / 2)",d="calc(("+l+" - "+i.caretWidth+"px) / 2)",g="0",x=Ju.CARET_INDENTATION+"px",I="calc("+a+" - "+x+")",A="calc("+l+" - "+x+")",L=35,N=Math.abs(90-L),B=["border-bottom-right-radius","border-top-left-radius"],F=["border-bottom-left-radius","border-top-right-radius"],z=20;switch(t){case Hr.BELOW_CENTER:return{yAlignment:ar.TOP,xAlignment:ar.LEFT,yAxisPx:g,xAxisPx:s,rotation:-1*L,skew:-1*z,xTransformOrigin:s,yTransformOrigin:g,caretCorners:B};case Hr.BELOW_END:return{yAlignment:ar.TOP,xAlignment:r?ar.RIGHT:ar.LEFT,yAxisPx:g,xAxisPx:x,rotation:r?L:-1*L,skew:r?z:-1*z,xTransformOrigin:r?I:x,yTransformOrigin:g,caretCorners:r?F:B};case Hr.BELOW_START:return{yAlignment:ar.TOP,xAlignment:r?ar.LEFT:ar.RIGHT,yAxisPx:g,xAxisPx:x,rotation:r?-1*L:L,skew:r?-1*z:z,xTransformOrigin:r?x:I,yTransformOrigin:g,caretCorners:r?B:F};case Hr.TOP_SIDE_END:return{yAlignment:ar.TOP,xAlignment:r?ar.LEFT:ar.RIGHT,yAxisPx:x,xAxisPx:g,rotation:r?N:-1*N,skew:r?-1*z:z,xTransformOrigin:r?g:a,yTransformOrigin:x,caretCorners:r?B:F};case Hr.CENTER_SIDE_END:return{yAlignment:ar.TOP,xAlignment:r?ar.LEFT:ar.RIGHT,yAxisPx:d,xAxisPx:g,rotation:r?N:-1*N,skew:r?-1*z:z,xTransformOrigin:r?g:a,yTransformOrigin:d,caretCorners:r?B:F};case Hr.BOTTOM_SIDE_END:return{yAlignment:ar.BOTTOM,xAlignment:r?ar.LEFT:ar.RIGHT,yAxisPx:x,xAxisPx:g,rotation:r?-1*N:N,skew:r?z:-1*z,xTransformOrigin:r?g:a,yTransformOrigin:A,caretCorners:r?F:B};case Hr.TOP_SIDE_START:return{yAlignment:ar.TOP,xAlignment:r?ar.RIGHT:ar.LEFT,yAxisPx:x,xAxisPx:g,rotation:r?-1*N:N,skew:r?z:-1*z,xTransformOrigin:r?a:g,yTransformOrigin:x,caretCorners:r?F:B};case Hr.CENTER_SIDE_START:return{yAlignment:ar.TOP,xAlignment:r?ar.RIGHT:ar.LEFT,yAxisPx:d,xAxisPx:g,rotation:r?-1*N:N,skew:r?z:-1*z,xTransformOrigin:r?a:g,yTransformOrigin:d,caretCorners:r?F:B};case Hr.BOTTOM_SIDE_START:return{yAlignment:ar.BOTTOM,xAlignment:r?ar.RIGHT:ar.LEFT,yAxisPx:x,xAxisPx:g,rotation:r?N:-1*N,skew:r?-1*z:z,xTransformOrigin:r?a:g,yTransformOrigin:A,caretCorners:r?B:F};case Hr.ABOVE_CENTER:return{yAlignment:ar.BOTTOM,xAlignment:ar.LEFT,yAxisPx:g,xAxisPx:s,rotation:L,skew:z,xTransformOrigin:s,yTransformOrigin:l,caretCorners:F};case Hr.ABOVE_END:return{yAlignment:ar.BOTTOM,xAlignment:r?ar.RIGHT:ar.LEFT,yAxisPx:g,xAxisPx:x,rotation:r?-1*L:L,skew:r?-1*z:z,xTransformOrigin:r?I:x,yTransformOrigin:l,caretCorners:r?B:F};default:case Hr.ABOVE_START:return{yAlignment:ar.BOTTOM,xAlignment:r?ar.LEFT:ar.RIGHT,yAxisPx:g,xAxisPx:x,rotation:r?L:-1*L,skew:r?z:-1*z,xTransformOrigin:r?x:I,yTransformOrigin:l,caretCorners:r?F:B}}}},e.prototype.clearShowTimeout=function(){this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=null)},e.prototype.clearHideTimeout=function(){this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null)},e.prototype.attachScrollHandler=function(t){var i=this;this.addAncestorScrollEventListeners.push(function(){t("scroll",i.windowScrollHandler)})},e.prototype.removeScrollHandler=function(t){var i=this;this.removeAncestorScrollEventListeners.push(function(){t("scroll",i.windowScrollHandler)})},e.prototype.destroy=function(){var t,i;this.frameId&&(cancelAnimationFrame(this.frameId),this.frameId=null),this.clearHideTimeout(),this.clearShowTimeout(),this.adapter.removeClass(xw),this.adapter.removeClass(oE),this.adapter.removeClass(Ew),this.adapter.removeClass(y1),this.adapter.removeClass(aE),this.richTooltip&&this.adapter.deregisterEventHandler("focusout",this.richTooltipFocusOutHandler),this.persistentTooltip||(this.adapter.deregisterEventHandler("mouseenter",this.tooltipMouseEnterHandler),this.adapter.deregisterEventHandler("mouseleave",this.tooltipMouseLeaveHandler)),this.adapter.deregisterAnchorEventHandler("blur",this.anchorBlurHandler),this.adapter.deregisterDocumentEventHandler("click",this.documentClickHandler),this.adapter.deregisterDocumentEventHandler("keydown",this.documentKeydownHandler),this.adapter.deregisterWindowEventHandler("scroll",this.windowScrollHandler),this.adapter.deregisterWindowEventHandler("resize",this.windowResizeHandler);try{for(var r=nu(this.removeAncestorScrollEventListeners),a=r.next();!a.done;a=r.next()){var l=a.value;l()}}catch(s){t={error:s}}finally{try{a&&!a.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}this.animFrame.cancelAll()},e}(xl);function In(n){return Object.entries(n).filter(([e,t])=>e!==""&&t).map(([e])=>e).join(" ")}function ji(n,e,t,i={bubbles:!0},r=!1){if(typeof Event>"u")throw new Error("Event not defined.");if(!n)throw new Error("Tried to dipatch event without element.");const a=new CustomEvent(e,Object.assign(Object.assign({},i),{detail:t}));if(n==null||n.dispatchEvent(a),r&&e.startsWith("SMUI")){const l=new CustomEvent(e.replace(/^SMUI/g,()=>"MDC"),Object.assign(Object.assign({},i),{detail:t}));n==null||n.dispatchEvent(l),l.defaultPrevented&&a.preventDefault()}return a}function jo(n,e){let t=Object.getOwnPropertyNames(n);const i={};for(let r=0;r<t.length;r++){const a=t[r],l=a.indexOf("$");l!==-1&&e.indexOf(a.substring(0,l+1))!==-1||e.indexOf(a)===-1&&(i[a]=n[a])}return i}const LC=/^[a-z]+(?::(?:preventDefault|stopPropagation|passive|nonpassive|capture|once|self))+$/,iD=/^[^$]+(?:\$(?:preventDefault|stopPropagation|passive|nonpassive|capture|once|self))+$/;function ps(n){let e,t=[];n.$on=(r,a)=>{let l=r,s=()=>{};return e?s=e(l,a):t.push([l,a]),l.match(LC)&&console&&console.warn('Event modifiers in SMUI now use "$" instead of ":", so that all events can be bound with modifiers. Please update your event binding: ',l),()=>{s()}};function i(r){iu(n,r)}return r=>{const a=[],l={};e=(s,d)=>{let g=s,x=d,I=!1;const A=g.match(LC),L=g.match(iD),N=A||L;if(g.match(/^SMUI:\w+:/)){const z=g.split(":");let V="";for(let Y=0;Y<z.length;Y++)V+=Y===z.length-1?":"+z[Y]:z[Y].split("-").map(Q=>Q.slice(0,1).toUpperCase()+Q.slice(1)).join("");console.warn(`The event ${g.split("$")[0]} has been renamed to ${V.split("$")[0]}.`),g=V}if(N){const z=g.split(A?":":"$");g=z[0];const V=z.slice(1).reduce((Y,Q)=>(Y[Q]=!0,Y),{});V.passive&&(I=I||{},I.passive=!0),V.nonpassive&&(I=I||{},I.passive=!1),V.capture&&(I=I||{},I.capture=!0),V.once&&(I=I||{},I.once=!0),V.preventDefault&&(x=CP(x)),V.stopPropagation&&(x=AP(x))}const B=qn(r,g,x,I),F=()=>{B();const z=a.indexOf(F);z>-1&&a.splice(z,1)};return a.push(F),g in l||(l[g]=qn(r,g,i)),F};for(let s=0;s<t.length;s++)e(t[s][0],t[s][1]);return{destroy:()=>{for(let s=0;s<a.length;s++)a[s]();for(let s of Object.entries(l))s[1]()}}}}function gi(n,e){let t=Object.getOwnPropertyNames(n);const i={};for(let r=0;r<t.length;r++){const a=t[r];a.substring(0,e.length)===e&&(i[a.substring(e.length)]=n[a])}return i}function jr(n,e){let t=[];if(e)for(let i=0;i<e.length;i++){const r=e[i],a=Array.isArray(r)?r[0]:r;Array.isArray(r)&&r.length>1?t.push(a(n,r[1])):t.push(a(n))}return{update(i){if((i&&i.length||0)!=t.length)throw new Error("You must not change the length of an actions array.");if(i)for(let r=0;r<i.length;r++){const a=t[r];if(a&&a.update){const l=i[r];Array.isArray(l)&&l.length>1?a.update(l[1]):a.update()}}},destroy(){for(let i=0;i<t.length;i++){const r=t[i];r&&r.destroy&&r.destroy()}}}}function rD(n){let e,t,i,r,a,l,s,d,g,x,I,A,L;const N=n[32].default,B=Ri(N,n,n[31],null);let F=[{class:i=In({[n[6]]:!0,"mdc-tooltip__surface":!0,"mdc-tooltip__surface-animation":!0})},{style:r=Object.entries(n[13]).map(RC).concat([n[7]]).join(" ")},gi(n[19],"surface$")],z={};for(let Q=0;Q<F.length;Q+=1)z=zt(z,F[Q]);let V=[{class:a=In({[n[1]]:!0,"mdc-tooltip":!0,"mdc-tooltip--rich":n[18],...n[10]})},{style:l=Object.entries(n[11]).map(PC).concat([n[2]]).join(" ")},{"aria-hidden":"true"},{id:n[3]},{"data-mdc-tooltip-persist":s=n[18]&&n[4]?"true":void 0},{"data-mdc-tooltip-persistent":d=n[18]&&n[4]?"true":void 0},{"data-mdc-tooltip-has-caret":void 0},{"data-hide-tooltip-from-screenreader":g=n[5]?"true":void 0},n[14],n[12],jo(n[19],["surface$"])],Y={};for(let Q=0;Q<V.length;Q+=1)Y=zt(Y,V[Q]);return{c(){e=qt("div"),t=qt("div"),B&&B.c(),this.h()},l(Q){e=Wt(Q,"DIV",{class:!0,style:!0,"aria-hidden":!0,id:!0,"data-mdc-tooltip-persist":!0,"data-mdc-tooltip-persistent":!0,"data-mdc-tooltip-has-caret":!0,"data-hide-tooltip-from-screenreader":!0});var J=Qt(e);t=Wt(J,"DIV",{class:!0,style:!0});var he=Qt(t);B&&B.l(he),he.forEach(de),J.forEach(de),this.h()},h(){Xn(t,z),Xn(e,Y)},m(Q,J){tt(Q,e,J),Kt(e,t),B&&B.m(t,null),n[33](e),I=!0,A||(L=[li(x=jr.call(null,e,n[0])),li(n[15].call(null,e)),qn(e,"transitionend",n[34])],A=!0)},p(Q,J){B&&B.p&&(!I||J[1]&1)&&Pi(B,N,Q,Q[31],I?Oi(N,Q[31],J,null):Di(Q[31]),null),Xn(t,z=hi(F,[(!I||J[0]&64&&i!==(i=In({[Q[6]]:!0,"mdc-tooltip__surface":!0,"mdc-tooltip__surface-animation":!0})))&&{class:i},(!I||J[0]&8320&&r!==(r=Object.entries(Q[13]).map(RC).concat([Q[7]]).join(" ")))&&{style:r},J[0]&524288&&gi(Q[19],"surface$")])),Xn(e,Y=hi(V,[(!I||J[0]&1026&&a!==(a=In({[Q[1]]:!0,"mdc-tooltip":!0,"mdc-tooltip--rich":Q[18],...Q[10]})))&&{class:a},(!I||J[0]&2052&&l!==(l=Object.entries(Q[11]).map(PC).concat([Q[2]]).join(" ")))&&{style:l},{"aria-hidden":"true"},(!I||J[0]&8)&&{id:Q[3]},(!I||J[0]&16&&s!==(s=Q[18]&&Q[4]?"true":void 0))&&{"data-mdc-tooltip-persist":s},(!I||J[0]&16&&d!==(d=Q[18]&&Q[4]?"true":void 0))&&{"data-mdc-tooltip-persistent":d},{"data-mdc-tooltip-has-caret":void 0},(!I||J[0]&32&&g!==(g=Q[5]?"true":void 0))&&{"data-hide-tooltip-from-screenreader":g},J[0]&16384&&Q[14],J[0]&4096&&Q[12],J[0]&524288&&jo(Q[19],["surface$"])])),x&&Gi(x.update)&&J[0]&1&&x.update.call(null,Q[0])},i(Q){I||(Te(B,Q),I=!0)},o(Q){Ne(B,Q),I=!1},d(Q){Q&&de(e),B&&B.d(Q),n[33](null),A=!1,Ss(L)}}}let sD=0;const RC=([n,e])=>`${n}: ${e};`,PC=([n,e])=>`${n}: ${e};`;function oD(n,e,t){let i;const r=["use","class","style","id","unbounded","xPos","yPos","persistent","interactive","hideFromScreenreader","showDelay","hideDelay","surface$class","surface$style","attachScrollHandler","removeScrollHandler","getElement"];let a=vi(e,r),l,s,{$$slots:d={},$$scope:g}=e;const x=ps(ds());let{use:I=[]}=e,{class:A=""}=e,{style:L=""}=e,{id:N="SMUI-tooltip-"+sD++}=e,{unbounded:B=!1}=e,{xPos:F="detected"}=e,{yPos:z="detected"}=e,{persistent:V=!1}=e,{interactive:Y=V}=e,{hideFromScreenreader:Q=!1}=e,{showDelay:J=void 0}=e,{hideDelay:he=void 0}=e,{surface$class:ee=""}=e,{surface$style:ae=""}=e,De,fe,le={setParent($e){Object.defineProperty(this,"parent",{value:$e})},setNextSibling($e){Object.defineProperty(this,"nextSibling",{value:$e})}},Be={},Pe={},Ce={},it={},Et=Fr("SMUI:tooltip:wrapper:anchor");Dl(n,Et,$e=>t(30,l=$e));let Ue=Fr("SMUI:tooltip:wrapper:tooltip");Dl(n,Ue,$e=>t(35,s=$e));const at=Fr("SMUI:tooltip:rich");let ke;ro(()=>(t(8,fe=new nD({getAttribute:En,setAttribute:_t,removeAttribute:kt,addClass:Gt,hasClass:Cn,removeClass:Mt,getComputedStyleProperty:$e=>{const kn=He();let Ei=getComputedStyle(kn).getPropertyValue($e);return Ei==="auto"&&(kn.classList.add("smui-banner--force-show"),Ei=getComputedStyle(kn).getPropertyValue($e),kn.classList.remove("smui-banner--force-show")),Ei},setStyleProperty:vt,setSurfaceAnimationStyleProperty:xn,getViewportWidth:()=>window.innerWidth,getViewportHeight:()=>window.innerHeight,getTooltipSize:()=>{const $e=He();let kn={width:$e.offsetWidth,height:$e.offsetHeight};return(kn.width===0||kn.height===0)&&($e.classList.add("smui-banner--force-show"),kn={width:$e.offsetWidth,height:$e.offsetHeight},$e.classList.remove("smui-banner--force-show")),kn},getAnchorBoundingRect:()=>l?l.getBoundingClientRect():null,getParentBoundingRect:()=>{let $e=He().parentElement;return at||($e=document.body),($e==null?void 0:$e.getBoundingClientRect())||null},getAnchorAttribute:$e=>l?l.getAttribute($e):null,setAnchorAttribute:($e,kn)=>{l&&l.setAttribute($e,kn)},isRTL:()=>getComputedStyle(He()).direction==="rtl",anchorContainsElement:$e=>!!(l&&l.contains($e)),tooltipContainsElement:$e=>He().contains($e),focusAnchorElement:()=>{l&&l.focus()},registerEventHandler:($e,kn)=>{He().addEventListener($e,kn)},deregisterEventHandler:($e,kn)=>{He().removeEventListener($e,kn)},registerAnchorEventHandler:($e,kn)=>{l&&l.addEventListener($e,kn)},deregisterAnchorEventHandler:($e,kn)=>{l&&l.removeEventListener($e,kn)},registerDocumentEventHandler:($e,kn)=>{document.body.addEventListener($e,kn)},deregisterDocumentEventHandler:($e,kn)=>{document.body.removeEventListener($e,kn)},registerWindowEventHandler:($e,kn)=>{window.addEventListener($e,kn,$e==="scroll"&&{capture:!0,passive:!0})},deregisterWindowEventHandler:($e,kn)=>{window.removeEventListener($e,kn,$e==="scroll"&&{capture:!0,passive:!0})},notifyHidden:()=>{ji(He(),"SMUITooltip:hidden",void 0,void 0,!0)},getTooltipCaretBoundingRect:()=>{const $e=He().querySelector(`.${Uc.TOOLTIP_CARET_TOP}`);return $e?$e.getBoundingClientRect():null},setTooltipCaretStyle:($e,kn)=>{const Ei=He().querySelector(`.${Uc.TOOLTIP_CARET_TOP}`),ni=He().querySelector(`.${Uc.TOOLTIP_CARET_BOTTOM}`);!Ei||!ni||(Ei.style.setProperty($e,kn),ni.style.setProperty($e,kn))},clearTooltipCaretStyles:()=>{const $e=He().querySelector(`.${Uc.TOOLTIP_CARET_TOP}`),kn=He().querySelector(`.${Uc.TOOLTIP_CARET_BOTTOM}`);!$e||!kn||($e.removeAttribute("style"),kn.removeAttribute("style"))},getActiveElement:()=>document.activeElement})),bf(Ue,s=De,s),()=>{l&&Dt(l)})),Dh(()=>{var $e;!at&&typeof document<"u"&&document.body===He().parentElement&&le.parent!==He().parentElement&&(!(($e=le.parent)===null||$e===void 0)&&$e.insertBefore)&&le.nextSibling&&le.parent.insertBefore(He(),le.nextSibling)});function Dt($e){$e.removeEventListener("focusout",Ct),at&&V?($e.removeEventListener("click",Bt),$e.removeEventListener("keydown",Bt)):($e.removeEventListener("mouseenter",Zn),$e.removeEventListener("focusin",mi),$e.removeEventListener("mouseleave",yn),$e.removeEventListener("touchstart",Pt),$e.removeEventListener("touchend",Yn)),at&&Y?($e.removeAttribute("aria-haspopup"),$e.removeAttribute("aria-expanded"),$e.removeAttribute("data-tooltip-id")):$e.removeAttribute("aria-describedby"),fe.destroy()}function fn($e){$e.addEventListener("focusout",Ct),at&&V?($e.addEventListener("click",Bt),$e.addEventListener("keydown",Bt)):($e.addEventListener("mouseenter",Zn),$e.addEventListener("focusin",mi),$e.addEventListener("mouseleave",yn),$e.addEventListener("touchstart",Pt),$e.addEventListener("touchend",Yn)),at&&Y?($e.setAttribute("aria-haspopup","dialog"),$e.setAttribute("aria-expanded","false"),$e.setAttribute("data-tooltip-id",N)):$e.setAttribute("aria-describedby",N),at||si(),fe.init()}function Cn($e){return $e in Be?Be[$e]:He().classList.contains($e)}function Gt($e){Be[$e]||t(10,Be[$e]=!0,Be)}function Mt($e){(!($e in Be)||Be[$e])&&t(10,Be[$e]=!1,Be)}function vt($e,kn){Pe[$e]!=kn&&(kn===""||kn==null?(delete Pe[$e],t(11,Pe)):t(11,Pe[$e]=kn,Pe))}function xn($e,kn){it[$e]!=kn&&(kn===""||kn==null?(delete it[$e],t(13,it)):t(13,it[$e]=kn,it))}function En($e){var kn;return $e in Ce?(kn=Ce[$e])!==null&&kn!==void 0?kn:null:He().getAttribute($e)}function _t($e,kn){Ce[$e]!==kn&&t(12,Ce[$e]=kn,Ce)}function kt($e){(!($e in Ce)||Ce[$e]!=null)&&t(12,Ce[$e]=void 0,Ce)}function Ct($e){De.contains($e.relatedTarget)||fe&&fe.hide()}function Bt($e){$e.type==="keydown"&&$e.key!=="Enter"&&$e.key!==" "||fe&&fe.handleAnchorClick()}function Zn(){fe&&fe.handleAnchorMouseEnter()}function mi($e){fe&&fe.handleAnchorFocus($e)}function yn(){fe&&fe.handleAnchorMouseLeave()}function Pt(){fe&&fe.handleAnchorTouchstart()}function Yn(){fe&&fe.handleAnchorTouchend()}function si(){var $e,kn;l&&document.body!==He().parentNode&&(le.setParent(($e=He().parentElement)!==null&&$e!==void 0?$e:void 0),le.setNextSibling((kn=He().nextElementSibling)!==null&&kn!==void 0?kn:void 0),document.body.appendChild(He()))}function Dr($e){fe&&fe.attachScrollHandler($e)}function Ur($e){fe&&fe.removeScrollHandler($e)}function He(){return De}function Jt($e){Sn[$e?"unshift":"push"](()=>{De=$e,t(9,De)})}const ui=()=>fe&&fe.handleTransitionEnd();return n.$$set=$e=>{e=zt(zt({},e),ls($e)),t(19,a=vi(e,r)),"use"in $e&&t(0,I=$e.use),"class"in $e&&t(1,A=$e.class),"style"in $e&&t(2,L=$e.style),"id"in $e&&t(3,N=$e.id),"unbounded"in $e&&t(20,B=$e.unbounded),"xPos"in $e&&t(21,F=$e.xPos),"yPos"in $e&&t(22,z=$e.yPos),"persistent"in $e&&t(4,V=$e.persistent),"interactive"in $e&&t(23,Y=$e.interactive),"hideFromScreenreader"in $e&&t(5,Q=$e.hideFromScreenreader),"showDelay"in $e&&t(24,J=$e.showDelay),"hideDelay"in $e&&t(25,he=$e.hideDelay),"surface$class"in $e&&t(6,ee=$e.surface$class),"surface$style"in $e&&t(7,ae=$e.surface$style),"$$scope"in $e&&t(31,g=$e.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&8388624&&t(14,i={role:at&&Y?"dialog":"tooltip",tabindex:at&&V?-1:void 0}),n.$$.dirty[0]&1610612992&&fe&&ke!==l&&(ke&&Dt(ke),l&&fn(l),t(29,ke=l)),n.$$.dirty[0]&1048832&&fe&&fe.setAnchorBoundaryType(NE[B?"UNBOUNDED":"BOUNDED"]),n.$$.dirty[0]&6291712&&fe&&fe.setTooltipPosition({xPos:x_[F.toUpperCase()],yPos:xv[z.toUpperCase()]}),n.$$.dirty[0]&16777472&&fe&&J!=null&&fe.setShowDelay(J),n.$$.dirty[0]&33554688&&fe&&he!=null&&fe.setHideDelay(he)},[I,A,L,N,V,Q,ee,ae,fe,De,Be,Pe,Ce,it,i,x,Et,Ue,at,a,B,F,z,Y,J,he,Dr,Ur,He,ke,l,g,d,Jt,ui]}class ab extends sr{constructor(e){super(),or(this,e,oD,rD,Qi,{use:0,class:1,style:2,id:3,unbounded:20,xPos:21,yPos:22,persistent:4,interactive:23,hideFromScreenreader:5,showDelay:24,hideDelay:25,surface$class:6,surface$style:7,attachScrollHandler:26,removeScrollHandler:27,getElement:28},null,[-1,-1])}get attachScrollHandler(){return this.$$.ctx[26]}get removeScrollHandler(){return this.$$.ctx[27]}get getElement(){return this.$$.ctx[28]}}function aD(n){let e;const t=n[12].default,i=Ri(t,n,n[11],null);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a&2048)&&Pi(i,t,r,r[11],e?Oi(t,r[11],a,null):Di(r[11]),null)},i(r){e||(Te(i,r),e=!0)},o(r){Ne(i,r),e=!1},d(r){i&&i.d(r)}}}function lD(n){let e,t,i,r,a,l;const s=n[12].default,d=Ri(s,n,n[11],null);let g=[{class:t=In({[n[1]]:!0,"mdc-tooltip-wrapper--rich":!0})},n[7]],x={};for(let I=0;I<g.length;I+=1)x=zt(x,g[I]);return{c(){e=qt("div"),d&&d.c(),this.h()},l(I){e=Wt(I,"DIV",{class:!0});var A=Qt(e);d&&d.l(A),A.forEach(de),this.h()},h(){Xn(e,x)},m(I,A){tt(I,e,A),d&&d.m(e,null),n[13](e),r=!0,a||(l=[li(i=jr.call(null,e,n[0])),li(n[4].call(null,e))],a=!0)},p(I,A){d&&d.p&&(!r||A&2048)&&Pi(d,s,I,I[11],r?Oi(s,I[11],A,null):Di(I[11]),null),Xn(e,x=hi(g,[(!r||A&2&&t!==(t=In({[I[1]]:!0,"mdc-tooltip-wrapper--rich":!0})))&&{class:t},A&128&&I[7]])),i&&Gi(i.update)&&A&1&&i.update.call(null,I[0])},i(I){r||(Te(d,I),r=!0)},o(I){Ne(d,I),r=!1},d(I){I&&de(e),d&&d.d(I),n[13](null),a=!1,Ss(l)}}}function uD(n){let e,t,i,r;const a=[lD,aD],l=[];function s(d,g){return d[2]?0:1}return e=s(n),t=l[e]=a[e](n),{c(){t.c(),i=pi()},l(d){t.l(d),i=pi()},m(d,g){l[e].m(d,g),tt(d,i,g),r=!0},p(d,[g]){let x=e;e=s(d),e===x?l[e].p(d,g):(Wi(),Ne(l[x],1,1,()=>{l[x]=null}),Xi(),t=l[e],t?t.p(d,g):(t=l[e]=a[e](d),t.c()),Te(t,1),t.m(i.parentNode,i))},i(d){r||(Te(t),r=!0)},o(d){Ne(t),r=!1},d(d){l[e].d(d),d&&de(i)}}}function cD(n,e,t){const i=["use","class","rich","getElement"];let r=vi(e,i),a,l,{$$slots:s={},$$scope:d}=e;const g=ps(ds());let{use:x=[]}=e,{class:I=""}=e,{rich:A=!1}=e,L;const N=Eh(void 0);Dl(n,N,V=>t(10,l=V));const B=Eh(void 0);Dl(n,B,V=>t(9,a=V)),lr("SMUI:tooltip:wrapper:anchor",N),lr("SMUI:tooltip:wrapper:tooltip",B),lr("SMUI:tooltip:rich",A);function F(){return L}function z(V){Sn[V?"unshift":"push"](()=>{L=V,t(3,L)})}return n.$$set=V=>{e=zt(zt({},e),ls(V)),t(7,r=vi(e,i)),"use"in V&&t(0,x=V.use),"class"in V&&t(1,I=V.class),"rich"in V&&t(2,A=V.rich),"$$scope"in V&&t(11,d=V.$$scope)},n.$$.update=()=>{n.$$.dirty&1536&&a&&!l&&bf(N,l=a.previousElementSibling,l)},[x,I,A,L,g,N,B,r,F,a,l,d,s,z]}class Rv extends sr{constructor(e){super(),or(this,e,cD,uD,Qi,{use:0,class:1,rich:2,getElement:8})}get getElement(){return this.$$.ctx[8]}}function hD(n){let e;const t=n[10].default,i=Ri(t,n,n[12],null);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a&4096)&&Pi(i,t,r,r[12],e?Oi(t,r[12],a,null):Di(r[12]),null)},i(r){e||(Te(i,r),e=!0)},o(r){Ne(i,r),e=!1},d(r){i&&i.d(r)}}}function fD(n){let e,t,i;const r=[{tag:n[3]},{use:[n[5],...n[0]]},{class:In({[n[1]]:!0,"mdc-button__label":n[6]==="button","mdc-fab__label":n[6]==="fab","mdc-tab__text-label":n[6]==="tab","mdc-image-list__label":n[6]==="image-list","mdc-snackbar__label":n[6]==="snackbar","mdc-banner__text":n[6]==="banner","mdc-segmented-button__label":n[6]==="segmented-button","mdc-data-table__pagination-rows-per-page-label":n[6]==="data-table:pagination","mdc-data-table__header-cell-label":n[6]==="data-table:sortable-header-cell"})},n[6]==="snackbar"?{"aria-atomic":"false"}:{},{tabindex:n[7]},n[8]];var a=n[2];function l(s){let d={$$slots:{default:[hD]},$$scope:{ctx:s}};for(let g=0;g<r.length;g+=1)d=zt(d,r[g]);return{props:d}}return a&&(e=Xa(a,l(n)),n[11](e)),{c(){e&&sn(e.$$.fragment),t=pi()},l(s){e&&dn(e.$$.fragment,s),t=pi()},m(s,d){e&&on(e,s,d),tt(s,t,d),i=!0},p(s,[d]){const g=d&491?hi(r,[d&8&&{tag:s[3]},d&33&&{use:[s[5],...s[0]]},d&66&&{class:In({[s[1]]:!0,"mdc-button__label":s[6]==="button","mdc-fab__label":s[6]==="fab","mdc-tab__text-label":s[6]==="tab","mdc-image-list__label":s[6]==="image-list","mdc-snackbar__label":s[6]==="snackbar","mdc-banner__text":s[6]==="banner","mdc-segmented-button__label":s[6]==="segmented-button","mdc-data-table__pagination-rows-per-page-label":s[6]==="data-table:pagination","mdc-data-table__header-cell-label":s[6]==="data-table:sortable-header-cell"})},d&64&&Mr(s[6]==="snackbar"?{"aria-atomic":"false"}:{}),d&128&&{tabindex:s[7]},d&256&&Mr(s[8])]):{};if(d&4096&&(g.$$scope={dirty:d,ctx:s}),d&4&&a!==(a=s[2])){if(e){Wi();const x=e;Ne(x.$$.fragment,1,0,()=>{an(x,1)}),Xi()}a?(e=Xa(a,l(s)),s[11](e),sn(e.$$.fragment),Te(e.$$.fragment,1),on(e,t.parentNode,t)):e=null}else a&&e.$set(g)},i(s){i||(e&&Te(e.$$.fragment,s),i=!0)},o(s){e&&Ne(e.$$.fragment,s),i=!1},d(s){n[11](null),s&&de(t),e&&an(e,s)}}}function dD(n,e,t){const i=["use","class","component","tag","getElement"];let r=vi(e,i),{$$slots:a={},$$scope:l}=e;const s=ps(ds());let{use:d=[]}=e,{class:g=""}=e,x,{component:I=Cu}=e,{tag:A=I===Cu?"span":void 0}=e;const L=Fr("SMUI:label:context"),N=Fr("SMUI:label:tabindex");function B(){return x.getElement()}function F(z){Sn[z?"unshift":"push"](()=>{x=z,t(4,x)})}return n.$$set=z=>{e=zt(zt({},e),ls(z)),t(8,r=vi(e,i)),"use"in z&&t(0,d=z.use),"class"in z&&t(1,g=z.class),"component"in z&&t(2,I=z.component),"tag"in z&&t(3,A=z.tag),"$$scope"in z&&t(12,l=z.$$scope)},[d,g,I,A,x,s,L,N,r,B,a,F,l]}class j_ extends sr{constructor(e){super(),or(this,e,dD,fD,Qi,{use:0,class:1,component:2,tag:3,getElement:9})}get getElement(){return this.$$.ctx[9]}}function pD(n){let e;const t=n[11].default,i=Ri(t,n,n[13],null);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a&8192)&&Pi(i,t,r,r[13],e?Oi(t,r[13],a,null):Di(r[13]),null)},i(r){e||(Te(i,r),e=!0)},o(r){Ne(i,r),e=!1},d(r){i&&i.d(r)}}}function mD(n){let e,t,i;const r=[{tag:n[4]},{use:[n[6],...n[0]]},{class:In({[n[1]]:!0,"mdc-button__icon":n[8]==="button","mdc-fab__icon":n[8]==="fab","mdc-icon-button__icon":n[8]==="icon-button","mdc-icon-button__icon--on":n[8]==="icon-button"&&n[2],"mdc-tab__icon":n[8]==="tab","mdc-banner__icon":n[8]==="banner","mdc-segmented-button__icon":n[8]==="segmented-button"})},{"aria-hidden":"true"},n[7]?{focusable:"false",tabindex:"-1"}:{},n[9]];var a=n[3];function l(s){let d={$$slots:{default:[pD]},$$scope:{ctx:s}};for(let g=0;g<r.length;g+=1)d=zt(d,r[g]);return{props:d}}return a&&(e=Xa(a,l(n)),n[12](e)),{c(){e&&sn(e.$$.fragment),t=pi()},l(s){e&&dn(e.$$.fragment,s),t=pi()},m(s,d){e&&on(e,s,d),tt(s,t,d),i=!0},p(s,[d]){const g=d&983?hi(r,[d&16&&{tag:s[4]},d&65&&{use:[s[6],...s[0]]},d&262&&{class:In({[s[1]]:!0,"mdc-button__icon":s[8]==="button","mdc-fab__icon":s[8]==="fab","mdc-icon-button__icon":s[8]==="icon-button","mdc-icon-button__icon--on":s[8]==="icon-button"&&s[2],"mdc-tab__icon":s[8]==="tab","mdc-banner__icon":s[8]==="banner","mdc-segmented-button__icon":s[8]==="segmented-button"})},r[3],d&128&&Mr(s[7]?{focusable:"false",tabindex:"-1"}:{}),d&512&&Mr(s[9])]):{};if(d&8192&&(g.$$scope={dirty:d,ctx:s}),d&8&&a!==(a=s[3])){if(e){Wi();const x=e;Ne(x.$$.fragment,1,0,()=>{an(x,1)}),Xi()}a?(e=Xa(a,l(s)),s[12](e),sn(e.$$.fragment),Te(e.$$.fragment,1),on(e,t.parentNode,t)):e=null}else a&&e.$set(g)},i(s){i||(e&&Te(e.$$.fragment,s),i=!0)},o(s){e&&Ne(e.$$.fragment,s),i=!1},d(s){n[12](null),s&&de(t),e&&an(e,s)}}}function gD(n,e,t){const i=["use","class","on","component","tag","getElement"];let r=vi(e,i),{$$slots:a={},$$scope:l}=e;const s=ps(ds());let{use:d=[]}=e,{class:g=""}=e,{on:x=!1}=e,I,{component:A=Cu}=e,{tag:L=A===Cu?"i":void 0}=e;const N=A===ID,B=Fr("SMUI:icon:context");function F(){return I.getElement()}function z(V){Sn[V?"unshift":"push"](()=>{I=V,t(5,I)})}return n.$$set=V=>{e=zt(zt({},e),ls(V)),t(9,r=vi(e,i)),"use"in V&&t(0,d=V.use),"class"in V&&t(1,g=V.class),"on"in V&&t(2,x=V.on),"component"in V&&t(3,A=V.component),"tag"in V&&t(4,L=V.tag),"$$scope"in V&&t(13,l=V.$$scope)},[d,g,x,A,L,I,s,N,B,r,F,a,z,l]}class MS extends sr{constructor(e){super(),or(this,e,gD,mD,Qi,{use:0,class:1,on:2,component:3,tag:4,getElement:10})}get getElement(){return this.$$.ctx[10]}}function _D(n){let e=n[1],t,i,r=n[1]&&Iw(n);return{c(){r&&r.c(),t=pi()},l(a){r&&r.l(a),t=pi()},m(a,l){r&&r.m(a,l),tt(a,t,l),i=!0},p(a,l){a[1]?e?Qi(e,a[1])?(r.d(1),r=Iw(a),e=a[1],r.c(),r.m(t.parentNode,t)):r.p(a,l):(r=Iw(a),e=a[1],r.c(),r.m(t.parentNode,t)):e&&(r.d(1),r=null,e=a[1])},i(a){i||(Te(r),i=!0)},o(a){Ne(r),i=!1},d(a){a&&de(t),r&&r.d(a)}}}function yD(n){let e=n[1],t,i=n[1]&&Tw(n);return{c(){i&&i.c(),t=pi()},l(r){i&&i.l(r),t=pi()},m(r,a){i&&i.m(r,a),tt(r,t,a)},p(r,a){r[1]?e?Qi(e,r[1])?(i.d(1),i=Tw(r),e=r[1],i.c(),i.m(t.parentNode,t)):i.p(r,a):(i=Tw(r),e=r[1],i.c(),i.m(t.parentNode,t)):e&&(i.d(1),i=null,e=r[1])},i:_l,o:_l,d(r){r&&de(t),i&&i.d(r)}}}function Iw(n){let e,t,i,r,a;const l=n[8].default,s=Ri(l,n,n[7],null);let d=[n[5]],g={};for(let x=0;x<d.length;x+=1)g=zt(g,d[x]);return{c(){e=qt(n[1]),s&&s.c(),this.h()},l(x){e=Wt(x,(n[1]||"null").toUpperCase(),{});var I=Qt(e);s&&s.l(I),I.forEach(de),this.h()},h(){PE(n[1])(e,g)},m(x,I){tt(x,e,I),s&&s.m(e,null),n[10](e),i=!0,r||(a=[li(t=jr.call(null,e,n[0])),li(n[4].call(null,e))],r=!0)},p(x,I){s&&s.p&&(!i||I&128)&&Pi(s,l,x,x[7],i?Oi(l,x[7],I,null):Di(x[7]),null),PE(x[1])(e,g=hi(d,[I&32&&x[5]])),t&&Gi(t.update)&&I&1&&t.update.call(null,x[0])},i(x){i||(Te(s,x),i=!0)},o(x){Ne(s,x),i=!1},d(x){x&&de(e),s&&s.d(x),n[10](null),r=!1,Ss(a)}}}function Tw(n){let e,t,i,r,a=[n[5]],l={};for(let s=0;s<a.length;s+=1)l=zt(l,a[s]);return{c(){e=qt(n[1]),this.h()},l(s){e=Wt(s,(n[1]||"null").toUpperCase(),{}),Qt(e).forEach(de),this.h()},h(){PE(n[1])(e,l)},m(s,d){tt(s,e,d),n[9](e),i||(r=[li(t=jr.call(null,e,n[0])),li(n[4].call(null,e))],i=!0)},p(s,d){PE(s[1])(e,l=hi(a,[d&32&&s[5]])),t&&Gi(t.update)&&d&1&&t.update.call(null,s[0])},d(s){s&&de(e),n[9](null),i=!1,Ss(r)}}}function vD(n){let e,t,i,r;const a=[yD,_D],l=[];function s(d,g){return d[3]?0:1}return e=s(n),t=l[e]=a[e](n),{c(){t.c(),i=pi()},l(d){t.l(d),i=pi()},m(d,g){l[e].m(d,g),tt(d,i,g),r=!0},p(d,[g]){let x=e;e=s(d),e===x?l[e].p(d,g):(Wi(),Ne(l[x],1,1,()=>{l[x]=null}),Xi(),t=l[e],t?t.p(d,g):(t=l[e]=a[e](d),t.c()),Te(t,1),t.m(i.parentNode,i))},i(d){r||(Te(t),r=!0)},o(d){Ne(t),r=!1},d(d){l[e].d(d),d&&de(i)}}}function bD(n,e,t){let i;const r=["use","tag","getElement"];let a=vi(e,r),{$$slots:l={},$$scope:s}=e,{use:d=[]}=e,{tag:g}=e;const x=ps(ds());let I;function A(){return I}function L(B){Sn[B?"unshift":"push"](()=>{I=B,t(2,I)})}function N(B){Sn[B?"unshift":"push"](()=>{I=B,t(2,I)})}return n.$$set=B=>{e=zt(zt({},e),ls(B)),t(5,a=vi(e,r)),"use"in B&&t(0,d=B.use),"tag"in B&&t(1,g=B.tag),"$$scope"in B&&t(7,s=B.$$scope)},n.$$.update=()=>{n.$$.dirty&2&&t(3,i=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"].indexOf(g)>-1)},[d,g,I,i,x,a,A,s,l,L,N]}class Cu extends sr{constructor(e){super(),or(this,e,bD,vD,Qi,{use:0,tag:1,getElement:6})}get getElement(){return this.$$.ctx[6]}}function xD(n){let e,t,i,r,a;const l=n[6].default,s=Ri(l,n,n[5],null);let d=[n[3]],g={};for(let x=0;x<d.length;x+=1)g=zt(g,d[x]);return{c(){e=TE("svg"),s&&s.c(),this.h()},l(x){e=wE(x,"svg",{});var I=Qt(e);s&&s.l(I),I.forEach(de),this.h()},h(){IC(e,g)},m(x,I){tt(x,e,I),s&&s.m(e,null),n[7](e),i=!0,r||(a=[li(t=jr.call(null,e,n[0])),li(n[2].call(null,e))],r=!0)},p(x,[I]){s&&s.p&&(!i||I&32)&&Pi(s,l,x,x[5],i?Oi(l,x[5],I,null):Di(x[5]),null),IC(e,g=hi(d,[I&8&&x[3]])),t&&Gi(t.update)&&I&1&&t.update.call(null,x[0])},i(x){i||(Te(s,x),i=!0)},o(x){Ne(s,x),i=!1},d(x){x&&de(e),s&&s.d(x),n[7](null),r=!1,Ss(a)}}}function ED(n,e,t){const i=["use","getElement"];let r=vi(e,i),{$$slots:a={},$$scope:l}=e,{use:s=[]}=e;const d=ps(ds());let g;function x(){return g}function I(A){Sn[A?"unshift":"push"](()=>{g=A,t(1,g)})}return n.$$set=A=>{e=zt(zt({},e),ls(A)),t(3,r=vi(e,i)),"use"in A&&t(0,s=A.use),"$$scope"in A&&t(5,l=A.$$scope)},[s,g,d,r,x,l,a,I]}class ID extends sr{constructor(e){super(),or(this,e,ED,xD,Qi,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function TD(n){let e;const t=n[4].default,i=Ri(t,n,n[3],null);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,[a]){i&&i.p&&(!e||a&8)&&Pi(i,t,r,r[3],e?Oi(t,r[3],a,null):Di(r[3]),null)},i(r){e||(Te(i,r),e=!0)},o(r){Ne(i,r),e=!1},d(r){i&&i.d(r)}}}function wD(n,e,t){let i,{$$slots:r={},$$scope:a}=e,{key:l}=e,{value:s}=e;const d=Eh(s);return Dl(n,d,g=>t(5,i=g)),lr(l,d),Dh(()=>{d.set(void 0)}),n.$$set=g=>{"key"in g&&t(1,l=g.key),"value"in g&&t(2,s=g.value),"$$scope"in g&&t(3,a=g.$$scope)},n.$$.update=()=>{n.$$.dirty&4&&bf(d,i=s,i)},[d,l,s,a,r]}class FE extends sr{constructor(e){super(),or(this,e,wD,TD,Qi,{key:1,value:2})}}function SD(n){let e;const t=n[11].default,i=Ri(t,n,n[13],null);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a&8192)&&Pi(i,t,r,r[13],e?Oi(t,r[13],a,null):Di(r[13]),null)},i(r){e||(Te(i,r),e=!0)},o(r){Ne(i,r),e=!1},d(r){i&&i.d(r)}}}function CD(n){let e,t,i;const r=[{tag:n[3]},{use:[n[8],...n[0]]},{class:In({[n[1]]:!0,[n[6]]:!0,...n[5]})},n[7],n[9]];var a=n[2];function l(s){let d={$$slots:{default:[SD]},$$scope:{ctx:s}};for(let g=0;g<r.length;g+=1)d=zt(d,r[g]);return{props:d}}return a&&(e=Xa(a,l(n)),n[12](e)),{c(){e&&sn(e.$$.fragment),t=pi()},l(s){e&&dn(e.$$.fragment,s),t=pi()},m(s,d){e&&on(e,s,d),tt(s,t,d),i=!0},p(s,[d]){const g=d&1003?hi(r,[d&8&&{tag:s[3]},d&257&&{use:[s[8],...s[0]]},d&98&&{class:In({[s[1]]:!0,[s[6]]:!0,...s[5]})},d&128&&Mr(s[7]),d&512&&Mr(s[9])]):{};if(d&8192&&(g.$$scope={dirty:d,ctx:s}),d&4&&a!==(a=s[2])){if(e){Wi();const x=e;Ne(x.$$.fragment,1,0,()=>{an(x,1)}),Xi()}a?(e=Xa(a,l(s)),s[12](e),sn(e.$$.fragment),Te(e.$$.fragment,1),on(e,t.parentNode,t)):e=null}else a&&e.$set(g)},i(s){i||(e&&Te(e.$$.fragment,s),i=!0)},o(s){e&&Ne(e.$$.fragment,s),i=!1},d(s){n[12](null),s&&de(t),e&&an(e,s)}}}const sm={component:Cu,tag:"div",class:"",classMap:{},contexts:{},props:{}};function AD(n,e,t){const i=["use","class","component","tag","getElement"];let r=vi(e,i),{$$slots:a={},$$scope:l}=e,{use:s=[]}=e,{class:d=""}=e,g;const x=sm.class,I={},A=[],L=sm.contexts,N=sm.props;let{component:B=sm.component}=e,{tag:F=B===Cu?sm.tag:void 0}=e;Object.entries(sm.classMap).forEach(([Q,J])=>{const he=Fr(J);he&&"subscribe"in he&&A.push(he.subscribe(ee=>{t(5,I[Q]=ee,I)}))});const z=ps(ds());for(let Q in L)L.hasOwnProperty(Q)&&lr(Q,L[Q]);Dh(()=>{for(const Q of A)Q()});function V(){return g.getElement()}function Y(Q){Sn[Q?"unshift":"push"](()=>{g=Q,t(4,g)})}return n.$$set=Q=>{e=zt(zt({},e),ls(Q)),t(9,r=vi(e,i)),"use"in Q&&t(0,s=Q.use),"class"in Q&&t(1,d=Q.class),"component"in Q&&t(2,B=Q.component),"tag"in Q&&t(3,F=Q.tag),"$$scope"in Q&&t(13,l=Q.$$scope)},[s,d,B,F,g,I,x,N,z,r,V,a,Y,l]}class MD extends sr{constructor(e){super(),or(this,e,AD,CD,Qi,{use:0,class:1,component:2,tag:3,getElement:10})}get getElement(){return this.$$.ctx[10]}}const DC=Object.assign({},sm);function zl(n){return new Proxy(MD,{construct:function(e,t){return Object.assign(sm,DC,n),new e(...t)},get:function(e,t){return Object.assign(sm,DC,n),e[t]}})}zl({class:"mdc-tooltip__title",tag:"h2"});const LD=zl({class:"mdc-tooltip__content",tag:"div"});zl({class:"mdc-tooltip__content-link",tag:"a"});zl({class:"mdc-tooltip--rich-actions",tag:"div",contexts:{"SMUI:button:context":"tooltip:rich-actions"}});var lE;function RD(n,e){e===void 0&&(e=!1);var t=n.CSS,i=lE;if(typeof lE=="boolean"&&!e)return lE;var r=t&&typeof t.supports=="function";if(!r)return!1;var a=t.supports("--css-vars","yes"),l=t.supports("(--css-vars: yes)")&&t.supports("color","#00000000");return i=a||l,e||(lE=i),i}function PD(n,e,t){if(!n)return{x:0,y:0};var i=e.x,r=e.y,a=i+t.left,l=r+t.top,s,d;if(n.type==="touchstart"){var g=n;s=g.changedTouches[0].pageX-a,d=g.changedTouches[0].pageY-l}else{var x=n;s=x.pageX-a,d=x.pageY-l}return{x:s,y:d}}/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function DD(n){return n===void 0&&(n=window),OD(n)?{passive:!0}:!1}function OD(n){n===void 0&&(n=window);var e=!1;try{var t={get passive(){return e=!0,!1}},i=function(){};n.document.addEventListener("test",i,t),n.document.removeEventListener("test",i,t)}catch{e=!1}return e}const gL=Object.freeze(Object.defineProperty({__proto__:null,applyPassive:DD},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function ND(n,e){if(n.closest)return n.closest(e);for(var t=n;t;){if(_L(t,e))return t;t=t.parentElement}return null}function _L(n,e){var t=n.matches||n.webkitMatchesSelector||n.msMatchesSelector;return t.call(n,e)}function kD(n){var e=n;if(e.offsetParent!==null)return e.scrollWidth;var t=e.cloneNode(!0);t.style.setProperty("position","absolute"),t.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(t);var i=t.scrollWidth;return document.documentElement.removeChild(t),i}const r0=Object.freeze(Object.defineProperty({__proto__:null,closest:ND,estimateScrollWidth:kD,matches:_L},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var FD={BG_FOCUSED:"mdc-ripple-upgraded--background-focused",FG_ACTIVATION:"mdc-ripple-upgraded--foreground-activation",FG_DEACTIVATION:"mdc-ripple-upgraded--foreground-deactivation",ROOT:"mdc-ripple-upgraded",UNBOUNDED:"mdc-ripple-upgraded--unbounded"},BD={VAR_FG_SCALE:"--mdc-ripple-fg-scale",VAR_FG_SIZE:"--mdc-ripple-fg-size",VAR_FG_TRANSLATE_END:"--mdc-ripple-fg-translate-end",VAR_FG_TRANSLATE_START:"--mdc-ripple-fg-translate-start",VAR_LEFT:"--mdc-ripple-left",VAR_TOP:"--mdc-ripple-top"},OC={DEACTIVATION_TIMEOUT_MS:225,FG_DEACTIVATION_MS:150,INITIAL_ORIGIN_SCALE:.6,PADDING:10,TAP_DELAY_MS:300};/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var NC=["touchstart","pointerdown","mousedown","keydown"],kC=["touchend","pointerup","mouseup","contextmenu"],uE=[],zD=function(n){Wo(e,n);function e(t){var i=n.call(this,zr(zr({},e.defaultAdapter),t))||this;return i.activationAnimationHasEnded=!1,i.activationTimer=0,i.fgDeactivationRemovalTimer=0,i.fgScale="0",i.frame={width:0,height:0},i.initialSize=0,i.layoutFrame=0,i.maxRadius=0,i.unboundedCoords={left:0,top:0},i.activationState=i.defaultActivationState(),i.activationTimerCallback=function(){i.activationAnimationHasEnded=!0,i.runDeactivationUXLogicIfReady()},i.activateHandler=function(r){i.activateImpl(r)},i.deactivateHandler=function(){i.deactivateImpl()},i.focusHandler=function(){i.handleFocus()},i.blurHandler=function(){i.handleBlur()},i.resizeHandler=function(){i.layout()},i}return Object.defineProperty(e,"cssClasses",{get:function(){return FD},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return BD},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return OC},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},browserSupportsCssVars:function(){return!0},computeBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},containsEventTarget:function(){return!0},deregisterDocumentInteractionHandler:function(){},deregisterInteractionHandler:function(){},deregisterResizeHandler:function(){},getWindowPageOffset:function(){return{x:0,y:0}},isSurfaceActive:function(){return!0},isSurfaceDisabled:function(){return!0},isUnbounded:function(){return!0},registerDocumentInteractionHandler:function(){},registerInteractionHandler:function(){},registerResizeHandler:function(){},removeClass:function(){},updateCssVariable:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){var t=this,i=this.supportsPressRipple();if(this.registerRootHandlers(i),i){var r=e.cssClasses,a=r.ROOT,l=r.UNBOUNDED;requestAnimationFrame(function(){t.adapter.addClass(a),t.adapter.isUnbounded()&&(t.adapter.addClass(l),t.layoutInternal())})}},e.prototype.destroy=function(){var t=this;if(this.supportsPressRipple()){this.activationTimer&&(clearTimeout(this.activationTimer),this.activationTimer=0,this.adapter.removeClass(e.cssClasses.FG_ACTIVATION)),this.fgDeactivationRemovalTimer&&(clearTimeout(this.fgDeactivationRemovalTimer),this.fgDeactivationRemovalTimer=0,this.adapter.removeClass(e.cssClasses.FG_DEACTIVATION));var i=e.cssClasses,r=i.ROOT,a=i.UNBOUNDED;requestAnimationFrame(function(){t.adapter.removeClass(r),t.adapter.removeClass(a),t.removeCssVars()})}this.deregisterRootHandlers(),this.deregisterDeactivationHandlers()},e.prototype.activate=function(t){this.activateImpl(t)},e.prototype.deactivate=function(){this.deactivateImpl()},e.prototype.layout=function(){var t=this;this.layoutFrame&&cancelAnimationFrame(this.layoutFrame),this.layoutFrame=requestAnimationFrame(function(){t.layoutInternal(),t.layoutFrame=0})},e.prototype.setUnbounded=function(t){var i=e.cssClasses.UNBOUNDED;t?this.adapter.addClass(i):this.adapter.removeClass(i)},e.prototype.handleFocus=function(){var t=this;requestAnimationFrame(function(){return t.adapter.addClass(e.cssClasses.BG_FOCUSED)})},e.prototype.handleBlur=function(){var t=this;requestAnimationFrame(function(){return t.adapter.removeClass(e.cssClasses.BG_FOCUSED)})},e.prototype.supportsPressRipple=function(){return this.adapter.browserSupportsCssVars()},e.prototype.defaultActivationState=function(){return{activationEvent:void 0,hasDeactivationUXRun:!1,isActivated:!1,isProgrammatic:!1,wasActivatedByPointer:!1,wasElementMadeActive:!1}},e.prototype.registerRootHandlers=function(t){var i,r;if(t){try{for(var a=nu(NC),l=a.next();!l.done;l=a.next()){var s=l.value;this.adapter.registerInteractionHandler(s,this.activateHandler)}}catch(d){i={error:d}}finally{try{l&&!l.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}this.adapter.isUnbounded()&&this.adapter.registerResizeHandler(this.resizeHandler)}this.adapter.registerInteractionHandler("focus",this.focusHandler),this.adapter.registerInteractionHandler("blur",this.blurHandler)},e.prototype.registerDeactivationHandlers=function(t){var i,r;if(t.type==="keydown")this.adapter.registerInteractionHandler("keyup",this.deactivateHandler);else try{for(var a=nu(kC),l=a.next();!l.done;l=a.next()){var s=l.value;this.adapter.registerDocumentInteractionHandler(s,this.deactivateHandler)}}catch(d){i={error:d}}finally{try{l&&!l.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}},e.prototype.deregisterRootHandlers=function(){var t,i;try{for(var r=nu(NC),a=r.next();!a.done;a=r.next()){var l=a.value;this.adapter.deregisterInteractionHandler(l,this.activateHandler)}}catch(s){t={error:s}}finally{try{a&&!a.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}this.adapter.deregisterInteractionHandler("focus",this.focusHandler),this.adapter.deregisterInteractionHandler("blur",this.blurHandler),this.adapter.isUnbounded()&&this.adapter.deregisterResizeHandler(this.resizeHandler)},e.prototype.deregisterDeactivationHandlers=function(){var t,i;this.adapter.deregisterInteractionHandler("keyup",this.deactivateHandler);try{for(var r=nu(kC),a=r.next();!a.done;a=r.next()){var l=a.value;this.adapter.deregisterDocumentInteractionHandler(l,this.deactivateHandler)}}catch(s){t={error:s}}finally{try{a&&!a.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}},e.prototype.removeCssVars=function(){var t=this,i=e.strings,r=Object.keys(i);r.forEach(function(a){a.indexOf("VAR_")===0&&t.adapter.updateCssVariable(i[a],null)})},e.prototype.activateImpl=function(t){var i=this;if(!this.adapter.isSurfaceDisabled()){var r=this.activationState;if(!r.isActivated){var a=this.previousActivationEvent,l=a&&t!==void 0&&a.type!==t.type;if(!l){r.isActivated=!0,r.isProgrammatic=t===void 0,r.activationEvent=t,r.wasActivatedByPointer=r.isProgrammatic?!1:t!==void 0&&(t.type==="mousedown"||t.type==="touchstart"||t.type==="pointerdown");var s=t!==void 0&&uE.length>0&&uE.some(function(d){return i.adapter.containsEventTarget(d)});if(s){this.resetActivationState();return}t!==void 0&&(uE.push(t.target),this.registerDeactivationHandlers(t)),r.wasElementMadeActive=this.checkElementMadeActive(t),r.wasElementMadeActive&&this.animateActivation(),requestAnimationFrame(function(){uE=[],!r.wasElementMadeActive&&t!==void 0&&(t.key===" "||t.keyCode===32)&&(r.wasElementMadeActive=i.checkElementMadeActive(t),r.wasElementMadeActive&&i.animateActivation()),r.wasElementMadeActive||(i.activationState=i.defaultActivationState())})}}}},e.prototype.checkElementMadeActive=function(t){return t!==void 0&&t.type==="keydown"?this.adapter.isSurfaceActive():!0},e.prototype.animateActivation=function(){var t=this,i=e.strings,r=i.VAR_FG_TRANSLATE_START,a=i.VAR_FG_TRANSLATE_END,l=e.cssClasses,s=l.FG_DEACTIVATION,d=l.FG_ACTIVATION,g=e.numbers.DEACTIVATION_TIMEOUT_MS;this.layoutInternal();var x="",I="";if(!this.adapter.isUnbounded()){var A=this.getFgTranslationCoordinates(),L=A.startPoint,N=A.endPoint;x=L.x+"px, "+L.y+"px",I=N.x+"px, "+N.y+"px"}this.adapter.updateCssVariable(r,x),this.adapter.updateCssVariable(a,I),clearTimeout(this.activationTimer),clearTimeout(this.fgDeactivationRemovalTimer),this.rmBoundedActivationClasses(),this.adapter.removeClass(s),this.adapter.computeBoundingRect(),this.adapter.addClass(d),this.activationTimer=setTimeout(function(){t.activationTimerCallback()},g)},e.prototype.getFgTranslationCoordinates=function(){var t=this.activationState,i=t.activationEvent,r=t.wasActivatedByPointer,a;r?a=PD(i,this.adapter.getWindowPageOffset(),this.adapter.computeBoundingRect()):a={x:this.frame.width/2,y:this.frame.height/2},a={x:a.x-this.initialSize/2,y:a.y-this.initialSize/2};var l={x:this.frame.width/2-this.initialSize/2,y:this.frame.height/2-this.initialSize/2};return{startPoint:a,endPoint:l}},e.prototype.runDeactivationUXLogicIfReady=function(){var t=this,i=e.cssClasses.FG_DEACTIVATION,r=this.activationState,a=r.hasDeactivationUXRun,l=r.isActivated,s=a||!l;s&&this.activationAnimationHasEnded&&(this.rmBoundedActivationClasses(),this.adapter.addClass(i),this.fgDeactivationRemovalTimer=setTimeout(function(){t.adapter.removeClass(i)},OC.FG_DEACTIVATION_MS))},e.prototype.rmBoundedActivationClasses=function(){var t=e.cssClasses.FG_ACTIVATION;this.adapter.removeClass(t),this.activationAnimationHasEnded=!1,this.adapter.computeBoundingRect()},e.prototype.resetActivationState=function(){var t=this;this.previousActivationEvent=this.activationState.activationEvent,this.activationState=this.defaultActivationState(),setTimeout(function(){return t.previousActivationEvent=void 0},e.numbers.TAP_DELAY_MS)},e.prototype.deactivateImpl=function(){var t=this,i=this.activationState;if(i.isActivated){var r=zr({},i);i.isProgrammatic?(requestAnimationFrame(function(){t.animateDeactivation(r)}),this.resetActivationState()):(this.deregisterDeactivationHandlers(),requestAnimationFrame(function(){t.activationState.hasDeactivationUXRun=!0,t.animateDeactivation(r),t.resetActivationState()}))}},e.prototype.animateDeactivation=function(t){var i=t.wasActivatedByPointer,r=t.wasElementMadeActive;(i||r)&&this.runDeactivationUXLogicIfReady()},e.prototype.layoutInternal=function(){var t=this;this.frame=this.adapter.computeBoundingRect();var i=Math.max(this.frame.height,this.frame.width),r=function(){var l=Math.sqrt(Math.pow(t.frame.width,2)+Math.pow(t.frame.height,2));return l+e.numbers.PADDING};this.maxRadius=this.adapter.isUnbounded()?i:r();var a=Math.floor(i*e.numbers.INITIAL_ORIGIN_SCALE);this.adapter.isUnbounded()&&a%2!==0?this.initialSize=a-1:this.initialSize=a,this.fgScale=""+this.maxRadius/this.initialSize,this.updateLayoutCssVars()},e.prototype.updateLayoutCssVars=function(){var t=e.strings,i=t.VAR_FG_SIZE,r=t.VAR_LEFT,a=t.VAR_TOP,l=t.VAR_FG_SCALE;this.adapter.updateCssVariable(i,this.initialSize+"px"),this.adapter.updateCssVariable(l,this.fgScale),this.adapter.isUnbounded()&&(this.unboundedCoords={left:Math.round(this.frame.width/2-this.initialSize/2),top:Math.round(this.frame.height/2-this.initialSize/2)},this.adapter.updateCssVariable(r,this.unboundedCoords.left+"px"),this.adapter.updateCssVariable(a,this.unboundedCoords.top+"px"))},e}(xl);/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var ww="mdc-dom-focus-sentinel",UD=function(){function n(e,t){t===void 0&&(t={}),this.root=e,this.options=t,this.elFocusedBeforeTrapFocus=null}return n.prototype.trapFocus=function(){var e=this.getFocusableElements(this.root);if(e.length===0)throw new Error("FocusTrap: Element must have at least one focusable child.");this.elFocusedBeforeTrapFocus=document.activeElement instanceof HTMLElement?document.activeElement:null,this.wrapTabFocus(this.root),this.options.skipInitialFocus||this.focusInitialElement(e,this.options.initialFocusEl)},n.prototype.releaseFocus=function(){[].slice.call(this.root.querySelectorAll("."+ww)).forEach(function(e){e.parentElement.removeChild(e)}),!this.options.skipRestoreFocus&&this.elFocusedBeforeTrapFocus&&this.elFocusedBeforeTrapFocus.focus()},n.prototype.wrapTabFocus=function(e){var t=this,i=this.createSentinel(),r=this.createSentinel();i.addEventListener("focus",function(){var a=t.getFocusableElements(e);a.length>0&&a[a.length-1].focus()}),r.addEventListener("focus",function(){var a=t.getFocusableElements(e);a.length>0&&a[0].focus()}),e.insertBefore(i,e.children[0]),e.appendChild(r)},n.prototype.focusInitialElement=function(e,t){var i=0;t&&(i=Math.max(e.indexOf(t),0)),e[i].focus()},n.prototype.getFocusableElements=function(e){var t=[].slice.call(e.querySelectorAll("[autofocus], [tabindex], a, input, textarea, select, button"));return t.filter(function(i){var r=i.getAttribute("aria-disabled")==="true"||i.getAttribute("disabled")!=null||i.getAttribute("hidden")!=null||i.getAttribute("aria-hidden")==="true",a=i.tabIndex>=0&&i.getBoundingClientRect().width>0&&!i.classList.contains(ww)&&!r,l=!1;if(a){var s=getComputedStyle(i);l=s.display==="none"||s.visibility==="hidden"}return a&&!l})},n.prototype.createSentinel=function(){var e=document.createElement("div");return e.setAttribute("tabindex","0"),e.setAttribute("aria-hidden","true"),e.classList.add(ww),e},n}();const VD=Object.freeze(Object.defineProperty({__proto__:null,FocusTrap:UD},Symbol.toStringTag,{value:"Module"})),{applyPassive:cE}=gL,{matches:GD}=r0;function jc(n,{ripple:e=!0,surface:t=!1,unbounded:i=!1,disabled:r=!1,color:a,active:l,rippleElement:s,eventTarget:d,activeTarget:g,addClass:x=N=>n.classList.add(N),removeClass:I=N=>n.classList.remove(N),addStyle:A=(N,B)=>n.style.setProperty(N,B),initPromise:L=Promise.resolve()}={}){let N,B=Fr("SMUI:addLayoutListener"),F,z=l,V=d,Y=g;function Q(){t?(x("mdc-ripple-surface"),a==="primary"?(x("smui-ripple-surface--primary"),I("smui-ripple-surface--secondary")):a==="secondary"?(I("smui-ripple-surface--primary"),x("smui-ripple-surface--secondary")):(I("smui-ripple-surface--primary"),I("smui-ripple-surface--secondary"))):(I("mdc-ripple-surface"),I("smui-ripple-surface--primary"),I("smui-ripple-surface--secondary")),N&&z!==l&&(z=l,l?N.activate():l===!1&&N.deactivate()),e&&!N?(N=new zD({addClass:x,browserSupportsCssVars:()=>RD(window),computeBoundingRect:()=>(s||n).getBoundingClientRect(),containsEventTarget:he=>n.contains(he),deregisterDocumentInteractionHandler:(he,ee)=>document.documentElement.removeEventListener(he,ee,cE()),deregisterInteractionHandler:(he,ee)=>(d||n).removeEventListener(he,ee,cE()),deregisterResizeHandler:he=>window.removeEventListener("resize",he),getWindowPageOffset:()=>({x:window.pageXOffset,y:window.pageYOffset}),isSurfaceActive:()=>l??GD(g||n,":active"),isSurfaceDisabled:()=>!!r,isUnbounded:()=>!!i,registerDocumentInteractionHandler:(he,ee)=>document.documentElement.addEventListener(he,ee,cE()),registerInteractionHandler:(he,ee)=>(d||n).addEventListener(he,ee,cE()),registerResizeHandler:he=>window.addEventListener("resize",he),removeClass:I,updateCssVariable:A}),L.then(()=>{N&&(N.init(),N.setUnbounded(i))})):N&&!e&&L.then(()=>{N&&(N.destroy(),N=void 0)}),N&&(V!==d||Y!==g)&&(V=d,Y=g,N.destroy(),requestAnimationFrame(()=>{N&&(N.init(),N.setUnbounded(i))})),!e&&i&&x("mdc-ripple-upgraded--unbounded")}Q(),B&&(F=B(J));function J(){N&&N.layout()}return{update(he){({ripple:e,surface:t,unbounded:i,disabled:r,color:a,active:l,rippleElement:s,eventTarget:d,activeTarget:g,addClass:x,removeClass:I,addStyle:A,initPromise:L}=Object.assign({ripple:!0,surface:!1,unbounded:!1,disabled:!1,color:void 0,active:void 0,rippleElement:void 0,eventTarget:void 0,activeTarget:void 0,addClass:ee=>n.classList.add(ee),removeClass:ee=>n.classList.remove(ee),addStyle:(ee,ae)=>n.style.setProperty(ee,ae),initPromise:Promise.resolve()},he)),Q()},destroy(){N&&(N.destroy(),N=void 0,I("mdc-ripple-surface"),I("smui-ripple-surface--primary"),I("smui-ripple-surface--secondary")),F&&F()}}}function FC(n){let e;return{c(){e=qt("div"),this.h()},l(t){e=Wt(t,"DIV",{class:!0}),Qt(e).forEach(de),this.h()},h(){tn(e,"class","mdc-button__touch")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function HD(n){let e,t,i,r;const a=n[28].default,l=Ri(a,n,n[30],null);let s=n[6]&&FC();return{c(){e=qt("div"),t=vn(),l&&l.c(),s&&s.c(),i=pi(),this.h()},l(d){e=Wt(d,"DIV",{class:!0}),Qt(e).forEach(de),t=bn(d),l&&l.l(d),s&&s.l(d),i=pi(),this.h()},h(){tn(e,"class","mdc-button__ripple")},m(d,g){tt(d,e,g),tt(d,t,g),l&&l.m(d,g),s&&s.m(d,g),tt(d,i,g),r=!0},p(d,g){l&&l.p&&(!r||g[0]&1073741824)&&Pi(l,a,d,d[30],r?Oi(a,d[30],g,null):Di(d[30]),null),d[6]?s||(s=FC(),s.c(),s.m(i.parentNode,i)):s&&(s.d(1),s=null)},i(d){r||(Te(l,d),r=!0)},o(d){Ne(l,d),r=!1},d(d){d&&de(e),d&&de(t),l&&l.d(d),s&&s.d(d),d&&de(i)}}}function jD(n){let e,t,i;const r=[{tag:n[10]},{use:[[jc,{ripple:n[3],unbounded:!1,color:n[4],disabled:!!n[23].disabled,addClass:n[19],removeClass:n[20],addStyle:n[21]}],n[17],...n[0]]},{class:In({[n[1]]:!0,"mdc-button":!0,"mdc-button--raised":n[5]==="raised","mdc-button--unelevated":n[5]==="unelevated","mdc-button--outlined":n[5]==="outlined","smui-button--color-secondary":n[4]==="secondary","mdc-button--touch":n[6],"mdc-card__action":n[18]==="card:action","mdc-card__action--button":n[18]==="card:action","mdc-dialog__button":n[18]==="dialog:action","mdc-top-app-bar__navigation-icon":n[18]==="top-app-bar:navigation","mdc-top-app-bar__action-item":n[18]==="top-app-bar:action","mdc-snackbar__action":n[18]==="snackbar:actions","mdc-banner__secondary-action":n[18]==="banner"&&n[8],"mdc-banner__primary-action":n[18]==="banner"&&!n[8],"mdc-tooltip__action":n[18]==="tooltip:rich-actions",...n[12]})},{style:Object.entries(n[13]).map(BC).concat([n[2]]).join(" ")},n[16],n[15],n[14],{href:n[7]},n[23]];var a=n[9];function l(s){let d={$$slots:{default:[HD]},$$scope:{ctx:s}};for(let g=0;g<r.length;g+=1)d=zt(d,r[g]);return{props:d}}return a&&(e=Xa(a,l(n)),n[29](e),e.$on("click",n[22])),{c(){e&&sn(e.$$.fragment),t=pi()},l(s){e&&dn(e.$$.fragment,s),t=pi()},m(s,d){e&&on(e,s,d),tt(s,t,d),i=!0},p(s,d){const g=d[0]&12580351?hi(r,[d[0]&1024&&{tag:s[10]},d[0]&12189721&&{use:[[jc,{ripple:s[3],unbounded:!1,color:s[4],disabled:!!s[23].disabled,addClass:s[19],removeClass:s[20],addStyle:s[21]}],s[17],...s[0]]},d[0]&266610&&{class:In({[s[1]]:!0,"mdc-button":!0,"mdc-button--raised":s[5]==="raised","mdc-button--unelevated":s[5]==="unelevated","mdc-button--outlined":s[5]==="outlined","smui-button--color-secondary":s[4]==="secondary","mdc-button--touch":s[6],"mdc-card__action":s[18]==="card:action","mdc-card__action--button":s[18]==="card:action","mdc-dialog__button":s[18]==="dialog:action","mdc-top-app-bar__navigation-icon":s[18]==="top-app-bar:navigation","mdc-top-app-bar__action-item":s[18]==="top-app-bar:action","mdc-snackbar__action":s[18]==="snackbar:actions","mdc-banner__secondary-action":s[18]==="banner"&&s[8],"mdc-banner__primary-action":s[18]==="banner"&&!s[8],"mdc-tooltip__action":s[18]==="tooltip:rich-actions",...s[12]})},d[0]&8196&&{style:Object.entries(s[13]).map(BC).concat([s[2]]).join(" ")},d[0]&65536&&Mr(s[16]),d[0]&32768&&Mr(s[15]),d[0]&16384&&Mr(s[14]),d[0]&128&&{href:s[7]},d[0]&8388608&&Mr(s[23])]):{};if(d[0]&1073741888&&(g.$$scope={dirty:d,ctx:s}),d[0]&512&&a!==(a=s[9])){if(e){Wi();const x=e;Ne(x.$$.fragment,1,0,()=>{an(x,1)}),Xi()}a?(e=Xa(a,l(s)),s[29](e),e.$on("click",s[22]),sn(e.$$.fragment),Te(e.$$.fragment,1),on(e,t.parentNode,t)):e=null}else a&&e.$set(g)},i(s){i||(e&&Te(e.$$.fragment,s),i=!0)},o(s){e&&Ne(e.$$.fragment,s),i=!1},d(s){n[29](null),s&&de(t),e&&an(e,s)}}}const BC=([n,e])=>`${n}: ${e};`;function qD(n,e,t){let i,r,a;const l=["use","class","style","ripple","color","variant","touch","href","action","defaultAction","secondary","component","tag","getElement"];let s=vi(e,l),{$$slots:d={},$$scope:g}=e;const x=ps(ds());let{use:I=[]}=e,{class:A=""}=e,{style:L=""}=e,{ripple:N=!0}=e,{color:B="primary"}=e,{variant:F="text"}=e,{touch:z=!1}=e,{href:V=void 0}=e,{action:Y="close"}=e,{defaultAction:Q=!1}=e,{secondary:J=!1}=e,he,ee={},ae={},De=Fr("SMUI:button:context"),{component:fe=Cu}=e,{tag:le=fe===Cu?V==null?"button":"a":void 0}=e,Be=s.disabled;lr("SMUI:label:context","button"),lr("SMUI:icon:context","button");function Pe(ke){ee[ke]||t(12,ee[ke]=!0,ee)}function Ce(ke){(!(ke in ee)||ee[ke])&&t(12,ee[ke]=!1,ee)}function it(ke,Dt){ae[ke]!=Dt&&(Dt===""||Dt==null?(delete ae[ke],t(13,ae)):t(13,ae[ke]=Dt,ae))}function Et(){De==="banner"&&ji(Ue(),J?"SMUIBannerButton:secondaryActionClick":"SMUIBannerButton:primaryActionClick")}function Ue(){return he.getElement()}function at(ke){Sn[ke?"unshift":"push"](()=>{he=ke,t(11,he)})}return n.$$set=ke=>{t(31,e=zt(zt({},e),ls(ke))),t(23,s=vi(e,l)),"use"in ke&&t(0,I=ke.use),"class"in ke&&t(1,A=ke.class),"style"in ke&&t(2,L=ke.style),"ripple"in ke&&t(3,N=ke.ripple),"color"in ke&&t(4,B=ke.color),"variant"in ke&&t(5,F=ke.variant),"touch"in ke&&t(6,z=ke.touch),"href"in ke&&t(7,V=ke.href),"action"in ke&&t(24,Y=ke.action),"defaultAction"in ke&&t(25,Q=ke.defaultAction),"secondary"in ke&&t(8,J=ke.secondary),"component"in ke&&t(9,fe=ke.component),"tag"in ke&&t(10,le=ke.tag),"$$scope"in ke&&t(30,g=ke.$$scope)},n.$$.update=()=>{if(t(16,i=De==="dialog:action"&&Y!=null?{"data-mdc-dialog-action":Y}:{action:e.action}),t(15,r=De==="dialog:action"&&Q?{"data-mdc-dialog-button-default":""}:{default:e.default}),t(14,a=De==="banner"?{}:{secondary:e.secondary}),Be!==s.disabled){const ke=Ue();"blur"in ke&&ke.blur(),t(27,Be=s.disabled)}},e=ls(e),[I,A,L,N,B,F,z,V,J,fe,le,he,ee,ae,a,r,i,x,De,Pe,Ce,it,Et,s,Y,Q,Ue,Be,d,at,g]}class cp extends sr{constructor(e){super(),or(this,e,qD,jD,Qi,{use:0,class:1,style:2,ripple:3,color:4,variant:5,touch:6,href:7,action:24,defaultAction:25,secondary:8,component:9,tag:10,getElement:26},null,[-1,-1])}get getElement(){return this.$$.ctx[26]}}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var hE={ICON_BUTTON_ON:"mdc-icon-button--on",ROOT:"mdc-icon-button"},nm={ARIA_LABEL:"aria-label",ARIA_PRESSED:"aria-pressed",DATA_ARIA_LABEL_OFF:"data-aria-label-off",DATA_ARIA_LABEL_ON:"data-aria-label-on",CHANGE_EVENT:"MDCIconButtonToggle:change"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var WD=function(n){Wo(e,n);function e(t){var i=n.call(this,zr(zr({},e.defaultAdapter),t))||this;return i.hasToggledAriaLabel=!1,i}return Object.defineProperty(e,"cssClasses",{get:function(){return hE},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return nm},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},hasClass:function(){return!1},notifyChange:function(){},removeClass:function(){},getAttr:function(){return null},setAttr:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){var t=this.adapter.getAttr(nm.DATA_ARIA_LABEL_ON),i=this.adapter.getAttr(nm.DATA_ARIA_LABEL_OFF);if(t&&i){if(this.adapter.getAttr(nm.ARIA_PRESSED)!==null)throw new Error("MDCIconButtonToggleFoundation: Button should not set `aria-pressed` if it has a toggled aria label.");this.hasToggledAriaLabel=!0}else this.adapter.setAttr(nm.ARIA_PRESSED,String(this.isOn()))},e.prototype.handleClick=function(){this.toggle(),this.adapter.notifyChange({isOn:this.isOn()})},e.prototype.isOn=function(){return this.adapter.hasClass(hE.ICON_BUTTON_ON)},e.prototype.toggle=function(t){if(t===void 0&&(t=!this.isOn()),t?this.adapter.addClass(hE.ICON_BUTTON_ON):this.adapter.removeClass(hE.ICON_BUTTON_ON),this.hasToggledAriaLabel){var i=t?this.adapter.getAttr(nm.DATA_ARIA_LABEL_ON):this.adapter.getAttr(nm.DATA_ARIA_LABEL_OFF);this.adapter.setAttr(nm.ARIA_LABEL,i||"")}else this.adapter.setAttr(nm.ARIA_PRESSED,""+t)},e}(xl);function zC(n){let e;return{c(){e=qt("div"),this.h()},l(t){e=Wt(t,"DIV",{class:!0}),Qt(e).forEach(de),this.h()},h(){tn(e,"class","mdc-icon-button__touch")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function XD(n){let e,t,i,r;const a=n[33].default,l=Ri(a,n,n[37],null);let s=n[8]&&zC();return{c(){e=qt("div"),t=vn(),l&&l.c(),s&&s.c(),i=pi(),this.h()},l(d){e=Wt(d,"DIV",{class:!0}),Qt(e).forEach(de),t=bn(d),l&&l.l(d),s&&s.l(d),i=pi(),this.h()},h(){tn(e,"class","mdc-icon-button__ripple")},m(d,g){tt(d,e,g),tt(d,t,g),l&&l.m(d,g),s&&s.m(d,g),tt(d,i,g),r=!0},p(d,g){l&&l.p&&(!r||g[1]&64)&&Pi(l,a,d,d[37],r?Oi(a,d[37],g,null):Di(d[37]),null),d[8]?s||(s=zC(),s.c(),s.m(i.parentNode,i)):s&&(s.d(1),s=null)},i(d){r||(Te(l,d),r=!0)},o(d){Ne(l,d),r=!1},d(d){d&&de(e),d&&de(t),l&&l.d(d),s&&s.d(d),d&&de(i)}}}function ZD(n){let e,t,i;const r=[{tag:n[14]},{use:[[jc,{ripple:n[4],unbounded:!0,color:n[5],disabled:!!n[29].disabled,addClass:n[26],removeClass:n[27],addStyle:n[28]}],n[22],...n[1]]},{class:In({[n[2]]:!0,"mdc-icon-button":!0,"mdc-icon-button--on":!n[23](n[0])&&n[0],"mdc-icon-button--touch":n[8],"mdc-icon-button--display-flex":n[9],"smui-icon-button--size-button":n[10]==="button","smui-icon-button--size-mini":n[10]==="mini","mdc-icon-button--reduced-size":n[10]==="mini"||n[10]==="button","mdc-card__action":n[24]==="card:action","mdc-card__action--icon":n[24]==="card:action","mdc-top-app-bar__navigation-icon":n[24]==="top-app-bar:navigation","mdc-top-app-bar__action-item":n[24]==="top-app-bar:action","mdc-snackbar__dismiss":n[24]==="snackbar:actions","mdc-data-table__pagination-button":n[24]==="data-table:pagination","mdc-data-table__sort-icon-button":n[24]==="data-table:sortable-header-cell","mdc-dialog__close":(n[24]==="dialog:header"||n[24]==="dialog:sheet")&&n[12]==="close",...n[18]})},{style:Object.entries(n[19]).map(UC).concat([n[3]]).join(" ")},{"aria-pressed":n[23](n[0])?null:n[0]?"true":"false"},{"aria-label":n[0]?n[6]:n[7]},{"data-aria-label-on":n[6]},{"data-aria-label-off":n[7]},{"aria-describedby":n[25]},{href:n[11]},n[21],n[20],n[29]];var a=n[13];function l(s){let d={$$slots:{default:[XD]},$$scope:{ctx:s}};for(let g=0;g<r.length;g+=1)d=zt(d,r[g]);return{props:d}}return a&&(e=Xa(a,l(n)),n[34](e),e.$on("click",n[35]),e.$on("click",n[36])),{c(){e&&sn(e.$$.fragment),t=pi()},l(s){e&&dn(e.$$.fragment,s),t=pi()},m(s,d){e&&on(e,s,d),tt(s,t,d),i=!0},p(s,d){const g=d[0]&1073504255?hi(r,[d[0]&16384&&{tag:s[14]},d[0]&1010827314&&{use:[[jc,{ripple:s[4],unbounded:!0,color:s[5],disabled:!!s[29].disabled,addClass:s[26],removeClass:s[27],addStyle:s[28]}],s[22],...s[1]]},d[0]&25433861&&{class:In({[s[2]]:!0,"mdc-icon-button":!0,"mdc-icon-button--on":!s[23](s[0])&&s[0],"mdc-icon-button--touch":s[8],"mdc-icon-button--display-flex":s[9],"smui-icon-button--size-button":s[10]==="button","smui-icon-button--size-mini":s[10]==="mini","mdc-icon-button--reduced-size":s[10]==="mini"||s[10]==="button","mdc-card__action":s[24]==="card:action","mdc-card__action--icon":s[24]==="card:action","mdc-top-app-bar__navigation-icon":s[24]==="top-app-bar:navigation","mdc-top-app-bar__action-item":s[24]==="top-app-bar:action","mdc-snackbar__dismiss":s[24]==="snackbar:actions","mdc-data-table__pagination-button":s[24]==="data-table:pagination","mdc-data-table__sort-icon-button":s[24]==="data-table:sortable-header-cell","mdc-dialog__close":(s[24]==="dialog:header"||s[24]==="dialog:sheet")&&s[12]==="close",...s[18]})},d[0]&524296&&{style:Object.entries(s[19]).map(UC).concat([s[3]]).join(" ")},d[0]&8388609&&{"aria-pressed":s[23](s[0])?null:s[0]?"true":"false"},d[0]&193&&{"aria-label":s[0]?s[6]:s[7]},d[0]&64&&{"data-aria-label-on":s[6]},d[0]&128&&{"data-aria-label-off":s[7]},d[0]&33554432&&{"aria-describedby":s[25]},d[0]&2048&&{href:s[11]},d[0]&2097152&&Mr(s[21]),d[0]&1048576&&Mr(s[20]),d[0]&536870912&&Mr(s[29])]):{};if(d[0]&256|d[1]&64&&(g.$$scope={dirty:d,ctx:s}),d[0]&8192&&a!==(a=s[13])){if(e){Wi();const x=e;Ne(x.$$.fragment,1,0,()=>{an(x,1)}),Xi()}a?(e=Xa(a,l(s)),s[34](e),e.$on("click",s[35]),e.$on("click",s[36]),sn(e.$$.fragment),Te(e.$$.fragment,1),on(e,t.parentNode,t)):e=null}else a&&e.$set(g)},i(s){i||(e&&Te(e.$$.fragment,s),i=!0)},o(s){e&&Ne(e.$$.fragment,s),i=!1},d(s){n[34](null),s&&de(t),e&&an(e,s)}}}const UC=([n,e])=>`${n}: ${e};`;function YD(n,e,t){let i;const r=["use","class","style","ripple","color","toggle","pressed","ariaLabelOn","ariaLabelOff","touch","displayFlex","size","href","action","component","tag","getElement"];let a=vi(e,r),{$$slots:l={},$$scope:s}=e;const d=ps(ds());let g=()=>{};function x(Bt){return Bt===g}let{use:I=[]}=e,{class:A=""}=e,{style:L=""}=e,{ripple:N=!0}=e,{color:B=void 0}=e,{toggle:F=!1}=e,{pressed:z=g}=e,{ariaLabelOn:V=void 0}=e,{ariaLabelOff:Y=void 0}=e,{touch:Q=!1}=e,{displayFlex:J=!0}=e,{size:he="normal"}=e,{href:ee=void 0}=e,{action:ae=void 0}=e,De,fe,le={},Be={},Pe={},Ce=Fr("SMUI:icon-button:context"),it=Fr("SMUI:icon-button:aria-describedby"),{component:Et=Cu}=e,{tag:Ue=Et===Cu?ee==null?"button":"a":void 0}=e,at=a.disabled;lr("SMUI:icon:context","icon-button");let ke=null;Dh(()=>{fe&&fe.destroy()});function Dt(Bt){return Bt in le?le[Bt]:En().classList.contains(Bt)}function fn(Bt){le[Bt]||t(18,le[Bt]=!0,le)}function Cn(Bt){(!(Bt in le)||le[Bt])&&t(18,le[Bt]=!1,le)}function Gt(Bt,Zn){Be[Bt]!=Zn&&(Zn===""||Zn==null?(delete Be[Bt],t(19,Be)):t(19,Be[Bt]=Zn,Be))}function Mt(Bt){var Zn;return Bt in Pe?(Zn=Pe[Bt])!==null&&Zn!==void 0?Zn:null:En().getAttribute(Bt)}function vt(Bt,Zn){Pe[Bt]!==Zn&&t(20,Pe[Bt]=Zn,Pe)}function xn(Bt){t(0,z=Bt.isOn)}function En(){return De.getElement()}function _t(Bt){Sn[Bt?"unshift":"push"](()=>{De=Bt,t(16,De)})}const kt=()=>fe&&fe.handleClick(),Ct=()=>Ce==="top-app-bar:navigation"&&ji(En(),"SMUITopAppBarIconButton:nav");return n.$$set=Bt=>{e=zt(zt({},e),ls(Bt)),t(29,a=vi(e,r)),"use"in Bt&&t(1,I=Bt.use),"class"in Bt&&t(2,A=Bt.class),"style"in Bt&&t(3,L=Bt.style),"ripple"in Bt&&t(4,N=Bt.ripple),"color"in Bt&&t(5,B=Bt.color),"toggle"in Bt&&t(30,F=Bt.toggle),"pressed"in Bt&&t(0,z=Bt.pressed),"ariaLabelOn"in Bt&&t(6,V=Bt.ariaLabelOn),"ariaLabelOff"in Bt&&t(7,Y=Bt.ariaLabelOff),"touch"in Bt&&t(8,Q=Bt.touch),"displayFlex"in Bt&&t(9,J=Bt.displayFlex),"size"in Bt&&t(10,he=Bt.size),"href"in Bt&&t(11,ee=Bt.href),"action"in Bt&&t(12,ae=Bt.action),"component"in Bt&&t(13,Et=Bt.component),"tag"in Bt&&t(14,Ue=Bt.tag),"$$scope"in Bt&&t(37,s=Bt.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&4096&&t(21,i=(()=>{if(Ce==="data-table:pagination")switch(ae){case"first-page":return{"data-first-page":"true"};case"prev-page":return{"data-prev-page":"true"};case"next-page":return{"data-next-page":"true"};case"last-page":return{"data-last-page":"true"};default:return{"data-action":"true"}}else return Ce==="dialog:header"||Ce==="dialog:sheet"?{"data-mdc-dialog-action":ae}:{action:ae}})()),at!==a.disabled){const Bt=En();"blur"in Bt&&Bt.blur(),t(31,at=a.disabled)}n.$$.dirty[0]&1073938432|n.$$.dirty[1]&2&&De&&En()&&F!==ke&&(F&&!fe?(t(17,fe=new WD({addClass:fn,hasClass:Dt,notifyChange:Bt=>{xn(Bt),ji(En(),"SMUIIconButtonToggle:change",Bt,void 0,!0)},removeClass:Cn,getAttr:Mt,setAttr:vt})),fe.init()):!F&&fe&&(fe.destroy(),t(17,fe=void 0),t(18,le={}),t(20,Pe={})),t(32,ke=F)),n.$$.dirty[0]&131073&&fe&&!x(z)&&fe.isOn()!==z&&fe.toggle(z)},[z,I,A,L,N,B,V,Y,Q,J,he,ee,ae,Et,Ue,En,De,fe,le,Be,Pe,i,d,x,Ce,it,fn,Cn,Gt,a,F,at,ke,l,_t,kt,Ct,s]}class xf extends sr{constructor(e){super(),or(this,e,YD,ZD,Qi,{use:1,class:2,style:3,ripple:4,color:5,toggle:30,pressed:0,ariaLabelOn:6,ariaLabelOff:7,touch:8,displayFlex:9,size:10,href:11,action:12,component:13,tag:14,getElement:15},null,[-1,-1])}get getElement(){return this.$$.ctx[15]}}function yL(n){const e=n-1;return e*e*e+1}function KD(n){return--n*n*n*n*n+1}function JD(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}function QD(n){var{fallback:e}=n,t=JD(n,["fallback"]);const i=new Map,r=new Map;function a(s,d,g){const{delay:x=0,duration:I=ee=>Math.sqrt(ee)*30,easing:A=yL}=zt(zt({},t),g),L=s.getBoundingClientRect(),N=d.getBoundingClientRect(),B=L.left-N.left,F=L.top-N.top,z=L.width/N.width,V=L.height/N.height,Y=Math.sqrt(B*B+F*F),Q=getComputedStyle(d),J=Q.transform==="none"?"":Q.transform,he=+Q.opacity;return{delay:x,duration:Gi(I)?I(Y):I,easing:A,css:(ee,ae)=>`
				opacity: ${ee*he};
				transform-origin: top left;
				transform: ${J} translate(${ae*B}px,${ae*F}px) scale(${ee+(1-ee)*z}, ${ee+(1-ee)*V});
			`}}function l(s,d,g){return(x,I)=>(s.set(I.key,x),()=>{if(d.has(I.key)){const A=d.get(I.key);return d.delete(I.key),a(A,x,I)}return s.delete(I.key),e&&e(x,I,g)})}return[l(r,i,!1),l(i,r,!0)]}function $D(n,{from:e,to:t},i={}){const r=getComputedStyle(n),a=r.transform==="none"?"":r.transform,[l,s]=r.transformOrigin.split(" ").map(parseFloat),d=e.left+e.width*l/t.width-(t.left+l),g=e.top+e.height*s/t.height-(t.top+s),{delay:x=0,duration:I=L=>Math.sqrt(L)*120,easing:A=yL}=i;return{delay:x,duration:Gi(I)?I(Math.sqrt(d*d+g*g)):I,easing:A,css:(L,N)=>{const B=N*d,F=N*g,z=L+N*e.width/t.width,V=L+N*e.height/t.height;return`transform: ${a} translate(${B}px, ${F}px) scale(${z}, ${V});`}}}function VC(n,e,t){const i=n.slice();return i[15]=e[t],i[17]=t,i}const eO=n=>({item:n&1,index:n&1}),GC=n=>({item:n[15],index:n[17]});function HC(n){let e,t=[],i=new Map,r,a=n[0];const l=s=>s[8](s[15]);for(let s=0;s<a.length;s+=1){let d=VC(n,a,s),g=l(d);i.set(g,t[s]=jC(g,d))}return{c(){e=qt("ul");for(let s=0;s<t.length;s+=1)t[s].c();this.h()},l(s){e=Wt(s,"UL",{class:!0});var d=Qt(e);for(let g=0;g<t.length;g+=1)t[g].l(d);d.forEach(de),this.h()},h(){tn(e,"class","svelte-1xt2noz")},m(s,d){tt(s,e,d);for(let g=0;g<t.length;g+=1)t[g]&&t[g].m(e,null);r=!0},p(s,d){if(d&1523){a=s[0],Wi();for(let g=0;g<t.length;g+=1)t[g].r();t=lL(t,d,l,1,s,a,i,e,NP,jC,null,VC);for(let g=0;g<t.length;g+=1)t[g].a();Xi()}},i(s){if(!r){for(let d=0;d<a.length;d+=1)Te(t[d]);r=!0}},o(s){for(let d=0;d<t.length;d+=1)Ne(t[d]);r=!1},d(s){s&&de(e);for(let d=0;d<t.length;d+=1)t[d].d()}}}function tO(n){let e,t=n[8](n[15])+"",i;return{c(){e=qt("p"),i=_i(t)},l(r){e=Wt(r,"P",{});var a=Qt(e);i=yi(a,t),a.forEach(de)},m(r,a){tt(r,e,a),Kt(e,i)},p(r,a){a&1&&t!==(t=r[8](r[15])+"")&&ys(i,t)},d(r){r&&de(e)}}}function jC(n,e){let t,i,r,a,l,s,d,g=_l,x,I,A;const L=e[11].default,N=Ri(L,e,e[10],GC),B=N||tO(e);return{key:n,first:null,c(){t=qt("li"),B&&B.c(),i=vn(),this.h()},l(F){t=Wt(F,"LI",{"data-index":!0,"data-id":!0,draggable:!0,class:!0});var z=Qt(t);B&&B.l(z),i=bn(z),z.forEach(de),this.h()},h(){tn(t,"data-index",r=e[17]),tn(t,"data-id",a=JSON.stringify(e[8](e[15]))),tn(t,"draggable","true"),tn(t,"class","svelte-1xt2noz"),Lv(t,"over",e[8](e[15])===e[1]),this.first=t},m(F,z){tt(F,t,z),B&&B.m(t,null),Kt(t,i),x=!0,I||(A=[qn(t,"dragstart",e[4]),qn(t,"dragover",e[5]),qn(t,"dragleave",e[6]),qn(t,"drop",e[7])],I=!0)},p(F,z){e=F,N?N.p&&(!x||z&1025)&&Pi(N,L,e,e[10],x?Oi(L,e[10],z,eO):Di(e[10]),GC):B&&B.p&&(!x||z&1)&&B.p(e,x?z:-1),(!x||z&1&&r!==(r=e[17]))&&tn(t,"data-index",r),(!x||z&1&&a!==(a=JSON.stringify(e[8](e[15]))))&&tn(t,"data-id",a),(!x||z&259)&&Lv(t,"over",e[8](e[15])===e[1])},r(){d=t.getBoundingClientRect()},f(){MP(t),g(),LP(t,d)},a(){g(),g=RP(t,d,$D,{duration:300})},i(F){x||(Te(B,F),PP(()=>{x&&(s&&s.end(1),l=DP(t,e[3],{key:e[8](e[15])}),l.start())}),x=!0)},o(F){Ne(B,F),l&&l.invalidate(),s=OP(t,e[2],{key:e[8](e[15])}),x=!1},d(F){F&&de(t),B&&B.d(F),F&&s&&s.end(),I=!1,Ss(A)}}}function nO(n){let e,t,i=n[0]&&n[0].length&&HC(n);return{c(){i&&i.c(),e=pi()},l(r){i&&i.l(r),e=pi()},m(r,a){i&&i.m(r,a),tt(r,e,a),t=!0},p(r,[a]){r[0]&&r[0].length?i?(i.p(r,a),a&1&&Te(i,1)):(i=HC(r),i.c(),Te(i,1),i.m(e.parentNode,e)):i&&(Wi(),Ne(i,1,1,()=>{i=null}),Xi())},i(r){t||(Te(i),t=!0)},o(r){Ne(i),t=!1},d(r){i&&i.d(r),r&&de(e)}}}function iO(n,e,t){let{$$slots:i={},$$scope:r}=e;const[a,l]=QD({duration:V=>Math.sqrt(V*200),fallback(V,Y){const Q=getComputedStyle(V),J=Q.transform==="none"?"":Q.transform;return{duration:600,easing:KD,css:he=>`
					transform: ${J} scale(${he});
					opacity: ${he}
				`}}});let s=!1;const d=V=>V.dataset.index&&V.dataset||d(V.parentNode),g=V=>{V.dataTransfer.setData("source",V.target.dataset.index)},x=V=>{V.preventDefault();let Y=d(V.target);s!==Y.id&&t(1,s=JSON.parse(Y.id))},I=V=>{let Y=d(V.target);s===Y.id&&t(1,s=!1)},A=V=>{t(1,s=!1),V.preventDefault();let Y=d(V.target),Q=V.dataTransfer.getData("source"),J=Y.index;N({from:Q,to:J})},L=i0(),N=({from:V,to:Y})=>{let Q=[...F];const J=Q.splice(V,1)[0];Q.splice(Y,0,J),L("sort",{newList:Q,from:V,to:Y})},B=V=>z?V[z]:V;let{list:F}=e,{key:z}=e;return n.$$set=V=>{"list"in V&&t(0,F=V.list),"key"in V&&t(9,z=V.key),"$$scope"in V&&t(10,r=V.$$scope)},[F,s,a,l,g,x,I,A,B,z,r,i]}class rO extends sr{constructor(e){super(),or(this,e,iO,nO,Qi,{list:0,key:9})}}function sO(n){let e=n[5][n[3]].muiIcon+"",t;return{c(){t=_i(e)},l(i){t=yi(i,e)},m(i,r){tt(i,t,r)},p(i,r){r&8&&e!==(e=i[5][i[3]].muiIcon+"")&&ys(t,e)},d(i){i&&de(t)}}}function oO(n){let e,t,i;return t=new xf({props:{class:"material-icons",$$slots:{default:[sO]},$$scope:{ctx:n}}}),t.$on("click",function(){Gi(n[5][n[3]].onClick)&&n[5][n[3]].onClick.apply(this,arguments)}),{c(){e=qt("span"),sn(t.$$.fragment),this.h()},l(r){e=Wt(r,"SPAN",{class:!0});var a=Qt(e);dn(t.$$.fragment,a),a.forEach(de),this.h()},h(){tn(e,"class","visibility-btn svelte-1qhw7hj")},m(r,a){tt(r,e,a),on(t,e,null),i=!0},p(r,a){n=r;const l={};a&8200&&(l.$$scope={dirty:a,ctx:n}),t.$set(l)},i(r){i||(Te(t.$$.fragment,r),i=!0)},o(r){Ne(t.$$.fragment,r),i=!1},d(r){r&&de(e),an(t)}}}function aO(n){let e=n[5][n[2]].muiIcon+"",t;return{c(){t=_i(e)},l(i){t=yi(i,e)},m(i,r){tt(i,t,r)},p(i,r){r&4&&e!==(e=i[5][i[2]].muiIcon+"")&&ys(t,e)},d(i){i&&de(t)}}}function qC(n){let e,t;return e=new ab({props:{$$slots:{default:[lO]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,r){on(e,i,r),t=!0},p(i,r){const a={};r&8196&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Te(e.$$.fragment,i),t=!0)},o(i){Ne(e.$$.fragment,i),t=!1},d(i){an(e,i)}}}function lO(n){let e=n[5][n[2]].tooltip+"",t;return{c(){t=_i(e)},l(i){t=yi(i,e)},m(i,r){tt(i,t,r)},p(i,r){r&4&&e!==(e=i[5][i[2]].tooltip+"")&&ys(t,e)},d(i){i&&de(t)}}}function uO(n){let e,t,i,r,a;t=new xf({props:{class:"material-icons",$$slots:{default:[aO]},$$scope:{ctx:n}}}),t.$on("click",function(){Gi(n[5][n[2]].onClick)&&n[5][n[2]].onClick.apply(this,arguments)});let l=n[5][n[2]].tooltip&&qC(n);return{c(){e=qt("span"),sn(t.$$.fragment),i=vn(),l&&l.c(),r=pi(),this.h()},l(s){e=Wt(s,"SPAN",{class:!0});var d=Qt(e);dn(t.$$.fragment,d),d.forEach(de),i=bn(s),l&&l.l(s),r=pi(),this.h()},h(){tn(e,"class","action-btn")},m(s,d){tt(s,e,d),on(t,e,null),tt(s,i,d),l&&l.m(s,d),tt(s,r,d),a=!0},p(s,d){n=s;const g={};d&8196&&(g.$$scope={dirty:d,ctx:n}),t.$set(g),n[5][n[2]].tooltip?l?(l.p(n,d),d&4&&Te(l,1)):(l=qC(n),l.c(),Te(l,1),l.m(r.parentNode,r)):l&&(Wi(),Ne(l,1,1,()=>{l=null}),Xi())},i(s){a||(Te(t.$$.fragment,s),Te(l),a=!0)},o(s){Ne(t.$$.fragment,s),Ne(l),a=!1},d(s){s&&de(e),an(t),s&&de(i),l&&l.d(s),s&&de(r)}}}function cO(n){let e,t,i,r,a,l,s,d=n[0].displayName+"",g,x,I,A,L,N,B,F;return I=new Rv({props:{$$slots:{default:[oO]},$$scope:{ctx:n}}}),L=new Rv({props:{$$slots:{default:[uO]},$$scope:{ctx:n}}}),{c(){e=qt("div"),t=qt("button"),i=qt("img"),l=vn(),s=qt("p"),g=_i(d),x=vn(),sn(I.$$.fragment),A=vn(),sn(L.$$.fragment),this.h()},l(z){e=Wt(z,"DIV",{class:!0});var V=Qt(e);t=Wt(V,"BUTTON",{class:!0});var Y=Qt(t);i=Wt(Y,"IMG",{class:!0,src:!0,alt:!0}),l=bn(Y),s=Wt(Y,"P",{class:!0});var Q=Qt(s);g=yi(Q,d),Q.forEach(de),Y.forEach(de),x=bn(V),dn(I.$$.fragment,V),A=bn(V),dn(L.$$.fragment,V),V.forEach(de),this.h()},h(){tn(i,"class","icon svelte-1qhw7hj"),DE(i.src,r=WC(n[0]))||tn(i,"src",r),tn(i,"alt",a=n[0].type),tn(s,"class","description"),tn(t,"class","btn svelte-1qhw7hj"),tn(e,"class","item svelte-1qhw7hj"),Lv(e,"checked",n[1])},m(z,V){tt(z,e,V),Kt(e,t),Kt(t,i),Kt(t,l),Kt(t,s),Kt(s,g),Kt(e,x),on(I,e,null),Kt(e,A),on(L,e,null),N=!0,B||(F=qn(t,"click",n[4]),B=!0)},p(z,[V]){(!N||V&1&&!DE(i.src,r=WC(z[0])))&&tn(i,"src",r),(!N||V&1&&a!==(a=z[0].type))&&tn(i,"alt",a),(!N||V&1)&&d!==(d=z[0].displayName+"")&&ys(g,d);const Y={};V&8200&&(Y.$$scope={dirty:V,ctx:z}),I.$set(Y);const Q={};V&8196&&(Q.$$scope={dirty:V,ctx:z}),L.$set(Q),(!N||V&2)&&Lv(e,"checked",z[1])},i(z){N||(Te(I.$$.fragment,z),Te(L.$$.fragment,z),N=!0)},o(z){Ne(I.$$.fragment,z),Ne(L.$$.fragment,z),N=!1},d(z){z&&de(e),an(I),an(L),B=!1,F()}}}function WC(n){switch(n.type){case"circle":return"button-icons/point.png";case"line":return"button-icons/line.png";case"fill":case"fill-extrusion":return"button-icons/polygon.png";default:return"button-icons/polygon.png"}}function hO(n,e,t){let i,{map:r}=e,{layer:a}=e,{selectedTool:l}=e,{selectModeEnabled:s}=e,{selectedLayers:d}=e,g,x;const I=i0(),A=()=>I("toggled",a),L=()=>I("singleSelect",a),N={acceptEdit:{tooltip:"Accept layer edit",onClick:()=>console.log("yayaya"),muiIcon:"check"},cancelEdit:{tooltip:"Cancel edit",onClick:()=>null,muiIcon:"do_disturb"},isInvisible:{tooltip:"Show",onClick:()=>{Lo.toggleVisibility(a.id)},muiIcon:"visibility_off"},isVisible:{tooltip:"Hide",onClick:()=>{Lo.toggleVisibility(a.id)},muiIcon:"visibility"},remove:{onClick:()=>{r.removeLayer(a.id),r.removeSource(a.id),Lo.deleteLayer(a.id)},muiIcon:"delete_outline"},checked:{onClick:()=>{A(),t(1,i=!1)},muiIcon:"check_box"},notChecked:{onClick:()=>{A(),t(1,i=!0)},muiIcon:"check_box_outline_blank"}};return n.$$set=B=>{"map"in B&&t(6,r=B.map),"layer"in B&&t(0,a=B.layer),"selectedTool"in B&&t(7,l=B.selectedTool),"selectModeEnabled"in B&&t(8,s=B.selectModeEnabled),"selectedLayers"in B&&t(9,d=B.selectedLayers)},n.$$.update=()=>{n.$$.dirty&513&&t(1,i=d.includes(a)),n.$$.dirty&386&&t(2,g=!l&&!s?"remove":i?"checked":"notChecked"),n.$$.dirty&1&&t(3,x=a.isVisible?"isVisible":"isInvisible")},[a,i,g,x,L,N,r,l,s,d]}class fO extends sr{constructor(e){super(),or(this,e,hO,cO,Qi,{map:6,layer:0,selectedTool:7,selectModeEnabled:8,selectedLayers:9})}}function dO(){return this._array=null,Promise.resolve()}function pO(){var n=this._array;return this._array=null,Promise.resolve(n?{done:!1,value:n}:{done:!0,value:void 0})}function B1(n){return new LS(n instanceof Uint8Array?n:new Uint8Array(n))}function LS(n){this._array=n}LS.prototype.read=pO;LS.prototype.cancel=dO;function mO(n){return fetch(n).then(function(e){return e.body&&e.body.getReader?e.body.getReader():e.arrayBuffer().then(B1)})}function gO(n){return new Promise(function(e,t){var i=new XMLHttpRequest;i.responseType="arraybuffer",i.onload=function(){e(B1(i.response))},i.onerror=t,i.ontimeout=t,i.open("GET",n,!0),i.send()})}function SE(n){return(typeof fetch=="function"?mO:gO)(n)}function Yw(n){return typeof n.read=="function"?n:n.getReader()}const RS=new Uint8Array(0);function _O(){return this._source.cancel()}function yO(n,e){if(!n.length)return e;if(!e.length)return n;var t=new Uint8Array(n.length+e.length);return t.set(n),t.set(e,n.length),t}function vO(){var n=this,e=n._array.subarray(n._index);return n._source.read().then(function(t){return n._array=RS,n._index=0,t.done?e.length>0?{done:!1,value:e}:{done:!0,value:void 0}:{done:!1,value:yO(e,t.value)}})}function bO(n){if((n|=0)<0)throw new Error("invalid length");var e=this,t=this._array.length-this._index;if(this._index+n<=this._array.length)return Promise.resolve(this._array.subarray(this._index,this._index+=n));var i=new Uint8Array(n);return i.set(this._array.subarray(this._index)),function r(){return e._source.read().then(function(a){return a.done?(e._array=RS,e._index=0,t>0?i.subarray(0,t):null):t+a.value.length>=n?(e._array=a.value,e._index=n-t,i.set(a.value.subarray(0,n-t),t),i):(i.set(a.value,t),t+=a.value.length,r())})}()}function vL(n){return typeof n.slice=="function"?n:new hI(typeof n.read=="function"?n:n.getReader())}function hI(n){this._source=n,this._array=RS,this._index=0}hI.prototype.read=vO;hI.prototype.slice=bO;hI.prototype.cancel=_O;function xO(){return this._source.cancel()}function EO(n){return/^[nf]$/i.test(n)?!1:/^[yt]$/i.test(n)?!0:null}function IO(n){return new Date(+n.substring(0,4),n.substring(4,6)-1,+n.substring(6,8))}function fE(n){return!(n=n.trim())||isNaN(n=+n)?null:n}function TO(n){return n.trim()||null}var wO={B:fE,C:TO,D:IO,F:fE,L:EO,M:fE,N:fE};function SO(){var n=this,e=1;return n._source.slice(n._recordLength).then(function(t){return t&&t[0]!==26?{done:!1,value:n._fields.reduce(function(i,r){return i[r.name]=wO[r.type](n._decode(t.subarray(e,e+=r.length))),i},{})}:{done:!0,value:void 0}})}function Ev(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function bL(n,e){return n=vL(n),n.slice(32).then(function(t){var i=Ev(t);return n.slice(i.getUint16(8,!0)-32).then(function(r){return new xL(n,e,i,Ev(r))})})}function xL(n,e,t,i){this._source=n,this._decode=e.decode.bind(e),this._recordLength=t.getUint16(10,!0),this._fields=[];for(var r=0;i.getUint8(r)!==13;r+=32){for(var a=0;a<11&&i.getUint8(r+a)!==0;++a);this._fields.push({name:this._decode(new Uint8Array(i.buffer,i.byteOffset+r,a)),type:String.fromCharCode(i.getUint8(r+11)),length:i.getUint8(r+16)})}}var EL=xL.prototype;EL.read=SO;EL.cancel=xO;function CO(){return this._source.cancel()}function Sw(n){var e=40,t,i=n.getInt32(36,!0),r=new Array(i);for(t=0;t<i;++t,e+=16)r[t]=[n.getFloat64(e,!0),n.getFloat64(e+8,!0)];return{type:"MultiPoint",coordinates:r}}function AO(){return null}function Cw(n){return{type:"Point",coordinates:[n.getFloat64(4,!0),n.getFloat64(12,!0)]}}function Aw(n){var e=44,t,i=n.getInt32(36,!0),r=n.getInt32(40,!0),a=new Array(i),l=new Array(r),s=[],d=[];for(t=0;t<i;++t,e+=4)a[t]=n.getInt32(e,!0);for(t=0;t<r;++t,e+=16)l[t]=[n.getFloat64(e,!0),n.getFloat64(e+8,!0)];return a.forEach(function(g,x){var I=l.slice(g,a[x+1]);MO(I)?s.push([I]):d.push(I)}),d.forEach(function(g){s.some(function(x){if(LO(x[0],g))return x.push(g),!0})||s.push([g])}),s.length===1?{type:"Polygon",coordinates:s[0]}:{type:"MultiPolygon",coordinates:s}}function MO(n){if((t=n.length)<4)return!1;for(var e=0,t,i=n[t-1][1]*n[0][0]-n[t-1][0]*n[0][1];++e<t;)i+=n[e-1][1]*n[e][0]-n[e-1][0]*n[e][1];return i>=0}function LO(n,e){for(var t=-1,i=e.length,r;++t<i;)if(r=RO(n,e[t]))return r>0;return!1}function RO(n,e){for(var t=e[0],i=e[1],r=-1,a=0,l=n.length,s=l-1;a<l;s=a++){var d=n[a],g=d[0],x=d[1],I=n[s],A=I[0],L=I[1];if(PO(d,I,e))return 0;x>i!=L>i&&t<(A-g)*(i-x)/(L-x)+g&&(r=-r)}return r}function PO(n,e,t){var i=t[0]-n[0],r=t[1]-n[1];if(i===0&&r===0)return!0;var a=e[0]-n[0],l=e[1]-n[1];if(a===0&&l===0)return!1;var s=(i*a+r*l)/(a*a+l*l);return s<0||s>1?!1:s===0||s===1?!0:s*a===i&&s*l===r}function Mw(n){var e=44,t,i=n.getInt32(36,!0),r=n.getInt32(40,!0),a=new Array(i),l=new Array(r);for(t=0;t<i;++t,e+=4)a[t]=n.getInt32(e,!0);for(t=0;t<r;++t,e+=16)l[t]=[n.getFloat64(e,!0),n.getFloat64(e+8,!0)];return i===1?{type:"LineString",coordinates:l}:{type:"MultiLineString",coordinates:a.map(function(s,d){return l.slice(s,a[d+1])})}}function XC(n,e){var t=new Uint8Array(n.length+e.length);return t.set(n,0),t.set(e,n.length),t}function DO(){var n=this;return++n._index,n._source.slice(12).then(function(e){if(e==null)return{done:!0,value:void 0};var t=Ev(e);function i(){return n._source.slice(4).then(function(a){return a==null?{done:!0,value:void 0}:(t=Ev(e=XC(e.slice(4),a)),t.getInt32(0,!1)!==n._index?i():r())})}function r(){var a=t.getInt32(4,!1)*2-4,l=t.getInt32(8,!0);return a<0||l&&l!==n._type?i():n._source.slice(a).then(function(s){return{done:!1,value:l?n._parse(Ev(XC(e.slice(8),s))):null}})}return r()})}var ZC={0:AO,1:Cw,3:Mw,5:Aw,8:Sw,11:Cw,13:Mw,15:Aw,18:Sw,21:Cw,23:Mw,25:Aw,28:Sw};function OO(n){return n=vL(n),n.slice(100).then(function(e){return new IL(n,Ev(e))})}function IL(n,e){var t=e.getInt32(32,!0);if(!(t in ZC))throw new Error("unsupported shape type: "+t);this._source=n,this._type=t,this._index=0,this._parse=ZC[t],this.bbox=[e.getFloat64(36,!0),e.getFloat64(44,!0),e.getFloat64(52,!0),e.getFloat64(60,!0)]}var TL=IL.prototype;TL.read=DO;TL.cancel=CO;function NO(){}function kO(){return Promise.all([this._dbf&&this._dbf.cancel(),this._shp.cancel()]).then(NO)}function FO(){var n=this;return Promise.all([n._dbf?n._dbf.read():{value:{}},n._shp.read()]).then(function(e){var t=e[0],i=e[1];return i.done?i:{done:!1,value:{type:"Feature",properties:t.value,geometry:i.value}}})}function BO(n,e,t){return Promise.all([OO(n),e&&bL(e,t)]).then(function(i){return new wL(i[0],i[1])})}function wL(n,e){this._shp=n,this._dbf=e,this.bbox=n.bbox}var SL=wL.prototype;SL.read=FO;SL.cancel=kO;function zO(n,e,t){return typeof e=="string"?(/\.dbf$/.test(e)||(e+=".dbf"),e=SE(e)):e instanceof ArrayBuffer||e instanceof Uint8Array?e=B1(e):e!=null&&(e=Yw(e)),typeof n=="string"?(/\.shp$/.test(n)||(n+=".shp"),e===void 0&&(e=SE(n.substring(0,n.length-4)+".dbf").catch(function(){})),n=SE(n)):n instanceof ArrayBuffer||n instanceof Uint8Array?n=B1(n):n=Yw(n),Promise.all([n,e]).then(function(i){var r=i[0],a=i[1],l="windows-1252";return t&&t.encoding!=null&&(l=t.encoding),BO(r,a,a&&new TextDecoder(l))})}function UO(n,e){var t="windows-1252";return e&&e.encoding!=null&&(t=e.encoding),t=new TextDecoder(t),typeof n=="string"?(/\.dbf$/.test(n)||(n+=".dbf"),n=SE(n)):n instanceof ArrayBuffer||n instanceof Uint8Array?n=B1(n):n=Yw(n),Promise.resolve(n).then(function(i){return bL(i,t)})}function VO(n,e,t){return zO(n,e,t).then(function(i){var r=[],a={type:"FeatureCollection",features:r,bbox:i.bbox};return i.read().then(function l(s){return s.done?a:(r.push(s.value),i.read().then(l))})})}function GO(n){n("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),n("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),n("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),n.WGS84=n["EPSG:4326"],n["EPSG:3785"]=n["EPSG:3857"],n.GOOGLE=n["EPSG:3857"],n["EPSG:900913"]=n["EPSG:3857"],n["EPSG:102113"]=n["EPSG:3857"]}var S_=1,C_=2,Iv=3,HO=4,Kw=5,YC=6378137,jO=6356752314e-3,KC=.0066943799901413165,N1=484813681109536e-20,Bn=Math.PI/2,qO=.16666666666666666,WO=.04722222222222222,XO=.022156084656084655,fi=1e-10,eu=.017453292519943295,lp=57.29577951308232,Vs=Math.PI/4,z1=Math.PI*2,Ta=3.14159265359,Yc={};Yc.greenwich=0;Yc.lisbon=-9.131906111111;Yc.paris=2.337229166667;Yc.bogota=-74.080916666667;Yc.madrid=-3.687938888889;Yc.rome=12.452333333333;Yc.bern=7.439583333333;Yc.jakarta=106.807719444444;Yc.ferro=-17.666666666667;Yc.brussels=4.367975;Yc.stockholm=18.058277777778;Yc.athens=23.7163375;Yc.oslo=10.722916666667;const ZO={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}};var JC=/[\s_\-\/\(\)]/g;function ag(n,e){if(n[e])return n[e];for(var t=Object.keys(n),i=e.toLowerCase().replace(JC,""),r=-1,a,l;++r<t.length;)if(a=t[r],l=a.toLowerCase().replace(JC,""),l===i)return n[a]}function Jw(n){var e={},t=n.split("+").map(function(s){return s.trim()}).filter(function(s){return s}).reduce(function(s,d){var g=d.split("=");return g.push(!0),s[g[0].toLowerCase()]=g[1],s},{}),i,r,a,l={proj:"projName",datum:"datumCode",rf:function(s){e.rf=parseFloat(s)},lat_0:function(s){e.lat0=s*eu},lat_1:function(s){e.lat1=s*eu},lat_2:function(s){e.lat2=s*eu},lat_ts:function(s){e.lat_ts=s*eu},lon_0:function(s){e.long0=s*eu},lon_1:function(s){e.long1=s*eu},lon_2:function(s){e.long2=s*eu},alpha:function(s){e.alpha=parseFloat(s)*eu},gamma:function(s){e.rectified_grid_angle=parseFloat(s)},lonc:function(s){e.longc=s*eu},x_0:function(s){e.x0=parseFloat(s)},y_0:function(s){e.y0=parseFloat(s)},k_0:function(s){e.k0=parseFloat(s)},k:function(s){e.k0=parseFloat(s)},a:function(s){e.a=parseFloat(s)},b:function(s){e.b=parseFloat(s)},r_a:function(){e.R_A=!0},zone:function(s){e.zone=parseInt(s,10)},south:function(){e.utmSouth=!0},towgs84:function(s){e.datum_params=s.split(",").map(function(d){return parseFloat(d)})},to_meter:function(s){e.to_meter=parseFloat(s)},units:function(s){e.units=s;var d=ag(ZO,s);d&&(e.to_meter=d.to_meter)},from_greenwich:function(s){e.from_greenwich=s*eu},pm:function(s){var d=ag(Yc,s);e.from_greenwich=(d||parseFloat(s))*eu},nadgrids:function(s){s==="@null"?e.datumCode="none":e.nadgrids=s},axis:function(s){var d="ewnsud";s.length===3&&d.indexOf(s.substr(0,1))!==-1&&d.indexOf(s.substr(1,1))!==-1&&d.indexOf(s.substr(2,1))!==-1&&(e.axis=s)},approx:function(){e.approx=!0}};for(i in t)r=t[i],i in l?(a=l[i],typeof a=="function"?a(r):e[a]=r):e[i]=r;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e}var U1=1,CL=2,AL=3,BE=4,ML=5,PS=-1,YO=/\s/,KO=/[A-Za-z]/,JO=/[A-Za-z84_]/,fI=/[,\]]/,LL=/[\d\.E\-\+]/;function bm(n){if(typeof n!="string")throw new Error("not a string");this.text=n.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=U1}bm.prototype.readCharicter=function(){var n=this.text[this.place++];if(this.state!==BE)for(;YO.test(n);){if(this.place>=this.text.length)return;n=this.text[this.place++]}switch(this.state){case U1:return this.neutral(n);case CL:return this.keyword(n);case BE:return this.quoted(n);case ML:return this.afterquote(n);case AL:return this.number(n);case PS:return}};bm.prototype.afterquote=function(n){if(n==='"'){this.word+='"',this.state=BE;return}if(fI.test(n)){this.word=this.word.trim(),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in afterquote yet, index '+this.place)};bm.prototype.afterItem=function(n){if(n===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=U1;return}if(n==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=U1,this.currentObject=this.stack.pop(),this.currentObject||(this.state=PS);return}};bm.prototype.number=function(n){if(LL.test(n)){this.word+=n;return}if(fI.test(n)){this.word=parseFloat(this.word),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in number yet, index '+this.place)};bm.prototype.quoted=function(n){if(n==='"'){this.state=ML;return}this.word+=n};bm.prototype.keyword=function(n){if(JO.test(n)){this.word+=n;return}if(n==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=U1;return}if(fI.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in keyword yet, index '+this.place)};bm.prototype.neutral=function(n){if(KO.test(n)){this.word=n,this.state=CL;return}if(n==='"'){this.word="",this.state=BE;return}if(LL.test(n)){this.word=n,this.state=AL;return}if(fI.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in neutral yet, index '+this.place)};bm.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===PS)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function QO(n){var e=new bm(n);return e.output()}function QC(n,e,t){Array.isArray(e)&&(t.unshift(e),e=null);var i=e?{}:n,r=t.reduce(function(a,l){return fv(l,a),a},i);e&&(n[e]=r)}function fv(n,e){if(!Array.isArray(n)){e[n]=!0;return}var t=n.shift();if(t==="PARAMETER"&&(t=n.shift()),n.length===1){if(Array.isArray(n[0])){e[t]={},fv(n[0],e[t]);return}e[t]=n[0];return}if(!n.length){e[t]=!0;return}if(t==="TOWGS84"){e[t]=n;return}if(t==="AXIS"){t in e||(e[t]=[]),e[t].push(n);return}Array.isArray(t)||(e[t]={});var i;switch(t){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[t]={name:n[0].toLowerCase(),convert:n[1]},n.length===3&&fv(n[2],e[t]);return;case"SPHEROID":case"ELLIPSOID":e[t]={name:n[0],a:n[1],rf:n[2]},n.length===4&&fv(n[3],e[t]);return;case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":n[0]=["name",n[0]],QC(e,t,n);return;default:for(i=-1;++i<n.length;)if(!Array.isArray(n[i]))return fv(n,e[t]);return QC(e,t,n)}}var $O=.017453292519943295;function eN(n,e){var t=e[0],i=e[1];!(t in n)&&i in n&&(n[t]=n[i],e.length===3&&(n[t]=e[2](n[t])))}function tp(n){return n*$O}function tN(n){if(n.type==="GEOGCS"?n.projName="longlat":n.type==="LOCAL_CS"?(n.projName="identity",n.local=!0):typeof n.PROJECTION=="object"?n.projName=Object.keys(n.PROJECTION)[0]:n.projName=n.PROJECTION,n.AXIS){for(var e="",t=0,i=n.AXIS.length;t<i;++t){var r=[n.AXIS[t][0].toLowerCase(),n.AXIS[t][1].toLowerCase()];r[0].indexOf("north")!==-1||(r[0]==="y"||r[0]==="lat")&&r[1]==="north"?e+="n":r[0].indexOf("south")!==-1||(r[0]==="y"||r[0]==="lat")&&r[1]==="south"?e+="s":r[0].indexOf("east")!==-1||(r[0]==="x"||r[0]==="lon")&&r[1]==="east"?e+="e":(r[0].indexOf("west")!==-1||(r[0]==="x"||r[0]==="lon")&&r[1]==="west")&&(e+="w")}e.length===2&&(e+="u"),e.length===3&&(n.axis=e)}n.UNIT&&(n.units=n.UNIT.name.toLowerCase(),n.units==="metre"&&(n.units="meter"),n.UNIT.convert&&(n.type==="GEOGCS"?n.DATUM&&n.DATUM.SPHEROID&&(n.to_meter=n.UNIT.convert*n.DATUM.SPHEROID.a):n.to_meter=n.UNIT.convert));var a=n.GEOGCS;n.type==="GEOGCS"&&(a=n),a&&(a.DATUM?n.datumCode=a.DATUM.name.toLowerCase():n.datumCode=a.name.toLowerCase(),n.datumCode.slice(0,2)==="d_"&&(n.datumCode=n.datumCode.slice(2)),(n.datumCode==="new_zealand_geodetic_datum_1949"||n.datumCode==="new_zealand_1949")&&(n.datumCode="nzgd49"),(n.datumCode==="wgs_1984"||n.datumCode==="world_geodetic_system_1984")&&(n.PROJECTION==="Mercator_Auxiliary_Sphere"&&(n.sphere=!0),n.datumCode="wgs84"),n.datumCode.slice(-6)==="_ferro"&&(n.datumCode=n.datumCode.slice(0,-6)),n.datumCode.slice(-8)==="_jakarta"&&(n.datumCode=n.datumCode.slice(0,-8)),~n.datumCode.indexOf("belge")&&(n.datumCode="rnb72"),a.DATUM&&a.DATUM.SPHEROID&&(n.ellps=a.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),n.ellps.toLowerCase().slice(0,13)==="international"&&(n.ellps="intl"),n.a=a.DATUM.SPHEROID.a,n.rf=parseFloat(a.DATUM.SPHEROID.rf,10)),a.DATUM&&a.DATUM.TOWGS84&&(n.datum_params=a.DATUM.TOWGS84),~n.datumCode.indexOf("osgb_1936")&&(n.datumCode="osgb36"),~n.datumCode.indexOf("osni_1952")&&(n.datumCode="osni52"),(~n.datumCode.indexOf("tm65")||~n.datumCode.indexOf("geodetic_datum_of_1965"))&&(n.datumCode="ire65"),n.datumCode==="ch1903+"&&(n.datumCode="ch1903"),~n.datumCode.indexOf("israel")&&(n.datumCode="isr93")),n.b&&!isFinite(n.b)&&(n.b=n.a);function l(g){var x=n.to_meter||1;return g*x}var s=function(g){return eN(n,g)},d=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",tp],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",tp],["x0","false_easting",l],["y0","false_northing",l],["long0","central_meridian",tp],["lat0","latitude_of_origin",tp],["lat0","standard_parallel_1",tp],["lat1","standard_parallel_1",tp],["lat2","standard_parallel_2",tp],["azimuth","Azimuth"],["alpha","azimuth",tp],["srsCode","name"]];d.forEach(s),!n.long0&&n.longc&&(n.projName==="Albers_Conic_Equal_Area"||n.projName==="Lambert_Azimuthal_Equal_Area")&&(n.long0=n.longc),!n.lat_ts&&n.lat1&&(n.projName==="Stereographic_South_Pole"||n.projName==="Polar Stereographic (variant B)")?(n.lat0=tp(n.lat1>0?90:-90),n.lat_ts=n.lat1):!n.lat_ts&&n.lat0&&n.projName==="Polar_Stereographic"&&(n.lat_ts=n.lat0,n.lat0=tp(n.lat0>0?90:-90))}function RL(n){var e=QO(n),t=e.shift(),i=e.shift();e.unshift(["name",i]),e.unshift(["type",t]);var r={};return fv(e,r),tN(r),r}function $u(n){var e=this;if(arguments.length===2){var t=arguments[1];typeof t=="string"?t.charAt(0)==="+"?$u[n]=Jw(arguments[1]):$u[n]=RL(arguments[1]):$u[n]=t}else if(arguments.length===1){if(Array.isArray(n))return n.map(function(i){Array.isArray(i)?$u.apply(e,i):$u(i)});if(typeof n=="string"){if(n in $u)return $u[n]}else"EPSG"in n?$u["EPSG:"+n.EPSG]=n:"ESRI"in n?$u["ESRI:"+n.ESRI]=n:"IAU2000"in n?$u["IAU2000:"+n.IAU2000]=n:console.log(n);return}}GO($u);function nN(n){return typeof n=="string"}function iN(n){return n in $u}var rN=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function sN(n){return rN.some(function(e){return n.indexOf(e)>-1})}var oN=["3857","900913","3785","102113"];function aN(n){var e=ag(n,"authority");if(e){var t=ag(e,"epsg");return t&&oN.indexOf(t)>-1}}function lN(n){var e=ag(n,"extension");if(e)return ag(e,"proj4")}function uN(n){return n[0]==="+"}function cN(n){if(nN(n)){if(iN(n))return $u[n];if(sN(n)){var e=RL(n);if(aN(e))return $u["EPSG:3857"];var t=lN(e);return t?Jw(t):e}if(uN(n))return Jw(n)}else return n}function $C(n,e){n=n||{};var t,i;if(!e)return n;for(i in e)t=e[i],t!==void 0&&(n[i]=t);return n}function dp(n,e,t){var i=n*e;return t/Math.sqrt(1-i*i)}function lb(n){return n<0?-1:1}function xi(n){return Math.abs(n)<=Ta?n:n-lb(n)*z1}function dd(n,e,t){var i=n*t,r=.5*n;return i=Math.pow((1-i)/(1+i),r),Math.tan(.5*(Bn-e))/i}function V1(n,e){for(var t=.5*n,i,r,a=Bn-2*Math.atan(e),l=0;l<=15;l++)if(i=n*Math.sin(a),r=Bn-2*Math.atan(e*Math.pow((1-i)/(1+i),t))-a,a+=r,Math.abs(r)<=1e-10)return a;return-9999}function hN(){var n=this.b/this.a;this.es=1-n*n,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=dp(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function fN(n){var e=n.x,t=n.y;if(t*lp>90&&t*lp<-90&&e*lp>180&&e*lp<-180)return null;var i,r;if(Math.abs(Math.abs(t)-Bn)<=fi)return null;if(this.sphere)i=this.x0+this.a*this.k0*xi(e-this.long0),r=this.y0+this.a*this.k0*Math.log(Math.tan(Vs+.5*t));else{var a=Math.sin(t),l=dd(this.e,t,a);i=this.x0+this.a*this.k0*xi(e-this.long0),r=this.y0-this.a*this.k0*Math.log(l)}return n.x=i,n.y=r,n}function dN(n){var e=n.x-this.x0,t=n.y-this.y0,i,r;if(this.sphere)r=Bn-2*Math.atan(Math.exp(-t/(this.a*this.k0)));else{var a=Math.exp(-t/(this.a*this.k0));if(r=V1(this.e,a),r===-9999)return null}return i=xi(this.long0+e/(this.a*this.k0)),n.x=i,n.y=r,n}var pN=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"];const mN={init:hN,forward:fN,inverse:dN,names:pN};function gN(){}function e2(n){return n}var _N=["longlat","identity"];const yN={init:gN,forward:e2,inverse:e2,names:_N};var vN=[mN,yN],CE={},zE=[];function PL(n,e){var t=zE.length;return n.names?(zE[t]=n,n.names.forEach(function(i){CE[i.toLowerCase()]=t}),this):(console.log(e),!0)}function bN(n){if(!n)return!1;var e=n.toLowerCase();if(typeof CE[e]<"u"&&zE[CE[e]])return zE[CE[e]]}function xN(){vN.forEach(PL)}const EN={start:xN,add:PL,get:bN};var wr={};wr.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};wr.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};wr.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"};wr.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};wr.airy={a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"};wr.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};wr.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};wr.mod_airy={a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"};wr.andrae={a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};wr.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"};wr.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};wr.bessel={a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"};wr.bess_nam={a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};wr.clrk66={a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"};wr.clrk80={a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."};wr.clrk80ign={a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"};wr.clrk58={a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"};wr.CPM={a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};wr.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};wr.engelis={a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"};wr.evrst30={a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"};wr.evrst48={a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"};wr.evrst56={a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"};wr.evrst69={a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"};wr.evrstSS={a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"};wr.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};wr.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};wr.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};wr.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};wr.hough={a:6378270,rf:297,ellipseName:"Hough"};wr.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};wr.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};wr.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};wr.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};wr.new_intl={a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"};wr.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};wr.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};wr.SEasia={a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"};wr.walbeck={a:6376896,b:63558348467e-4,ellipseName:"Walbeck"};wr.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"};wr.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};wr.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var IN=wr.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};wr.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};function TN(n,e,t,i){var r=n*n,a=e*e,l=(r-a)/r,s=0;i?(n*=1-l*(qO+l*(WO+l*XO)),r=n*n,l=0):s=Math.sqrt(l);var d=(r-a)/a;return{es:l,e:s,ep2:d}}function wN(n,e,t,i,r){if(!n){var a=ag(wr,i);a||(a=IN),n=a.a,e=a.b,t=a.rf}return t&&!e&&(e=(1-1/t)*n),(t===0||Math.abs(n-e)<fi)&&(r=!0,e=n),{a:n,b:e,rf:t,sphere:r}}var Ul={};Ul.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"};Ul.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"};Ul.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"};Ul.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"};Ul.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"};Ul.potsdam={towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"};Ul.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"};Ul.hermannskogel={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"};Ul.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"};Ul.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"};Ul.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"};Ul.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"};Ul.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"};Ul.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"};Ul.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"};Ul.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"};Ul.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};function SN(n,e,t,i,r,a,l){var s={};return n===void 0||n==="none"?s.datum_type=Kw:s.datum_type=HO,e&&(s.datum_params=e.map(parseFloat),(s.datum_params[0]!==0||s.datum_params[1]!==0||s.datum_params[2]!==0)&&(s.datum_type=S_),s.datum_params.length>3&&(s.datum_params[3]!==0||s.datum_params[4]!==0||s.datum_params[5]!==0||s.datum_params[6]!==0)&&(s.datum_type=C_,s.datum_params[3]*=N1,s.datum_params[4]*=N1,s.datum_params[5]*=N1,s.datum_params[6]=s.datum_params[6]/1e6+1)),l&&(s.datum_type=Iv,s.grids=l),s.a=t,s.b=i,s.es=r,s.ep2=a,s}var DL={};function CN(n,e){var t=new DataView(e),i=LN(t),r=RN(t,i);r.nSubgrids>1&&console.log("Only single NTv2 subgrids are currently supported, subsequent sub grids are ignored");var a=PN(t,r,i),l={header:r,subgrids:a};return DL[n]=l,l}function AN(n){if(n===void 0)return null;var e=n.split(",");return e.map(MN)}function MN(n){if(n.length===0)return null;var e=n[0]==="@";return e&&(n=n.slice(1)),n==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:n,mandatory:!e,grid:DL[n]||null,isNull:!1}}function dv(n){return n/3600*Math.PI/180}function LN(n){var e=n.getInt32(8,!1);return e===11?!1:(e=n.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function RN(n,e){return{nFields:n.getInt32(8,e),nSubgridFields:n.getInt32(24,e),nSubgrids:n.getInt32(40,e),shiftType:Qw(n,56,56+8).trim(),fromSemiMajorAxis:n.getFloat64(120,e),fromSemiMinorAxis:n.getFloat64(136,e),toSemiMajorAxis:n.getFloat64(152,e),toSemiMinorAxis:n.getFloat64(168,e)}}function Qw(n,e,t){return String.fromCharCode.apply(null,new Uint8Array(n.buffer.slice(e,t)))}function PN(n,e,t){for(var i=176,r=[],a=0;a<e.nSubgrids;a++){var l=ON(n,i,t),s=NN(n,i,l,t),d=Math.round(1+(l.upperLongitude-l.lowerLongitude)/l.longitudeInterval),g=Math.round(1+(l.upperLatitude-l.lowerLatitude)/l.latitudeInterval);r.push({ll:[dv(l.lowerLongitude),dv(l.lowerLatitude)],del:[dv(l.longitudeInterval),dv(l.latitudeInterval)],lim:[d,g],count:l.gridNodeCount,cvs:DN(s)})}return r}function DN(n){return n.map(function(e){return[dv(e.longitudeShift),dv(e.latitudeShift)]})}function ON(n,e,t){return{name:Qw(n,e+8,e+16).trim(),parent:Qw(n,e+24,e+24+8).trim(),lowerLatitude:n.getFloat64(e+72,t),upperLatitude:n.getFloat64(e+88,t),lowerLongitude:n.getFloat64(e+104,t),upperLongitude:n.getFloat64(e+120,t),latitudeInterval:n.getFloat64(e+136,t),longitudeInterval:n.getFloat64(e+152,t),gridNodeCount:n.getInt32(e+168,t)}}function NN(n,e,t,i){for(var r=e+176,a=16,l=[],s=0;s<t.gridNodeCount;s++){var d={latitudeShift:n.getFloat32(r+s*a,i),longitudeShift:n.getFloat32(r+s*a+4,i),latitudeAccuracy:n.getFloat32(r+s*a+8,i),longitudeAccuracy:n.getFloat32(r+s*a+12,i)};l.push(d)}return l}function hp(n,e){if(!(this instanceof hp))return new hp(n);e=e||function(g){if(g)throw g};var t=cN(n);if(typeof t!="object"){e(n);return}var i=hp.projections.get(t.projName);if(!i){e(n);return}if(t.datumCode&&t.datumCode!=="none"){var r=ag(Ul,t.datumCode);r&&(t.datum_params=t.datum_params||(r.towgs84?r.towgs84.split(","):null),t.ellps=r.ellipse,t.datumName=r.datumName?r.datumName:t.datumCode)}t.k0=t.k0||1,t.axis=t.axis||"enu",t.ellps=t.ellps||"wgs84",t.lat1=t.lat1||t.lat0;var a=wN(t.a,t.b,t.rf,t.ellps,t.sphere),l=TN(a.a,a.b,a.rf,t.R_A),s=AN(t.nadgrids),d=t.datum||SN(t.datumCode,t.datum_params,a.a,a.b,l.es,l.ep2,s);$C(this,t),$C(this,i),this.a=a.a,this.b=a.b,this.rf=a.rf,this.sphere=a.sphere,this.es=l.es,this.e=l.e,this.ep2=l.ep2,this.datum=d,this.init(),e(null,this)}hp.projections=EN;hp.projections.start();function kN(n,e){return n.datum_type!==e.datum_type||n.a!==e.a||Math.abs(n.es-e.es)>5e-11?!1:n.datum_type===S_?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]:n.datum_type===C_?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]&&n.datum_params[3]===e.datum_params[3]&&n.datum_params[4]===e.datum_params[4]&&n.datum_params[5]===e.datum_params[5]&&n.datum_params[6]===e.datum_params[6]:!0}function OL(n,e,t){var i=n.x,r=n.y,a=n.z?n.z:0,l,s,d,g;if(r<-Bn&&r>-1.001*Bn)r=-Bn;else if(r>Bn&&r<1.001*Bn)r=Bn;else{if(r<-Bn)return{x:-1/0,y:-1/0,z:n.z};if(r>Bn)return{x:1/0,y:1/0,z:n.z}}return i>Math.PI&&(i-=2*Math.PI),s=Math.sin(r),g=Math.cos(r),d=s*s,l=t/Math.sqrt(1-e*d),{x:(l+a)*g*Math.cos(i),y:(l+a)*g*Math.sin(i),z:(l*(1-e)+a)*s}}function NL(n,e,t,i){var r=1e-12,a=r*r,l=30,s,d,g,x,I,A,L,N,B,F,z,V,Y,Q=n.x,J=n.y,he=n.z?n.z:0,ee,ae,De;if(s=Math.sqrt(Q*Q+J*J),d=Math.sqrt(Q*Q+J*J+he*he),s/t<r){if(ee=0,d/t<r)return ae=Bn,De=-i,{x:n.x,y:n.y,z:n.z}}else ee=Math.atan2(J,Q);g=he/d,x=s/d,I=1/Math.sqrt(1-e*(2-e)*x*x),N=x*(1-e)*I,B=g*I,Y=0;do Y++,L=t/Math.sqrt(1-e*B*B),De=s*N+he*B-L*(1-e*B*B),A=e*L/(L+De),I=1/Math.sqrt(1-A*(2-A)*x*x),F=x*(1-A)*I,z=g*I,V=z*N-F*B,N=F,B=z;while(V*V>a&&Y<l);return ae=Math.atan(z/Math.abs(F)),{x:ee,y:ae,z:De}}function FN(n,e,t){if(e===S_)return{x:n.x+t[0],y:n.y+t[1],z:n.z+t[2]};if(e===C_){var i=t[0],r=t[1],a=t[2],l=t[3],s=t[4],d=t[5],g=t[6];return{x:g*(n.x-d*n.y+s*n.z)+i,y:g*(d*n.x+n.y-l*n.z)+r,z:g*(-s*n.x+l*n.y+n.z)+a}}}function BN(n,e,t){if(e===S_)return{x:n.x-t[0],y:n.y-t[1],z:n.z-t[2]};if(e===C_){var i=t[0],r=t[1],a=t[2],l=t[3],s=t[4],d=t[5],g=t[6],x=(n.x-i)/g,I=(n.y-r)/g,A=(n.z-a)/g;return{x:x+d*I-s*A,y:-d*x+I+l*A,z:s*x-l*I+A}}}function dE(n){return n===S_||n===C_}function zN(n,e,t){if(kN(n,e)||n.datum_type===Kw||e.datum_type===Kw)return t;var i=n.a,r=n.es;if(n.datum_type===Iv){var a=t2(n,!1,t);if(a!==0)return;i=YC,r=KC}var l=e.a,s=e.b,d=e.es;if(e.datum_type===Iv&&(l=YC,s=jO,d=KC),r===d&&i===l&&!dE(n.datum_type)&&!dE(e.datum_type))return t;if(t=OL(t,r,i),dE(n.datum_type)&&(t=FN(t,n.datum_type,n.datum_params)),dE(e.datum_type)&&(t=BN(t,e.datum_type,e.datum_params)),t=NL(t,d,l,s),e.datum_type===Iv){var g=t2(e,!0,t);if(g!==0)return}return t}function t2(n,e,t){if(n.grids===null||n.grids.length===0)return console.log("Grid shift grids not found"),-1;for(var i={x:-t.x,y:t.y},r={x:Number.NaN,y:Number.NaN},a=[],l=0;l<n.grids.length;l++){var s=n.grids[l];if(a.push(s.name),s.isNull){r=i;break}if(s.mandatory,s.grid===null){if(s.mandatory)return console.log("Unable to find mandatory grid '"+s.name+"'"),-1;continue}var d=s.grid.subgrids[0],g=(Math.abs(d.del[1])+Math.abs(d.del[0]))/1e4,x=d.ll[0]-g,I=d.ll[1]-g,A=d.ll[0]+(d.lim[0]-1)*d.del[0]+g,L=d.ll[1]+(d.lim[1]-1)*d.del[1]+g;if(!(I>i.y||x>i.x||L<i.y||A<i.x)&&(r=UN(i,e,d),!isNaN(r.x)))break}return isNaN(r.x)?(console.log("Failed to find a grid shift table for location '"+-i.x*lp+" "+i.y*lp+" tried: '"+a+"'"),-1):(t.x=-r.x,t.y=r.y,0)}function UN(n,e,t){var i={x:Number.NaN,y:Number.NaN};if(isNaN(n.x))return i;var r={x:n.x,y:n.y};r.x-=t.ll[0],r.y-=t.ll[1],r.x=xi(r.x-Math.PI)+Math.PI;var a=n2(r,t);if(e){if(isNaN(a.x))return i;a.x=r.x-a.x,a.y=r.y-a.y;var l=9,s=1e-12,d,g;do{if(g=n2(a,t),isNaN(g.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}d={x:r.x-(g.x+a.x),y:r.y-(g.y+a.y)},a.x+=d.x,a.y+=d.y}while(l--&&Math.abs(d.x)>s&&Math.abs(d.y)>s);if(l<0)return console.log("Inverse grid shift iterator failed to converge."),i;i.x=xi(a.x+t.ll[0]),i.y=a.y+t.ll[1]}else isNaN(a.x)||(i.x=n.x+a.x,i.y=n.y+a.y);return i}function n2(n,e){var t={x:n.x/e.del[0],y:n.y/e.del[1]},i={x:Math.floor(t.x),y:Math.floor(t.y)},r={x:t.x-1*i.x,y:t.y-1*i.y},a={x:Number.NaN,y:Number.NaN},l;if(i.x<0||i.x>=e.lim[0]||i.y<0||i.y>=e.lim[1])return a;l=i.y*e.lim[0]+i.x;var s={x:e.cvs[l][0],y:e.cvs[l][1]};l++;var d={x:e.cvs[l][0],y:e.cvs[l][1]};l+=e.lim[0];var g={x:e.cvs[l][0],y:e.cvs[l][1]};l--;var x={x:e.cvs[l][0],y:e.cvs[l][1]},I=r.x*r.y,A=r.x*(1-r.y),L=(1-r.x)*(1-r.y),N=(1-r.x)*r.y;return a.x=L*s.x+A*d.x+N*x.x+I*g.x,a.y=L*s.y+A*d.y+N*x.y+I*g.y,a}function i2(n,e,t){var i=t.x,r=t.y,a=t.z||0,l,s,d,g={};for(d=0;d<3;d++)if(!(e&&d===2&&t.z===void 0))switch(d===0?(l=i,"ew".indexOf(n.axis[d])!==-1?s="x":s="y"):d===1?(l=r,"ns".indexOf(n.axis[d])!==-1?s="y":s="x"):(l=a,s="z"),n.axis[d]){case"e":g[s]=l;break;case"w":g[s]=-l;break;case"n":g[s]=l;break;case"s":g[s]=-l;break;case"u":t[s]!==void 0&&(g.z=l);break;case"d":t[s]!==void 0&&(g.z=-l);break;default:return null}return g}function kL(n){var e={x:n[0],y:n[1]};return n.length>2&&(e.z=n[2]),n.length>3&&(e.m=n[3]),e}function VN(n){r2(n.x),r2(n.y)}function r2(n){if(typeof Number.isFinite=="function"){if(Number.isFinite(n))return;throw new TypeError("coordinates must be finite numbers")}if(typeof n!="number"||n!==n||!isFinite(n))throw new TypeError("coordinates must be finite numbers")}function GN(n,e){return(n.datum.datum_type===S_||n.datum.datum_type===C_||n.datum.datum_type===Iv)&&e.datumCode!=="WGS84"||(e.datum.datum_type===S_||e.datum.datum_type===C_||e.datum.datum_type===Iv)&&n.datumCode!=="WGS84"}function UE(n,e,t,i){var r;Array.isArray(t)?t=kL(t):t={x:t.x,y:t.y,z:t.z,m:t.m};var a=t.z!==void 0;if(VN(t),n.datum&&e.datum&&GN(n,e)&&(r=new hp("WGS84"),t=UE(n,r,t,i),n=r),i&&n.axis!=="enu"&&(t=i2(n,!1,t)),n.projName==="longlat")t={x:t.x*eu,y:t.y*eu,z:t.z||0};else if(n.to_meter&&(t={x:t.x*n.to_meter,y:t.y*n.to_meter,z:t.z||0}),t=n.inverse(t),!t)return;if(n.from_greenwich&&(t.x+=n.from_greenwich),t=zN(n.datum,e.datum,t),!!t)return e.from_greenwich&&(t={x:t.x-e.from_greenwich,y:t.y,z:t.z||0}),e.projName==="longlat"?t={x:t.x*lp,y:t.y*lp,z:t.z||0}:(t=e.forward(t),e.to_meter&&(t={x:t.x/e.to_meter,y:t.y/e.to_meter,z:t.z||0})),i&&e.axis!=="enu"?i2(e,!0,t):(a||delete t.z,t)}var s2=hp("WGS84");function Lw(n,e,t,i){var r,a,l;return Array.isArray(t)?(r=UE(n,e,t,i)||{x:NaN,y:NaN},t.length>2?typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof r.z=="number"?[r.x,r.y,r.z].concat(t.splice(3)):[r.x,r.y,t[2]].concat(t.splice(3)):[r.x,r.y].concat(t.splice(2)):[r.x,r.y]):(a=UE(n,e,t,i),l=Object.keys(t),l.length===2||l.forEach(function(s){if(typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(s==="x"||s==="y"||s==="z")return}else if(s==="x"||s==="y")return;a[s]=t[s]}),a)}function o2(n){return n instanceof hp?n:n.oProj?n.oProj:hp(n)}function rc(n,e,t){n=o2(n);var i=!1,r;return typeof e>"u"?(e=n,n=s2,i=!0):(typeof e.x<"u"||Array.isArray(e))&&(t=e,e=n,n=s2,i=!0),e=o2(e),t?Lw(n,e,t):(r={forward:function(a,l){return Lw(n,e,a,l)},inverse:function(a,l){return Lw(e,n,a,l)}},i&&(r.oProj=e),r)}var a2=6,FL="AJSAJS",BL="AFAFAF",pv=65,Fc=73,df=79,M1=86,L1=90;const HN={forward:zL,inverse:jN,toPoint:UL};function zL(n,e){return e=e||5,XN(qN({lat:n[1],lon:n[0]}),e)}function jN(n){var e=DS(GL(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function UL(n){var e=DS(GL(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function Rw(n){return n*(Math.PI/180)}function l2(n){return 180*(n/Math.PI)}function qN(n){var e=n.lat,t=n.lon,i=6378137,r=.00669438,a=.9996,l,s,d,g,x,I,A,L=Rw(e),N=Rw(t),B,F;F=Math.floor((t+180)/6)+1,t===180&&(F=60),e>=56&&e<64&&t>=3&&t<12&&(F=32),e>=72&&e<84&&(t>=0&&t<9?F=31:t>=9&&t<21?F=33:t>=21&&t<33?F=35:t>=33&&t<42&&(F=37)),l=(F-1)*6-180+3,B=Rw(l),s=r/(1-r),d=i/Math.sqrt(1-r*Math.sin(L)*Math.sin(L)),g=Math.tan(L)*Math.tan(L),x=s*Math.cos(L)*Math.cos(L),I=Math.cos(L)*(N-B),A=i*((1-r/4-3*r*r/64-5*r*r*r/256)*L-(3*r/8+3*r*r/32+45*r*r*r/1024)*Math.sin(2*L)+(15*r*r/256+45*r*r*r/1024)*Math.sin(4*L)-35*r*r*r/3072*Math.sin(6*L));var z=a*d*(I+(1-g+x)*I*I*I/6+(5-18*g+g*g+72*x-58*s)*I*I*I*I*I/120)+5e5,V=a*(A+d*Math.tan(L)*(I*I/2+(5-g+9*x+4*x*x)*I*I*I*I/24+(61-58*g+g*g+600*x-330*s)*I*I*I*I*I*I/720));return e<0&&(V+=1e7),{northing:Math.round(V),easting:Math.round(z),zoneNumber:F,zoneLetter:WN(e)}}function DS(n){var e=n.northing,t=n.easting,i=n.zoneLetter,r=n.zoneNumber;if(r<0||r>60)return null;var a=.9996,l=6378137,s=.00669438,d,g=(1-Math.sqrt(1-s))/(1+Math.sqrt(1-s)),x,I,A,L,N,B,F,z,V,Y=t-5e5,Q=e;i<"N"&&(Q-=1e7),F=(r-1)*6-180+3,d=s/(1-s),B=Q/a,z=B/(l*(1-s/4-3*s*s/64-5*s*s*s/256)),V=z+(3*g/2-27*g*g*g/32)*Math.sin(2*z)+(21*g*g/16-55*g*g*g*g/32)*Math.sin(4*z)+151*g*g*g/96*Math.sin(6*z),x=l/Math.sqrt(1-s*Math.sin(V)*Math.sin(V)),I=Math.tan(V)*Math.tan(V),A=d*Math.cos(V)*Math.cos(V),L=l*(1-s)/Math.pow(1-s*Math.sin(V)*Math.sin(V),1.5),N=Y/(x*a);var J=V-x*Math.tan(V)/L*(N*N/2-(5+3*I+10*A-4*A*A-9*d)*N*N*N*N/24+(61+90*I+298*A+45*I*I-252*d-3*A*A)*N*N*N*N*N*N/720);J=l2(J);var he=(N-(1+2*I+A)*N*N*N/6+(5-2*A+28*I-3*A*A+8*d+24*I*I)*N*N*N*N*N/120)/Math.cos(V);he=F+l2(he);var ee;if(n.accuracy){var ae=DS({northing:n.northing+n.accuracy,easting:n.easting+n.accuracy,zoneLetter:n.zoneLetter,zoneNumber:n.zoneNumber});ee={top:ae.lat,right:ae.lon,bottom:J,left:he}}else ee={lat:J,lon:he};return ee}function WN(n){var e="Z";return 84>=n&&n>=72?e="X":72>n&&n>=64?e="W":64>n&&n>=56?e="V":56>n&&n>=48?e="U":48>n&&n>=40?e="T":40>n&&n>=32?e="S":32>n&&n>=24?e="R":24>n&&n>=16?e="Q":16>n&&n>=8?e="P":8>n&&n>=0?e="N":0>n&&n>=-8?e="M":-8>n&&n>=-16?e="L":-16>n&&n>=-24?e="K":-24>n&&n>=-32?e="J":-32>n&&n>=-40?e="H":-40>n&&n>=-48?e="G":-48>n&&n>=-56?e="F":-56>n&&n>=-64?e="E":-64>n&&n>=-72?e="D":-72>n&&n>=-80&&(e="C"),e}function XN(n,e){var t="00000"+n.easting,i="00000"+n.northing;return n.zoneNumber+n.zoneLetter+ZN(n.easting,n.northing,n.zoneNumber)+t.substr(t.length-5,e)+i.substr(i.length-5,e)}function ZN(n,e,t){var i=VL(t),r=Math.floor(n/1e5),a=Math.floor(e/1e5)%20;return YN(r,a,i)}function VL(n){var e=n%a2;return e===0&&(e=a2),e}function YN(n,e,t){var i=t-1,r=FL.charCodeAt(i),a=BL.charCodeAt(i),l=r+n-1,s=a+e,d=!1;l>L1&&(l=l-L1+pv-1,d=!0),(l===Fc||r<Fc&&l>Fc||(l>Fc||r<Fc)&&d)&&l++,(l===df||r<df&&l>df||(l>df||r<df)&&d)&&(l++,l===Fc&&l++),l>L1&&(l=l-L1+pv-1),s>M1?(s=s-M1+pv-1,d=!0):d=!1,(s===Fc||a<Fc&&s>Fc||(s>Fc||a<Fc)&&d)&&s++,(s===df||a<df&&s>df||(s>df||a<df)&&d)&&(s++,s===Fc&&s++),s>M1&&(s=s-M1+pv-1);var g=String.fromCharCode(l)+String.fromCharCode(s);return g}function GL(n){if(n&&n.length===0)throw"MGRSPoint coverting from nothing";for(var e=n.length,t=null,i="",r,a=0;!/[A-Z]/.test(r=n.charAt(a));){if(a>=2)throw"MGRSPoint bad conversion from: "+n;i+=r,a++}var l=parseInt(i,10);if(a===0||a+3>e)throw"MGRSPoint bad conversion from: "+n;var s=n.charAt(a++);if(s<="A"||s==="B"||s==="Y"||s>="Z"||s==="I"||s==="O")throw"MGRSPoint zone letter "+s+" not handled: "+n;t=n.substring(a,a+=2);for(var d=VL(l),g=KN(t.charAt(0),d),x=JN(t.charAt(1),d);x<QN(s);)x+=2e6;var I=e-a;if(I%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+n;var A=I/2,L=0,N=0,B,F,z,V,Y;return A>0&&(B=1e5/Math.pow(10,A),F=n.substring(a,a+A),L=parseFloat(F)*B,z=n.substring(a+A),N=parseFloat(z)*B),V=L+g,Y=N+x,{easting:V,northing:Y,zoneLetter:s,zoneNumber:l,accuracy:B}}function KN(n,e){for(var t=FL.charCodeAt(e-1),i=1e5,r=!1;t!==n.charCodeAt(0);){if(t++,t===Fc&&t++,t===df&&t++,t>L1){if(r)throw"Bad character: "+n;t=pv,r=!0}i+=1e5}return i}function JN(n,e){if(n>"V")throw"MGRSPoint given invalid Northing "+n;for(var t=BL.charCodeAt(e-1),i=0,r=!1;t!==n.charCodeAt(0);){if(t++,t===Fc&&t++,t===df&&t++,t>M1){if(r)throw"Bad character: "+n;t=pv,r=!0}i+=1e5}return i}function QN(n){var e;switch(n){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+n}function Pv(n,e,t){if(!(this instanceof Pv))return new Pv(n,e,t);if(Array.isArray(n))this.x=n[0],this.y=n[1],this.z=n[2]||0;else if(typeof n=="object")this.x=n.x,this.y=n.y,this.z=n.z||0;else if(typeof n=="string"&&typeof e>"u"){var i=n.split(",");this.x=parseFloat(i[0],10),this.y=parseFloat(i[1],10),this.z=parseFloat(i[2],10)||0}else this.x=n,this.y=e,this.z=t||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Pv.fromMGRS=function(n){return new Pv(UL(n))};Pv.prototype.toMGRS=function(n){return zL([this.x,this.y],n)};var $N=1,e3=.25,u2=.046875,c2=.01953125,h2=.01068115234375,t3=.75,n3=.46875,i3=.013020833333333334,r3=.007120768229166667,s3=.3645833333333333,o3=.005696614583333333,a3=.3076171875;function HL(n){var e=[];e[0]=$N-n*(e3+n*(u2+n*(c2+n*h2))),e[1]=n*(t3-n*(u2+n*(c2+n*h2)));var t=n*n;return e[2]=t*(n3-n*(i3+n*r3)),t*=n,e[3]=t*(s3-n*o3),e[4]=t*n*a3,e}function dI(n,e,t,i){return t*=e,e*=e,i[0]*n-t*(i[1]+e*(i[2]+e*(i[3]+e*i[4])))}var l3=20;function jL(n,e,t){for(var i=1/(1-e),r=n,a=l3;a;--a){var l=Math.sin(r),s=1-e*l*l;if(s=(dI(r,l,Math.cos(r),t)-n)*(s*Math.sqrt(s))*i,r-=s,Math.abs(s)<fi)return r}return r}function u3(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=HL(this.es),this.ml0=dI(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function c3(n){var e=n.x,t=n.y,i=xi(e-this.long0),r,a,l,s=Math.sin(t),d=Math.cos(t);if(this.es){var x=d*i,I=Math.pow(x,2),A=this.ep2*Math.pow(d,2),L=Math.pow(A,2),N=Math.abs(d)>fi?Math.tan(t):0,B=Math.pow(N,2),F=Math.pow(B,2);r=1-this.es*Math.pow(s,2),x=x/Math.sqrt(r);var z=dI(t,s,d,this.en);a=this.a*(this.k0*x*(1+I/6*(1-B+A+I/20*(5-18*B+F+14*A-58*B*A+I/42*(61+179*F-F*B-479*B)))))+this.x0,l=this.a*(this.k0*(z-this.ml0+s*i*x/2*(1+I/12*(5-B+9*A+4*L+I/30*(61+F-58*B+270*A-330*B*A+I/56*(1385+543*F-F*B-3111*B))))))+this.y0}else{var g=d*Math.sin(i);if(Math.abs(Math.abs(g)-1)<fi)return 93;if(a=.5*this.a*this.k0*Math.log((1+g)/(1-g))+this.x0,l=d*Math.cos(i)/Math.sqrt(1-Math.pow(g,2)),g=Math.abs(l),g>=1){if(g-1>fi)return 93;l=0}else l=Math.acos(l);t<0&&(l=-l),l=this.a*this.k0*(l-this.lat0)+this.y0}return n.x=a,n.y=l,n}function h3(n){var e,t,i,r,a=(n.x-this.x0)*(1/this.a),l=(n.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+l/this.k0,t=jL(e,this.es,this.en),Math.abs(t)<Bn){var I=Math.sin(t),A=Math.cos(t),L=Math.abs(A)>fi?Math.tan(t):0,N=this.ep2*Math.pow(A,2),B=Math.pow(N,2),F=Math.pow(L,2),z=Math.pow(F,2);e=1-this.es*Math.pow(I,2);var V=a*Math.sqrt(e)/this.k0,Y=Math.pow(V,2);e=e*L,i=t-e*Y/(1-this.es)*.5*(1-Y/12*(5+3*F-9*N*F+N-4*B-Y/30*(61+90*F-252*N*F+45*z+46*N-Y/56*(1385+3633*F+4095*z+1574*z*F)))),r=xi(this.long0+V*(1-Y/6*(1+2*F+N-Y/20*(5+28*F+24*z+8*N*F+6*N-Y/42*(61+662*F+1320*z+720*z*F))))/A)}else i=Bn*lb(l),r=0;else{var s=Math.exp(a/this.k0),d=.5*(s-1/s),g=this.lat0+l/this.k0,x=Math.cos(g);e=Math.sqrt((1-Math.pow(x,2))/(1+Math.pow(d,2))),i=Math.asin(e),l<0&&(i=-i),d===0&&x===0?r=0:r=xi(Math.atan2(d,x)+this.long0)}return n.x=r,n.y=i,n}var f3=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const AE={init:u3,forward:c3,inverse:h3,names:f3};function qL(n){var e=Math.exp(n);return e=(e-1/e)/2,e}function cd(n,e){n=Math.abs(n),e=Math.abs(e);var t=Math.max(n,e),i=Math.min(n,e)/(t||1);return t*Math.sqrt(1+Math.pow(i,2))}function d3(n){var e=1+n,t=e-1;return t===0?n:n*Math.log(e)/t}function p3(n){var e=Math.abs(n);return e=d3(e*(1+e/(cd(1,e)+1))),n<0?-e:e}function OS(n,e){for(var t=2*Math.cos(2*e),i=n.length-1,r=n[i],a=0,l;--i>=0;)l=-a+t*r+n[i],a=r,r=l;return e+l*Math.sin(2*e)}function m3(n,e){for(var t=2*Math.cos(e),i=n.length-1,r=n[i],a=0,l;--i>=0;)l=-a+t*r+n[i],a=r,r=l;return Math.sin(e)*l}function g3(n){var e=Math.exp(n);return e=(e+1/e)/2,e}function WL(n,e,t){for(var i=Math.sin(e),r=Math.cos(e),a=qL(t),l=g3(t),s=2*r*l,d=-2*i*a,g=n.length-1,x=n[g],I=0,A=0,L=0,N,B;--g>=0;)N=A,B=I,A=x,I=L,x=-N+s*A-d*I+n[g],L=-B+d*A+s*I;return s=i*l,d=r*a,[s*x-d*L,s*L+d*x]}function _3(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(AE.init.apply(this),this.forward=AE.forward,this.inverse=AE.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var n=this.es/(1+Math.sqrt(1-this.es)),e=n/(2-n),t=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),t=t*e,this.cgb[1]=t*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=t*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),t=t*e,this.cgb[2]=t*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=t*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),t=t*e,this.cgb[3]=t*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=t*(1237/630+e*(-12/5+e*(-24832/14175))),t=t*e,this.cgb[4]=t*(4174/315+e*(-144838/6237)),this.cbg[4]=t*(-734/315+e*(109598/31185)),t=t*e,this.cgb[5]=t*(601676/22275),this.cbg[5]=t*(444337/155925),t=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+t*(1/4+t*(1/64+t/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=t*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=t*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),t=t*e,this.utg[2]=t*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=t*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),t=t*e,this.utg[3]=t*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=t*(49561/161280+e*(-179/168+e*(6601661/7257600))),t=t*e,this.utg[4]=t*(-4583/161280+e*(108847/3991680)),this.gtu[4]=t*(34729/80640+e*(-3418889/1995840)),t=t*e,this.utg[5]=t*(-20648693/638668800),this.gtu[5]=t*(212378941/319334400);var i=OS(this.cbg,this.lat0);this.Zb=-this.Qn*(i+m3(this.gtu,2*i))}function y3(n){var e=xi(n.x-this.long0),t=n.y;t=OS(this.cbg,t);var i=Math.sin(t),r=Math.cos(t),a=Math.sin(e),l=Math.cos(e);t=Math.atan2(i,l*r),e=Math.atan2(a*r,cd(i,r*l)),e=p3(Math.tan(e));var s=WL(this.gtu,2*t,2*e);t=t+s[0],e=e+s[1];var d,g;return Math.abs(e)<=2.623395162778?(d=this.a*(this.Qn*e)+this.x0,g=this.a*(this.Qn*t+this.Zb)+this.y0):(d=1/0,g=1/0),n.x=d,n.y=g,n}function v3(n){var e=(n.x-this.x0)*(1/this.a),t=(n.y-this.y0)*(1/this.a);t=(t-this.Zb)/this.Qn,e=e/this.Qn;var i,r;if(Math.abs(e)<=2.623395162778){var a=WL(this.utg,2*t,2*e);t=t+a[0],e=e+a[1],e=Math.atan(qL(e));var l=Math.sin(t),s=Math.cos(t),d=Math.sin(e),g=Math.cos(e);t=Math.atan2(l*g,cd(d,g*s)),e=Math.atan2(d,g*s),i=xi(e+this.long0),r=OS(this.cgb,t)}else i=1/0,r=1/0;return n.x=i,n.y=r,n}var b3=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","tmerc"];const ME={init:_3,forward:y3,inverse:v3,names:b3};function x3(n,e){if(n===void 0){if(n=Math.floor((xi(e)+Math.PI)*30/Math.PI)+1,n<0)return 0;if(n>60)return 60}return n}var E3="etmerc";function I3(){var n=x3(this.zone,this.long0);if(n===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(n)-183)*eu,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,ME.init.apply(this),this.forward=ME.forward,this.inverse=ME.inverse}var T3=["Universal Transverse Mercator System","utm"];const w3={init:I3,names:T3,dependsOn:E3};function NS(n,e){return Math.pow((1-n)/(1+n),e)}var S3=20;function C3(){var n=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*n*n),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(n/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Vs)/(Math.pow(Math.tan(.5*this.lat0+Vs),this.C)*NS(this.e*n,this.ratexp))}function A3(n){var e=n.x,t=n.y;return n.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*t+Vs),this.C)*NS(this.e*Math.sin(t),this.ratexp))-Bn,n.x=this.C*e,n}function M3(n){for(var e=1e-14,t=n.x/this.C,i=n.y,r=Math.pow(Math.tan(.5*i+Vs)/this.K,1/this.C),a=S3;a>0&&(i=2*Math.atan(r*NS(this.e*Math.sin(n.y),-.5*this.e))-Bn,!(Math.abs(i-n.y)<e));--a)n.y=i;return a?(n.x=t,n.y=i,n):null}var L3=["gauss"];const kS={init:C3,forward:A3,inverse:M3,names:L3};function R3(){kS.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function P3(n){var e,t,i,r;return n.x=xi(n.x-this.long0),kS.forward.apply(this,[n]),e=Math.sin(n.y),t=Math.cos(n.y),i=Math.cos(n.x),r=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*t*i),n.x=r*t*Math.sin(n.x),n.y=r*(this.cosc0*e-this.sinc0*t*i),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function D3(n){var e,t,i,r,a;if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,a=Math.sqrt(n.x*n.x+n.y*n.y)){var l=2*Math.atan2(a,this.R2);e=Math.sin(l),t=Math.cos(l),r=Math.asin(t*this.sinc0+n.y*e*this.cosc0/a),i=Math.atan2(n.x*e,a*this.cosc0*t-n.y*this.sinc0*e)}else r=this.phic0,i=0;return n.x=i,n.y=r,kS.inverse.apply(this,[n]),n.x=xi(n.x+this.long0),n}var O3=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const N3={init:R3,forward:P3,inverse:D3,names:O3};function k3(n,e,t){return e*=t,Math.tan(.5*(Bn+n))*Math.pow((1-e)/(1+e),.5*t)}function F3(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=fi&&(this.k0=.5*(1+lb(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=fi&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=fi&&(this.k0=.5*this.cons*dp(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/dd(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=dp(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-Bn,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function B3(n){var e=n.x,t=n.y,i=Math.sin(t),r=Math.cos(t),a,l,s,d,g,x,I=xi(e-this.long0);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=fi&&Math.abs(t+this.lat0)<=fi?(n.x=NaN,n.y=NaN,n):this.sphere?(a=2*this.k0/(1+this.sinlat0*i+this.coslat0*r*Math.cos(I)),n.x=this.a*a*r*Math.sin(I)+this.x0,n.y=this.a*a*(this.coslat0*i-this.sinlat0*r*Math.cos(I))+this.y0,n):(l=2*Math.atan(this.ssfn_(t,i,this.e))-Bn,d=Math.cos(l),s=Math.sin(l),Math.abs(this.coslat0)<=fi?(g=dd(this.e,t*this.con,this.con*i),x=2*this.a*this.k0*g/this.cons,n.x=this.x0+x*Math.sin(e-this.long0),n.y=this.y0-this.con*x*Math.cos(e-this.long0),n):(Math.abs(this.sinlat0)<fi?(a=2*this.a*this.k0/(1+d*Math.cos(I)),n.y=a*s):(a=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*s+this.cosX0*d*Math.cos(I))),n.y=a*(this.cosX0*s-this.sinX0*d*Math.cos(I))+this.y0),n.x=a*d*Math.sin(I)+this.x0,n))}function z3(n){n.x-=this.x0,n.y-=this.y0;var e,t,i,r,a,l=Math.sqrt(n.x*n.x+n.y*n.y);if(this.sphere){var s=2*Math.atan(l/(2*this.a*this.k0));return e=this.long0,t=this.lat0,l<=fi?(n.x=e,n.y=t,n):(t=Math.asin(Math.cos(s)*this.sinlat0+n.y*Math.sin(s)*this.coslat0/l),Math.abs(this.coslat0)<fi?this.lat0>0?e=xi(this.long0+Math.atan2(n.x,-1*n.y)):e=xi(this.long0+Math.atan2(n.x,n.y)):e=xi(this.long0+Math.atan2(n.x*Math.sin(s),l*this.coslat0*Math.cos(s)-n.y*this.sinlat0*Math.sin(s))),n.x=e,n.y=t,n)}else if(Math.abs(this.coslat0)<=fi){if(l<=fi)return t=this.lat0,e=this.long0,n.x=e,n.y=t,n;n.x*=this.con,n.y*=this.con,i=l*this.cons/(2*this.a*this.k0),t=this.con*V1(this.e,i),e=this.con*xi(this.con*this.long0+Math.atan2(n.x,-1*n.y))}else r=2*Math.atan(l*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,l<=fi?a=this.X0:(a=Math.asin(Math.cos(r)*this.sinX0+n.y*Math.sin(r)*this.cosX0/l),e=xi(this.long0+Math.atan2(n.x*Math.sin(r),l*this.cosX0*Math.cos(r)-n.y*this.sinX0*Math.sin(r)))),t=-1*V1(this.e,Math.tan(.5*(Bn+a)));return n.x=e,n.y=t,n}var U3=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"];const V3={init:F3,forward:B3,inverse:z3,names:U3,ssfn_:k3};function G3(){var n=this.lat0;this.lambda0=this.long0;var e=Math.sin(n),t=this.a,i=this.rf,r=1/i,a=2*r-Math.pow(r,2),l=this.e=Math.sqrt(a);this.R=this.k0*t*Math.sqrt(1-a)/(1-a*Math.pow(e,2)),this.alpha=Math.sqrt(1+a/(1-a)*Math.pow(Math.cos(n),4)),this.b0=Math.asin(e/this.alpha);var s=Math.log(Math.tan(Math.PI/4+this.b0/2)),d=Math.log(Math.tan(Math.PI/4+n/2)),g=Math.log((1+l*e)/(1-l*e));this.K=s-this.alpha*d+this.alpha*l/2*g}function H3(n){var e=Math.log(Math.tan(Math.PI/4-n.y/2)),t=this.e/2*Math.log((1+this.e*Math.sin(n.y))/(1-this.e*Math.sin(n.y))),i=-this.alpha*(e+t)+this.K,r=2*(Math.atan(Math.exp(i))-Math.PI/4),a=this.alpha*(n.x-this.lambda0),l=Math.atan(Math.sin(a)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(a))),s=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(a));return n.y=this.R/2*Math.log((1+Math.sin(s))/(1-Math.sin(s)))+this.y0,n.x=this.R*l+this.x0,n}function j3(n){for(var e=n.x-this.x0,t=n.y-this.y0,i=e/this.R,r=2*(Math.atan(Math.exp(t/this.R))-Math.PI/4),a=Math.asin(Math.cos(this.b0)*Math.sin(r)+Math.sin(this.b0)*Math.cos(r)*Math.cos(i)),l=Math.atan(Math.sin(i)/(Math.cos(this.b0)*Math.cos(i)-Math.sin(this.b0)*Math.tan(r))),s=this.lambda0+l/this.alpha,d=0,g=a,x=-1e3,I=0;Math.abs(g-x)>1e-7;){if(++I>20)return;d=1/this.alpha*(Math.log(Math.tan(Math.PI/4+a/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(g))/2)),x=g,g=2*Math.atan(Math.exp(d))-Math.PI/2}return n.x=s,n.y=g,n}var q3=["somerc"];const W3={init:G3,forward:H3,inverse:j3,names:q3};var hv=1e-7;function X3(n){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],t=typeof n.PROJECTION=="object"?Object.keys(n.PROJECTION)[0]:n.PROJECTION;return"no_uoff"in n||"no_off"in n||e.indexOf(t)!==-1}function Z3(){var n,e,t,i,r,a,l,s,d,g,x=0,I,A=0,L=0,N=0,B=0,F=0,z=0;this.no_off=X3(this),this.no_rot="no_rot"in this;var V=!1;"alpha"in this&&(V=!0);var Y=!1;if("rectified_grid_angle"in this&&(Y=!0),V&&(z=this.alpha),Y&&(x=this.rectified_grid_angle*eu),V||Y)A=this.longc;else if(L=this.long1,B=this.lat1,N=this.long2,F=this.lat2,Math.abs(B-F)<=hv||(n=Math.abs(B))<=hv||Math.abs(n-Bn)<=hv||Math.abs(Math.abs(this.lat0)-Bn)<=hv||Math.abs(Math.abs(F)-Bn)<=hv)throw new Error;var Q=1-this.es;e=Math.sqrt(Q),Math.abs(this.lat0)>fi?(s=Math.sin(this.lat0),t=Math.cos(this.lat0),n=1-this.es*s*s,this.B=t*t,this.B=Math.sqrt(1+this.es*this.B*this.B/Q),this.A=this.B*this.k0*e/n,i=this.B*e/(t*Math.sqrt(n)),r=i*i-1,r<=0?r=0:(r=Math.sqrt(r),this.lat0<0&&(r=-r)),this.E=r+=i,this.E*=Math.pow(dd(this.e,this.lat0,s),this.B)):(this.B=1/e,this.A=this.k0,this.E=i=r=1),V||Y?(V?(I=Math.asin(Math.sin(z)/i),Y||(x=z)):(I=x,z=Math.asin(i*Math.sin(I))),this.lam0=A-Math.asin(.5*(r-1/r)*Math.tan(I))/this.B):(a=Math.pow(dd(this.e,B,Math.sin(B)),this.B),l=Math.pow(dd(this.e,F,Math.sin(F)),this.B),r=this.E/a,d=(l-a)/(l+a),g=this.E*this.E,g=(g-l*a)/(g+l*a),n=L-N,n<-Math.pi?N-=z1:n>Math.pi&&(N+=z1),this.lam0=xi(.5*(L+N)-Math.atan(g*Math.tan(.5*this.B*(L-N))/d)/this.B),I=Math.atan(2*Math.sin(this.B*xi(L-this.lam0))/(r-1/r)),x=z=Math.asin(i*Math.sin(I))),this.singam=Math.sin(I),this.cosgam=Math.cos(I),this.sinrot=Math.sin(x),this.cosrot=Math.cos(x),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A*this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(i*i-1)/Math.cos(z))),this.lat0<0&&(this.u_0=-this.u_0)),r=.5*I,this.v_pole_n=this.ArB*Math.log(Math.tan(Vs-r)),this.v_pole_s=this.ArB*Math.log(Math.tan(Vs+r))}function Y3(n){var e={},t,i,r,a,l,s,d,g;if(n.x=n.x-this.lam0,Math.abs(Math.abs(n.y)-Bn)>fi){if(l=this.E/Math.pow(dd(this.e,n.y,Math.sin(n.y)),this.B),s=1/l,t=.5*(l-s),i=.5*(l+s),a=Math.sin(this.B*n.x),r=(t*this.singam-a*this.cosgam)/i,Math.abs(Math.abs(r)-1)<fi)throw new Error;g=.5*this.ArB*Math.log((1-r)/(1+r)),s=Math.cos(this.B*n.x),Math.abs(s)<hv?d=this.A*n.x:d=this.ArB*Math.atan2(t*this.cosgam+a*this.singam,s)}else g=n.y>0?this.v_pole_n:this.v_pole_s,d=this.ArB*n.y;return this.no_rot?(e.x=d,e.y=g):(d-=this.u_0,e.x=g*this.cosrot+d*this.sinrot,e.y=d*this.cosrot-g*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function K3(n){var e,t,i,r,a,l,s,d={};if(n.x=(n.x-this.x0)*(1/this.a),n.y=(n.y-this.y0)*(1/this.a),this.no_rot?(t=n.y,e=n.x):(t=n.x*this.cosrot-n.y*this.sinrot,e=n.y*this.cosrot+n.x*this.sinrot+this.u_0),i=Math.exp(-this.BrA*t),r=.5*(i-1/i),a=.5*(i+1/i),l=Math.sin(this.BrA*e),s=(l*this.cosgam+r*this.singam)/a,Math.abs(Math.abs(s)-1)<fi)d.x=0,d.y=s<0?-Bn:Bn;else{if(d.y=this.E/Math.sqrt((1+s)/(1-s)),d.y=V1(this.e,Math.pow(d.y,1/this.B)),d.y===1/0)throw new Error;d.x=-this.rB*Math.atan2(r*this.cosgam-l*this.singam,Math.cos(this.BrA*e))}return d.x+=this.lam0,d}var J3=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const Q3={init:Z3,forward:Y3,inverse:K3,names:J3};function $3(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<fi)){var n=this.b/this.a;this.e=Math.sqrt(1-n*n);var e=Math.sin(this.lat1),t=Math.cos(this.lat1),i=dp(this.e,e,t),r=dd(this.e,this.lat1,e),a=Math.sin(this.lat2),l=Math.cos(this.lat2),s=dp(this.e,a,l),d=dd(this.e,this.lat2,a),g=dd(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>fi?this.ns=Math.log(i/s)/Math.log(r/d):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=i/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(g,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function ek(n){var e=n.x,t=n.y;Math.abs(2*Math.abs(t)-Math.PI)<=fi&&(t=lb(t)*(Bn-2*fi));var i=Math.abs(Math.abs(t)-Bn),r,a;if(i>fi)r=dd(this.e,t,Math.sin(t)),a=this.a*this.f0*Math.pow(r,this.ns);else{if(i=t*this.ns,i<=0)return null;a=0}var l=this.ns*xi(e-this.long0);return n.x=this.k0*(a*Math.sin(l))+this.x0,n.y=this.k0*(this.rh-a*Math.cos(l))+this.y0,n}function tk(n){var e,t,i,r,a,l=(n.x-this.x0)/this.k0,s=this.rh-(n.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(l*l+s*s),t=1):(e=-Math.sqrt(l*l+s*s),t=-1);var d=0;if(e!==0&&(d=Math.atan2(t*l,t*s)),e!==0||this.ns>0){if(t=1/this.ns,i=Math.pow(e/(this.a*this.f0),t),r=V1(this.e,i),r===-9999)return null}else r=-Bn;return a=xi(d/this.ns+this.long0),n.x=a,n.y=r,n}var nk=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const ik={init:$3,forward:ek,inverse:tk,names:nk};function rk(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function sk(n){var e,t,i,r,a,l,s,d=n.x,g=n.y,x=xi(d-this.long0);return e=Math.pow((1+this.e*Math.sin(g))/(1-this.e*Math.sin(g)),this.alfa*this.e/2),t=2*(Math.atan(this.k*Math.pow(Math.tan(g/2+this.s45),this.alfa)/e)-this.s45),i=-x*this.alfa,r=Math.asin(Math.cos(this.ad)*Math.sin(t)+Math.sin(this.ad)*Math.cos(t)*Math.cos(i)),a=Math.asin(Math.cos(t)*Math.sin(i)/Math.cos(r)),l=this.n*a,s=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(r/2+this.s45),this.n),n.y=s*Math.cos(l)/1,n.x=s*Math.sin(l)/1,this.czech||(n.y*=-1,n.x*=-1),n}function ok(n){var e,t,i,r,a,l,s,d,g=n.x;n.x=n.y,n.y=g,this.czech||(n.y*=-1,n.x*=-1),l=Math.sqrt(n.x*n.x+n.y*n.y),a=Math.atan2(n.y,n.x),r=a/Math.sin(this.s0),i=2*(Math.atan(Math.pow(this.ro0/l,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(i)-Math.sin(this.ad)*Math.cos(i)*Math.cos(r)),t=Math.asin(Math.cos(i)*Math.sin(r)/Math.cos(e)),n.x=this.long0-t/this.alfa,s=e,d=0;var x=0;do n.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(s))/(1-this.e*Math.sin(s)),this.e/2))-this.s45),Math.abs(s-n.y)<1e-10&&(d=1),s=n.y,x+=1;while(d===0&&x<15);return x>=15?null:n}var ak=["Krovak","krovak"];const lk={init:rk,forward:sk,inverse:ok,names:ak};function nc(n,e,t,i,r){return n*r-e*Math.sin(2*r)+t*Math.sin(4*r)-i*Math.sin(6*r)}function ub(n){return 1-.25*n*(1+n/16*(3+1.25*n))}function cb(n){return .375*n*(1+.25*n*(1+.46875*n))}function hb(n){return .05859375*n*n*(1+.75*n)}function fb(n){return n*n*n*(35/3072)}function Dv(n,e,t){var i=e*t;return n/Math.sqrt(1-i*i)}function s0(n){return Math.abs(n)<Bn?n:n-lb(n)*Math.PI}function VE(n,e,t,i,r){var a,l;a=n/e;for(var s=0;s<15;s++)if(l=(n-(e*a-t*Math.sin(2*a)+i*Math.sin(4*a)-r*Math.sin(6*a)))/(e-2*t*Math.cos(2*a)+4*i*Math.cos(4*a)-6*r*Math.cos(6*a)),a+=l,Math.abs(l)<=1e-10)return a;return NaN}function uk(){this.sphere||(this.e0=ub(this.es),this.e1=cb(this.es),this.e2=hb(this.es),this.e3=fb(this.es),this.ml0=this.a*nc(this.e0,this.e1,this.e2,this.e3,this.lat0))}function ck(n){var e,t,i=n.x,r=n.y;if(i=xi(i-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(r)*Math.sin(i)),t=this.a*(Math.atan2(Math.tan(r),Math.cos(i))-this.lat0);else{var a=Math.sin(r),l=Math.cos(r),s=Dv(this.a,this.e,a),d=Math.tan(r)*Math.tan(r),g=i*Math.cos(r),x=g*g,I=this.es*l*l/(1-this.es),A=this.a*nc(this.e0,this.e1,this.e2,this.e3,r);e=s*g*(1-x*d*(1/6-(8-d+8*I)*x/120)),t=A-this.ml0+s*a/l*x*(.5+(5-d+6*I)*x/24)}return n.x=e+this.x0,n.y=t+this.y0,n}function hk(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,i,r;if(this.sphere){var a=t+this.lat0;i=Math.asin(Math.sin(a)*Math.cos(e)),r=Math.atan2(Math.tan(e),Math.cos(a))}else{var l=this.ml0/this.a+t,s=VE(l,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(s)-Bn)<=fi)return n.x=this.long0,n.y=Bn,t<0&&(n.y*=-1),n;var d=Dv(this.a,this.e,Math.sin(s)),g=d*d*d/this.a/this.a*(1-this.es),x=Math.pow(Math.tan(s),2),I=e*this.a/d,A=I*I;i=s-d*Math.tan(s)/g*I*I*(.5-(1+3*x)*I*I/24),r=I*(1-A*(x/3+(1+3*x)*x*A/15))/Math.cos(s)}return n.x=xi(r+this.long0),n.y=s0(i),n}var fk=["Cassini","Cassini_Soldner","cass"];const dk={init:uk,forward:ck,inverse:hk,names:fk};function ig(n,e){var t;return n>1e-7?(t=n*e,(1-n*n)*(e/(1-t*t)-.5/n*Math.log((1-t)/(1+t)))):2*e}var pk=1,mk=2,gk=3,_k=4;function yk(){var n=Math.abs(this.lat0);if(Math.abs(n-Bn)<fi?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(n)<fi?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var e;switch(this.qp=ig(this.e,1),this.mmf=.5/(1-this.es),this.apa=Ck(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=ig(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function vk(n){var e,t,i,r,a,l,s,d,g,x,I=n.x,A=n.y;if(I=xi(I-this.long0),this.sphere){if(a=Math.sin(A),x=Math.cos(A),i=Math.cos(I),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t=this.mode===this.EQUIT?1+x*i:1+this.sinph0*a+this.cosph0*x*i,t<=fi)return null;t=Math.sqrt(2/t),e=t*x*Math.sin(I),t*=this.mode===this.EQUIT?a:this.cosph0*a-this.sinph0*x*i}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),Math.abs(A+this.lat0)<fi)return null;t=Vs-A*.5,t=2*(this.mode===this.S_POLE?Math.cos(t):Math.sin(t)),e=t*Math.sin(I),t*=i}}else{switch(s=0,d=0,g=0,i=Math.cos(I),r=Math.sin(I),a=Math.sin(A),l=ig(this.e,a),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(s=l/this.qp,d=Math.sqrt(1-s*s)),this.mode){case this.OBLIQ:g=1+this.sinb1*s+this.cosb1*d*i;break;case this.EQUIT:g=1+d*i;break;case this.N_POLE:g=Bn+A,l=this.qp-l;break;case this.S_POLE:g=A-Bn,l=this.qp+l;break}if(Math.abs(g)<fi)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:g=Math.sqrt(2/g),this.mode===this.OBLIQ?t=this.ymf*g*(this.cosb1*s-this.sinb1*d*i):t=(g=Math.sqrt(2/(1+d*i)))*s*this.ymf,e=this.xmf*g*d*r;break;case this.N_POLE:case this.S_POLE:l>=0?(e=(g=Math.sqrt(l))*r,t=i*(this.mode===this.S_POLE?g:-g)):e=t=0;break}}return n.x=this.a*e+this.x0,n.y=this.a*t+this.y0,n}function bk(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,i,r,a,l,s,d,g;if(this.sphere){var x=0,I,A=0;if(I=Math.sqrt(e*e+t*t),r=I*.5,r>1)return null;switch(r=2*Math.asin(r),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(A=Math.sin(r),x=Math.cos(r)),this.mode){case this.EQUIT:r=Math.abs(I)<=fi?0:Math.asin(t*A/I),e*=A,t=x*I;break;case this.OBLIQ:r=Math.abs(I)<=fi?this.lat0:Math.asin(x*this.sinph0+t*A*this.cosph0/I),e*=A*this.cosph0,t=(x-Math.sin(r)*this.sinph0)*I;break;case this.N_POLE:t=-t,r=Bn-r;break;case this.S_POLE:r-=Bn;break}i=t===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,t)}else{if(g=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,t*=this.dd,d=Math.sqrt(e*e+t*t),d<fi)return n.x=this.long0,n.y=this.lat0,n;l=2*Math.asin(.5*d/this.rq),a=Math.cos(l),e*=l=Math.sin(l),this.mode===this.OBLIQ?(g=a*this.sinb1+t*l*this.cosb1/d,s=this.qp*g,t=d*this.cosb1*a-t*this.sinb1*l):(g=t*l/d,s=this.qp*g,t=d*a)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(t=-t),s=e*e+t*t,!s)return n.x=this.long0,n.y=this.lat0,n;g=1-s/this.qp,this.mode===this.S_POLE&&(g=-g)}i=Math.atan2(e,t),r=Ak(Math.asin(g),this.apa)}return n.x=xi(this.long0+i),n.y=r,n}var xk=.3333333333333333,Ek=.17222222222222222,Ik=.10257936507936508,Tk=.06388888888888888,wk=.0664021164021164,Sk=.016415012942191543;function Ck(n){var e,t=[];return t[0]=n*xk,e=n*n,t[0]+=e*Ek,t[1]=e*Tk,e*=n,t[0]+=e*Ik,t[1]+=e*wk,t[2]=e*Sk,t}function Ak(n,e){var t=n+n;return n+e[0]*Math.sin(t)+e[1]*Math.sin(t+t)+e[2]*Math.sin(t+t+t)}var Mk=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const Lk={init:yk,forward:vk,inverse:bk,names:Mk,S_POLE:pk,N_POLE:mk,EQUIT:gk,OBLIQ:_k};function lg(n){return Math.abs(n)>1&&(n=n>1?1:-1),Math.asin(n)}function Rk(){Math.abs(this.lat1+this.lat2)<fi||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=dp(this.e3,this.sin_po,this.cos_po),this.qs1=ig(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=dp(this.e3,this.sin_po,this.cos_po),this.qs2=ig(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=ig(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>fi?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function Pk(n){var e=n.x,t=n.y;this.sin_phi=Math.sin(t),this.cos_phi=Math.cos(t);var i=ig(this.e3,this.sin_phi),r=this.a*Math.sqrt(this.c-this.ns0*i)/this.ns0,a=this.ns0*xi(e-this.long0),l=r*Math.sin(a)+this.x0,s=this.rh-r*Math.cos(a)+this.y0;return n.x=l,n.y=s,n}function Dk(n){var e,t,i,r,a,l;return n.x-=this.x0,n.y=this.rh-n.y+this.y0,this.ns0>=0?(e=Math.sqrt(n.x*n.x+n.y*n.y),i=1):(e=-Math.sqrt(n.x*n.x+n.y*n.y),i=-1),r=0,e!==0&&(r=Math.atan2(i*n.x,i*n.y)),i=e*this.ns0/this.a,this.sphere?l=Math.asin((this.c-i*i)/(2*this.ns0)):(t=(this.c-i*i)/this.ns0,l=this.phi1z(this.e3,t)),a=xi(r/this.ns0+this.long0),n.x=a,n.y=l,n}function Ok(n,e){var t,i,r,a,l,s=lg(.5*e);if(n<fi)return s;for(var d=n*n,g=1;g<=25;g++)if(t=Math.sin(s),i=Math.cos(s),r=n*t,a=1-r*r,l=.5*a*a/i*(e/(1-d)-t/a+.5/n*Math.log((1-r)/(1+r))),s=s+l,Math.abs(l)<=1e-7)return s;return null}var Nk=["Albers_Conic_Equal_Area","Albers","aea"];const kk={init:Rk,forward:Pk,inverse:Dk,names:Nk,phi1z:Ok};function Fk(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function Bk(n){var e,t,i,r,a,l,s,d,g=n.x,x=n.y;return i=xi(g-this.long0),e=Math.sin(x),t=Math.cos(x),r=Math.cos(i),l=this.sin_p14*e+this.cos_p14*t*r,a=1,l>0||Math.abs(l)<=fi?(s=this.x0+this.a*a*t*Math.sin(i)/l,d=this.y0+this.a*a*(this.cos_p14*e-this.sin_p14*t*r)/l):(s=this.x0+this.infinity_dist*t*Math.sin(i),d=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*t*r)),n.x=s,n.y=d,n}function zk(n){var e,t,i,r,a,l;return n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,(e=Math.sqrt(n.x*n.x+n.y*n.y))?(r=Math.atan2(e,this.rc),t=Math.sin(r),i=Math.cos(r),l=lg(i*this.sin_p14+n.y*t*this.cos_p14/e),a=Math.atan2(n.x*t,e*this.cos_p14*i-n.y*this.sin_p14*t),a=xi(this.long0+a)):(l=this.phic0,a=0),n.x=a,n.y=l,n}var Uk=["gnom"];const Vk={init:Fk,forward:Bk,inverse:zk,names:Uk};function Gk(n,e){var t=1-(1-n*n)/(2*n)*Math.log((1-n)/(1+n));if(Math.abs(Math.abs(e)-t)<1e-6)return e<0?-1*Bn:Bn;for(var i=Math.asin(.5*e),r,a,l,s,d=0;d<30;d++)if(a=Math.sin(i),l=Math.cos(i),s=n*a,r=Math.pow(1-s*s,2)/(2*l)*(e/(1-n*n)-a/(1-s*s)+.5/n*Math.log((1-s)/(1+s))),i+=r,Math.abs(r)<=1e-10)return i;return NaN}function Hk(){this.sphere||(this.k0=dp(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function jk(n){var e=n.x,t=n.y,i,r,a=xi(e-this.long0);if(this.sphere)i=this.x0+this.a*a*Math.cos(this.lat_ts),r=this.y0+this.a*Math.sin(t)/Math.cos(this.lat_ts);else{var l=ig(this.e,Math.sin(t));i=this.x0+this.a*this.k0*a,r=this.y0+this.a*l*.5/this.k0}return n.x=i,n.y=r,n}function qk(n){n.x-=this.x0,n.y-=this.y0;var e,t;return this.sphere?(e=xi(this.long0+n.x/this.a/Math.cos(this.lat_ts)),t=Math.asin(n.y/this.a*Math.cos(this.lat_ts))):(t=Gk(this.e,2*n.y*this.k0/this.a),e=xi(this.long0+n.x/(this.a*this.k0))),n.x=e,n.y=t,n}var Wk=["cea"];const Xk={init:Hk,forward:jk,inverse:qk,names:Wk};function Zk(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function Yk(n){var e=n.x,t=n.y,i=xi(e-this.long0),r=s0(t-this.lat0);return n.x=this.x0+this.a*i*this.rc,n.y=this.y0+this.a*r,n}function Kk(n){var e=n.x,t=n.y;return n.x=xi(this.long0+(e-this.x0)/(this.a*this.rc)),n.y=s0(this.lat0+(t-this.y0)/this.a),n}var Jk=["Equirectangular","Equidistant_Cylindrical","eqc"];const Qk={init:Zk,forward:Yk,inverse:Kk,names:Jk};var f2=20;function $k(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=ub(this.es),this.e1=cb(this.es),this.e2=hb(this.es),this.e3=fb(this.es),this.ml0=this.a*nc(this.e0,this.e1,this.e2,this.e3,this.lat0)}function eF(n){var e=n.x,t=n.y,i,r,a,l=xi(e-this.long0);if(a=l*Math.sin(t),this.sphere)Math.abs(t)<=fi?(i=this.a*l,r=-1*this.a*this.lat0):(i=this.a*Math.sin(a)/Math.tan(t),r=this.a*(s0(t-this.lat0)+(1-Math.cos(a))/Math.tan(t)));else if(Math.abs(t)<=fi)i=this.a*l,r=-1*this.ml0;else{var s=Dv(this.a,this.e,Math.sin(t))/Math.tan(t);i=s*Math.sin(a),r=this.a*nc(this.e0,this.e1,this.e2,this.e3,t)-this.ml0+s*(1-Math.cos(a))}return n.x=i+this.x0,n.y=r+this.y0,n}function tF(n){var e,t,i,r,a,l,s,d,g;if(i=n.x-this.x0,r=n.y-this.y0,this.sphere)if(Math.abs(r+this.a*this.lat0)<=fi)e=xi(i/this.a+this.long0),t=0;else{l=this.lat0+r/this.a,s=i*i/this.a/this.a+l*l,d=l;var x;for(a=f2;a;--a)if(x=Math.tan(d),g=-1*(l*(d*x+1)-d-.5*(d*d+s)*x)/((d-l)/x-1),d+=g,Math.abs(g)<=fi){t=d;break}e=xi(this.long0+Math.asin(i*Math.tan(d)/this.a)/Math.sin(t))}else if(Math.abs(r+this.ml0)<=fi)t=0,e=xi(this.long0+i/this.a);else{l=(this.ml0+r)/this.a,s=i*i/this.a/this.a+l*l,d=l;var I,A,L,N,B;for(a=f2;a;--a)if(B=this.e*Math.sin(d),I=Math.sqrt(1-B*B)*Math.tan(d),A=this.a*nc(this.e0,this.e1,this.e2,this.e3,d),L=this.e0-2*this.e1*Math.cos(2*d)+4*this.e2*Math.cos(4*d)-6*this.e3*Math.cos(6*d),N=A/this.a,g=(l*(I*N+1)-N-.5*I*(N*N+s))/(this.es*Math.sin(2*d)*(N*N+s-2*l*N)/(4*I)+(l-N)*(I*L-2/Math.sin(2*d))-L),d-=g,Math.abs(g)<=fi){t=d;break}I=Math.sqrt(1-this.es*Math.pow(Math.sin(t),2))*Math.tan(t),e=xi(this.long0+Math.asin(i*I/this.a)/Math.sin(t))}return n.x=e,n.y=t,n}var nF=["Polyconic","poly"];const iF={init:$k,forward:eF,inverse:tF,names:nF};function rF(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function sF(n){var e,t=n.x,i=n.y,r=i-this.lat0,a=t-this.long0,l=r/N1*1e-5,s=a,d=1,g=0;for(e=1;e<=10;e++)d=d*l,g=g+this.A[e]*d;var x=g,I=s,A=1,L=0,N,B,F=0,z=0;for(e=1;e<=6;e++)N=A*x-L*I,B=L*x+A*I,A=N,L=B,F=F+this.B_re[e]*A-this.B_im[e]*L,z=z+this.B_im[e]*A+this.B_re[e]*L;return n.x=z*this.a+this.x0,n.y=F*this.a+this.y0,n}function oF(n){var e,t=n.x,i=n.y,r=t-this.x0,a=i-this.y0,l=a/this.a,s=r/this.a,d=1,g=0,x,I,A=0,L=0;for(e=1;e<=6;e++)x=d*l-g*s,I=g*l+d*s,d=x,g=I,A=A+this.C_re[e]*d-this.C_im[e]*g,L=L+this.C_im[e]*d+this.C_re[e]*g;for(var N=0;N<this.iterations;N++){var B=A,F=L,z,V,Y=l,Q=s;for(e=2;e<=6;e++)z=B*A-F*L,V=F*A+B*L,B=z,F=V,Y=Y+(e-1)*(this.B_re[e]*B-this.B_im[e]*F),Q=Q+(e-1)*(this.B_im[e]*B+this.B_re[e]*F);B=1,F=0;var J=this.B_re[1],he=this.B_im[1];for(e=2;e<=6;e++)z=B*A-F*L,V=F*A+B*L,B=z,F=V,J=J+e*(this.B_re[e]*B-this.B_im[e]*F),he=he+e*(this.B_im[e]*B+this.B_re[e]*F);var ee=J*J+he*he;A=(Y*J+Q*he)/ee,L=(Q*J-Y*he)/ee}var ae=A,De=L,fe=1,le=0;for(e=1;e<=9;e++)fe=fe*ae,le=le+this.D[e]*fe;var Be=this.lat0+le*N1*1e5,Pe=this.long0+De;return n.x=Pe,n.y=Be,n}var aF=["New_Zealand_Map_Grid","nzmg"];const lF={init:rF,forward:sF,inverse:oF,names:aF};function uF(){}function cF(n){var e=n.x,t=n.y,i=xi(e-this.long0),r=this.x0+this.a*i,a=this.y0+this.a*Math.log(Math.tan(Math.PI/4+t/2.5))*1.25;return n.x=r,n.y=a,n}function hF(n){n.x-=this.x0,n.y-=this.y0;var e=xi(this.long0+n.x/this.a),t=2.5*(Math.atan(Math.exp(.8*n.y/this.a))-Math.PI/4);return n.x=e,n.y=t,n}var fF=["Miller_Cylindrical","mill"];const dF={init:uF,forward:cF,inverse:hF,names:fF};var pF=20;function mF(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=HL(this.es)}function gF(n){var e,t,i=n.x,r=n.y;if(i=xi(i-this.long0),this.sphere){if(!this.m)r=this.n!==1?Math.asin(this.n*Math.sin(r)):r;else for(var a=this.n*Math.sin(r),l=pF;l;--l){var s=(this.m*r+Math.sin(r)-a)/(this.m+Math.cos(r));if(r-=s,Math.abs(s)<fi)break}e=this.a*this.C_x*i*(this.m+Math.cos(r)),t=this.a*this.C_y*r}else{var d=Math.sin(r),g=Math.cos(r);t=this.a*dI(r,d,g,this.en),e=this.a*i*g/Math.sqrt(1-this.es*d*d)}return n.x=e,n.y=t,n}function _F(n){var e,t,i,r;return n.x-=this.x0,i=n.x/this.a,n.y-=this.y0,e=n.y/this.a,this.sphere?(e/=this.C_y,i=i/(this.C_x*(this.m+Math.cos(e))),this.m?e=lg((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=lg(Math.sin(e)/this.n)),i=xi(i+this.long0),e=s0(e)):(e=jL(n.y/this.a,this.es,this.en),r=Math.abs(e),r<Bn?(r=Math.sin(e),t=this.long0+n.x*Math.sqrt(1-this.es*r*r)/(this.a*Math.cos(e)),i=xi(t)):r-fi<Bn&&(i=this.long0)),n.x=i,n.y=e,n}var yF=["Sinusoidal","sinu"];const vF={init:mF,forward:gF,inverse:_F,names:yF};function bF(){}function xF(n){for(var e=n.x,t=n.y,i=xi(e-this.long0),r=t,a=Math.PI*Math.sin(t);;){var l=-(r+Math.sin(r)-a)/(1+Math.cos(r));if(r+=l,Math.abs(l)<fi)break}r/=2,Math.PI/2-Math.abs(t)<fi&&(i=0);var s=.900316316158*this.a*i*Math.cos(r)+this.x0,d=1.4142135623731*this.a*Math.sin(r)+this.y0;return n.x=s,n.y=d,n}function EF(n){var e,t;n.x-=this.x0,n.y-=this.y0,t=n.y/(1.4142135623731*this.a),Math.abs(t)>.999999999999&&(t=.999999999999),e=Math.asin(t);var i=xi(this.long0+n.x/(.900316316158*this.a*Math.cos(e)));i<-Math.PI&&(i=-Math.PI),i>Math.PI&&(i=Math.PI),t=(2*e+Math.sin(2*e))/Math.PI,Math.abs(t)>1&&(t=1);var r=Math.asin(t);return n.x=i,n.y=r,n}var IF=["Mollweide","moll"];const TF={init:bF,forward:xF,inverse:EF,names:IF};function wF(){Math.abs(this.lat1+this.lat2)<fi||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=ub(this.es),this.e1=cb(this.es),this.e2=hb(this.es),this.e3=fb(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=dp(this.e,this.sinphi,this.cosphi),this.ml1=nc(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<fi?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=dp(this.e,this.sinphi,this.cosphi),this.ml2=nc(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=nc(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function SF(n){var e=n.x,t=n.y,i;if(this.sphere)i=this.a*(this.g-t);else{var r=nc(this.e0,this.e1,this.e2,this.e3,t);i=this.a*(this.g-r)}var a=this.ns*xi(e-this.long0),l=this.x0+i*Math.sin(a),s=this.y0+this.rh-i*Math.cos(a);return n.x=l,n.y=s,n}function CF(n){n.x-=this.x0,n.y=this.rh-n.y+this.y0;var e,t,i,r;this.ns>=0?(t=Math.sqrt(n.x*n.x+n.y*n.y),e=1):(t=-Math.sqrt(n.x*n.x+n.y*n.y),e=-1);var a=0;if(t!==0&&(a=Math.atan2(e*n.x,e*n.y)),this.sphere)return r=xi(this.long0+a/this.ns),i=s0(this.g-t/this.a),n.x=r,n.y=i,n;var l=this.g-t/this.a;return i=VE(l,this.e0,this.e1,this.e2,this.e3),r=xi(this.long0+a/this.ns),n.x=r,n.y=i,n}var AF=["Equidistant_Conic","eqdc"];const MF={init:wF,forward:SF,inverse:CF,names:AF};function LF(){this.R=this.a}function RF(n){var e=n.x,t=n.y,i=xi(e-this.long0),r,a;Math.abs(t)<=fi&&(r=this.x0+this.R*i,a=this.y0);var l=lg(2*Math.abs(t/Math.PI));(Math.abs(i)<=fi||Math.abs(Math.abs(t)-Bn)<=fi)&&(r=this.x0,t>=0?a=this.y0+Math.PI*this.R*Math.tan(.5*l):a=this.y0+Math.PI*this.R*-Math.tan(.5*l));var s=.5*Math.abs(Math.PI/i-i/Math.PI),d=s*s,g=Math.sin(l),x=Math.cos(l),I=x/(g+x-1),A=I*I,L=I*(2/g-1),N=L*L,B=Math.PI*this.R*(s*(I-N)+Math.sqrt(d*(I-N)*(I-N)-(N+d)*(A-N)))/(N+d);i<0&&(B=-B),r=this.x0+B;var F=d+I;return B=Math.PI*this.R*(L*F-s*Math.sqrt((N+d)*(d+1)-F*F))/(N+d),t>=0?a=this.y0+B:a=this.y0-B,n.x=r,n.y=a,n}function PF(n){var e,t,i,r,a,l,s,d,g,x,I,A,L;return n.x-=this.x0,n.y-=this.y0,I=Math.PI*this.R,i=n.x/I,r=n.y/I,a=i*i+r*r,l=-Math.abs(r)*(1+a),s=l-2*r*r+i*i,d=-2*l+1+2*r*r+a*a,L=r*r/d+(2*s*s*s/d/d/d-9*l*s/d/d)/27,g=(l-s*s/3/d)/d,x=2*Math.sqrt(-g/3),I=3*L/g/x,Math.abs(I)>1&&(I>=0?I=1:I=-1),A=Math.acos(I)/3,n.y>=0?t=(-x*Math.cos(A+Math.PI/3)-s/3/d)*Math.PI:t=-(-x*Math.cos(A+Math.PI/3)-s/3/d)*Math.PI,Math.abs(i)<fi?e=this.long0:e=xi(this.long0+Math.PI*(a-1+Math.sqrt(1+2*(i*i-r*r)+a*a))/2/i),n.x=e,n.y=t,n}var DF=["Van_der_Grinten_I","VanDerGrinten","vandg"];const OF={init:LF,forward:RF,inverse:PF,names:DF};function NF(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)}function kF(n){var e=n.x,t=n.y,i=Math.sin(n.y),r=Math.cos(n.y),a=xi(e-this.long0),l,s,d,g,x,I,A,L,N,B,F,z,V,Y,Q,J,he,ee,ae,De,fe,le,Be;return this.sphere?Math.abs(this.sin_p12-1)<=fi?(n.x=this.x0+this.a*(Bn-t)*Math.sin(a),n.y=this.y0-this.a*(Bn-t)*Math.cos(a),n):Math.abs(this.sin_p12+1)<=fi?(n.x=this.x0+this.a*(Bn+t)*Math.sin(a),n.y=this.y0+this.a*(Bn+t)*Math.cos(a),n):(ee=this.sin_p12*i+this.cos_p12*r*Math.cos(a),J=Math.acos(ee),he=J?J/Math.sin(J):1,n.x=this.x0+this.a*he*r*Math.sin(a),n.y=this.y0+this.a*he*(this.cos_p12*i-this.sin_p12*r*Math.cos(a)),n):(l=ub(this.es),s=cb(this.es),d=hb(this.es),g=fb(this.es),Math.abs(this.sin_p12-1)<=fi?(x=this.a*nc(l,s,d,g,Bn),I=this.a*nc(l,s,d,g,t),n.x=this.x0+(x-I)*Math.sin(a),n.y=this.y0-(x-I)*Math.cos(a),n):Math.abs(this.sin_p12+1)<=fi?(x=this.a*nc(l,s,d,g,Bn),I=this.a*nc(l,s,d,g,t),n.x=this.x0+(x+I)*Math.sin(a),n.y=this.y0+(x+I)*Math.cos(a),n):(A=i/r,L=Dv(this.a,this.e,this.sin_p12),N=Dv(this.a,this.e,i),B=Math.atan((1-this.es)*A+this.es*L*this.sin_p12/(N*r)),F=Math.atan2(Math.sin(a),this.cos_p12*Math.tan(B)-this.sin_p12*Math.cos(a)),F===0?ae=Math.asin(this.cos_p12*Math.sin(B)-this.sin_p12*Math.cos(B)):Math.abs(Math.abs(F)-Math.PI)<=fi?ae=-Math.asin(this.cos_p12*Math.sin(B)-this.sin_p12*Math.cos(B)):ae=Math.asin(Math.sin(a)*Math.cos(B)/Math.sin(F)),z=this.e*this.sin_p12/Math.sqrt(1-this.es),V=this.e*this.cos_p12*Math.cos(F)/Math.sqrt(1-this.es),Y=z*V,Q=V*V,De=ae*ae,fe=De*ae,le=fe*ae,Be=le*ae,J=L*ae*(1-De*Q*(1-Q)/6+fe/8*Y*(1-2*Q)+le/120*(Q*(4-7*Q)-3*z*z*(1-7*Q))-Be/48*Y),n.x=this.x0+J*Math.sin(F),n.y=this.y0+J*Math.cos(F),n))}function FF(n){n.x-=this.x0,n.y-=this.y0;var e,t,i,r,a,l,s,d,g,x,I,A,L,N,B,F,z,V,Y,Q,J,he,ee,ae;return this.sphere?(e=Math.sqrt(n.x*n.x+n.y*n.y),e>2*Bn*this.a?void 0:(t=e/this.a,i=Math.sin(t),r=Math.cos(t),a=this.long0,Math.abs(e)<=fi?l=this.lat0:(l=lg(r*this.sin_p12+n.y*i*this.cos_p12/e),s=Math.abs(this.lat0)-Bn,Math.abs(s)<=fi?this.lat0>=0?a=xi(this.long0+Math.atan2(n.x,-n.y)):a=xi(this.long0-Math.atan2(-n.x,n.y)):a=xi(this.long0+Math.atan2(n.x*i,e*this.cos_p12*r-n.y*this.sin_p12*i))),n.x=a,n.y=l,n)):(d=ub(this.es),g=cb(this.es),x=hb(this.es),I=fb(this.es),Math.abs(this.sin_p12-1)<=fi?(A=this.a*nc(d,g,x,I,Bn),e=Math.sqrt(n.x*n.x+n.y*n.y),L=A-e,l=VE(L/this.a,d,g,x,I),a=xi(this.long0+Math.atan2(n.x,-1*n.y)),n.x=a,n.y=l,n):Math.abs(this.sin_p12+1)<=fi?(A=this.a*nc(d,g,x,I,Bn),e=Math.sqrt(n.x*n.x+n.y*n.y),L=e-A,l=VE(L/this.a,d,g,x,I),a=xi(this.long0+Math.atan2(n.x,n.y)),n.x=a,n.y=l,n):(e=Math.sqrt(n.x*n.x+n.y*n.y),F=Math.atan2(n.x,n.y),N=Dv(this.a,this.e,this.sin_p12),z=Math.cos(F),V=this.e*this.cos_p12*z,Y=-V*V/(1-this.es),Q=3*this.es*(1-Y)*this.sin_p12*this.cos_p12*z/(1-this.es),J=e/N,he=J-Y*(1+Y)*Math.pow(J,3)/6-Q*(1+3*Y)*Math.pow(J,4)/24,ee=1-Y*he*he/2-J*he*he*he/6,B=Math.asin(this.sin_p12*Math.cos(he)+this.cos_p12*Math.sin(he)*z),a=xi(this.long0+Math.asin(Math.sin(F)*Math.sin(he)/Math.cos(B))),ae=Math.sin(B),l=Math.atan2((ae-this.es*ee*this.sin_p12)*Math.tan(B),ae*(1-this.es)),n.x=a,n.y=l,n))}var BF=["Azimuthal_Equidistant","aeqd"];const zF={init:NF,forward:kF,inverse:FF,names:BF};function UF(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function VF(n){var e,t,i,r,a,l,s,d,g=n.x,x=n.y;return i=xi(g-this.long0),e=Math.sin(x),t=Math.cos(x),r=Math.cos(i),l=this.sin_p14*e+this.cos_p14*t*r,a=1,(l>0||Math.abs(l)<=fi)&&(s=this.a*a*t*Math.sin(i),d=this.y0+this.a*a*(this.cos_p14*e-this.sin_p14*t*r)),n.x=s,n.y=d,n}function GF(n){var e,t,i,r,a,l,s;return n.x-=this.x0,n.y-=this.y0,e=Math.sqrt(n.x*n.x+n.y*n.y),t=lg(e/this.a),i=Math.sin(t),r=Math.cos(t),l=this.long0,Math.abs(e)<=fi?(s=this.lat0,n.x=l,n.y=s,n):(s=lg(r*this.sin_p14+n.y*i*this.cos_p14/e),a=Math.abs(this.lat0)-Bn,Math.abs(a)<=fi?(this.lat0>=0?l=xi(this.long0+Math.atan2(n.x,-n.y)):l=xi(this.long0-Math.atan2(-n.x,n.y)),n.x=l,n.y=s,n):(l=xi(this.long0+Math.atan2(n.x*i,e*this.cos_p14*r-n.y*this.sin_p14*i)),n.x=l,n.y=s,n))}var HF=["ortho"];const jF={init:UF,forward:VF,inverse:GF,names:HF};var ea={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Gs={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function qF(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=Bn-Vs/2?this.face=ea.TOP:this.lat0<=-(Bn-Vs/2)?this.face=ea.BOTTOM:Math.abs(this.long0)<=Vs?this.face=ea.FRONT:Math.abs(this.long0)<=Bn+Vs?this.face=this.long0>0?ea.RIGHT:ea.LEFT:this.face=ea.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function WF(n){var e={x:0,y:0},t,i,r,a,l,s,d={value:0};if(n.x-=this.long0,this.es!==0?t=Math.atan(this.one_minus_f_squared*Math.tan(n.y)):t=n.y,i=n.x,this.face===ea.TOP)a=Bn-t,i>=Vs&&i<=Bn+Vs?(d.value=Gs.AREA_0,r=i-Bn):i>Bn+Vs||i<=-(Bn+Vs)?(d.value=Gs.AREA_1,r=i>0?i-Ta:i+Ta):i>-(Bn+Vs)&&i<=-Vs?(d.value=Gs.AREA_2,r=i+Bn):(d.value=Gs.AREA_3,r=i);else if(this.face===ea.BOTTOM)a=Bn+t,i>=Vs&&i<=Bn+Vs?(d.value=Gs.AREA_0,r=-i+Bn):i<Vs&&i>=-Vs?(d.value=Gs.AREA_1,r=-i):i<-Vs&&i>=-(Bn+Vs)?(d.value=Gs.AREA_2,r=-i-Bn):(d.value=Gs.AREA_3,r=i>0?-i+Ta:-i-Ta);else{var g,x,I,A,L,N,B;this.face===ea.RIGHT?i=Tv(i,+Bn):this.face===ea.BACK?i=Tv(i,+Ta):this.face===ea.LEFT&&(i=Tv(i,-Bn)),A=Math.sin(t),L=Math.cos(t),N=Math.sin(i),B=Math.cos(i),g=L*B,x=L*N,I=A,this.face===ea.FRONT?(a=Math.acos(g),r=pE(a,I,x,d)):this.face===ea.RIGHT?(a=Math.acos(x),r=pE(a,I,-g,d)):this.face===ea.BACK?(a=Math.acos(-g),r=pE(a,I,-x,d)):this.face===ea.LEFT?(a=Math.acos(-x),r=pE(a,I,g,d)):(a=r=0,d.value=Gs.AREA_0)}return s=Math.atan(12/Ta*(r+Math.acos(Math.sin(r)*Math.cos(Vs))-Bn)),l=Math.sqrt((1-Math.cos(a))/(Math.cos(s)*Math.cos(s))/(1-Math.cos(Math.atan(1/Math.cos(r))))),d.value===Gs.AREA_1?s+=Bn:d.value===Gs.AREA_2?s+=Ta:d.value===Gs.AREA_3&&(s+=1.5*Ta),e.x=l*Math.cos(s),e.y=l*Math.sin(s),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,n.x=e.x,n.y=e.y,n}function XF(n){var e={lam:0,phi:0},t,i,r,a,l,s,d,g,x,I={value:0};if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,i=Math.atan(Math.sqrt(n.x*n.x+n.y*n.y)),t=Math.atan2(n.y,n.x),n.x>=0&&n.x>=Math.abs(n.y)?I.value=Gs.AREA_0:n.y>=0&&n.y>=Math.abs(n.x)?(I.value=Gs.AREA_1,t-=Bn):n.x<0&&-n.x>=Math.abs(n.y)?(I.value=Gs.AREA_2,t=t<0?t+Ta:t-Ta):(I.value=Gs.AREA_3,t+=Bn),x=Ta/12*Math.tan(t),l=Math.sin(x)/(Math.cos(x)-1/Math.sqrt(2)),s=Math.atan(l),r=Math.cos(t),a=Math.tan(i),d=1-r*r*a*a*(1-Math.cos(Math.atan(1/Math.cos(s)))),d<-1?d=-1:d>1&&(d=1),this.face===ea.TOP)g=Math.acos(d),e.phi=Bn-g,I.value===Gs.AREA_0?e.lam=s+Bn:I.value===Gs.AREA_1?e.lam=s<0?s+Ta:s-Ta:I.value===Gs.AREA_2?e.lam=s-Bn:e.lam=s;else if(this.face===ea.BOTTOM)g=Math.acos(d),e.phi=g-Bn,I.value===Gs.AREA_0?e.lam=-s+Bn:I.value===Gs.AREA_1?e.lam=-s:I.value===Gs.AREA_2?e.lam=-s-Bn:e.lam=s<0?-s-Ta:-s+Ta;else{var A,L,N;A=d,x=A*A,x>=1?N=0:N=Math.sqrt(1-x)*Math.sin(s),x+=N*N,x>=1?L=0:L=Math.sqrt(1-x),I.value===Gs.AREA_1?(x=L,L=-N,N=x):I.value===Gs.AREA_2?(L=-L,N=-N):I.value===Gs.AREA_3&&(x=L,L=N,N=-x),this.face===ea.RIGHT?(x=A,A=-L,L=x):this.face===ea.BACK?(A=-A,L=-L):this.face===ea.LEFT&&(x=A,A=L,L=-x),e.phi=Math.acos(-N)-Bn,e.lam=Math.atan2(L,A),this.face===ea.RIGHT?e.lam=Tv(e.lam,-Bn):this.face===ea.BACK?e.lam=Tv(e.lam,-Ta):this.face===ea.LEFT&&(e.lam=Tv(e.lam,+Bn))}if(this.es!==0){var B,F,z;B=e.phi<0?1:0,F=Math.tan(e.phi),z=this.b/Math.sqrt(F*F+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-z*z)/(this.one_minus_f*z)),B&&(e.phi=-e.phi)}return e.lam+=this.long0,n.x=e.lam,n.y=e.phi,n}function pE(n,e,t,i){var r;return n<fi?(i.value=Gs.AREA_0,r=0):(r=Math.atan2(e,t),Math.abs(r)<=Vs?i.value=Gs.AREA_0:r>Vs&&r<=Bn+Vs?(i.value=Gs.AREA_1,r-=Bn):r>Bn+Vs||r<=-(Bn+Vs)?(i.value=Gs.AREA_2,r=r>=0?r-Ta:r+Ta):(i.value=Gs.AREA_3,r+=Bn)),r}function Tv(n,e){var t=n+e;return t<-Ta?t+=z1:t>+Ta&&(t-=z1),t}var ZF=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const YF={init:qF,forward:WF,inverse:XF,names:ZF};var $w=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],R1=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],XL=.8487,ZL=1.3523,YL=lp/5,KF=1/YL,mv=18,GE=function(n,e){return n[0]+e*(n[1]+e*(n[2]+e*n[3]))},JF=function(n,e){return n[1]+e*(2*n[2]+e*3*n[3])};function QF(n,e,t,i){for(var r=e;i;--i){var a=n(r);if(r-=a,Math.abs(a)<t)break}return r}function $F(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function e4(n){var e=xi(n.x-this.long0),t=Math.abs(n.y),i=Math.floor(t*YL);i<0?i=0:i>=mv&&(i=mv-1),t=lp*(t-KF*i);var r={x:GE($w[i],t)*e,y:GE(R1[i],t)};return n.y<0&&(r.y=-r.y),r.x=r.x*this.a*XL+this.x0,r.y=r.y*this.a*ZL+this.y0,r}function t4(n){var e={x:(n.x-this.x0)/(this.a*XL),y:Math.abs(n.y-this.y0)/(this.a*ZL)};if(e.y>=1)e.x/=$w[mv][0],e.y=n.y<0?-Bn:Bn;else{var t=Math.floor(e.y*mv);for(t<0?t=0:t>=mv&&(t=mv-1);;)if(R1[t][0]>e.y)--t;else if(R1[t+1][0]<=e.y)++t;else break;var i=R1[t],r=5*(e.y-i[0])/(R1[t+1][0]-i[0]);r=QF(function(a){return(GE(i,a)-e.y)/JF(i,a)},r,fi,100),e.x/=GE($w[t],r),e.y=(5*t+r)*eu,n.y<0&&(e.y=-e.y)}return e.x=xi(e.x+this.long0),e}var n4=["Robinson","robin"];const i4={init:$F,forward:e4,inverse:t4,names:n4};function r4(){this.name="geocent"}function s4(n){var e=OL(n,this.es,this.a);return e}function o4(n){var e=NL(n,this.es,this.a,this.b);return e}var a4=["Geocentric","geocentric","geocent","Geocent"];const l4={init:r4,forward:s4,inverse:o4,names:a4};var Tu={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},v1={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function u4(){if(Object.keys(v1).forEach(function(t){if(typeof this[t]>"u")this[t]=v1[t].def;else{if(v1[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);v1[t].num&&(this[t]=parseFloat(this[t]))}v1[t].degrees&&(this[t]=this[t]*eu)}.bind(this)),Math.abs(Math.abs(this.lat0)-Bn)<fi?this.mode=this.lat0<0?Tu.S_POLE:Tu.N_POLE:Math.abs(this.lat0)<fi?this.mode=Tu.EQUIT:(this.mode=Tu.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var n=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(n),this.sw=Math.sin(n)}function c4(n){n.x-=this.long0;var e=Math.sin(n.y),t=Math.cos(n.y),i=Math.cos(n.x),r,a;switch(this.mode){case Tu.OBLIQ:a=this.sinph0*e+this.cosph0*t*i;break;case Tu.EQUIT:a=t*i;break;case Tu.S_POLE:a=-e;break;case Tu.N_POLE:a=e;break}switch(a=this.pn1/(this.p-a),r=a*t*Math.sin(n.x),this.mode){case Tu.OBLIQ:a*=this.cosph0*e-this.sinph0*t*i;break;case Tu.EQUIT:a*=e;break;case Tu.N_POLE:a*=-(t*i);break;case Tu.S_POLE:a*=t*i;break}var l,s;return l=a*this.cg+r*this.sg,s=1/(l*this.sw*this.h1+this.cw),r=(r*this.cg-a*this.sg)*this.cw*s,a=l*s,n.x=r*this.a,n.y=a*this.a,n}function h4(n){n.x/=this.a,n.y/=this.a;var e={x:n.x,y:n.y},t,i,r;r=1/(this.pn1-n.y*this.sw),t=this.pn1*n.x*r,i=this.pn1*n.y*this.cw*r,n.x=t*this.cg+i*this.sg,n.y=i*this.cg-t*this.sg;var a=cd(n.x,n.y);if(Math.abs(a)<fi)e.x=0,e.y=n.y;else{var l,s;switch(s=1-a*a*this.pfact,s=(this.p-Math.sqrt(s))/(this.pn1/a+a/this.pn1),l=Math.sqrt(1-s*s),this.mode){case Tu.OBLIQ:e.y=Math.asin(l*this.sinph0+n.y*s*this.cosph0/a),n.y=(l-this.sinph0*Math.sin(e.y))*a,n.x*=s*this.cosph0;break;case Tu.EQUIT:e.y=Math.asin(n.y*s/a),n.y=l*a,n.x*=s;break;case Tu.N_POLE:e.y=Math.asin(l),n.y=-n.y;break;case Tu.S_POLE:e.y=-Math.asin(l);break}e.x=Math.atan2(n.x,n.y)}return n.x=e.x+this.long0,n.y=e.y,n}var f4=["Tilted_Perspective","tpers"];const d4={init:u4,forward:c4,inverse:h4,names:f4};function p4(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var n=1-this.es,e=1/n;this.radius_p=Math.sqrt(n),this.radius_p2=n,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function m4(n){var e=n.x,t=n.y,i,r,a,l;if(e=e-this.long0,this.shape==="ellipse"){t=Math.atan(this.radius_p2*Math.tan(t));var s=this.radius_p/cd(this.radius_p*Math.cos(t),Math.sin(t));if(r=s*Math.cos(e)*Math.cos(t),a=s*Math.sin(e)*Math.cos(t),l=s*Math.sin(t),(this.radius_g-r)*r-a*a-l*l*this.radius_p_inv2<0)return n.x=Number.NaN,n.y=Number.NaN,n;i=this.radius_g-r,this.flip_axis?(n.x=this.radius_g_1*Math.atan(a/cd(l,i)),n.y=this.radius_g_1*Math.atan(l/i)):(n.x=this.radius_g_1*Math.atan(a/i),n.y=this.radius_g_1*Math.atan(l/cd(a,i)))}else this.shape==="sphere"&&(i=Math.cos(t),r=Math.cos(e)*i,a=Math.sin(e)*i,l=Math.sin(t),i=this.radius_g-r,this.flip_axis?(n.x=this.radius_g_1*Math.atan(a/cd(l,i)),n.y=this.radius_g_1*Math.atan(l/i)):(n.x=this.radius_g_1*Math.atan(a/i),n.y=this.radius_g_1*Math.atan(l/cd(a,i))));return n.x=n.x*this.a,n.y=n.y*this.a,n}function g4(n){var e=-1,t=0,i=0,r,a,l,s;if(n.x=n.x/this.a,n.y=n.y/this.a,this.shape==="ellipse"){this.flip_axis?(i=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*cd(1,i)):(t=Math.tan(n.x/this.radius_g_1),i=Math.tan(n.y/this.radius_g_1)*cd(1,t));var d=i/this.radius_p;if(r=t*t+d*d+e*e,a=2*this.radius_g*e,l=a*a-4*r*this.C,l<0)return n.x=Number.NaN,n.y=Number.NaN,n;s=(-a-Math.sqrt(l))/(2*r),e=this.radius_g+s*e,t*=s,i*=s,n.x=Math.atan2(t,e),n.y=Math.atan(i*Math.cos(n.x)/e),n.y=Math.atan(this.radius_p_inv2*Math.tan(n.y))}else if(this.shape==="sphere"){if(this.flip_axis?(i=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Math.sqrt(1+i*i)):(t=Math.tan(n.x/this.radius_g_1),i=Math.tan(n.y/this.radius_g_1)*Math.sqrt(1+t*t)),r=t*t+i*i+e*e,a=2*this.radius_g*e,l=a*a-4*r*this.C,l<0)return n.x=Number.NaN,n.y=Number.NaN,n;s=(-a-Math.sqrt(l))/(2*r),e=this.radius_g+s*e,t*=s,i*=s,n.x=Math.atan2(t,e),n.y=Math.atan(i*Math.cos(n.x)/e)}return n.x=n.x+this.long0,n}var _4=["Geostationary Satellite View","Geostationary_Satellite","geos"];const y4={init:p4,forward:m4,inverse:g4,names:_4};function v4(n){n.Proj.projections.add(AE),n.Proj.projections.add(ME),n.Proj.projections.add(w3),n.Proj.projections.add(N3),n.Proj.projections.add(V3),n.Proj.projections.add(W3),n.Proj.projections.add(Q3),n.Proj.projections.add(ik),n.Proj.projections.add(lk),n.Proj.projections.add(dk),n.Proj.projections.add(Lk),n.Proj.projections.add(kk),n.Proj.projections.add(Vk),n.Proj.projections.add(Xk),n.Proj.projections.add(Qk),n.Proj.projections.add(iF),n.Proj.projections.add(lF),n.Proj.projections.add(dF),n.Proj.projections.add(vF),n.Proj.projections.add(TF),n.Proj.projections.add(MF),n.Proj.projections.add(OF),n.Proj.projections.add(zF),n.Proj.projections.add(jF),n.Proj.projections.add(YF),n.Proj.projections.add(i4),n.Proj.projections.add(l4),n.Proj.projections.add(d4),n.Proj.projections.add(y4)}rc.defaultDatum="WGS84";rc.Proj=hp;rc.WGS84=new rc.Proj("WGS84");rc.Point=Pv;rc.toPoint=kL;rc.defs=$u;rc.nadgrid=CN;rc.transform=UE;rc.mgrs=HN;rc.version="__VERSION__";v4(rc);function b4(n){const e=wh.groupBy(n,r=>r.name.split(".")[0]),i=wh.flatMap(e,r=>{const a=r.find(s=>s.name.endsWith(".shp")),l=r.find(s=>s.name.endsWith(".json"));if(a){const s=r.find(g=>g.name.endsWith(".dbf")),d=r.find(g=>g.name.endsWith(".prj"));return I4(a,s,d)}else if(l)return r.map(E4)}).filter(r=>r!==void 0);return Promise.all(i)}async function G1(n){try{return await(await fetch(`https://epsg.io/${n}.proj4`)).text()}catch(e){console.error("Failed to extract Proj4 string",e)}}async function x4(n){try{return(await(await fetch(`https://epsg.io/${n}.json`)).json()).name}catch{console.error("Invalid EPSG")}}function E4(n){if(n.type!=="application/json"){console.error("Not a json file!");return}return new Promise((e,t)=>{const i=new FileReader;i.onload=r=>{if(r.target&&r.target.result){const a=r.target.result,l=JSON.parse(a);Ef(l)&&wh.groupBy(l.features,s=>s.geometry.type),e({id:n.name.replace(".json",""),geojson:{type:"geojson",data:l}})}t("Could not parse geoJSON file")},i.readAsText(n)})}async function I4(n,e,t){const i=await n.arrayBuffer(),r=await VO(i),a=e&&await S4(e);a&&r.features.length===a.length&&wh.zip(r.features,a).forEach(([s,d])=>{wh.merge(s,{properties:d})});const l=t&&await w4(t);return l&&r.features.forEach(s=>{s.geometry=F1(s.geometry,l)}),{id:n.name.split(".")[0],geojson:{type:"geojson",data:r},projectionName:l?await T4(t):void 0}}async function T4(n){return new Promise((e,t)=>{const i=new FileReader;i.onload=async r=>{var a;try{const l=(a=r.target)==null?void 0:a.result,s=l==null?void 0:l.toString().trim(),d=/PROJCS\["([^"]+)"/,x=s.match(d)[1].replaceAll("_"," ");e(x)}catch(l){t(l)}},i.readAsText(n)})}async function w4(n){return new Promise((e,t)=>{const i=new FileReader;i.onload=async r=>{var a;try{const l=(a=r.target)==null?void 0:a.result,s=l==null?void 0:l.toString().trim(),d=await G1("4326"),g=rc(s,d);e(g)}catch(l){t(l)}},i.readAsText(n)})}async function S4(n){const e=await n.arrayBuffer(),t=await UO(e);async function i(r=[]){const a=await t.read();return a.done?r:await i([...r,a.value])}return await i()}/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function C4(n){return n?n.scrollHeight>n.offsetHeight:!1}function A4(n){return n?n.scrollTop===0:!1}function M4(n){return n?Math.ceil(n.scrollHeight-n.scrollTop)===n.clientHeight:!1}function L4(n){var e=new Set;return[].forEach.call(n,function(t){return e.add(t.offsetTop)}),e.size>1}/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var to={CLOSING:"mdc-dialog--closing",OPEN:"mdc-dialog--open",OPENING:"mdc-dialog--opening",SCROLLABLE:"mdc-dialog--scrollable",SCROLL_LOCK:"mdc-dialog-scroll-lock",STACKED:"mdc-dialog--stacked",FULLSCREEN:"mdc-dialog--fullscreen",SCROLL_DIVIDER_HEADER:"mdc-dialog-scroll-divider-header",SCROLL_DIVIDER_FOOTER:"mdc-dialog-scroll-divider-footer",SURFACE_SCRIM_SHOWN:"mdc-dialog__surface-scrim--shown",SURFACE_SCRIM_SHOWING:"mdc-dialog__surface-scrim--showing",SURFACE_SCRIM_HIDING:"mdc-dialog__surface-scrim--hiding",SCRIM_HIDDEN:"mdc-dialog__scrim--hidden"},b1={ACTION_ATTRIBUTE:"data-mdc-dialog-action",BUTTON_DEFAULT_ATTRIBUTE:"data-mdc-dialog-button-default",BUTTON_SELECTOR:".mdc-dialog__button",CLOSED_EVENT:"MDCDialog:closed",CLOSE_ACTION:"close",CLOSING_EVENT:"MDCDialog:closing",CONTAINER_SELECTOR:".mdc-dialog__container",CONTENT_SELECTOR:".mdc-dialog__content",DESTROY_ACTION:"destroy",INITIAL_FOCUS_ATTRIBUTE:"data-mdc-dialog-initial-focus",OPENED_EVENT:"MDCDialog:opened",OPENING_EVENT:"MDCDialog:opening",SCRIM_SELECTOR:".mdc-dialog__scrim",SUPPRESS_DEFAULT_PRESS_SELECTOR:["textarea",".mdc-menu .mdc-list-item",".mdc-menu .mdc-deprecated-list-item"].join(", "),SURFACE_SELECTOR:".mdc-dialog__surface"},Pw={DIALOG_ANIMATION_CLOSE_TIME_MS:75,DIALOG_ANIMATION_OPEN_TIME_MS:150};/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var HE;(function(n){n.POLL_SCROLL_POS="poll_scroll_position",n.POLL_LAYOUT_CHANGE="poll_layout_change"})(HE||(HE={}));var R4=function(n){Wo(e,n);function e(t){var i=n.call(this,zr(zr({},e.defaultAdapter),t))||this;return i.dialogOpen=!1,i.isFullscreen=!1,i.animationFrame=0,i.animationTimer=0,i.escapeKeyAction=b1.CLOSE_ACTION,i.scrimClickAction=b1.CLOSE_ACTION,i.autoStackButtons=!0,i.areButtonsStacked=!1,i.suppressDefaultPressSelector=b1.SUPPRESS_DEFAULT_PRESS_SELECTOR,i.animFrame=new AS,i.contentScrollHandler=function(){i.handleScrollEvent()},i.windowResizeHandler=function(){i.layout()},i.windowOrientationChangeHandler=function(){i.layout()},i}return Object.defineProperty(e,"cssClasses",{get:function(){return to},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return b1},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return Pw},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addBodyClass:function(){},addClass:function(){},areButtonsStacked:function(){return!1},clickDefaultButton:function(){},eventTargetMatches:function(){return!1},getActionFromEvent:function(){return""},getInitialFocusEl:function(){return null},hasClass:function(){return!1},isContentScrollable:function(){return!1},notifyClosed:function(){},notifyClosing:function(){},notifyOpened:function(){},notifyOpening:function(){},releaseFocus:function(){},removeBodyClass:function(){},removeClass:function(){},reverseButtons:function(){},trapFocus:function(){},registerContentEventHandler:function(){},deregisterContentEventHandler:function(){},isScrollableContentAtTop:function(){return!1},isScrollableContentAtBottom:function(){return!1},registerWindowEventHandler:function(){},deregisterWindowEventHandler:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){this.adapter.hasClass(to.STACKED)&&this.setAutoStackButtons(!1),this.isFullscreen=this.adapter.hasClass(to.FULLSCREEN)},e.prototype.destroy=function(){this.animationTimer&&(clearTimeout(this.animationTimer),this.handleAnimationTimerEnd()),this.isFullscreen&&this.adapter.deregisterContentEventHandler("scroll",this.contentScrollHandler),this.animFrame.cancelAll(),this.adapter.deregisterWindowEventHandler("resize",this.windowResizeHandler),this.adapter.deregisterWindowEventHandler("orientationchange",this.windowOrientationChangeHandler)},e.prototype.open=function(t){var i=this;this.dialogOpen=!0,this.adapter.notifyOpening(),this.adapter.addClass(to.OPENING),this.isFullscreen&&this.adapter.registerContentEventHandler("scroll",this.contentScrollHandler),t&&t.isAboveFullscreenDialog&&this.adapter.addClass(to.SCRIM_HIDDEN),this.adapter.registerWindowEventHandler("resize",this.windowResizeHandler),this.adapter.registerWindowEventHandler("orientationchange",this.windowOrientationChangeHandler),this.runNextAnimationFrame(function(){i.adapter.addClass(to.OPEN),i.adapter.addBodyClass(to.SCROLL_LOCK),i.layout(),i.animationTimer=setTimeout(function(){i.handleAnimationTimerEnd(),i.adapter.trapFocus(i.adapter.getInitialFocusEl()),i.adapter.notifyOpened()},Pw.DIALOG_ANIMATION_OPEN_TIME_MS)})},e.prototype.close=function(t){var i=this;t===void 0&&(t=""),this.dialogOpen&&(this.dialogOpen=!1,this.adapter.notifyClosing(t),this.adapter.addClass(to.CLOSING),this.adapter.removeClass(to.OPEN),this.adapter.removeBodyClass(to.SCROLL_LOCK),this.isFullscreen&&this.adapter.deregisterContentEventHandler("scroll",this.contentScrollHandler),this.adapter.deregisterWindowEventHandler("resize",this.windowResizeHandler),this.adapter.deregisterWindowEventHandler("orientationchange",this.windowOrientationChangeHandler),cancelAnimationFrame(this.animationFrame),this.animationFrame=0,clearTimeout(this.animationTimer),this.animationTimer=setTimeout(function(){i.adapter.releaseFocus(),i.handleAnimationTimerEnd(),i.adapter.notifyClosed(t)},Pw.DIALOG_ANIMATION_CLOSE_TIME_MS))},e.prototype.showSurfaceScrim=function(){var t=this;this.adapter.addClass(to.SURFACE_SCRIM_SHOWING),this.runNextAnimationFrame(function(){t.adapter.addClass(to.SURFACE_SCRIM_SHOWN)})},e.prototype.hideSurfaceScrim=function(){this.adapter.removeClass(to.SURFACE_SCRIM_SHOWN),this.adapter.addClass(to.SURFACE_SCRIM_HIDING)},e.prototype.handleSurfaceScrimTransitionEnd=function(){this.adapter.removeClass(to.SURFACE_SCRIM_HIDING),this.adapter.removeClass(to.SURFACE_SCRIM_SHOWING)},e.prototype.isOpen=function(){return this.dialogOpen},e.prototype.getEscapeKeyAction=function(){return this.escapeKeyAction},e.prototype.setEscapeKeyAction=function(t){this.escapeKeyAction=t},e.prototype.getScrimClickAction=function(){return this.scrimClickAction},e.prototype.setScrimClickAction=function(t){this.scrimClickAction=t},e.prototype.getAutoStackButtons=function(){return this.autoStackButtons},e.prototype.setAutoStackButtons=function(t){this.autoStackButtons=t},e.prototype.getSuppressDefaultPressSelector=function(){return this.suppressDefaultPressSelector},e.prototype.setSuppressDefaultPressSelector=function(t){this.suppressDefaultPressSelector=t},e.prototype.layout=function(){var t=this;this.animFrame.request(HE.POLL_LAYOUT_CHANGE,function(){t.layoutInternal()})},e.prototype.handleClick=function(t){var i=this.adapter.eventTargetMatches(t.target,b1.SCRIM_SELECTOR);if(i&&this.scrimClickAction!=="")this.close(this.scrimClickAction);else{var r=this.adapter.getActionFromEvent(t);r&&this.close(r)}},e.prototype.handleKeydown=function(t){var i=t.key==="Enter"||t.keyCode===13;if(i){var r=this.adapter.getActionFromEvent(t);if(!r){var a=t.composedPath?t.composedPath()[0]:t.target,l=this.suppressDefaultPressSelector?!this.adapter.eventTargetMatches(a,this.suppressDefaultPressSelector):!0;i&&l&&this.adapter.clickDefaultButton()}}},e.prototype.handleDocumentKeydown=function(t){var i=t.key==="Escape"||t.keyCode===27;i&&this.escapeKeyAction!==""&&this.close(this.escapeKeyAction)},e.prototype.handleScrollEvent=function(){var t=this;this.animFrame.request(HE.POLL_SCROLL_POS,function(){t.toggleScrollDividerHeader(),t.toggleScrollDividerFooter()})},e.prototype.layoutInternal=function(){this.autoStackButtons&&this.detectStackedButtons(),this.toggleScrollableClasses()},e.prototype.handleAnimationTimerEnd=function(){this.animationTimer=0,this.adapter.removeClass(to.OPENING),this.adapter.removeClass(to.CLOSING)},e.prototype.runNextAnimationFrame=function(t){var i=this;cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame(function(){i.animationFrame=0,clearTimeout(i.animationTimer),i.animationTimer=setTimeout(t,0)})},e.prototype.detectStackedButtons=function(){this.adapter.removeClass(to.STACKED);var t=this.adapter.areButtonsStacked();t&&this.adapter.addClass(to.STACKED),t!==this.areButtonsStacked&&(this.adapter.reverseButtons(),this.areButtonsStacked=t)},e.prototype.toggleScrollableClasses=function(){this.adapter.removeClass(to.SCROLLABLE),this.adapter.isContentScrollable()&&(this.adapter.addClass(to.SCROLLABLE),this.isFullscreen&&(this.toggleScrollDividerHeader(),this.toggleScrollDividerFooter()))},e.prototype.toggleScrollDividerHeader=function(){this.adapter.isScrollableContentAtTop()?this.adapter.hasClass(to.SCROLL_DIVIDER_HEADER)&&this.adapter.removeClass(to.SCROLL_DIVIDER_HEADER):this.adapter.addClass(to.SCROLL_DIVIDER_HEADER)},e.prototype.toggleScrollDividerFooter=function(){this.adapter.isScrollableContentAtBottom()?this.adapter.hasClass(to.SCROLL_DIVIDER_FOOTER)&&this.adapter.removeClass(to.SCROLL_DIVIDER_FOOTER):this.adapter.addClass(to.SCROLL_DIVIDER_FOOTER)},e}(xl);const{document:P4,window:d2}=uL,D4=n=>({}),p2=n=>({});function m2(n){let e,t,i;return{c(){e=qt("div"),this.h()},l(r){e=Wt(r,"DIV",{class:!0}),Qt(e).forEach(de),this.h()},h(){tn(e,"class","mdc-dialog__surface-scrim")},m(r,a){tt(r,e,a),t||(i=qn(e,"transitionend",n[32]),t=!0)},p:_l,d(r){r&&de(e),t=!1,i()}}}function O4(n){let e,t,i,r,a,l,s,d,g,x,I,A,L,N,B;const F=n[29].default,z=Ri(F,n,n[28],null);let V=n[5]&&m2(n),Y=[{class:l=In({[n[9]]:!0,"mdc-dialog__surface":!0})},{role:"alertdialog"},{"aria-modal":"true"},gi(n[19],"surface$")],Q={};for(let le=0;le<Y.length;le+=1)Q=zt(Q,Y[le]);let J=[{class:s=In({[n[8]]:!0,"mdc-dialog__container":!0})},gi(n[19],"container$")],he={};for(let le=0;le<J.length;le+=1)he=zt(he,J[le]);let ee=[{class:x=In({[n[2]]:!0,"mdc-dialog":!0,"mdc-dialog--stacked":!n[4],"mdc-dialog--fullscreen":n[5],"mdc-dialog--sheet":n[6],"mdc-dialog--no-content-padding":n[7],"smui-dialog--selection":n[3],...n[12]})},{role:"alertdialog"},{"aria-modal":"true"},jo(n[19],["container$","surface$"])],ae={};for(let le=0;le<ee.length;le+=1)ae=zt(ae,ee[le]);const De=n[29].over,fe=Ri(De,n,n[28],p2);return{c(){e=vn(),t=qt("div"),i=qt("div"),r=qt("div"),z&&z.c(),a=vn(),V&&V.c(),d=vn(),g=qt("div"),A=vn(),fe&&fe.c(),this.h()},l(le){e=bn(le),t=Wt(le,"DIV",{class:!0,role:!0,"aria-modal":!0});var Be=Qt(t);i=Wt(Be,"DIV",{class:!0});var Pe=Qt(i);r=Wt(Pe,"DIV",{class:!0,role:!0,"aria-modal":!0});var Ce=Qt(r);z&&z.l(Ce),a=bn(Ce),V&&V.l(Ce),Ce.forEach(de),Pe.forEach(de),d=bn(Be),g=Wt(Be,"DIV",{class:!0}),Qt(g).forEach(de),Be.forEach(de),A=bn(le),fe&&fe.l(le),this.h()},h(){Xn(r,Q),Xn(i,he),tn(g,"class","mdc-dialog__scrim"),Xn(t,ae)},m(le,Be){tt(le,e,Be),tt(le,t,Be),Kt(t,i),Kt(i,r),z&&z.m(r,null),Kt(r,a),V&&V.m(r,null),Kt(t,d),Kt(t,g),n[33](t),tt(le,A,Be),fe&&fe.m(le,Be),L=!0,N||(B=[qn(d2,"resize",n[30]),qn(d2,"orientationchange",n[31]),qn(P4.body,"keydown",function(){Gi(n[10]&&n[10].handleDocumentKeydown.bind(n[10]))&&(n[10]&&n[10].handleDocumentKeydown.bind(n[10])).apply(this,arguments)}),li(I=jr.call(null,t,n[1])),li(n[13].call(null,t)),qn(t,"SMUIDialog:opening",n[16]),qn(t,"SMUIDialog:opened",n[17]),qn(t,"SMUIDialog:closed",n[18]),qn(t,"click",function(){Gi(n[10]&&n[10].handleClick.bind(n[10]))&&(n[10]&&n[10].handleClick.bind(n[10])).apply(this,arguments)}),qn(t,"keydown",function(){Gi(n[10]&&n[10].handleKeydown.bind(n[10]))&&(n[10]&&n[10].handleKeydown.bind(n[10])).apply(this,arguments)})],N=!0)},p(le,Be){n=le,z&&z.p&&(!L||Be[0]&268435456)&&Pi(z,F,n,n[28],L?Oi(F,n[28],Be,null):Di(n[28]),null),n[5]?V?V.p(n,Be):(V=m2(n),V.c(),V.m(r,null)):V&&(V.d(1),V=null),Xn(r,Q=hi(Y,[(!L||Be[0]&512&&l!==(l=In({[n[9]]:!0,"mdc-dialog__surface":!0})))&&{class:l},{role:"alertdialog"},{"aria-modal":"true"},Be[0]&524288&&gi(n[19],"surface$")])),Xn(i,he=hi(J,[(!L||Be[0]&256&&s!==(s=In({[n[8]]:!0,"mdc-dialog__container":!0})))&&{class:s},Be[0]&524288&&gi(n[19],"container$")])),Xn(t,ae=hi(ee,[(!L||Be[0]&4348&&x!==(x=In({[n[2]]:!0,"mdc-dialog":!0,"mdc-dialog--stacked":!n[4],"mdc-dialog--fullscreen":n[5],"mdc-dialog--sheet":n[6],"mdc-dialog--no-content-padding":n[7],"smui-dialog--selection":n[3],...n[12]})))&&{class:x},{role:"alertdialog"},{"aria-modal":"true"},Be[0]&524288&&jo(n[19],["container$","surface$"])])),I&&Gi(I.update)&&Be[0]&2&&I.update.call(null,n[1]),fe&&fe.p&&(!L||Be[0]&268435456)&&Pi(fe,De,n,n[28],L?Oi(De,n[28],Be,D4):Di(n[28]),p2)},i(le){L||(Te(z,le),Te(fe,le),L=!0)},o(le){Ne(z,le),Ne(fe,le),L=!1},d(le){le&&de(e),le&&de(t),z&&z.d(le),V&&V.d(),n[33](null),le&&de(A),fe&&fe.d(le),N=!1,Ss(B)}}}function N4(n,e,t){const i=["use","class","open","selection","escapeKeyAction","scrimClickAction","autoStackButtons","fullscreen","sheet","noContentPadding","container$class","surface$class","isOpen","setOpen","layout","getElement"];let r=vi(e,i),a,l,{$$slots:s={},$$scope:d}=e;var g;const{FocusTrap:x}=VD,{closest:I,matches:A}=r0,L=ps(ds());let{use:N=[]}=e,{class:B=""}=e,{open:F=!1}=e,{selection:z=!1}=e,{escapeKeyAction:V="close"}=e,{scrimClickAction:Y="close"}=e,{autoStackButtons:Q=!0}=e,{fullscreen:J=!1}=e,{sheet:he=!1}=e,{noContentPadding:ee=!1}=e,{container$class:ae=""}=e,{surface$class:De=""}=e,fe,le,Be={},Pe,Ce=Eh(!1);Dl(n,Ce,He=>t(37,l=He));let it=Fr("SMUI:dialog:aboveFullscreen"),Et=(g=Fr("SMUI:dialog:aboveFullscreenShown"))!==null&&g!==void 0?g:Eh(!1);Dl(n,Et,He=>t(27,a=He));let Ue=Fr("SMUI:addLayoutListener"),at,ke=[],Dt=He=>(ke.push(He),()=>{const Jt=ke.indexOf(He);Jt>=0&&ke.splice(Jt,1)});lr("SMUI:dialog:actions:reversed",Ce),lr("SMUI:addLayoutListener",Dt),lr("SMUI:dialog:selection",z),lr("SMUI:dialog:aboveFullscreen",it||J),lr("SMUI:dialog:aboveFullscreenShown",Et),he&&lr("SMUI:icon-button:context","dialog:sheet"),Ue&&(at=Ue(yn));let fn=a;ro(()=>{var He;return Pe=new x(fe,{initialFocusEl:(He=_t())!==null&&He!==void 0?He:void 0}),t(10,le=new R4({addBodyClass:Jt=>document.body.classList.add(Jt),addClass:Gt,areButtonsStacked:()=>L4(vt()),clickDefaultButton:()=>{const Jt=xn();Jt&&Jt.click()},eventTargetMatches:(Jt,ui)=>Jt?A(Jt,ui):!1,getActionFromEvent:Jt=>{if(!Jt.target)return"";const ui=I(Jt.target,"[data-mdc-dialog-action]");return ui&&ui.getAttribute("data-mdc-dialog-action")},getInitialFocusEl:_t,hasClass:Cn,isContentScrollable:()=>C4(En()),notifyClosed:Jt=>{t(0,F=!1),ji(Pt(),"SMUIDialog:closed",Jt?{action:Jt}:{},void 0,!0)},notifyClosing:Jt=>ji(Pt(),"SMUIDialog:closing",Jt?{action:Jt}:{},void 0,!0),notifyOpened:()=>ji(Pt(),"SMUIDialog:opened",{},void 0,!0),notifyOpening:()=>ji(Pt(),"SMUIDialog:opening",{},void 0,!0),releaseFocus:()=>Pe.releaseFocus(),removeBodyClass:Jt=>document.body.classList.remove(Jt),removeClass:Mt,reverseButtons:()=>{bf(Ce,l=!0,l)},trapFocus:()=>Pe.trapFocus(),registerContentEventHandler:(Jt,ui)=>{const $e=En();$e instanceof HTMLElement&&$e.addEventListener(Jt,ui)},deregisterContentEventHandler:(Jt,ui)=>{const $e=En();$e instanceof HTMLElement&&$e.removeEventListener(Jt,ui)},isScrollableContentAtTop:()=>A4(En()),isScrollableContentAtBottom:()=>M4(En()),registerWindowEventHandler:(Jt,ui)=>{window.addEventListener(Jt,ui)},deregisterWindowEventHandler:(Jt,ui)=>{window.removeEventListener(Jt,ui)}})),le.init(),()=>{le.destroy()}}),Dh(()=>{at&&at()});function Cn(He){return He in Be?Be[He]:Pt().classList.contains(He)}function Gt(He){Be[He]||t(12,Be[He]=!0,Be)}function Mt(He){(!(He in Be)||Be[He])&&t(12,Be[He]=!1,Be)}function vt(){return[].slice.call(fe.querySelectorAll(".mdc-dialog__button"))}function xn(){return fe.querySelector("[data-mdc-dialog-button-default]")}function En(){return fe.querySelector(".mdc-dialog__content")}function _t(){return fe.querySelector("[data-mdc-dialog-initial-focus]")}function kt(){it&&bf(Et,a=!0,a),requestAnimationFrame(()=>{ke.forEach(He=>He())})}function Ct(){ke.forEach(He=>He())}function Bt(){it&&bf(Et,a=!1,a)}function Zn(){return F}function mi(He){t(0,F=He)}function yn(){return le.layout()}function Pt(){return fe}const Yn=()=>F&&le&&le.layout(),si=()=>F&&le&&le.layout(),Dr=()=>le&&le.handleSurfaceScrimTransitionEnd();function Ur(He){Sn[He?"unshift":"push"](()=>{fe=He,t(11,fe)})}return n.$$set=He=>{e=zt(zt({},e),ls(He)),t(19,r=vi(e,i)),"use"in He&&t(1,N=He.use),"class"in He&&t(2,B=He.class),"open"in He&&t(0,F=He.open),"selection"in He&&t(3,z=He.selection),"escapeKeyAction"in He&&t(20,V=He.escapeKeyAction),"scrimClickAction"in He&&t(21,Y=He.scrimClickAction),"autoStackButtons"in He&&t(4,Q=He.autoStackButtons),"fullscreen"in He&&t(5,J=He.fullscreen),"sheet"in He&&t(6,he=He.sheet),"noContentPadding"in He&&t(7,ee=He.noContentPadding),"container$class"in He&&t(8,ae=He.container$class),"surface$class"in He&&t(9,De=He.surface$class),"$$scope"in He&&t(28,d=He.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&1049600&&le&&le.getEscapeKeyAction()!==V&&le.setEscapeKeyAction(V),n.$$.dirty[0]&2098176&&le&&le.getScrimClickAction()!==Y&&le.setScrimClickAction(Y),n.$$.dirty[0]&1040&&le&&le.getAutoStackButtons()!==Q&&le.setAutoStackButtons(Q),n.$$.dirty[0]&16&&(Q||bf(Ce,l=!0,l)),n.$$.dirty[0]&1025&&le&&le.isOpen()!==F&&(F?le.open({isAboveFullscreenDialog:!!it}):le.close()),n.$$.dirty[0]&201327648&&J&&le&&fn!==a&&(t(26,fn=a),a?le.showSurfaceScrim():le.hideSurfaceScrim())},[F,N,B,z,Q,J,he,ee,ae,De,le,fe,Be,L,Ce,Et,kt,Ct,Bt,r,V,Y,Zn,mi,yn,Pt,fn,a,d,s,Yn,si,Dr,Ur]}class KL extends sr{constructor(e){super(),or(this,e,N4,O4,Qi,{use:1,class:2,open:0,selection:3,escapeKeyAction:20,scrimClickAction:21,autoStackButtons:4,fullscreen:5,sheet:6,noContentPadding:7,container$class:8,surface$class:9,isOpen:22,setOpen:23,layout:24,getElement:25},null,[-1,-1])}get isOpen(){return this.$$.ctx[22]}get setOpen(){return this.$$.ctx[23]}get layout(){return this.$$.ctx[24]}get getElement(){return this.$$.ctx[25]}}zl({class:"mdc-dialog__header",tag:"div",contexts:{"SMUI:icon-button:context":"dialog:header"}});const k4=zl({class:"mdc-dialog__title",tag:"h2"});zl({class:"mdc-dialog__content",tag:"div"});zl({class:"mdc-dialog__actions",tag:"div",classMap:{"smui-dialog__actions--reversed":"SMUI:dialog:actions:reversed"},contexts:{"SMUI:button:context":"dialog:action"}});/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var F4={LABEL_FLOAT_ABOVE:"mdc-floating-label--float-above",LABEL_REQUIRED:"mdc-floating-label--required",LABEL_SHAKE:"mdc-floating-label--shake",ROOT:"mdc-floating-label"};/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var B4=function(n){Wo(e,n);function e(t){var i=n.call(this,zr(zr({},e.defaultAdapter),t))||this;return i.shakeAnimationEndHandler=function(){i.handleShakeAnimationEnd()},i}return Object.defineProperty(e,"cssClasses",{get:function(){return F4},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},getWidth:function(){return 0},registerInteractionHandler:function(){},deregisterInteractionHandler:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){this.adapter.registerInteractionHandler("animationend",this.shakeAnimationEndHandler)},e.prototype.destroy=function(){this.adapter.deregisterInteractionHandler("animationend",this.shakeAnimationEndHandler)},e.prototype.getWidth=function(){return this.adapter.getWidth()},e.prototype.shake=function(t){var i=e.cssClasses.LABEL_SHAKE;t?this.adapter.addClass(i):this.adapter.removeClass(i)},e.prototype.float=function(t){var i=e.cssClasses,r=i.LABEL_FLOAT_ABOVE,a=i.LABEL_SHAKE;t?this.adapter.addClass(r):(this.adapter.removeClass(r),this.adapter.removeClass(a))},e.prototype.setRequired=function(t){var i=e.cssClasses.LABEL_REQUIRED;t?this.adapter.addClass(i):this.adapter.removeClass(i)},e.prototype.handleShakeAnimationEnd=function(){var t=e.cssClasses.LABEL_SHAKE;this.adapter.removeClass(t)},e}(xl);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var p_={LINE_RIPPLE_ACTIVE:"mdc-line-ripple--active",LINE_RIPPLE_DEACTIVATING:"mdc-line-ripple--deactivating"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var z4=function(n){Wo(e,n);function e(t){var i=n.call(this,zr(zr({},e.defaultAdapter),t))||this;return i.transitionEndHandler=function(r){i.handleTransitionEnd(r)},i}return Object.defineProperty(e,"cssClasses",{get:function(){return p_},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setStyle:function(){},registerEventHandler:function(){},deregisterEventHandler:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){this.adapter.registerEventHandler("transitionend",this.transitionEndHandler)},e.prototype.destroy=function(){this.adapter.deregisterEventHandler("transitionend",this.transitionEndHandler)},e.prototype.activate=function(){this.adapter.removeClass(p_.LINE_RIPPLE_DEACTIVATING),this.adapter.addClass(p_.LINE_RIPPLE_ACTIVE)},e.prototype.setRippleCenter=function(t){this.adapter.setStyle("transform-origin",t+"px center")},e.prototype.deactivate=function(){this.adapter.addClass(p_.LINE_RIPPLE_DEACTIVATING)},e.prototype.handleTransitionEnd=function(t){var i=this.adapter.hasClass(p_.LINE_RIPPLE_DEACTIVATING);t.propertyName==="opacity"&&i&&(this.adapter.removeClass(p_.LINE_RIPPLE_ACTIVE),this.adapter.removeClass(p_.LINE_RIPPLE_DEACTIVATING))},e}(xl);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var U4={NOTCH_ELEMENT_SELECTOR:".mdc-notched-outline__notch"},g2={NOTCH_ELEMENT_PADDING:8},V4={NO_LABEL:"mdc-notched-outline--no-label",OUTLINE_NOTCHED:"mdc-notched-outline--notched",OUTLINE_UPGRADED:"mdc-notched-outline--upgraded"};/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var G4=function(n){Wo(e,n);function e(t){return n.call(this,zr(zr({},e.defaultAdapter),t))||this}return Object.defineProperty(e,"strings",{get:function(){return U4},enumerable:!1,configurable:!0}),Object.defineProperty(e,"cssClasses",{get:function(){return V4},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return g2},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},setNotchWidthProperty:function(){},removeNotchWidthProperty:function(){}}},enumerable:!1,configurable:!0}),e.prototype.notch=function(t){var i=e.cssClasses.OUTLINE_NOTCHED;t>0&&(t+=g2.NOTCH_ELEMENT_PADDING),this.adapter.setNotchWidthProperty(t),this.adapter.addClass(i)},e.prototype.closeNotch=function(){var t=e.cssClasses.OUTLINE_NOTCHED;this.adapter.removeClass(t),this.adapter.removeNotchWidthProperty()},e}(xl);/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Dw={ARIA_CONTROLS:"aria-controls",ARIA_DESCRIBEDBY:"aria-describedby",INPUT_SELECTOR:".mdc-text-field__input",LABEL_SELECTOR:".mdc-floating-label",LEADING_ICON_SELECTOR:".mdc-text-field__icon--leading",LINE_RIPPLE_SELECTOR:".mdc-line-ripple",OUTLINE_SELECTOR:".mdc-notched-outline",PREFIX_SELECTOR:".mdc-text-field__affix--prefix",SUFFIX_SELECTOR:".mdc-text-field__affix--suffix",TRAILING_ICON_SELECTOR:".mdc-text-field__icon--trailing"},H4={DISABLED:"mdc-text-field--disabled",FOCUSED:"mdc-text-field--focused",HELPER_LINE:"mdc-text-field-helper-line",INVALID:"mdc-text-field--invalid",LABEL_FLOATING:"mdc-text-field--label-floating",NO_LABEL:"mdc-text-field--no-label",OUTLINED:"mdc-text-field--outlined",ROOT:"mdc-text-field",TEXTAREA:"mdc-text-field--textarea",WITH_LEADING_ICON:"mdc-text-field--with-leading-icon",WITH_TRAILING_ICON:"mdc-text-field--with-trailing-icon",WITH_INTERNAL_COUNTER:"mdc-text-field--with-internal-counter"},_2={LABEL_SCALE:.75},j4=["pattern","min","max","required","step","minlength","maxlength"],q4=["color","date","datetime-local","month","range","time","week"];/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var y2=["mousedown","touchstart"],v2=["click","keydown"],W4=function(n){Wo(e,n);function e(t,i){i===void 0&&(i={});var r=n.call(this,zr(zr({},e.defaultAdapter),t))||this;return r.isFocused=!1,r.receivedUserInput=!1,r.valid=!0,r.useNativeValidation=!0,r.validateOnValueChange=!0,r.helperText=i.helperText,r.characterCounter=i.characterCounter,r.leadingIcon=i.leadingIcon,r.trailingIcon=i.trailingIcon,r.inputFocusHandler=function(){r.activateFocus()},r.inputBlurHandler=function(){r.deactivateFocus()},r.inputInputHandler=function(){r.handleInput()},r.setPointerXOffset=function(a){r.setTransformOrigin(a)},r.textFieldInteractionHandler=function(){r.handleTextFieldInteraction()},r.validationAttributeChangeHandler=function(a){r.handleValidationAttributeChange(a)},r}return Object.defineProperty(e,"cssClasses",{get:function(){return H4},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return Dw},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return _2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shouldAlwaysFloat",{get:function(){var t=this.getNativeInput().type;return q4.indexOf(t)>=0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shouldFloat",{get:function(){return this.shouldAlwaysFloat||this.isFocused||!!this.getValue()||this.isBadInput()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shouldShake",{get:function(){return!this.isFocused&&!this.isValid()&&!!this.getValue()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!0},setInputAttr:function(){},removeInputAttr:function(){},registerTextFieldInteractionHandler:function(){},deregisterTextFieldInteractionHandler:function(){},registerInputInteractionHandler:function(){},deregisterInputInteractionHandler:function(){},registerValidationAttributeChangeHandler:function(){return new MutationObserver(function(){})},deregisterValidationAttributeChangeHandler:function(){},getNativeInput:function(){return null},isFocused:function(){return!1},activateLineRipple:function(){},deactivateLineRipple:function(){},setLineRippleTransformOrigin:function(){},shakeLabel:function(){},floatLabel:function(){},setLabelRequired:function(){},hasLabel:function(){return!1},getLabelWidth:function(){return 0},hasOutline:function(){return!1},notchOutline:function(){},closeOutline:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){var t,i,r,a;this.adapter.hasLabel()&&this.getNativeInput().required&&this.adapter.setLabelRequired(!0),this.adapter.isFocused()?this.inputFocusHandler():this.adapter.hasLabel()&&this.shouldFloat&&(this.notchOutline(!0),this.adapter.floatLabel(!0),this.styleFloating(!0)),this.adapter.registerInputInteractionHandler("focus",this.inputFocusHandler),this.adapter.registerInputInteractionHandler("blur",this.inputBlurHandler),this.adapter.registerInputInteractionHandler("input",this.inputInputHandler);try{for(var l=nu(y2),s=l.next();!s.done;s=l.next()){var d=s.value;this.adapter.registerInputInteractionHandler(d,this.setPointerXOffset)}}catch(I){t={error:I}}finally{try{s&&!s.done&&(i=l.return)&&i.call(l)}finally{if(t)throw t.error}}try{for(var g=nu(v2),x=g.next();!x.done;x=g.next()){var d=x.value;this.adapter.registerTextFieldInteractionHandler(d,this.textFieldInteractionHandler)}}catch(I){r={error:I}}finally{try{x&&!x.done&&(a=g.return)&&a.call(g)}finally{if(r)throw r.error}}this.validationObserver=this.adapter.registerValidationAttributeChangeHandler(this.validationAttributeChangeHandler),this.setcharacterCounter(this.getValue().length)},e.prototype.destroy=function(){var t,i,r,a;this.adapter.deregisterInputInteractionHandler("focus",this.inputFocusHandler),this.adapter.deregisterInputInteractionHandler("blur",this.inputBlurHandler),this.adapter.deregisterInputInteractionHandler("input",this.inputInputHandler);try{for(var l=nu(y2),s=l.next();!s.done;s=l.next()){var d=s.value;this.adapter.deregisterInputInteractionHandler(d,this.setPointerXOffset)}}catch(I){t={error:I}}finally{try{s&&!s.done&&(i=l.return)&&i.call(l)}finally{if(t)throw t.error}}try{for(var g=nu(v2),x=g.next();!x.done;x=g.next()){var d=x.value;this.adapter.deregisterTextFieldInteractionHandler(d,this.textFieldInteractionHandler)}}catch(I){r={error:I}}finally{try{x&&!x.done&&(a=g.return)&&a.call(g)}finally{if(r)throw r.error}}this.adapter.deregisterValidationAttributeChangeHandler(this.validationObserver)},e.prototype.handleTextFieldInteraction=function(){var t=this.adapter.getNativeInput();t&&t.disabled||(this.receivedUserInput=!0)},e.prototype.handleValidationAttributeChange=function(t){var i=this;t.some(function(r){return j4.indexOf(r)>-1?(i.styleValidity(!0),i.adapter.setLabelRequired(i.getNativeInput().required),!0):!1}),t.indexOf("maxlength")>-1&&this.setcharacterCounter(this.getValue().length)},e.prototype.notchOutline=function(t){if(!(!this.adapter.hasOutline()||!this.adapter.hasLabel()))if(t){var i=this.adapter.getLabelWidth()*_2.LABEL_SCALE;this.adapter.notchOutline(i)}else this.adapter.closeOutline()},e.prototype.activateFocus=function(){this.isFocused=!0,this.styleFocused(this.isFocused),this.adapter.activateLineRipple(),this.adapter.hasLabel()&&(this.notchOutline(this.shouldFloat),this.adapter.floatLabel(this.shouldFloat),this.styleFloating(this.shouldFloat),this.adapter.shakeLabel(this.shouldShake)),this.helperText&&(this.helperText.isPersistent()||!this.helperText.isValidation()||!this.valid)&&this.helperText.showToScreenReader()},e.prototype.setTransformOrigin=function(t){if(!(this.isDisabled()||this.adapter.hasOutline())){var i=t.touches,r=i?i[0]:t,a=r.target.getBoundingClientRect(),l=r.clientX-a.left;this.adapter.setLineRippleTransformOrigin(l)}},e.prototype.handleInput=function(){this.autoCompleteFocus(),this.setcharacterCounter(this.getValue().length)},e.prototype.autoCompleteFocus=function(){this.receivedUserInput||this.activateFocus()},e.prototype.deactivateFocus=function(){this.isFocused=!1,this.adapter.deactivateLineRipple();var t=this.isValid();this.styleValidity(t),this.styleFocused(this.isFocused),this.adapter.hasLabel()&&(this.notchOutline(this.shouldFloat),this.adapter.floatLabel(this.shouldFloat),this.styleFloating(this.shouldFloat),this.adapter.shakeLabel(this.shouldShake)),this.shouldFloat||(this.receivedUserInput=!1)},e.prototype.getValue=function(){return this.getNativeInput().value},e.prototype.setValue=function(t){if(this.getValue()!==t&&(this.getNativeInput().value=t),this.setcharacterCounter(t.length),this.validateOnValueChange){var i=this.isValid();this.styleValidity(i)}this.adapter.hasLabel()&&(this.notchOutline(this.shouldFloat),this.adapter.floatLabel(this.shouldFloat),this.styleFloating(this.shouldFloat),this.validateOnValueChange&&this.adapter.shakeLabel(this.shouldShake))},e.prototype.isValid=function(){return this.useNativeValidation?this.isNativeInputValid():this.valid},e.prototype.setValid=function(t){this.valid=t,this.styleValidity(t);var i=!t&&!this.isFocused&&!!this.getValue();this.adapter.hasLabel()&&this.adapter.shakeLabel(i)},e.prototype.setValidateOnValueChange=function(t){this.validateOnValueChange=t},e.prototype.getValidateOnValueChange=function(){return this.validateOnValueChange},e.prototype.setUseNativeValidation=function(t){this.useNativeValidation=t},e.prototype.isDisabled=function(){return this.getNativeInput().disabled},e.prototype.setDisabled=function(t){this.getNativeInput().disabled=t,this.styleDisabled(t)},e.prototype.setHelperTextContent=function(t){this.helperText&&this.helperText.setContent(t)},e.prototype.setLeadingIconAriaLabel=function(t){this.leadingIcon&&this.leadingIcon.setAriaLabel(t)},e.prototype.setLeadingIconContent=function(t){this.leadingIcon&&this.leadingIcon.setContent(t)},e.prototype.setTrailingIconAriaLabel=function(t){this.trailingIcon&&this.trailingIcon.setAriaLabel(t)},e.prototype.setTrailingIconContent=function(t){this.trailingIcon&&this.trailingIcon.setContent(t)},e.prototype.setcharacterCounter=function(t){if(this.characterCounter){var i=this.getNativeInput().maxLength;if(i===-1)throw new Error("MDCTextFieldFoundation: Expected maxlength html property on text input or textarea.");this.characterCounter.setCounterValue(t,i)}},e.prototype.isBadInput=function(){return this.getNativeInput().validity.badInput||!1},e.prototype.isNativeInputValid=function(){return this.getNativeInput().validity.valid},e.prototype.styleValidity=function(t){var i=e.cssClasses.INVALID;if(t?this.adapter.removeClass(i):this.adapter.addClass(i),this.helperText){this.helperText.setValidity(t);var r=this.helperText.isValidation();if(!r)return;var a=this.helperText.isVisible(),l=this.helperText.getId();a&&l?this.adapter.setInputAttr(Dw.ARIA_DESCRIBEDBY,l):this.adapter.removeInputAttr(Dw.ARIA_DESCRIBEDBY)}},e.prototype.styleFocused=function(t){var i=e.cssClasses.FOCUSED;t?this.adapter.addClass(i):this.adapter.removeClass(i)},e.prototype.styleDisabled=function(t){var i=e.cssClasses,r=i.DISABLED,a=i.INVALID;t?(this.adapter.addClass(r),this.adapter.removeClass(a)):this.adapter.removeClass(r),this.leadingIcon&&this.leadingIcon.setDisabled(t),this.trailingIcon&&this.trailingIcon.setDisabled(t)},e.prototype.styleFloating=function(t){var i=e.cssClasses.LABEL_FLOATING;t?this.adapter.addClass(i):this.adapter.removeClass(i)},e.prototype.getNativeInput=function(){var t=this.adapter?this.adapter.getNativeInput():null;return t||{disabled:!1,maxLength:-1,required:!1,type:"input",validity:{badInput:!1,valid:!0},value:""}},e}(xl);function X4(n){let e,t,i,r,a,l,s,d;const g=n[22].default,x=Ri(g,n,n[21],null);let I=[{class:t=In({[n[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":n[0],"mdc-floating-label--required":n[1],...n[8]})},{style:i=Object.entries(n[9]).map(x2).concat([n[4]]).join(" ")},{for:r=n[5]||(n[11]?n[11].id:void 0)},n[12]],A={};for(let L=0;L<I.length;L+=1)A=zt(A,I[L]);return{c(){e=qt("label"),x&&x.c(),this.h()},l(L){e=Wt(L,"LABEL",{class:!0,style:!0,for:!0});var N=Qt(e);x&&x.l(N),N.forEach(de),this.h()},h(){Xn(e,A)},m(L,N){tt(L,e,N),x&&x.m(e,null),n[24](e),l=!0,s||(d=[li(a=jr.call(null,e,n[2])),li(n[10].call(null,e))],s=!0)},p(L,N){x&&x.p&&(!l||N&2097152)&&Pi(x,g,L,L[21],l?Oi(g,L[21],N,null):Di(L[21]),null),Xn(e,A=hi(I,[(!l||N&267&&t!==(t=In({[L[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":L[0],"mdc-floating-label--required":L[1],...L[8]})))&&{class:t},(!l||N&528&&i!==(i=Object.entries(L[9]).map(x2).concat([L[4]]).join(" ")))&&{style:i},(!l||N&32&&r!==(r=L[5]||(L[11]?L[11].id:void 0)))&&{for:r},N&4096&&L[12]])),a&&Gi(a.update)&&N&4&&a.update.call(null,L[2])},i(L){l||(Te(x,L),l=!0)},o(L){Ne(x,L),l=!1},d(L){L&&de(e),x&&x.d(L),n[24](null),s=!1,Ss(d)}}}function Z4(n){let e,t,i,r,a,l,s;const d=n[22].default,g=Ri(d,n,n[21],null);let x=[{class:t=In({[n[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":n[0],"mdc-floating-label--required":n[1],...n[8]})},{style:i=Object.entries(n[9]).map(b2).concat([n[4]]).join(" ")},n[12]],I={};for(let A=0;A<x.length;A+=1)I=zt(I,x[A]);return{c(){e=qt("span"),g&&g.c(),this.h()},l(A){e=Wt(A,"SPAN",{class:!0,style:!0});var L=Qt(e);g&&g.l(L),L.forEach(de),this.h()},h(){Xn(e,I)},m(A,L){tt(A,e,L),g&&g.m(e,null),n[23](e),a=!0,l||(s=[li(r=jr.call(null,e,n[2])),li(n[10].call(null,e))],l=!0)},p(A,L){g&&g.p&&(!a||L&2097152)&&Pi(g,d,A,A[21],a?Oi(d,A[21],L,null):Di(A[21]),null),Xn(e,I=hi(x,[(!a||L&267&&t!==(t=In({[A[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":A[0],"mdc-floating-label--required":A[1],...A[8]})))&&{class:t},(!a||L&528&&i!==(i=Object.entries(A[9]).map(b2).concat([A[4]]).join(" ")))&&{style:i},L&4096&&A[12]])),r&&Gi(r.update)&&L&4&&r.update.call(null,A[2])},i(A){a||(Te(g,A),a=!0)},o(A){Ne(g,A),a=!1},d(A){A&&de(e),g&&g.d(A),n[23](null),l=!1,Ss(s)}}}function Y4(n){let e,t,i,r;const a=[Z4,X4],l=[];function s(d,g){return d[6]?0:1}return e=s(n),t=l[e]=a[e](n),{c(){t.c(),i=pi()},l(d){t.l(d),i=pi()},m(d,g){l[e].m(d,g),tt(d,i,g),r=!0},p(d,[g]){let x=e;e=s(d),e===x?l[e].p(d,g):(Wi(),Ne(l[x],1,1,()=>{l[x]=null}),Xi(),t=l[e],t?t.p(d,g):(t=l[e]=a[e](d),t.c()),Te(t,1),t.m(i.parentNode,i))},i(d){r||(Te(t),r=!0)},o(d){Ne(t),r=!1},d(d){l[e].d(d),d&&de(i)}}}const b2=([n,e])=>`${n}: ${e};`,x2=([n,e])=>`${n}: ${e};`;function K4(n,e,t){const i=["use","class","style","for","floatAbove","required","wrapped","shake","float","setRequired","getWidth","getElement"];let r=vi(e,i),{$$slots:a={},$$scope:l}=e;var s;const d=ps(ds());let{use:g=[]}=e,{class:x=""}=e,{style:I=""}=e,{for:A=void 0}=e,{floatAbove:L=!1}=e,{required:N=!1}=e,{wrapped:B=!1}=e,F,z,V={},Y={},Q=(s=Fr("SMUI:generic:input:props"))!==null&&s!==void 0?s:{},J=L,he=N;ro(()=>{t(18,z=new B4({addClass:ee,removeClass:ae,getWidth:()=>{var ke,Dt;const fn=it(),Cn=fn.cloneNode(!0);(ke=fn.parentNode)===null||ke===void 0||ke.appendChild(Cn),Cn.classList.add("smui-floating-label--remove-transition"),Cn.classList.add("smui-floating-label--force-size"),Cn.classList.remove("mdc-floating-label--float-above");const Gt=Cn.scrollWidth;return(Dt=fn.parentNode)===null||Dt===void 0||Dt.removeChild(Cn),Gt},registerInteractionHandler:(ke,Dt)=>it().addEventListener(ke,Dt),deregisterInteractionHandler:(ke,Dt)=>it().removeEventListener(ke,Dt)}));const at={get element(){return it()},addStyle:De,removeStyle:fe};return ji(F,"SMUIFloatingLabel:mount",at),z.init(),()=>{ji(F,"SMUIFloatingLabel:unmount",at),z.destroy()}});function ee(at){V[at]||t(8,V[at]=!0,V)}function ae(at){(!(at in V)||V[at])&&t(8,V[at]=!1,V)}function De(at,ke){Y[at]!=ke&&(ke===""||ke==null?(delete Y[at],t(9,Y)):t(9,Y[at]=ke,Y))}function fe(at){at in Y&&(delete Y[at],t(9,Y))}function le(at){z.shake(at)}function Be(at){t(0,L=at)}function Pe(at){t(1,N=at)}function Ce(){return z.getWidth()}function it(){return F}function Et(at){Sn[at?"unshift":"push"](()=>{F=at,t(7,F)})}function Ue(at){Sn[at?"unshift":"push"](()=>{F=at,t(7,F)})}return n.$$set=at=>{e=zt(zt({},e),ls(at)),t(12,r=vi(e,i)),"use"in at&&t(2,g=at.use),"class"in at&&t(3,x=at.class),"style"in at&&t(4,I=at.style),"for"in at&&t(5,A=at.for),"floatAbove"in at&&t(0,L=at.floatAbove),"required"in at&&t(1,N=at.required),"wrapped"in at&&t(6,B=at.wrapped),"$$scope"in at&&t(21,l=at.$$scope)},n.$$.update=()=>{n.$$.dirty&786433&&z&&J!==L&&(t(19,J=L),z.float(L)),n.$$.dirty&1310722&&z&&he!==N&&(t(20,he=N),z.setRequired(N))},[L,N,g,x,I,A,B,F,V,Y,d,Q,r,le,Be,Pe,Ce,it,z,J,he,l,a,Et,Ue]}class pI extends sr{constructor(e){super(),or(this,e,K4,Y4,Qi,{use:2,class:3,style:4,for:5,floatAbove:0,required:1,wrapped:6,shake:13,float:14,setRequired:15,getWidth:16,getElement:17})}get shake(){return this.$$.ctx[13]}get float(){return this.$$.ctx[14]}get setRequired(){return this.$$.ctx[15]}get getWidth(){return this.$$.ctx[16]}get getElement(){return this.$$.ctx[17]}}function J4(n){let e,t,i,r,a,l,s=[{class:t=In({[n[1]]:!0,"mdc-line-ripple":!0,"mdc-line-ripple--active":n[3],...n[5]})},{style:i=Object.entries(n[6]).map(E2).concat([n[2]]).join(" ")},n[8]],d={};for(let g=0;g<s.length;g+=1)d=zt(d,s[g]);return{c(){e=qt("div"),this.h()},l(g){e=Wt(g,"DIV",{class:!0,style:!0}),Qt(e).forEach(de),this.h()},h(){Xn(e,d)},m(g,x){tt(g,e,x),n[13](e),a||(l=[li(r=jr.call(null,e,n[0])),li(n[7].call(null,e))],a=!0)},p(g,[x]){Xn(e,d=hi(s,[x&42&&t!==(t=In({[g[1]]:!0,"mdc-line-ripple":!0,"mdc-line-ripple--active":g[3],...g[5]}))&&{class:t},x&68&&i!==(i=Object.entries(g[6]).map(E2).concat([g[2]]).join(" "))&&{style:i},x&256&&g[8]])),r&&Gi(r.update)&&x&1&&r.update.call(null,g[0])},i:_l,o:_l,d(g){g&&de(e),n[13](null),a=!1,Ss(l)}}}const E2=([n,e])=>`${n}: ${e};`;function Q4(n,e,t){const i=["use","class","style","active","activate","deactivate","setRippleCenter","getElement"];let r=vi(e,i);const a=ps(ds());let{use:l=[]}=e,{class:s=""}=e,{style:d=""}=e,{active:g=!1}=e,x,I,A={},L={};ro(()=>(I=new z4({addClass:B,removeClass:F,hasClass:N,setStyle:z,registerEventHandler:(ee,ae)=>J().addEventListener(ee,ae),deregisterEventHandler:(ee,ae)=>J().removeEventListener(ee,ae)}),I.init(),()=>{I.destroy()}));function N(ee){return ee in A?A[ee]:J().classList.contains(ee)}function B(ee){A[ee]||t(5,A[ee]=!0,A)}function F(ee){(!(ee in A)||A[ee])&&t(5,A[ee]=!1,A)}function z(ee,ae){L[ee]!=ae&&(ae===""||ae==null?(delete L[ee],t(6,L)):t(6,L[ee]=ae,L))}function V(){I.activate()}function Y(){I.deactivate()}function Q(ee){I.setRippleCenter(ee)}function J(){return x}function he(ee){Sn[ee?"unshift":"push"](()=>{x=ee,t(4,x)})}return n.$$set=ee=>{e=zt(zt({},e),ls(ee)),t(8,r=vi(e,i)),"use"in ee&&t(0,l=ee.use),"class"in ee&&t(1,s=ee.class),"style"in ee&&t(2,d=ee.style),"active"in ee&&t(3,g=ee.active)},[l,s,d,g,x,A,L,a,r,V,Y,Q,J,he]}class JL extends sr{constructor(e){super(),or(this,e,Q4,J4,Qi,{use:0,class:1,style:2,active:3,activate:9,deactivate:10,setRippleCenter:11,getElement:12})}get activate(){return this.$$.ctx[9]}get deactivate(){return this.$$.ctx[10]}get setRippleCenter(){return this.$$.ctx[11]}get getElement(){return this.$$.ctx[12]}}function I2(n){let e,t,i;const r=n[15].default,a=Ri(r,n,n[14],null);return{c(){e=qt("div"),a&&a.c(),this.h()},l(l){e=Wt(l,"DIV",{class:!0,style:!0});var s=Qt(e);a&&a.l(s),s.forEach(de),this.h()},h(){tn(e,"class","mdc-notched-outline__notch"),tn(e,"style",t=Object.entries(n[7]).map(T2).join(" "))},m(l,s){tt(l,e,s),a&&a.m(e,null),i=!0},p(l,s){a&&a.p&&(!i||s&16384)&&Pi(a,r,l,l[14],i?Oi(r,l[14],s,null):Di(l[14]),null),(!i||s&128&&t!==(t=Object.entries(l[7]).map(T2).join(" ")))&&tn(e,"style",t)},i(l){i||(Te(a,l),i=!0)},o(l){Ne(a,l),i=!1},d(l){l&&de(e),a&&a.d(l)}}}function $4(n){let e,t,i,r,a,l,s,d,g,x,I=!n[3]&&I2(n),A=[{class:l=In({[n[1]]:!0,"mdc-notched-outline":!0,"mdc-notched-outline--notched":n[2],"mdc-notched-outline--no-label":n[3],...n[6]})},n[10]],L={};for(let N=0;N<A.length;N+=1)L=zt(L,A[N]);return{c(){e=qt("div"),t=qt("div"),i=vn(),I&&I.c(),r=vn(),a=qt("div"),this.h()},l(N){e=Wt(N,"DIV",{class:!0});var B=Qt(e);t=Wt(B,"DIV",{class:!0}),Qt(t).forEach(de),i=bn(B),I&&I.l(B),r=bn(B),a=Wt(B,"DIV",{class:!0}),Qt(a).forEach(de),B.forEach(de),this.h()},h(){tn(t,"class","mdc-notched-outline__leading"),tn(a,"class","mdc-notched-outline__trailing"),Xn(e,L)},m(N,B){tt(N,e,B),Kt(e,t),Kt(e,i),I&&I.m(e,null),Kt(e,r),Kt(e,a),n[16](e),d=!0,g||(x=[li(s=jr.call(null,e,n[0])),li(n[8].call(null,e)),qn(e,"SMUIFloatingLabel:mount",n[9]),qn(e,"SMUIFloatingLabel:unmount",n[17])],g=!0)},p(N,[B]){N[3]?I&&(Wi(),Ne(I,1,1,()=>{I=null}),Xi()):I?(I.p(N,B),B&8&&Te(I,1)):(I=I2(N),I.c(),Te(I,1),I.m(e,r)),Xn(e,L=hi(A,[(!d||B&78&&l!==(l=In({[N[1]]:!0,"mdc-notched-outline":!0,"mdc-notched-outline--notched":N[2],"mdc-notched-outline--no-label":N[3],...N[6]})))&&{class:l},B&1024&&N[10]])),s&&Gi(s.update)&&B&1&&s.update.call(null,N[0])},i(N){d||(Te(I),d=!0)},o(N){Ne(I),d=!1},d(N){N&&de(e),I&&I.d(),n[16](null),g=!1,Ss(x)}}}const T2=([n,e])=>`${n}: ${e};`;function eB(n,e,t){const i=["use","class","notched","noLabel","notch","closeNotch","getElement"];let r=vi(e,i),{$$slots:a={},$$scope:l}=e;const s=ps(ds());let{use:d=[]}=e,{class:g=""}=e,{notched:x=!1}=e,{noLabel:I=!1}=e,A,L,N,B={},F={};ro(()=>(L=new G4({addClass:V,removeClass:Y,setNotchWidthProperty:le=>Q("width",le+"px"),removeNotchWidthProperty:()=>J("width")}),L.init(),()=>{L.destroy()}));function z(le){t(4,N=le.detail)}function V(le){B[le]||t(6,B[le]=!0,B)}function Y(le){(!(le in B)||B[le])&&t(6,B[le]=!1,B)}function Q(le,Be){F[le]!=Be&&(Be===""||Be==null?(delete F[le],t(7,F)):t(7,F[le]=Be,F))}function J(le){le in F&&(delete F[le],t(7,F))}function he(le){L.notch(le)}function ee(){L.closeNotch()}function ae(){return A}function De(le){Sn[le?"unshift":"push"](()=>{A=le,t(5,A)})}const fe=()=>t(4,N=void 0);return n.$$set=le=>{e=zt(zt({},e),ls(le)),t(10,r=vi(e,i)),"use"in le&&t(0,d=le.use),"class"in le&&t(1,g=le.class),"notched"in le&&t(2,x=le.notched),"noLabel"in le&&t(3,I=le.noLabel),"$$scope"in le&&t(14,l=le.$$scope)},n.$$.update=()=>{n.$$.dirty&16&&(N?(N.addStyle("transition-duration","0s"),V("mdc-notched-outline--upgraded"),requestAnimationFrame(()=>{N&&N.removeStyle("transition-duration")})):Y("mdc-notched-outline--upgraded"))},[d,g,x,I,N,A,B,F,s,z,r,he,ee,ae,l,a,De,fe]}class QL extends sr{constructor(e){super(),or(this,e,eB,$4,Qi,{use:0,class:1,notched:2,noLabel:3,notch:11,closeNotch:12,getElement:13})}get notch(){return this.$$.ctx[11]}get closeNotch(){return this.$$.ctx[12]}get getElement(){return this.$$.ctx[13]}}const tB=zl({class:"mdc-text-field-helper-line",tag:"div"}),nB=zl({class:"mdc-text-field__affix mdc-text-field__affix--prefix",tag:"span"}),iB=zl({class:"mdc-text-field__affix mdc-text-field__affix--suffix",tag:"span"});function rB(n){let e,t,i,r,a,l=[{class:t=In({[n[1]]:!0,"mdc-text-field__input":!0})},{type:n[2]},{placeholder:n[3]},n[4],n[6],n[10]],s={};for(let d=0;d<l.length;d+=1)s=zt(s,l[d]);return{c(){e=qt("input"),this.h()},l(d){e=Wt(d,"INPUT",{class:!0,type:!0,placeholder:!0}),this.h()},h(){Xn(e,s)},m(d,g){tt(d,e,g),e.autofocus&&e.focus(),n[26](e),r||(a=[li(i=jr.call(null,e,n[0])),li(n[7].call(null,e)),qn(e,"input",n[27]),qn(e,"change",n[9]),qn(e,"blur",n[24]),qn(e,"focus",n[25])],r=!0)},p(d,[g]){Xn(e,s=hi(l,[g&2&&t!==(t=In({[d[1]]:!0,"mdc-text-field__input":!0}))&&{class:t},g&4&&{type:d[2]},g&8&&{placeholder:d[3]},g&16&&d[4],g&64&&d[6],g&1024&&d[10]])),i&&Gi(i.update)&&g&1&&i.update.call(null,d[0])},i:_l,o:_l,d(d){d&&de(e),n[26](null),r=!1,Ss(a)}}}function sB(n){return n===""?Number.NaN:+n}function oB(n,e,t){const i=["use","class","type","placeholder","value","files","dirty","invalid","updateInvalid","emptyValueNull","emptyValueUndefined","getAttr","addAttr","removeAttr","focus","blur","getElement"];let r=vi(e,i);const a=ps(ds());let l=()=>{};function s(ke){return ke===l}let{use:d=[]}=e,{class:g=""}=e,{type:x="text"}=e,{placeholder:I=" "}=e,{value:A=l}=e;const L=s(A);L&&(A="");let{files:N=null}=e,{dirty:B=!1}=e,{invalid:F=!1}=e,{updateInvalid:z=!0}=e,{emptyValueNull:V=A===null}=e;L&&V&&(A=null);let{emptyValueUndefined:Y=A===void 0}=e;L&&Y&&(A=void 0);let Q,J={},he={};ro(()=>{z&&t(14,F=Q.matches(":invalid"))});function ee(ke){if(x==="file"){t(12,N=ke.currentTarget.files);return}if(ke.currentTarget.value===""&&V){t(11,A=null);return}if(ke.currentTarget.value===""&&Y){t(11,A=void 0);return}switch(x){case"number":case"range":t(11,A=sB(ke.currentTarget.value));break;default:t(11,A=ke.currentTarget.value);break}}function ae(ke){(x==="file"||x==="range")&&ee(ke),t(13,B=!0),z&&t(14,F=Q.matches(":invalid"))}function De(ke){var Dt;return ke in J?(Dt=J[ke])!==null&&Dt!==void 0?Dt:null:Ce().getAttribute(ke)}function fe(ke,Dt){J[ke]!==Dt&&t(6,J[ke]=Dt,J)}function le(ke){(!(ke in J)||J[ke]!=null)&&t(6,J[ke]=void 0,J)}function Be(){Ce().focus()}function Pe(){Ce().blur()}function Ce(){return Q}function it(ke){iu.call(this,n,ke)}function Et(ke){iu.call(this,n,ke)}function Ue(ke){Sn[ke?"unshift":"push"](()=>{Q=ke,t(5,Q)})}const at=ke=>x!=="file"&&ee(ke);return n.$$set=ke=>{e=zt(zt({},e),ls(ke)),t(10,r=vi(e,i)),"use"in ke&&t(0,d=ke.use),"class"in ke&&t(1,g=ke.class),"type"in ke&&t(2,x=ke.type),"placeholder"in ke&&t(3,I=ke.placeholder),"value"in ke&&t(11,A=ke.value),"files"in ke&&t(12,N=ke.files),"dirty"in ke&&t(13,B=ke.dirty),"invalid"in ke&&t(14,F=ke.invalid),"updateInvalid"in ke&&t(15,z=ke.updateInvalid),"emptyValueNull"in ke&&t(16,V=ke.emptyValueNull),"emptyValueUndefined"in ke&&t(17,Y=ke.emptyValueUndefined)},n.$$.update=()=>{n.$$.dirty&2068&&(x==="file"?(delete he.value,t(4,he),t(2,x),t(11,A)):t(4,he.value=A??"",he))},[d,g,x,I,he,Q,J,a,ee,ae,r,A,N,B,F,z,V,Y,De,fe,le,Be,Pe,Ce,it,Et,Ue,at]}class aB extends sr{constructor(e){super(),or(this,e,oB,rB,Qi,{use:0,class:1,type:2,placeholder:3,value:11,files:12,dirty:13,invalid:14,updateInvalid:15,emptyValueNull:16,emptyValueUndefined:17,getAttr:18,addAttr:19,removeAttr:20,focus:21,blur:22,getElement:23})}get getAttr(){return this.$$.ctx[18]}get addAttr(){return this.$$.ctx[19]}get removeAttr(){return this.$$.ctx[20]}get focus(){return this.$$.ctx[21]}get blur(){return this.$$.ctx[22]}get getElement(){return this.$$.ctx[23]}}function lB(n){let e,t,i,r,a,l,s=[{class:t=In({[n[2]]:!0,"mdc-text-field__input":!0})},{style:i=`${n[4]?"":"resize: none; "}${n[3]}`},n[6],n[9]],d={};for(let g=0;g<s.length;g+=1)d=zt(d,s[g]);return{c(){e=qt("textarea"),this.h()},l(g){e=Wt(g,"TEXTAREA",{class:!0,style:!0}),Qt(e).forEach(de),this.h()},h(){Xn(e,d)},m(g,x){tt(g,e,x),e.autofocus&&e.focus(),n[21](e),eg(e,n[0]),a||(l=[li(r=jr.call(null,e,n[1])),li(n[7].call(null,e)),qn(e,"change",n[8]),qn(e,"blur",n[19]),qn(e,"focus",n[20]),qn(e,"input",n[22])],a=!0)},p(g,[x]){Xn(e,d=hi(s,[x&4&&t!==(t=In({[g[2]]:!0,"mdc-text-field__input":!0}))&&{class:t},x&24&&i!==(i=`${g[4]?"":"resize: none; "}${g[3]}`)&&{style:i},x&64&&g[6],x&512&&g[9]])),r&&Gi(r.update)&&x&2&&r.update.call(null,g[1]),x&1&&eg(e,g[0])},i:_l,o:_l,d(g){g&&de(e),n[21](null),a=!1,Ss(l)}}}function uB(n,e,t){const i=["use","class","style","value","dirty","invalid","updateInvalid","resizable","getAttr","addAttr","removeAttr","focus","blur","getElement"];let r=vi(e,i);const a=ps(ds());let{use:l=[]}=e,{class:s=""}=e,{style:d=""}=e,{value:g=""}=e,{dirty:x=!1}=e,{invalid:I=!1}=e,{updateInvalid:A=!0}=e,{resizable:L=!0}=e,N,B={};ro(()=>{A&&t(11,I=N.matches(":invalid"))});function F(){t(10,x=!0),A&&t(11,I=N.matches(":invalid"))}function z(le){var Be;return le in B?(Be=B[le])!==null&&Be!==void 0?Be:null:he().getAttribute(le)}function V(le,Be){B[le]!==Be&&t(6,B[le]=Be,B)}function Y(le){(!(le in B)||B[le]!=null)&&t(6,B[le]=void 0,B)}function Q(){he().focus()}function J(){he().blur()}function he(){return N}function ee(le){iu.call(this,n,le)}function ae(le){iu.call(this,n,le)}function De(le){Sn[le?"unshift":"push"](()=>{N=le,t(5,N)})}function fe(){g=this.value,t(0,g)}return n.$$set=le=>{e=zt(zt({},e),ls(le)),t(9,r=vi(e,i)),"use"in le&&t(1,l=le.use),"class"in le&&t(2,s=le.class),"style"in le&&t(3,d=le.style),"value"in le&&t(0,g=le.value),"dirty"in le&&t(10,x=le.dirty),"invalid"in le&&t(11,I=le.invalid),"updateInvalid"in le&&t(12,A=le.updateInvalid),"resizable"in le&&t(4,L=le.resizable)},[g,l,s,d,L,N,B,a,F,r,x,I,A,z,V,Y,Q,J,he,ee,ae,De,fe]}class cB extends sr{constructor(e){super(),or(this,e,uB,lB,Qi,{use:1,class:2,style:3,value:0,dirty:10,invalid:11,updateInvalid:12,resizable:4,getAttr:13,addAttr:14,removeAttr:15,focus:16,blur:17,getElement:18})}get getAttr(){return this.$$.ctx[13]}get addAttr(){return this.$$.ctx[14]}get removeAttr(){return this.$$.ctx[15]}get focus(){return this.$$.ctx[16]}get blur(){return this.$$.ctx[17]}get getElement(){return this.$$.ctx[18]}}const hB=n=>({}),w2=n=>({}),fB=n=>({}),S2=n=>({}),dB=n=>({}),C2=n=>({}),pB=n=>({}),A2=n=>({}),mB=n=>({}),M2=n=>({}),gB=n=>({}),L2=n=>({}),_B=n=>({}),R2=n=>({}),yB=n=>({}),P2=n=>({}),vB=n=>({}),D2=n=>({}),bB=n=>({}),O2=n=>({}),xB=n=>({}),N2=n=>({}),EB=n=>({}),k2=n=>({});function IB(n){let e,t,i,r,a,l,s,d,g,x,I,A,L,N;const B=n[56].label,F=Ri(B,n,n[87],M2);i=new FE({props:{key:"SMUI:textfield:icon:leading",value:!0,$$slots:{default:[wB]},$$scope:{ctx:n}}});const z=n[56].default,V=Ri(z,n,n[87],null);l=new FE({props:{key:"SMUI:textfield:icon:leading",value:!1,$$slots:{default:[SB]},$$scope:{ctx:n}}});const Y=n[56].ripple,Q=Ri(Y,n,n[87],S2);let J=[{class:d=In({[n[9]]:!0,"mdc-text-field":!0,"mdc-text-field--disabled":n[12],"mdc-text-field--textarea":n[14],"mdc-text-field--filled":n[15]==="filled","mdc-text-field--outlined":n[15]==="outlined","smui-text-field--standard":n[15]==="standard"&&!n[14],"mdc-text-field--no-label":n[16]||!n[47].label,"mdc-text-field--with-leading-icon":n[47].leadingIcon,"mdc-text-field--with-trailing-icon":n[47].trailingIcon,"mdc-text-field--invalid":n[1],...n[25]})},{style:g=Object.entries(n[26]).map(X2).concat([n[10]]).join(" ")},jo(n[46],["input$","label$","ripple$","outline$","helperLine$"])],he={};for(let ee=0;ee<J.length;ee+=1)he=zt(he,J[ee]);return{c(){e=qt("div"),F&&F.c(),t=vn(),sn(i.$$.fragment),r=vn(),V&&V.c(),a=vn(),sn(l.$$.fragment),s=vn(),Q&&Q.c(),this.h()},l(ee){e=Wt(ee,"DIV",{class:!0,style:!0});var ae=Qt(e);F&&F.l(ae),t=bn(ae),dn(i.$$.fragment,ae),r=bn(ae),V&&V.l(ae),a=bn(ae),dn(l.$$.fragment,ae),s=bn(ae),Q&&Q.l(ae),ae.forEach(de),this.h()},h(){Xn(e,he)},m(ee,ae){tt(ee,e,ae),F&&F.m(e,null),Kt(e,t),on(i,e,null),Kt(e,r),V&&V.m(e,null),Kt(e,a),on(l,e,null),Kt(e,s),Q&&Q.m(e,null),n[82](e),A=!0,L||(N=[li(x=jc.call(null,e,{ripple:n[11],unbounded:!1,addClass:n[43],removeClass:n[44],addStyle:n[45]})),li(I=jr.call(null,e,n[8])),li(n[34].call(null,e)),qn(e,"SMUITextfieldLeadingIcon:mount",n[38]),qn(e,"SMUITextfieldLeadingIcon:unmount",n[83]),qn(e,"SMUITextfieldTrailingIcon:mount",n[39]),qn(e,"SMUITextfieldTrailingIcon:unmount",n[84])],L=!0)},p(ee,ae){F&&F.p&&(!A||ae[2]&33554432)&&Pi(F,B,ee,ee[87],A?Oi(B,ee[87],ae,mB):Di(ee[87]),M2);const De={};ae[2]&33554432&&(De.$$scope={dirty:ae,ctx:ee}),i.$set(De),V&&V.p&&(!A||ae[2]&33554432)&&Pi(V,z,ee,ee[87],A?Oi(z,ee[87],ae,null):Di(ee[87]),null);const fe={};ae[2]&33554432&&(fe.$$scope={dirty:ae,ctx:ee}),l.$set(fe),Q&&Q.p&&(!A||ae[2]&33554432)&&Pi(Q,Y,ee,ee[87],A?Oi(Y,ee[87],ae,fB):Di(ee[87]),S2),Xn(e,he=hi(J,[(!A||ae[0]&33673730|ae[1]&65536&&d!==(d=In({[ee[9]]:!0,"mdc-text-field":!0,"mdc-text-field--disabled":ee[12],"mdc-text-field--textarea":ee[14],"mdc-text-field--filled":ee[15]==="filled","mdc-text-field--outlined":ee[15]==="outlined","smui-text-field--standard":ee[15]==="standard"&&!ee[14],"mdc-text-field--no-label":ee[16]||!ee[47].label,"mdc-text-field--with-leading-icon":ee[47].leadingIcon,"mdc-text-field--with-trailing-icon":ee[47].trailingIcon,"mdc-text-field--invalid":ee[1],...ee[25]})))&&{class:d},(!A||ae[0]&67109888&&g!==(g=Object.entries(ee[26]).map(X2).concat([ee[10]]).join(" ")))&&{style:g},ae[1]&32768&&jo(ee[46],["input$","label$","ripple$","outline$","helperLine$"])])),x&&Gi(x.update)&&ae[0]&2048&&x.update.call(null,{ripple:ee[11],unbounded:!1,addClass:ee[43],removeClass:ee[44],addStyle:ee[45]}),I&&Gi(I.update)&&ae[0]&256&&I.update.call(null,ee[8])},i(ee){A||(Te(F,ee),Te(i.$$.fragment,ee),Te(V,ee),Te(l.$$.fragment,ee),Te(Q,ee),A=!0)},o(ee){Ne(F,ee),Ne(i.$$.fragment,ee),Ne(V,ee),Ne(l.$$.fragment,ee),Ne(Q,ee),A=!1},d(ee){ee&&de(e),F&&F.d(ee),an(i),V&&V.d(ee),an(l),Q&&Q.d(ee),n[82](null),L=!1,Ss(N)}}}function TB(n){let e,t,i,r,a,l,s,d,g,x,I,A,L,N,B,F,z,V,Y=!n[14]&&n[15]!=="outlined"&&F2(n),Q=(n[14]||n[15]==="outlined")&&U2(n);r=new FE({props:{key:"SMUI:textfield:icon:leading",value:!0,$$slots:{default:[LB]},$$scope:{ctx:n}}});const J=n[56].default,he=Ri(J,n,n[87],null),ee=[PB,RB],ae=[];function De(Pe,Ce){return Pe[14]&&typeof Pe[0]=="string"?0:1}s=De(n),d=ae[s]=ee[s](n),x=new FE({props:{key:"SMUI:textfield:icon:leading",value:!1,$$slots:{default:[NB]},$$scope:{ctx:n}}});let fe=!n[14]&&n[15]!=="outlined"&&n[11]&&j2(n),le=[{class:A=In({[n[9]]:!0,"mdc-text-field":!0,"mdc-text-field--disabled":n[12],"mdc-text-field--textarea":n[14],"mdc-text-field--filled":n[15]==="filled","mdc-text-field--outlined":n[15]==="outlined","smui-text-field--standard":n[15]==="standard"&&!n[14],"mdc-text-field--no-label":n[16]||n[17]==null&&!n[47].label,"mdc-text-field--label-floating":n[28]||n[0]!=null&&n[0]!=="","mdc-text-field--with-leading-icon":n[35](n[22])?n[47].leadingIcon:n[22],"mdc-text-field--with-trailing-icon":n[35](n[23])?n[47].trailingIcon:n[23],"mdc-text-field--with-internal-counter":n[14]&&n[47].internalCounter,"mdc-text-field--invalid":n[1],...n[25]})},{style:L=Object.entries(n[26]).map(W2).concat([n[10]]).join(" ")},{for:void 0},jo(n[46],["input$","label$","ripple$","outline$","helperLine$"])],Be={};for(let Pe=0;Pe<le.length;Pe+=1)Be=zt(Be,le[Pe]);return{c(){e=qt("label"),Y&&Y.c(),t=vn(),Q&&Q.c(),i=vn(),sn(r.$$.fragment),a=vn(),he&&he.c(),l=vn(),d.c(),g=vn(),sn(x.$$.fragment),I=vn(),fe&&fe.c(),this.h()},l(Pe){e=Wt(Pe,"LABEL",{class:!0,style:!0,for:!0});var Ce=Qt(e);Y&&Y.l(Ce),t=bn(Ce),Q&&Q.l(Ce),i=bn(Ce),dn(r.$$.fragment,Ce),a=bn(Ce),he&&he.l(Ce),l=bn(Ce),d.l(Ce),g=bn(Ce),dn(x.$$.fragment,Ce),I=bn(Ce),fe&&fe.l(Ce),Ce.forEach(de),this.h()},h(){Xn(e,Be)},m(Pe,Ce){tt(Pe,e,Ce),Y&&Y.m(e,null),Kt(e,t),Q&&Q.m(e,null),Kt(e,i),on(r,e,null),Kt(e,a),he&&he.m(e,null),Kt(e,l),ae[s].m(e,null),Kt(e,g),on(x,e,null),Kt(e,I),fe&&fe.m(e,null),n[78](e),F=!0,z||(V=[li(N=jc.call(null,e,{ripple:!n[14]&&n[15]==="filled",unbounded:!1,addClass:n[43],removeClass:n[44],addStyle:n[45],eventTarget:n[33],activeTarget:n[33],initPromise:n[37]})),li(B=jr.call(null,e,n[8])),li(n[34].call(null,e)),qn(e,"SMUITextfieldLeadingIcon:mount",n[38]),qn(e,"SMUITextfieldLeadingIcon:unmount",n[79]),qn(e,"SMUITextfieldTrailingIcon:mount",n[39]),qn(e,"SMUITextfieldTrailingIcon:unmount",n[80]),qn(e,"SMUITextfieldCharacterCounter:mount",n[40]),qn(e,"SMUITextfieldCharacterCounter:unmount",n[81])],z=!0)},p(Pe,Ce){!Pe[14]&&Pe[15]!=="outlined"?Y?(Y.p(Pe,Ce),Ce[0]&49152&&Te(Y,1)):(Y=F2(Pe),Y.c(),Te(Y,1),Y.m(e,t)):Y&&(Wi(),Ne(Y,1,1,()=>{Y=null}),Xi()),Pe[14]||Pe[15]==="outlined"?Q?(Q.p(Pe,Ce),Ce[0]&49152&&Te(Q,1)):(Q=U2(Pe),Q.c(),Te(Q,1),Q.m(e,i)):Q&&(Wi(),Ne(Q,1,1,()=>{Q=null}),Xi());const it={};Ce[2]&33554432&&(it.$$scope={dirty:Ce,ctx:Pe}),r.$set(it),he&&he.p&&(!F||Ce[2]&33554432)&&Pi(he,J,Pe,Pe[87],F?Oi(J,Pe[87],Ce,null):Di(Pe[87]),null);let Et=s;s=De(Pe),s===Et?ae[s].p(Pe,Ce):(Wi(),Ne(ae[Et],1,1,()=>{ae[Et]=null}),Xi(),d=ae[s],d?d.p(Pe,Ce):(d=ae[s]=ee[s](Pe),d.c()),Te(d,1),d.m(e,g));const Ue={};Ce[2]&33554432&&(Ue.$$scope={dirty:Ce,ctx:Pe}),x.$set(Ue),!Pe[14]&&Pe[15]!=="outlined"&&Pe[11]?fe?(fe.p(Pe,Ce),Ce[0]&51200&&Te(fe,1)):(fe=j2(Pe),fe.c(),Te(fe,1),fe.m(e,null)):fe&&(Wi(),Ne(fe,1,1,()=>{fe=null}),Xi()),Xn(e,Be=hi(le,[(!F||Ce[0]&314823171|Ce[1]&65536&&A!==(A=In({[Pe[9]]:!0,"mdc-text-field":!0,"mdc-text-field--disabled":Pe[12],"mdc-text-field--textarea":Pe[14],"mdc-text-field--filled":Pe[15]==="filled","mdc-text-field--outlined":Pe[15]==="outlined","smui-text-field--standard":Pe[15]==="standard"&&!Pe[14],"mdc-text-field--no-label":Pe[16]||Pe[17]==null&&!Pe[47].label,"mdc-text-field--label-floating":Pe[28]||Pe[0]!=null&&Pe[0]!=="","mdc-text-field--with-leading-icon":Pe[35](Pe[22])?Pe[47].leadingIcon:Pe[22],"mdc-text-field--with-trailing-icon":Pe[35](Pe[23])?Pe[47].trailingIcon:Pe[23],"mdc-text-field--with-internal-counter":Pe[14]&&Pe[47].internalCounter,"mdc-text-field--invalid":Pe[1],...Pe[25]})))&&{class:A},(!F||Ce[0]&67109888&&L!==(L=Object.entries(Pe[26]).map(W2).concat([Pe[10]]).join(" ")))&&{style:L},{for:void 0},Ce[1]&32768&&jo(Pe[46],["input$","label$","ripple$","outline$","helperLine$"])])),N&&Gi(N.update)&&Ce[0]&49152|Ce[1]&4&&N.update.call(null,{ripple:!Pe[14]&&Pe[15]==="filled",unbounded:!1,addClass:Pe[43],removeClass:Pe[44],addStyle:Pe[45],eventTarget:Pe[33],activeTarget:Pe[33],initPromise:Pe[37]}),B&&Gi(B.update)&&Ce[0]&256&&B.update.call(null,Pe[8])},i(Pe){F||(Te(Y),Te(Q),Te(r.$$.fragment,Pe),Te(he,Pe),Te(d),Te(x.$$.fragment,Pe),Te(fe),F=!0)},o(Pe){Ne(Y),Ne(Q),Ne(r.$$.fragment,Pe),Ne(he,Pe),Ne(d),Ne(x.$$.fragment,Pe),Ne(fe),F=!1},d(Pe){Pe&&de(e),Y&&Y.d(),Q&&Q.d(),an(r),he&&he.d(Pe),ae[s].d(),an(x),fe&&fe.d(),n[78](null),z=!1,Ss(V)}}}function wB(n){let e;const t=n[56].leadingIcon,i=Ri(t,n,n[87],A2);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a[2]&33554432)&&Pi(i,t,r,r[87],e?Oi(t,r[87],a,pB):Di(r[87]),A2)},i(r){e||(Te(i,r),e=!0)},o(r){Ne(i,r),e=!1},d(r){i&&i.d(r)}}}function SB(n){let e;const t=n[56].trailingIcon,i=Ri(t,n,n[87],C2);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a[2]&33554432)&&Pi(i,t,r,r[87],e?Oi(t,r[87],a,dB):Di(r[87]),C2)},i(r){e||(Te(i,r),e=!0)},o(r){Ne(i,r),e=!1},d(r){i&&i.d(r)}}}function F2(n){let e,t,i,r=n[15]==="filled"&&B2(),a=!n[16]&&(n[17]!=null||n[47].label)&&z2(n);return{c(){r&&r.c(),e=vn(),a&&a.c(),t=pi()},l(l){r&&r.l(l),e=bn(l),a&&a.l(l),t=pi()},m(l,s){r&&r.m(l,s),tt(l,e,s),a&&a.m(l,s),tt(l,t,s),i=!0},p(l,s){l[15]==="filled"?r||(r=B2(),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),!l[16]&&(l[17]!=null||l[47].label)?a?(a.p(l,s),s[0]&196608|s[1]&65536&&Te(a,1)):(a=z2(l),a.c(),Te(a,1),a.m(t.parentNode,t)):a&&(Wi(),Ne(a,1,1,()=>{a=null}),Xi())},i(l){i||(Te(a),i=!0)},o(l){Ne(a),i=!1},d(l){r&&r.d(l),l&&de(e),a&&a.d(l),l&&de(t)}}}function B2(n){let e;return{c(){e=qt("span"),this.h()},l(t){e=Wt(t,"SPAN",{class:!0}),Qt(e).forEach(de),this.h()},h(){tn(e,"class","mdc-text-field__ripple")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function z2(n){let e,t;const i=[{floatAbove:n[28]||n[0]!=null&&n[0]!==""&&(typeof n[0]!="number"||!isNaN(n[0]))},{required:n[13]},{wrapped:!0},gi(n[46],"label$")];let r={$$slots:{default:[CB]},$$scope:{ctx:n}};for(let a=0;a<i.length;a+=1)r=zt(r,i[a]);return e=new pI({props:r}),n[57](e),{c(){sn(e.$$.fragment)},l(a){dn(e.$$.fragment,a)},m(a,l){on(e,a,l),t=!0},p(a,l){const s=l[0]&268443649|l[1]&32768?hi(i,[l[0]&268435457&&{floatAbove:a[28]||a[0]!=null&&a[0]!==""&&(typeof a[0]!="number"||!isNaN(a[0]))},l[0]&8192&&{required:a[13]},i[2],l[1]&32768&&Mr(gi(a[46],"label$"))]):{};l[0]&131072|l[2]&33554432&&(s.$$scope={dirty:l,ctx:a}),e.$set(s)},i(a){t||(Te(e.$$.fragment,a),t=!0)},o(a){Ne(e.$$.fragment,a),t=!1},d(a){n[57](null),an(e,a)}}}function CB(n){let e=(n[17]==null?"":n[17])+"",t,i;const r=n[56].label,a=Ri(r,n,n[87],k2);return{c(){t=_i(e),a&&a.c()},l(l){t=yi(l,e),a&&a.l(l)},m(l,s){tt(l,t,s),a&&a.m(l,s),i=!0},p(l,s){(!i||s[0]&131072)&&e!==(e=(l[17]==null?"":l[17])+"")&&ys(t,e),a&&a.p&&(!i||s[2]&33554432)&&Pi(a,r,l,l[87],i?Oi(r,l[87],s,EB):Di(l[87]),k2)},i(l){i||(Te(a,l),i=!0)},o(l){Ne(a,l),i=!1},d(l){l&&de(t),a&&a.d(l)}}}function U2(n){let e,t;const i=[{noLabel:n[16]||n[17]==null&&!n[47].label},gi(n[46],"outline$")];let r={$$slots:{default:[MB]},$$scope:{ctx:n}};for(let a=0;a<i.length;a+=1)r=zt(r,i[a]);return e=new QL({props:r}),n[59](e),{c(){sn(e.$$.fragment)},l(a){dn(e.$$.fragment,a)},m(a,l){on(e,a,l),t=!0},p(a,l){const s=l[0]&196608|l[1]&98304?hi(i,[l[0]&196608|l[1]&65536&&{noLabel:a[16]||a[17]==null&&!a[47].label},l[1]&32768&&Mr(gi(a[46],"outline$"))]):{};l[0]&268640289|l[1]&98304|l[2]&33554432&&(s.$$scope={dirty:l,ctx:a}),e.$set(s)},i(a){t||(Te(e.$$.fragment,a),t=!0)},o(a){Ne(e.$$.fragment,a),t=!1},d(a){n[59](null),an(e,a)}}}function V2(n){let e,t;const i=[{floatAbove:n[28]||n[0]!=null&&n[0]!==""&&(typeof n[0]!="number"||!isNaN(n[0]))},{required:n[13]},{wrapped:!0},gi(n[46],"label$")];let r={$$slots:{default:[AB]},$$scope:{ctx:n}};for(let a=0;a<i.length;a+=1)r=zt(r,i[a]);return e=new pI({props:r}),n[58](e),{c(){sn(e.$$.fragment)},l(a){dn(e.$$.fragment,a)},m(a,l){on(e,a,l),t=!0},p(a,l){const s=l[0]&268443649|l[1]&32768?hi(i,[l[0]&268435457&&{floatAbove:a[28]||a[0]!=null&&a[0]!==""&&(typeof a[0]!="number"||!isNaN(a[0]))},l[0]&8192&&{required:a[13]},i[2],l[1]&32768&&Mr(gi(a[46],"label$"))]):{};l[0]&131072|l[2]&33554432&&(s.$$scope={dirty:l,ctx:a}),e.$set(s)},i(a){t||(Te(e.$$.fragment,a),t=!0)},o(a){Ne(e.$$.fragment,a),t=!1},d(a){n[58](null),an(e,a)}}}function AB(n){let e=(n[17]==null?"":n[17])+"",t,i;const r=n[56].label,a=Ri(r,n,n[87],N2);return{c(){t=_i(e),a&&a.c()},l(l){t=yi(l,e),a&&a.l(l)},m(l,s){tt(l,t,s),a&&a.m(l,s),i=!0},p(l,s){(!i||s[0]&131072)&&e!==(e=(l[17]==null?"":l[17])+"")&&ys(t,e),a&&a.p&&(!i||s[2]&33554432)&&Pi(a,r,l,l[87],i?Oi(r,l[87],s,xB):Di(l[87]),N2)},i(l){i||(Te(a,l),i=!0)},o(l){Ne(a,l),i=!1},d(l){l&&de(t),a&&a.d(l)}}}function MB(n){let e,t,i=!n[16]&&(n[17]!=null||n[47].label)&&V2(n);return{c(){i&&i.c(),e=pi()},l(r){i&&i.l(r),e=pi()},m(r,a){i&&i.m(r,a),tt(r,e,a),t=!0},p(r,a){!r[16]&&(r[17]!=null||r[47].label)?i?(i.p(r,a),a[0]&196608|a[1]&65536&&Te(i,1)):(i=V2(r),i.c(),Te(i,1),i.m(e.parentNode,e)):i&&(Wi(),Ne(i,1,1,()=>{i=null}),Xi())},i(r){t||(Te(i),t=!0)},o(r){Ne(i),t=!1},d(r){i&&i.d(r),r&&de(e)}}}function LB(n){let e;const t=n[56].leadingIcon,i=Ri(t,n,n[87],O2);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a[2]&33554432)&&Pi(i,t,r,r[87],e?Oi(t,r[87],a,bB):Di(r[87]),O2)},i(r){e||(Te(i,r),e=!0)},o(r){Ne(i,r),e=!1},d(r){i&&i.d(r)}}}function RB(n){let e,t,i,r,a,l,s,d,g,x;const I=n[56].prefix,A=Ri(I,n,n[87],P2);let L=n[20]!=null&&G2(n);const N=[{type:n[18]},{disabled:n[12]},{required:n[13]},{updateInvalid:n[19]},{"aria-controls":n[27]},{"aria-describedby":n[27]},n[16]&&n[17]!=null?{placeholder:n[17]}:{},gi(n[46],"input$")];function B(ee){n[69](ee)}function F(ee){n[70](ee)}function z(ee){n[71](ee)}function V(ee){n[72](ee)}let Y={};for(let ee=0;ee<N.length;ee+=1)Y=zt(Y,N[ee]);n[0]!==void 0&&(Y.value=n[0]),n[3]!==void 0&&(Y.files=n[3]),n[4]!==void 0&&(Y.dirty=n[4]),n[1]!==void 0&&(Y.invalid=n[1]),i=new aB({props:Y}),n[68](i),Sn.push(()=>Xr(i,"value",B)),Sn.push(()=>Xr(i,"files",F)),Sn.push(()=>Xr(i,"dirty",z)),Sn.push(()=>Xr(i,"invalid",V)),i.$on("blur",n[73]),i.$on("focus",n[74]),i.$on("blur",n[75]),i.$on("focus",n[76]);let Q=n[21]!=null&&H2(n);const J=n[56].suffix,he=Ri(J,n,n[87],R2);return{c(){A&&A.c(),e=vn(),L&&L.c(),t=vn(),sn(i.$$.fragment),d=vn(),Q&&Q.c(),g=vn(),he&&he.c()},l(ee){A&&A.l(ee),e=bn(ee),L&&L.l(ee),t=bn(ee),dn(i.$$.fragment,ee),d=bn(ee),Q&&Q.l(ee),g=bn(ee),he&&he.l(ee)},m(ee,ae){A&&A.m(ee,ae),tt(ee,e,ae),L&&L.m(ee,ae),tt(ee,t,ae),on(i,ee,ae),tt(ee,d,ae),Q&&Q.m(ee,ae),tt(ee,g,ae),he&&he.m(ee,ae),x=!0},p(ee,ae){A&&A.p&&(!x||ae[2]&33554432)&&Pi(A,I,ee,ee[87],x?Oi(I,ee[87],ae,yB):Di(ee[87]),P2),ee[20]!=null?L?(L.p(ee,ae),ae[0]&1048576&&Te(L,1)):(L=G2(ee),L.c(),Te(L,1),L.m(t.parentNode,t)):L&&(Wi(),Ne(L,1,1,()=>{L=null}),Xi());const De=ae[0]&135213056|ae[1]&32768?hi(N,[ae[0]&262144&&{type:ee[18]},ae[0]&4096&&{disabled:ee[12]},ae[0]&8192&&{required:ee[13]},ae[0]&524288&&{updateInvalid:ee[19]},ae[0]&134217728&&{"aria-controls":ee[27]},ae[0]&134217728&&{"aria-describedby":ee[27]},ae[0]&196608&&Mr(ee[16]&&ee[17]!=null?{placeholder:ee[17]}:{}),ae[1]&32768&&Mr(gi(ee[46],"input$"))]):{};!r&&ae[0]&1&&(r=!0,De.value=ee[0],Qr(()=>r=!1)),!a&&ae[0]&8&&(a=!0,De.files=ee[3],Qr(()=>a=!1)),!l&&ae[0]&16&&(l=!0,De.dirty=ee[4],Qr(()=>l=!1)),!s&&ae[0]&2&&(s=!0,De.invalid=ee[1],Qr(()=>s=!1)),i.$set(De),ee[21]!=null?Q?(Q.p(ee,ae),ae[0]&2097152&&Te(Q,1)):(Q=H2(ee),Q.c(),Te(Q,1),Q.m(g.parentNode,g)):Q&&(Wi(),Ne(Q,1,1,()=>{Q=null}),Xi()),he&&he.p&&(!x||ae[2]&33554432)&&Pi(he,J,ee,ee[87],x?Oi(J,ee[87],ae,_B):Di(ee[87]),R2)},i(ee){x||(Te(A,ee),Te(L),Te(i.$$.fragment,ee),Te(Q),Te(he,ee),x=!0)},o(ee){Ne(A,ee),Ne(L),Ne(i.$$.fragment,ee),Ne(Q),Ne(he,ee),x=!1},d(ee){A&&A.d(ee),ee&&de(e),L&&L.d(ee),ee&&de(t),n[68](null),an(i,ee),ee&&de(d),Q&&Q.d(ee),ee&&de(g),he&&he.d(ee)}}}function PB(n){let e,t,i,r,a,l,s,d;const g=[{disabled:n[12]},{required:n[13]},{updateInvalid:n[19]},{"aria-controls":n[27]},{"aria-describedby":n[27]},gi(n[46],"input$")];function x(F){n[61](F)}function I(F){n[62](F)}function A(F){n[63](F)}let L={};for(let F=0;F<g.length;F+=1)L=zt(L,g[F]);n[0]!==void 0&&(L.value=n[0]),n[4]!==void 0&&(L.dirty=n[4]),n[1]!==void 0&&(L.invalid=n[1]),t=new cB({props:L}),n[60](t),Sn.push(()=>Xr(t,"value",x)),Sn.push(()=>Xr(t,"dirty",I)),Sn.push(()=>Xr(t,"invalid",A)),t.$on("blur",n[64]),t.$on("focus",n[65]),t.$on("blur",n[66]),t.$on("focus",n[67]);const N=n[56].internalCounter,B=Ri(N,n,n[87],D2);return{c(){e=qt("span"),sn(t.$$.fragment),l=vn(),B&&B.c(),this.h()},l(F){e=Wt(F,"SPAN",{class:!0});var z=Qt(e);dn(t.$$.fragment,z),l=bn(z),B&&B.l(z),z.forEach(de),this.h()},h(){tn(e,"class",s=In({"mdc-text-field__resizer":!("input$resizable"in n[46])||n[46].input$resizable}))},m(F,z){tt(F,e,z),on(t,e,null),Kt(e,l),B&&B.m(e,null),d=!0},p(F,z){const V=z[0]&134754304|z[1]&32768?hi(g,[z[0]&4096&&{disabled:F[12]},z[0]&8192&&{required:F[13]},z[0]&524288&&{updateInvalid:F[19]},z[0]&134217728&&{"aria-controls":F[27]},z[0]&134217728&&{"aria-describedby":F[27]},z[1]&32768&&Mr(gi(F[46],"input$"))]):{};!i&&z[0]&1&&(i=!0,V.value=F[0],Qr(()=>i=!1)),!r&&z[0]&16&&(r=!0,V.dirty=F[4],Qr(()=>r=!1)),!a&&z[0]&2&&(a=!0,V.invalid=F[1],Qr(()=>a=!1)),t.$set(V),B&&B.p&&(!d||z[2]&33554432)&&Pi(B,N,F,F[87],d?Oi(N,F[87],z,vB):Di(F[87]),D2),(!d||z[1]&32768&&s!==(s=In({"mdc-text-field__resizer":!("input$resizable"in F[46])||F[46].input$resizable})))&&tn(e,"class",s)},i(F){d||(Te(t.$$.fragment,F),Te(B,F),d=!0)},o(F){Ne(t.$$.fragment,F),Ne(B,F),d=!1},d(F){F&&de(e),n[60](null),an(t),B&&B.d(F)}}}function G2(n){let e,t;return e=new nB({props:{$$slots:{default:[DB]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,r){on(e,i,r),t=!0},p(i,r){const a={};r[0]&1048576|r[2]&33554432&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Te(e.$$.fragment,i),t=!0)},o(i){Ne(e.$$.fragment,i),t=!1},d(i){an(e,i)}}}function DB(n){let e;return{c(){e=_i(n[20])},l(t){e=yi(t,n[20])},m(t,i){tt(t,e,i)},p(t,i){i[0]&1048576&&ys(e,t[20])},d(t){t&&de(e)}}}function H2(n){let e,t;return e=new iB({props:{$$slots:{default:[OB]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,r){on(e,i,r),t=!0},p(i,r){const a={};r[0]&2097152|r[2]&33554432&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Te(e.$$.fragment,i),t=!0)},o(i){Ne(e.$$.fragment,i),t=!1},d(i){an(e,i)}}}function OB(n){let e;return{c(){e=_i(n[21])},l(t){e=yi(t,n[21])},m(t,i){tt(t,e,i)},p(t,i){i[0]&2097152&&ys(e,t[21])},d(t){t&&de(e)}}}function NB(n){let e;const t=n[56].trailingIcon,i=Ri(t,n,n[87],L2);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a[2]&33554432)&&Pi(i,t,r,r[87],e?Oi(t,r[87],a,gB):Di(r[87]),L2)},i(r){e||(Te(i,r),e=!0)},o(r){Ne(i,r),e=!1},d(r){i&&i.d(r)}}}function j2(n){let e,t;const i=[gi(n[46],"ripple$")];let r={};for(let a=0;a<i.length;a+=1)r=zt(r,i[a]);return e=new JL({props:r}),n[77](e),{c(){sn(e.$$.fragment)},l(a){dn(e.$$.fragment,a)},m(a,l){on(e,a,l),t=!0},p(a,l){const s=l[1]&32768?hi(i,[Mr(gi(a[46],"ripple$"))]):{};e.$set(s)},i(a){t||(Te(e.$$.fragment,a),t=!0)},o(a){Ne(e.$$.fragment,a),t=!1},d(a){n[77](null),an(e,a)}}}function q2(n){let e,t;const i=[gi(n[46],"helperLine$")];let r={$$slots:{default:[kB]},$$scope:{ctx:n}};for(let a=0;a<i.length;a+=1)r=zt(r,i[a]);return e=new tB({props:r}),e.$on("SMUITextfieldHelperText:id",n[41]),e.$on("SMUITextfieldHelperText:mount",n[42]),e.$on("SMUITextfieldHelperText:unmount",n[85]),e.$on("SMUITextfieldCharacterCounter:mount",n[40]),e.$on("SMUITextfieldCharacterCounter:unmount",n[86]),{c(){sn(e.$$.fragment)},l(a){dn(e.$$.fragment,a)},m(a,l){on(e,a,l),t=!0},p(a,l){const s=l[1]&32768?hi(i,[Mr(gi(a[46],"helperLine$"))]):{};l[2]&33554432&&(s.$$scope={dirty:l,ctx:a}),e.$set(s)},i(a){t||(Te(e.$$.fragment,a),t=!0)},o(a){Ne(e.$$.fragment,a),t=!1},d(a){an(e,a)}}}function kB(n){let e;const t=n[56].helper,i=Ri(t,n,n[87],w2);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a[2]&33554432)&&Pi(i,t,r,r[87],e?Oi(t,r[87],a,hB):Di(r[87]),w2)},i(r){e||(Te(i,r),e=!0)},o(r){Ne(i,r),e=!1},d(r){i&&i.d(r)}}}function FB(n){let e,t,i,r,a;const l=[TB,IB],s=[];function d(x,I){return x[36]?0:1}e=d(n),t=s[e]=l[e](n);let g=n[47].helper&&q2(n);return{c(){t.c(),i=vn(),g&&g.c(),r=pi()},l(x){t.l(x),i=bn(x),g&&g.l(x),r=pi()},m(x,I){s[e].m(x,I),tt(x,i,I),g&&g.m(x,I),tt(x,r,I),a=!0},p(x,I){t.p(x,I),x[47].helper?g?(g.p(x,I),I[1]&65536&&Te(g,1)):(g=q2(x),g.c(),Te(g,1),g.m(r.parentNode,r)):g&&(Wi(),Ne(g,1,1,()=>{g=null}),Xi())},i(x){a||(Te(t),Te(g),a=!0)},o(x){Ne(t),Ne(g),a=!1},d(x){s[e].d(x),x&&de(i),g&&g.d(x),x&&de(r)}}}const W2=([n,e])=>`${n}: ${e};`,X2=([n,e])=>`${n}: ${e};`;function BB(n,e,t){let i;const r=["use","class","style","ripple","disabled","required","textarea","variant","noLabel","label","type","value","files","invalid","updateInvalid","dirty","prefix","suffix","validateOnValueChange","useNativeValidation","withLeadingIcon","withTrailingIcon","input","floatingLabel","lineRipple","notchedOutline","focus","blur","layout","getElement"];let a=vi(e,r),{$$slots:l={},$$scope:s}=e;const d=uI(l),{applyPassive:g}=gL,x=ps(ds());let I=()=>{};function A(be){return be===I}let{use:L=[]}=e,{class:N=""}=e,{style:B=""}=e,{ripple:F=!0}=e,{disabled:z=!1}=e,{required:V=!1}=e,{textarea:Y=!1}=e,{variant:Q=Y?"outlined":"standard"}=e,{noLabel:J=!1}=e,{label:he=void 0}=e,{type:ee="text"}=e,{value:ae=a.input$emptyValueUndefined?void 0:I}=e,{files:De=I}=e;const fe=!A(ae)||!A(De);A(ae)&&(ae=void 0),A(De)&&(De=null);let{invalid:le=I}=e,{updateInvalid:Be=A(le)}=e;A(le)&&(le=!1);let{dirty:Pe=!1}=e,{prefix:Ce=void 0}=e,{suffix:it=void 0}=e,{validateOnValueChange:Et=Be}=e,{useNativeValidation:Ue=Be}=e,{withLeadingIcon:at=I}=e,{withTrailingIcon:ke=I}=e,{input:Dt=void 0}=e,{floatingLabel:fn=void 0}=e,{lineRipple:Cn=void 0}=e,{notchedOutline:Gt=void 0}=e,Mt,vt,xn={},En={},_t,kt=!1,Ct=Fr("SMUI:addLayoutListener"),Bt,Zn,mi=new Promise(be=>Zn=be),yn,Pt,Yn,si,Dr=ae;Ct&&(Bt=Ct(Xt)),ro(()=>{if(t(54,vt=new W4({addClass:Ei,removeClass:ni,hasClass:kn,registerTextFieldInteractionHandler:(be,Ot)=>Rn().addEventListener(be,Ot),deregisterTextFieldInteractionHandler:(be,Ot)=>Rn().removeEventListener(be,Ot),registerValidationAttributeChangeHandler:be=>{const Ot=ei=>ei.map(Ye=>Ye.attributeName).filter(Ye=>Ye),On=new MutationObserver(ei=>{Ue&&be(Ot(ei))}),ii={attributes:!0};return Dt&&On.observe(Dt.getElement(),ii),On},deregisterValidationAttributeChangeHandler:be=>{be.disconnect()},getNativeInput:()=>{var be;return(be=Dt==null?void 0:Dt.getElement())!==null&&be!==void 0?be:null},setInputAttr:(be,Ot)=>{Dt==null||Dt.addAttr(be,Ot)},removeInputAttr:be=>{Dt==null||Dt.removeAttr(be)},isFocused:()=>document.activeElement===(Dt==null?void 0:Dt.getElement()),registerInputInteractionHandler:(be,Ot)=>{Dt==null||Dt.getElement().addEventListener(be,Ot,g())},deregisterInputInteractionHandler:(be,Ot)=>{Dt==null||Dt.getElement().removeEventListener(be,Ot,g())},floatLabel:be=>fn&&fn.float(be),getLabelWidth:()=>fn?fn.getWidth():0,hasLabel:()=>!!fn,shakeLabel:be=>fn&&fn.shake(be),setLabelRequired:be=>fn&&fn.setRequired(be),activateLineRipple:()=>Cn&&Cn.activate(),deactivateLineRipple:()=>Cn&&Cn.deactivate(),setLineRippleTransformOrigin:be=>Cn&&Cn.setRippleCenter(be),closeOutline:()=>Gt&&Gt.closeNotch(),hasOutline:()=>!!Gt,notchOutline:be=>Gt&&Gt.notch(be)},{get helperText(){return Yn},get characterCounter(){return si},get leadingIcon(){return yn},get trailingIcon(){return Pt}})),fe){if(Dt==null)throw new Error("SMUI Textfield initialized without Input component.");vt.init()}else kP().then(()=>{if(Dt==null)throw new Error("SMUI Textfield initialized without Input component.");vt.init()});return Zn(),()=>{vt.destroy()}}),Dh(()=>{Bt&&Bt()});function Ur(be){t(29,yn=be.detail)}function He(be){t(30,Pt=be.detail)}function Jt(be){t(32,si=be.detail)}function ui(be){t(27,_t=be.detail)}function $e(be){t(31,Yn=be.detail)}function kn(be){var Ot;return be in xn?(Ot=xn[be])!==null&&Ot!==void 0?Ot:null:Rn().classList.contains(be)}function Ei(be){xn[be]||t(25,xn[be]=!0,xn)}function ni(be){(!(be in xn)||xn[be])&&t(25,xn[be]=!1,xn)}function Ln(be,Ot){En[be]!=Ot&&(Ot===""||Ot==null?(delete En[be],t(26,En)):t(26,En[be]=Ot,En))}function ki(){Dt==null||Dt.focus()}function Hs(){Dt==null||Dt.blur()}function Xt(){if(vt){const be=vt.shouldFloat;vt.notchOutline(be)}}function Rn(){return Mt}function ti(be){Sn[be?"unshift":"push"](()=>{fn=be,t(5,fn)})}function tr(be){Sn[be?"unshift":"push"](()=>{fn=be,t(5,fn)})}function js(be){Sn[be?"unshift":"push"](()=>{Gt=be,t(7,Gt)})}function mo(be){Sn[be?"unshift":"push"](()=>{Dt=be,t(2,Dt)})}function ca(be){ae=be,t(0,ae)}function Xo(be){Pe=be,t(4,Pe)}function qs(be){le=be,t(1,le),t(54,vt),t(19,Be)}const No=()=>t(28,kt=!1),Ja=()=>t(28,kt=!0),go=be=>ji(Mt,"blur",be),Ma=be=>ji(Mt,"focus",be);function Vl(be){Sn[be?"unshift":"push"](()=>{Dt=be,t(2,Dt)})}function Qa(be){ae=be,t(0,ae)}function ha(be){De=be,t(3,De)}function $a(be){Pe=be,t(4,Pe)}function Zs(be){le=be,t(1,le),t(54,vt),t(19,Be)}const La=()=>t(28,kt=!1),so=()=>t(28,kt=!0),Ra=be=>ji(Mt,"blur",be),we=be=>ji(Mt,"focus",be);function te(be){Sn[be?"unshift":"push"](()=>{Cn=be,t(6,Cn)})}function re(be){Sn[be?"unshift":"push"](()=>{Mt=be,t(24,Mt)})}const Ie=()=>t(29,yn=void 0),Oe=()=>t(30,Pt=void 0),We=()=>t(32,si=void 0);function ut(be){Sn[be?"unshift":"push"](()=>{Mt=be,t(24,Mt)})}const ot=()=>t(29,yn=void 0),Je=()=>t(30,Pt=void 0),pe=()=>{t(27,_t=void 0),t(31,Yn=void 0)},nt=()=>t(32,si=void 0);return n.$$set=be=>{e=zt(zt({},e),ls(be)),t(46,a=vi(e,r)),"use"in be&&t(8,L=be.use),"class"in be&&t(9,N=be.class),"style"in be&&t(10,B=be.style),"ripple"in be&&t(11,F=be.ripple),"disabled"in be&&t(12,z=be.disabled),"required"in be&&t(13,V=be.required),"textarea"in be&&t(14,Y=be.textarea),"variant"in be&&t(15,Q=be.variant),"noLabel"in be&&t(16,J=be.noLabel),"label"in be&&t(17,he=be.label),"type"in be&&t(18,ee=be.type),"value"in be&&t(0,ae=be.value),"files"in be&&t(3,De=be.files),"invalid"in be&&t(1,le=be.invalid),"updateInvalid"in be&&t(19,Be=be.updateInvalid),"dirty"in be&&t(4,Pe=be.dirty),"prefix"in be&&t(20,Ce=be.prefix),"suffix"in be&&t(21,it=be.suffix),"validateOnValueChange"in be&&t(48,Et=be.validateOnValueChange),"useNativeValidation"in be&&t(49,Ue=be.useNativeValidation),"withLeadingIcon"in be&&t(22,at=be.withLeadingIcon),"withTrailingIcon"in be&&t(23,ke=be.withTrailingIcon),"input"in be&&t(2,Dt=be.input),"floatingLabel"in be&&t(5,fn=be.floatingLabel),"lineRipple"in be&&t(6,Cn=be.lineRipple),"notchedOutline"in be&&t(7,Gt=be.notchedOutline),"$$scope"in be&&t(87,s=be.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&4&&t(33,i=Dt&&Dt.getElement()),n.$$.dirty[0]&524290|n.$$.dirty[1]&8388608&&vt&&vt.isValid()!==!le&&(Be?t(1,le=!vt.isValid()):vt.setValid(!le)),n.$$.dirty[1]&8519680&&vt&&vt.getValidateOnValueChange()!==Et&&vt.setValidateOnValueChange(A(Et)?!1:Et),n.$$.dirty[1]&8650752&&vt&&vt.setUseNativeValidation(A(Ue)?!0:Ue),n.$$.dirty[0]&4096|n.$$.dirty[1]&8388608&&vt&&vt.setDisabled(z),n.$$.dirty[0]&1|n.$$.dirty[1]&25165824&&vt&&fe&&Dr!==ae){t(55,Dr=ae);const be=`${ae}`;vt.getValue()!==be&&vt.setValue(be)}},[ae,le,Dt,De,Pe,fn,Cn,Gt,L,N,B,F,z,V,Y,Q,J,he,ee,Be,Ce,it,at,ke,Mt,xn,En,_t,kt,yn,Pt,Yn,si,i,x,A,fe,mi,Ur,He,Jt,ui,$e,Ei,ni,Ln,a,d,Et,Ue,ki,Hs,Xt,Rn,vt,Dr,l,ti,tr,js,mo,ca,Xo,qs,No,Ja,go,Ma,Vl,Qa,ha,$a,Zs,La,so,Ra,we,te,re,Ie,Oe,We,ut,ot,Je,pe,nt,s]}class FS extends sr{constructor(e){super(),or(this,e,BB,FB,Qi,{use:8,class:9,style:10,ripple:11,disabled:12,required:13,textarea:14,variant:15,noLabel:16,label:17,type:18,value:0,files:3,invalid:1,updateInvalid:19,dirty:4,prefix:20,suffix:21,validateOnValueChange:48,useNativeValidation:49,withLeadingIcon:22,withTrailingIcon:23,input:2,floatingLabel:5,lineRipple:6,notchedOutline:7,focus:50,blur:51,layout:52,getElement:53},null,[-1,-1,-1,-1])}get focus(){return this.$$.ctx[50]}get blur(){return this.$$.ctx[51]}get layout(){return this.$$.ctx[52]}get getElement(){return this.$$.ctx[53]}}function zB(n){let e,t,i,r;return{c(){e=_i("Choose "),t=qt("a"),i=_i("EPSG"),r=_i(" for download:"),this.h()},l(a){e=yi(a,"Choose "),t=Wt(a,"A",{href:!0});var l=Qt(t);i=yi(l,"EPSG"),l.forEach(de),r=yi(a," for download:"),this.h()},h(){tn(t,"href","https://epsg.io/")},m(a,l){tt(a,e,l),tt(a,t,l),Kt(t,i),tt(a,r,l)},p:_l,d(a){a&&de(e),a&&de(t),a&&de(r)}}}function UB(n){let e;return{c(){e=_i("WGS84")},l(t){e=yi(t,"WGS84")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function VB(n){let e;return{c(){e=_i("Download")},l(t){e=yi(t,"Download")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function GB(n){let e,t;return e=new j_({props:{$$slots:{default:[VB]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,r){on(e,i,r),t=!0},p(i,r){const a={};r&4096&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Te(e.$$.fragment,i),t=!0)},o(i){Ne(e.$$.fragment,i),t=!1},d(i){an(e,i)}}}function HB(n){let e;return{c(){e=_i("Cancel")},l(t){e=yi(t,"Cancel")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function jB(n){let e,t;return e=new j_({props:{$$slots:{default:[HB]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,r){on(e,i,r),t=!0},p(i,r){const a={};r&4096&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Te(e.$$.fragment,i),t=!0)},o(i){Ne(e.$$.fragment,i),t=!1},d(i){an(e,i)}}}function qB(n){let e,t,i,r,a,l,s,d,g,x,I,A,L,N,B;e=new k4({props:{$$slots:{default:[zB]},$$scope:{ctx:n}}});function F(J){n[5](J)}function z(J){n[6](J)}let V={variant:"outlined"};n[2]!==void 0&&(V.value=n[2]),n[1]!==void 0&&(V.invalid=n[1]),r=new FS({props:V}),Sn.push(()=>Xr(r,"value",F)),Sn.push(()=>Xr(r,"invalid",z)),d=new cp({props:{variant:"outlined",$$slots:{default:[UB]},$$scope:{ctx:n}}}),d.$on("click",n[7]);function Y(J){n[8](J)}let Q={variant:"unelevated",$$slots:{default:[GB]},$$scope:{ctx:n}};return n[3]!==void 0&&(Q.disabled=n[3]),I=new cp({props:Q}),Sn.push(()=>Xr(I,"disabled",Y)),I.$on("click",n[4]),N=new cp({props:{variant:"outlined",$$slots:{default:[jB]},$$scope:{ctx:n}}}),N.$on("click",n[9]),{c(){sn(e.$$.fragment),t=vn(),i=qt("span"),sn(r.$$.fragment),s=vn(),sn(d.$$.fragment),g=vn(),x=qt("div"),sn(I.$$.fragment),L=vn(),sn(N.$$.fragment),this.h()},l(J){dn(e.$$.fragment,J),t=bn(J),i=Wt(J,"SPAN",{class:!0});var he=Qt(i);dn(r.$$.fragment,he),s=bn(he),dn(d.$$.fragment,he),he.forEach(de),g=bn(J),x=Wt(J,"DIV",{class:!0});var ee=Qt(x);dn(I.$$.fragment,ee),L=bn(ee),dn(N.$$.fragment,ee),ee.forEach(de),this.h()},h(){tn(i,"class","epsg-row svelte-1bp1p1c"),tn(x,"class","btn-row svelte-1bp1p1c")},m(J,he){on(e,J,he),tt(J,t,he),tt(J,i,he),on(r,i,null),Kt(i,s),on(d,i,null),tt(J,g,he),tt(J,x,he),on(I,x,null),Kt(x,L),on(N,x,null),B=!0},p(J,he){const ee={};he&4096&&(ee.$$scope={dirty:he,ctx:J}),e.$set(ee);const ae={};!a&&he&4&&(a=!0,ae.value=J[2],Qr(()=>a=!1)),!l&&he&2&&(l=!0,ae.invalid=J[1],Qr(()=>l=!1)),r.$set(ae);const De={};he&4096&&(De.$$scope={dirty:he,ctx:J}),d.$set(De);const fe={};he&4096&&(fe.$$scope={dirty:he,ctx:J}),!A&&he&8&&(A=!0,fe.disabled=J[3],Qr(()=>A=!1)),I.$set(fe);const le={};he&4096&&(le.$$scope={dirty:he,ctx:J}),N.$set(le)},i(J){B||(Te(e.$$.fragment,J),Te(r.$$.fragment,J),Te(d.$$.fragment,J),Te(I.$$.fragment,J),Te(N.$$.fragment,J),B=!0)},o(J){Ne(e.$$.fragment,J),Ne(r.$$.fragment,J),Ne(d.$$.fragment,J),Ne(I.$$.fragment,J),Ne(N.$$.fragment,J),B=!1},d(J){an(e,J),J&&de(t),J&&de(i),an(r),an(d),J&&de(g),J&&de(x),an(I),an(N)}}}function WB(n){let e,t,i;function r(l){n[10](l)}let a={$$slots:{default:[qB]},$$scope:{ctx:n}};return n[0]!==void 0&&(a.open=n[0]),e=new KL({props:a}),Sn.push(()=>Xr(e,"open",r)),{c(){sn(e.$$.fragment)},l(l){dn(e.$$.fragment,l)},m(l,s){on(e,l,s),i=!0},p(l,[s]){const d={};s&4111&&(d.$$scope={dirty:s,ctx:l}),!t&&s&1&&(t=!0,d.open=l[0],Qr(()=>t=!1)),e.$set(d)},i(l){i||(Te(e.$$.fragment,l),i=!0)},o(l){Ne(e.$$.fragment,l),i=!1},d(l){an(e,l)}}}const Z2="4326";function XB(n,e,t){let i,{open:r}=e,{problem:a}=e,l=Z2;const s=i0();function d(){s("epsgSet",{epsg:l}),t(0,r=!1)}function g(B){l=B,t(2,l)}function x(B){a=B,t(1,a)}const I=()=>t(2,l=Z2);function A(B){i=B,t(3,i),t(2,l)}const L=()=>{t(0,r=!1)};function N(B){r=B,t(0,r)}return n.$$set=B=>{"open"in B&&t(0,r=B.open),"problem"in B&&t(1,a=B.problem)},n.$$.update=()=>{n.$$.dirty&4&&t(3,i=!/^[0-9]+$/.test(l)||l.length===0)},[r,a,l,i,d,g,x,I,A,L,N]}class ZB extends sr{constructor(e){super(),or(this,e,XB,WB,Qi,{open:0,problem:1})}}function YB(n){let e;return{c(){e=_i("layers")},l(t){e=yi(t,"layers")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function Y2(n){let e,t,i;return t=new xf({props:{class:"material-icons",$$slots:{default:[KB]},$$scope:{ctx:n}}}),t.$on("click",n[17]),{c(){e=qt("span"),sn(t.$$.fragment),this.h()},l(r){e=Wt(r,"SPAN",{class:!0});var a=Qt(e);dn(t.$$.fragment,a),a.forEach(de),this.h()},h(){tn(e,"class","check-all-btn svelte-ga66me")},m(r,a){tt(r,e,a),on(t,e,null),i=!0},p(r,a){const l={};a[0]&128|a[1]&64&&(l.$$scope={dirty:a,ctx:r}),t.$set(l)},i(r){i||(Te(t.$$.fragment,r),i=!0)},o(r){Ne(t.$$.fragment,r),i=!1},d(r){r&&de(e),an(t)}}}function KB(n){let e=n[7]?"check_box":"check_box_outline_blank",t;return{c(){t=_i(e)},l(i){t=yi(i,e)},m(i,r){tt(i,t,r)},p(i,r){r[0]&128&&e!==(e=i[7]?"check_box":"check_box_outline_blank")&&ys(t,e)},d(i){i&&de(t)}}}function K2(n){var N,B,F;let e,t,i=((N=n[0])==null?void 0:N.name.toUpperCase())+"",r,a,l,s,d,g,x;l=new Rv({props:{rich:!0,$$slots:{default:[e5]},$$scope:{ctx:n}}});const I=[(B=n[0].optionsComponent)==null?void 0:B.props,{updateOptions:n[10]}];var A=(F=n[0].optionsComponent)==null?void 0:F.component;function L(z){let V={};for(let Y=0;Y<I.length;Y+=1)V=zt(V,I[Y]);return{props:V}}return A&&(d=Xa(A,L())),{c(){e=qt("span"),t=qt("h3"),r=_i(i),a=vn(),sn(l.$$.fragment),s=vn(),d&&sn(d.$$.fragment),g=pi(),this.h()},l(z){e=Wt(z,"SPAN",{style:!0});var V=Qt(e);t=Wt(V,"H3",{});var Y=Qt(t);r=yi(Y,i),Y.forEach(de),a=bn(V),dn(l.$$.fragment,V),V.forEach(de),s=bn(z),d&&dn(d.$$.fragment,z),g=pi(),this.h()},h(){wa(e,"display","flex"),wa(e,"align-items","center"),wa(e,"justify-content","space-between")},m(z,V){tt(z,e,V),Kt(e,t),Kt(t,r),Kt(e,a),on(l,e,null),tt(z,s,V),d&&on(d,z,V),tt(z,g,V),x=!0},p(z,V){var J,he,ee;(!x||V[0]&1)&&i!==(i=((J=z[0])==null?void 0:J.name.toUpperCase())+"")&&ys(r,i);const Y={};V[0]&1|V[1]&64&&(Y.$$scope={dirty:V,ctx:z}),l.$set(Y);const Q=V[0]&1025?hi(I,[V[0]&1&&Mr((he=z[0].optionsComponent)==null?void 0:he.props),V[0]&1024&&{updateOptions:z[10]}]):{};if(V[0]&1&&A!==(A=(ee=z[0].optionsComponent)==null?void 0:ee.component)){if(d){Wi();const ae=d;Ne(ae.$$.fragment,1,0,()=>{an(ae,1)}),Xi()}A?(d=Xa(A,L()),sn(d.$$.fragment),Te(d.$$.fragment,1),on(d,g.parentNode,g)):d=null}else A&&d.$set(Q)},i(z){x||(Te(l.$$.fragment,z),d&&Te(d.$$.fragment,z),x=!0)},o(z){Ne(l.$$.fragment,z),d&&Ne(d.$$.fragment,z),x=!1},d(z){z&&de(e),an(l),z&&de(s),z&&de(g),d&&an(d,z)}}}function JB(n){let e;return{c(){e=_i("info")},l(t){e=yi(t,"info")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function QB(n){let e=n[0].tooltip+"",t;return{c(){t=_i(e)},l(i){t=yi(i,e)},m(i,r){tt(i,t,r)},p(i,r){r[0]&1&&e!==(e=i[0].tooltip+"")&&ys(t,e)},d(i){i&&de(t)}}}function $B(n){let e,t;return e=new LD({props:{$$slots:{default:[QB]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,r){on(e,i,r),t=!0},p(i,r){const a={};r[0]&1|r[1]&64&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Te(e.$$.fragment,i),t=!0)},o(i){Ne(e.$$.fragment,i),t=!1},d(i){an(e,i)}}}function e5(n){let e,t,i,r,a;return t=new MS({props:{class:"material-icons",$$slots:{default:[JB]},$$scope:{ctx:n}}}),r=new ab({props:{$$slots:{default:[$B]},$$scope:{ctx:n}}}),{c(){e=qt("span"),sn(t.$$.fragment),i=vn(),sn(r.$$.fragment),this.h()},l(l){e=Wt(l,"SPAN",{class:!0});var s=Qt(e);dn(t.$$.fragment,s),s.forEach(de),i=bn(l),dn(r.$$.fragment,l),this.h()},h(){tn(e,"class","info-btn svelte-ga66me")},m(l,s){tt(l,e,s),on(t,e,null),tt(l,i,s),on(r,l,s),a=!0},p(l,s){const d={};s[1]&64&&(d.$$scope={dirty:s,ctx:l}),t.$set(d);const g={};s[0]&1|s[1]&64&&(g.$$scope={dirty:s,ctx:l}),r.$set(g)},i(l){a||(Te(t.$$.fragment,l),Te(r.$$.fragment,l),a=!0)},o(l){Ne(t.$$.fragment,l),Ne(r.$$.fragment,l),a=!1},d(l){l&&de(e),an(t),l&&de(i),an(r,l)}}}function t5(n){let e,t,i,r,a;function l(x){n[21](x)}function s(x){n[22](x)}function d(x){n[23](x)}let g={layer:n[36],map:n[1]};return n[4]!==void 0&&(g.selectModeEnabled=n[4]),n[0]!==void 0&&(g.selectedTool=n[0]),n[2]!==void 0&&(g.selectedLayers=n[2]),e=new fO({props:g}),Sn.push(()=>Xr(e,"selectModeEnabled",l)),Sn.push(()=>Xr(e,"selectedTool",s)),Sn.push(()=>Xr(e,"selectedLayers",d)),e.$on("toggled",n[13]),e.$on("singleSelect",n[15]),{c(){sn(e.$$.fragment)},l(x){dn(e.$$.fragment,x)},m(x,I){on(e,x,I),a=!0},p(x,I){const A={};I[1]&32&&(A.layer=x[36]),I[0]&2&&(A.map=x[1]),!t&&I[0]&16&&(t=!0,A.selectModeEnabled=x[4],Qr(()=>t=!1)),!i&&I[0]&1&&(i=!0,A.selectedTool=x[0],Qr(()=>i=!1)),!r&&I[0]&4&&(r=!0,A.selectedLayers=x[2],Qr(()=>r=!1)),e.$set(A)},i(x){a||(Te(e.$$.fragment,x),a=!0)},o(x){Ne(e.$$.fragment,x),a=!1},d(x){an(e,x)}}}function n5(n){let e;return{c(){e=_i("upload_file")},l(t){e=yi(t,"upload_file")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function i5(n){let e;return{c(){e=_i("Upload layers")},l(t){e=yi(t,"Upload layers")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function r5(n){let e,t,i,r;return e=new xf({props:{class:"material-icons",$$slots:{default:[n5]},$$scope:{ctx:n}}}),e.$on("click",n[24]),i=new ab({props:{$$slots:{default:[i5]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment),t=vn(),sn(i.$$.fragment)},l(a){dn(e.$$.fragment,a),t=bn(a),dn(i.$$.fragment,a)},m(a,l){on(e,a,l),tt(a,t,l),on(i,a,l),r=!0},p(a,l){const s={};l[1]&64&&(s.$$scope={dirty:l,ctx:a}),e.$set(s);const d={};l[1]&64&&(d.$$scope={dirty:l,ctx:a}),i.$set(d)},i(a){r||(Te(e.$$.fragment,a),Te(i.$$.fragment,a),r=!0)},o(a){Ne(e.$$.fragment,a),Ne(i.$$.fragment,a),r=!1},d(a){an(e,a),a&&de(t),an(i,a)}}}function s5(n){let e;return{c(){e=_i("download")},l(t){e=yi(t,"download")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function o5(n){let e;return{c(){e=_i("Download layer(s)")},l(t){e=yi(t,"Download layer(s)")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function a5(n){let e,t,i,r;return e=new xf({props:{class:"material-icons",disabled:n[2].length===0,$$slots:{default:[s5]},$$scope:{ctx:n}}}),e.$on("click",n[26]),i=new ab({props:{$$slots:{default:[o5]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment),t=vn(),sn(i.$$.fragment)},l(a){dn(e.$$.fragment,a),t=bn(a),dn(i.$$.fragment,a)},m(a,l){on(e,a,l),tt(a,t,l),on(i,a,l),r=!0},p(a,l){const s={};l[0]&4&&(s.disabled=a[2].length===0),l[1]&64&&(s.$$scope={dirty:l,ctx:a}),e.$set(s);const d={};l[1]&64&&(d.$$scope={dirty:l,ctx:a}),i.$set(d)},i(a){r||(Te(e.$$.fragment,a),Te(i.$$.fragment,a),r=!0)},o(a){Ne(e.$$.fragment,a),Ne(i.$$.fragment,a),r=!1},d(a){an(e,a),a&&de(t),an(i,a)}}}function l5(n){let e,t,i,r;e=new Rv({props:{$$slots:{default:[f5]},$$scope:{ctx:n}}});let a=n[4]&&J2(n);return{c(){sn(e.$$.fragment),t=vn(),a&&a.c(),i=pi()},l(l){dn(e.$$.fragment,l),t=bn(l),a&&a.l(l),i=pi()},m(l,s){on(e,l,s),tt(l,t,s),a&&a.m(l,s),tt(l,i,s),r=!0},p(l,s){const d={};s[0]&20|s[1]&64&&(d.$$scope={dirty:s,ctx:l}),e.$set(d),l[4]?a?(a.p(l,s),s[0]&16&&Te(a,1)):(a=J2(l),a.c(),Te(a,1),a.m(i.parentNode,i)):a&&(Wi(),Ne(a,1,1,()=>{a=null}),Xi())},i(l){r||(Te(e.$$.fragment,l),Te(a),r=!0)},o(l){Ne(e.$$.fragment,l),Ne(a),r=!1},d(l){an(e,l),l&&de(t),a&&a.d(l),l&&de(i)}}}function u5(n){let e,t,i,r,a;function l(d){n[27](d)}let s={variant:"unelevated",$$slots:{default:[m5]},$$scope:{ctx:n}};return n[8]!==void 0&&(s.disabled=n[8]),e=new cp({props:s}),Sn.push(()=>Xr(e,"disabled",l)),e.$on("click",n[12]),r=new cp({props:{variant:"outlined",$$slots:{default:[_5]},$$scope:{ctx:n}}}),r.$on("click",n[28]),{c(){sn(e.$$.fragment),i=vn(),sn(r.$$.fragment)},l(d){dn(e.$$.fragment,d),i=bn(d),dn(r.$$.fragment,d)},m(d,g){on(e,d,g),tt(d,i,g),on(r,d,g),a=!0},p(d,g){const x={};g[1]&64&&(x.$$scope={dirty:g,ctx:d}),!t&&g[0]&256&&(t=!0,x.disabled=d[8],Qr(()=>t=!1)),e.$set(x);const I={};g[1]&64&&(I.$$scope={dirty:g,ctx:d}),r.$set(I)},i(d){a||(Te(e.$$.fragment,d),Te(r.$$.fragment,d),a=!0)},o(d){Ne(e.$$.fragment,d),Ne(r.$$.fragment,d),a=!1},d(d){an(e,d),d&&de(i),an(r,d)}}}function c5(n){let e=n[4]?"check":"rule",t;return{c(){t=_i(e)},l(i){t=yi(i,e)},m(i,r){tt(i,t,r)},p(i,r){r[0]&16&&e!==(e=i[4]?"check":"rule")&&ys(t,e)},d(i){i&&de(t)}}}function h5(n){let e=n[4]?"Quit selection mode":"Select layers",t;return{c(){t=_i(e)},l(i){t=yi(i,e)},m(i,r){tt(i,t,r)},p(i,r){r[0]&16&&e!==(e=i[4]?"Quit selection mode":"Select layers")&&ys(t,e)},d(i){i&&de(t)}}}function f5(n){let e,t,i,r;return e=new xf({props:{class:"material-icons",$$slots:{default:[c5]},$$scope:{ctx:n}}}),e.$on("click",n[29]),i=new ab({props:{$$slots:{default:[h5]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment),t=vn(),sn(i.$$.fragment)},l(a){dn(e.$$.fragment,a),t=bn(a),dn(i.$$.fragment,a)},m(a,l){on(e,a,l),tt(a,t,l),on(i,a,l),r=!0},p(a,l){const s={};l[0]&16|l[1]&64&&(s.$$scope={dirty:l,ctx:a}),e.$set(s);const d={};l[0]&16|l[1]&64&&(d.$$scope={dirty:l,ctx:a}),i.$set(d)},i(a){r||(Te(e.$$.fragment,a),Te(i.$$.fragment,a),r=!0)},o(a){Ne(e.$$.fragment,a),Ne(i.$$.fragment,a),r=!1},d(a){an(e,a),a&&de(t),an(i,a)}}}function J2(n){let e,t;return e=new xf({props:{class:"material-icons",disabled:n[2].length===0,$$slots:{default:[d5]},$$scope:{ctx:n}}}),e.$on("click",n[30]),{c(){sn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,r){on(e,i,r),t=!0},p(i,r){const a={};r[0]&4&&(a.disabled=i[2].length===0),r[1]&64&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Te(e.$$.fragment,i),t=!0)},o(i){Ne(e.$$.fragment,i),t=!1},d(i){an(e,i)}}}function d5(n){let e;return{c(){e=_i("delete_outline")},l(t){e=yi(t,"delete_outline")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function p5(n){let e;return{c(){e=_i("Apply")},l(t){e=yi(t,"Apply")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function m5(n){let e,t;return e=new j_({props:{$$slots:{default:[p5]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,r){on(e,i,r),t=!0},p(i,r){const a={};r[1]&64&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Te(e.$$.fragment,i),t=!0)},o(i){Ne(e.$$.fragment,i),t=!1},d(i){an(e,i)}}}function g5(n){let e;return{c(){e=_i("Cancel")},l(t){e=yi(t,"Cancel")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function _5(n){let e,t;return e=new j_({props:{$$slots:{default:[g5]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,r){on(e,i,r),t=!0},p(i,r){const a={};r[1]&64&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Te(e.$$.fragment,i),t=!0)},o(i){Ne(e.$$.fragment,i),t=!1},d(i){an(e,i)}}}function y5(n){let e,t,i,r,a,l,s,d,g,x,I,A,L,N,B,F,z,V,Y,Q,J,he,ee,ae,De,fe,le,Be,Pe,Ce,it;s=new MS({props:{class:"material-icons",$$slots:{default:[YB]},$$scope:{ctx:n}}});let Et=n[4]&&Y2(n),Ue=n[0]&&K2(n);L=new rO({props:{list:n[9],key:null,$$slots:{default:[t5,({item:Mt})=>({36:Mt}),({item:Mt})=>[0,Mt?32:0]]},$$scope:{ctx:n}}}),L.$on("sort",n[11]),V=new Rv({props:{$$slots:{default:[r5]},$$scope:{ctx:n}}}),he=new Rv({props:{$$slots:{default:[a5]},$$scope:{ctx:n}}});const at=[u5,l5],ke=[];function Dt(Mt,vt){return Mt[0]?0:1}De=Dt(n),fe=ke[De]=at[De](n);function fn(Mt){n[31](Mt)}function Cn(Mt){n[32](Mt)}let Gt={};return n[5]!==void 0&&(Gt.open=n[5]),n[6]!==void 0&&(Gt.problem=n[6]),Be=new ZB({props:Gt}),Sn.push(()=>Xr(Be,"open",fn)),Sn.push(()=>Xr(Be,"problem",Cn)),Be.$on("epsgSet",n[16]),{c(){e=qt("div"),t=qt("div"),i=qt("span"),r=qt("h2"),a=_i("Layers"),l=vn(),sn(s.$$.fragment),d=vn(),Et&&Et.c(),g=vn(),x=qt("hr"),I=vn(),Ue&&Ue.c(),A=vn(),sn(L.$$.fragment),N=vn(),B=qt("hr"),F=vn(),z=qt("span"),sn(V.$$.fragment),Y=vn(),Q=qt("input"),J=vn(),sn(he.$$.fragment),ee=vn(),ae=qt("span"),fe.c(),le=vn(),sn(Be.$$.fragment),this.h()},l(Mt){e=Wt(Mt,"DIV",{class:!0});var vt=Qt(e);t=Wt(vt,"DIV",{class:!0});var xn=Qt(t);i=Wt(xn,"SPAN",{class:!0});var En=Qt(i);r=Wt(En,"H2",{style:!0});var _t=Qt(r);a=yi(_t,"Layers"),_t.forEach(de),l=bn(En),dn(s.$$.fragment,En),d=bn(En),Et&&Et.l(En),En.forEach(de),g=bn(xn),x=Wt(xn,"HR",{class:!0}),I=bn(xn),Ue&&Ue.l(xn),A=bn(xn),dn(L.$$.fragment,xn),N=bn(xn),B=Wt(xn,"HR",{style:!0,class:!0}),F=bn(xn),z=Wt(xn,"SPAN",{class:!0});var kt=Qt(z);dn(V.$$.fragment,kt),Y=bn(kt),Q=Wt(kt,"INPUT",{id:!0,type:!0,style:!0}),J=bn(kt),dn(he.$$.fragment,kt),ee=bn(kt),ae=Wt(kt,"SPAN",{style:!0});var Ct=Qt(ae);fe.l(Ct),Ct.forEach(de),kt.forEach(de),xn.forEach(de),vt.forEach(de),le=bn(Mt),dn(Be.$$.fragment,Mt),this.h()},h(){wa(r,"margin","0"),tn(i,"class","layer-title svelte-ga66me"),tn(x,"class","svelte-ga66me"),wa(B,"margin-top","auto"),tn(B,"class","svelte-ga66me"),tn(Q,"id","file-upload"),Q.multiple=!0,tn(Q,"type","file"),wa(Q,"display","none"),wa(ae,"margin-left","auto"),tn(z,"class","file-action-row svelte-ga66me"),tn(t,"class","content svelte-ga66me"),tn(e,"class","container pulsating-border svelte-ga66me")},m(Mt,vt){tt(Mt,e,vt),Kt(e,t),Kt(t,i),Kt(i,r),Kt(r,a),Kt(i,l),on(s,i,null),Kt(i,d),Et&&Et.m(i,null),Kt(t,g),Kt(t,x),Kt(t,I),Ue&&Ue.m(t,null),Kt(t,A),on(L,t,null),Kt(t,N),Kt(t,B),Kt(t,F),Kt(t,z),on(V,z,null),Kt(z,Y),Kt(z,Q),n[25](Q),Kt(z,J),on(he,z,null),Kt(z,ee),Kt(z,ae),ke[De].m(ae,null),tt(Mt,le,vt),on(Be,Mt,vt),it=!0},p(Mt,vt){const xn={};vt[1]&64&&(xn.$$scope={dirty:vt,ctx:Mt}),s.$set(xn),Mt[4]?Et?(Et.p(Mt,vt),vt[0]&16&&Te(Et,1)):(Et=Y2(Mt),Et.c(),Te(Et,1),Et.m(i,null)):Et&&(Wi(),Ne(Et,1,1,()=>{Et=null}),Xi()),Mt[0]?Ue?(Ue.p(Mt,vt),vt[0]&1&&Te(Ue,1)):(Ue=K2(Mt),Ue.c(),Te(Ue,1),Ue.m(t,A)):Ue&&(Wi(),Ne(Ue,1,1,()=>{Ue=null}),Xi());const En={};vt[0]&512&&(En.list=Mt[9]),vt[0]&23|vt[1]&96&&(En.$$scope={dirty:vt,ctx:Mt}),L.$set(En);const _t={};vt[0]&8|vt[1]&64&&(_t.$$scope={dirty:vt,ctx:Mt}),V.$set(_t);const kt={};vt[0]&36|vt[1]&64&&(kt.$$scope={dirty:vt,ctx:Mt}),he.$set(kt);let Ct=De;De=Dt(Mt),De===Ct?ke[De].p(Mt,vt):(Wi(),Ne(ke[Ct],1,1,()=>{ke[Ct]=null}),Xi(),fe=ke[De],fe?fe.p(Mt,vt):(fe=ke[De]=at[De](Mt),fe.c()),Te(fe,1),fe.m(ae,null));const Bt={};!Pe&&vt[0]&32&&(Pe=!0,Bt.open=Mt[5],Qr(()=>Pe=!1)),!Ce&&vt[0]&64&&(Ce=!0,Bt.problem=Mt[6],Qr(()=>Ce=!1)),Be.$set(Bt)},i(Mt){it||(Te(s.$$.fragment,Mt),Te(Et),Te(Ue),Te(L.$$.fragment,Mt),Te(V.$$.fragment,Mt),Te(he.$$.fragment,Mt),Te(fe),Te(Be.$$.fragment,Mt),it=!0)},o(Mt){Ne(s.$$.fragment,Mt),Ne(Et),Ne(Ue),Ne(L.$$.fragment,Mt),Ne(V.$$.fragment,Mt),Ne(he.$$.fragment,Mt),Ne(fe),Ne(Be.$$.fragment,Mt),it=!1},d(Mt){Mt&&de(e),an(s),Et&&Et.d(),Ue&&Ue.d(),an(L),an(V),n[25](null),an(he),ke[De].d(),Mt&&de(le),an(Be,Mt)}}}function v5(n,e,t){let i,r,a;Dl(n,Lo,Gt=>t(9,a=Gt));let{map:l}=e,{draw:s}=e,{tools:d}=e,{selectedTool:g}=e,x,I,A=!1,L=[],N,B,F=!1,z=!1;function V(Gt,Mt){t(20,N=Gt.args),B=Mt,Gt.layerSelection!==void 0&&Gt.layerSelection.length!==void 0&&t(2,L=Gt.layerSelection)}function Y(Gt){const{newList:Mt,from:vt,to:xn}=Gt.detail,En=Mt[xn];Lo.set(Mt),Lo.setNewLayerIndex({layerId:En,index:parseInt(xn)})}function Q(){var Mt;let Gt=(Mt=g==null?void 0:g.geoProcessor)==null?void 0:Mt.processor(L,N);Gt&&!Array.isArray(Gt)&&(Gt=[Gt]),Gt==null||Gt.forEach(vt=>TS(l,{id:g.name,geojson:{type:"geojson",data:vt}})),t(0,g=null),t(2,L=[]),B&&B()}function J(Gt){const Mt=Gt.detail;if(L.find(xn=>xn.id===Mt.id)!==void 0){t(2,L=L.filter(xn=>xn.id!==Mt.id));return}t(2,L=[...L,Mt])}const he=i0();function ee(Gt){const Mt=Gt.detail;L.length===1&&L[0]===Mt?(t(2,L=[]),he("singleLayerSelect",{layer:null})):(t(2,L=[Mt]),he("singleLayerSelect",{layer:Mt}))}async function ae(Gt){const Mt=Gt.target;if(Mt.files&&Mt.files.length>0){I=Mt.files;const vt=await b4(I);G_.add(vt),Mt.value=""}}async function De(Gt){L.forEach(async Mt=>{const vt=Mt.source.data;if(!gd(vt))return;let xn=vt;if(Gt.detail.epsg!=="4326"){const Zn=await G1("4326"),mi=await G1(Gt.detail.epsg);if(mi)t(6,z=!1),t(5,F=!1);else{t(6,z=!0);return}const yn=rc(Zn,mi);H_(vt)?xn={type:"GeometryCollection",geometries:vt.geometries}:ob(vt)?xn={type:vt.type,coordinates:vt.coordinates}:bp(vt)?xn={type:"Feature",geometry:F1(vt.geometry,yn),properties:vt.properties}:Ef(vt)&&(console.log(xn),xn={type:"FeatureCollection",features:vt.features.map(Pt=>({type:"Feature",geometry:F1(Pt.geometry,yn),properties:Pt.properties}))})}const En=Mt.displayName+".geojson",_t="application/json",kt=new Blob([JSON.stringify(xn)],{type:_t}),Ct=URL.createObjectURL(kt),Bt=document.createElement("a");Bt.href=Ct,Bt.download=En,Bt.click(),URL.revokeObjectURL(Ct)})}function fe(){r?t(2,L=[]):t(2,L=ap(Lo))}ro(()=>{x.addEventListener("change",ae)});function le(Gt){A=Gt,t(4,A)}function Be(Gt){g=Gt,t(0,g)}function Pe(Gt){L=Gt,t(2,L)}const Ce=()=>x.click();function it(Gt){Sn[Gt?"unshift":"push"](()=>{x=Gt,t(3,x)})}const Et=()=>{t(5,F=!0)};function Ue(Gt){i=Gt,t(8,i),t(0,g),t(2,L),t(20,N)}const at=()=>t(0,g=null),ke=()=>{t(4,A=!A),A||(t(2,L=[]),he("singleLayerSelect",{layer:null}))},Dt=()=>{L.forEach(Gt=>{l.removeLayer(Gt.id),l.removeSource(Gt.id),Lo.deleteLayer(Gt.id)}),t(4,A=!A)};function fn(Gt){F=Gt,t(5,F)}function Cn(Gt){z=Gt,t(6,z)}return n.$$set=Gt=>{"map"in Gt&&t(1,l=Gt.map),"draw"in Gt&&t(18,s=Gt.draw),"tools"in Gt&&t(19,d=Gt.tools),"selectedTool"in Gt&&t(0,g=Gt.selectedTool)},n.$$.update=()=>{var Gt;n.$$.dirty[0]&1048581&&t(8,i=!((Gt=g==null?void 0:g.geoProcessor)!=null&&Gt.validator(L,N))),n.$$.dirty[0]&4&&t(7,r=L.length===ap(Lo).length)},[g,l,L,x,A,F,z,r,i,a,V,Y,Q,J,he,ee,De,fe,s,d,N,le,Be,Pe,Ce,it,Et,Ue,at,ke,Dt,fn,Cn]}class b5 extends sr{constructor(e){super(),or(this,e,v5,y5,Qi,{map:1,draw:18,tools:19,selectedTool:0},null,[-1,-1])}}function x5(n){let e,t,i,r,a,l=n[1].name.toUpperCase()+"",s,d,g;return{c(){e=qt("button"),t=qt("img"),r=vn(),a=qt("p"),s=_i(l),this.h()},l(x){e=Wt(x,"BUTTON",{class:!0});var I=Qt(e);t=Wt(I,"IMG",{class:!0,alt:!0,src:!0}),r=bn(I),a=Wt(I,"P",{class:!0});var A=Qt(a);s=yi(A,l),A.forEach(de),I.forEach(de),this.h()},h(){tn(t,"class","button-icon svelte-dbbhwe"),tn(t,"alt","button"),DE(t.src,i=n[1].iconPath||"button-icons/intersection.png")||tn(t,"src",i),tn(a,"class","svelte-dbbhwe"),tn(e,"class","svelte-dbbhwe"),Lv(e,"selected",n[0])},m(x,I){tt(x,e,I),Kt(e,t),Kt(e,r),Kt(e,a),Kt(a,s),d||(g=qn(e,"click",n[2]),d=!0)},p(x,[I]){I&2&&!DE(t.src,i=x[1].iconPath||"button-icons/intersection.png")&&tn(t,"src",i),I&2&&l!==(l=x[1].name.toUpperCase()+"")&&ys(s,l),I&1&&Lv(e,"selected",x[0])},i:_l,o:_l,d(x){x&&de(e),d=!1,g()}}}function E5(n,e,t){let{tool:i}=e,{selected:r=!1}=e;const a=i0();function l(){t(0,r=!r),a("toolSelected",r?i:null)}return n.$$set=s=>{"tool"in s&&t(1,i=s.tool),"selected"in s&&t(0,r=s.selected)},[r,i,l]}class I5 extends sr{constructor(e){super(),or(this,e,E5,x5,Qi,{tool:1,selected:0})}}function Q2(n,e,t){const i=n.slice();return i[3]=e[t],i}function $2(n){let e,t,i=wh.sortBy(n[1],tA),r=[];for(let l=0;l<i.length;l+=1)r[l]=eA(Q2(n,i,l));const a=l=>Ne(r[l],1,1,()=>{r[l]=null});return{c(){for(let l=0;l<r.length;l+=1)r[l].c();e=pi()},l(l){for(let s=0;s<r.length;s+=1)r[s].l(l);e=pi()},m(l,s){for(let d=0;d<r.length;d+=1)r[d]&&r[d].m(l,s);tt(l,e,s),t=!0},p(l,s){if(s&3){i=wh.sortBy(l[1],tA);let d;for(d=0;d<i.length;d+=1){const g=Q2(l,i,d);r[d]?(r[d].p(g,s),Te(r[d],1)):(r[d]=eA(g),r[d].c(),Te(r[d],1),r[d].m(e.parentNode,e))}for(Wi(),d=i.length;d<r.length;d+=1)a(d);Xi()}},i(l){if(!t){for(let s=0;s<i.length;s+=1)Te(r[s]);t=!0}},o(l){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)Ne(r[s]);t=!1},d(l){vm(r,l),l&&de(e)}}}function eA(n){let e,t;return e=new I5({props:{tool:n[3],selected:n[3]===n[0]}}),e.$on("toolSelected",n[2]),{c(){sn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,r){on(e,i,r),t=!0},p(i,r){const a={};r&2&&(a.tool=i[3]),r&3&&(a.selected=i[3]===i[0]),e.$set(a)},i(i){t||(Te(e.$$.fragment,i),t=!0)},o(i){Ne(e.$$.fragment,i),t=!1},d(i){an(e,i)}}}function T5(n){let e,t,i=n[1]&&$2(n);return{c(){e=qt("div"),i&&i.c(),this.h()},l(r){e=Wt(r,"DIV",{class:!0});var a=Qt(e);i&&i.l(a),a.forEach(de),this.h()},h(){tn(e,"class","container svelte-ux8w1b")},m(r,a){tt(r,e,a),i&&i.m(e,null),t=!0},p(r,[a]){r[1]?i?(i.p(r,a),a&2&&Te(i,1)):(i=$2(r),i.c(),Te(i,1),i.m(e,null)):i&&(Wi(),Ne(i,1,1,()=>{i=null}),Xi())},i(r){t||(Te(i),t=!0)},o(r){Ne(i),t=!1},d(r){r&&de(e),i&&i.d()}}}const tA=n=>n.name;function w5(n,e,t){let{selectedTool:i}=e,{tools:r}=e;function a(l){iu.call(this,n,l)}return n.$$set=l=>{"selectedTool"in l&&t(0,i=l.selectedTool),"tools"in l&&t(1,r=l.tools)},[i,r,a]}class S5 extends sr{constructor(e){super(),or(this,e,w5,T5,Qi,{selectedTool:0,tools:1})}}var $L={};Object.defineProperty($L,"__esModule",{value:!0});var nA={enable:function(e){setTimeout(function(){!e.map||!e.map.doubleClickZoom||!e._ctx||!e._ctx.store||!e._ctx.store.getInitialConfigValue||e._ctx.store.getInitialConfigValue("doubleClickZoom")&&e.map.doubleClickZoom.enable()},0)},disable:function(e){setTimeout(function(){!e.map||!e.map.doubleClickZoom||e.map.doubleClickZoom.disable()},0)}},C5={onSetup:function(e){var t=this.newFeature({type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),nA.disable(this),this.updateUIClasses({mouse:"add"}),this.setActionableState({trash:!0}),{rectangle:t}},onTap:function(e,t){e.startPoint&&this.onMouseMove(e,t),this.onClick(e,t)},onClick:function(e,t){e.startPoint&&e.startPoint[0]!==t.lngLat.lng&&e.startPoint[1]!==t.lngLat.lat&&(this.updateUIClasses({mouse:"pointer"}),e.endPoint=[t.lngLat.lng,t.lngLat.lat],this.changeMode("simple_select",{featuresId:e.rectangle.id}));var i=[t.lngLat.lng,t.lngLat.lat];e.startPoint=i},onMouseMove:function(e,t){e.startPoint&&(e.rectangle.updateCoordinate("0.0",e.startPoint[0],e.startPoint[1]),e.rectangle.updateCoordinate("0.1",t.lngLat.lng,e.startPoint[1]),e.rectangle.updateCoordinate("0.2",t.lngLat.lng,t.lngLat.lat),e.rectangle.updateCoordinate("0.3",e.startPoint[0],t.lngLat.lat),e.rectangle.updateCoordinate("0.4",e.startPoint[0],e.startPoint[1]))},onKeyUp:function(e,t){if(t.keyCode===27)return this.changeMode("simple_select")},onStop:function(e){nA.enable(this),this.updateUIClasses({mouse:"none"}),this.activateUIButton(),this.getFeature(e.rectangle.id)!==void 0&&(e.rectangle.removeCoordinate("0.4"),e.rectangle.isValid()?this.map.fire("draw.create",{features:[e.rectangle.toGeoJSON()]}):(this.deleteFeature([e.rectangle.id],{silent:!0}),this.changeMode("simple_select",{},{silent:!0})))},toDisplayFeatures:function(e,t,i){var r=t.properties.id===e.rectangle.id;if(t.properties.active=r?"true":"false",!r)return i(t);if(e.startPoint)return i(t)},onTrash:function(e){this.deleteFeature([e.rectangle.id],{silent:!0}),this.changeMode("simple_select")}},A5=$L.default=C5,Qu=63710088e-1,eR={centimeters:Qu*100,centimetres:Qu*100,degrees:Qu/111325,feet:Qu*3.28084,inches:Qu*39.37,kilometers:Qu/1e3,kilometres:Qu/1e3,meters:Qu,metres:Qu,miles:Qu/1609.344,millimeters:Qu*1e3,millimetres:Qu*1e3,nauticalmiles:Qu/1852,radians:1,yards:Qu*1.0936};function ug(n,e,t){t===void 0&&(t={});var i={type:"Feature"};return(t.id===0||t.id)&&(i.id=t.id),t.bbox&&(i.bbox=t.bbox),i.properties=e||{},i.geometry=n,i}function M5(n,e,t){if(t===void 0&&(t={}),!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!iA(n[0])||!iA(n[1]))throw new Error("coordinates must contain numbers");var i={type:"Point",coordinates:n};return ug(i,e,t)}function o0(n,e,t){t===void 0&&(t={});for(var i=0,r=n;i<r.length;i++){var a=r[i];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var l=0;l<a[a.length-1].length;l++)if(a[a.length-1][l]!==a[0][l])throw new Error("First and last Position are not equivalent.")}var s={type:"Polygon",coordinates:n};return ug(s,e,t)}function L5(n,e,t){if(t===void 0&&(t={}),n.length<2)throw new Error("coordinates must be an array of two or more positions");var i={type:"LineString",coordinates:n};return ug(i,e,t)}function Ov(n,e){e===void 0&&(e={});var t={type:"FeatureCollection"};return e.id&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.features=n,t}function R5(n,e,t){t===void 0&&(t={});var i={type:"MultiLineString",coordinates:n};return ug(i,e,t)}function Nv(n,e,t){t===void 0&&(t={});var i={type:"MultiPolygon",coordinates:n};return ug(i,e,t)}function P5(n,e){e===void 0&&(e="kilometers");var t=eR[e];if(!t)throw new Error(e+" units is invalid");return n*t}function D5(n,e){e===void 0&&(e="kilometers");var t=eR[e];if(!t)throw new Error(e+" units is invalid");return n/t}function iA(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}function tR(n){return!!n&&n.constructor===Object}function nR(n,e,t){if(n!==null)for(var i,r,a,l,s,d,g,x=0,I=0,A,L=n.type,N=L==="FeatureCollection",B=L==="Feature",F=N?n.features.length:1,z=0;z<F;z++){g=N?n.features[z].geometry:B?n.geometry:n,A=g?g.type==="GeometryCollection":!1,s=A?g.geometries.length:1;for(var V=0;V<s;V++){var Y=0,Q=0;if(l=A?g.geometries[V]:g,l!==null){d=l.coordinates;var J=l.type;switch(x=t&&(J==="Polygon"||J==="MultiPolygon")?1:0,J){case null:break;case"Point":if(e(d,I,z,Y,Q)===!1)return!1;I++,Y++;break;case"LineString":case"MultiPoint":for(i=0;i<d.length;i++){if(e(d[i],I,z,Y,Q)===!1)return!1;I++,J==="MultiPoint"&&Y++}J==="LineString"&&Y++;break;case"Polygon":case"MultiLineString":for(i=0;i<d.length;i++){for(r=0;r<d[i].length-x;r++){if(e(d[i][r],I,z,Y,Q)===!1)return!1;I++}J==="MultiLineString"&&Y++,J==="Polygon"&&Q++}J==="Polygon"&&Y++;break;case"MultiPolygon":for(i=0;i<d.length;i++){for(Q=0,r=0;r<d[i].length;r++){for(a=0;a<d[i][r].length-x;a++){if(e(d[i][r][a],I,z,Y,Q)===!1)return!1;I++}Q++}Y++}break;case"GeometryCollection":for(i=0;i<l.geometries.length;i++)if(nR(l.geometries[i],e,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function eS(n,e){if(n.type==="Feature")e(n,0);else if(n.type==="FeatureCollection")for(var t=0;t<n.features.length&&e(n.features[t],t)!==!1;t++);}function BS(n,e){var t,i,r,a,l,s,d,g,x,I,A=0,L=n.type==="FeatureCollection",N=n.type==="Feature",B=L?n.features.length:1;for(t=0;t<B;t++){for(s=L?n.features[t].geometry:N?n.geometry:n,g=L?n.features[t].properties:N?n.properties:{},x=L?n.features[t].bbox:N?n.bbox:void 0,I=L?n.features[t].id:N?n.id:void 0,d=s?s.type==="GeometryCollection":!1,l=d?s.geometries.length:1,r=0;r<l;r++){if(a=d?s.geometries[r]:s,a===null){if(e(null,A,g,x,I)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(a,A,g,x,I)===!1)return!1;break}case"GeometryCollection":{for(i=0;i<a.geometries.length;i++)if(e(a.geometries[i],A,g,x,I)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}A++}}function O5(n,e){BS(n,function(t,i,r,a,l){var s=t===null?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return e(ug(t,r,{bbox:a,id:l}),i,0)===!1?!1:void 0}var d;switch(s){case"MultiPoint":d="Point";break;case"MultiLineString":d="LineString";break;case"MultiPolygon":d="Polygon";break}for(var g=0;g<t.coordinates.length;g++){var x=t.coordinates[g],I={type:d,coordinates:x};if(e(ug(I,r),i,g)===!1)return!1}})}function cg(n){var e=[1/0,1/0,-1/0,-1/0];return nR(n,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}cg.default=cg;function N5(n,e){e===void 0&&(e={});var t=cg(n),i=(t[0]+t[2])/2,r=(t[1]+t[3])/2;return M5([i,r],e.properties,e)}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(e){if(this===void 0||this===null)throw new TypeError(this+" is not an object");var t=Object(this),i=Math.max(Math.min(t.length,9007199254740991),0)||0,r=1 in arguments&&parseInt(Number(arguments[1]),10)||0;r=r<0?Math.max(i+r,0):Math.min(r,i);var a=2 in arguments&&arguments[2]!==void 0?parseInt(Number(arguments[2]),10)||0:i;for(a=a<0?Math.max(i+arguments[2],0):Math.min(a,i);r<a;)t[r]=e,++r;return t},writable:!0});Number.isFinite=Number.isFinite||function(n){return typeof n=="number"&&isFinite(n)};Number.isInteger=Number.isInteger||function(n){return typeof n=="number"&&isFinite(n)&&Math.floor(n)===n};Number.parseFloat=Number.parseFloat||parseFloat;Number.isNaN=Number.isNaN||function(n){return n!==n};Math.trunc=Math.trunc||function(n){return n<0?Math.ceil(n):Math.floor(n)};var A_=function(){};A_.prototype.interfaces_=function(){return[]};A_.prototype.getClass=function(){return A_};A_.prototype.equalsWithTolerance=function(e,t,i){return Math.abs(e-t)<=i};var io=function(n){function e(t){n.call(this,t),this.name="IllegalArgumentException",this.message=t,this.stack=new n().stack}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e}(Error),rr=function(){},iR={MAX_VALUE:{configurable:!0}};rr.isNaN=function(e){return Number.isNaN(e)};rr.doubleToLongBits=function(e){return e};rr.longBitsToDouble=function(e){return e};rr.isInfinite=function(e){return!Number.isFinite(e)};iR.MAX_VALUE.get=function(){return Number.MAX_VALUE};Object.defineProperties(rr,iR);var Kc=function(){},mI=function(){},kv=function(){};function Jc(){}var mt=function n(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)this.x=0,this.y=0,this.z=n.NULL_ORDINATE;else if(arguments.length===1){var e=arguments[0];this.x=e.x,this.y=e.y,this.z=e.z}else arguments.length===2?(this.x=arguments[0],this.y=arguments[1],this.z=n.NULL_ORDINATE):arguments.length===3&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},q_={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};mt.prototype.setOrdinate=function(e,t){switch(e){case mt.X:this.x=t;break;case mt.Y:this.y=t;break;case mt.Z:this.z=t;break;default:throw new io("Invalid ordinate index: "+e)}};mt.prototype.equals2D=function(){if(arguments.length===1){var e=arguments[0];return!(this.x!==e.x||this.y!==e.y)}else if(arguments.length===2){var t=arguments[0],i=arguments[1];return!(!A_.equalsWithTolerance(this.x,t.x,i)||!A_.equalsWithTolerance(this.y,t.y,i))}};mt.prototype.getOrdinate=function(e){switch(e){case mt.X:return this.x;case mt.Y:return this.y;case mt.Z:return this.z}throw new io("Invalid ordinate index: "+e)};mt.prototype.equals3D=function(e){return this.x===e.x&&this.y===e.y&&(this.z===e.z||rr.isNaN(this.z))&&rr.isNaN(e.z)};mt.prototype.equals=function(e){return e instanceof mt?this.equals2D(e):!1};mt.prototype.equalInZ=function(e,t){return A_.equalsWithTolerance(this.z,e.z,t)};mt.prototype.compareTo=function(e){var t=e;return this.x<t.x?-1:this.x>t.x?1:this.y<t.y?-1:this.y>t.y?1:0};mt.prototype.clone=function(){};mt.prototype.copy=function(){return new mt(this)};mt.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"};mt.prototype.distance3D=function(e){var t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return Math.sqrt(t*t+i*i+r*r)};mt.prototype.distance=function(e){var t=this.x-e.x,i=this.y-e.y;return Math.sqrt(t*t+i*i)};mt.prototype.hashCode=function(){var e=17;return e=37*e+mt.hashCode(this.x),e=37*e+mt.hashCode(this.y),e};mt.prototype.setCoordinate=function(e){this.x=e.x,this.y=e.y,this.z=e.z};mt.prototype.interfaces_=function(){return[Kc,mI,Jc]};mt.prototype.getClass=function(){return mt};mt.hashCode=function(){if(arguments.length===1){var e=arguments[0],t=rr.doubleToLongBits(e);return Math.trunc((t^t)>>>32)}};q_.DimensionalComparator.get=function(){return am};q_.serialVersionUID.get=function(){return 6683108902428367e3};q_.NULL_ORDINATE.get=function(){return rr.NaN};q_.X.get=function(){return 0};q_.Y.get=function(){return 1};q_.Z.get=function(){return 2};Object.defineProperties(mt,q_);var am=function(e){if(this._dimensionsToTest=2,arguments.length!==0){if(arguments.length===1){var t=arguments[0];if(t!==2&&t!==3)throw new io("only 2 or 3 dimensions may be specified");this._dimensionsToTest=t}}};am.prototype.compare=function(e,t){var i=e,r=t,a=am.compare(i.x,r.x);if(a!==0)return a;var l=am.compare(i.y,r.y);if(l!==0)return l;if(this._dimensionsToTest<=2)return 0;var s=am.compare(i.z,r.z);return s};am.prototype.interfaces_=function(){return[kv]};am.prototype.getClass=function(){return am};am.compare=function(e,t){return e<t?-1:e>t?1:rr.isNaN(e)?rr.isNaN(t)?0:-1:rr.isNaN(t)?1:0};var Fv=function(){};Fv.prototype.create=function(){};Fv.prototype.interfaces_=function(){return[]};Fv.prototype.getClass=function(){return Fv};var wt=function(){},db={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};wt.prototype.interfaces_=function(){return[]};wt.prototype.getClass=function(){return wt};wt.toLocationSymbol=function(e){switch(e){case wt.EXTERIOR:return"e";case wt.BOUNDARY:return"b";case wt.INTERIOR:return"i";case wt.NONE:return"-"}throw new io("Unknown location value: "+e)};db.INTERIOR.get=function(){return 0};db.BOUNDARY.get=function(){return 1};db.EXTERIOR.get=function(){return 2};db.NONE.get=function(){return-1};Object.defineProperties(wt,db);var Hi=function(n,e){return n.interfaces_&&n.interfaces_().indexOf(e)>-1},sc=function(){},rR={LOG_10:{configurable:!0}};sc.prototype.interfaces_=function(){return[]};sc.prototype.getClass=function(){return sc};sc.log10=function(e){var t=Math.log(e);return rr.isInfinite(t)||rr.isNaN(t)?t:t/sc.LOG_10};sc.min=function(e,t,i,r){var a=e;return t<a&&(a=t),i<a&&(a=i),r<a&&(a=r),a};sc.clamp=function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],t=arguments[1],i=arguments[2];return e<t?t:e>i?i:e}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var r=arguments[0],a=arguments[1],l=arguments[2];return r<a?a:r>l?l:r}};sc.wrap=function(e,t){return e<0?t- -e%t:e%t};sc.max=function(){if(arguments.length===3){var e=arguments[0],t=arguments[1],i=arguments[2],r=e;return t>r&&(r=t),i>r&&(r=i),r}else if(arguments.length===4){var a=arguments[0],l=arguments[1],s=arguments[2],d=arguments[3],g=a;return l>g&&(g=l),s>g&&(g=s),d>g&&(g=d),g}};sc.average=function(e,t){return(e+t)/2};rR.LOG_10.get=function(){return Math.log(10)};Object.defineProperties(sc,rR);var Nf=function(e){this.str=e};Nf.prototype.append=function(e){this.str+=e};Nf.prototype.setCharAt=function(e,t){this.str=this.str.substr(0,e)+t+this.str.substr(e+1)};Nf.prototype.toString=function(e){return this.str};var wf=function(e){this.value=e};wf.prototype.intValue=function(){return this.value};wf.prototype.compareTo=function(e){return this.value<e?-1:this.value>e?1:0};wf.isNaN=function(e){return Number.isNaN(e)};var H1=function(){};H1.isWhitespace=function(e){return e<=32&&e>=0||e===127};H1.toUpperCase=function(e){return e.toUpperCase()};var Ft=function n(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof n){var t=arguments[0];this.init(t)}else if(typeof arguments[0]=="string"){var i=arguments[0];n.call(this,n.parse(i))}}else if(arguments.length===2){var r=arguments[0],a=arguments[1];this.init(r,a)}},Oh={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};Ft.prototype.le=function(e){return(this._hi<e._hi||this._hi===e._hi)&&this._lo<=e._lo};Ft.prototype.extractSignificantDigits=function(e,t){var i=this.abs(),r=Ft.magnitude(i._hi),a=Ft.TEN.pow(r);i=i.divide(a),i.gt(Ft.TEN)?(i=i.divide(Ft.TEN),r+=1):i.lt(Ft.ONE)&&(i=i.multiply(Ft.TEN),r-=1);for(var l=r+1,s=new Nf,d=Ft.MAX_PRINT_DIGITS-1,g=0;g<=d;g++){e&&g===l&&s.append(".");var x=Math.trunc(i._hi);if(x<0)break;var I=!1,A=0;x>9?(I=!0,A="9"):A="0"+x,s.append(A),i=i.subtract(Ft.valueOf(x)).multiply(Ft.TEN),I&&i.selfAdd(Ft.TEN);var L=!0,N=Ft.magnitude(i._hi);if(N<0&&Math.abs(N)>=d-g&&(L=!1),!L)break}return t[0]=r,s.toString()};Ft.prototype.sqr=function(){return this.multiply(this)};Ft.prototype.doubleValue=function(){return this._hi+this._lo};Ft.prototype.subtract=function(){if(arguments[0]instanceof Ft){var e=arguments[0];return this.add(e.negate())}else if(typeof arguments[0]=="number"){var t=arguments[0];return this.add(-t)}};Ft.prototype.equals=function(){if(arguments.length===1){var e=arguments[0];return this._hi===e._hi&&this._lo===e._lo}};Ft.prototype.isZero=function(){return this._hi===0&&this._lo===0};Ft.prototype.selfSubtract=function(){if(arguments[0]instanceof Ft){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e._hi,-e._lo)}else if(typeof arguments[0]=="number"){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t,0)}};Ft.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null};Ft.prototype.min=function(e){return this.le(e)?this:e};Ft.prototype.selfDivide=function(){if(arguments.length===1){if(arguments[0]instanceof Ft){var e=arguments[0];return this.selfDivide(e._hi,e._lo)}else if(typeof arguments[0]=="number"){var t=arguments[0];return this.selfDivide(t,0)}}else if(arguments.length===2){var i=arguments[0],r=arguments[1],a=null,l=null,s=null,d=null,g=null,x=null,I=null,A=null;return g=this._hi/i,x=Ft.SPLIT*g,a=x-g,A=Ft.SPLIT*i,a=x-a,l=g-a,s=A-i,I=g*i,s=A-s,d=i-s,A=a*s-I+a*d+l*s+l*d,x=(this._hi-I-A+this._lo-g*r)/i,A=g+x,this._hi=A,this._lo=g-A+x,this}};Ft.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"};Ft.prototype.divide=function(){if(arguments[0]instanceof Ft){var e=arguments[0],t=null,i=null,r=null,a=null,l=null,s=null,d=null,g=null;l=this._hi/e._hi,s=Ft.SPLIT*l,t=s-l,g=Ft.SPLIT*e._hi,t=s-t,i=l-t,r=g-e._hi,d=l*e._hi,r=g-r,a=e._hi-r,g=t*r-d+t*a+i*r+i*a,s=(this._hi-d-g+this._lo-l*e._lo)/e._hi,g=l+s;var x=g,I=l-g+s;return new Ft(x,I)}else if(typeof arguments[0]=="number"){var A=arguments[0];return rr.isNaN(A)?Ft.createNaN():Ft.copy(this).selfDivide(A,0)}};Ft.prototype.ge=function(e){return(this._hi>e._hi||this._hi===e._hi)&&this._lo>=e._lo};Ft.prototype.pow=function(e){if(e===0)return Ft.valueOf(1);var t=new Ft(this),i=Ft.valueOf(1),r=Math.abs(e);if(r>1)for(;r>0;)r%2===1&&i.selfMultiply(t),r/=2,r>0&&(t=t.sqr());else i=t;return e<0?i.reciprocal():i};Ft.prototype.ceil=function(){if(this.isNaN())return Ft.NaN;var e=Math.ceil(this._hi),t=0;return e===this._hi&&(t=Math.ceil(this._lo)),new Ft(e,t)};Ft.prototype.compareTo=function(e){var t=e;return this._hi<t._hi?-1:this._hi>t._hi?1:this._lo<t._lo?-1:this._lo>t._lo?1:0};Ft.prototype.rint=function(){if(this.isNaN())return this;var e=this.add(.5);return e.floor()};Ft.prototype.setValue=function(){if(arguments[0]instanceof Ft){var e=arguments[0];return this.init(e),this}else if(typeof arguments[0]=="number"){var t=arguments[0];return this.init(t),this}};Ft.prototype.max=function(e){return this.ge(e)?this:e};Ft.prototype.sqrt=function(){if(this.isZero())return Ft.valueOf(0);if(this.isNegative())return Ft.NaN;var e=1/Math.sqrt(this._hi),t=this._hi*e,i=Ft.valueOf(t),r=this.subtract(i.sqr()),a=r._hi*(e*.5);return i.add(a)};Ft.prototype.selfAdd=function(){if(arguments.length===1){if(arguments[0]instanceof Ft){var e=arguments[0];return this.selfAdd(e._hi,e._lo)}else if(typeof arguments[0]=="number"){var t=arguments[0],i=null,r=null,a=null,l=null,s=null,d=null;return a=this._hi+t,s=a-this._hi,l=a-s,l=t-s+(this._hi-l),d=l+this._lo,i=a+d,r=d+(a-i),this._hi=i+r,this._lo=r+(i-this._hi),this}}else if(arguments.length===2){var g=arguments[0],x=arguments[1],I=null,A=null,L=null,N=null,B=null,F=null,z=null,V=null;B=this._hi+g,L=this._lo+x,z=B-this._hi,V=L-this._lo,F=B-z,N=L-V,F=g-z+(this._hi-F),N=x-V+(this._lo-N),z=F+L,I=B+z,A=z+(B-I),z=N+A;var Y=I+z,Q=z+(I-Y);return this._hi=Y,this._lo=Q,this}};Ft.prototype.selfMultiply=function(){if(arguments.length===1){if(arguments[0]instanceof Ft){var e=arguments[0];return this.selfMultiply(e._hi,e._lo)}else if(typeof arguments[0]=="number"){var t=arguments[0];return this.selfMultiply(t,0)}}else if(arguments.length===2){var i=arguments[0],r=arguments[1],a=null,l=null,s=null,d=null,g=null,x=null;g=Ft.SPLIT*this._hi,a=g-this._hi,x=Ft.SPLIT*i,a=g-a,l=this._hi-a,s=x-i,g=this._hi*i,s=x-s,d=i-s,x=a*s-g+a*d+l*s+l*d+(this._hi*r+this._lo*i);var I=g+x;a=g-I;var A=x+a;return this._hi=I,this._lo=A,this}};Ft.prototype.selfSqr=function(){return this.selfMultiply(this)};Ft.prototype.floor=function(){if(this.isNaN())return Ft.NaN;var e=Math.floor(this._hi),t=0;return e===this._hi&&(t=Math.floor(this._lo)),new Ft(e,t)};Ft.prototype.negate=function(){return this.isNaN()?this:new Ft(-this._hi,-this._lo)};Ft.prototype.clone=function(){};Ft.prototype.multiply=function(){if(arguments[0]instanceof Ft){var e=arguments[0];return e.isNaN()?Ft.createNaN():Ft.copy(this).selfMultiply(e)}else if(typeof arguments[0]=="number"){var t=arguments[0];return rr.isNaN(t)?Ft.createNaN():Ft.copy(this).selfMultiply(t,0)}};Ft.prototype.isNaN=function(){return rr.isNaN(this._hi)};Ft.prototype.intValue=function(){return Math.trunc(this._hi)};Ft.prototype.toString=function(){var e=Ft.magnitude(this._hi);return e>=-3&&e<=20?this.toStandardNotation():this.toSciNotation()};Ft.prototype.toStandardNotation=function(){var e=this.getSpecialNumberString();if(e!==null)return e;var t=new Array(1).fill(null),i=this.extractSignificantDigits(!0,t),r=t[0]+1,a=i;if(i.charAt(0)===".")a="0"+i;else if(r<0)a="0."+Ft.stringOfChar("0",-r)+i;else if(i.indexOf(".")===-1){var l=r-i.length,s=Ft.stringOfChar("0",l);a=i+s+".0"}return this.isNegative()?"-"+a:a};Ft.prototype.reciprocal=function(){var e=null,t=null,i=null,r=null,a=null,l=null,s=null,d=null;a=1/this._hi,l=Ft.SPLIT*a,e=l-a,d=Ft.SPLIT*this._hi,e=l-e,t=a-e,i=d-this._hi,s=a*this._hi,i=d-i,r=this._hi-i,d=e*i-s+e*r+t*i+t*r,l=(1-s-d-a*this._lo)/this._hi;var g=a+l,x=a-g+l;return new Ft(g,x)};Ft.prototype.toSciNotation=function(){if(this.isZero())return Ft.SCI_NOT_ZERO;var e=this.getSpecialNumberString();if(e!==null)return e;var t=new Array(1).fill(null),i=this.extractSignificantDigits(!1,t),r=Ft.SCI_NOT_EXPONENT_CHAR+t[0];if(i.charAt(0)==="0")throw new Error("Found leading zero: "+i);var a="";i.length>1&&(a=i.substring(1));var l=i.charAt(0)+"."+a;return this.isNegative()?"-"+l+r:l+r};Ft.prototype.abs=function(){return this.isNaN()?Ft.NaN:this.isNegative()?this.negate():new Ft(this)};Ft.prototype.isPositive=function(){return(this._hi>0||this._hi===0)&&this._lo>0};Ft.prototype.lt=function(e){return(this._hi<e._hi||this._hi===e._hi)&&this._lo<e._lo};Ft.prototype.add=function(){if(arguments[0]instanceof Ft){var e=arguments[0];return Ft.copy(this).selfAdd(e)}else if(typeof arguments[0]=="number"){var t=arguments[0];return Ft.copy(this).selfAdd(t)}};Ft.prototype.init=function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var e=arguments[0];this._hi=e,this._lo=0}else if(arguments[0]instanceof Ft){var t=arguments[0];this._hi=t._hi,this._lo=t._lo}}else if(arguments.length===2){var i=arguments[0],r=arguments[1];this._hi=i,this._lo=r}};Ft.prototype.gt=function(e){return(this._hi>e._hi||this._hi===e._hi)&&this._lo>e._lo};Ft.prototype.isNegative=function(){return(this._hi<0||this._hi===0)&&this._lo<0};Ft.prototype.trunc=function(){return this.isNaN()?Ft.NaN:this.isPositive()?this.floor():this.ceil()};Ft.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0};Ft.prototype.interfaces_=function(){return[Jc,Kc,mI]};Ft.prototype.getClass=function(){return Ft};Ft.sqr=function(e){return Ft.valueOf(e).selfMultiply(e)};Ft.valueOf=function(){if(typeof arguments[0]=="string"){var e=arguments[0];return Ft.parse(e)}else if(typeof arguments[0]=="number"){var t=arguments[0];return new Ft(t)}};Ft.sqrt=function(e){return Ft.valueOf(e).sqrt()};Ft.parse=function(e){for(var t=0,i=e.length;H1.isWhitespace(e.charAt(t));)t++;var r=!1;if(t<i){var a=e.charAt(t);(a==="-"||a==="+")&&(t++,a==="-"&&(r=!0))}for(var l=new Ft,s=0,d=0,g=0;!(t>=i);){var x=e.charAt(t);if(t++,H1.isDigit(x)){var I=x-"0";l.selfMultiply(Ft.TEN),l.selfAdd(I),s++;continue}if(x==="."){d=s;continue}if(x==="e"||x==="E"){var A=e.substring(t);try{g=wf.parseInt(A)}catch(z){throw z instanceof Error?new Error("Invalid exponent "+A+" in string "+e):z}finally{}break}throw new Error("Unexpected character '"+x+"' at position "+t+" in string "+e)}var L=l,N=s-d-g;if(N===0)L=l;else if(N>0){var B=Ft.TEN.pow(N);L=l.divide(B)}else if(N<0){var F=Ft.TEN.pow(-N);L=l.multiply(F)}return r?L.negate():L};Ft.createNaN=function(){return new Ft(rr.NaN,rr.NaN)};Ft.copy=function(e){return new Ft(e)};Ft.magnitude=function(e){var t=Math.abs(e),i=Math.log(t)/Math.log(10),r=Math.trunc(Math.floor(i)),a=Math.pow(10,r);return a*10<=t&&(r+=1),r};Ft.stringOfChar=function(e,t){for(var i=new Nf,r=0;r<t;r++)i.append(e);return i.toString()};Oh.PI.get=function(){return new Ft(3.141592653589793,12246467991473532e-32)};Oh.TWO_PI.get=function(){return new Ft(6.283185307179586,24492935982947064e-32)};Oh.PI_2.get=function(){return new Ft(1.5707963267948966,6123233995736766e-32)};Oh.E.get=function(){return new Ft(2.718281828459045,14456468917292502e-32)};Oh.NaN.get=function(){return new Ft(rr.NaN,rr.NaN)};Oh.EPS.get=function(){return 123259516440783e-46};Oh.SPLIT.get=function(){return 134217729};Oh.MAX_PRINT_DIGITS.get=function(){return 32};Oh.TEN.get=function(){return Ft.valueOf(10)};Oh.ONE.get=function(){return Ft.valueOf(1)};Oh.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"};Oh.SCI_NOT_ZERO.get=function(){return"0.0E0"};Object.defineProperties(Ft,Oh);var ru=function(){},sR={DP_SAFE_EPSILON:{configurable:!0}};ru.prototype.interfaces_=function(){return[]};ru.prototype.getClass=function(){return ru};ru.orientationIndex=function(e,t,i){var r=ru.orientationIndexFilter(e,t,i);if(r<=1)return r;var a=Ft.valueOf(t.x).selfAdd(-e.x),l=Ft.valueOf(t.y).selfAdd(-e.y),s=Ft.valueOf(i.x).selfAdd(-t.x),d=Ft.valueOf(i.y).selfAdd(-t.y);return a.selfMultiply(d).selfSubtract(l.selfMultiply(s)).signum()};ru.signOfDet2x2=function(e,t,i,r){var a=e.multiply(r).selfSubtract(t.multiply(i));return a.signum()};ru.intersection=function(e,t,i,r){var a=Ft.valueOf(r.y).selfSubtract(i.y).selfMultiply(Ft.valueOf(t.x).selfSubtract(e.x)),l=Ft.valueOf(r.x).selfSubtract(i.x).selfMultiply(Ft.valueOf(t.y).selfSubtract(e.y)),s=a.subtract(l),d=Ft.valueOf(r.x).selfSubtract(i.x).selfMultiply(Ft.valueOf(e.y).selfSubtract(i.y)),g=Ft.valueOf(r.y).selfSubtract(i.y).selfMultiply(Ft.valueOf(e.x).selfSubtract(i.x)),x=d.subtract(g),I=x.selfDivide(s).doubleValue(),A=Ft.valueOf(e.x).selfAdd(Ft.valueOf(t.x).selfSubtract(e.x).selfMultiply(I)).doubleValue(),L=Ft.valueOf(t.x).selfSubtract(e.x).selfMultiply(Ft.valueOf(e.y).selfSubtract(i.y)),N=Ft.valueOf(t.y).selfSubtract(e.y).selfMultiply(Ft.valueOf(e.x).selfSubtract(i.x)),B=L.subtract(N),F=B.selfDivide(s).doubleValue(),z=Ft.valueOf(i.y).selfAdd(Ft.valueOf(r.y).selfSubtract(i.y).selfMultiply(F)).doubleValue();return new mt(A,z)};ru.orientationIndexFilter=function(e,t,i){var r=null,a=(e.x-i.x)*(t.y-i.y),l=(e.y-i.y)*(t.x-i.x),s=a-l;if(a>0){if(l<=0)return ru.signum(s);r=a+l}else if(a<0){if(l>=0)return ru.signum(s);r=-a-l}else return ru.signum(s);var d=ru.DP_SAFE_EPSILON*r;return s>=d||-s>=d?ru.signum(s):2};ru.signum=function(e){return e>0?1:e<0?-1:0};sR.DP_SAFE_EPSILON.get=function(){return 1e-15};Object.defineProperties(ru,sR);var qr=function(){},pb={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};pb.X.get=function(){return 0};pb.Y.get=function(){return 1};pb.Z.get=function(){return 2};pb.M.get=function(){return 3};qr.prototype.setOrdinate=function(e,t,i){};qr.prototype.size=function(){};qr.prototype.getOrdinate=function(e,t){};qr.prototype.getCoordinate=function(){};qr.prototype.getCoordinateCopy=function(e){};qr.prototype.getDimension=function(){};qr.prototype.getX=function(e){};qr.prototype.clone=function(){};qr.prototype.expandEnvelope=function(e){};qr.prototype.copy=function(){};qr.prototype.getY=function(e){};qr.prototype.toCoordinateArray=function(){};qr.prototype.interfaces_=function(){return[mI]};qr.prototype.getClass=function(){return qr};Object.defineProperties(qr,pb);var oR=function(){},a0=function(n){function e(){n.call(this,"Projective point not representable on the Cartesian plane.")}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(oR),Wa=function(){};Wa.arraycopy=function(e,t,i,r,a){for(var l=0,s=t;s<t+a;s++)i[r+l]=e[s],l++};Wa.getProperty=function(e){return{"line.separator":`
`}[e]};var Ih=function n(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],i=arguments[1];this.x=t,this.y=i,this.w=1}else if(arguments[0]instanceof n&&arguments[1]instanceof n){var r=arguments[0],a=arguments[1];this.x=r.y*a.w-a.y*r.w,this.y=a.x*r.w-r.x*a.w,this.w=r.x*a.y-a.x*r.y}else if(arguments[0]instanceof mt&&arguments[1]instanceof mt){var l=arguments[0],s=arguments[1];this.x=l.y-s.y,this.y=s.x-l.x,this.w=l.x*s.y-s.x*l.y}}else if(arguments.length===3){var d=arguments[0],g=arguments[1],x=arguments[2];this.x=d,this.y=g,this.w=x}else if(arguments.length===4){var I=arguments[0],A=arguments[1],L=arguments[2],N=arguments[3],B=I.y-A.y,F=A.x-I.x,z=I.x*A.y-A.x*I.y,V=L.y-N.y,Y=N.x-L.x,Q=L.x*N.y-N.x*L.y;this.x=F*Q-Y*z,this.y=V*z-B*Q,this.w=B*Y-V*F}};Ih.prototype.getY=function(){var e=this.y/this.w;if(rr.isNaN(e)||rr.isInfinite(e))throw new a0;return e};Ih.prototype.getX=function(){var e=this.x/this.w;if(rr.isNaN(e)||rr.isInfinite(e))throw new a0;return e};Ih.prototype.getCoordinate=function(){var e=new mt;return e.x=this.getX(),e.y=this.getY(),e};Ih.prototype.interfaces_=function(){return[]};Ih.prototype.getClass=function(){return Ih};Ih.intersection=function(e,t,i,r){var a=e.y-t.y,l=t.x-e.x,s=e.x*t.y-t.x*e.y,d=i.y-r.y,g=r.x-i.x,x=i.x*r.y-r.x*i.y,I=l*x-g*s,A=d*s-a*x,L=a*g-d*l,N=I/L,B=A/L;if(rr.isNaN(N)||rr.isInfinite(N)||rr.isNaN(B)||rr.isInfinite(B))throw new a0;return new mt(N,B)};var Ii=function n(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof mt){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof n){var t=arguments[0];this.init(t)}}else if(arguments.length===2){var i=arguments[0],r=arguments[1];this.init(i.x,r.x,i.y,r.y)}else if(arguments.length===4){var a=arguments[0],l=arguments[1],s=arguments[2],d=arguments[3];this.init(a,l,s,d)}},aR={serialVersionUID:{configurable:!0}};Ii.prototype.getArea=function(){return this.getWidth()*this.getHeight()};Ii.prototype.equals=function(e){if(!(e instanceof Ii))return!1;var t=e;return this.isNull()?t.isNull():this._maxx===t.getMaxX()&&this._maxy===t.getMaxY()&&this._minx===t.getMinX()&&this._miny===t.getMinY()};Ii.prototype.intersection=function(e){if(this.isNull()||e.isNull()||!this.intersects(e))return new Ii;var t=this._minx>e._minx?this._minx:e._minx,i=this._miny>e._miny?this._miny:e._miny,r=this._maxx<e._maxx?this._maxx:e._maxx,a=this._maxy<e._maxy?this._maxy:e._maxy;return new Ii(t,r,i,a)};Ii.prototype.isNull=function(){return this._maxx<this._minx};Ii.prototype.getMaxX=function(){return this._maxx};Ii.prototype.covers=function(){if(arguments.length===1){if(arguments[0]instanceof mt){var e=arguments[0];return this.covers(e.x,e.y)}else if(arguments[0]instanceof Ii){var t=arguments[0];return this.isNull()||t.isNull()?!1:t.getMinX()>=this._minx&&t.getMaxX()<=this._maxx&&t.getMinY()>=this._miny&&t.getMaxY()<=this._maxy}}else if(arguments.length===2){var i=arguments[0],r=arguments[1];return this.isNull()?!1:i>=this._minx&&i<=this._maxx&&r>=this._miny&&r<=this._maxy}};Ii.prototype.intersects=function(){if(arguments.length===1){if(arguments[0]instanceof Ii){var e=arguments[0];return this.isNull()||e.isNull()?!1:!(e._minx>this._maxx||e._maxx<this._minx||e._miny>this._maxy||e._maxy<this._miny)}else if(arguments[0]instanceof mt){var t=arguments[0];return this.intersects(t.x,t.y)}}else if(arguments.length===2){var i=arguments[0],r=arguments[1];return this.isNull()?!1:!(i>this._maxx||i<this._minx||r>this._maxy||r<this._miny)}};Ii.prototype.getMinY=function(){return this._miny};Ii.prototype.getMinX=function(){return this._minx};Ii.prototype.expandToInclude=function(){if(arguments.length===1){if(arguments[0]instanceof mt){var e=arguments[0];this.expandToInclude(e.x,e.y)}else if(arguments[0]instanceof Ii){var t=arguments[0];if(t.isNull())return null;this.isNull()?(this._minx=t.getMinX(),this._maxx=t.getMaxX(),this._miny=t.getMinY(),this._maxy=t.getMaxY()):(t._minx<this._minx&&(this._minx=t._minx),t._maxx>this._maxx&&(this._maxx=t._maxx),t._miny<this._miny&&(this._miny=t._miny),t._maxy>this._maxy&&(this._maxy=t._maxy))}}else if(arguments.length===2){var i=arguments[0],r=arguments[1];this.isNull()?(this._minx=i,this._maxx=i,this._miny=r,this._maxy=r):(i<this._minx&&(this._minx=i),i>this._maxx&&(this._maxx=i),r<this._miny&&(this._miny=r),r>this._maxy&&(this._maxy=r))}};Ii.prototype.minExtent=function(){if(this.isNull())return 0;var e=this.getWidth(),t=this.getHeight();return e<t?e:t};Ii.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx};Ii.prototype.compareTo=function(e){var t=e;return this.isNull()?t.isNull()?0:-1:t.isNull()?1:this._minx<t._minx?-1:this._minx>t._minx?1:this._miny<t._miny?-1:this._miny>t._miny?1:this._maxx<t._maxx?-1:this._maxx>t._maxx?1:this._maxy<t._maxy?-1:this._maxy>t._maxy?1:0};Ii.prototype.translate=function(e,t){if(this.isNull())return null;this.init(this.getMinX()+e,this.getMaxX()+e,this.getMinY()+t,this.getMaxY()+t)};Ii.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"};Ii.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1};Ii.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny};Ii.prototype.maxExtent=function(){if(this.isNull())return 0;var e=this.getWidth(),t=this.getHeight();return e>t?e:t};Ii.prototype.expandBy=function(){if(arguments.length===1){var e=arguments[0];this.expandBy(e,e)}else if(arguments.length===2){var t=arguments[0],i=arguments[1];if(this.isNull())return null;this._minx-=t,this._maxx+=t,this._miny-=i,this._maxy+=i,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}};Ii.prototype.contains=function(){if(arguments.length===1){if(arguments[0]instanceof Ii){var e=arguments[0];return this.covers(e)}else if(arguments[0]instanceof mt){var t=arguments[0];return this.covers(t)}}else if(arguments.length===2){var i=arguments[0],r=arguments[1];return this.covers(i,r)}};Ii.prototype.centre=function(){return this.isNull()?null:new mt((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)};Ii.prototype.init=function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof mt){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof Ii){var t=arguments[0];this._minx=t._minx,this._maxx=t._maxx,this._miny=t._miny,this._maxy=t._maxy}}else if(arguments.length===2){var i=arguments[0],r=arguments[1];this.init(i.x,r.x,i.y,r.y)}else if(arguments.length===4){var a=arguments[0],l=arguments[1],s=arguments[2],d=arguments[3];a<l?(this._minx=a,this._maxx=l):(this._minx=l,this._maxx=a),s<d?(this._miny=s,this._maxy=d):(this._miny=d,this._maxy=s)}};Ii.prototype.getMaxY=function(){return this._maxy};Ii.prototype.distance=function(e){if(this.intersects(e))return 0;var t=0;this._maxx<e._minx?t=e._minx-this._maxx:this._minx>e._maxx&&(t=this._minx-e._maxx);var i=0;return this._maxy<e._miny?i=e._miny-this._maxy:this._miny>e._maxy&&(i=this._miny-e._maxy),t===0?i:i===0?t:Math.sqrt(t*t+i*i)};Ii.prototype.hashCode=function(){var e=17;return e=37*e+mt.hashCode(this._minx),e=37*e+mt.hashCode(this._maxx),e=37*e+mt.hashCode(this._miny),e=37*e+mt.hashCode(this._maxy),e};Ii.prototype.interfaces_=function(){return[Kc,Jc]};Ii.prototype.getClass=function(){return Ii};Ii.intersects=function(){if(arguments.length===3){var e=arguments[0],t=arguments[1],i=arguments[2];return i.x>=(e.x<t.x?e.x:t.x)&&i.x<=(e.x>t.x?e.x:t.x)&&i.y>=(e.y<t.y?e.y:t.y)&&i.y<=(e.y>t.y?e.y:t.y)}else if(arguments.length===4){var r=arguments[0],a=arguments[1],l=arguments[2],s=arguments[3],d=Math.min(l.x,s.x),g=Math.max(l.x,s.x),x=Math.min(r.x,a.x),I=Math.max(r.x,a.x);return!(x>g||I<d||(d=Math.min(l.y,s.y),g=Math.max(l.y,s.y),x=Math.min(r.y,a.y),I=Math.max(r.y,a.y),x>g)||I<d)}};aR.serialVersionUID.get=function(){return 5873921885273102e3};Object.defineProperties(Ii,aR);var pf={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},gI=function(e){this.geometryFactory=e||new Lr};gI.prototype.read=function(e){var t,i,r;e=e.replace(/[\n\r]/g," ");var a=pf.typeStr.exec(e);if(e.search("EMPTY")!==-1&&(a=pf.emptyTypeStr.exec(e),a[2]=void 0),a&&(i=a[1].toLowerCase(),r=a[2],gv[i]&&(t=gv[i].apply(this,[r]))),t===void 0)throw new Error("Could not parse WKT "+e);return t};gI.prototype.write=function(e){return this.extractGeometry(e)};gI.prototype.extractGeometry=function(e){var t=e.getGeometryType().toLowerCase();if(!ip[t])return null;var i=t.toUpperCase(),r;return e.isEmpty()?r=i+" EMPTY":r=i+"("+ip[t].apply(this,[e])+")",r};var ip={coordinate:function(e){return e.x+" "+e.y},point:function(e){return ip.coordinate.call(this,e._coordinates._coordinates[0])},multipoint:function(e){for(var t=this,i=[],r=0,a=e._geometries.length;r<a;++r)i.push("("+ip.point.apply(t,[e._geometries[r]])+")");return i.join(",")},linestring:function(e){for(var t=this,i=[],r=0,a=e._points._coordinates.length;r<a;++r)i.push(ip.coordinate.apply(t,[e._points._coordinates[r]]));return i.join(",")},linearring:function(e){for(var t=this,i=[],r=0,a=e._points._coordinates.length;r<a;++r)i.push(ip.coordinate.apply(t,[e._points._coordinates[r]]));return i.join(",")},multilinestring:function(e){for(var t=this,i=[],r=0,a=e._geometries.length;r<a;++r)i.push("("+ip.linestring.apply(t,[e._geometries[r]])+")");return i.join(",")},polygon:function(e){var t=this,i=[];i.push("("+ip.linestring.apply(this,[e._shell])+")");for(var r=0,a=e._holes.length;r<a;++r)i.push("("+ip.linestring.apply(t,[e._holes[r]])+")");return i.join(",")},multipolygon:function(e){for(var t=this,i=[],r=0,a=e._geometries.length;r<a;++r)i.push("("+ip.polygon.apply(t,[e._geometries[r]])+")");return i.join(",")},geometrycollection:function(e){for(var t=this,i=[],r=0,a=e._geometries.length;r<a;++r)i.push(t.extractGeometry(e._geometries[r]));return i.join(",")}},gv={point:function(e){if(e===void 0)return this.geometryFactory.createPoint();var t=e.trim().split(pf.spaces);return this.geometryFactory.createPoint(new mt(Number.parseFloat(t[0]),Number.parseFloat(t[1])))},multipoint:function(e){var t=this;if(e===void 0)return this.geometryFactory.createMultiPoint();for(var i,r=e.trim().split(","),a=[],l=0,s=r.length;l<s;++l)i=r[l].replace(pf.trimParens,"$1"),a.push(gv.point.apply(t,[i]));return this.geometryFactory.createMultiPoint(a)},linestring:function(e){if(e===void 0)return this.geometryFactory.createLineString();for(var t=e.trim().split(","),i=[],r,a=0,l=t.length;a<l;++a)r=t[a].trim().split(pf.spaces),i.push(new mt(Number.parseFloat(r[0]),Number.parseFloat(r[1])));return this.geometryFactory.createLineString(i)},linearring:function(e){if(e===void 0)return this.geometryFactory.createLinearRing();for(var t=e.trim().split(","),i=[],r,a=0,l=t.length;a<l;++a)r=t[a].trim().split(pf.spaces),i.push(new mt(Number.parseFloat(r[0]),Number.parseFloat(r[1])));return this.geometryFactory.createLinearRing(i)},multilinestring:function(e){var t=this;if(e===void 0)return this.geometryFactory.createMultiLineString();for(var i,r=e.trim().split(pf.parenComma),a=[],l=0,s=r.length;l<s;++l)i=r[l].replace(pf.trimParens,"$1"),a.push(gv.linestring.apply(t,[i]));return this.geometryFactory.createMultiLineString(a)},polygon:function(e){var t=this;if(e===void 0)return this.geometryFactory.createPolygon();for(var i,r,a,l=e.trim().split(pf.parenComma),s,d=[],g=0,x=l.length;g<x;++g)i=l[g].replace(pf.trimParens,"$1"),r=gv.linestring.apply(t,[i]),a=t.geometryFactory.createLinearRing(r._points),g===0?s=a:d.push(a);return this.geometryFactory.createPolygon(s,d)},multipolygon:function(e){var t=this;if(e===void 0)return this.geometryFactory.createMultiPolygon();for(var i,r=e.trim().split(pf.doubleParenComma),a=[],l=0,s=r.length;l<s;++l)i=r[l].replace(pf.trimParens,"$1"),a.push(gv.polygon.apply(t,[i]));return this.geometryFactory.createMultiPolygon(a)},geometrycollection:function(e){var t=this;if(e===void 0)return this.geometryFactory.createGeometryCollection();e=e.replace(/,\s*([A-Za-z])/g,"|$1");for(var i=e.trim().split("|"),r=[],a=0,l=i.length;a<l;++a)r.push(t.read(i[a]));return this.geometryFactory.createGeometryCollection(r)}},Sh=function(e){this.parser=new gI(e)};Sh.prototype.write=function(e){return this.parser.write(e)};Sh.toLineString=function(e,t){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+e.x+" "+e.y+", "+t.x+" "+t.y+" )"};var pp=function(n){function e(t){n.call(this,t),this.name="RuntimeException",this.message=t,this.stack=new n().stack}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e}(Error),jE=function(n){function e(){if(n.call(this),arguments.length===0)n.call(this);else if(arguments.length===1){var t=arguments[0];n.call(this,t)}}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(pp),dr=function(){};dr.prototype.interfaces_=function(){return[]};dr.prototype.getClass=function(){return dr};dr.shouldNeverReachHere=function(){if(arguments.length===0)dr.shouldNeverReachHere(null);else if(arguments.length===1){var e=arguments[0];throw new jE("Should never reach here"+(e!==null?": "+e:""))}};dr.isTrue=function(){var e,t;if(arguments.length===1)e=arguments[0],dr.isTrue(e,null);else if(arguments.length===2&&(e=arguments[0],t=arguments[1],!e))throw t===null?new jE:new jE(t)};dr.equals=function(){var e,t,i;if(arguments.length===2)e=arguments[0],t=arguments[1],dr.equals(e,t,null);else if(arguments.length===3&&(e=arguments[0],t=arguments[1],i=arguments[2],!t.equals(e)))throw new jE("Expected "+e+" but encountered "+t+(i!==null?": "+i:""))};var fo=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new mt,this._intPt[1]=new mt,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},W_={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};fo.prototype.getIndexAlongSegment=function(e,t){return this.computeIntLineIndex(),this._intLineIndex[e][t]};fo.prototype.getTopologySummary=function(){var e=new Nf;return this.isEndPoint()&&e.append(" endpoint"),this._isProper&&e.append(" proper"),this.isCollinear()&&e.append(" collinear"),e.toString()};fo.prototype.computeIntersection=function(e,t,i,r){this._inputLines[0][0]=e,this._inputLines[0][1]=t,this._inputLines[1][0]=i,this._inputLines[1][1]=r,this._result=this.computeIntersect(e,t,i,r)};fo.prototype.getIntersectionNum=function(){return this._result};fo.prototype.computeIntLineIndex=function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var e=arguments[0],t=this.getEdgeDistance(e,0),i=this.getEdgeDistance(e,1);t>i?(this._intLineIndex[e][0]=0,this._intLineIndex[e][1]=1):(this._intLineIndex[e][0]=1,this._intLineIndex[e][1]=0)}};fo.prototype.isProper=function(){return this.hasIntersection()&&this._isProper};fo.prototype.setPrecisionModel=function(e){this._precisionModel=e};fo.prototype.isInteriorIntersection=function(){var e=this;if(arguments.length===0)return!!(this.isInteriorIntersection(0)||this.isInteriorIntersection(1));if(arguments.length===1){for(var t=arguments[0],i=0;i<this._result;i++)if(!(e._intPt[i].equals2D(e._inputLines[t][0])||e._intPt[i].equals2D(e._inputLines[t][1])))return!0;return!1}};fo.prototype.getIntersection=function(e){return this._intPt[e]};fo.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper};fo.prototype.hasIntersection=function(){return this._result!==fo.NO_INTERSECTION};fo.prototype.getEdgeDistance=function(e,t){var i=fo.computeEdgeDistance(this._intPt[t],this._inputLines[e][0],this._inputLines[e][1]);return i};fo.prototype.isCollinear=function(){return this._result===fo.COLLINEAR_INTERSECTION};fo.prototype.toString=function(){return Sh.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Sh.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()};fo.prototype.getEndpoint=function(e,t){return this._inputLines[e][t]};fo.prototype.isIntersection=function(e){for(var t=this,i=0;i<this._result;i++)if(t._intPt[i].equals2D(e))return!0;return!1};fo.prototype.getIntersectionAlongSegment=function(e,t){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[e][t]]};fo.prototype.interfaces_=function(){return[]};fo.prototype.getClass=function(){return fo};fo.computeEdgeDistance=function(e,t,i){var r=Math.abs(i.x-t.x),a=Math.abs(i.y-t.y),l=-1;if(e.equals(t))l=0;else if(e.equals(i))r>a?l=r:l=a;else{var s=Math.abs(e.x-t.x),d=Math.abs(e.y-t.y);r>a?l=s:l=d,l===0&&!e.equals(t)&&(l=Math.max(s,d))}return dr.isTrue(!(l===0&&!e.equals(t)),"Bad distance calculation"),l};fo.nonRobustComputeEdgeDistance=function(e,t,i){var r=e.x-t.x,a=e.y-t.y,l=Math.sqrt(r*r+a*a);return dr.isTrue(!(l===0&&!e.equals(t)),"Invalid distance calculation"),l};W_.DONT_INTERSECT.get=function(){return 0};W_.DO_INTERSECT.get=function(){return 1};W_.COLLINEAR.get=function(){return 2};W_.NO_INTERSECTION.get=function(){return 0};W_.POINT_INTERSECTION.get=function(){return 1};W_.COLLINEAR_INTERSECTION.get=function(){return 2};Object.defineProperties(fo,W_);var Ig=function(n){function e(){n.apply(this,arguments)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.isInSegmentEnvelopes=function(i){var r=new Ii(this._inputLines[0][0],this._inputLines[0][1]),a=new Ii(this._inputLines[1][0],this._inputLines[1][1]);return r.contains(i)&&a.contains(i)},e.prototype.computeIntersection=function(){if(arguments.length===3){var i=arguments[0],r=arguments[1],a=arguments[2];if(this._isProper=!1,Ii.intersects(r,a,i)&&Jn.orientationIndex(r,a,i)===0&&Jn.orientationIndex(a,r,i)===0)return this._isProper=!0,(i.equals(r)||i.equals(a))&&(this._isProper=!1),this._result=n.POINT_INTERSECTION,null;this._result=n.NO_INTERSECTION}else return n.prototype.computeIntersection.apply(this,arguments)},e.prototype.normalizeToMinimum=function(i,r,a,l,s){s.x=this.smallestInAbsValue(i.x,r.x,a.x,l.x),s.y=this.smallestInAbsValue(i.y,r.y,a.y,l.y),i.x-=s.x,i.y-=s.y,r.x-=s.x,r.y-=s.y,a.x-=s.x,a.y-=s.y,l.x-=s.x,l.y-=s.y},e.prototype.safeHCoordinateIntersection=function(i,r,a,l){var s=null;try{s=Ih.intersection(i,r,a,l)}catch(d){if(d instanceof a0)s=e.nearestEndpoint(i,r,a,l);else throw d}finally{}return s},e.prototype.intersection=function(i,r,a,l){var s=this.intersectionWithNormalization(i,r,a,l);return this.isInSegmentEnvelopes(s)||(s=new mt(e.nearestEndpoint(i,r,a,l))),this._precisionModel!==null&&this._precisionModel.makePrecise(s),s},e.prototype.smallestInAbsValue=function(i,r,a,l){var s=i,d=Math.abs(s);return Math.abs(r)<d&&(s=r,d=Math.abs(r)),Math.abs(a)<d&&(s=a,d=Math.abs(a)),Math.abs(l)<d&&(s=l),s},e.prototype.checkDD=function(i,r,a,l,s){var d=ru.intersection(i,r,a,l),g=this.isInSegmentEnvelopes(d);Wa.out.println("DD in env = "+g+"  --------------------- "+d),s.distance(d)>1e-4&&Wa.out.println("Distance = "+s.distance(d))},e.prototype.intersectionWithNormalization=function(i,r,a,l){var s=new mt(i),d=new mt(r),g=new mt(a),x=new mt(l),I=new mt;this.normalizeToEnvCentre(s,d,g,x,I);var A=this.safeHCoordinateIntersection(s,d,g,x);return A.x+=I.x,A.y+=I.y,A},e.prototype.computeCollinearIntersection=function(i,r,a,l){var s=Ii.intersects(i,r,a),d=Ii.intersects(i,r,l),g=Ii.intersects(a,l,i),x=Ii.intersects(a,l,r);return s&&d?(this._intPt[0]=a,this._intPt[1]=l,n.COLLINEAR_INTERSECTION):g&&x?(this._intPt[0]=i,this._intPt[1]=r,n.COLLINEAR_INTERSECTION):s&&g?(this._intPt[0]=a,this._intPt[1]=i,a.equals(i)&&!d&&!x?n.POINT_INTERSECTION:n.COLLINEAR_INTERSECTION):s&&x?(this._intPt[0]=a,this._intPt[1]=r,a.equals(r)&&!d&&!g?n.POINT_INTERSECTION:n.COLLINEAR_INTERSECTION):d&&g?(this._intPt[0]=l,this._intPt[1]=i,l.equals(i)&&!s&&!x?n.POINT_INTERSECTION:n.COLLINEAR_INTERSECTION):d&&x?(this._intPt[0]=l,this._intPt[1]=r,l.equals(r)&&!s&&!g?n.POINT_INTERSECTION:n.COLLINEAR_INTERSECTION):n.NO_INTERSECTION},e.prototype.normalizeToEnvCentre=function(i,r,a,l,s){var d=i.x<r.x?i.x:r.x,g=i.y<r.y?i.y:r.y,x=i.x>r.x?i.x:r.x,I=i.y>r.y?i.y:r.y,A=a.x<l.x?a.x:l.x,L=a.y<l.y?a.y:l.y,N=a.x>l.x?a.x:l.x,B=a.y>l.y?a.y:l.y,F=d>A?d:A,z=x<N?x:N,V=g>L?g:L,Y=I<B?I:B,Q=(F+z)/2,J=(V+Y)/2;s.x=Q,s.y=J,i.x-=s.x,i.y-=s.y,r.x-=s.x,r.y-=s.y,a.x-=s.x,a.y-=s.y,l.x-=s.x,l.y-=s.y},e.prototype.computeIntersect=function(i,r,a,l){if(this._isProper=!1,!Ii.intersects(i,r,a,l))return n.NO_INTERSECTION;var s=Jn.orientationIndex(i,r,a),d=Jn.orientationIndex(i,r,l);if(s>0&&d>0||s<0&&d<0)return n.NO_INTERSECTION;var g=Jn.orientationIndex(a,l,i),x=Jn.orientationIndex(a,l,r);if(g>0&&x>0||g<0&&x<0)return n.NO_INTERSECTION;var I=s===0&&d===0&&g===0&&x===0;return I?this.computeCollinearIntersection(i,r,a,l):(s===0||d===0||g===0||x===0?(this._isProper=!1,i.equals2D(a)||i.equals2D(l)?this._intPt[0]=i:r.equals2D(a)||r.equals2D(l)?this._intPt[0]=r:s===0?this._intPt[0]=new mt(a):d===0?this._intPt[0]=new mt(l):g===0?this._intPt[0]=new mt(i):x===0&&(this._intPt[0]=new mt(r))):(this._isProper=!0,this._intPt[0]=this.intersection(i,r,a,l)),n.POINT_INTERSECTION)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.nearestEndpoint=function(i,r,a,l){var s=i,d=Jn.distancePointLine(i,a,l),g=Jn.distancePointLine(r,a,l);return g<d&&(d=g,s=r),g=Jn.distancePointLine(a,i,r),g<d&&(d=g,s=a),g=Jn.distancePointLine(l,i,r),g<d&&(d=g,s=l),s},e}(fo),M_=function(){};M_.prototype.interfaces_=function(){return[]};M_.prototype.getClass=function(){return M_};M_.orientationIndex=function(e,t,i){var r=t.x-e.x,a=t.y-e.y,l=i.x-t.x,s=i.y-t.y;return M_.signOfDet2x2(r,a,l,s)};M_.signOfDet2x2=function(e,t,i,r){var a=null,l=null,s=null;if(a=1,e===0||r===0)return t===0||i===0?0:t>0?i>0?-a:a:i>0?a:-a;if(t===0||i===0)return r>0?e>0?a:-a:e>0?-a:a;if(t>0?r>0?t<=r||(a=-a,l=e,e=i,i=l,l=t,t=r,r=l):t<=-r?(a=-a,i=-i,r=-r):(l=e,e=-i,i=l,l=t,t=-r,r=l):r>0?-t<=r?(a=-a,e=-e,t=-t):(l=-e,e=i,i=l,l=-t,t=r,r=l):t>=r?(e=-e,t=-t,i=-i,r=-r):(a=-a,l=-e,e=-i,i=l,l=-t,t=-r,r=l),e>0)if(i>0){if(!(e<=i))return a}else return a;else{if(i>0)return-a;if(e>=i)a=-a,e=-e,i=-i;else return-a}for(;;){if(s=Math.floor(i/e),i=i-s*e,r=r-s*t,r<0)return-a;if(r>t)return a;if(e>i+i){if(t<r+r)return a}else{if(t>r+r)return-a;i=e-i,r=t-r,a=-a}if(r===0)return i===0?0:-a;if(i===0||(s=Math.floor(e/i),e=e-s*i,t=t-s*r,t<0))return a;if(t>r)return-a;if(i>e+e){if(r<t+t)return-a}else{if(r>t+t)return a;e=i-e,t=r-t,a=-a}if(t===0)return e===0?0:a;if(e===0)return-a}};var If=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var e=arguments[0];this._p=e};If.prototype.countSegment=function(e,t){if(e.x<this._p.x&&t.x<this._p.x)return null;if(this._p.x===t.x&&this._p.y===t.y)return this._isPointOnSegment=!0,null;if(e.y===this._p.y&&t.y===this._p.y){var i=e.x,r=t.x;return i>r&&(i=t.x,r=e.x),this._p.x>=i&&this._p.x<=r&&(this._isPointOnSegment=!0),null}if(e.y>this._p.y&&t.y<=this._p.y||t.y>this._p.y&&e.y<=this._p.y){var a=e.x-this._p.x,l=e.y-this._p.y,s=t.x-this._p.x,d=t.y-this._p.y,g=M_.signOfDet2x2(a,l,s,d);if(g===0)return this._isPointOnSegment=!0,null;d<l&&(g=-g),g>0&&this._crossingCount++}};If.prototype.isPointInPolygon=function(){return this.getLocation()!==wt.EXTERIOR};If.prototype.getLocation=function(){return this._isPointOnSegment?wt.BOUNDARY:this._crossingCount%2===1?wt.INTERIOR:wt.EXTERIOR};If.prototype.isOnSegment=function(){return this._isPointOnSegment};If.prototype.interfaces_=function(){return[]};If.prototype.getClass=function(){return If};If.locatePointInRing=function(){if(arguments[0]instanceof mt&&Hi(arguments[1],qr)){for(var e=arguments[0],t=arguments[1],i=new If(e),r=new mt,a=new mt,l=1;l<t.size();l++)if(t.getCoordinate(l,r),t.getCoordinate(l-1,a),i.countSegment(r,a),i.isOnSegment())return i.getLocation();return i.getLocation()}else if(arguments[0]instanceof mt&&arguments[1]instanceof Array){for(var s=arguments[0],d=arguments[1],g=new If(s),x=1;x<d.length;x++){var I=d[x],A=d[x-1];if(g.countSegment(I,A),g.isOnSegment())return g.getLocation()}return g.getLocation()}};var Jn=function(){},X_={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};Jn.prototype.interfaces_=function(){return[]};Jn.prototype.getClass=function(){return Jn};Jn.orientationIndex=function(e,t,i){return ru.orientationIndex(e,t,i)};Jn.signedArea=function(){if(arguments[0]instanceof Array){var e=arguments[0];if(e.length<3)return 0;for(var t=0,i=e[0].x,r=1;r<e.length-1;r++){var a=e[r].x-i,l=e[r+1].y,s=e[r-1].y;t+=a*(s-l)}return t/2}else if(Hi(arguments[0],qr)){var d=arguments[0],g=d.size();if(g<3)return 0;var x=new mt,I=new mt,A=new mt;d.getCoordinate(0,I),d.getCoordinate(1,A);var L=I.x;A.x-=L;for(var N=0,B=1;B<g-1;B++)x.y=I.y,I.x=A.x,I.y=A.y,d.getCoordinate(B+1,A),A.x-=L,N+=I.x*(x.y-A.y);return N/2}};Jn.distanceLineLine=function(e,t,i,r){if(e.equals(t))return Jn.distancePointLine(e,i,r);if(i.equals(r))return Jn.distancePointLine(r,e,t);var a=!1;if(!Ii.intersects(e,t,i,r))a=!0;else{var l=(t.x-e.x)*(r.y-i.y)-(t.y-e.y)*(r.x-i.x);if(l===0)a=!0;else{var s=(e.y-i.y)*(r.x-i.x)-(e.x-i.x)*(r.y-i.y),d=(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y),g=d/l,x=s/l;(x<0||x>1||g<0||g>1)&&(a=!0)}}return a?sc.min(Jn.distancePointLine(e,i,r),Jn.distancePointLine(t,i,r),Jn.distancePointLine(i,e,t),Jn.distancePointLine(r,e,t)):0};Jn.isPointInRing=function(e,t){return Jn.locatePointInRing(e,t)!==wt.EXTERIOR};Jn.computeLength=function(e){var t=e.size();if(t<=1)return 0;var i=0,r=new mt;e.getCoordinate(0,r);for(var a=r.x,l=r.y,s=1;s<t;s++){e.getCoordinate(s,r);var d=r.x,g=r.y,x=d-a,I=g-l;i+=Math.sqrt(x*x+I*I),a=d,l=g}return i};Jn.isCCW=function(e){var t=e.length-1;if(t<3)throw new io("Ring has fewer than 4 points, so orientation cannot be determined");for(var i=e[0],r=0,a=1;a<=t;a++){var l=e[a];l.y>i.y&&(i=l,r=a)}var s=r;do s=s-1,s<0&&(s=t);while(e[s].equals2D(i)&&s!==r);var d=r;do d=(d+1)%t;while(e[d].equals2D(i)&&d!==r);var g=e[s],x=e[d];if(g.equals2D(i)||x.equals2D(i)||g.equals2D(x))return!1;var I=Jn.computeOrientation(g,i,x),A=!1;return I===0?A=g.x>x.x:A=I>0,A};Jn.locatePointInRing=function(e,t){return If.locatePointInRing(e,t)};Jn.distancePointLinePerpendicular=function(e,t,i){var r=(i.x-t.x)*(i.x-t.x)+(i.y-t.y)*(i.y-t.y),a=((t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y))/r;return Math.abs(a)*Math.sqrt(r)};Jn.computeOrientation=function(e,t,i){return Jn.orientationIndex(e,t,i)};Jn.distancePointLine=function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];if(t.length===0)throw new io("Line array must contain at least one vertex");for(var i=e.distance(t[0]),r=0;r<t.length-1;r++){var a=Jn.distancePointLine(e,t[r],t[r+1]);a<i&&(i=a)}return i}else if(arguments.length===3){var l=arguments[0],s=arguments[1],d=arguments[2];if(s.x===d.x&&s.y===d.y)return l.distance(s);var g=(d.x-s.x)*(d.x-s.x)+(d.y-s.y)*(d.y-s.y),x=((l.x-s.x)*(d.x-s.x)+(l.y-s.y)*(d.y-s.y))/g;if(x<=0)return l.distance(s);if(x>=1)return l.distance(d);var I=((s.y-l.y)*(d.x-s.x)-(s.x-l.x)*(d.y-s.y))/g;return Math.abs(I)*Math.sqrt(g)}};Jn.isOnLine=function(e,t){for(var i=new Ig,r=1;r<t.length;r++){var a=t[r-1],l=t[r];if(i.computeIntersection(e,a,l),i.hasIntersection())return!0}return!1};X_.CLOCKWISE.get=function(){return-1};X_.RIGHT.get=function(){return Jn.CLOCKWISE};X_.COUNTERCLOCKWISE.get=function(){return 1};X_.LEFT.get=function(){return Jn.COUNTERCLOCKWISE};X_.COLLINEAR.get=function(){return 0};X_.STRAIGHT.get=function(){return Jn.COLLINEAR};Object.defineProperties(Jn,X_);var mp=function(){};mp.prototype.filter=function(e){};mp.prototype.interfaces_=function(){return[]};mp.prototype.getClass=function(){return mp};var Bi=function(){var e=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=e,this._SRID=e.getSRID()},Sd={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};Bi.prototype.isGeometryCollection=function(){return this.getSortIndex()===Bi.SORTINDEX_GEOMETRYCOLLECTION};Bi.prototype.getFactory=function(){return this._factory};Bi.prototype.getGeometryN=function(e){return this};Bi.prototype.getArea=function(){return 0};Bi.prototype.isRectangle=function(){return!1};Bi.prototype.equals=function(){if(arguments[0]instanceof Bi){var e=arguments[0];return e===null?!1:this.equalsTopo(e)}else if(arguments[0]instanceof Object){var t=arguments[0];if(!(t instanceof Bi))return!1;var i=t;return this.equalsExact(i)}};Bi.prototype.equalsExact=function(e){return this===e||this.equalsExact(e,0)};Bi.prototype.geometryChanged=function(){this.apply(Bi.geometryChangedFilter)};Bi.prototype.geometryChangedAction=function(){this._envelope=null};Bi.prototype.equalsNorm=function(e){return e===null?!1:this.norm().equalsExact(e.norm())};Bi.prototype.getLength=function(){return 0};Bi.prototype.getNumGeometries=function(){return 1};Bi.prototype.compareTo=function(){if(arguments.length===1){var e=arguments[0],t=e;return this.getSortIndex()!==t.getSortIndex()?this.getSortIndex()-t.getSortIndex():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e)}else if(arguments.length===2){var i=arguments[0],r=arguments[1];return this.getSortIndex()!==i.getSortIndex()?this.getSortIndex()-i.getSortIndex():this.isEmpty()&&i.isEmpty()?0:this.isEmpty()?-1:i.isEmpty()?1:this.compareToSameClass(i,r)}};Bi.prototype.getUserData=function(){return this._userData};Bi.prototype.getSRID=function(){return this._SRID};Bi.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())};Bi.prototype.checkNotGeometryCollection=function(e){if(e.getSortIndex()===Bi.SORTINDEX_GEOMETRYCOLLECTION)throw new io("This method does not support GeometryCollection arguments")};Bi.prototype.equal=function(e,t,i){return i===0?e.equals(t):e.distance(t)<=i};Bi.prototype.norm=function(){var e=this.copy();return e.normalize(),e};Bi.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()};Bi.prototype.getEnvelopeInternal=function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new Ii(this._envelope)};Bi.prototype.setSRID=function(e){this._SRID=e};Bi.prototype.setUserData=function(e){this._userData=e};Bi.prototype.compare=function(e,t){for(var i=e.iterator(),r=t.iterator();i.hasNext()&&r.hasNext();){var a=i.next(),l=r.next(),s=a.compareTo(l);if(s!==0)return s}return i.hasNext()?1:r.hasNext()?-1:0};Bi.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()};Bi.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===Bi.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===Bi.SORTINDEX_MULTIPOINT||this.getSortIndex()===Bi.SORTINDEX_MULTILINESTRING||this.getSortIndex()===Bi.SORTINDEX_MULTIPOLYGON};Bi.prototype.interfaces_=function(){return[mI,Kc,Jc]};Bi.prototype.getClass=function(){return Bi};Bi.hasNonEmptyElements=function(e){for(var t=0;t<e.length;t++)if(!e[t].isEmpty())return!0;return!1};Bi.hasNullElements=function(e){for(var t=0;t<e.length;t++)if(e[t]===null)return!0;return!1};Sd.serialVersionUID.get=function(){return 8763622679187377e3};Sd.SORTINDEX_POINT.get=function(){return 0};Sd.SORTINDEX_MULTIPOINT.get=function(){return 1};Sd.SORTINDEX_LINESTRING.get=function(){return 2};Sd.SORTINDEX_LINEARRING.get=function(){return 3};Sd.SORTINDEX_MULTILINESTRING.get=function(){return 4};Sd.SORTINDEX_POLYGON.get=function(){return 5};Sd.SORTINDEX_MULTIPOLYGON.get=function(){return 6};Sd.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7};Sd.geometryChangedFilter.get=function(){return zS};Object.defineProperties(Bi,Sd);var zS=function(){};zS.interfaces_=function(){return[mp]};zS.filter=function(e){e.geometryChangedAction()};var _d=function(){};_d.prototype.filter=function(e){};_d.prototype.interfaces_=function(){return[]};_d.prototype.getClass=function(){return _d};var qc=function(){},xp={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};qc.prototype.isInBoundary=function(e){};qc.prototype.interfaces_=function(){return[]};qc.prototype.getClass=function(){return qc};xp.Mod2BoundaryNodeRule.get=function(){return Bv};xp.EndPointBoundaryNodeRule.get=function(){return zv};xp.MultiValentEndPointBoundaryNodeRule.get=function(){return Uv};xp.MonoValentEndPointBoundaryNodeRule.get=function(){return Vv};xp.MOD2_BOUNDARY_RULE.get=function(){return new Bv};xp.ENDPOINT_BOUNDARY_RULE.get=function(){return new zv};xp.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Uv};xp.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Vv};xp.OGC_SFS_BOUNDARY_RULE.get=function(){return qc.MOD2_BOUNDARY_RULE};Object.defineProperties(qc,xp);var Bv=function(){};Bv.prototype.isInBoundary=function(e){return e%2===1};Bv.prototype.interfaces_=function(){return[qc]};Bv.prototype.getClass=function(){return Bv};var zv=function(){};zv.prototype.isInBoundary=function(e){return e>0};zv.prototype.interfaces_=function(){return[qc]};zv.prototype.getClass=function(){return zv};var Uv=function(){};Uv.prototype.isInBoundary=function(e){return e>1};Uv.prototype.interfaces_=function(){return[qc]};Uv.prototype.getClass=function(){return Uv};var Vv=function(){};Vv.prototype.isInBoundary=function(e){return e===1};Vv.prototype.interfaces_=function(){return[qc]};Vv.prototype.getClass=function(){return Vv};var ta=function(){};ta.prototype.add=function(){};ta.prototype.addAll=function(){};ta.prototype.isEmpty=function(){};ta.prototype.iterator=function(){};ta.prototype.size=function(){};ta.prototype.toArray=function(){};ta.prototype.remove=function(){};function US(n){this.message=n||""}US.prototype=new Error;US.prototype.name="IndexOutOfBoundsException";var l0=function(){};l0.prototype.hasNext=function(){};l0.prototype.next=function(){};l0.prototype.remove=function(){};var Th=function(n){function e(){n.apply(this,arguments)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.get=function(){},e.prototype.set=function(){},e.prototype.isEmpty=function(){},e}(ta);function u0(n){this.message=n||""}u0.prototype=new Error;u0.prototype.name="NoSuchElementException";var Un=function(n){function e(){n.call(this),this.array_=[],arguments[0]instanceof ta&&this.addAll(arguments[0])}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.ensureCapacity=function(){},e.prototype.interfaces_=function(){return[n,ta]},e.prototype.add=function(i){return arguments.length===1?this.array_.push(i):this.array_.splice(arguments[0],arguments[1]),!0},e.prototype.clear=function(){this.array_=[]},e.prototype.addAll=function(i){for(var r=this,a=i.iterator();a.hasNext();)r.add(a.next());return!0},e.prototype.set=function(i,r){var a=this.array_[i];return this.array_[i]=r,a},e.prototype.iterator=function(){return new k5(this)},e.prototype.get=function(i){if(i<0||i>=this.size())throw new US;return this.array_[i]},e.prototype.isEmpty=function(){return this.array_.length===0},e.prototype.size=function(){return this.array_.length},e.prototype.toArray=function(){for(var i=this,r=[],a=0,l=this.array_.length;a<l;a++)r.push(i.array_[a]);return r},e.prototype.remove=function(i){for(var r=this,a=!1,l=0,s=this.array_.length;l<s;l++)if(r.array_[l]===i){r.array_.splice(l,1),a=!0;break}return a},e}(Th),k5=function(n){function e(t){n.call(this),this.arrayList_=t,this.position_=0}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new u0;return this.arrayList_.get(this.position_++)},e.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},e.prototype.set=function(i){return this.arrayList_.set(this.position_-1,i)},e.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},e}(l0),mb=function(n){function e(){if(n.call(this),arguments.length!==0){if(arguments.length===1){var i=arguments[0];this.ensureCapacity(i.length),this.add(i,!0)}else if(arguments.length===2){var r=arguments[0],a=arguments[1];this.ensureCapacity(r.length),this.add(r,a)}}}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={coordArrayType:{configurable:!0}};return t.coordArrayType.get=function(){return new Array(0).fill(null)},e.prototype.getCoordinate=function(r){return this.get(r)},e.prototype.addAll=function(){var r=this;if(arguments.length===2){for(var a=arguments[0],l=arguments[1],s=!1,d=a.iterator();d.hasNext();)r.add(d.next(),l),s=!0;return s}else return n.prototype.addAll.apply(this,arguments)},e.prototype.clone=function(){for(var r=this,a=n.prototype.clone.call(this),l=0;l<this.size();l++)a.add(l,r.get(l).copy());return a},e.prototype.toCoordinateArray=function(){return this.toArray(e.coordArrayType)},e.prototype.add=function(){var r=this;if(arguments.length===1){var a=arguments[0];n.prototype.add.call(this,a)}else if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var l=arguments[0],s=arguments[1];return this.add(l,s,!0),!0}else if(arguments[0]instanceof mt&&typeof arguments[1]=="boolean"){var d=arguments[0],g=arguments[1];if(!g&&this.size()>=1){var x=this.get(this.size()-1);if(x.equals2D(d))return null}n.prototype.add.call(this,d)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var I=arguments[0],A=arguments[1];return this.add(I,A),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var L=arguments[0],N=arguments[1],B=arguments[2];if(B)for(var F=0;F<L.length;F++)r.add(L[F],N);else for(var z=L.length-1;z>=0;z--)r.add(L[z],N);return!0}else if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof mt){var V=arguments[0],Y=arguments[1],Q=arguments[2];if(!Q){var J=this.size();if(J>0){if(V>0){var he=this.get(V-1);if(he.equals2D(Y))return null}if(V<J){var ee=this.get(V);if(ee.equals2D(Y))return null}}}n.prototype.add.call(this,V,Y)}}else if(arguments.length===4){var ae=arguments[0],De=arguments[1],fe=arguments[2],le=arguments[3],Be=1;fe>le&&(Be=-1);for(var Pe=fe;Pe!==le;Pe+=Be)r.add(ae[Pe],De);return!0}},e.prototype.closeRing=function(){this.size()>0&&this.add(new mt(this.get(0)),!1)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},Object.defineProperties(e,t),e}(Un),Rr=function(){},_I={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};_I.ForwardComparator.get=function(){return j1};_I.BidirectionalComparator.get=function(){return Gv};_I.coordArrayType.get=function(){return new Array(0).fill(null)};Rr.prototype.interfaces_=function(){return[]};Rr.prototype.getClass=function(){return Rr};Rr.isRing=function(e){return!(e.length<4||!e[0].equals2D(e[e.length-1]))};Rr.ptNotInList=function(e,t){for(var i=0;i<e.length;i++){var r=e[i];if(Rr.indexOf(r,t)<0)return r}return null};Rr.scroll=function(e,t){var i=Rr.indexOf(t,e);if(i<0)return null;var r=new Array(e.length).fill(null);Wa.arraycopy(e,i,r,0,e.length-i),Wa.arraycopy(e,0,r,e.length-i,i),Wa.arraycopy(r,0,e,0,e.length)};Rr.equals=function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];if(e===t)return!0;if(e===null||t===null||e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(!e[i].equals(t[i]))return!1;return!0}else if(arguments.length===3){var r=arguments[0],a=arguments[1],l=arguments[2];if(r===a)return!0;if(r===null||a===null||r.length!==a.length)return!1;for(var s=0;s<r.length;s++)if(l.compare(r[s],a[s])!==0)return!1;return!0}};Rr.intersection=function(e,t){for(var i=new mb,r=0;r<e.length;r++)t.intersects(e[r])&&i.add(e[r],!0);return i.toCoordinateArray()};Rr.hasRepeatedPoints=function(e){for(var t=1;t<e.length;t++)if(e[t-1].equals(e[t]))return!0;return!1};Rr.removeRepeatedPoints=function(e){if(!Rr.hasRepeatedPoints(e))return e;var t=new mb(e,!1);return t.toCoordinateArray()};Rr.reverse=function(e){for(var t=e.length-1,i=Math.trunc(t/2),r=0;r<=i;r++){var a=e[r];e[r]=e[t-r],e[t-r]=a}};Rr.removeNull=function(e){for(var t=0,i=0;i<e.length;i++)e[i]!==null&&t++;var r=new Array(t).fill(null);if(t===0)return r;for(var a=0,l=0;l<e.length;l++)e[l]!==null&&(r[a++]=e[l]);return r};Rr.copyDeep=function(){if(arguments.length===1){for(var e=arguments[0],t=new Array(e.length).fill(null),i=0;i<e.length;i++)t[i]=new mt(e[i]);return t}else if(arguments.length===5)for(var r=arguments[0],a=arguments[1],l=arguments[2],s=arguments[3],d=arguments[4],g=0;g<d;g++)l[s+g]=new mt(r[a+g])};Rr.isEqualReversed=function(e,t){for(var i=0;i<e.length;i++){var r=e[i],a=t[e.length-i-1];if(r.compareTo(a)!==0)return!1}return!0};Rr.envelope=function(e){for(var t=new Ii,i=0;i<e.length;i++)t.expandToInclude(e[i]);return t};Rr.toCoordinateArray=function(e){return e.toArray(Rr.coordArrayType)};Rr.atLeastNCoordinatesOrNothing=function(e,t){return t.length>=e?t:[]};Rr.indexOf=function(e,t){for(var i=0;i<t.length;i++)if(e.equals(t[i]))return i;return-1};Rr.increasingDirection=function(e){for(var t=0;t<Math.trunc(e.length/2);t++){var i=e.length-1-t,r=e[t].compareTo(e[i]);if(r!==0)return r}return 1};Rr.compare=function(e,t){for(var i=0;i<e.length&&i<t.length;){var r=e[i].compareTo(t[i]);if(r!==0)return r;i++}return i<t.length?-1:i<e.length?1:0};Rr.minCoordinate=function(e){for(var t=null,i=0;i<e.length;i++)(t===null||t.compareTo(e[i])>0)&&(t=e[i]);return t};Rr.extract=function(e,t,i){t=sc.clamp(t,0,e.length),i=sc.clamp(i,-1,e.length);var r=i-t+1;i<0&&(r=0),t>=e.length&&(r=0),i<t&&(r=0);var a=new Array(r).fill(null);if(r===0)return a;for(var l=0,s=t;s<=i;s++)a[l++]=e[s];return a};Object.defineProperties(Rr,_I);var j1=function(){};j1.prototype.compare=function(e,t){var i=e,r=t;return Rr.compare(i,r)};j1.prototype.interfaces_=function(){return[kv]};j1.prototype.getClass=function(){return j1};var Gv=function(){};Gv.prototype.compare=function(e,t){var i=e,r=t;if(i.length<r.length)return-1;if(i.length>r.length)return 1;if(i.length===0)return 0;var a=Rr.compare(i,r),l=Rr.isEqualReversed(i,r);return l?0:a};Gv.prototype.OLDcompare=function(e,t){var i=e,r=t;if(i.length<r.length)return-1;if(i.length>r.length)return 1;if(i.length===0)return 0;for(var a=Rr.increasingDirection(i),l=Rr.increasingDirection(r),s=a>0?0:i.length-1,d=l>0?0:i.length-1,g=0;g<i.length;g++){var x=i[s].compareTo(r[d]);if(x!==0)return x;s+=a,d+=l}return 0};Gv.prototype.interfaces_=function(){return[kv]};Gv.prototype.getClass=function(){return Gv};var Z_=function(){};Z_.prototype.get=function(){};Z_.prototype.put=function(){};Z_.prototype.size=function(){};Z_.prototype.values=function(){};Z_.prototype.entrySet=function(){};var F5=function(n){function e(){n.apply(this,arguments)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e}(Z_);function gb(n){this.message=n||""}gb.prototype=new Error;gb.prototype.name="OperationNotSupported";function yI(){}yI.prototype=new ta;yI.prototype.contains=function(){};var VS=function(n){function e(){n.call(this),this.array_=[],arguments[0]instanceof ta&&this.addAll(arguments[0])}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.contains=function(i){for(var r=this,a=0,l=this.array_.length;a<l;a++){var s=r.array_[a];if(s===i)return!0}return!1},e.prototype.add=function(i){return this.contains(i)?!1:(this.array_.push(i),!0)},e.prototype.addAll=function(i){for(var r=this,a=i.iterator();a.hasNext();)r.add(a.next());return!0},e.prototype.remove=function(i){throw new Error},e.prototype.size=function(){return this.array_.length},e.prototype.isEmpty=function(){return this.array_.length===0},e.prototype.toArray=function(){for(var i=this,r=[],a=0,l=this.array_.length;a<l;a++)r.push(i.array_[a]);return r},e.prototype.iterator=function(){return new B5(this)},e}(yI),B5=function(n){function e(t){n.call(this),this.hashSet_=t,this.position_=0}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new u0;return this.hashSet_.array_[this.position_++]},e.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},e.prototype.remove=function(){throw new gb},e}(l0),sp=0,Ym=1;function rA(n){return n===null?sp:n.color}function Ns(n){return n===null?null:n.parent}function np(n,e){n!==null&&(n.color=e)}function Ow(n){return n===null?null:n.left}function sA(n){return n===null?null:n.right}function yl(){this.root_=null,this.size_=0}yl.prototype=new F5;yl.prototype.get=function(n){for(var e=this.root_;e!==null;){var t=n.compareTo(e.key);if(t<0)e=e.left;else if(t>0)e=e.right;else return e.value}return null};yl.prototype.put=function(n,e){if(this.root_===null)return this.root_={key:n,value:e,left:null,right:null,parent:null,color:sp,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var t=this.root_,i,r;do if(i=t,r=n.compareTo(t.key),r<0)t=t.left;else if(r>0)t=t.right;else{var a=t.value;return t.value=e,a}while(t!==null);var l={key:n,left:null,right:null,value:e,parent:i,color:sp,getValue:function(){return this.value},getKey:function(){return this.key}};return r<0?i.left=l:i.right=l,this.fixAfterInsertion(l),this.size_++,null};yl.prototype.fixAfterInsertion=function(n){var e=this;for(n.color=Ym;n!=null&&n!==this.root_&&n.parent.color===Ym;)if(Ns(n)===Ow(Ns(Ns(n)))){var t=sA(Ns(Ns(n)));rA(t)===Ym?(np(Ns(n),sp),np(t,sp),np(Ns(Ns(n)),Ym),n=Ns(Ns(n))):(n===sA(Ns(n))&&(n=Ns(n),e.rotateLeft(n)),np(Ns(n),sp),np(Ns(Ns(n)),Ym),e.rotateRight(Ns(Ns(n))))}else{var i=Ow(Ns(Ns(n)));rA(i)===Ym?(np(Ns(n),sp),np(i,sp),np(Ns(Ns(n)),Ym),n=Ns(Ns(n))):(n===Ow(Ns(n))&&(n=Ns(n),e.rotateRight(n)),np(Ns(n),sp),np(Ns(Ns(n)),Ym),e.rotateLeft(Ns(Ns(n))))}this.root_.color=sp};yl.prototype.values=function(){var n=new Un,e=this.getFirstEntry();if(e!==null)for(n.add(e.value);(e=yl.successor(e))!==null;)n.add(e.value);return n};yl.prototype.entrySet=function(){var n=new VS,e=this.getFirstEntry();if(e!==null)for(n.add(e);(e=yl.successor(e))!==null;)n.add(e);return n};yl.prototype.rotateLeft=function(n){if(n!=null){var e=n.right;n.right=e.left,e.left!=null&&(e.left.parent=n),e.parent=n.parent,n.parent===null?this.root_=e:n.parent.left===n?n.parent.left=e:n.parent.right=e,e.left=n,n.parent=e}};yl.prototype.rotateRight=function(n){if(n!=null){var e=n.left;n.left=e.right,e.right!=null&&(e.right.parent=n),e.parent=n.parent,n.parent===null?this.root_=e:n.parent.right===n?n.parent.right=e:n.parent.left=e,e.right=n,n.parent=e}};yl.prototype.getFirstEntry=function(){var n=this.root_;if(n!=null)for(;n.left!=null;)n=n.left;return n};yl.successor=function(n){if(n===null)return null;if(n.right!==null){for(var e=n.right;e.left!==null;)e=e.left;return e}else{for(var t=n.parent,i=n;t!==null&&i===t.right;)i=t,t=t.parent;return t}};yl.prototype.size=function(){return this.size_};var q1=function(){};q1.prototype.interfaces_=function(){return[]};q1.prototype.getClass=function(){return q1};function lR(){}lR.prototype=new yI;function Sf(){this.array_=[],arguments[0]instanceof ta&&this.addAll(arguments[0])}Sf.prototype=new lR;Sf.prototype.contains=function(n){for(var e=this,t=0,i=this.array_.length;t<i;t++){var r=e.array_[t];if(r.compareTo(n)===0)return!0}return!1};Sf.prototype.add=function(n){var e=this;if(this.contains(n))return!1;for(var t=0,i=this.array_.length;t<i;t++){var r=e.array_[t];if(r.compareTo(n)===1)return e.array_.splice(t,0,n),!0}return this.array_.push(n),!0};Sf.prototype.addAll=function(n){for(var e=this,t=n.iterator();t.hasNext();)e.add(t.next());return!0};Sf.prototype.remove=function(n){throw new gb};Sf.prototype.size=function(){return this.array_.length};Sf.prototype.isEmpty=function(){return this.array_.length===0};Sf.prototype.toArray=function(){for(var n=this,e=[],t=0,i=this.array_.length;t<i;t++)e.push(n.array_[t]);return e};Sf.prototype.iterator=function(){return new vI(this)};var vI=function(n){this.treeSet_=n,this.position_=0};vI.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new u0;return this.treeSet_.array_[this.position_++]};vI.prototype.hasNext=function(){return this.position_<this.treeSet_.size()};vI.prototype.remove=function(){throw new gb};var rg=function(){};rg.sort=function(){var e=arguments[0],t,i,r,a;if(arguments.length===1)a=function(s,d){return s.compareTo(d)},e.sort(a);else if(arguments.length===2)r=arguments[1],a=function(s,d){return r.compare(s,d)},e.sort(a);else if(arguments.length===3){i=e.slice(arguments[1],arguments[2]),i.sort();var l=e.slice(0,arguments[1]).concat(i,e.slice(arguments[2],e.length));for(e.splice(0,e.length),t=0;t<l.length;t++)e.push(l[t])}else if(arguments.length===4)for(i=e.slice(arguments[1],arguments[2]),r=arguments[3],a=function(s,d){return r.compare(s,d)},i.sort(a),l=e.slice(0,arguments[1]).concat(i,e.slice(arguments[2],e.length)),e.splice(0,e.length),t=0;t<l.length;t++)e.push(l[t])};rg.asList=function(e){for(var t=new Un,i=0,r=e.length;i<r;i++)t.add(e[i]);return t};var es=function(){},Nh={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};Nh.P.get=function(){return 0};Nh.L.get=function(){return 1};Nh.A.get=function(){return 2};Nh.FALSE.get=function(){return-1};Nh.TRUE.get=function(){return-2};Nh.DONTCARE.get=function(){return-3};Nh.SYM_FALSE.get=function(){return"F"};Nh.SYM_TRUE.get=function(){return"T"};Nh.SYM_DONTCARE.get=function(){return"*"};Nh.SYM_P.get=function(){return"0"};Nh.SYM_L.get=function(){return"1"};Nh.SYM_A.get=function(){return"2"};es.prototype.interfaces_=function(){return[]};es.prototype.getClass=function(){return es};es.toDimensionSymbol=function(e){switch(e){case es.FALSE:return es.SYM_FALSE;case es.TRUE:return es.SYM_TRUE;case es.DONTCARE:return es.SYM_DONTCARE;case es.P:return es.SYM_P;case es.L:return es.SYM_L;case es.A:return es.SYM_A}throw new io("Unknown dimension value: "+e)};es.toDimensionValue=function(e){switch(H1.toUpperCase(e)){case es.SYM_FALSE:return es.FALSE;case es.SYM_TRUE:return es.TRUE;case es.SYM_DONTCARE:return es.DONTCARE;case es.SYM_P:return es.P;case es.SYM_L:return es.L;case es.SYM_A:return es.A}throw new io("Unknown dimension symbol: "+e)};Object.defineProperties(es,Nh);var Cf=function(){};Cf.prototype.filter=function(e){};Cf.prototype.interfaces_=function(){return[]};Cf.prototype.getClass=function(){return Cf};var Ch=function(){};Ch.prototype.filter=function(e,t){};Ch.prototype.isDone=function(){};Ch.prototype.isGeometryChanged=function(){};Ch.prototype.interfaces_=function(){return[]};Ch.prototype.getClass=function(){return Ch};var Nl=function(n){function e(i,r){if(n.call(this,r),this._geometries=i||[],n.hasNullElements(this._geometries))throw new io("geometries must not contain null elements")}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){for(var r=this,a=new Ii,l=0;l<this._geometries.length;l++)a.expandToInclude(r._geometries[l].getEnvelopeInternal());return a},e.prototype.getGeometryN=function(r){return this._geometries[r]},e.prototype.getSortIndex=function(){return n.SORTINDEX_GEOMETRYCOLLECTION},e.prototype.getCoordinates=function(){for(var r=this,a=new Array(this.getNumPoints()).fill(null),l=-1,s=0;s<this._geometries.length;s++)for(var d=r._geometries[s].getCoordinates(),g=0;g<d.length;g++)l++,a[l]=d[g];return a},e.prototype.getArea=function(){for(var r=this,a=0,l=0;l<this._geometries.length;l++)a+=r._geometries[l].getArea();return a},e.prototype.equalsExact=function(){var r=this;if(arguments.length===2){var a=arguments[0],l=arguments[1];if(!this.isEquivalentClass(a))return!1;var s=a;if(this._geometries.length!==s._geometries.length)return!1;for(var d=0;d<this._geometries.length;d++)if(!r._geometries[d].equalsExact(s._geometries[d],l))return!1;return!0}else return n.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var r=this,a=0;a<this._geometries.length;a++)r._geometries[a].normalize();rg.sort(this._geometries)},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},e.prototype.getBoundaryDimension=function(){for(var r=this,a=es.FALSE,l=0;l<this._geometries.length;l++)a=Math.max(a,r._geometries[l].getBoundaryDimension());return a},e.prototype.getDimension=function(){for(var r=this,a=es.FALSE,l=0;l<this._geometries.length;l++)a=Math.max(a,r._geometries[l].getDimension());return a},e.prototype.getLength=function(){for(var r=this,a=0,l=0;l<this._geometries.length;l++)a+=r._geometries[l].getLength();return a},e.prototype.getNumPoints=function(){for(var r=this,a=0,l=0;l<this._geometries.length;l++)a+=r._geometries[l].getNumPoints();return a},e.prototype.getNumGeometries=function(){return this._geometries.length},e.prototype.reverse=function(){for(var r=this,a=this._geometries.length,l=new Array(a).fill(null),s=0;s<this._geometries.length;s++)l[s]=r._geometries[s].reverse();return this.getFactory().createGeometryCollection(l)},e.prototype.compareToSameClass=function(){var r=this;if(arguments.length===1){var a=arguments[0],l=new Sf(rg.asList(this._geometries)),s=new Sf(rg.asList(a._geometries));return this.compare(l,s)}else if(arguments.length===2){for(var d=arguments[0],g=arguments[1],x=d,I=this.getNumGeometries(),A=x.getNumGeometries(),L=0;L<I&&L<A;){var N=r.getGeometryN(L),B=x.getGeometryN(L),F=N.compareToSameClass(B,g);if(F!==0)return F;L++}return L<I?1:L<A?-1:0}},e.prototype.apply=function(){var r=this;if(Hi(arguments[0],_d))for(var a=arguments[0],l=0;l<this._geometries.length;l++)r._geometries[l].apply(a);else if(Hi(arguments[0],Ch)){var s=arguments[0];if(this._geometries.length===0)return null;for(var d=0;d<this._geometries.length&&(r._geometries[d].apply(s),!s.isDone());d++);s.isGeometryChanged()&&this.geometryChanged()}else if(Hi(arguments[0],Cf)){var g=arguments[0];g.filter(this);for(var x=0;x<this._geometries.length;x++)r._geometries[x].apply(g)}else if(Hi(arguments[0],mp)){var I=arguments[0];I.filter(this);for(var A=0;A<this._geometries.length;A++)r._geometries[A].apply(I)}},e.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),dr.shouldNeverReachHere(),null},e.prototype.clone=function(){var r=this,a=n.prototype.clone.call(this);a._geometries=new Array(this._geometries.length).fill(null);for(var l=0;l<this._geometries.length;l++)a._geometries[l]=r._geometries[l].clone();return a},e.prototype.getGeometryType=function(){return"GeometryCollection"},e.prototype.copy=function(){for(var r=this,a=new Array(this._geometries.length).fill(null),l=0;l<a.length;l++)a[l]=r._geometries[l].copy();return new e(a,this._factory)},e.prototype.isEmpty=function(){for(var r=this,a=0;a<this._geometries.length;a++)if(!r._geometries[a].isEmpty())return!1;return!0},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},t.serialVersionUID.get=function(){return-5694727726395021e3},Object.defineProperties(e,t),e}(Bi),hg=function(n){function e(){n.apply(this,arguments)}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return Bi.SORTINDEX_MULTILINESTRING},e.prototype.equalsExact=function(){if(arguments.length===2){var r=arguments[0],a=arguments[1];return this.isEquivalentClass(r)?n.prototype.equalsExact.call(this,r,a):!1}else return n.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?es.FALSE:0},e.prototype.isClosed=function(){var r=this;if(this.isEmpty())return!1;for(var a=0;a<this._geometries.length;a++)if(!r._geometries[a].isClosed())return!1;return!0},e.prototype.getDimension=function(){return 1},e.prototype.reverse=function(){for(var r=this,a=this._geometries.length,l=new Array(a).fill(null),s=0;s<this._geometries.length;s++)l[a-1-s]=r._geometries[s].reverse();return this.getFactory().createMultiLineString(l)},e.prototype.getBoundary=function(){return new Vc(this).getBoundary()},e.prototype.getGeometryType=function(){return"MultiLineString"},e.prototype.copy=function(){for(var r=this,a=new Array(this._geometries.length).fill(null),l=0;l<a.length;l++)a[l]=r._geometries[l].copy();return new e(a,this._factory)},e.prototype.interfaces_=function(){return[q1]},e.prototype.getClass=function(){return e},t.serialVersionUID.get=function(){return 8166665132445434e3},Object.defineProperties(e,t),e}(Nl),Vc=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,arguments.length===1){var e=arguments[0],t=qc.MOD2_BOUNDARY_RULE;this._geom=e,this._geomFact=e.getFactory(),this._bnRule=t}else if(arguments.length===2){var i=arguments[0],r=arguments[1];this._geom=i,this._geomFact=i.getFactory(),this._bnRule=r}};Vc.prototype.boundaryMultiLineString=function(e){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var t=this.computeBoundaryCoordinates(e);return t.length===1?this._geomFact.createPoint(t[0]):this._geomFact.createMultiPointFromCoords(t)};Vc.prototype.getBoundary=function(){return this._geom instanceof Io?this.boundaryLineString(this._geom):this._geom instanceof hg?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()};Vc.prototype.boundaryLineString=function(e){if(this._geom.isEmpty())return this.getEmptyMultiPoint();if(e.isClosed()){var t=this._bnRule.isInBoundary(2);return t?e.getStartPoint():this._geomFact.createMultiPoint()}return this._geomFact.createMultiPoint([e.getStartPoint(),e.getEndPoint()])};Vc.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()};Vc.prototype.computeBoundaryCoordinates=function(e){var t=this,i=new Un;this._endpointMap=new yl;for(var r=0;r<e.getNumGeometries();r++){var a=e.getGeometryN(r);a.getNumPoints()!==0&&(t.addEndpoint(a.getCoordinateN(0)),t.addEndpoint(a.getCoordinateN(a.getNumPoints()-1)))}for(var l=this._endpointMap.entrySet().iterator();l.hasNext();){var s=l.next(),d=s.getValue(),g=d.count;t._bnRule.isInBoundary(g)&&i.add(s.getKey())}return Rr.toCoordinateArray(i)};Vc.prototype.addEndpoint=function(e){var t=this._endpointMap.get(e);t===null&&(t=new qE,this._endpointMap.put(e,t)),t.count++};Vc.prototype.interfaces_=function(){return[]};Vc.prototype.getClass=function(){return Vc};Vc.getBoundary=function(){if(arguments.length===1){var e=arguments[0],t=new Vc(e);return t.getBoundary()}else if(arguments.length===2){var i=arguments[0],r=arguments[1],a=new Vc(i,r);return a.getBoundary()}};var qE=function(){this.count=null};qE.prototype.interfaces_=function(){return[]};qE.prototype.getClass=function(){return qE};function z5(){}function U5(){}var V5=function(){};function G5(){}function H5(){}function j5(){}var Gc=function(){},GS={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Gc.prototype.interfaces_=function(){return[]};Gc.prototype.getClass=function(){return Gc};Gc.chars=function(e,t){for(var i=new Array(t).fill(null),r=0;r<t;r++)i[r]=e;return String(i)};Gc.getStackTrace=function(){if(arguments.length===1){var e=arguments[0],t=new G5,i=new z5;return e.printStackTrace(i),t.toString()}else if(arguments.length===2){var r=arguments[0],a=arguments[1],l="";new U5(Gc.getStackTrace(r));for(var s=new j5,d=0;d<a;d++)try{l+=s.readLine()+Gc.NEWLINE}catch(g){if(g instanceof H5)dr.shouldNeverReachHere();else throw g}finally{}return l}};Gc.split=function(e,t){for(var i=t.length,r=new Un,a=""+e,l=a.indexOf(t);l>=0;){var s=a.substring(0,l);r.add(s),a=a.substring(l+i),l=a.indexOf(t)}a.length>0&&r.add(a);for(var d=new Array(r.size()).fill(null),g=0;g<d.length;g++)d[g]=r.get(g);return d};Gc.toString=function(){if(arguments.length===1){var e=arguments[0];return Gc.SIMPLE_ORDINATE_FORMAT.format(e)}};Gc.spaces=function(e){return Gc.chars(" ",e)};GS.NEWLINE.get=function(){return Wa.getProperty("line.separator")};GS.SIMPLE_ORDINATE_FORMAT.get=function(){return new V5};Object.defineProperties(Gc,GS);var Do=function(){};Do.prototype.interfaces_=function(){return[]};Do.prototype.getClass=function(){return Do};Do.copyCoord=function(e,t,i,r){for(var a=Math.min(e.getDimension(),i.getDimension()),l=0;l<a;l++)i.setOrdinate(r,l,e.getOrdinate(t,l))};Do.isRing=function(e){var t=e.size();return t===0?!0:t<=3?!1:e.getOrdinate(0,qr.X)===e.getOrdinate(t-1,qr.X)&&e.getOrdinate(0,qr.Y)===e.getOrdinate(t-1,qr.Y)};Do.isEqual=function(e,t){var i=e.size(),r=t.size();if(i!==r)return!1;for(var a=Math.min(e.getDimension(),t.getDimension()),l=0;l<i;l++)for(var s=0;s<a;s++){var d=e.getOrdinate(l,s),g=t.getOrdinate(l,s);if(e.getOrdinate(l,s)!==t.getOrdinate(l,s)&&!(rr.isNaN(d)&&rr.isNaN(g)))return!1}return!0};Do.extend=function(e,t,i){var r=e.create(i,t.getDimension()),a=t.size();if(Do.copy(t,0,r,0,a),a>0)for(var l=a;l<i;l++)Do.copy(t,a-1,r,l,1);return r};Do.reverse=function(e){for(var t=e.size()-1,i=Math.trunc(t/2),r=0;r<=i;r++)Do.swap(e,r,t-r)};Do.swap=function(e,t,i){if(t===i)return null;for(var r=0;r<e.getDimension();r++){var a=e.getOrdinate(t,r);e.setOrdinate(t,r,e.getOrdinate(i,r)),e.setOrdinate(i,r,a)}};Do.copy=function(e,t,i,r,a){for(var l=0;l<a;l++)Do.copyCoord(e,t+l,i,r+l)};Do.toString=function(){if(arguments.length===1){var e=arguments[0],t=e.size();if(t===0)return"()";var i=e.getDimension(),r=new Nf;r.append("(");for(var a=0;a<t;a++){a>0&&r.append(" ");for(var l=0;l<i;l++)l>0&&r.append(","),r.append(Gc.toString(e.getOrdinate(a,l)))}return r.append(")"),r.toString()}};Do.ensureValidRing=function(e,t){var i=t.size();if(i===0)return t;if(i<=3)return Do.createClosedRing(e,t,4);var r=t.getOrdinate(0,qr.X)===t.getOrdinate(i-1,qr.X)&&t.getOrdinate(0,qr.Y)===t.getOrdinate(i-1,qr.Y);return r?t:Do.createClosedRing(e,t,i+1)};Do.createClosedRing=function(e,t,i){var r=e.create(i,t.getDimension()),a=t.size();Do.copy(t,0,r,0,a);for(var l=a;l<i;l++)Do.copy(t,0,r,l,1);return r};var Io=function(n){function e(i,r){n.call(this,r),this._points=null,this.init(i)}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new Ii:this._points.expandEnvelope(new Ii)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return n.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){var r=this;if(arguments.length===2){var a=arguments[0],l=arguments[1];if(!this.isEquivalentClass(a))return!1;var s=a;if(this._points.size()!==s._points.size())return!1;for(var d=0;d<this._points.size();d++)if(!r.equal(r._points.getCoordinate(d),s._points.getCoordinate(d),l))return!1;return!0}else return n.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var r=this,a=0;a<Math.trunc(this._points.size()/2);a++){var l=r._points.size()-1-a;if(!r._points.getCoordinate(a).equals(r._points.getCoordinate(l)))return r._points.getCoordinate(a).compareTo(r._points.getCoordinate(l))>0&&Do.reverse(r._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?es.FALSE:0},e.prototype.isClosed=function(){return this.isEmpty()?!1:this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return Jn.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var r=this._points.copy();Do.reverse(r);var a=this.getFactory().createLineString(r);return a},e.prototype.compareToSameClass=function(){var r=this;if(arguments.length===1){for(var a=arguments[0],l=a,s=0,d=0;s<this._points.size()&&d<l._points.size();){var g=r._points.getCoordinate(s).compareTo(l._points.getCoordinate(d));if(g!==0)return g;s++,d++}return s<this._points.size()?1:d<l._points.size()?-1:0}else if(arguments.length===2){var x=arguments[0],I=arguments[1],A=x;return I.compare(this._points,A._points)}},e.prototype.apply=function(){var r=this;if(Hi(arguments[0],_d))for(var a=arguments[0],l=0;l<this._points.size();l++)a.filter(r._points.getCoordinate(l));else if(Hi(arguments[0],Ch)){var s=arguments[0];if(this._points.size()===0)return null;for(var d=0;d<this._points.size()&&(s.filter(r._points,d),!s.isDone());d++);s.isGeometryChanged()&&this.geometryChanged()}else if(Hi(arguments[0],Cf)){var g=arguments[0];g.filter(this)}else if(Hi(arguments[0],mp)){var x=arguments[0];x.filter(this)}},e.prototype.getBoundary=function(){return new Vc(this).getBoundary()},e.prototype.isEquivalentClass=function(r){return r instanceof e},e.prototype.clone=function(){var r=n.prototype.clone.call(this);return r._points=this._points.clone(),r},e.prototype.getCoordinateN=function(r){return this._points.getCoordinate(r)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return this._points.size()===0},e.prototype.init=function(r){if(r===null&&(r=this.getFactory().getCoordinateSequenceFactory().create([])),r.size()===1)throw new io("Invalid number of points in LineString (found "+r.size()+" - must be 0 or >= 2)");this._points=r},e.prototype.isCoordinate=function(r){for(var a=this,l=0;l<this._points.size();l++)if(a._points.getCoordinate(l).equals(r))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(r){return this.getFactory().createPoint(this._points.getCoordinate(r))},e.prototype.interfaces_=function(){return[q1]},e.prototype.getClass=function(){return e},t.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,t),e}(Bi),W1=function(){};W1.prototype.interfaces_=function(){return[]};W1.prototype.getClass=function(){return W1};var Au=function(n){function e(i,r){n.call(this,r),this._coordinates=i||null,this.init(this._coordinates)}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new Ii;var r=new Ii;return r.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),r},e.prototype.getSortIndex=function(){return n.SORTINDEX_POINT},e.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},e.prototype.equalsExact=function(){if(arguments.length===2){var r=arguments[0],a=arguments[1];return this.isEquivalentClass(r)?this.isEmpty()&&r.isEmpty()?!0:this.isEmpty()!==r.isEmpty()?!1:this.equal(r.getCoordinate(),this.getCoordinate(),a):!1}else return n.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){},e.prototype.getCoordinate=function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null},e.prototype.getBoundaryDimension=function(){return es.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getNumPoints=function(){return this.isEmpty()?0:1},e.prototype.reverse=function(){return this.copy()},e.prototype.getX=function(){if(this.getCoordinate()===null)throw new Error("getX called on empty Point");return this.getCoordinate().x},e.prototype.compareToSameClass=function(){if(arguments.length===1){var r=arguments[0],a=r;return this.getCoordinate().compareTo(a.getCoordinate())}else if(arguments.length===2){var l=arguments[0],s=arguments[1],d=l;return s.compare(this._coordinates,d._coordinates)}},e.prototype.apply=function(){if(Hi(arguments[0],_d)){var r=arguments[0];if(this.isEmpty())return null;r.filter(this.getCoordinate())}else if(Hi(arguments[0],Ch)){var a=arguments[0];if(this.isEmpty())return null;a.filter(this._coordinates,0),a.isGeometryChanged()&&this.geometryChanged()}else if(Hi(arguments[0],Cf)){var l=arguments[0];l.filter(this)}else if(Hi(arguments[0],mp)){var s=arguments[0];s.filter(this)}},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.clone=function(){var r=n.prototype.clone.call(this);return r._coordinates=this._coordinates.clone(),r},e.prototype.getGeometryType=function(){return"Point"},e.prototype.copy=function(){return new e(this._coordinates.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._coordinates},e.prototype.getY=function(){if(this.getCoordinate()===null)throw new Error("getY called on empty Point");return this.getCoordinate().y},e.prototype.isEmpty=function(){return this._coordinates.size()===0},e.prototype.init=function(r){r===null&&(r=this.getFactory().getCoordinateSequenceFactory().create([])),dr.isTrue(r.size()<=1),this._coordinates=r},e.prototype.isSimple=function(){return!0},e.prototype.interfaces_=function(){return[W1]},e.prototype.getClass=function(){return e},t.serialVersionUID.get=function(){return 4902022702746615e3},Object.defineProperties(e,t),e}(Bi),cm=function(){};cm.prototype.interfaces_=function(){return[]};cm.prototype.getClass=function(){return cm};var oa=function(n){function e(i,r,a){if(n.call(this,a),this._shell=null,this._holes=null,i===null&&(i=this.getFactory().createLinearRing()),r===null&&(r=[]),n.hasNullElements(r))throw new io("holes must not contain null elements");if(i.isEmpty()&&n.hasNonEmptyElements(r))throw new io("shell is empty but holes are not");this._shell=i,this._holes=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},e.prototype.getSortIndex=function(){return n.SORTINDEX_POLYGON},e.prototype.getCoordinates=function(){var r=this;if(this.isEmpty())return[];for(var a=new Array(this.getNumPoints()).fill(null),l=-1,s=this._shell.getCoordinates(),d=0;d<s.length;d++)l++,a[l]=s[d];for(var g=0;g<this._holes.length;g++)for(var x=r._holes[g].getCoordinates(),I=0;I<x.length;I++)l++,a[l]=x[I];return a},e.prototype.getArea=function(){var r=this,a=0;a+=Math.abs(Jn.signedArea(this._shell.getCoordinateSequence()));for(var l=0;l<this._holes.length;l++)a-=Math.abs(Jn.signedArea(r._holes[l].getCoordinateSequence()));return a},e.prototype.isRectangle=function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var r=this._shell.getCoordinateSequence(),a=this.getEnvelopeInternal(),l=0;l<5;l++){var s=r.getX(l);if(!(s===a.getMinX()||s===a.getMaxX()))return!1;var d=r.getY(l);if(!(d===a.getMinY()||d===a.getMaxY()))return!1}for(var g=r.getX(0),x=r.getY(0),I=1;I<=4;I++){var A=r.getX(I),L=r.getY(I),N=A!==g,B=L!==x;if(N===B)return!1;g=A,x=L}return!0},e.prototype.equalsExact=function(){var r=this;if(arguments.length===2){var a=arguments[0],l=arguments[1];if(!this.isEquivalentClass(a))return!1;var s=a,d=this._shell,g=s._shell;if(!d.equalsExact(g,l)||this._holes.length!==s._holes.length)return!1;for(var x=0;x<this._holes.length;x++)if(!r._holes[x].equalsExact(s._holes[x],l))return!1;return!0}else return n.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){var r=this;if(arguments.length===0){this.normalize(this._shell,!0);for(var a=0;a<this._holes.length;a++)r.normalize(r._holes[a],!1);rg.sort(this._holes)}else if(arguments.length===2){var l=arguments[0],s=arguments[1];if(l.isEmpty())return null;var d=new Array(l.getCoordinates().length-1).fill(null);Wa.arraycopy(l.getCoordinates(),0,d,0,d.length);var g=Rr.minCoordinate(l.getCoordinates());Rr.scroll(d,g),Wa.arraycopy(d,0,l.getCoordinates(),0,d.length),l.getCoordinates()[d.length]=d[0],Jn.isCCW(l.getCoordinates())===s&&Rr.reverse(l.getCoordinates())}},e.prototype.getCoordinate=function(){return this._shell.getCoordinate()},e.prototype.getNumInteriorRing=function(){return this._holes.length},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.getLength=function(){var r=this,a=0;a+=this._shell.getLength();for(var l=0;l<this._holes.length;l++)a+=r._holes[l].getLength();return a},e.prototype.getNumPoints=function(){for(var r=this,a=this._shell.getNumPoints(),l=0;l<this._holes.length;l++)a+=r._holes[l].getNumPoints();return a},e.prototype.reverse=function(){var r=this,a=this.copy();a._shell=this._shell.copy().reverse(),a._holes=new Array(this._holes.length).fill(null);for(var l=0;l<this._holes.length;l++)a._holes[l]=r._holes[l].copy().reverse();return a},e.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},e.prototype.compareToSameClass=function(){var r=this;if(arguments.length===1){var a=arguments[0],l=this._shell,s=a._shell;return l.compareToSameClass(s)}else if(arguments.length===2){var d=arguments[0],g=arguments[1],x=d,I=this._shell,A=x._shell,L=I.compareToSameClass(A,g);if(L!==0)return L;for(var N=this.getNumInteriorRing(),B=x.getNumInteriorRing(),F=0;F<N&&F<B;){var z=r.getInteriorRingN(F),V=x.getInteriorRingN(F),Y=z.compareToSameClass(V,g);if(Y!==0)return Y;F++}return F<N?1:F<B?-1:0}},e.prototype.apply=function(r){var a=this;if(Hi(r,_d)){this._shell.apply(r);for(var l=0;l<this._holes.length;l++)a._holes[l].apply(r)}else if(Hi(r,Ch)){if(this._shell.apply(r),!r.isDone())for(var s=0;s<this._holes.length&&(a._holes[s].apply(r),!r.isDone());s++);r.isGeometryChanged()&&this.geometryChanged()}else if(Hi(r,Cf))r.filter(this);else if(Hi(r,mp)){r.filter(this),this._shell.apply(r);for(var d=0;d<this._holes.length;d++)a._holes[d].apply(r)}},e.prototype.getBoundary=function(){var r=this;if(this.isEmpty())return this.getFactory().createMultiLineString();var a=new Array(this._holes.length+1).fill(null);a[0]=this._shell;for(var l=0;l<this._holes.length;l++)a[l+1]=r._holes[l];return a.length<=1?this.getFactory().createLinearRing(a[0].getCoordinateSequence()):this.getFactory().createMultiLineString(a)},e.prototype.clone=function(){var r=this,a=n.prototype.clone.call(this);a._shell=this._shell.clone(),a._holes=new Array(this._holes.length).fill(null);for(var l=0;l<this._holes.length;l++)a._holes[l]=r._holes[l].clone();return a},e.prototype.getGeometryType=function(){return"Polygon"},e.prototype.copy=function(){for(var r=this,a=this._shell.copy(),l=new Array(this._holes.length).fill(null),s=0;s<l.length;s++)l[s]=r._holes[s].copy();return new e(a,l,this._factory)},e.prototype.getExteriorRing=function(){return this._shell},e.prototype.isEmpty=function(){return this._shell.isEmpty()},e.prototype.getInteriorRingN=function(r){return this._holes[r]},e.prototype.interfaces_=function(){return[cm]},e.prototype.getClass=function(){return e},t.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(e,t),e}(Bi),Hv=function(n){function e(){n.apply(this,arguments)}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return Bi.SORTINDEX_MULTIPOINT},e.prototype.isValid=function(){return!0},e.prototype.equalsExact=function(){if(arguments.length===2){var r=arguments[0],a=arguments[1];return this.isEquivalentClass(r)?n.prototype.equalsExact.call(this,r,a):!1}else return n.prototype.equalsExact.apply(this,arguments)},e.prototype.getCoordinate=function(){if(arguments.length===1){var r=arguments[0];return this._geometries[r].getCoordinate()}else return n.prototype.getCoordinate.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return es.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.getGeometryType=function(){return"MultiPoint"},e.prototype.copy=function(){for(var r=this,a=new Array(this._geometries.length).fill(null),l=0;l<a.length;l++)a[l]=r._geometries[l].copy();return new e(a,this._factory)},e.prototype.interfaces_=function(){return[W1]},e.prototype.getClass=function(){return e},t.serialVersionUID.get=function(){return-8048474874175356e3},Object.defineProperties(e,t),e}(Nl),yd=function(n){function e(i,r){i instanceof mt&&r instanceof Lr&&(i=r.getCoordinateSequenceFactory().create(i)),n.call(this,i,r),this.validateConstruction()}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return Bi.SORTINDEX_LINEARRING},e.prototype.getBoundaryDimension=function(){return es.FALSE},e.prototype.isClosed=function(){return this.isEmpty()?!0:n.prototype.isClosed.call(this)},e.prototype.reverse=function(){var r=this._points.copy();Do.reverse(r);var a=this.getFactory().createLinearRing(r);return a},e.prototype.validateConstruction=function(){if(!this.isEmpty()&&!n.prototype.isClosed.call(this))throw new io("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new io("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},e.prototype.getGeometryType=function(){return"LinearRing"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},t.MINIMUM_VALID_SIZE.get=function(){return 4},t.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(e,t),e}(Io),pd=function(n){function e(){n.apply(this,arguments)}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return Bi.SORTINDEX_MULTIPOLYGON},e.prototype.equalsExact=function(){if(arguments.length===2){var r=arguments[0],a=arguments[1];return this.isEquivalentClass(r)?n.prototype.equalsExact.call(this,r,a):!1}else return n.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.reverse=function(){for(var r=this,a=this._geometries.length,l=new Array(a).fill(null),s=0;s<this._geometries.length;s++)l[s]=r._geometries[s].reverse();return this.getFactory().createMultiPolygon(l)},e.prototype.getBoundary=function(){var r=this;if(this.isEmpty())return this.getFactory().createMultiLineString();for(var a=new Un,l=0;l<this._geometries.length;l++)for(var s=r._geometries[l],d=s.getBoundary(),g=0;g<d.getNumGeometries();g++)a.add(d.getGeometryN(g));var x=new Array(a.size()).fill(null);return this.getFactory().createMultiLineString(a.toArray(x))},e.prototype.getGeometryType=function(){return"MultiPolygon"},e.prototype.copy=function(){for(var r=this,a=new Array(this._geometries.length).fill(null),l=0;l<a.length;l++)a[l]=r._geometries[l].copy();return new e(a,this._factory)},e.prototype.interfaces_=function(){return[cm]},e.prototype.getClass=function(){return e},t.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(e,t),e}(Nl),Wc=function(e){this._factory=e||null,this._isUserDataCopied=!1},bI={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};Wc.prototype.setCopyUserData=function(e){this._isUserDataCopied=e};Wc.prototype.edit=function(e,t){if(e===null)return null;var i=this.editInternal(e,t);return this._isUserDataCopied&&i.setUserData(e.getUserData()),i};Wc.prototype.editInternal=function(e,t){return this._factory===null&&(this._factory=e.getFactory()),e instanceof Nl?this.editGeometryCollection(e,t):e instanceof oa?this.editPolygon(e,t):e instanceof Au?t.edit(e,this._factory):e instanceof Io?t.edit(e,this._factory):(dr.shouldNeverReachHere("Unsupported Geometry class: "+e.getClass().getName()),null)};Wc.prototype.editGeometryCollection=function(e,t){for(var i=this,r=t.edit(e,this._factory),a=new Un,l=0;l<r.getNumGeometries();l++){var s=i.edit(r.getGeometryN(l),t);s===null||s.isEmpty()||a.add(s)}return r.getClass()===Hv?this._factory.createMultiPoint(a.toArray([])):r.getClass()===hg?this._factory.createMultiLineString(a.toArray([])):r.getClass()===pd?this._factory.createMultiPolygon(a.toArray([])):this._factory.createGeometryCollection(a.toArray([]))};Wc.prototype.editPolygon=function(e,t){var i=this,r=t.edit(e,this._factory);if(r===null&&(r=this._factory.createPolygon(null)),r.isEmpty())return r;var a=this.edit(r.getExteriorRing(),t);if(a===null||a.isEmpty())return this._factory.createPolygon();for(var l=new Un,s=0;s<r.getNumInteriorRing();s++){var d=i.edit(r.getInteriorRingN(s),t);d===null||d.isEmpty()||l.add(d)}return this._factory.createPolygon(a,l.toArray([]))};Wc.prototype.interfaces_=function(){return[]};Wc.prototype.getClass=function(){return Wc};Wc.GeometryEditorOperation=function(){};bI.NoOpGeometryOperation.get=function(){return X1};bI.CoordinateOperation.get=function(){return Z1};bI.CoordinateSequenceOperation.get=function(){return Y1};Object.defineProperties(Wc,bI);var X1=function(){};X1.prototype.edit=function(e,t){return e};X1.prototype.interfaces_=function(){return[Wc.GeometryEditorOperation]};X1.prototype.getClass=function(){return X1};var Z1=function(){};Z1.prototype.edit=function(e,t){var i=this.editCoordinates(e.getCoordinates(),e);return i===null?e:e instanceof yd?t.createLinearRing(i):e instanceof Io?t.createLineString(i):e instanceof Au?i.length>0?t.createPoint(i[0]):t.createPoint():e};Z1.prototype.interfaces_=function(){return[Wc.GeometryEditorOperation]};Z1.prototype.getClass=function(){return Z1};var Y1=function(){};Y1.prototype.edit=function(e,t){return e instanceof yd?t.createLinearRing(this.edit(e.getCoordinateSequence(),e)):e instanceof Io?t.createLineString(this.edit(e.getCoordinateSequence(),e)):e instanceof Au?t.createPoint(this.edit(e.getCoordinateSequence(),e)):e};Y1.prototype.interfaces_=function(){return[Wc.GeometryEditorOperation]};Y1.prototype.getClass=function(){return Y1};var Ro=function(){var e=this;if(this._dimension=3,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var t=arguments[0];this._coordinates=new Array(t).fill(null);for(var i=0;i<t;i++)e._coordinates[i]=new mt}else if(Hi(arguments[0],qr)){var r=arguments[0];if(r===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=r.getDimension(),this._coordinates=new Array(r.size()).fill(null);for(var a=0;a<this._coordinates.length;a++)e._coordinates[a]=r.getCoordinateCopy(a)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var l=arguments[0],s=arguments[1];this._coordinates=l,this._dimension=s,l===null&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var d=arguments[0],g=arguments[1];this._coordinates=new Array(d).fill(null),this._dimension=g;for(var x=0;x<d;x++)e._coordinates[x]=new mt}}},uR={serialVersionUID:{configurable:!0}};Ro.prototype.setOrdinate=function(e,t,i){switch(t){case qr.X:this._coordinates[e].x=i;break;case qr.Y:this._coordinates[e].y=i;break;case qr.Z:this._coordinates[e].z=i;break;default:throw new io("invalid ordinateIndex")}};Ro.prototype.size=function(){return this._coordinates.length};Ro.prototype.getOrdinate=function(e,t){switch(t){case qr.X:return this._coordinates[e].x;case qr.Y:return this._coordinates[e].y;case qr.Z:return this._coordinates[e].z}return rr.NaN};Ro.prototype.getCoordinate=function(){if(arguments.length===1){var e=arguments[0];return this._coordinates[e]}else if(arguments.length===2){var t=arguments[0],i=arguments[1];i.x=this._coordinates[t].x,i.y=this._coordinates[t].y,i.z=this._coordinates[t].z}};Ro.prototype.getCoordinateCopy=function(e){return new mt(this._coordinates[e])};Ro.prototype.getDimension=function(){return this._dimension};Ro.prototype.getX=function(e){return this._coordinates[e].x};Ro.prototype.clone=function(){for(var e=this,t=new Array(this.size()).fill(null),i=0;i<this._coordinates.length;i++)t[i]=e._coordinates[i].clone();return new Ro(t,this._dimension)};Ro.prototype.expandEnvelope=function(e){for(var t=this,i=0;i<this._coordinates.length;i++)e.expandToInclude(t._coordinates[i]);return e};Ro.prototype.copy=function(){for(var e=this,t=new Array(this.size()).fill(null),i=0;i<this._coordinates.length;i++)t[i]=e._coordinates[i].copy();return new Ro(t,this._dimension)};Ro.prototype.toString=function(){var e=this;if(this._coordinates.length>0){var t=new Nf(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var i=1;i<this._coordinates.length;i++)t.append(", "),t.append(e._coordinates[i]);return t.append(")"),t.toString()}else return"()"};Ro.prototype.getY=function(e){return this._coordinates[e].y};Ro.prototype.toCoordinateArray=function(){return this._coordinates};Ro.prototype.interfaces_=function(){return[qr,Jc]};Ro.prototype.getClass=function(){return Ro};uR.serialVersionUID.get=function(){return-0xcb44a778db18e00};Object.defineProperties(Ro,uR);var vd=function(){},HS={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};vd.prototype.readResolve=function(){return vd.instance()};vd.prototype.create=function(){if(arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];return new Ro(e)}else if(Hi(arguments[0],qr)){var t=arguments[0];return new Ro(t)}}else if(arguments.length===2){var i=arguments[0],r=arguments[1];return r>3&&(r=3),r<2?new Ro(i):new Ro(i,r)}};vd.prototype.interfaces_=function(){return[Fv,Jc]};vd.prototype.getClass=function(){return vd};vd.instance=function(){return vd.instanceObject};HS.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00};HS.instanceObject.get=function(){return new vd};Object.defineProperties(vd,HS);var cR=function(n){function e(){n.call(this),this.map_=new Map}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.get=function(i){return this.map_.get(i)||null},e.prototype.put=function(i,r){return this.map_.set(i,r),r},e.prototype.values=function(){for(var i=new Un,r=this.map_.values(),a=r.next();!a.done;)i.add(a.value),a=r.next();return i},e.prototype.entrySet=function(){var i=new VS;return this.map_.entries().forEach(function(r){return i.add(r)}),i},e.prototype.size=function(){return this.map_.size()},e}(Z_),ns=function n(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=n.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Af){var e=arguments[0];this._modelType=e,e===n.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var t=arguments[0];this._modelType=n.FIXED,this.setScale(t)}else if(arguments[0]instanceof n){var i=arguments[0];this._modelType=i._modelType,this._scale=i._scale}}},jS={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};ns.prototype.equals=function(e){if(!(e instanceof ns))return!1;var t=e;return this._modelType===t._modelType&&this._scale===t._scale};ns.prototype.compareTo=function(e){var t=e,i=this.getMaximumSignificantDigits(),r=t.getMaximumSignificantDigits();return new wf(i).compareTo(new wf(r))};ns.prototype.getScale=function(){return this._scale};ns.prototype.isFloating=function(){return this._modelType===ns.FLOATING||this._modelType===ns.FLOATING_SINGLE};ns.prototype.getType=function(){return this._modelType};ns.prototype.toString=function(){var e="UNKNOWN";return this._modelType===ns.FLOATING?e="Floating":this._modelType===ns.FLOATING_SINGLE?e="Floating-Single":this._modelType===ns.FIXED&&(e="Fixed (Scale="+this.getScale()+")"),e};ns.prototype.makePrecise=function(){if(typeof arguments[0]=="number"){var e=arguments[0];if(rr.isNaN(e))return e;if(this._modelType===ns.FLOATING_SINGLE){var t=e;return t}return this._modelType===ns.FIXED?Math.round(e*this._scale)/this._scale:e}else if(arguments[0]instanceof mt){var i=arguments[0];if(this._modelType===ns.FLOATING)return null;i.x=this.makePrecise(i.x),i.y=this.makePrecise(i.y)}};ns.prototype.getMaximumSignificantDigits=function(){var e=16;return this._modelType===ns.FLOATING?e=16:this._modelType===ns.FLOATING_SINGLE?e=6:this._modelType===ns.FIXED&&(e=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),e};ns.prototype.setScale=function(e){this._scale=Math.abs(e)};ns.prototype.interfaces_=function(){return[Jc,Kc]};ns.prototype.getClass=function(){return ns};ns.mostPrecise=function(e,t){return e.compareTo(t)>=0?e:t};jS.serialVersionUID.get=function(){return 7777263578777804e3};jS.maximumPreciseValue.get=function(){return 9007199254740992};Object.defineProperties(ns,jS);var Af=function n(e){this._name=e||null,n.nameToTypeMap.put(e,this)},qS={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Af.prototype.readResolve=function(){return Af.nameToTypeMap.get(this._name)};Af.prototype.toString=function(){return this._name};Af.prototype.interfaces_=function(){return[Jc]};Af.prototype.getClass=function(){return Af};qS.serialVersionUID.get=function(){return-552860263173159e4};qS.nameToTypeMap.get=function(){return new cR};Object.defineProperties(Af,qS);ns.Type=Af;ns.FIXED=new Af("FIXED");ns.FLOATING=new Af("FLOATING");ns.FLOATING_SINGLE=new Af("FLOATING SINGLE");var Lr=function n(){this._precisionModel=new ns,this._SRID=0,this._coordinateSequenceFactory=n.getDefaultCoordinateSequenceFactory(),arguments.length===0||(arguments.length===1?Hi(arguments[0],Fv)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof ns&&(this._precisionModel=arguments[0]):arguments.length===2?(this._precisionModel=arguments[0],this._SRID=arguments[1]):arguments.length===3&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},hR={serialVersionUID:{configurable:!0}};Lr.prototype.toGeometry=function(e){return e.isNull()?this.createPoint(null):e.getMinX()===e.getMaxX()&&e.getMinY()===e.getMaxY()?this.createPoint(new mt(e.getMinX(),e.getMinY())):e.getMinX()===e.getMaxX()||e.getMinY()===e.getMaxY()?this.createLineString([new mt(e.getMinX(),e.getMinY()),new mt(e.getMaxX(),e.getMaxY())]):this.createPolygon(this.createLinearRing([new mt(e.getMinX(),e.getMinY()),new mt(e.getMinX(),e.getMaxY()),new mt(e.getMaxX(),e.getMaxY()),new mt(e.getMaxX(),e.getMinY()),new mt(e.getMinX(),e.getMinY())]),null)};Lr.prototype.createLineString=function(e){if(e){if(e instanceof Array)return new Io(this.getCoordinateSequenceFactory().create(e),this);if(Hi(e,qr))return new Io(e,this)}else return new Io(this.getCoordinateSequenceFactory().create([]),this)};Lr.prototype.createMultiLineString=function(){if(arguments.length===0)return new hg(null,this);if(arguments.length===1){var e=arguments[0];return new hg(e,this)}};Lr.prototype.buildGeometry=function(e){for(var t=null,i=!1,r=!1,a=e.iterator();a.hasNext();){var l=a.next(),s=l.getClass();t===null&&(t=s),s!==t&&(i=!0),l.isGeometryCollectionOrDerived()&&(r=!0)}if(t===null)return this.createGeometryCollection();if(i||r)return this.createGeometryCollection(Lr.toGeometryArray(e));var d=e.iterator().next(),g=e.size()>1;if(g){if(d instanceof oa)return this.createMultiPolygon(Lr.toPolygonArray(e));if(d instanceof Io)return this.createMultiLineString(Lr.toLineStringArray(e));if(d instanceof Au)return this.createMultiPoint(Lr.toPointArray(e));dr.shouldNeverReachHere("Unhandled class: "+d.getClass().getName())}return d};Lr.prototype.createMultiPointFromCoords=function(e){return this.createMultiPoint(e!==null?this.getCoordinateSequenceFactory().create(e):null)};Lr.prototype.createPoint=function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof mt){var e=arguments[0];return this.createPoint(e!==null?this.getCoordinateSequenceFactory().create([e]):null)}else if(Hi(arguments[0],qr)){var t=arguments[0];return new Au(t,this)}}};Lr.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory};Lr.prototype.createPolygon=function(){if(arguments.length===0)return new oa(null,null,this);if(arguments.length===1){if(Hi(arguments[0],qr)){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}else if(arguments[0]instanceof Array){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}else if(arguments[0]instanceof yd){var i=arguments[0];return this.createPolygon(i,null)}}else if(arguments.length===2){var r=arguments[0],a=arguments[1];return new oa(r,a,this)}};Lr.prototype.getSRID=function(){return this._SRID};Lr.prototype.createGeometryCollection=function(){if(arguments.length===0)return new Nl(null,this);if(arguments.length===1){var e=arguments[0];return new Nl(e,this)}};Lr.prototype.createGeometry=function(e){var t=new Wc(this);return t.edit(e,{edit:function(){if(arguments.length===2){var i=arguments[0];return this._coordinateSequenceFactory.create(i)}}})};Lr.prototype.getPrecisionModel=function(){return this._precisionModel};Lr.prototype.createLinearRing=function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];return this.createLinearRing(e!==null?this.getCoordinateSequenceFactory().create(e):null)}else if(Hi(arguments[0],qr)){var t=arguments[0];return new yd(t,this)}}};Lr.prototype.createMultiPolygon=function(){if(arguments.length===0)return new pd(null,this);if(arguments.length===1){var e=arguments[0];return new pd(e,this)}};Lr.prototype.createMultiPoint=function(){var e=this;if(arguments.length===0)return new Hv(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return new Hv(t,this)}else if(arguments[0]instanceof Array){var i=arguments[0];return this.createMultiPoint(i!==null?this.getCoordinateSequenceFactory().create(i):null)}else if(Hi(arguments[0],qr)){var r=arguments[0];if(r===null)return this.createMultiPoint(new Array(0).fill(null));for(var a=new Array(r.size()).fill(null),l=0;l<r.size();l++){var s=e.getCoordinateSequenceFactory().create(1,r.getDimension());Do.copy(r,l,s,0,1),a[l]=e.createPoint(s)}return this.createMultiPoint(a)}}};Lr.prototype.interfaces_=function(){return[Jc]};Lr.prototype.getClass=function(){return Lr};Lr.toMultiPolygonArray=function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)};Lr.toGeometryArray=function(e){if(e===null)return null;var t=new Array(e.size()).fill(null);return e.toArray(t)};Lr.getDefaultCoordinateSequenceFactory=function(){return vd.instance()};Lr.toMultiLineStringArray=function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)};Lr.toLineStringArray=function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)};Lr.toMultiPointArray=function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)};Lr.toLinearRingArray=function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)};Lr.toPointArray=function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)};Lr.toPolygonArray=function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)};Lr.createPointFromInternalCoord=function(e,t){return t.getPrecisionModel().makePrecise(e),t.getFactory().createPoint(e)};hR.serialVersionUID.get=function(){return-6820524753094096e3};Object.defineProperties(Lr,hR);var q5=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],xI=function(e){this.geometryFactory=e||new Lr};xI.prototype.read=function(e){var t;typeof e=="string"?t=JSON.parse(e):t=e;var i=t.type;if(!_f[i])throw new Error("Unknown GeoJSON type: "+t.type);return q5.indexOf(i)!==-1?_f[i].apply(this,[t.coordinates]):i==="GeometryCollection"?_f[i].apply(this,[t.geometries]):_f[i].apply(this,[t])};xI.prototype.write=function(e){var t=e.getGeometryType();if(!rp[t])throw new Error("Geometry is not supported");return rp[t].apply(this,[e])};var _f={Feature:function(n){var e={};for(var t in n)e[t]=n[t];if(n.geometry){var i=n.geometry.type;if(!_f[i])throw new Error("Unknown GeoJSON type: "+n.type);e.geometry=this.read(n.geometry)}return n.bbox&&(e.bbox=_f.bbox.apply(this,[n.bbox])),e},FeatureCollection:function(n){var e=this,t={};if(n.features){t.features=[];for(var i=0;i<n.features.length;++i)t.features.push(e.read(n.features[i]))}return n.bbox&&(t.bbox=this.parse.bbox.apply(this,[n.bbox])),t},coordinates:function(n){for(var e=[],t=0;t<n.length;++t){var i=n[t];e.push(new mt(i[0],i[1]))}return e},bbox:function(n){return this.geometryFactory.createLinearRing([new mt(n[0],n[1]),new mt(n[2],n[1]),new mt(n[2],n[3]),new mt(n[0],n[3]),new mt(n[0],n[1])])},Point:function(n){var e=new mt(n[0],n[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(n){for(var e=this,t=[],i=0;i<n.length;++i)t.push(_f.Point.apply(e,[n[i]]));return this.geometryFactory.createMultiPoint(t)},LineString:function(n){var e=_f.coordinates.apply(this,[n]);return this.geometryFactory.createLineString(e)},MultiLineString:function(n){for(var e=this,t=[],i=0;i<n.length;++i)t.push(_f.LineString.apply(e,[n[i]]));return this.geometryFactory.createMultiLineString(t)},Polygon:function(n){for(var e=this,t=_f.coordinates.apply(this,[n[0]]),i=this.geometryFactory.createLinearRing(t),r=[],a=1;a<n.length;++a){var l=n[a],s=_f.coordinates.apply(e,[l]),d=e.geometryFactory.createLinearRing(s);r.push(d)}return this.geometryFactory.createPolygon(i,r)},MultiPolygon:function(n){for(var e=this,t=[],i=0;i<n.length;++i){var r=n[i];t.push(_f.Polygon.apply(e,[r]))}return this.geometryFactory.createMultiPolygon(t)},GeometryCollection:function(n){for(var e=this,t=[],i=0;i<n.length;++i){var r=n[i];t.push(e.read(r))}return this.geometryFactory.createGeometryCollection(t)}},rp={coordinate:function(n){return[n.x,n.y]},Point:function(n){var e=rp.coordinate.apply(this,[n.getCoordinate()]);return{type:"Point",coordinates:e}},MultiPoint:function(n){for(var e=this,t=[],i=0;i<n._geometries.length;++i){var r=n._geometries[i],a=rp.Point.apply(e,[r]);t.push(a.coordinates)}return{type:"MultiPoint",coordinates:t}},LineString:function(n){for(var e=this,t=[],i=n.getCoordinates(),r=0;r<i.length;++r){var a=i[r];t.push(rp.coordinate.apply(e,[a]))}return{type:"LineString",coordinates:t}},MultiLineString:function(n){for(var e=this,t=[],i=0;i<n._geometries.length;++i){var r=n._geometries[i],a=rp.LineString.apply(e,[r]);t.push(a.coordinates)}return{type:"MultiLineString",coordinates:t}},Polygon:function(n){var e=this,t=[],i=rp.LineString.apply(this,[n._shell]);t.push(i.coordinates);for(var r=0;r<n._holes.length;++r){var a=n._holes[r],l=rp.LineString.apply(e,[a]);t.push(l.coordinates)}return{type:"Polygon",coordinates:t}},MultiPolygon:function(n){for(var e=this,t=[],i=0;i<n._geometries.length;++i){var r=n._geometries[i],a=rp.Polygon.apply(e,[r]);t.push(a.coordinates)}return{type:"MultiPolygon",coordinates:t}},GeometryCollection:function(n){for(var e=this,t=[],i=0;i<n._geometries.length;++i){var r=n._geometries[i],a=r.getGeometryType();t.push(rp[a].apply(e,[r]))}return{type:"GeometryCollection",geometries:t}}},WS=function(e){this.geometryFactory=e||new Lr,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new xI(this.geometryFactory)};WS.prototype.read=function(e){var t=this.parser.read(e);return this.precisionModel.getType()===ns.FIXED&&this.reducePrecision(t),t};WS.prototype.reducePrecision=function(e){var t=this,i,r;if(e.coordinate)this.precisionModel.makePrecise(e.coordinate);else if(e.points)for(i=0,r=e.points.length;i<r;i++)t.precisionModel.makePrecise(e.points[i]);else if(e.geometries)for(i=0,r=e.geometries.length;i<r;i++)t.reducePrecision(e.geometries[i])};var fR=function(){this.parser=new xI(this.geometryFactory)};fR.prototype.write=function(e){return this.parser.write(e)};var Mn=function(){},EI={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Mn.prototype.interfaces_=function(){return[]};Mn.prototype.getClass=function(){return Mn};Mn.opposite=function(e){return e===Mn.LEFT?Mn.RIGHT:e===Mn.RIGHT?Mn.LEFT:e};EI.ON.get=function(){return 0};EI.LEFT.get=function(){return 1};EI.RIGHT.get=function(){return 2};Object.defineProperties(Mn,EI);function II(n){this.message=n||""}II.prototype=new Error;II.prototype.name="EmptyStackException";function kf(){this.array_=[]}kf.prototype=new Th;kf.prototype.add=function(n){return this.array_.push(n),!0};kf.prototype.get=function(n){if(n<0||n>=this.size())throw new Error;return this.array_[n]};kf.prototype.push=function(n){return this.array_.push(n),n};kf.prototype.pop=function(n){if(this.array_.length===0)throw new II;return this.array_.pop()};kf.prototype.peek=function(){if(this.array_.length===0)throw new II;return this.array_[this.array_.length-1]};kf.prototype.empty=function(){return this.array_.length===0};kf.prototype.isEmpty=function(){return this.empty()};kf.prototype.search=function(n){return this.array_.indexOf(n)};kf.prototype.size=function(){return this.array_.length};kf.prototype.toArray=function(){for(var n=this,e=[],t=0,i=this.array_.length;t<i;t++)e.push(n.array_[t]);return e};var Mf=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Mf.prototype.getCoordinate=function(){return this._minCoord};Mf.prototype.getRightmostSide=function(e,t){var i=this.getRightmostSideOfSegment(e,t);return i<0&&(i=this.getRightmostSideOfSegment(e,t-1)),i<0&&(this._minCoord=null,this.checkForRightmostCoordinate(e)),i};Mf.prototype.findRightmostEdgeAtVertex=function(){var e=this._minDe.getEdge().getCoordinates();dr.isTrue(this._minIndex>0&&this._minIndex<e.length,"rightmost point expected to be interior vertex of edge");var t=e[this._minIndex-1],i=e[this._minIndex+1],r=Jn.computeOrientation(this._minCoord,i,t),a=!1;(t.y<this._minCoord.y&&i.y<this._minCoord.y&&r===Jn.COUNTERCLOCKWISE||t.y>this._minCoord.y&&i.y>this._minCoord.y&&r===Jn.CLOCKWISE)&&(a=!0),a&&(this._minIndex=this._minIndex-1)};Mf.prototype.getRightmostSideOfSegment=function(e,t){var i=e.getEdge(),r=i.getCoordinates();if(t<0||t+1>=r.length||r[t].y===r[t+1].y)return-1;var a=Mn.LEFT;return r[t].y<r[t+1].y&&(a=Mn.RIGHT),a};Mf.prototype.getEdge=function(){return this._orientedDe};Mf.prototype.checkForRightmostCoordinate=function(e){for(var t=this,i=e.getEdge().getCoordinates(),r=0;r<i.length-1;r++)(t._minCoord===null||i[r].x>t._minCoord.x)&&(t._minDe=e,t._minIndex=r,t._minCoord=i[r])};Mf.prototype.findRightmostEdgeAtNode=function(){var e=this._minDe.getNode(),t=e.getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)};Mf.prototype.findEdge=function(e){for(var t=this,i=e.iterator();i.hasNext();){var r=i.next();r.isForward()&&t.checkForRightmostCoordinate(r)}dr.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe;var a=this.getRightmostSide(this._minDe,this._minIndex);a===Mn.LEFT&&(this._orientedDe=this._minDe.getSym())};Mf.prototype.interfaces_=function(){return[]};Mf.prototype.getClass=function(){return Mf};var gp=function(n){function e(t,i){n.call(this,e.msgWithCoord(t,i)),this.pt=i?new mt(i):null,this.name="TopologyException"}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.getCoordinate=function(){return this.pt},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.msgWithCoord=function(i,r){return r?i:i+" [ "+r+" ]"},e}(pp),TI=function(){this.array_=[]};TI.prototype.addLast=function(e){this.array_.push(e)};TI.prototype.removeFirst=function(){return this.array_.shift()};TI.prototype.isEmpty=function(){return this.array_.length===0};var kl=function(){this._finder=null,this._dirEdgeList=new Un,this._nodes=new Un,this._rightMostCoord=null,this._env=null,this._finder=new Mf};kl.prototype.clearVisitedEdges=function(){for(var e=this._dirEdgeList.iterator();e.hasNext();){var t=e.next();t.setVisited(!1)}};kl.prototype.getRightmostCoordinate=function(){return this._rightMostCoord};kl.prototype.computeNodeDepth=function(e){for(var t=this,i=null,r=e.getEdges().iterator();r.hasNext();){var a=r.next();if(a.isVisited()||a.getSym().isVisited()){i=a;break}}if(i===null)throw new gp("unable to find edge to compute depths at "+e.getCoordinate());e.getEdges().computeDepths(i);for(var l=e.getEdges().iterator();l.hasNext();){var s=l.next();s.setVisited(!0),t.copySymDepths(s)}};kl.prototype.computeDepth=function(e){this.clearVisitedEdges();var t=this._finder.getEdge();t.setEdgeDepths(Mn.RIGHT,e),this.copySymDepths(t),this.computeDepths(t)};kl.prototype.create=function(e){this.addReachable(e),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()};kl.prototype.findResultEdges=function(){for(var e=this._dirEdgeList.iterator();e.hasNext();){var t=e.next();t.getDepth(Mn.RIGHT)>=1&&t.getDepth(Mn.LEFT)<=0&&!t.isInteriorAreaEdge()&&t.setInResult(!0)}};kl.prototype.computeDepths=function(e){var t=this,i=new VS,r=new TI,a=e.getNode();for(r.addLast(a),i.add(a),e.setVisited(!0);!r.isEmpty();){var l=r.removeFirst();i.add(l),t.computeNodeDepth(l);for(var s=l.getEdges().iterator();s.hasNext();){var d=s.next(),g=d.getSym();if(!g.isVisited()){var x=g.getNode();i.contains(x)||(r.addLast(x),i.add(x))}}}};kl.prototype.compareTo=function(e){var t=e;return this._rightMostCoord.x<t._rightMostCoord.x?-1:this._rightMostCoord.x>t._rightMostCoord.x?1:0};kl.prototype.getEnvelope=function(){if(this._env===null){for(var e=new Ii,t=this._dirEdgeList.iterator();t.hasNext();)for(var i=t.next(),r=i.getEdge().getCoordinates(),a=0;a<r.length-1;a++)e.expandToInclude(r[a]);this._env=e}return this._env};kl.prototype.addReachable=function(e){var t=this,i=new kf;for(i.add(e);!i.empty();){var r=i.pop();t.add(r,i)}};kl.prototype.copySymDepths=function(e){var t=e.getSym();t.setDepth(Mn.LEFT,e.getDepth(Mn.RIGHT)),t.setDepth(Mn.RIGHT,e.getDepth(Mn.LEFT))};kl.prototype.add=function(e,t){var i=this;e.setVisited(!0),this._nodes.add(e);for(var r=e.getEdges().iterator();r.hasNext();){var a=r.next();i._dirEdgeList.add(a);var l=a.getSym(),s=l.getNode();s.isVisited()||t.push(s)}};kl.prototype.getNodes=function(){return this._nodes};kl.prototype.getDirectedEdges=function(){return this._dirEdgeList};kl.prototype.interfaces_=function(){return[Kc]};kl.prototype.getClass=function(){return kl};var ks=function n(){var e=this;if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){var i=arguments[0];this.init(1),this.location[Mn.ON]=i}else if(arguments[0]instanceof n){var r=arguments[0];if(this.init(r.location.length),r!==null)for(var a=0;a<this.location.length;a++)e.location[a]=r.location[a]}}else if(arguments.length===3){var l=arguments[0],s=arguments[1],d=arguments[2];this.init(3),this.location[Mn.ON]=l,this.location[Mn.LEFT]=s,this.location[Mn.RIGHT]=d}};ks.prototype.setAllLocations=function(e){for(var t=this,i=0;i<this.location.length;i++)t.location[i]=e};ks.prototype.isNull=function(){for(var e=this,t=0;t<this.location.length;t++)if(e.location[t]!==wt.NONE)return!1;return!0};ks.prototype.setAllLocationsIfNull=function(e){for(var t=this,i=0;i<this.location.length;i++)t.location[i]===wt.NONE&&(t.location[i]=e)};ks.prototype.isLine=function(){return this.location.length===1};ks.prototype.merge=function(e){var t=this;if(e.location.length>this.location.length){var i=new Array(3).fill(null);i[Mn.ON]=this.location[Mn.ON],i[Mn.LEFT]=wt.NONE,i[Mn.RIGHT]=wt.NONE,this.location=i}for(var r=0;r<this.location.length;r++)t.location[r]===wt.NONE&&r<e.location.length&&(t.location[r]=e.location[r])};ks.prototype.getLocations=function(){return this.location};ks.prototype.flip=function(){if(this.location.length<=1)return null;var e=this.location[Mn.LEFT];this.location[Mn.LEFT]=this.location[Mn.RIGHT],this.location[Mn.RIGHT]=e};ks.prototype.toString=function(){var e=new Nf;return this.location.length>1&&e.append(wt.toLocationSymbol(this.location[Mn.LEFT])),e.append(wt.toLocationSymbol(this.location[Mn.ON])),this.location.length>1&&e.append(wt.toLocationSymbol(this.location[Mn.RIGHT])),e.toString()};ks.prototype.setLocations=function(e,t,i){this.location[Mn.ON]=e,this.location[Mn.LEFT]=t,this.location[Mn.RIGHT]=i};ks.prototype.get=function(e){return e<this.location.length?this.location[e]:wt.NONE};ks.prototype.isArea=function(){return this.location.length>1};ks.prototype.isAnyNull=function(){for(var e=this,t=0;t<this.location.length;t++)if(e.location[t]===wt.NONE)return!0;return!1};ks.prototype.setLocation=function(){if(arguments.length===1){var e=arguments[0];this.setLocation(Mn.ON,e)}else if(arguments.length===2){var t=arguments[0],i=arguments[1];this.location[t]=i}};ks.prototype.init=function(e){this.location=new Array(e).fill(null),this.setAllLocations(wt.NONE)};ks.prototype.isEqualOnSide=function(e,t){return this.location[t]===e.location[t]};ks.prototype.allPositionsEqual=function(e){for(var t=this,i=0;i<this.location.length;i++)if(t.location[i]!==e)return!1;return!0};ks.prototype.interfaces_=function(){return[]};ks.prototype.getClass=function(){return ks};var fs=function n(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new ks(e),this.elt[1]=new ks(e)}else if(arguments[0]instanceof n){var t=arguments[0];this.elt[0]=new ks(t.elt[0]),this.elt[1]=new ks(t.elt[1])}}else if(arguments.length===2){var i=arguments[0],r=arguments[1];this.elt[0]=new ks(wt.NONE),this.elt[1]=new ks(wt.NONE),this.elt[i].setLocation(r)}else if(arguments.length===3){var a=arguments[0],l=arguments[1],s=arguments[2];this.elt[0]=new ks(a,l,s),this.elt[1]=new ks(a,l,s)}else if(arguments.length===4){var d=arguments[0],g=arguments[1],x=arguments[2],I=arguments[3];this.elt[0]=new ks(wt.NONE,wt.NONE,wt.NONE),this.elt[1]=new ks(wt.NONE,wt.NONE,wt.NONE),this.elt[d].setLocations(g,x,I)}};fs.prototype.getGeometryCount=function(){var e=0;return this.elt[0].isNull()||e++,this.elt[1].isNull()||e++,e};fs.prototype.setAllLocations=function(e,t){this.elt[e].setAllLocations(t)};fs.prototype.isNull=function(e){return this.elt[e].isNull()};fs.prototype.setAllLocationsIfNull=function(){if(arguments.length===1){var e=arguments[0];this.setAllLocationsIfNull(0,e),this.setAllLocationsIfNull(1,e)}else if(arguments.length===2){var t=arguments[0],i=arguments[1];this.elt[t].setAllLocationsIfNull(i)}};fs.prototype.isLine=function(e){return this.elt[e].isLine()};fs.prototype.merge=function(e){for(var t=this,i=0;i<2;i++)t.elt[i]===null&&e.elt[i]!==null?t.elt[i]=new ks(e.elt[i]):t.elt[i].merge(e.elt[i])};fs.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()};fs.prototype.getLocation=function(){if(arguments.length===1){var e=arguments[0];return this.elt[e].get(Mn.ON)}else if(arguments.length===2){var t=arguments[0],i=arguments[1];return this.elt[t].get(i)}};fs.prototype.toString=function(){var e=new Nf;return this.elt[0]!==null&&(e.append("A:"),e.append(this.elt[0].toString())),this.elt[1]!==null&&(e.append(" B:"),e.append(this.elt[1].toString())),e.toString()};fs.prototype.isArea=function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var e=arguments[0];return this.elt[e].isArea()}};fs.prototype.isAnyNull=function(e){return this.elt[e].isAnyNull()};fs.prototype.setLocation=function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];this.elt[e].setLocation(Mn.ON,t)}else if(arguments.length===3){var i=arguments[0],r=arguments[1],a=arguments[2];this.elt[i].setLocation(r,a)}};fs.prototype.isEqualOnSide=function(e,t){return this.elt[0].isEqualOnSide(e.elt[0],t)&&this.elt[1].isEqualOnSide(e.elt[1],t)};fs.prototype.allPositionsEqual=function(e,t){return this.elt[e].allPositionsEqual(t)};fs.prototype.toLine=function(e){this.elt[e].isArea()&&(this.elt[e]=new ks(this.elt[e].location[0]))};fs.prototype.interfaces_=function(){return[]};fs.prototype.getClass=function(){return fs};fs.toLineLabel=function(e){for(var t=new fs(wt.NONE),i=0;i<2;i++)t.setLocation(i,e.getLocation(i));return t};var qo=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new Un,this._pts=new Un,this._label=new fs(wt.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Un,this._geometryFactory=null;var e=arguments[0],t=arguments[1];this._geometryFactory=t,this.computePoints(e),this.computeRing()};qo.prototype.computeRing=function(){var e=this;if(this._ring!==null)return null;for(var t=new Array(this._pts.size()).fill(null),i=0;i<this._pts.size();i++)t[i]=e._pts.get(i);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=Jn.isCCW(this._ring.getCoordinates())};qo.prototype.isIsolated=function(){return this._label.getGeometryCount()===1};qo.prototype.computePoints=function(e){var t=this;this._startDe=e;var i=e,r=!0;do{if(i===null)throw new gp("Found null DirectedEdge");if(i.getEdgeRing()===t)throw new gp("Directed Edge visited twice during ring-building at "+i.getCoordinate());t._edges.add(i);var a=i.getLabel();dr.isTrue(a.isArea()),t.mergeLabel(a),t.addPoints(i.getEdge(),i.isForward(),r),r=!1,t.setEdgeRing(i,t),i=t.getNext(i)}while(i!==this._startDe)};qo.prototype.getLinearRing=function(){return this._ring};qo.prototype.getCoordinate=function(e){return this._pts.get(e)};qo.prototype.computeMaxNodeDegree=function(){var e=this;this._maxNodeDegree=0;var t=this._startDe;do{var i=t.getNode(),r=i.getEdges().getOutgoingDegree(e);r>e._maxNodeDegree&&(e._maxNodeDegree=r),t=e.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2};qo.prototype.addPoints=function(e,t,i){var r=this,a=e.getCoordinates();if(t){var l=1;i&&(l=0);for(var s=l;s<a.length;s++)r._pts.add(a[s])}else{var d=a.length-2;i&&(d=a.length-1);for(var g=d;g>=0;g--)r._pts.add(a[g])}};qo.prototype.isHole=function(){return this._isHole};qo.prototype.setInResult=function(){var e=this._startDe;do e.getEdge().setInResult(!0),e=e.getNext();while(e!==this._startDe)};qo.prototype.containsPoint=function(e){var t=this.getLinearRing(),i=t.getEnvelopeInternal();if(!i.contains(e)||!Jn.isPointInRing(e,t.getCoordinates()))return!1;for(var r=this._holes.iterator();r.hasNext();){var a=r.next();if(a.containsPoint(e))return!1}return!0};qo.prototype.addHole=function(e){this._holes.add(e)};qo.prototype.isShell=function(){return this._shell===null};qo.prototype.getLabel=function(){return this._label};qo.prototype.getEdges=function(){return this._edges};qo.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree};qo.prototype.getShell=function(){return this._shell};qo.prototype.mergeLabel=function(){if(arguments.length===1){var e=arguments[0];this.mergeLabel(e,0),this.mergeLabel(e,1)}else if(arguments.length===2){var t=arguments[0],i=arguments[1],r=t.getLocation(i,Mn.RIGHT);if(r===wt.NONE)return null;if(this._label.getLocation(i)===wt.NONE)return this._label.setLocation(i,r),null}};qo.prototype.setShell=function(e){this._shell=e,e!==null&&e.addHole(this)};qo.prototype.toPolygon=function(e){for(var t=this,i=new Array(this._holes.size()).fill(null),r=0;r<this._holes.size();r++)i[r]=t._holes.get(r).getLinearRing();var a=e.createPolygon(this.getLinearRing(),i);return a};qo.prototype.interfaces_=function(){return[]};qo.prototype.getClass=function(){return qo};var W5=function(n){function e(){var t=arguments[0],i=arguments[1];n.call(this,t,i)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.setEdgeRing=function(i,r){i.setMinEdgeRing(r)},e.prototype.getNext=function(i){return i.getNextMin()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(qo),X5=function(n){function e(){var t=arguments[0],i=arguments[1];n.call(this,t,i)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.buildMinimalRings=function(){var i=this,r=new Un,a=this._startDe;do{if(a.getMinEdgeRing()===null){var l=new W5(a,i._geometryFactory);r.add(l)}a=a.getNext()}while(a!==this._startDe);return r},e.prototype.setEdgeRing=function(i,r){i.setEdgeRing(r)},e.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var i=this,r=this._startDe;do{var a=r.getNode();a.getEdges().linkMinimalDirectedEdges(i),r=r.getNext()}while(r!==this._startDe)},e.prototype.getNext=function(i){return i.getNext()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(qo),oc=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this._label=e}}};oc.prototype.setVisited=function(e){this._isVisited=e};oc.prototype.setInResult=function(e){this._isInResult=e};oc.prototype.isCovered=function(){return this._isCovered};oc.prototype.isCoveredSet=function(){return this._isCoveredSet};oc.prototype.setLabel=function(e){this._label=e};oc.prototype.getLabel=function(){return this._label};oc.prototype.setCovered=function(e){this._isCovered=e,this._isCoveredSet=!0};oc.prototype.updateIM=function(e){dr.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(e)};oc.prototype.isInResult=function(){return this._isInResult};oc.prototype.isVisited=function(){return this._isVisited};oc.prototype.interfaces_=function(){return[]};oc.prototype.getClass=function(){return oc};var wI=function(n){function e(){n.call(this),this._coord=null,this._edges=null;var t=arguments[0],i=arguments[1];this._coord=t,this._edges=i,this._label=new fs(0,wt.NONE)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.isIncidentEdgeInResult=function(){for(var i=this.getEdges().getEdges().iterator();i.hasNext();){var r=i.next();if(r.getEdge().isInResult())return!0}return!1},e.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},e.prototype.getCoordinate=function(){return this._coord},e.prototype.print=function(i){i.println("node "+this._coord+" lbl: "+this._label)},e.prototype.computeIM=function(i){},e.prototype.computeMergedLocation=function(i,r){var a=wt.NONE;if(a=this._label.getLocation(r),!i.isNull(r)){var l=i.getLocation(r);a!==wt.BOUNDARY&&(a=l)}return a},e.prototype.setLabel=function(){if(arguments.length===2){var i=arguments[0],r=arguments[1];this._label===null?this._label=new fs(i,r):this._label.setLocation(i,r)}else return n.prototype.setLabel.apply(this,arguments)},e.prototype.getEdges=function(){return this._edges},e.prototype.mergeLabel=function(){var i=this;if(arguments[0]instanceof e){var r=arguments[0];this.mergeLabel(r._label)}else if(arguments[0]instanceof fs)for(var a=arguments[0],l=0;l<2;l++){var s=i.computeMergedLocation(a,l),d=i._label.getLocation(l);d===wt.NONE&&i._label.setLocation(l,s)}},e.prototype.add=function(i){this._edges.insert(i),i.setNode(this)},e.prototype.setLabelBoundary=function(i){if(this._label===null)return null;var r=wt.NONE;this._label!==null&&(r=this._label.getLocation(i));var a=null;switch(r){case wt.BOUNDARY:a=wt.INTERIOR;break;case wt.INTERIOR:a=wt.BOUNDARY;break;default:a=wt.BOUNDARY;break}this._label.setLocation(i,a)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(oc),Lf=function(){this.nodeMap=new yl,this.nodeFact=null;var e=arguments[0];this.nodeFact=e};Lf.prototype.find=function(e){return this.nodeMap.get(e)};Lf.prototype.addNode=function(){if(arguments[0]instanceof mt){var e=arguments[0],t=this.nodeMap.get(e);return t===null&&(t=this.nodeFact.createNode(e),this.nodeMap.put(e,t)),t}else if(arguments[0]instanceof wI){var i=arguments[0],r=this.nodeMap.get(i.getCoordinate());return r===null?(this.nodeMap.put(i.getCoordinate(),i),i):(r.mergeLabel(i),r)}};Lf.prototype.print=function(e){for(var t=this.iterator();t.hasNext();){var i=t.next();i.print(e)}};Lf.prototype.iterator=function(){return this.nodeMap.values().iterator()};Lf.prototype.values=function(){return this.nodeMap.values()};Lf.prototype.getBoundaryNodes=function(e){for(var t=new Un,i=this.iterator();i.hasNext();){var r=i.next();r.getLabel().getLocation(e)===wt.BOUNDARY&&t.add(r)}return t};Lf.prototype.add=function(e){var t=e.getCoordinate(),i=this.addNode(t);i.add(e)};Lf.prototype.interfaces_=function(){return[]};Lf.prototype.getClass=function(){return Lf};var ws=function(){},_b={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};ws.prototype.interfaces_=function(){return[]};ws.prototype.getClass=function(){return ws};ws.isNorthern=function(e){return e===ws.NE||e===ws.NW};ws.isOpposite=function(e,t){if(e===t)return!1;var i=(e-t+4)%4;return i===2};ws.commonHalfPlane=function(e,t){if(e===t)return e;var i=(e-t+4)%4;if(i===2)return-1;var r=e<t?e:t,a=e>t?e:t;return r===0&&a===3?3:r};ws.isInHalfPlane=function(e,t){return t===ws.SE?e===ws.SE||e===ws.SW:e===t||e===t+1};ws.quadrant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],t=arguments[1];if(e===0&&t===0)throw new io("Cannot compute the quadrant for point ( "+e+", "+t+" )");return e>=0?t>=0?ws.NE:ws.SE:t>=0?ws.NW:ws.SW}else if(arguments[0]instanceof mt&&arguments[1]instanceof mt){var i=arguments[0],r=arguments[1];if(r.x===i.x&&r.y===i.y)throw new io("Cannot compute the quadrant for two identical points "+i);return r.x>=i.x?r.y>=i.y?ws.NE:ws.SE:r.y>=i.y?ws.NW:ws.SW}};_b.NE.get=function(){return 0};_b.NW.get=function(){return 1};_b.SW.get=function(){return 2};_b.SE.get=function(){return 3};Object.defineProperties(ws,_b);var vl=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var e=arguments[0];this._edge=e}else if(arguments.length===3){var t=arguments[0],i=arguments[1],r=arguments[2],a=null;this._edge=t,this.init(i,r),this._label=a}else if(arguments.length===4){var l=arguments[0],s=arguments[1],d=arguments[2],g=arguments[3];this._edge=l,this.init(s,d),this._label=g}};vl.prototype.compareDirection=function(e){return this._dx===e._dx&&this._dy===e._dy?0:this._quadrant>e._quadrant?1:this._quadrant<e._quadrant?-1:Jn.computeOrientation(e._p0,e._p1,this._p1)};vl.prototype.getDy=function(){return this._dy};vl.prototype.getCoordinate=function(){return this._p0};vl.prototype.setNode=function(e){this._node=e};vl.prototype.print=function(e){var t=Math.atan2(this._dy,this._dx),i=this.getClass().getName(),r=i.lastIndexOf("."),a=i.substring(r+1);e.print("  "+a+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label)};vl.prototype.compareTo=function(e){var t=e;return this.compareDirection(t)};vl.prototype.getDirectedCoordinate=function(){return this._p1};vl.prototype.getDx=function(){return this._dx};vl.prototype.getLabel=function(){return this._label};vl.prototype.getEdge=function(){return this._edge};vl.prototype.getQuadrant=function(){return this._quadrant};vl.prototype.getNode=function(){return this._node};vl.prototype.toString=function(){var e=Math.atan2(this._dy,this._dx),t=this.getClass().getName(),i=t.lastIndexOf("."),r=t.substring(i+1);return"  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label};vl.prototype.computeLabel=function(e){};vl.prototype.init=function(e,t){this._p0=e,this._p1=t,this._dx=t.x-e.x,this._dy=t.y-e.y,this._quadrant=ws.quadrant(this._dx,this._dy),dr.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")};vl.prototype.interfaces_=function(){return[Kc]};vl.prototype.getClass=function(){return vl};var tS=function(n){function e(){var t=arguments[0],i=arguments[1];if(n.call(this,t),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=i,i)this.init(t.getCoordinate(0),t.getCoordinate(1));else{var r=t.getNumPoints()-1;this.init(t.getCoordinate(r),t.getCoordinate(r-1))}this.computeDirectedLabel()}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.getNextMin=function(){return this._nextMin},e.prototype.getDepth=function(i){return this._depth[i]},e.prototype.setVisited=function(i){this._isVisited=i},e.prototype.computeDirectedLabel=function(){this._label=new fs(this._edge.getLabel()),this._isForward||this._label.flip()},e.prototype.getNext=function(){return this._next},e.prototype.setDepth=function(i,r){if(this._depth[i]!==-999&&this._depth[i]!==r)throw new gp("assigned depths do not match",this.getCoordinate());this._depth[i]=r},e.prototype.isInteriorAreaEdge=function(){for(var i=this,r=!0,a=0;a<2;a++)i._label.isArea(a)&&i._label.getLocation(a,Mn.LEFT)===wt.INTERIOR&&i._label.getLocation(a,Mn.RIGHT)===wt.INTERIOR||(r=!1);return r},e.prototype.setNextMin=function(i){this._nextMin=i},e.prototype.print=function(i){n.prototype.print.call(this,i),i.print(" "+this._depth[Mn.LEFT]+"/"+this._depth[Mn.RIGHT]),i.print(" ("+this.getDepthDelta()+")"),this._isInResult&&i.print(" inResult")},e.prototype.setMinEdgeRing=function(i){this._minEdgeRing=i},e.prototype.isLineEdge=function(){var i=this._label.isLine(0)||this._label.isLine(1),r=!this._label.isArea(0)||this._label.allPositionsEqual(0,wt.EXTERIOR),a=!this._label.isArea(1)||this._label.allPositionsEqual(1,wt.EXTERIOR);return i&&r&&a},e.prototype.setEdgeRing=function(i){this._edgeRing=i},e.prototype.getMinEdgeRing=function(){return this._minEdgeRing},e.prototype.getDepthDelta=function(){var i=this._edge.getDepthDelta();return this._isForward||(i=-i),i},e.prototype.setInResult=function(i){this._isInResult=i},e.prototype.getSym=function(){return this._sym},e.prototype.isForward=function(){return this._isForward},e.prototype.getEdge=function(){return this._edge},e.prototype.printEdge=function(i){this.print(i),i.print(" "),this._isForward?this._edge.print(i):this._edge.printReverse(i)},e.prototype.setSym=function(i){this._sym=i},e.prototype.setVisitedEdge=function(i){this.setVisited(i),this._sym.setVisited(i)},e.prototype.setEdgeDepths=function(i,r){var a=this.getEdge().getDepthDelta();this._isForward||(a=-a);var l=1;i===Mn.LEFT&&(l=-1);var s=Mn.opposite(i),d=a*l,g=r+d;this.setDepth(i,r),this.setDepth(s,g)},e.prototype.getEdgeRing=function(){return this._edgeRing},e.prototype.isInResult=function(){return this._isInResult},e.prototype.setNext=function(i){this._next=i},e.prototype.isVisited=function(){return this._isVisited},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.depthFactor=function(i,r){return i===wt.EXTERIOR&&r===wt.INTERIOR?1:i===wt.INTERIOR&&r===wt.EXTERIOR?-1:0},e}(vl),jv=function(){};jv.prototype.createNode=function(e){return new wI(e,null)};jv.prototype.interfaces_=function(){return[]};jv.prototype.getClass=function(){return jv};var po=function(){if(this._edges=new Un,this._nodes=null,this._edgeEndList=new Un,arguments.length===0)this._nodes=new Lf(new jv);else if(arguments.length===1){var e=arguments[0];this._nodes=new Lf(e)}};po.prototype.printEdges=function(e){var t=this;e.println("Edges:");for(var i=0;i<this._edges.size();i++){e.println("edge "+i+":");var r=t._edges.get(i);r.print(e),r.eiList.print(e)}};po.prototype.find=function(e){return this._nodes.find(e)};po.prototype.addNode=function(){if(arguments[0]instanceof wI){var e=arguments[0];return this._nodes.addNode(e)}else if(arguments[0]instanceof mt){var t=arguments[0];return this._nodes.addNode(t)}};po.prototype.getNodeIterator=function(){return this._nodes.iterator()};po.prototype.linkResultDirectedEdges=function(){for(var e=this._nodes.iterator();e.hasNext();){var t=e.next();t.getEdges().linkResultDirectedEdges()}};po.prototype.debugPrintln=function(e){Wa.out.println(e)};po.prototype.isBoundaryNode=function(e,t){var i=this._nodes.find(t);if(i===null)return!1;var r=i.getLabel();return r!==null&&r.getLocation(e)===wt.BOUNDARY};po.prototype.linkAllDirectedEdges=function(){for(var e=this._nodes.iterator();e.hasNext();){var t=e.next();t.getEdges().linkAllDirectedEdges()}};po.prototype.matchInSameDirection=function(e,t,i,r){return e.equals(i)?Jn.computeOrientation(e,t,r)===Jn.COLLINEAR&&ws.quadrant(e,t)===ws.quadrant(i,r):!1};po.prototype.getEdgeEnds=function(){return this._edgeEndList};po.prototype.debugPrint=function(e){Wa.out.print(e)};po.prototype.getEdgeIterator=function(){return this._edges.iterator()};po.prototype.findEdgeInSameDirection=function(e,t){for(var i=this,r=0;r<this._edges.size();r++){var a=i._edges.get(r),l=a.getCoordinates();if(i.matchInSameDirection(e,t,l[0],l[1])||i.matchInSameDirection(e,t,l[l.length-1],l[l.length-2]))return a}return null};po.prototype.insertEdge=function(e){this._edges.add(e)};po.prototype.findEdgeEnd=function(e){for(var t=this.getEdgeEnds().iterator();t.hasNext();){var i=t.next();if(i.getEdge()===e)return i}return null};po.prototype.addEdges=function(e){for(var t=this,i=e.iterator();i.hasNext();){var r=i.next();t._edges.add(r);var a=new tS(r,!0),l=new tS(r,!1);a.setSym(l),l.setSym(a),t.add(a),t.add(l)}};po.prototype.add=function(e){this._nodes.add(e),this._edgeEndList.add(e)};po.prototype.getNodes=function(){return this._nodes.values()};po.prototype.findEdge=function(e,t){for(var i=this,r=0;r<this._edges.size();r++){var a=i._edges.get(r),l=a.getCoordinates();if(e.equals(l[0])&&t.equals(l[1]))return a}return null};po.prototype.interfaces_=function(){return[]};po.prototype.getClass=function(){return po};po.linkResultDirectedEdges=function(e){for(var t=e.iterator();t.hasNext();){var i=t.next();i.getEdges().linkResultDirectedEdges()}};var Mu=function(){this._geometryFactory=null,this._shellList=new Un;var e=arguments[0];this._geometryFactory=e};Mu.prototype.sortShellsAndHoles=function(e,t,i){for(var r=e.iterator();r.hasNext();){var a=r.next();a.isHole()?i.add(a):t.add(a)}};Mu.prototype.computePolygons=function(e){for(var t=this,i=new Un,r=e.iterator();r.hasNext();){var a=r.next(),l=a.toPolygon(t._geometryFactory);i.add(l)}return i};Mu.prototype.placeFreeHoles=function(e,t){for(var i=this,r=t.iterator();r.hasNext();){var a=r.next();if(a.getShell()===null){var l=i.findEdgeRingContaining(a,e);if(l===null)throw new gp("unable to assign hole to a shell",a.getCoordinate(0));a.setShell(l)}}};Mu.prototype.buildMinimalEdgeRings=function(e,t,i){for(var r=this,a=new Un,l=e.iterator();l.hasNext();){var s=l.next();if(s.getMaxNodeDegree()>2){s.linkDirectedEdgesForMinimalEdgeRings();var d=s.buildMinimalRings(),g=r.findShell(d);g!==null?(r.placePolygonHoles(g,d),t.add(g)):i.addAll(d)}else a.add(s)}return a};Mu.prototype.containsPoint=function(e){for(var t=this._shellList.iterator();t.hasNext();){var i=t.next();if(i.containsPoint(e))return!0}return!1};Mu.prototype.buildMaximalEdgeRings=function(e){for(var t=this,i=new Un,r=e.iterator();r.hasNext();){var a=r.next();if(a.isInResult()&&a.getLabel().isArea()&&a.getEdgeRing()===null){var l=new X5(a,t._geometryFactory);i.add(l),l.setInResult()}}return i};Mu.prototype.placePolygonHoles=function(e,t){for(var i=t.iterator();i.hasNext();){var r=i.next();r.isHole()&&r.setShell(e)}};Mu.prototype.getPolygons=function(){var e=this.computePolygons(this._shellList);return e};Mu.prototype.findEdgeRingContaining=function(e,t){for(var i=e.getLinearRing(),r=i.getEnvelopeInternal(),a=i.getCoordinateN(0),l=null,s=null,d=t.iterator();d.hasNext();){var g=d.next(),x=g.getLinearRing(),I=x.getEnvelopeInternal();l!==null&&(s=l.getLinearRing().getEnvelopeInternal());var A=!1;I.contains(r)&&Jn.isPointInRing(a,x.getCoordinates())&&(A=!0),A&&(l===null||s.contains(I))&&(l=g)}return l};Mu.prototype.findShell=function(e){for(var t=0,i=null,r=e.iterator();r.hasNext();){var a=r.next();a.isHole()||(i=a,t++)}return dr.isTrue(t<=1,"found two shells in MinimalEdgeRing list"),i};Mu.prototype.add=function(){if(arguments.length===1){var e=arguments[0];this.add(e.getEdgeEnds(),e.getNodes())}else if(arguments.length===2){var t=arguments[0],i=arguments[1];po.linkResultDirectedEdges(i);var r=this.buildMaximalEdgeRings(t),a=new Un,l=this.buildMinimalEdgeRings(r,this._shellList,a);this.sortShellsAndHoles(l,this._shellList,a),this.placeFreeHoles(this._shellList,a)}};Mu.prototype.interfaces_=function(){return[]};Mu.prototype.getClass=function(){return Mu};var qv=function(){};qv.prototype.getBounds=function(){};qv.prototype.interfaces_=function(){return[]};qv.prototype.getClass=function(){return qv};var Ah=function(){this._bounds=null,this._item=null;var e=arguments[0],t=arguments[1];this._bounds=e,this._item=t};Ah.prototype.getItem=function(){return this._item};Ah.prototype.getBounds=function(){return this._bounds};Ah.prototype.interfaces_=function(){return[qv,Jc]};Ah.prototype.getClass=function(){return Ah};var _p=function(){this._size=null,this._items=null,this._size=0,this._items=new Un,this._items.add(null)};_p.prototype.poll=function(){if(this.isEmpty())return null;var e=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),e};_p.prototype.size=function(){return this._size};_p.prototype.reorder=function(e){for(var t=this,i=null,r=this._items.get(e);e*2<=this._size&&(i=e*2,i!==t._size&&t._items.get(i+1).compareTo(t._items.get(i))<0&&i++,t._items.get(i).compareTo(r)<0);e=i)t._items.set(e,t._items.get(i));this._items.set(e,r)};_p.prototype.clear=function(){this._size=0,this._items.clear()};_p.prototype.isEmpty=function(){return this._size===0};_p.prototype.add=function(e){var t=this;this._items.add(null),this._size+=1;var i=this._size;for(this._items.set(0,e);e.compareTo(this._items.get(Math.trunc(i/2)))<0;i/=2)t._items.set(i,t._items.get(Math.trunc(i/2)));this._items.set(i,e)};_p.prototype.interfaces_=function(){return[]};_p.prototype.getClass=function(){return _p};var hm=function(){};hm.prototype.visitItem=function(e){};hm.prototype.interfaces_=function(){return[]};hm.prototype.getClass=function(){return hm};var L_=function(){};L_.prototype.insert=function(e,t){};L_.prototype.remove=function(e,t){};L_.prototype.query=function(){};L_.prototype.interfaces_=function(){return[]};L_.prototype.getClass=function(){return L_};var ra=function(){if(this._childBoundables=new Un,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this._level=e}}},dR={serialVersionUID:{configurable:!0}};ra.prototype.getLevel=function(){return this._level};ra.prototype.size=function(){return this._childBoundables.size()};ra.prototype.getChildBoundables=function(){return this._childBoundables};ra.prototype.addChildBoundable=function(e){dr.isTrue(this._bounds===null),this._childBoundables.add(e)};ra.prototype.isEmpty=function(){return this._childBoundables.isEmpty()};ra.prototype.getBounds=function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds};ra.prototype.interfaces_=function(){return[qv,Jc]};ra.prototype.getClass=function(){return ra};dR.serialVersionUID.get=function(){return 6493722185909574e3};Object.defineProperties(ra,dR);var Mh=function(){};Mh.reverseOrder=function(){return{compare:function(t,i){return i.compareTo(t)}}};Mh.min=function(e){return Mh.sort(e),e.get(0)};Mh.sort=function(e,t){var i=e.toArray();t?rg.sort(i,t):rg.sort(i);for(var r=e.iterator(),a=0,l=i.length;a<l;a++)r.next(),r.set(i[a])};Mh.singletonList=function(e){var t=new Un;return t.add(e),t};var Go=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var e=arguments[0],t=arguments[1],i=arguments[2];this._boundable1=e,this._boundable2=t,this._itemDistance=i,this._distance=this.distance()};Go.prototype.expandToQueue=function(e,t){var i=Go.isComposite(this._boundable1),r=Go.isComposite(this._boundable2);if(i&&r)return Go.area(this._boundable1)>Go.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,e,t),null):(this.expand(this._boundable2,this._boundable1,e,t),null);if(i)return this.expand(this._boundable1,this._boundable2,e,t),null;if(r)return this.expand(this._boundable2,this._boundable1,e,t),null;throw new io("neither boundable is composite")};Go.prototype.isLeaves=function(){return!(Go.isComposite(this._boundable1)||Go.isComposite(this._boundable2))};Go.prototype.compareTo=function(e){var t=e;return this._distance<t._distance?-1:this._distance>t._distance?1:0};Go.prototype.expand=function(e,t,i,r){for(var a=this,l=e.getChildBoundables(),s=l.iterator();s.hasNext();){var d=s.next(),g=new Go(d,t,a._itemDistance);g.getDistance()<r&&i.add(g)}};Go.prototype.getBoundable=function(e){return e===0?this._boundable1:this._boundable2};Go.prototype.getDistance=function(){return this._distance};Go.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())};Go.prototype.interfaces_=function(){return[Kc]};Go.prototype.getClass=function(){return Go};Go.area=function(e){return e.getBounds().getArea()};Go.isComposite=function(e){return e instanceof ra};var Sa=function n(){if(this._root=null,this._built=!1,this._itemBoundables=new Un,this._nodeCapacity=null,arguments.length===0){var e=n.DEFAULT_NODE_CAPACITY;this._nodeCapacity=e}else if(arguments.length===1){var t=arguments[0];dr.isTrue(t>1,"Node capacity must be greater than 1"),this._nodeCapacity=t}},SI={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};Sa.prototype.getNodeCapacity=function(){return this._nodeCapacity};Sa.prototype.lastNode=function(e){return e.get(e.size()-1)};Sa.prototype.size=function(){var e=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var t=arguments[0],i=0,r=t.getChildBoundables().iterator();r.hasNext();){var a=r.next();a instanceof ra?i+=e.size(a):a instanceof Ah&&(i+=1)}return i}};Sa.prototype.removeItem=function(e,t){for(var i=null,r=e.getChildBoundables().iterator();r.hasNext();){var a=r.next();a instanceof Ah&&a.getItem()===t&&(i=a)}return i!==null?(e.getChildBoundables().remove(i),!0):!1};Sa.prototype.itemsTree=function(){var e=this;if(arguments.length===0){this.build();var t=this.itemsTree(this._root);return t===null?new Un:t}else if(arguments.length===1){for(var i=arguments[0],r=new Un,a=i.getChildBoundables().iterator();a.hasNext();){var l=a.next();if(l instanceof ra){var s=e.itemsTree(l);s!==null&&r.add(s)}else l instanceof Ah?r.add(l.getItem()):dr.shouldNeverReachHere()}return r.size()<=0?null:r}};Sa.prototype.insert=function(e,t){dr.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Ah(e,t))};Sa.prototype.boundablesAtLevel=function(){var e=this;if(arguments.length===1){var t=arguments[0],i=new Un;return this.boundablesAtLevel(t,this._root,i),i}else if(arguments.length===3){var r=arguments[0],a=arguments[1],l=arguments[2];if(dr.isTrue(r>-2),a.getLevel()===r)return l.add(a),null;for(var s=a.getChildBoundables().iterator();s.hasNext();){var d=s.next();d instanceof ra?e.boundablesAtLevel(r,d,l):(dr.isTrue(d instanceof Ah),r===-1&&l.add(d))}return null}};Sa.prototype.query=function(){var e=this;if(arguments.length===1){var t=arguments[0];this.build();var i=new Un;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.query(t,this._root,i),i}else if(arguments.length===2){var r=arguments[0],a=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),r)&&this.query(r,this._root,a)}else if(arguments.length===3){if(Hi(arguments[2],hm)&&arguments[0]instanceof Object&&arguments[1]instanceof ra)for(var l=arguments[0],s=arguments[1],d=arguments[2],g=s.getChildBoundables(),x=0;x<g.size();x++){var I=g.get(x);e.getIntersectsOp().intersects(I.getBounds(),l)&&(I instanceof ra?e.query(l,I,d):I instanceof Ah?d.visitItem(I.getItem()):dr.shouldNeverReachHere())}else if(Hi(arguments[2],Th)&&arguments[0]instanceof Object&&arguments[1]instanceof ra)for(var A=arguments[0],L=arguments[1],N=arguments[2],B=L.getChildBoundables(),F=0;F<B.size();F++){var z=B.get(F);e.getIntersectsOp().intersects(z.getBounds(),A)&&(z instanceof ra?e.query(A,z,N):z instanceof Ah?N.add(z.getItem()):dr.shouldNeverReachHere())}}};Sa.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0};Sa.prototype.getRoot=function(){return this.build(),this._root};Sa.prototype.remove=function(){var e=this;if(arguments.length===2){var t=arguments[0],i=arguments[1];return this.build(),this.getIntersectsOp().intersects(this._root.getBounds(),t)?this.remove(t,this._root,i):!1}else if(arguments.length===3){var r=arguments[0],a=arguments[1],l=arguments[2],s=this.removeItem(a,l);if(s)return!0;for(var d=null,g=a.getChildBoundables().iterator();g.hasNext();){var x=g.next();if(e.getIntersectsOp().intersects(x.getBounds(),r)&&x instanceof ra&&(s=e.remove(r,x,l),s)){d=x;break}}return d!==null&&d.getChildBoundables().isEmpty()&&a.getChildBoundables().remove(d),s}};Sa.prototype.createHigherLevels=function(e,t){dr.isTrue(!e.isEmpty());var i=this.createParentBoundables(e,t+1);return i.size()===1?i.get(0):this.createHigherLevels(i,t+1)};Sa.prototype.depth=function(){var e=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var t=arguments[0],i=0,r=t.getChildBoundables().iterator();r.hasNext();){var a=r.next();if(a instanceof ra){var l=e.depth(a);l>i&&(i=l)}}return i+1}};Sa.prototype.createParentBoundables=function(e,t){var i=this;dr.isTrue(!e.isEmpty());var r=new Un;r.add(this.createNode(t));var a=new Un(e);Mh.sort(a,this.getComparator());for(var l=a.iterator();l.hasNext();){var s=l.next();i.lastNode(r).getChildBoundables().size()===i.getNodeCapacity()&&r.add(i.createNode(t)),i.lastNode(r).addChildBoundable(s)}return r};Sa.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()};Sa.prototype.interfaces_=function(){return[Jc]};Sa.prototype.getClass=function(){return Sa};Sa.compareDoubles=function(e,t){return e>t?1:e<t?-1:0};SI.IntersectsOp.get=function(){return Z5};SI.serialVersionUID.get=function(){return-3886435814360241e3};SI.DEFAULT_NODE_CAPACITY.get=function(){return 10};Object.defineProperties(Sa,SI);var Z5=function(){},Wv=function(){};Wv.prototype.distance=function(e,t){};Wv.prototype.interfaces_=function(){return[]};Wv.prototype.getClass=function(){return Wv};var pR=function(n){function e(i){i=i||e.DEFAULT_NODE_CAPACITY,n.call(this,i)}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return e.prototype.createParentBoundablesFromVerticalSlices=function(r,a){var l=this;dr.isTrue(r.length>0);for(var s=new Un,d=0;d<r.length;d++)s.addAll(l.createParentBoundablesFromVerticalSlice(r[d],a));return s},e.prototype.createNode=function(r){return new oA(r)},e.prototype.size=function(){return arguments.length===0?n.prototype.size.call(this):n.prototype.size.apply(this,arguments)},e.prototype.insert=function(){if(arguments.length===2){var r=arguments[0],a=arguments[1];if(r.isNull())return null;n.prototype.insert.call(this,r,a)}else return n.prototype.insert.apply(this,arguments)},e.prototype.getIntersectsOp=function(){return e.intersectsOp},e.prototype.verticalSlices=function(r,a){for(var l=Math.trunc(Math.ceil(r.size()/a)),s=new Array(a).fill(null),d=r.iterator(),g=0;g<a;g++){s[g]=new Un;for(var x=0;d.hasNext()&&x<l;){var I=d.next();s[g].add(I),x++}}return s},e.prototype.query=function(){if(arguments.length===1){var r=arguments[0];return n.prototype.query.call(this,r)}else if(arguments.length===2){var a=arguments[0],l=arguments[1];n.prototype.query.call(this,a,l)}else if(arguments.length===3){if(Hi(arguments[2],hm)&&arguments[0]instanceof Object&&arguments[1]instanceof ra){var s=arguments[0],d=arguments[1],g=arguments[2];n.prototype.query.call(this,s,d,g)}else if(Hi(arguments[2],Th)&&arguments[0]instanceof Object&&arguments[1]instanceof ra){var x=arguments[0],I=arguments[1],A=arguments[2];n.prototype.query.call(this,x,I,A)}}},e.prototype.getComparator=function(){return e.yComparator},e.prototype.createParentBoundablesFromVerticalSlice=function(r,a){return n.prototype.createParentBoundables.call(this,r,a)},e.prototype.remove=function(){if(arguments.length===2){var r=arguments[0],a=arguments[1];return n.prototype.remove.call(this,r,a)}else return n.prototype.remove.apply(this,arguments)},e.prototype.depth=function(){return arguments.length===0?n.prototype.depth.call(this):n.prototype.depth.apply(this,arguments)},e.prototype.createParentBoundables=function(r,a){dr.isTrue(!r.isEmpty());var l=Math.trunc(Math.ceil(r.size()/this.getNodeCapacity())),s=new Un(r);Mh.sort(s,e.xComparator);var d=this.verticalSlices(s,Math.trunc(Math.ceil(Math.sqrt(l))));return this.createParentBoundablesFromVerticalSlices(d,a)},e.prototype.nearestNeighbour=function(){if(arguments.length===1){if(Hi(arguments[0],Wv)){var r=arguments[0],a=new Go(this.getRoot(),this.getRoot(),r);return this.nearestNeighbour(a)}else if(arguments[0]instanceof Go){var l=arguments[0];return this.nearestNeighbour(l,rr.POSITIVE_INFINITY)}}else if(arguments.length===2){if(arguments[0]instanceof e&&Hi(arguments[1],Wv)){var s=arguments[0],d=arguments[1],g=new Go(this.getRoot(),s.getRoot(),d);return this.nearestNeighbour(g)}else if(arguments[0]instanceof Go&&typeof arguments[1]=="number"){var x=arguments[0],I=arguments[1],A=I,L=null,N=new _p;for(N.add(x);!N.isEmpty()&&A>0;){var B=N.poll(),F=B.getDistance();if(F>=A)break;B.isLeaves()?(A=F,L=B):B.expandToQueue(N,A)}return[L.getBoundable(0).getItem(),L.getBoundable(1).getItem()]}}else if(arguments.length===3){var z=arguments[0],V=arguments[1],Y=arguments[2],Q=new Ah(z,V),J=new Go(this.getRoot(),Q,Y);return this.nearestNeighbour(J)[0]}},e.prototype.interfaces_=function(){return[L_,Jc]},e.prototype.getClass=function(){return e},e.centreX=function(r){return e.avg(r.getMinX(),r.getMaxX())},e.avg=function(r,a){return(r+a)/2},e.centreY=function(r){return e.avg(r.getMinY(),r.getMaxY())},t.STRtreeNode.get=function(){return oA},t.serialVersionUID.get=function(){return 0x39920f7d5f261e0},t.xComparator.get=function(){return{interfaces_:function(){return[kv]},compare:function(i,r){return n.compareDoubles(e.centreX(i.getBounds()),e.centreX(r.getBounds()))}}},t.yComparator.get=function(){return{interfaces_:function(){return[kv]},compare:function(i,r){return n.compareDoubles(e.centreY(i.getBounds()),e.centreY(r.getBounds()))}}},t.intersectsOp.get=function(){return{interfaces_:function(){return[n.IntersectsOp]},intersects:function(i,r){return i.intersects(r)}}},t.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(e,t),e}(Sa),oA=function(n){function e(){var t=arguments[0];n.call(this,t)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.computeBounds=function(){for(var i=null,r=this.getChildBoundables().iterator();r.hasNext();){var a=r.next();i===null?i=new Ii(a.getBounds()):i.expandToInclude(a.getBounds())}return i},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(ra),tu=function(){};tu.prototype.interfaces_=function(){return[]};tu.prototype.getClass=function(){return tu};tu.relativeSign=function(e,t){return e<t?-1:e>t?1:0};tu.compare=function(e,t,i){if(t.equals2D(i))return 0;var r=tu.relativeSign(t.x,i.x),a=tu.relativeSign(t.y,i.y);switch(e){case 0:return tu.compareValue(r,a);case 1:return tu.compareValue(a,r);case 2:return tu.compareValue(a,-r);case 3:return tu.compareValue(-r,a);case 4:return tu.compareValue(-r,-a);case 5:return tu.compareValue(-a,-r);case 6:return tu.compareValue(-a,r);case 7:return tu.compareValue(r,-a)}return dr.shouldNeverReachHere("invalid octant value"),0};tu.compareValue=function(e,t){return e<0?-1:e>0?1:t<0?-1:t>0?1:0};var fm=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var e=arguments[0],t=arguments[1],i=arguments[2],r=arguments[3];this._segString=e,this.coord=new mt(t),this.segmentIndex=i,this._segmentOctant=r,this._isInterior=!t.equals2D(e.getCoordinate(i))};fm.prototype.getCoordinate=function(){return this.coord};fm.prototype.print=function(e){e.print(this.coord),e.print(" seg # = "+this.segmentIndex)};fm.prototype.compareTo=function(e){var t=e;return this.segmentIndex<t.segmentIndex?-1:this.segmentIndex>t.segmentIndex?1:this.coord.equals2D(t.coord)?0:tu.compare(this._segmentOctant,this.coord,t.coord)};fm.prototype.isEndPoint=function(e){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===e};fm.prototype.isInterior=function(){return this._isInterior};fm.prototype.interfaces_=function(){return[Kc]};fm.prototype.getClass=function(){return fm};var Fl=function(){this._nodeMap=new yl,this._edge=null;var e=arguments[0];this._edge=e};Fl.prototype.getSplitCoordinates=function(){var e=this,t=new mb;this.addEndpoints();for(var i=this.iterator(),r=i.next();i.hasNext();){var a=i.next();e.addEdgeCoordinates(r,a,t),r=a}return t.toCoordinateArray()};Fl.prototype.addCollapsedNodes=function(){var e=this,t=new Un;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var i=t.iterator();i.hasNext();){var r=i.next().intValue();e.add(e._edge.getCoordinate(r),r)}};Fl.prototype.print=function(e){e.println("Intersections:");for(var t=this.iterator();t.hasNext();){var i=t.next();i.print(e)}};Fl.prototype.findCollapsesFromExistingVertices=function(e){for(var t=this,i=0;i<this._edge.size()-2;i++){var r=t._edge.getCoordinate(i),a=t._edge.getCoordinate(i+2);r.equals2D(a)&&e.add(new wf(i+1))}};Fl.prototype.addEdgeCoordinates=function(e,t,i){var r=this,a=this._edge.getCoordinate(t.segmentIndex),l=t.isInterior()||!t.coord.equals2D(a);i.add(new mt(e.coord),!1);for(var s=e.segmentIndex+1;s<=t.segmentIndex;s++)i.add(r._edge.getCoordinate(s));l&&i.add(new mt(t.coord))};Fl.prototype.iterator=function(){return this._nodeMap.values().iterator()};Fl.prototype.addSplitEdges=function(e){var t=this;this.addEndpoints(),this.addCollapsedNodes();for(var i=this.iterator(),r=i.next();i.hasNext();){var a=i.next(),l=t.createSplitEdge(r,a);e.add(l),r=a}};Fl.prototype.findCollapseIndex=function(e,t,i){if(!e.coord.equals2D(t.coord))return!1;var r=t.segmentIndex-e.segmentIndex;return t.isInterior()||r--,r===1?(i[0]=e.segmentIndex+1,!0):!1};Fl.prototype.findCollapsesFromInsertedNodes=function(e){for(var t=this,i=new Array(1).fill(null),r=this.iterator(),a=r.next();r.hasNext();){var l=r.next(),s=t.findCollapseIndex(a,l,i);s&&e.add(new wf(i[0])),a=l}};Fl.prototype.getEdge=function(){return this._edge};Fl.prototype.addEndpoints=function(){var e=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(e),e)};Fl.prototype.createSplitEdge=function(e,t){var i=this,r=t.segmentIndex-e.segmentIndex+2,a=this._edge.getCoordinate(t.segmentIndex),l=t.isInterior()||!t.coord.equals2D(a);l||r--;var s=new Array(r).fill(null),d=0;s[d++]=new mt(e.coord);for(var g=e.segmentIndex+1;g<=t.segmentIndex;g++)s[d++]=i._edge.getCoordinate(g);return l&&(s[d]=new mt(t.coord)),new Oo(s,this._edge.getData())};Fl.prototype.add=function(e,t){var i=new fm(this._edge,e,t,this._edge.getSegmentOctant(t)),r=this._nodeMap.get(i);return r!==null?(dr.isTrue(r.coord.equals2D(e),"Found equal nodes with different coordinates"),r):(this._nodeMap.put(i,i),i)};Fl.prototype.checkSplitEdgesCorrectness=function(e){var t=this._edge.getCoordinates(),i=e.get(0),r=i.getCoordinate(0);if(!r.equals2D(t[0]))throw new pp("bad split edge start point at "+r);var a=e.get(e.size()-1),l=a.getCoordinates(),s=l[l.length-1];if(!s.equals2D(t[t.length-1]))throw new pp("bad split edge end point at "+s)};Fl.prototype.interfaces_=function(){return[]};Fl.prototype.getClass=function(){return Fl};var R_=function(){};R_.prototype.interfaces_=function(){return[]};R_.prototype.getClass=function(){return R_};R_.octant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],t=arguments[1];if(e===0&&t===0)throw new io("Cannot compute the octant for point ( "+e+", "+t+" )");var i=Math.abs(e),r=Math.abs(t);return e>=0?t>=0?i>=r?0:1:i>=r?7:6:t>=0?i>=r?3:2:i>=r?4:5}else if(arguments[0]instanceof mt&&arguments[1]instanceof mt){var a=arguments[0],l=arguments[1],s=l.x-a.x,d=l.y-a.y;if(s===0&&d===0)throw new io("Cannot compute the octant for two identical points "+a);return R_.octant(s,d)}};var bd=function(){};bd.prototype.getCoordinates=function(){};bd.prototype.size=function(){};bd.prototype.getCoordinate=function(e){};bd.prototype.isClosed=function(){};bd.prototype.setData=function(e){};bd.prototype.getData=function(){};bd.prototype.interfaces_=function(){return[]};bd.prototype.getClass=function(){return bd};var K1=function(){};K1.prototype.addIntersection=function(e,t){};K1.prototype.interfaces_=function(){return[bd]};K1.prototype.getClass=function(){return K1};var Oo=function(){this._nodeList=new Fl(this),this._pts=null,this._data=null;var e=arguments[0],t=arguments[1];this._pts=e,this._data=t};Oo.prototype.getCoordinates=function(){return this._pts};Oo.prototype.size=function(){return this._pts.length};Oo.prototype.getCoordinate=function(e){return this._pts[e]};Oo.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};Oo.prototype.getSegmentOctant=function(e){return e===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(e),this.getCoordinate(e+1))};Oo.prototype.setData=function(e){this._data=e};Oo.prototype.safeOctant=function(e,t){return e.equals2D(t)?0:R_.octant(e,t)};Oo.prototype.getData=function(){return this._data};Oo.prototype.addIntersection=function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];this.addIntersectionNode(e,t)}else if(arguments.length===4){var i=arguments[0],r=arguments[1],a=arguments[3],l=new mt(i.getIntersection(a));this.addIntersection(l,r)}};Oo.prototype.toString=function(){return Sh.toLineString(new Ro(this._pts))};Oo.prototype.getNodeList=function(){return this._nodeList};Oo.prototype.addIntersectionNode=function(e,t){var i=t,r=i+1;if(r<this._pts.length){var a=this._pts[r];e.equals2D(a)&&(i=r)}var l=this._nodeList.add(e,i);return l};Oo.prototype.addIntersections=function(e,t,i){for(var r=this,a=0;a<e.getIntersectionNum();a++)r.addIntersection(e,t,i,a)};Oo.prototype.interfaces_=function(){return[K1]};Oo.prototype.getClass=function(){return Oo};Oo.getNodedSubstrings=function(){if(arguments.length===1){var e=arguments[0],t=new Un;return Oo.getNodedSubstrings(e,t),t}else if(arguments.length===2)for(var i=arguments[0],r=arguments[1],a=i.iterator();a.hasNext();){var l=a.next();l.getNodeList().addSplitEdges(r)}};var wi=function(){if(this.p0=null,this.p1=null,arguments.length===0)this.p0=new mt,this.p1=new mt;else if(arguments.length===1){var e=arguments[0];this.p0=new mt(e.p0),this.p1=new mt(e.p1)}else if(arguments.length===2)this.p0=arguments[0],this.p1=arguments[1];else if(arguments.length===4){var t=arguments[0],i=arguments[1],r=arguments[2],a=arguments[3];this.p0=new mt(t,i),this.p1=new mt(r,a)}},mR={serialVersionUID:{configurable:!0}};wi.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)};wi.prototype.orientationIndex=function(){if(arguments[0]instanceof wi){var e=arguments[0],t=Jn.orientationIndex(this.p0,this.p1,e.p0),i=Jn.orientationIndex(this.p0,this.p1,e.p1);return t>=0&&i>=0||t<=0&&i<=0?Math.max(t,i):0}else if(arguments[0]instanceof mt){var r=arguments[0];return Jn.orientationIndex(this.p0,this.p1,r)}};wi.prototype.toGeometry=function(e){return e.createLineString([this.p0,this.p1])};wi.prototype.isVertical=function(){return this.p0.x===this.p1.x};wi.prototype.equals=function(e){if(!(e instanceof wi))return!1;var t=e;return this.p0.equals(t.p0)&&this.p1.equals(t.p1)};wi.prototype.intersection=function(e){var t=new Ig;return t.computeIntersection(this.p0,this.p1,e.p0,e.p1),t.hasIntersection()?t.getIntersection(0):null};wi.prototype.project=function(){if(arguments[0]instanceof mt){var e=arguments[0];if(e.equals(this.p0)||e.equals(this.p1))return new mt(e);var t=this.projectionFactor(e),i=new mt;return i.x=this.p0.x+t*(this.p1.x-this.p0.x),i.y=this.p0.y+t*(this.p1.y-this.p0.y),i}else if(arguments[0]instanceof wi){var r=arguments[0],a=this.projectionFactor(r.p0),l=this.projectionFactor(r.p1);if(a>=1&&l>=1||a<=0&&l<=0)return null;var s=this.project(r.p0);a<0&&(s=this.p0),a>1&&(s=this.p1);var d=this.project(r.p1);return l<0&&(d=this.p0),l>1&&(d=this.p1),new wi(s,d)}};wi.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()};wi.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)};wi.prototype.getCoordinate=function(e){return e===0?this.p0:this.p1};wi.prototype.distancePerpendicular=function(e){return Jn.distancePointLinePerpendicular(e,this.p0,this.p1)};wi.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)};wi.prototype.midPoint=function(){return wi.midPoint(this.p0,this.p1)};wi.prototype.projectionFactor=function(e){if(e.equals(this.p0))return 0;if(e.equals(this.p1))return 1;var t=this.p1.x-this.p0.x,i=this.p1.y-this.p0.y,r=t*t+i*i;if(r<=0)return rr.NaN;var a=((e.x-this.p0.x)*t+(e.y-this.p0.y)*i)/r;return a};wi.prototype.closestPoints=function(e){var t=this.intersection(e);if(t!==null)return[t,t];var i=new Array(2).fill(null),r=rr.MAX_VALUE,a=null,l=this.closestPoint(e.p0);r=l.distance(e.p0),i[0]=l,i[1]=e.p0;var s=this.closestPoint(e.p1);a=s.distance(e.p1),a<r&&(r=a,i[0]=s,i[1]=e.p1);var d=e.closestPoint(this.p0);a=d.distance(this.p0),a<r&&(r=a,i[0]=this.p0,i[1]=d);var g=e.closestPoint(this.p1);return a=g.distance(this.p1),a<r&&(r=a,i[0]=this.p1,i[1]=g),i};wi.prototype.closestPoint=function(e){var t=this.projectionFactor(e);if(t>0&&t<1)return this.project(e);var i=this.p0.distance(e),r=this.p1.distance(e);return i<r?this.p0:this.p1};wi.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)};wi.prototype.getLength=function(){return this.p0.distance(this.p1)};wi.prototype.compareTo=function(e){var t=e,i=this.p0.compareTo(t.p0);return i!==0?i:this.p1.compareTo(t.p1)};wi.prototype.reverse=function(){var e=this.p0;this.p0=this.p1,this.p1=e};wi.prototype.equalsTopo=function(e){return this.p0.equals(e.p0)&&(this.p1.equals(e.p1)||this.p0.equals(e.p1))&&this.p1.equals(e.p0)};wi.prototype.lineIntersection=function(e){try{var t=Ih.intersection(this.p0,this.p1,e.p0,e.p1);return t}catch(i){if(!(i instanceof a0))throw i}finally{}return null};wi.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)};wi.prototype.pointAlongOffset=function(e,t){var i=this.p0.x+e*(this.p1.x-this.p0.x),r=this.p0.y+e*(this.p1.y-this.p0.y),a=this.p1.x-this.p0.x,l=this.p1.y-this.p0.y,s=Math.sqrt(a*a+l*l),d=0,g=0;if(t!==0){if(s<=0)throw new Error("Cannot compute offset from zero-length line segment");d=t*a/s,g=t*l/s}var x=i-g,I=r+d,A=new mt(x,I);return A};wi.prototype.setCoordinates=function(){if(arguments.length===1){var e=arguments[0];this.setCoordinates(e.p0,e.p1)}else if(arguments.length===2){var t=arguments[0],i=arguments[1];this.p0.x=t.x,this.p0.y=t.y,this.p1.x=i.x,this.p1.y=i.y}};wi.prototype.segmentFraction=function(e){var t=this.projectionFactor(e);return t<0?t=0:(t>1||rr.isNaN(t))&&(t=1),t};wi.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"};wi.prototype.isHorizontal=function(){return this.p0.y===this.p1.y};wi.prototype.distance=function(){if(arguments[0]instanceof wi){var e=arguments[0];return Jn.distanceLineLine(this.p0,this.p1,e.p0,e.p1)}else if(arguments[0]instanceof mt){var t=arguments[0];return Jn.distancePointLine(t,this.p0,this.p1)}};wi.prototype.pointAlong=function(e){var t=new mt;return t.x=this.p0.x+e*(this.p1.x-this.p0.x),t.y=this.p0.y+e*(this.p1.y-this.p0.y),t};wi.prototype.hashCode=function(){var e=rr.doubleToLongBits(this.p0.x);e^=rr.doubleToLongBits(this.p0.y)*31;var t=Math.trunc(e)^Math.trunc(e>>32),i=rr.doubleToLongBits(this.p1.x);i^=rr.doubleToLongBits(this.p1.y)*31;var r=Math.trunc(i)^Math.trunc(i>>32);return t^r};wi.prototype.interfaces_=function(){return[Kc,Jc]};wi.prototype.getClass=function(){return wi};wi.midPoint=function(e,t){return new mt((e.x+t.x)/2,(e.y+t.y)/2)};mR.serialVersionUID.get=function(){return 0x2d2172135f411c00};Object.defineProperties(wi,mR);var J1=function(){this.tempEnv1=new Ii,this.tempEnv2=new Ii,this._overlapSeg1=new wi,this._overlapSeg2=new wi};J1.prototype.overlap=function(){if(arguments.length!==2){if(arguments.length===4){var e=arguments[0],t=arguments[1],i=arguments[2],r=arguments[3];e.getLineSegment(t,this._overlapSeg1),i.getLineSegment(r,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}};J1.prototype.interfaces_=function(){return[]};J1.prototype.getClass=function(){return J1};var Lu=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var e=arguments[0],t=arguments[1],i=arguments[2],r=arguments[3];this._pts=e,this._start=t,this._end=i,this._context=r};Lu.prototype.getLineSegment=function(e,t){t.p0=this._pts[e],t.p1=this._pts[e+1]};Lu.prototype.computeSelect=function(e,t,i,r){var a=this._pts[t],l=this._pts[i];if(r.tempEnv1.init(a,l),i-t===1)return r.select(this,t),null;if(!e.intersects(r.tempEnv1))return null;var s=Math.trunc((t+i)/2);t<s&&this.computeSelect(e,t,s,r),s<i&&this.computeSelect(e,s,i,r)};Lu.prototype.getCoordinates=function(){for(var e=this,t=new Array(this._end-this._start+1).fill(null),i=0,r=this._start;r<=this._end;r++)t[i++]=e._pts[r];return t};Lu.prototype.computeOverlaps=function(e,t){this.computeOverlapsInternal(this._start,this._end,e,e._start,e._end,t)};Lu.prototype.setId=function(e){this._id=e};Lu.prototype.select=function(e,t){this.computeSelect(e,this._start,this._end,t)};Lu.prototype.getEnvelope=function(){if(this._env===null){var e=this._pts[this._start],t=this._pts[this._end];this._env=new Ii(e,t)}return this._env};Lu.prototype.getEndIndex=function(){return this._end};Lu.prototype.getStartIndex=function(){return this._start};Lu.prototype.getContext=function(){return this._context};Lu.prototype.getId=function(){return this._id};Lu.prototype.computeOverlapsInternal=function(e,t,i,r,a,l){var s=this._pts[e],d=this._pts[t],g=i._pts[r],x=i._pts[a];if(t-e===1&&a-r===1)return l.overlap(this,e,i,r),null;if(l.tempEnv1.init(s,d),l.tempEnv2.init(g,x),!l.tempEnv1.intersects(l.tempEnv2))return null;var I=Math.trunc((e+t)/2),A=Math.trunc((r+a)/2);e<I&&(r<A&&this.computeOverlapsInternal(e,I,i,r,A,l),A<a&&this.computeOverlapsInternal(e,I,i,A,a,l)),I<t&&(r<A&&this.computeOverlapsInternal(I,t,i,r,A,l),A<a&&this.computeOverlapsInternal(I,t,i,A,a,l))};Lu.prototype.interfaces_=function(){return[]};Lu.prototype.getClass=function(){return Lu};var Tf=function(){};Tf.prototype.interfaces_=function(){return[]};Tf.prototype.getClass=function(){return Tf};Tf.getChainStartIndices=function(e){var t=0,i=new Un;i.add(new wf(t));do{var r=Tf.findChainEnd(e,t);i.add(new wf(r)),t=r}while(t<e.length-1);var a=Tf.toIntArray(i);return a};Tf.findChainEnd=function(e,t){for(var i=t;i<e.length-1&&e[i].equals2D(e[i+1]);)i++;if(i>=e.length-1)return e.length-1;for(var r=ws.quadrant(e[i],e[i+1]),a=t+1;a<e.length;){if(!e[a-1].equals2D(e[a])){var l=ws.quadrant(e[a-1],e[a]);if(l!==r)break}a++}return a-1};Tf.getChains=function(){if(arguments.length===1){var e=arguments[0];return Tf.getChains(e,null)}else if(arguments.length===2){for(var t=arguments[0],i=arguments[1],r=new Un,a=Tf.getChainStartIndices(t),l=0;l<a.length-1;l++){var s=new Lu(t,a[l],a[l+1],i);r.add(s)}return r}};Tf.toIntArray=function(e){for(var t=new Array(e.size()).fill(null),i=0;i<t.length;i++)t[i]=e.get(i).intValue();return t};var fg=function(){};fg.prototype.computeNodes=function(e){};fg.prototype.getNodedSubstrings=function(){};fg.prototype.interfaces_=function(){return[]};fg.prototype.getClass=function(){return fg};var Q1=function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this.setSegmentIntersector(e)}}};Q1.prototype.setSegmentIntersector=function(e){this._segInt=e};Q1.prototype.interfaces_=function(){return[fg]};Q1.prototype.getClass=function(){return Q1};var XS=function(n){function e(i){i?n.call(this,i):n.call(this),this._monoChains=new Un,this._index=new pR,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={SegmentOverlapAction:{configurable:!0}};return e.prototype.getMonotoneChains=function(){return this._monoChains},e.prototype.getNodedSubstrings=function(){return Oo.getNodedSubstrings(this._nodedSegStrings)},e.prototype.getIndex=function(){return this._index},e.prototype.add=function(r){for(var a=this,l=Tf.getChains(r.getCoordinates(),r),s=l.iterator();s.hasNext();){var d=s.next();d.setId(a._idCounter++),a._index.insert(d.getEnvelope(),d),a._monoChains.add(d)}},e.prototype.computeNodes=function(r){var a=this;this._nodedSegStrings=r;for(var l=r.iterator();l.hasNext();)a.add(l.next());this.intersectChains()},e.prototype.intersectChains=function(){for(var r=this,a=new aA(this._segInt),l=this._monoChains.iterator();l.hasNext();)for(var s=l.next(),d=r._index.query(s.getEnvelope()),g=d.iterator();g.hasNext();){var x=g.next();if(x.getId()>s.getId()&&(s.computeOverlaps(x,a),r._nOverlaps++),r._segInt.isDone())return null}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},t.SegmentOverlapAction.get=function(){return aA},Object.defineProperties(e,t),e}(Q1),aA=function(n){function e(){n.call(this),this._si=null;var t=arguments[0];this._si=t}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.overlap=function(){if(arguments.length===4){var i=arguments[0],r=arguments[1],a=arguments[2],l=arguments[3],s=i.getContext(),d=a.getContext();this._si.processIntersections(s,r,d,l)}else return n.prototype.overlap.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(J1),ts=function n(){if(this._quadrantSegments=n.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=n.CAP_ROUND,this._joinStyle=n.JOIN_ROUND,this._mitreLimit=n.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=n.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this.setQuadrantSegments(e)}else if(arguments.length===2){var t=arguments[0],i=arguments[1];this.setQuadrantSegments(t),this.setEndCapStyle(i)}else if(arguments.length===4){var r=arguments[0],a=arguments[1],l=arguments[2],s=arguments[3];this.setQuadrantSegments(r),this.setEndCapStyle(a),this.setJoinStyle(l),this.setMitreLimit(s)}}},Ep={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};ts.prototype.getEndCapStyle=function(){return this._endCapStyle};ts.prototype.isSingleSided=function(){return this._isSingleSided};ts.prototype.setQuadrantSegments=function(e){this._quadrantSegments=e,this._quadrantSegments===0&&(this._joinStyle=ts.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=ts.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),e<=0&&(this._quadrantSegments=1),this._joinStyle!==ts.JOIN_ROUND&&(this._quadrantSegments=ts.DEFAULT_QUADRANT_SEGMENTS)};ts.prototype.getJoinStyle=function(){return this._joinStyle};ts.prototype.setJoinStyle=function(e){this._joinStyle=e};ts.prototype.setSimplifyFactor=function(e){this._simplifyFactor=e<0?0:e};ts.prototype.getSimplifyFactor=function(){return this._simplifyFactor};ts.prototype.getQuadrantSegments=function(){return this._quadrantSegments};ts.prototype.setEndCapStyle=function(e){this._endCapStyle=e};ts.prototype.getMitreLimit=function(){return this._mitreLimit};ts.prototype.setMitreLimit=function(e){this._mitreLimit=e};ts.prototype.setSingleSided=function(e){this._isSingleSided=e};ts.prototype.interfaces_=function(){return[]};ts.prototype.getClass=function(){return ts};ts.bufferDistanceError=function(e){var t=Math.PI/2/e;return 1-Math.cos(t/2)};Ep.CAP_ROUND.get=function(){return 1};Ep.CAP_FLAT.get=function(){return 2};Ep.CAP_SQUARE.get=function(){return 3};Ep.JOIN_ROUND.get=function(){return 1};Ep.JOIN_MITRE.get=function(){return 2};Ep.JOIN_BEVEL.get=function(){return 3};Ep.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8};Ep.DEFAULT_MITRE_LIMIT.get=function(){return 5};Ep.DEFAULT_SIMPLIFY_FACTOR.get=function(){return .01};Object.defineProperties(ts,Ep);var To=function(e){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Jn.COUNTERCLOCKWISE,this._inputLine=e||null},yb={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};To.prototype.isDeletable=function(e,t,i,r){var a=this._inputLine[e],l=this._inputLine[t],s=this._inputLine[i];return!this.isConcave(a,l,s)||!this.isShallow(a,l,s,r)?!1:this.isShallowSampled(a,l,e,i,r)};To.prototype.deleteShallowConcavities=function(){for(var e=this,t=1,i=this.findNextNonDeletedIndex(t),r=this.findNextNonDeletedIndex(i),a=!1;r<this._inputLine.length;){var l=!1;e.isDeletable(t,i,r,e._distanceTol)&&(e._isDeleted[i]=To.DELETE,l=!0,a=!0),l?t=r:t=i,i=e.findNextNonDeletedIndex(t),r=e.findNextNonDeletedIndex(i)}return a};To.prototype.isShallowConcavity=function(e,t,i,r){var a=Jn.computeOrientation(e,t,i),l=a===this._angleOrientation;if(!l)return!1;var s=Jn.distancePointLine(t,e,i);return s<r};To.prototype.isShallowSampled=function(e,t,i,r,a){var l=this,s=Math.trunc((r-i)/To.NUM_PTS_TO_CHECK);s<=0&&(s=1);for(var d=i;d<r;d+=s)if(!l.isShallow(e,t,l._inputLine[d],a))return!1;return!0};To.prototype.isConcave=function(e,t,i){var r=Jn.computeOrientation(e,t,i),a=r===this._angleOrientation;return a};To.prototype.simplify=function(e){var t=this;this._distanceTol=Math.abs(e),e<0&&(this._angleOrientation=Jn.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var i=!1;do i=t.deleteShallowConcavities();while(i);return this.collapseLine()};To.prototype.findNextNonDeletedIndex=function(e){for(var t=e+1;t<this._inputLine.length&&this._isDeleted[t]===To.DELETE;)t++;return t};To.prototype.isShallow=function(e,t,i,r){var a=Jn.distancePointLine(t,e,i);return a<r};To.prototype.collapseLine=function(){for(var e=this,t=new mb,i=0;i<this._inputLine.length;i++)e._isDeleted[i]!==To.DELETE&&t.add(e._inputLine[i]);return t.toCoordinateArray()};To.prototype.interfaces_=function(){return[]};To.prototype.getClass=function(){return To};To.simplify=function(e,t){var i=new To(e);return i.simplify(t)};yb.INIT.get=function(){return 0};yb.DELETE.get=function(){return 1};yb.KEEP.get=function(){return 1};yb.NUM_PTS_TO_CHECK.get=function(){return 10};Object.defineProperties(To,yb);var ac=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Un},gR={COORDINATE_ARRAY_TYPE:{configurable:!0}};ac.prototype.getCoordinates=function(){var e=this._ptList.toArray(ac.COORDINATE_ARRAY_TYPE);return e};ac.prototype.setPrecisionModel=function(e){this._precisionModel=e};ac.prototype.addPt=function(e){var t=new mt(e);if(this._precisionModel.makePrecise(t),this.isRedundant(t))return null;this._ptList.add(t)};ac.prototype.revere=function(){};ac.prototype.addPts=function(e,t){var i=this;if(t)for(var r=0;r<e.length;r++)i.addPt(e[r]);else for(var a=e.length-1;a>=0;a--)i.addPt(e[a])};ac.prototype.isRedundant=function(e){if(this._ptList.size()<1)return!1;var t=this._ptList.get(this._ptList.size()-1),i=e.distance(t);return i<this._minimimVertexDistance};ac.prototype.toString=function(){var e=new Lr,t=e.createLineString(this.getCoordinates());return t.toString()};ac.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var e=new mt(this._ptList.get(0)),t=this._ptList.get(this._ptList.size()-1);if(e.equals(t))return null;this._ptList.add(e)};ac.prototype.setMinimumVertexDistance=function(e){this._minimimVertexDistance=e};ac.prototype.interfaces_=function(){return[]};ac.prototype.getClass=function(){return ac};gR.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)};Object.defineProperties(ac,gR);var Br=function(){},Y_={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Br.prototype.interfaces_=function(){return[]};Br.prototype.getClass=function(){return Br};Br.toDegrees=function(e){return e*180/Math.PI};Br.normalize=function(e){for(;e>Math.PI;)e-=Br.PI_TIMES_2;for(;e<=-Math.PI;)e+=Br.PI_TIMES_2;return e};Br.angle=function(){if(arguments.length===1){var e=arguments[0];return Math.atan2(e.y,e.x)}else if(arguments.length===2){var t=arguments[0],i=arguments[1],r=i.x-t.x,a=i.y-t.y;return Math.atan2(a,r)}};Br.isAcute=function(e,t,i){var r=e.x-t.x,a=e.y-t.y,l=i.x-t.x,s=i.y-t.y,d=r*l+a*s;return d>0};Br.isObtuse=function(e,t,i){var r=e.x-t.x,a=e.y-t.y,l=i.x-t.x,s=i.y-t.y,d=r*l+a*s;return d<0};Br.interiorAngle=function(e,t,i){var r=Br.angle(t,e),a=Br.angle(t,i);return Math.abs(a-r)};Br.normalizePositive=function(e){if(e<0){for(;e<0;)e+=Br.PI_TIMES_2;e>=Br.PI_TIMES_2&&(e=0)}else{for(;e>=Br.PI_TIMES_2;)e-=Br.PI_TIMES_2;e<0&&(e=0)}return e};Br.angleBetween=function(e,t,i){var r=Br.angle(t,e),a=Br.angle(t,i);return Br.diff(r,a)};Br.diff=function(e,t){var i=null;return e<t?i=t-e:i=e-t,i>Math.PI&&(i=2*Math.PI-i),i};Br.toRadians=function(e){return e*Math.PI/180};Br.getTurn=function(e,t){var i=Math.sin(t-e);return i>0?Br.COUNTERCLOCKWISE:i<0?Br.CLOCKWISE:Br.NONE};Br.angleBetweenOriented=function(e,t,i){var r=Br.angle(t,e),a=Br.angle(t,i),l=a-r;return l<=-Math.PI?l+Br.PI_TIMES_2:l>Math.PI?l-Br.PI_TIMES_2:l};Y_.PI_TIMES_2.get=function(){return 2*Math.PI};Y_.PI_OVER_2.get=function(){return Math.PI/2};Y_.PI_OVER_4.get=function(){return Math.PI/4};Y_.COUNTERCLOCKWISE.get=function(){return Jn.COUNTERCLOCKWISE};Y_.CLOCKWISE.get=function(){return Jn.CLOCKWISE};Y_.NONE.get=function(){return Jn.COLLINEAR};Object.defineProperties(Br,Y_);var Xs=function n(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new wi,this._seg1=new wi,this._offset0=new wi,this._offset1=new wi,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],t=arguments[1],i=arguments[2];this._precisionModel=e,this._bufParams=t,this._li=new Ig,this._filletAngleQuantum=Math.PI/2/t.getQuadrantSegments(),t.getQuadrantSegments()>=8&&t.getJoinStyle()===ts.JOIN_ROUND&&(this._closingSegLengthFactor=n.MAX_CLOSING_SEG_LEN_FACTOR),this.init(i)},vb={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Xs.prototype.addNextSegment=function(e,t){if(this._s0=this._s1,this._s1=this._s2,this._s2=e,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var i=Jn.computeOrientation(this._s0,this._s1,this._s2),r=i===Jn.CLOCKWISE&&this._side===Mn.LEFT||i===Jn.COUNTERCLOCKWISE&&this._side===Mn.RIGHT;i===0?this.addCollinear(t):r?this.addOutsideTurn(i,t):this.addInsideTurn(i,t)};Xs.prototype.addLineEndCap=function(e,t){var i=new wi(e,t),r=new wi;this.computeOffsetSegment(i,Mn.LEFT,this._distance,r);var a=new wi;this.computeOffsetSegment(i,Mn.RIGHT,this._distance,a);var l=t.x-e.x,s=t.y-e.y,d=Math.atan2(s,l);switch(this._bufParams.getEndCapStyle()){case ts.CAP_ROUND:this._segList.addPt(r.p1),this.addFilletArc(t,d+Math.PI/2,d-Math.PI/2,Jn.CLOCKWISE,this._distance),this._segList.addPt(a.p1);break;case ts.CAP_FLAT:this._segList.addPt(r.p1),this._segList.addPt(a.p1);break;case ts.CAP_SQUARE:var g=new mt;g.x=Math.abs(this._distance)*Math.cos(d),g.y=Math.abs(this._distance)*Math.sin(d);var x=new mt(r.p1.x+g.x,r.p1.y+g.y),I=new mt(a.p1.x+g.x,a.p1.y+g.y);this._segList.addPt(x),this._segList.addPt(I);break}};Xs.prototype.getCoordinates=function(){var e=this._segList.getCoordinates();return e};Xs.prototype.addMitreJoin=function(e,t,i,r){var a=!0,l=null;try{l=Ih.intersection(t.p0,t.p1,i.p0,i.p1);var s=r<=0?1:l.distance(e)/Math.abs(r);s>this._bufParams.getMitreLimit()&&(a=!1)}catch(d){if(d instanceof a0)l=new mt(0,0),a=!1;else throw d}finally{}a?this._segList.addPt(l):this.addLimitedMitreJoin(t,i,r,this._bufParams.getMitreLimit())};Xs.prototype.addFilletCorner=function(e,t,i,r,a){var l=t.x-e.x,s=t.y-e.y,d=Math.atan2(s,l),g=i.x-e.x,x=i.y-e.y,I=Math.atan2(x,g);r===Jn.CLOCKWISE?d<=I&&(d+=2*Math.PI):d>=I&&(d-=2*Math.PI),this._segList.addPt(t),this.addFilletArc(e,d,I,r,a),this._segList.addPt(i)};Xs.prototype.addOutsideTurn=function(e,t){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Xs.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===ts.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===ts.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(t&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,e,this._distance),this._segList.addPt(this._offset1.p0))};Xs.prototype.createSquare=function(e){this._segList.addPt(new mt(e.x+this._distance,e.y+this._distance)),this._segList.addPt(new mt(e.x+this._distance,e.y-this._distance)),this._segList.addPt(new mt(e.x-this._distance,e.y-this._distance)),this._segList.addPt(new mt(e.x-this._distance,e.y+this._distance)),this._segList.closeRing()};Xs.prototype.addSegments=function(e,t){this._segList.addPts(e,t)};Xs.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)};Xs.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)};Xs.prototype.initSideSegments=function(e,t,i){this._s1=e,this._s2=t,this._side=i,this._seg1.setCoordinates(e,t),this.computeOffsetSegment(this._seg1,i,this._distance,this._offset1)};Xs.prototype.addLimitedMitreJoin=function(e,t,i,r){var a=this._seg0.p1,l=Br.angle(a,this._seg0.p0),s=Br.angleBetweenOriented(this._seg0.p0,a,this._seg1.p1),d=s/2,g=Br.normalize(l+d),x=Br.normalize(g+Math.PI),I=r*i,A=I*Math.abs(Math.sin(d)),L=i-A,N=a.x+I*Math.cos(x),B=a.y+I*Math.sin(x),F=new mt(N,B),z=new wi(a,F),V=z.pointAlongOffset(1,L),Y=z.pointAlongOffset(1,-L);this._side===Mn.LEFT?(this._segList.addPt(V),this._segList.addPt(Y)):(this._segList.addPt(Y),this._segList.addPt(V))};Xs.prototype.computeOffsetSegment=function(e,t,i,r){var a=t===Mn.LEFT?1:-1,l=e.p1.x-e.p0.x,s=e.p1.y-e.p0.y,d=Math.sqrt(l*l+s*s),g=a*i*l/d,x=a*i*s/d;r.p0.x=e.p0.x-x,r.p0.y=e.p0.y+g,r.p1.x=e.p1.x-x,r.p1.y=e.p1.y+g};Xs.prototype.addFilletArc=function(e,t,i,r,a){var l=this,s=r===Jn.CLOCKWISE?-1:1,d=Math.abs(t-i),g=Math.trunc(d/this._filletAngleQuantum+.5);if(g<1)return null;for(var x=0,I=d/g,A=x,L=new mt;A<d;){var N=t+s*A;L.x=e.x+a*Math.cos(N),L.y=e.y+a*Math.sin(N),l._segList.addPt(L),A+=I}};Xs.prototype.addInsideTurn=function(e,t){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Xs.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var i=new mt((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(i);var r=new mt((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}};Xs.prototype.createCircle=function(e){var t=new mt(e.x+this._distance,e.y);this._segList.addPt(t),this.addFilletArc(e,0,2*Math.PI,-1,this._distance),this._segList.closeRing()};Xs.prototype.addBevelJoin=function(e,t){this._segList.addPt(e.p1),this._segList.addPt(t.p0)};Xs.prototype.init=function(e){this._distance=e,this._maxCurveSegmentError=e*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new ac,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(e*Xs.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)};Xs.prototype.addCollinear=function(e){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2);var t=this._li.getIntersectionNum();t>=2&&(this._bufParams.getJoinStyle()===ts.JOIN_BEVEL||this._bufParams.getJoinStyle()===ts.JOIN_MITRE?(e&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,Jn.CLOCKWISE,this._distance))};Xs.prototype.closeRing=function(){this._segList.closeRing()};Xs.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle};Xs.prototype.interfaces_=function(){return[]};Xs.prototype.getClass=function(){return Xs};vb.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return .001};vb.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return .001};vb.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6};vb.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80};Object.defineProperties(Xs,vb);var su=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var e=arguments[0],t=arguments[1];this._precisionModel=e,this._bufParams=t};su.prototype.getOffsetCurve=function(e,t){if(this._distance=t,t===0)return null;var i=t<0,r=Math.abs(t),a=this.getSegGen(r);e.length<=1?this.computePointCurve(e[0],a):this.computeOffsetCurve(e,i,a);var l=a.getCoordinates();return i&&Rr.reverse(l),l};su.prototype.computeSingleSidedBufferCurve=function(e,t,i){var r=this.simplifyTolerance(this._distance);if(t){i.addSegments(e,!0);var a=To.simplify(e,-r),l=a.length-1;i.initSideSegments(a[l],a[l-1],Mn.LEFT),i.addFirstSegment();for(var s=l-2;s>=0;s--)i.addNextSegment(a[s],!0)}else{i.addSegments(e,!1);var d=To.simplify(e,r),g=d.length-1;i.initSideSegments(d[0],d[1],Mn.LEFT),i.addFirstSegment();for(var x=2;x<=g;x++)i.addNextSegment(d[x],!0)}i.addLastSegment(),i.closeRing()};su.prototype.computeRingBufferCurve=function(e,t,i){var r=this.simplifyTolerance(this._distance);t===Mn.RIGHT&&(r=-r);var a=To.simplify(e,r),l=a.length-1;i.initSideSegments(a[l-1],a[0],t);for(var s=1;s<=l;s++){var d=s!==1;i.addNextSegment(a[s],d)}i.closeRing()};su.prototype.computeLineBufferCurve=function(e,t){var i=this.simplifyTolerance(this._distance),r=To.simplify(e,i),a=r.length-1;t.initSideSegments(r[0],r[1],Mn.LEFT);for(var l=2;l<=a;l++)t.addNextSegment(r[l],!0);t.addLastSegment(),t.addLineEndCap(r[a-1],r[a]);var s=To.simplify(e,-i),d=s.length-1;t.initSideSegments(s[d],s[d-1],Mn.LEFT);for(var g=d-2;g>=0;g--)t.addNextSegment(s[g],!0);t.addLastSegment(),t.addLineEndCap(s[1],s[0]),t.closeRing()};su.prototype.computePointCurve=function(e,t){switch(this._bufParams.getEndCapStyle()){case ts.CAP_ROUND:t.createCircle(e);break;case ts.CAP_SQUARE:t.createSquare(e);break}};su.prototype.getLineCurve=function(e,t){if(this._distance=t,t<0&&!this._bufParams.isSingleSided()||t===0)return null;var i=Math.abs(t),r=this.getSegGen(i);if(e.length<=1)this.computePointCurve(e[0],r);else if(this._bufParams.isSingleSided()){var a=t<0;this.computeSingleSidedBufferCurve(e,a,r)}else this.computeLineBufferCurve(e,r);var l=r.getCoordinates();return l};su.prototype.getBufferParameters=function(){return this._bufParams};su.prototype.simplifyTolerance=function(e){return e*this._bufParams.getSimplifyFactor()};su.prototype.getRingCurve=function(e,t,i){if(this._distance=i,e.length<=2)return this.getLineCurve(e,i);if(i===0)return su.copyCoordinates(e);var r=this.getSegGen(i);return this.computeRingBufferCurve(e,t,r),r.getCoordinates()};su.prototype.computeOffsetCurve=function(e,t,i){var r=this.simplifyTolerance(this._distance);if(t){var a=To.simplify(e,-r),l=a.length-1;i.initSideSegments(a[l],a[l-1],Mn.LEFT),i.addFirstSegment();for(var s=l-2;s>=0;s--)i.addNextSegment(a[s],!0)}else{var d=To.simplify(e,r),g=d.length-1;i.initSideSegments(d[0],d[1],Mn.LEFT),i.addFirstSegment();for(var x=2;x<=g;x++)i.addNextSegment(d[x],!0)}i.addLastSegment()};su.prototype.getSegGen=function(e){return new Xs(this._precisionModel,this._bufParams,e)};su.prototype.interfaces_=function(){return[]};su.prototype.getClass=function(){return su};su.copyCoordinates=function(e){for(var t=new Array(e.length).fill(null),i=0;i<t.length;i++)t[i]=new mt(e[i]);return t};var P_=function(){this._subgraphs=null,this._seg=new wi,this._cga=new Jn;var e=arguments[0];this._subgraphs=e},_R={DepthSegment:{configurable:!0}};P_.prototype.findStabbedSegments=function(){var e=this;if(arguments.length===1){for(var t=arguments[0],i=new Un,r=this._subgraphs.iterator();r.hasNext();){var a=r.next(),l=a.getEnvelope();t.y<l.getMinY()||t.y>l.getMaxY()||e.findStabbedSegments(t,a.getDirectedEdges(),i)}return i}else if(arguments.length===3){if(Hi(arguments[2],Th)&&arguments[0]instanceof mt&&arguments[1]instanceof tS)for(var s=arguments[0],d=arguments[1],g=arguments[2],x=d.getEdge().getCoordinates(),I=0;I<x.length-1;I++){e._seg.p0=x[I],e._seg.p1=x[I+1],e._seg.p0.y>e._seg.p1.y&&e._seg.reverse();var A=Math.max(e._seg.p0.x,e._seg.p1.x);if(!(A<s.x)&&!e._seg.isHorizontal()&&!(s.y<e._seg.p0.y||s.y>e._seg.p1.y)&&Jn.computeOrientation(e._seg.p0,e._seg.p1,s)!==Jn.RIGHT){var L=d.getDepth(Mn.LEFT);e._seg.p0.equals(x[I])||(L=d.getDepth(Mn.RIGHT));var N=new dg(e._seg,L);g.add(N)}}else if(Hi(arguments[2],Th)&&arguments[0]instanceof mt&&Hi(arguments[1],Th))for(var B=arguments[0],F=arguments[1],z=arguments[2],V=F.iterator();V.hasNext();){var Y=V.next();Y.isForward()&&e.findStabbedSegments(B,Y,z)}}};P_.prototype.getDepth=function(e){var t=this.findStabbedSegments(e);if(t.size()===0)return 0;var i=Mh.min(t);return i._leftDepth};P_.prototype.interfaces_=function(){return[]};P_.prototype.getClass=function(){return P_};_R.DepthSegment.get=function(){return dg};Object.defineProperties(P_,_R);var dg=function(){this._upwardSeg=null,this._leftDepth=null;var e=arguments[0],t=arguments[1];this._upwardSeg=new wi(e),this._leftDepth=t};dg.prototype.compareTo=function(e){var t=e;if(this._upwardSeg.minX()>=t._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=t._upwardSeg.minX())return-1;var i=this._upwardSeg.orientationIndex(t._upwardSeg);return i!==0||(i=-1*t._upwardSeg.orientationIndex(this._upwardSeg),i!==0)?i:this._upwardSeg.compareTo(t._upwardSeg)};dg.prototype.compareX=function(e,t){var i=e.p0.compareTo(t.p0);return i!==0?i:e.p1.compareTo(t.p1)};dg.prototype.toString=function(){return this._upwardSeg.toString()};dg.prototype.interfaces_=function(){return[Kc]};dg.prototype.getClass=function(){return dg};var is=function(e,t,i){this.p0=e||null,this.p1=t||null,this.p2=i||null};is.prototype.area=function(){return is.area(this.p0,this.p1,this.p2)};is.prototype.signedArea=function(){return is.signedArea(this.p0,this.p1,this.p2)};is.prototype.interpolateZ=function(e){if(e===null)throw new io("Supplied point is null.");return is.interpolateZ(e,this.p0,this.p1,this.p2)};is.prototype.longestSideLength=function(){return is.longestSideLength(this.p0,this.p1,this.p2)};is.prototype.isAcute=function(){return is.isAcute(this.p0,this.p1,this.p2)};is.prototype.circumcentre=function(){return is.circumcentre(this.p0,this.p1,this.p2)};is.prototype.area3D=function(){return is.area3D(this.p0,this.p1,this.p2)};is.prototype.centroid=function(){return is.centroid(this.p0,this.p1,this.p2)};is.prototype.inCentre=function(){return is.inCentre(this.p0,this.p1,this.p2)};is.prototype.interfaces_=function(){return[]};is.prototype.getClass=function(){return is};is.area=function(e,t,i){return Math.abs(((i.x-e.x)*(t.y-e.y)-(t.x-e.x)*(i.y-e.y))/2)};is.signedArea=function(e,t,i){return((i.x-e.x)*(t.y-e.y)-(t.x-e.x)*(i.y-e.y))/2};is.det=function(e,t,i,r){return e*r-t*i};is.interpolateZ=function(e,t,i,r){var a=t.x,l=t.y,s=i.x-a,d=r.x-a,g=i.y-l,x=r.y-l,I=s*x-d*g,A=e.x-a,L=e.y-l,N=(x*A-d*L)/I,B=(-g*A+s*L)/I,F=t.z+N*(i.z-t.z)+B*(r.z-t.z);return F};is.longestSideLength=function(e,t,i){var r=e.distance(t),a=t.distance(i),l=i.distance(e),s=r;return a>s&&(s=a),l>s&&(s=l),s};is.isAcute=function(e,t,i){return!(!Br.isAcute(e,t,i)||!Br.isAcute(t,i,e)||!Br.isAcute(i,e,t))};is.circumcentre=function(e,t,i){var r=i.x,a=i.y,l=e.x-r,s=e.y-a,d=t.x-r,g=t.y-a,x=2*is.det(l,s,d,g),I=is.det(s,l*l+s*s,g,d*d+g*g),A=is.det(l,l*l+s*s,d,d*d+g*g),L=r-I/x,N=a+A/x;return new mt(L,N)};is.perpendicularBisector=function(e,t){var i=t.x-e.x,r=t.y-e.y,a=new Ih(e.x+i/2,e.y+r/2,1),l=new Ih(e.x-r+i/2,e.y+i+r/2,1);return new Ih(a,l)};is.angleBisector=function(e,t,i){var r=t.distance(e),a=t.distance(i),l=r/(r+a),s=i.x-e.x,d=i.y-e.y,g=new mt(e.x+l*s,e.y+l*d);return g};is.area3D=function(e,t,i){var r=t.x-e.x,a=t.y-e.y,l=t.z-e.z,s=i.x-e.x,d=i.y-e.y,g=i.z-e.z,x=a*g-l*d,I=l*s-r*g,A=r*d-a*s,L=x*x+I*I+A*A,N=Math.sqrt(L)/2;return N};is.centroid=function(e,t,i){var r=(e.x+t.x+i.x)/3,a=(e.y+t.y+i.y)/3;return new mt(r,a)};is.inCentre=function(e,t,i){var r=t.distance(i),a=e.distance(i),l=e.distance(t),s=r+a+l,d=(r*e.x+a*t.x+l*i.x)/s,g=(r*e.y+a*t.y+l*i.y)/s;return new mt(d,g)};var Xc=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Un;var e=arguments[0],t=arguments[1],i=arguments[2];this._inputGeom=e,this._distance=t,this._curveBuilder=i};Xc.prototype.addPoint=function(e){if(this._distance<=0)return null;var t=e.getCoordinates(),i=this._curveBuilder.getLineCurve(t,this._distance);this.addCurve(i,wt.EXTERIOR,wt.INTERIOR)};Xc.prototype.addPolygon=function(e){var t=this,i=this._distance,r=Mn.LEFT;this._distance<0&&(i=-this._distance,r=Mn.RIGHT);var a=e.getExteriorRing(),l=Rr.removeRepeatedPoints(a.getCoordinates());if(this._distance<0&&this.isErodedCompletely(a,this._distance)||this._distance<=0&&l.length<3)return null;this.addPolygonRing(l,i,r,wt.EXTERIOR,wt.INTERIOR);for(var s=0;s<e.getNumInteriorRing();s++){var d=e.getInteriorRingN(s),g=Rr.removeRepeatedPoints(d.getCoordinates());t._distance>0&&t.isErodedCompletely(d,-t._distance)||t.addPolygonRing(g,i,Mn.opposite(r),wt.INTERIOR,wt.EXTERIOR)}};Xc.prototype.isTriangleErodedCompletely=function(e,t){var i=new is(e[0],e[1],e[2]),r=i.inCentre(),a=Jn.distancePointLine(r,i.p0,i.p1);return a<Math.abs(t)};Xc.prototype.addLineString=function(e){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var t=Rr.removeRepeatedPoints(e.getCoordinates()),i=this._curveBuilder.getLineCurve(t,this._distance);this.addCurve(i,wt.EXTERIOR,wt.INTERIOR)};Xc.prototype.addCurve=function(e,t,i){if(e===null||e.length<2)return null;var r=new Oo(e,new fs(0,wt.BOUNDARY,t,i));this._curveList.add(r)};Xc.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList};Xc.prototype.addPolygonRing=function(e,t,i,r,a){if(t===0&&e.length<yd.MINIMUM_VALID_SIZE)return null;var l=r,s=a;e.length>=yd.MINIMUM_VALID_SIZE&&Jn.isCCW(e)&&(l=a,s=r,i=Mn.opposite(i));var d=this._curveBuilder.getRingCurve(e,i,t);this.addCurve(d,l,s)};Xc.prototype.add=function(e){if(e.isEmpty())return null;e instanceof oa?this.addPolygon(e):e instanceof Io?this.addLineString(e):e instanceof Au?this.addPoint(e):e instanceof Hv?this.addCollection(e):e instanceof hg?this.addCollection(e):e instanceof pd?this.addCollection(e):e instanceof Nl&&this.addCollection(e)};Xc.prototype.isErodedCompletely=function(e,t){var i=e.getCoordinates();if(i.length<4)return t<0;if(i.length===4)return this.isTriangleErodedCompletely(i,t);var r=e.getEnvelopeInternal(),a=Math.min(r.getHeight(),r.getWidth());return t<0&&2*Math.abs(t)>a};Xc.prototype.addCollection=function(e){for(var t=this,i=0;i<e.getNumGeometries();i++){var r=e.getGeometryN(i);t.add(r)}};Xc.prototype.interfaces_=function(){return[]};Xc.prototype.getClass=function(){return Xc};var Xv=function(){};Xv.prototype.locate=function(e){};Xv.prototype.interfaces_=function(){return[]};Xv.prototype.getClass=function(){return Xv};var md=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var e=arguments[0];this._parent=e,this._atStart=!0,this._index=0,this._max=e.getNumGeometries()};md.prototype.next=function(){if(this._atStart)return this._atStart=!1,md.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new u0;var e=this._parent.getGeometryN(this._index++);return e instanceof Nl?(this._subcollectionIterator=new md(e),this._subcollectionIterator.next()):e};md.prototype.remove=function(){throw new Error(this.getClass().getName())};md.prototype.hasNext=function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)};md.prototype.interfaces_=function(){return[l0]};md.prototype.getClass=function(){return md};md.isAtomic=function(e){return!(e instanceof Nl)};var ic=function(){this._geom=null;var e=arguments[0];this._geom=e};ic.prototype.locate=function(e){return ic.locate(e,this._geom)};ic.prototype.interfaces_=function(){return[Xv]};ic.prototype.getClass=function(){return ic};ic.isPointInRing=function(e,t){return t.getEnvelopeInternal().intersects(e)?Jn.isPointInRing(e,t.getCoordinates()):!1};ic.containsPointInPolygon=function(e,t){if(t.isEmpty())return!1;var i=t.getExteriorRing();if(!ic.isPointInRing(e,i))return!1;for(var r=0;r<t.getNumInteriorRing();r++){var a=t.getInteriorRingN(r);if(ic.isPointInRing(e,a))return!1}return!0};ic.containsPoint=function(e,t){if(t instanceof oa)return ic.containsPointInPolygon(e,t);if(t instanceof Nl)for(var i=new md(t);i.hasNext();){var r=i.next();if(r!==t&&ic.containsPoint(e,r))return!0}return!1};ic.locate=function(e,t){return t.isEmpty()?wt.EXTERIOR:ic.containsPoint(e,t)?wt.INTERIOR:wt.EXTERIOR};var bl=function(){this._edgeMap=new yl,this._edgeList=null,this._ptInAreaLocation=[wt.NONE,wt.NONE]};bl.prototype.getNextCW=function(e){this.getEdges();var t=this._edgeList.indexOf(e),i=t-1;return t===0&&(i=this._edgeList.size()-1),this._edgeList.get(i)};bl.prototype.propagateSideLabels=function(e){for(var t=wt.NONE,i=this.iterator();i.hasNext();){var r=i.next(),a=r.getLabel();a.isArea(e)&&a.getLocation(e,Mn.LEFT)!==wt.NONE&&(t=a.getLocation(e,Mn.LEFT))}if(t===wt.NONE)return null;for(var l=t,s=this.iterator();s.hasNext();){var d=s.next(),g=d.getLabel();if(g.getLocation(e,Mn.ON)===wt.NONE&&g.setLocation(e,Mn.ON,l),g.isArea(e)){var x=g.getLocation(e,Mn.LEFT),I=g.getLocation(e,Mn.RIGHT);if(I!==wt.NONE){if(I!==l)throw new gp("side location conflict",d.getCoordinate());x===wt.NONE&&dr.shouldNeverReachHere("found single null side (at "+d.getCoordinate()+")"),l=x}else dr.isTrue(g.getLocation(e,Mn.LEFT)===wt.NONE,"found single null side"),g.setLocation(e,Mn.RIGHT,l),g.setLocation(e,Mn.LEFT,l)}}};bl.prototype.getCoordinate=function(){var e=this.iterator();if(!e.hasNext())return null;var t=e.next();return t.getCoordinate()};bl.prototype.print=function(e){Wa.out.println("EdgeEndStar:   "+this.getCoordinate());for(var t=this.iterator();t.hasNext();){var i=t.next();i.print(e)}};bl.prototype.isAreaLabelsConsistent=function(e){return this.computeEdgeEndLabels(e.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)};bl.prototype.checkAreaLabelsConsistent=function(e){var t=this.getEdges();if(t.size()<=0)return!0;var i=t.size()-1,r=t.get(i).getLabel(),a=r.getLocation(e,Mn.LEFT);dr.isTrue(a!==wt.NONE,"Found unlabelled area edge");for(var l=a,s=this.iterator();s.hasNext();){var d=s.next(),g=d.getLabel();dr.isTrue(g.isArea(e),"Found non-area edge");var x=g.getLocation(e,Mn.LEFT),I=g.getLocation(e,Mn.RIGHT);if(x===I||I!==l)return!1;l=x}return!0};bl.prototype.findIndex=function(e){var t=this;this.iterator();for(var i=0;i<this._edgeList.size();i++){var r=t._edgeList.get(i);if(r===e)return i}return-1};bl.prototype.iterator=function(){return this.getEdges().iterator()};bl.prototype.getEdges=function(){return this._edgeList===null&&(this._edgeList=new Un(this._edgeMap.values())),this._edgeList};bl.prototype.getLocation=function(e,t,i){return this._ptInAreaLocation[e]===wt.NONE&&(this._ptInAreaLocation[e]=ic.locate(t,i[e].getGeometry())),this._ptInAreaLocation[e]};bl.prototype.toString=function(){var e=new Nf;e.append("EdgeEndStar:   "+this.getCoordinate()),e.append(`
`);for(var t=this.iterator();t.hasNext();){var i=t.next();e.append(i),e.append(`
`)}return e.toString()};bl.prototype.computeEdgeEndLabels=function(e){for(var t=this.iterator();t.hasNext();){var i=t.next();i.computeLabel(e)}};bl.prototype.computeLabelling=function(e){var t=this;this.computeEdgeEndLabels(e[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var i=[!1,!1],r=this.iterator();r.hasNext();)for(var a=r.next(),l=a.getLabel(),s=0;s<2;s++)l.isLine(s)&&l.getLocation(s)===wt.BOUNDARY&&(i[s]=!0);for(var d=this.iterator();d.hasNext();)for(var g=d.next(),x=g.getLabel(),I=0;I<2;I++)if(x.isAnyNull(I)){var A=wt.NONE;if(i[I])A=wt.EXTERIOR;else{var L=g.getCoordinate();A=t.getLocation(I,L,e)}x.setAllLocationsIfNull(I,A)}};bl.prototype.getDegree=function(){return this._edgeMap.size()};bl.prototype.insertEdgeEnd=function(e,t){this._edgeMap.put(e,t),this._edgeList=null};bl.prototype.interfaces_=function(){return[]};bl.prototype.getClass=function(){return bl};var Y5=function(n){function e(){n.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.linkResultDirectedEdges=function(){var i=this;this.getResultAreaEdges();for(var r=null,a=null,l=this._SCANNING_FOR_INCOMING,s=0;s<this._resultAreaEdgeList.size();s++){var d=i._resultAreaEdgeList.get(s),g=d.getSym();if(d.getLabel().isArea())switch(r===null&&d.isInResult()&&(r=d),l){case i._SCANNING_FOR_INCOMING:if(!g.isInResult())continue;a=g,l=i._LINKING_TO_OUTGOING;break;case i._LINKING_TO_OUTGOING:if(!d.isInResult())continue;a.setNext(d),l=i._SCANNING_FOR_INCOMING;break}}if(l===this._LINKING_TO_OUTGOING){if(r===null)throw new gp("no outgoing dirEdge found",this.getCoordinate());dr.isTrue(r.isInResult(),"unable to link last incoming dirEdge"),a.setNext(r)}},e.prototype.insert=function(i){var r=i;this.insertEdgeEnd(r,r)},e.prototype.getRightmostEdge=function(){var i=this.getEdges(),r=i.size();if(r<1)return null;var a=i.get(0);if(r===1)return a;var l=i.get(r-1),s=a.getQuadrant(),d=l.getQuadrant();return ws.isNorthern(s)&&ws.isNorthern(d)?a:!ws.isNorthern(s)&&!ws.isNorthern(d)?l:a.getDy()!==0?a:l.getDy()!==0?l:(dr.shouldNeverReachHere("found two horizontal edges incident on node"),null)},e.prototype.print=function(i){Wa.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var r=this.iterator();r.hasNext();){var a=r.next();i.print("out "),a.print(i),i.println(),i.print("in "),a.getSym().print(i),i.println()}},e.prototype.getResultAreaEdges=function(){var i=this;if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Un;for(var r=this.iterator();r.hasNext();){var a=r.next();(a.isInResult()||a.getSym().isInResult())&&i._resultAreaEdgeList.add(a)}return this._resultAreaEdgeList},e.prototype.updateLabelling=function(i){for(var r=this.iterator();r.hasNext();){var a=r.next(),l=a.getLabel();l.setAllLocationsIfNull(0,i.getLocation(0)),l.setAllLocationsIfNull(1,i.getLocation(1))}},e.prototype.linkAllDirectedEdges=function(){var i=this;this.getEdges();for(var r=null,a=null,l=this._edgeList.size()-1;l>=0;l--){var s=i._edgeList.get(l),d=s.getSym();a===null&&(a=d),r!==null&&d.setNext(r),r=s}a.setNext(r)},e.prototype.computeDepths=function(){var i=this;if(arguments.length===1){var r=arguments[0],a=this.findIndex(r),l=r.getDepth(Mn.LEFT),s=r.getDepth(Mn.RIGHT),d=this.computeDepths(a+1,this._edgeList.size(),l),g=this.computeDepths(0,a,d);if(g!==s)throw new gp("depth mismatch at "+r.getCoordinate())}else if(arguments.length===3){for(var x=arguments[0],I=arguments[1],A=arguments[2],L=A,N=x;N<I;N++){var B=i._edgeList.get(N);B.setEdgeDepths(Mn.RIGHT,L),L=B.getDepth(Mn.LEFT)}return L}},e.prototype.mergeSymLabels=function(){for(var i=this.iterator();i.hasNext();){var r=i.next(),a=r.getLabel();a.merge(r.getSym().getLabel())}},e.prototype.linkMinimalDirectedEdges=function(i){for(var r=this,a=null,l=null,s=this._SCANNING_FOR_INCOMING,d=this._resultAreaEdgeList.size()-1;d>=0;d--){var g=r._resultAreaEdgeList.get(d),x=g.getSym();switch(a===null&&g.getEdgeRing()===i&&(a=g),s){case r._SCANNING_FOR_INCOMING:if(x.getEdgeRing()!==i)continue;l=x,s=r._LINKING_TO_OUTGOING;break;case r._LINKING_TO_OUTGOING:if(g.getEdgeRing()!==i)continue;l.setNextMin(g),s=r._SCANNING_FOR_INCOMING;break}}s===this._LINKING_TO_OUTGOING&&(dr.isTrue(a!==null,"found null for first outgoing dirEdge"),dr.isTrue(a.getEdgeRing()===i,"unable to link last incoming dirEdge"),l.setNextMin(a))},e.prototype.getOutgoingDegree=function(){if(arguments.length===0){for(var i=0,r=this.iterator();r.hasNext();){var a=r.next();a.isInResult()&&i++}return i}else if(arguments.length===1){for(var l=arguments[0],s=0,d=this.iterator();d.hasNext();){var g=d.next();g.getEdgeRing()===l&&s++}return s}},e.prototype.getLabel=function(){return this._label},e.prototype.findCoveredLineEdges=function(){for(var i=wt.NONE,r=this.iterator();r.hasNext();){var a=r.next(),l=a.getSym();if(!a.isLineEdge()){if(a.isInResult()){i=wt.INTERIOR;break}if(l.isInResult()){i=wt.EXTERIOR;break}}}if(i===wt.NONE)return null;for(var s=i,d=this.iterator();d.hasNext();){var g=d.next(),x=g.getSym();g.isLineEdge()?g.getEdge().setCovered(s===wt.INTERIOR):(g.isInResult()&&(s=wt.EXTERIOR),x.isInResult()&&(s=wt.INTERIOR))}},e.prototype.computeLabelling=function(i){var r=this;n.prototype.computeLabelling.call(this,i),this._label=new fs(wt.NONE);for(var a=this.iterator();a.hasNext();)for(var l=a.next(),s=l.getEdge(),d=s.getLabel(),g=0;g<2;g++){var x=d.getLocation(g);(x===wt.INTERIOR||x===wt.BOUNDARY)&&r._label.setLocation(g,wt.INTERIOR)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(bl),yR=function(n){function e(){n.apply(this,arguments)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.createNode=function(i){return new wI(i,new Y5)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(jv),dm=function n(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=n.orientation(e)};dm.prototype.compareTo=function(e){var t=e,i=dm.compareOriented(this._pts,this._orientation,t._pts,t._orientation);return i};dm.prototype.interfaces_=function(){return[Kc]};dm.prototype.getClass=function(){return dm};dm.orientation=function(e){return Rr.increasingDirection(e)===1};dm.compareOriented=function(e,t,i,r){for(var a=t?1:-1,l=r?1:-1,s=t?e.length:-1,d=r?i.length:-1,g=t?0:e.length-1,x=r?0:i.length-1;;){var I=e[g].compareTo(i[x]);if(I!==0)return I;g+=a,x+=l;var A=g===s,L=x===d;if(A&&!L)return-1;if(!A&&L)return 1;if(A&&L)return 0}};var Lh=function(){this._edges=new Un,this._ocaMap=new yl};Lh.prototype.print=function(e){var t=this;e.print("MULTILINESTRING ( ");for(var i=0;i<this._edges.size();i++){var r=t._edges.get(i);i>0&&e.print(","),e.print("(");for(var a=r.getCoordinates(),l=0;l<a.length;l++)l>0&&e.print(","),e.print(a[l].x+" "+a[l].y);e.println(")")}e.print(")  ")};Lh.prototype.addAll=function(e){for(var t=this,i=e.iterator();i.hasNext();)t.add(i.next())};Lh.prototype.findEdgeIndex=function(e){for(var t=this,i=0;i<this._edges.size();i++)if(t._edges.get(i).equals(e))return i;return-1};Lh.prototype.iterator=function(){return this._edges.iterator()};Lh.prototype.getEdges=function(){return this._edges};Lh.prototype.get=function(e){return this._edges.get(e)};Lh.prototype.findEqualEdge=function(e){var t=new dm(e.getCoordinates()),i=this._ocaMap.get(t);return i};Lh.prototype.add=function(e){this._edges.add(e);var t=new dm(e.getCoordinates());this._ocaMap.put(t,e)};Lh.prototype.interfaces_=function(){return[]};Lh.prototype.getClass=function(){return Lh};var pg=function(){};pg.prototype.processIntersections=function(e,t,i,r){};pg.prototype.isDone=function(){};pg.prototype.interfaces_=function(){return[]};pg.prototype.getClass=function(){return pg};var lc=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var e=arguments[0];this._li=e};lc.prototype.isTrivialIntersection=function(e,t,i,r){if(e===i&&this._li.getIntersectionNum()===1){if(lc.isAdjacentSegments(t,r))return!0;if(e.isClosed()){var a=e.size()-1;if(t===0&&r===a||r===0&&t===a)return!0}}return!1};lc.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};lc.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};lc.prototype.getLineIntersector=function(){return this._li};lc.prototype.hasProperIntersection=function(){return this._hasProper};lc.prototype.processIntersections=function(e,t,i,r){if(e===i&&t===r)return null;this.numTests++;var a=e.getCoordinates()[t],l=e.getCoordinates()[t+1],s=i.getCoordinates()[r],d=i.getCoordinates()[r+1];this._li.computeIntersection(a,l,s,d),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(e,t,i,r)||(this._hasIntersection=!0,e.addIntersections(this._li,t,0),i.addIntersections(this._li,r,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))};lc.prototype.hasIntersection=function(){return this._hasIntersection};lc.prototype.isDone=function(){return!1};lc.prototype.hasInteriorIntersection=function(){return this._hasInterior};lc.prototype.interfaces_=function(){return[pg]};lc.prototype.getClass=function(){return lc};lc.isAdjacentSegments=function(e,t){return Math.abs(e-t)===1};var Rf=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var e=arguments[0],t=arguments[1],i=arguments[2];this.coord=new mt(e),this.segmentIndex=t,this.dist=i};Rf.prototype.getSegmentIndex=function(){return this.segmentIndex};Rf.prototype.getCoordinate=function(){return this.coord};Rf.prototype.print=function(e){e.print(this.coord),e.print(" seg # = "+this.segmentIndex),e.println(" dist = "+this.dist)};Rf.prototype.compareTo=function(e){var t=e;return this.compare(t.segmentIndex,t.dist)};Rf.prototype.isEndPoint=function(e){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===e};Rf.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist};Rf.prototype.getDistance=function(){return this.dist};Rf.prototype.compare=function(e,t){return this.segmentIndex<e?-1:this.segmentIndex>e?1:this.dist<t?-1:this.dist>t?1:0};Rf.prototype.interfaces_=function(){return[Kc]};Rf.prototype.getClass=function(){return Rf};var xd=function(){this._nodeMap=new yl,this.edge=null;var e=arguments[0];this.edge=e};xd.prototype.print=function(e){e.println("Intersections:");for(var t=this.iterator();t.hasNext();){var i=t.next();i.print(e)}};xd.prototype.iterator=function(){return this._nodeMap.values().iterator()};xd.prototype.addSplitEdges=function(e){var t=this;this.addEndpoints();for(var i=this.iterator(),r=i.next();i.hasNext();){var a=i.next(),l=t.createSplitEdge(r,a);e.add(l),r=a}};xd.prototype.addEndpoints=function(){var e=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[e],e,0)};xd.prototype.createSplitEdge=function(e,t){var i=this,r=t.segmentIndex-e.segmentIndex+2,a=this.edge.pts[t.segmentIndex],l=t.dist>0||!t.coord.equals2D(a);l||r--;var s=new Array(r).fill(null),d=0;s[d++]=new mt(e.coord);for(var g=e.segmentIndex+1;g<=t.segmentIndex;g++)s[d++]=i.edge.pts[g];return l&&(s[d]=t.coord),new WE(s,new fs(this.edge._label))};xd.prototype.add=function(e,t,i){var r=new Rf(e,t,i),a=this._nodeMap.get(r);return a!==null?a:(this._nodeMap.put(r,r),r)};xd.prototype.isIntersection=function(e){for(var t=this.iterator();t.hasNext();){var i=t.next();if(i.coord.equals(e))return!0}return!1};xd.prototype.interfaces_=function(){return[]};xd.prototype.getClass=function(){return xd};var mg=function(){};mg.prototype.getChainStartIndices=function(e){var t=this,i=0,r=new Un;r.add(new wf(i));do{var a=t.findChainEnd(e,i);r.add(new wf(a)),i=a}while(i<e.length-1);var l=mg.toIntArray(r);return l};mg.prototype.findChainEnd=function(e,t){for(var i=ws.quadrant(e[t],e[t+1]),r=t+1;r<e.length;){var a=ws.quadrant(e[r-1],e[r]);if(a!==i)break;r++}return r-1};mg.prototype.interfaces_=function(){return[]};mg.prototype.getClass=function(){return mg};mg.toIntArray=function(e){for(var t=new Array(e.size()).fill(null),i=0;i<t.length;i++)t[i]=e.get(i).intValue();return t};var yp=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new Ii,this.env2=new Ii;var e=arguments[0];this.e=e,this.pts=e.getCoordinates();var t=new mg;this.startIndex=t.getChainStartIndices(this.pts)};yp.prototype.getCoordinates=function(){return this.pts};yp.prototype.getMaxX=function(e){var t=this.pts[this.startIndex[e]].x,i=this.pts[this.startIndex[e+1]].x;return t>i?t:i};yp.prototype.getMinX=function(e){var t=this.pts[this.startIndex[e]].x,i=this.pts[this.startIndex[e+1]].x;return t<i?t:i};yp.prototype.computeIntersectsForChain=function(){if(arguments.length===4){var e=arguments[0],t=arguments[1],i=arguments[2],r=arguments[3];this.computeIntersectsForChain(this.startIndex[e],this.startIndex[e+1],t,t.startIndex[i],t.startIndex[i+1],r)}else if(arguments.length===6){var a=arguments[0],l=arguments[1],s=arguments[2],d=arguments[3],g=arguments[4],x=arguments[5],I=this.pts[a],A=this.pts[l],L=s.pts[d],N=s.pts[g];if(l-a===1&&g-d===1)return x.addIntersections(this.e,a,s.e,d),null;if(this.env1.init(I,A),this.env2.init(L,N),!this.env1.intersects(this.env2))return null;var B=Math.trunc((a+l)/2),F=Math.trunc((d+g)/2);a<B&&(d<F&&this.computeIntersectsForChain(a,B,s,d,F,x),F<g&&this.computeIntersectsForChain(a,B,s,F,g,x)),B<l&&(d<F&&this.computeIntersectsForChain(B,l,s,d,F,x),F<g&&this.computeIntersectsForChain(B,l,s,F,g,x))}};yp.prototype.getStartIndexes=function(){return this.startIndex};yp.prototype.computeIntersects=function(e,t){for(var i=this,r=0;r<this.startIndex.length-1;r++)for(var a=0;a<e.startIndex.length-1;a++)i.computeIntersectsForChain(r,e,a,t)};yp.prototype.interfaces_=function(){return[]};yp.prototype.getClass=function(){return yp};var qa=function n(){var e=this;this._depth=Array(2).fill().map(function(){return Array(3)});for(var t=0;t<2;t++)for(var i=0;i<3;i++)e._depth[t][i]=n.NULL_VALUE},vR={NULL_VALUE:{configurable:!0}};qa.prototype.getDepth=function(e,t){return this._depth[e][t]};qa.prototype.setDepth=function(e,t,i){this._depth[e][t]=i};qa.prototype.isNull=function(){var e=this;if(arguments.length===0){for(var t=0;t<2;t++)for(var i=0;i<3;i++)if(e._depth[t][i]!==qa.NULL_VALUE)return!1;return!0}else if(arguments.length===1){var r=arguments[0];return this._depth[r][1]===qa.NULL_VALUE}else if(arguments.length===2){var a=arguments[0],l=arguments[1];return this._depth[a][l]===qa.NULL_VALUE}};qa.prototype.normalize=function(){for(var e=this,t=0;t<2;t++)if(!e.isNull(t)){var i=e._depth[t][1];e._depth[t][2]<i&&(i=e._depth[t][2]),i<0&&(i=0);for(var r=1;r<3;r++){var a=0;e._depth[t][r]>i&&(a=1),e._depth[t][r]=a}}};qa.prototype.getDelta=function(e){return this._depth[e][Mn.RIGHT]-this._depth[e][Mn.LEFT]};qa.prototype.getLocation=function(e,t){return this._depth[e][t]<=0?wt.EXTERIOR:wt.INTERIOR};qa.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]};qa.prototype.add=function(){var e=this;if(arguments.length===1)for(var t=arguments[0],i=0;i<2;i++)for(var r=1;r<3;r++){var a=t.getLocation(i,r);(a===wt.EXTERIOR||a===wt.INTERIOR)&&(e.isNull(i,r)?e._depth[i][r]=qa.depthAtLocation(a):e._depth[i][r]+=qa.depthAtLocation(a))}else if(arguments.length===3){var l=arguments[0],s=arguments[1],d=arguments[2];d===wt.INTERIOR&&this._depth[l][s]++}};qa.prototype.interfaces_=function(){return[]};qa.prototype.getClass=function(){return qa};qa.depthAtLocation=function(e){return e===wt.EXTERIOR?0:e===wt.INTERIOR?1:qa.NULL_VALUE};vR.NULL_VALUE.get=function(){return-1};Object.defineProperties(qa,vR);var WE=function(n){function e(){if(n.call(this),this.pts=null,this._env=null,this.eiList=new xd(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new qa,this._depthDelta=0,arguments.length===1){var t=arguments[0];e.call(this,t,null)}else if(arguments.length===2){var i=arguments[0],r=arguments[1];this.pts=i,this._label=r}}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.getDepth=function(){return this._depth},e.prototype.getCollapsedEdge=function(){var i=new Array(2).fill(null);i[0]=this.pts[0],i[1]=this.pts[1];var r=new e(i,fs.toLineLabel(this._label));return r},e.prototype.isIsolated=function(){return this._isIsolated},e.prototype.getCoordinates=function(){return this.pts},e.prototype.setIsolated=function(i){this._isIsolated=i},e.prototype.setName=function(i){this._name=i},e.prototype.equals=function(i){var r=this;if(!(i instanceof e))return!1;var a=i;if(this.pts.length!==a.pts.length)return!1;for(var l=!0,s=!0,d=this.pts.length,g=0;g<this.pts.length;g++)if(r.pts[g].equals2D(a.pts[g])||(l=!1),r.pts[g].equals2D(a.pts[--d])||(s=!1),!l&&!s)return!1;return!0},e.prototype.getCoordinate=function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var i=arguments[0];return this.pts[i]}},e.prototype.print=function(i){var r=this;i.print("edge "+this._name+": "),i.print("LINESTRING (");for(var a=0;a<this.pts.length;a++)a>0&&i.print(","),i.print(r.pts[a].x+" "+r.pts[a].y);i.print(")  "+this._label+" "+this._depthDelta)},e.prototype.computeIM=function(i){e.updateIM(this._label,i)},e.prototype.isCollapsed=function(){return!this._label.isArea()||this.pts.length!==3?!1:!!this.pts[0].equals(this.pts[2])},e.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},e.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},e.prototype.getDepthDelta=function(){return this._depthDelta},e.prototype.getNumPoints=function(){return this.pts.length},e.prototype.printReverse=function(i){var r=this;i.print("edge "+this._name+": ");for(var a=this.pts.length-1;a>=0;a--)i.print(r.pts[a]+" ");i.println("")},e.prototype.getMonotoneChainEdge=function(){return this._mce===null&&(this._mce=new yp(this)),this._mce},e.prototype.getEnvelope=function(){var i=this;if(this._env===null){this._env=new Ii;for(var r=0;r<this.pts.length;r++)i._env.expandToInclude(i.pts[r])}return this._env},e.prototype.addIntersection=function(i,r,a,l){var s=new mt(i.getIntersection(l)),d=r,g=i.getEdgeDistance(a,l),x=d+1;if(x<this.pts.length){var I=this.pts[x];s.equals2D(I)&&(d=x,g=0)}this.eiList.add(s,d,g)},e.prototype.toString=function(){var i=this,r=new Nf;r.append("edge "+this._name+": "),r.append("LINESTRING (");for(var a=0;a<this.pts.length;a++)a>0&&r.append(","),r.append(i.pts[a].x+" "+i.pts[a].y);return r.append(")  "+this._label+" "+this._depthDelta),r.toString()},e.prototype.isPointwiseEqual=function(i){var r=this;if(this.pts.length!==i.pts.length)return!1;for(var a=0;a<this.pts.length;a++)if(!r.pts[a].equals2D(i.pts[a]))return!1;return!0},e.prototype.setDepthDelta=function(i){this._depthDelta=i},e.prototype.getEdgeIntersectionList=function(){return this.eiList},e.prototype.addIntersections=function(i,r,a){for(var l=this,s=0;s<i.getIntersectionNum();s++)l.addIntersection(i,r,a,s)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.updateIM=function(){if(arguments.length===2){var i=arguments[0],r=arguments[1];r.setAtLeastIfValid(i.getLocation(0,Mn.ON),i.getLocation(1,Mn.ON),1),i.isArea()&&(r.setAtLeastIfValid(i.getLocation(0,Mn.LEFT),i.getLocation(1,Mn.LEFT),2),r.setAtLeastIfValid(i.getLocation(0,Mn.RIGHT),i.getLocation(1,Mn.RIGHT),2))}else return n.prototype.updateIM.apply(this,arguments)},e}(oc),Ol=function(e){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Lh,this._bufParams=e||null};Ol.prototype.setWorkingPrecisionModel=function(e){this._workingPrecisionModel=e};Ol.prototype.insertUniqueEdge=function(e){var t=this._edgeList.findEqualEdge(e);if(t!==null){var i=t.getLabel(),r=e.getLabel();t.isPointwiseEqual(e)||(r=new fs(e.getLabel()),r.flip()),i.merge(r);var a=Ol.depthDelta(r),l=t.getDepthDelta(),s=l+a;t.setDepthDelta(s)}else this._edgeList.add(e),e.setDepthDelta(Ol.depthDelta(e.getLabel()))};Ol.prototype.buildSubgraphs=function(e,t){for(var i=new Un,r=e.iterator();r.hasNext();){var a=r.next(),l=a.getRightmostCoordinate(),s=new P_(i),d=s.getDepth(l);a.computeDepth(d),a.findResultEdges(),i.add(a),t.add(a.getDirectedEdges(),a.getNodes())}};Ol.prototype.createSubgraphs=function(e){for(var t=new Un,i=e.getNodes().iterator();i.hasNext();){var r=i.next();if(!r.isVisited()){var a=new kl;a.create(r),t.add(a)}}return Mh.sort(t,Mh.reverseOrder()),t};Ol.prototype.createEmptyResultGeometry=function(){var e=this._geomFact.createPolygon();return e};Ol.prototype.getNoder=function(e){if(this._workingNoder!==null)return this._workingNoder;var t=new XS,i=new Ig;return i.setPrecisionModel(e),t.setSegmentIntersector(new lc(i)),t};Ol.prototype.buffer=function(e,t){var i=this._workingPrecisionModel;i===null&&(i=e.getPrecisionModel()),this._geomFact=e.getFactory();var r=new su(i,this._bufParams),a=new Xc(e,t,r),l=a.getCurves();if(l.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(l,i),this._graph=new po(new yR),this._graph.addEdges(this._edgeList.getEdges());var s=this.createSubgraphs(this._graph),d=new Mu(this._geomFact);this.buildSubgraphs(s,d);var g=d.getPolygons();if(g.size()<=0)return this.createEmptyResultGeometry();var x=this._geomFact.buildGeometry(g);return x};Ol.prototype.computeNodedEdges=function(e,t){var i=this,r=this.getNoder(t);r.computeNodes(e);for(var a=r.getNodedSubstrings(),l=a.iterator();l.hasNext();){var s=l.next(),d=s.getCoordinates();if(!(d.length===2&&d[0].equals2D(d[1]))){var g=s.getData(),x=new WE(s.getCoordinates(),new fs(g));i.insertUniqueEdge(x)}}};Ol.prototype.setNoder=function(e){this._workingNoder=e};Ol.prototype.interfaces_=function(){return[]};Ol.prototype.getClass=function(){return Ol};Ol.depthDelta=function(e){var t=e.getLocation(0,Mn.LEFT),i=e.getLocation(0,Mn.RIGHT);return t===wt.INTERIOR&&i===wt.EXTERIOR?1:t===wt.EXTERIOR&&i===wt.INTERIOR?-1:0};Ol.convertSegStrings=function(e){for(var t=new Lr,i=new Un;e.hasNext();){var r=e.next(),a=t.createLineString(r.getCoordinates());i.add(a)}return t.buildGeometry(i)};var pm=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var e=arguments[0],t=arguments[1];this._noder=e,this._scaleFactor=t,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(arguments.length===4){var i=arguments[0],r=arguments[1],a=arguments[2],l=arguments[3];this._noder=i,this._scaleFactor=r,this._offsetX=a,this._offsetY=l,this._isScaled=!this.isIntegerPrecision()}};pm.prototype.rescale=function(){var e=this;if(Hi(arguments[0],ta))for(var t=arguments[0],i=t.iterator();i.hasNext();){var r=i.next();e.rescale(r.getCoordinates())}else if(arguments[0]instanceof Array){for(var a=arguments[0],l=0;l<a.length;l++)a[l].x=a[l].x/e._scaleFactor+e._offsetX,a[l].y=a[l].y/e._scaleFactor+e._offsetY;a.length===2&&a[0].equals2D(a[1])&&Wa.out.println(a)}};pm.prototype.scale=function(){var e=this;if(Hi(arguments[0],ta)){for(var t=arguments[0],i=new Un,r=t.iterator();r.hasNext();){var a=r.next();i.add(new Oo(e.scale(a.getCoordinates()),a.getData()))}return i}else if(arguments[0]instanceof Array){for(var l=arguments[0],s=new Array(l.length).fill(null),d=0;d<l.length;d++)s[d]=new mt(Math.round((l[d].x-e._offsetX)*e._scaleFactor),Math.round((l[d].y-e._offsetY)*e._scaleFactor),l[d].z);var g=Rr.removeRepeatedPoints(s);return g}};pm.prototype.isIntegerPrecision=function(){return this._scaleFactor===1};pm.prototype.getNodedSubstrings=function(){var e=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(e),e};pm.prototype.computeNodes=function(e){var t=e;this._isScaled&&(t=this.scale(e)),this._noder.computeNodes(t)};pm.prototype.interfaces_=function(){return[fg]};pm.prototype.getClass=function(){return pm};var Pf=function(){this._li=new Ig,this._segStrings=null;var e=arguments[0];this._segStrings=e},bR={fact:{configurable:!0}};Pf.prototype.checkEndPtVertexIntersections=function(){var e=this;if(arguments.length===0)for(var t=this._segStrings.iterator();t.hasNext();){var i=t.next(),r=i.getCoordinates();e.checkEndPtVertexIntersections(r[0],e._segStrings),e.checkEndPtVertexIntersections(r[r.length-1],e._segStrings)}else if(arguments.length===2){for(var a=arguments[0],l=arguments[1],s=l.iterator();s.hasNext();)for(var d=s.next(),g=d.getCoordinates(),x=1;x<g.length-1;x++)if(g[x].equals(a))throw new pp("found endpt/interior pt intersection at index "+x+" :pt "+a)}};Pf.prototype.checkInteriorIntersections=function(){var e=this;if(arguments.length===0)for(var t=this._segStrings.iterator();t.hasNext();)for(var i=t.next(),r=this._segStrings.iterator();r.hasNext();){var a=r.next();e.checkInteriorIntersections(i,a)}else if(arguments.length===2)for(var l=arguments[0],s=arguments[1],d=l.getCoordinates(),g=s.getCoordinates(),x=0;x<d.length-1;x++)for(var I=0;I<g.length-1;I++)e.checkInteriorIntersections(l,x,s,I);else if(arguments.length===4){var A=arguments[0],L=arguments[1],N=arguments[2],B=arguments[3];if(A===N&&L===B)return null;var F=A.getCoordinates()[L],z=A.getCoordinates()[L+1],V=N.getCoordinates()[B],Y=N.getCoordinates()[B+1];if(this._li.computeIntersection(F,z,V,Y),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,F,z)||this.hasInteriorIntersection(this._li,V,Y)))throw new pp("found non-noded intersection at "+F+"-"+z+" and "+V+"-"+Y)}};Pf.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()};Pf.prototype.checkCollapses=function(){var e=this;if(arguments.length===0)for(var t=this._segStrings.iterator();t.hasNext();){var i=t.next();e.checkCollapses(i)}else if(arguments.length===1)for(var r=arguments[0],a=r.getCoordinates(),l=0;l<a.length-2;l++)e.checkCollapse(a[l],a[l+1],a[l+2])};Pf.prototype.hasInteriorIntersection=function(e,t,i){for(var r=0;r<e.getIntersectionNum();r++){var a=e.getIntersection(r);if(!(a.equals(t)||a.equals(i)))return!0}return!1};Pf.prototype.checkCollapse=function(e,t,i){if(e.equals(i))throw new pp("found non-noded collapse at "+Pf.fact.createLineString([e,t,i]))};Pf.prototype.interfaces_=function(){return[]};Pf.prototype.getClass=function(){return Pf};bR.fact.get=function(){return new Lr};Object.defineProperties(Pf,bR);var ou=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var e=arguments[0],t=arguments[1],i=arguments[2];if(this._originalPt=e,this._pt=e,this._scaleFactor=t,this._li=i,t<=0)throw new io("Scale factor must be non-zero");t!==1&&(this._pt=new mt(this.scale(e.x),this.scale(e.y)),this._p0Scaled=new mt,this._p1Scaled=new mt),this.initCorners(this._pt)},xR={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};ou.prototype.intersectsScaled=function(e,t){var i=Math.min(e.x,t.x),r=Math.max(e.x,t.x),a=Math.min(e.y,t.y),l=Math.max(e.y,t.y),s=this._maxx<i||this._minx>r||this._maxy<a||this._miny>l;if(s)return!1;var d=this.intersectsToleranceSquare(e,t);return dr.isTrue(!(s&&d),"Found bad envelope test"),d};ou.prototype.initCorners=function(e){var t=.5;this._minx=e.x-t,this._maxx=e.x+t,this._miny=e.y-t,this._maxy=e.y+t,this._corner[0]=new mt(this._maxx,this._maxy),this._corner[1]=new mt(this._minx,this._maxy),this._corner[2]=new mt(this._minx,this._miny),this._corner[3]=new mt(this._maxx,this._miny)};ou.prototype.intersects=function(e,t){return this._scaleFactor===1?this.intersectsScaled(e,t):(this.copyScaled(e,this._p0Scaled),this.copyScaled(t,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))};ou.prototype.scale=function(e){return Math.round(e*this._scaleFactor)};ou.prototype.getCoordinate=function(){return this._originalPt};ou.prototype.copyScaled=function(e,t){t.x=this.scale(e.x),t.y=this.scale(e.y)};ou.prototype.getSafeEnvelope=function(){if(this._safeEnv===null){var e=ou.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Ii(this._originalPt.x-e,this._originalPt.x+e,this._originalPt.y-e,this._originalPt.y+e)}return this._safeEnv};ou.prototype.intersectsPixelClosure=function(e,t){return this._li.computeIntersection(e,t,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(e,t,this._corner[1],this._corner[2]),this._li.hasIntersection())||(this._li.computeIntersection(e,t,this._corner[2],this._corner[3]),this._li.hasIntersection())||(this._li.computeIntersection(e,t,this._corner[3],this._corner[0]),this._li.hasIntersection()))};ou.prototype.intersectsToleranceSquare=function(e,t){var i=!1,r=!1;return this._li.computeIntersection(e,t,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(e,t,this._corner[1],this._corner[2]),this._li.isProper())||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(e,t,this._corner[2],this._corner[3]),this._li.isProper())||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(e,t,this._corner[3],this._corner[0]),this._li.isProper())||i&&r||e.equals(this._pt)||t.equals(this._pt))};ou.prototype.addSnappedNode=function(e,t){var i=e.getCoordinate(t),r=e.getCoordinate(t+1);return this.intersects(i,r)?(e.addIntersection(this.getCoordinate(),t),!0):!1};ou.prototype.interfaces_=function(){return[]};ou.prototype.getClass=function(){return ou};xR.SAFE_ENV_EXPANSION_FACTOR.get=function(){return .75};Object.defineProperties(ou,xR);var $1=function(){this.tempEnv1=new Ii,this.selectedSegment=new wi};$1.prototype.select=function(){if(arguments.length!==1){if(arguments.length===2){var e=arguments[0],t=arguments[1];e.getLineSegment(t,this.selectedSegment),this.select(this.selectedSegment)}}};$1.prototype.interfaces_=function(){return[]};$1.prototype.getClass=function(){return $1};var Zv=function(){this._index=null;var e=arguments[0];this._index=e},ER={HotPixelSnapAction:{configurable:!0}};Zv.prototype.snap=function(){if(arguments.length===1){var e=arguments[0];return this.snap(e,null,-1)}else if(arguments.length===3){var t=arguments[0],i=arguments[1],r=arguments[2],a=t.getSafeEnvelope(),l=new IR(t,i,r);return this._index.query(a,{interfaces_:function(){return[hm]},visitItem:function(s){var d=s;d.select(a,l)}}),l.isNodeAdded()}};Zv.prototype.interfaces_=function(){return[]};Zv.prototype.getClass=function(){return Zv};ER.HotPixelSnapAction.get=function(){return IR};Object.defineProperties(Zv,ER);var IR=function(n){function e(){n.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var t=arguments[0],i=arguments[1],r=arguments[2];this._hotPixel=t,this._parentEdge=i,this._hotPixelVertexIndex=r}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.isNodeAdded=function(){return this._isNodeAdded},e.prototype.select=function(){if(arguments.length===2){var i=arguments[0],r=arguments[1],a=i.getContext();if(this._parentEdge!==null&&a===this._parentEdge&&r===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(a,r)}else return n.prototype.select.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}($1),D_=function(){this._li=null,this._interiorIntersections=null;var e=arguments[0];this._li=e,this._interiorIntersections=new Un};D_.prototype.processIntersections=function(e,t,i,r){var a=this;if(e===i&&t===r)return null;var l=e.getCoordinates()[t],s=e.getCoordinates()[t+1],d=i.getCoordinates()[r],g=i.getCoordinates()[r+1];if(this._li.computeIntersection(l,s,d,g),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var x=0;x<this._li.getIntersectionNum();x++)a._interiorIntersections.add(a._li.getIntersection(x));e.addIntersections(this._li,t,0),i.addIntersections(this._li,r,1)}};D_.prototype.isDone=function(){return!1};D_.prototype.getInteriorIntersections=function(){return this._interiorIntersections};D_.prototype.interfaces_=function(){return[pg]};D_.prototype.getClass=function(){return D_};var Ed=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var e=arguments[0];this._pm=e,this._li=new Ig,this._li.setPrecisionModel(e),this._scaleFactor=e.getScale()};Ed.prototype.checkCorrectness=function(e){var t=Oo.getNodedSubstrings(e),i=new Pf(t);try{i.checkValid()}catch(r){if(r instanceof oR)r.printStackTrace();else throw r}finally{}};Ed.prototype.getNodedSubstrings=function(){return Oo.getNodedSubstrings(this._nodedSegStrings)};Ed.prototype.snapRound=function(e,t){var i=this.findInteriorIntersections(e,t);this.computeIntersectionSnaps(i),this.computeVertexSnaps(e)};Ed.prototype.findInteriorIntersections=function(e,t){var i=new D_(t);return this._noder.setSegmentIntersector(i),this._noder.computeNodes(e),i.getInteriorIntersections()};Ed.prototype.computeVertexSnaps=function(){var e=this;if(Hi(arguments[0],ta))for(var t=arguments[0],i=t.iterator();i.hasNext();){var r=i.next();e.computeVertexSnaps(r)}else if(arguments[0]instanceof Oo)for(var a=arguments[0],l=a.getCoordinates(),s=0;s<l.length;s++){var d=new ou(l[s],e._scaleFactor,e._li),g=e._pointSnapper.snap(d,a,s);g&&a.addIntersection(l[s],s)}};Ed.prototype.computeNodes=function(e){this._nodedSegStrings=e,this._noder=new XS,this._pointSnapper=new Zv(this._noder.getIndex()),this.snapRound(e,this._li)};Ed.prototype.computeIntersectionSnaps=function(e){for(var t=this,i=e.iterator();i.hasNext();){var r=i.next(),a=new ou(r,t._scaleFactor,t._li);t._pointSnapper.snap(a)}};Ed.prototype.interfaces_=function(){return[fg]};Ed.prototype.getClass=function(){return Ed};var ja=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new ts,this._resultGeometry=null,this._saveException=null,arguments.length===1){var e=arguments[0];this._argGeom=e}else if(arguments.length===2){var t=arguments[0],i=arguments[1];this._argGeom=t,this._bufParams=i}},c0={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};ja.prototype.bufferFixedPrecision=function(e){var t=new pm(new Ed(new ns(1)),e.getScale()),i=new Ol(this._bufParams);i.setWorkingPrecisionModel(e),i.setNoder(t),this._resultGeometry=i.buffer(this._argGeom,this._distance)};ja.prototype.bufferReducedPrecision=function(){var e=this;if(arguments.length===0){for(var t=ja.MAX_PRECISION_DIGITS;t>=0;t--){try{e.bufferReducedPrecision(t)}catch(l){if(l instanceof gp)e._saveException=l;else throw l}finally{}if(e._resultGeometry!==null)return null}throw this._saveException}else if(arguments.length===1){var i=arguments[0],r=ja.precisionScaleFactor(this._argGeom,this._distance,i),a=new ns(r);this.bufferFixedPrecision(a)}};ja.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var e=this._argGeom.getFactory().getPrecisionModel();e.getType()===ns.FIXED?this.bufferFixedPrecision(e):this.bufferReducedPrecision()};ja.prototype.setQuadrantSegments=function(e){this._bufParams.setQuadrantSegments(e)};ja.prototype.bufferOriginalPrecision=function(){try{var e=new Ol(this._bufParams);this._resultGeometry=e.buffer(this._argGeom,this._distance)}catch(t){if(t instanceof pp)this._saveException=t;else throw t}finally{}};ja.prototype.getResultGeometry=function(e){return this._distance=e,this.computeGeometry(),this._resultGeometry};ja.prototype.setEndCapStyle=function(e){this._bufParams.setEndCapStyle(e)};ja.prototype.interfaces_=function(){return[]};ja.prototype.getClass=function(){return ja};ja.bufferOp=function(){if(arguments.length===2){var e=arguments[0],t=arguments[1],i=new ja(e),r=i.getResultGeometry(t);return r}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Bi&&typeof arguments[1]=="number"){var a=arguments[0],l=arguments[1],s=arguments[2],d=new ja(a);d.setQuadrantSegments(s);var g=d.getResultGeometry(l);return g}else if(arguments[2]instanceof ts&&arguments[0]instanceof Bi&&typeof arguments[1]=="number"){var x=arguments[0],I=arguments[1],A=arguments[2],L=new ja(x,A),N=L.getResultGeometry(I);return N}}else if(arguments.length===4){var B=arguments[0],F=arguments[1],z=arguments[2],V=arguments[3],Y=new ja(B);Y.setQuadrantSegments(z),Y.setEndCapStyle(V);var Q=Y.getResultGeometry(F);return Q}};ja.precisionScaleFactor=function(e,t,i){var r=e.getEnvelopeInternal(),a=sc.max(Math.abs(r.getMaxX()),Math.abs(r.getMaxY()),Math.abs(r.getMinX()),Math.abs(r.getMinY())),l=t>0?t:0,s=a+2*l,d=Math.trunc(Math.log(s)/Math.log(10)+1),g=i-d,x=Math.pow(10,g);return x};c0.CAP_ROUND.get=function(){return ts.CAP_ROUND};c0.CAP_BUTT.get=function(){return ts.CAP_FLAT};c0.CAP_FLAT.get=function(){return ts.CAP_FLAT};c0.CAP_SQUARE.get=function(){return ts.CAP_SQUARE};c0.MAX_PRECISION_DIGITS.get=function(){return 12};Object.defineProperties(ja,c0);var Ll=function(){this._pt=[new mt,new mt],this._distance=rr.NaN,this._isNull=!0};Ll.prototype.getCoordinates=function(){return this._pt};Ll.prototype.getCoordinate=function(e){return this._pt[e]};Ll.prototype.setMinimum=function(){if(arguments.length===1){var e=arguments[0];this.setMinimum(e._pt[0],e._pt[1])}else if(arguments.length===2){var t=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(t,i),null;var r=t.distance(i);r<this._distance&&this.initialize(t,i,r)}};Ll.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var e=arguments[0],t=arguments[1];this._pt[0].setCoordinate(e),this._pt[1].setCoordinate(t),this._distance=e.distance(t),this._isNull=!1}else if(arguments.length===3){var i=arguments[0],r=arguments[1],a=arguments[2];this._pt[0].setCoordinate(i),this._pt[1].setCoordinate(r),this._distance=a,this._isNull=!1}};Ll.prototype.getDistance=function(){return this._distance};Ll.prototype.setMaximum=function(){if(arguments.length===1){var e=arguments[0];this.setMaximum(e._pt[0],e._pt[1])}else if(arguments.length===2){var t=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(t,i),null;var r=t.distance(i);r>this._distance&&this.initialize(t,i,r)}};Ll.prototype.interfaces_=function(){return[]};Ll.prototype.getClass=function(){return Ll};var ad=function(){};ad.prototype.interfaces_=function(){return[]};ad.prototype.getClass=function(){return ad};ad.computeDistance=function(){if(arguments[2]instanceof Ll&&arguments[0]instanceof Io&&arguments[1]instanceof mt)for(var e=arguments[0],t=arguments[1],i=arguments[2],r=e.getCoordinates(),a=new wi,l=0;l<r.length-1;l++){a.setCoordinates(r[l],r[l+1]);var s=a.closestPoint(t);i.setMinimum(s,t)}else if(arguments[2]instanceof Ll&&arguments[0]instanceof oa&&arguments[1]instanceof mt){var d=arguments[0],g=arguments[1],x=arguments[2];ad.computeDistance(d.getExteriorRing(),g,x);for(var I=0;I<d.getNumInteriorRing();I++)ad.computeDistance(d.getInteriorRingN(I),g,x)}else if(arguments[2]instanceof Ll&&arguments[0]instanceof Bi&&arguments[1]instanceof mt){var A=arguments[0],L=arguments[1],N=arguments[2];if(A instanceof Io)ad.computeDistance(A,L,N);else if(A instanceof oa)ad.computeDistance(A,L,N);else if(A instanceof Nl)for(var B=A,F=0;F<B.getNumGeometries();F++){var z=B.getGeometryN(F);ad.computeDistance(z,L,N)}else N.setMinimum(A.getCoordinate(),L)}else if(arguments[2]instanceof Ll&&arguments[0]instanceof wi&&arguments[1]instanceof mt){var V=arguments[0],Y=arguments[1],Q=arguments[2],J=V.closestPoint(Y);Q.setMinimum(J,Y)}};var gg=function(e){this._maxPtDist=new Ll,this._inputGeom=e||null},ZS={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};gg.prototype.computeMaxMidpointDistance=function(e){var t=new mm(this._inputGeom);e.apply(t),this._maxPtDist.setMaximum(t.getMaxPointDistance())};gg.prototype.computeMaxVertexDistance=function(e){var t=new O_(this._inputGeom);e.apply(t),this._maxPtDist.setMaximum(t.getMaxPointDistance())};gg.prototype.findDistance=function(e){return this.computeMaxVertexDistance(e),this.computeMaxMidpointDistance(e),this._maxPtDist.getDistance()};gg.prototype.getDistancePoints=function(){return this._maxPtDist};gg.prototype.interfaces_=function(){return[]};gg.prototype.getClass=function(){return gg};ZS.MaxPointDistanceFilter.get=function(){return O_};ZS.MaxMidpointDistanceFilter.get=function(){return mm};Object.defineProperties(gg,ZS);var O_=function(e){this._maxPtDist=new Ll,this._minPtDist=new Ll,this._geom=e||null};O_.prototype.filter=function(e){this._minPtDist.initialize(),ad.computeDistance(this._geom,e,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};O_.prototype.getMaxPointDistance=function(){return this._maxPtDist};O_.prototype.interfaces_=function(){return[_d]};O_.prototype.getClass=function(){return O_};var mm=function(e){this._maxPtDist=new Ll,this._minPtDist=new Ll,this._geom=e||null};mm.prototype.filter=function(e,t){if(t===0)return null;var i=e.getCoordinate(t-1),r=e.getCoordinate(t),a=new mt((i.x+r.x)/2,(i.y+r.y)/2);this._minPtDist.initialize(),ad.computeDistance(this._geom,a,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};mm.prototype.isDone=function(){return!1};mm.prototype.isGeometryChanged=function(){return!1};mm.prototype.getMaxPointDistance=function(){return this._maxPtDist};mm.prototype.interfaces_=function(){return[Ch]};mm.prototype.getClass=function(){return mm};var fp=function(e){this._comps=e||null};fp.prototype.filter=function(e){e instanceof oa&&this._comps.add(e)};fp.prototype.interfaces_=function(){return[Cf]};fp.prototype.getClass=function(){return fp};fp.getPolygons=function(){if(arguments.length===1){var e=arguments[0];return fp.getPolygons(e,new Un)}else if(arguments.length===2){var t=arguments[0],i=arguments[1];return t instanceof oa?i.add(t):t instanceof Nl&&t.apply(new fp(i)),i}};var Ha=function(){if(this._lines=null,this._isForcedToLineString=!1,arguments.length===1){var e=arguments[0];this._lines=e}else if(arguments.length===2){var t=arguments[0],i=arguments[1];this._lines=t,this._isForcedToLineString=i}};Ha.prototype.filter=function(e){if(this._isForcedToLineString&&e instanceof yd){var t=e.getFactory().createLineString(e.getCoordinateSequence());return this._lines.add(t),null}e instanceof Io&&this._lines.add(e)};Ha.prototype.setForceToLineString=function(e){this._isForcedToLineString=e};Ha.prototype.interfaces_=function(){return[mp]};Ha.prototype.getClass=function(){return Ha};Ha.getGeometry=function(){if(arguments.length===1){var e=arguments[0];return e.getFactory().buildGeometry(Ha.getLines(e))}else if(arguments.length===2){var t=arguments[0],i=arguments[1];return t.getFactory().buildGeometry(Ha.getLines(t,i))}};Ha.getLines=function(){if(arguments.length===1){var e=arguments[0];return Ha.getLines(e,!1)}else if(arguments.length===2){if(Hi(arguments[0],ta)&&Hi(arguments[1],ta)){for(var t=arguments[0],i=arguments[1],r=t.iterator();r.hasNext();){var a=r.next();Ha.getLines(a,i)}return i}else if(arguments[0]instanceof Bi&&typeof arguments[1]=="boolean"){var l=arguments[0],s=arguments[1],d=new Un;return l.apply(new Ha(d,s)),d}else if(arguments[0]instanceof Bi&&Hi(arguments[1],ta)){var g=arguments[0],x=arguments[1];return g instanceof Io?x.add(g):g.apply(new Ha(x)),x}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&Hi(arguments[0],ta)&&Hi(arguments[1],ta)){for(var I=arguments[0],A=arguments[1],L=arguments[2],N=I.iterator();N.hasNext();){var B=N.next();Ha.getLines(B,A,L)}return A}else if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Bi&&Hi(arguments[1],ta)){var F=arguments[0],z=arguments[1],V=arguments[2];return F.apply(new Ha(z,V)),z}}};var Rh=function(){if(this._boundaryRule=qc.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,arguments.length!==0){if(arguments.length===1){var e=arguments[0];if(e===null)throw new io("Rule must be non-null");this._boundaryRule=e}}};Rh.prototype.locateInternal=function(){var e=this;if(arguments[0]instanceof mt&&arguments[1]instanceof oa){var t=arguments[0],i=arguments[1];if(i.isEmpty())return wt.EXTERIOR;var r=i.getExteriorRing(),a=this.locateInPolygonRing(t,r);if(a===wt.EXTERIOR)return wt.EXTERIOR;if(a===wt.BOUNDARY)return wt.BOUNDARY;for(var l=0;l<i.getNumInteriorRing();l++){var s=i.getInteriorRingN(l),d=e.locateInPolygonRing(t,s);if(d===wt.INTERIOR)return wt.EXTERIOR;if(d===wt.BOUNDARY)return wt.BOUNDARY}return wt.INTERIOR}else if(arguments[0]instanceof mt&&arguments[1]instanceof Io){var g=arguments[0],x=arguments[1];if(!x.getEnvelopeInternal().intersects(g))return wt.EXTERIOR;var I=x.getCoordinates();return!x.isClosed()&&(g.equals(I[0])||g.equals(I[I.length-1]))?wt.BOUNDARY:Jn.isOnLine(g,I)?wt.INTERIOR:wt.EXTERIOR}else if(arguments[0]instanceof mt&&arguments[1]instanceof Au){var A=arguments[0],L=arguments[1],N=L.getCoordinate();return N.equals2D(A)?wt.INTERIOR:wt.EXTERIOR}};Rh.prototype.locateInPolygonRing=function(e,t){return t.getEnvelopeInternal().intersects(e)?Jn.locatePointInRing(e,t.getCoordinates()):wt.EXTERIOR};Rh.prototype.intersects=function(e,t){return this.locate(e,t)!==wt.EXTERIOR};Rh.prototype.updateLocationInfo=function(e){e===wt.INTERIOR&&(this._isIn=!0),e===wt.BOUNDARY&&this._numBoundaries++};Rh.prototype.computeLocation=function(e,t){var i=this;if(t instanceof Au&&this.updateLocationInfo(this.locateInternal(e,t)),t instanceof Io)this.updateLocationInfo(this.locateInternal(e,t));else if(t instanceof oa)this.updateLocationInfo(this.locateInternal(e,t));else if(t instanceof hg)for(var r=t,a=0;a<r.getNumGeometries();a++){var l=r.getGeometryN(a);i.updateLocationInfo(i.locateInternal(e,l))}else if(t instanceof pd)for(var s=t,d=0;d<s.getNumGeometries();d++){var g=s.getGeometryN(d);i.updateLocationInfo(i.locateInternal(e,g))}else if(t instanceof Nl)for(var x=new md(t);x.hasNext();){var I=x.next();I!==t&&i.computeLocation(e,I)}};Rh.prototype.locate=function(e,t){return t.isEmpty()?wt.EXTERIOR:t instanceof Io?this.locateInternal(e,t):t instanceof oa?this.locateInternal(e,t):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(e,t),this._boundaryRule.isInBoundary(this._numBoundaries)?wt.BOUNDARY:this._numBoundaries>0||this._isIn?wt.INTERIOR:wt.EXTERIOR)};Rh.prototype.interfaces_=function(){return[]};Rh.prototype.getClass=function(){return Rh};var Rl=function n(){if(this._component=null,this._segIndex=null,this._pt=null,arguments.length===2){var e=arguments[0],t=arguments[1];n.call(this,e,n.INSIDE_AREA,t)}else if(arguments.length===3){var i=arguments[0],r=arguments[1],a=arguments[2];this._component=i,this._segIndex=r,this._pt=a}},TR={INSIDE_AREA:{configurable:!0}};Rl.prototype.isInsideArea=function(){return this._segIndex===Rl.INSIDE_AREA};Rl.prototype.getCoordinate=function(){return this._pt};Rl.prototype.getGeometryComponent=function(){return this._component};Rl.prototype.getSegmentIndex=function(){return this._segIndex};Rl.prototype.interfaces_=function(){return[]};Rl.prototype.getClass=function(){return Rl};TR.INSIDE_AREA.get=function(){return-1};Object.defineProperties(Rl,TR);var lm=function(e){this._pts=e||null};lm.prototype.filter=function(e){e instanceof Au&&this._pts.add(e)};lm.prototype.interfaces_=function(){return[Cf]};lm.prototype.getClass=function(){return lm};lm.getPoints=function(){if(arguments.length===1){var e=arguments[0];return e instanceof Au?Mh.singletonList(e):lm.getPoints(e,new Un)}else if(arguments.length===2){var t=arguments[0],i=arguments[1];return t instanceof Au?i.add(t):t instanceof Nl&&t.apply(new lm(i)),i}};var N_=function(){this._locations=null;var e=arguments[0];this._locations=e};N_.prototype.filter=function(e){(e instanceof Au||e instanceof Io||e instanceof oa)&&this._locations.add(new Rl(e,0,e.getCoordinate()))};N_.prototype.interfaces_=function(){return[Cf]};N_.prototype.getClass=function(){return N_};N_.getLocations=function(e){var t=new Un;return e.apply(new N_(t)),t};var Za=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Rh,this._minDistanceLocation=null,this._minDistance=rr.MAX_VALUE,arguments.length===2){var e=arguments[0],t=arguments[1];this._geom=[e,t],this._terminateDistance=0}else if(arguments.length===3){var i=arguments[0],r=arguments[1],a=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=i,this._geom[1]=r,this._terminateDistance=a}};Za.prototype.computeContainmentDistance=function(){var e=this;if(arguments.length===0){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(arguments.length===2){var i=arguments[0],r=arguments[1],a=1-i,l=fp.getPolygons(this._geom[i]);if(l.size()>0){var s=N_.getLocations(this._geom[a]);if(this.computeContainmentDistance(s,l,r),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[a]=r[0],this._minDistanceLocation[i]=r[1],null}}else if(arguments.length===3){if(arguments[2]instanceof Array&&Hi(arguments[0],Th)&&Hi(arguments[1],Th)){for(var d=arguments[0],g=arguments[1],x=arguments[2],I=0;I<d.size();I++)for(var A=d.get(I),L=0;L<g.size();L++)if(e.computeContainmentDistance(A,g.get(L),x),e._minDistance<=e._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Rl&&arguments[1]instanceof oa){var N=arguments[0],B=arguments[1],F=arguments[2],z=N.getCoordinate();if(wt.EXTERIOR!==this._ptLocator.locate(z,B))return this._minDistance=0,F[0]=N,F[1]=new Rl(B,z),null}}};Za.prototype.computeMinDistanceLinesPoints=function(e,t,i){for(var r=this,a=0;a<e.size();a++)for(var l=e.get(a),s=0;s<t.size();s++){var d=t.get(s);if(r.computeMinDistance(l,d,i),r._minDistance<=r._terminateDistance)return null}};Za.prototype.computeFacetDistance=function(){var e=new Array(2).fill(null),t=Ha.getLines(this._geom[0]),i=Ha.getLines(this._geom[1]),r=lm.getPoints(this._geom[0]),a=lm.getPoints(this._geom[1]);if(this.computeMinDistanceLines(t,i,e),this.updateMinDistance(e,!1),this._minDistance<=this._terminateDistance||(e[0]=null,e[1]=null,this.computeMinDistanceLinesPoints(t,a,e),this.updateMinDistance(e,!1),this._minDistance<=this._terminateDistance)||(e[0]=null,e[1]=null,this.computeMinDistanceLinesPoints(i,r,e),this.updateMinDistance(e,!0),this._minDistance<=this._terminateDistance))return null;e[0]=null,e[1]=null,this.computeMinDistancePoints(r,a,e),this.updateMinDistance(e,!1)};Za.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation};Za.prototype.updateMinDistance=function(e,t){if(e[0]===null)return null;t?(this._minDistanceLocation[0]=e[1],this._minDistanceLocation[1]=e[0]):(this._minDistanceLocation[0]=e[0],this._minDistanceLocation[1]=e[1])};Za.prototype.nearestPoints=function(){this.computeMinDistance();var e=[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()];return e};Za.prototype.computeMinDistance=function(){var e=this;if(arguments.length===0){if(this._minDistanceLocation!==null||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(arguments.length===3){if(arguments[2]instanceof Array&&arguments[0]instanceof Io&&arguments[1]instanceof Au){var t=arguments[0],i=arguments[1],r=arguments[2];if(t.getEnvelopeInternal().distance(i.getEnvelopeInternal())>this._minDistance)return null;for(var a=t.getCoordinates(),l=i.getCoordinate(),s=0;s<a.length-1;s++){var d=Jn.distancePointLine(l,a[s],a[s+1]);if(d<e._minDistance){e._minDistance=d;var g=new wi(a[s],a[s+1]),x=g.closestPoint(l);r[0]=new Rl(t,s,x),r[1]=new Rl(i,0,l)}if(e._minDistance<=e._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Io&&arguments[1]instanceof Io){var I=arguments[0],A=arguments[1],L=arguments[2];if(I.getEnvelopeInternal().distance(A.getEnvelopeInternal())>this._minDistance)return null;for(var N=I.getCoordinates(),B=A.getCoordinates(),F=0;F<N.length-1;F++)for(var z=0;z<B.length-1;z++){var V=Jn.distanceLineLine(N[F],N[F+1],B[z],B[z+1]);if(V<e._minDistance){e._minDistance=V;var Y=new wi(N[F],N[F+1]),Q=new wi(B[z],B[z+1]),J=Y.closestPoints(Q);L[0]=new Rl(I,F,J[0]),L[1]=new Rl(A,z,J[1])}if(e._minDistance<=e._terminateDistance)return null}}}};Za.prototype.computeMinDistancePoints=function(e,t,i){for(var r=this,a=0;a<e.size();a++)for(var l=e.get(a),s=0;s<t.size();s++){var d=t.get(s),g=l.getCoordinate().distance(d.getCoordinate());if(g<r._minDistance&&(r._minDistance=g,i[0]=new Rl(l,0,l.getCoordinate()),i[1]=new Rl(d,0,d.getCoordinate())),r._minDistance<=r._terminateDistance)return null}};Za.prototype.distance=function(){if(this._geom[0]===null||this._geom[1]===null)throw new io("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)};Za.prototype.computeMinDistanceLines=function(e,t,i){for(var r=this,a=0;a<e.size();a++)for(var l=e.get(a),s=0;s<t.size();s++){var d=t.get(s);if(r.computeMinDistance(l,d,i),r._minDistance<=r._terminateDistance)return null}};Za.prototype.interfaces_=function(){return[]};Za.prototype.getClass=function(){return Za};Za.distance=function(e,t){var i=new Za(e,t);return i.distance()};Za.isWithinDistance=function(e,t,i){var r=new Za(e,t,i);return r.distance()<=i};Za.nearestPoints=function(e,t){var i=new Za(e,t);return i.nearestPoints()};var gl=function(){this._pt=[new mt,new mt],this._distance=rr.NaN,this._isNull=!0};gl.prototype.getCoordinates=function(){return this._pt};gl.prototype.getCoordinate=function(e){return this._pt[e]};gl.prototype.setMinimum=function(){if(arguments.length===1){var e=arguments[0];this.setMinimum(e._pt[0],e._pt[1])}else if(arguments.length===2){var t=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(t,i),null;var r=t.distance(i);r<this._distance&&this.initialize(t,i,r)}};gl.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var e=arguments[0],t=arguments[1];this._pt[0].setCoordinate(e),this._pt[1].setCoordinate(t),this._distance=e.distance(t),this._isNull=!1}else if(arguments.length===3){var i=arguments[0],r=arguments[1],a=arguments[2];this._pt[0].setCoordinate(i),this._pt[1].setCoordinate(r),this._distance=a,this._isNull=!1}};gl.prototype.toString=function(){return Sh.toLineString(this._pt[0],this._pt[1])};gl.prototype.getDistance=function(){return this._distance};gl.prototype.setMaximum=function(){if(arguments.length===1){var e=arguments[0];this.setMaximum(e._pt[0],e._pt[1])}else if(arguments.length===2){var t=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(t,i),null;var r=t.distance(i);r>this._distance&&this.initialize(t,i,r)}};gl.prototype.interfaces_=function(){return[]};gl.prototype.getClass=function(){return gl};var yf=function(){};yf.prototype.interfaces_=function(){return[]};yf.prototype.getClass=function(){return yf};yf.computeDistance=function(){if(arguments[2]instanceof gl&&arguments[0]instanceof Io&&arguments[1]instanceof mt)for(var e=arguments[0],t=arguments[1],i=arguments[2],r=new wi,a=e.getCoordinates(),l=0;l<a.length-1;l++){r.setCoordinates(a[l],a[l+1]);var s=r.closestPoint(t);i.setMinimum(s,t)}else if(arguments[2]instanceof gl&&arguments[0]instanceof oa&&arguments[1]instanceof mt){var d=arguments[0],g=arguments[1],x=arguments[2];yf.computeDistance(d.getExteriorRing(),g,x);for(var I=0;I<d.getNumInteriorRing();I++)yf.computeDistance(d.getInteriorRingN(I),g,x)}else if(arguments[2]instanceof gl&&arguments[0]instanceof Bi&&arguments[1]instanceof mt){var A=arguments[0],L=arguments[1],N=arguments[2];if(A instanceof Io)yf.computeDistance(A,L,N);else if(A instanceof oa)yf.computeDistance(A,L,N);else if(A instanceof Nl)for(var B=A,F=0;F<B.getNumGeometries();F++){var z=B.getGeometryN(F);yf.computeDistance(z,L,N)}else N.setMinimum(A.getCoordinate(),L)}else if(arguments[2]instanceof gl&&arguments[0]instanceof wi&&arguments[1]instanceof mt){var V=arguments[0],Y=arguments[1],Q=arguments[2],J=V.closestPoint(Y);Q.setMinimum(J,Y)}};var Hc=function(){this._g0=null,this._g1=null,this._ptDist=new gl,this._densifyFrac=0;var e=arguments[0],t=arguments[1];this._g0=e,this._g1=t},YS={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Hc.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()};Hc.prototype.setDensifyFraction=function(e){if(e>1||e<=0)throw new io("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=e};Hc.prototype.compute=function(e,t){this.computeOrientedDistance(e,t,this._ptDist),this.computeOrientedDistance(t,e,this._ptDist)};Hc.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()};Hc.prototype.computeOrientedDistance=function(e,t,i){var r=new k_(t);if(e.apply(r),i.setMaximum(r.getMaxPointDistance()),this._densifyFrac>0){var a=new gm(t,this._densifyFrac);e.apply(a),i.setMaximum(a.getMaxPointDistance())}};Hc.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()};Hc.prototype.interfaces_=function(){return[]};Hc.prototype.getClass=function(){return Hc};Hc.distance=function(){if(arguments.length===2){var e=arguments[0],t=arguments[1],i=new Hc(e,t);return i.distance()}else if(arguments.length===3){var r=arguments[0],a=arguments[1],l=arguments[2],s=new Hc(r,a);return s.setDensifyFraction(l),s.distance()}};YS.MaxPointDistanceFilter.get=function(){return k_};YS.MaxDensifiedByFractionDistanceFilter.get=function(){return gm};Object.defineProperties(Hc,YS);var k_=function(){this._maxPtDist=new gl,this._minPtDist=new gl,this._euclideanDist=new yf,this._geom=null;var e=arguments[0];this._geom=e};k_.prototype.filter=function(e){this._minPtDist.initialize(),yf.computeDistance(this._geom,e,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};k_.prototype.getMaxPointDistance=function(){return this._maxPtDist};k_.prototype.interfaces_=function(){return[_d]};k_.prototype.getClass=function(){return k_};var gm=function(){this._maxPtDist=new gl,this._minPtDist=new gl,this._geom=null,this._numSubSegs=0;var e=arguments[0],t=arguments[1];this._geom=e,this._numSubSegs=Math.trunc(Math.round(1/t))};gm.prototype.filter=function(e,t){var i=this;if(t===0)return null;for(var r=e.getCoordinate(t-1),a=e.getCoordinate(t),l=(a.x-r.x)/this._numSubSegs,s=(a.y-r.y)/this._numSubSegs,d=0;d<this._numSubSegs;d++){var g=r.x+d*l,x=r.y+d*s,I=new mt(g,x);i._minPtDist.initialize(),yf.computeDistance(i._geom,I,i._minPtDist),i._maxPtDist.setMaximum(i._minPtDist)}};gm.prototype.isDone=function(){return!1};gm.prototype.isGeometryChanged=function(){return!1};gm.prototype.getMaxPointDistance=function(){return this._maxPtDist};gm.prototype.interfaces_=function(){return[Ch]};gm.prototype.getClass=function(){return gm};var Su=function(e,t,i){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=e||null,this._bufDistance=t||null,this._result=i||null},KS={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};Su.prototype.checkMaximumDistance=function(e,t,i){var r=new Hc(t,e);if(r.setDensifyFraction(.25),this._maxDistanceFound=r.orientedDistance(),this._maxDistanceFound>i){this._isValid=!1;var a=r.getCoordinates();this._errorLocation=a[1],this._errorIndicator=e.getFactory().createLineString(a),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+Sh.toLineString(a[0],a[1])+")"}};Su.prototype.isValid=function(){var e=Math.abs(this._bufDistance),t=Su.MAX_DISTANCE_DIFF_FRAC*e;return this._minValidDistance=e-t,this._maxValidDistance=e+t,this._input.isEmpty()||this._result.isEmpty()?!0:(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),Su.VERBOSE&&Wa.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)};Su.prototype.checkNegativeValid=function(){if(!(this._input instanceof oa||this._input instanceof pd||this._input instanceof Nl))return null;var e=this.getPolygonLines(this._input);if(this.checkMinimumDistance(e,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(e,this._result,this._maxValidDistance)};Su.prototype.getErrorIndicator=function(){return this._errorIndicator};Su.prototype.checkMinimumDistance=function(e,t,i){var r=new Za(e,t,i);if(this._minDistanceFound=r.distance(),this._minDistanceFound<i){this._isValid=!1;var a=r.nearestPoints();this._errorLocation=r.nearestPoints()[1],this._errorIndicator=e.getFactory().createLineString(a),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+Sh.toLineString(a[0],a[1])+" )"}};Su.prototype.checkPositiveValid=function(){var e=this._result.getBoundary();if(this.checkMinimumDistance(this._input,e,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,e,this._maxValidDistance)};Su.prototype.getErrorLocation=function(){return this._errorLocation};Su.prototype.getPolygonLines=function(e){for(var t=new Un,i=new Ha(t),r=fp.getPolygons(e),a=r.iterator();a.hasNext();){var l=a.next();l.apply(i)}return e.getFactory().buildGeometry(t)};Su.prototype.getErrorMessage=function(){return this._errMsg};Su.prototype.interfaces_=function(){return[]};Su.prototype.getClass=function(){return Su};KS.VERBOSE.get=function(){return!1};KS.MAX_DISTANCE_DIFF_FRAC.get=function(){return .012};Object.defineProperties(Su,KS);var Ya=function(e,t,i){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=e||null,this._distance=t||null,this._result=i||null},JS={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};Ya.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid};Ya.prototype.checkEnvelope=function(){if(this._distance<0)return null;var e=this._distance*Ya.MAX_ENV_DIFF_FRAC;e===0&&(e=.001);var t=new Ii(this._input.getEnvelopeInternal());t.expandBy(this._distance);var i=new Ii(this._result.getEnvelopeInternal());i.expandBy(e),i.contains(t)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(i)),this.report("Envelope")};Ya.prototype.checkDistance=function(){var e=new Su(this._input,this._distance,this._result);e.isValid()||(this._isValid=!1,this._errorMsg=e.getErrorMessage(),this._errorLocation=e.getErrorLocation(),this._errorIndicator=e.getErrorIndicator()),this.report("Distance")};Ya.prototype.checkArea=function(){var e=this._input.getArea(),t=this._result.getArea();this._distance>0&&e>t&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&e<t&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")};Ya.prototype.checkPolygonal=function(){this._result instanceof oa||this._result instanceof pd||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")};Ya.prototype.getErrorIndicator=function(){return this._errorIndicator};Ya.prototype.getErrorLocation=function(){return this._errorLocation};Ya.prototype.checkExpectedEmpty=function(){if(this._input.getDimension()>=2||this._distance>0)return null;this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),this.report("ExpectedEmpty")};Ya.prototype.report=function(e){if(!Ya.VERBOSE)return null;Wa.out.println("Check "+e+": "+(this._isValid?"passed":"FAILED"))};Ya.prototype.getErrorMessage=function(){return this._errorMsg};Ya.prototype.interfaces_=function(){return[]};Ya.prototype.getClass=function(){return Ya};Ya.isValidMsg=function(e,t,i){var r=new Ya(e,t,i);return r.isValid()?null:r.getErrorMessage()};Ya.isValid=function(e,t,i){var r=new Ya(e,t,i);return!!r.isValid()};JS.VERBOSE.get=function(){return!1};JS.MAX_ENV_DIFF_FRAC.get=function(){return .012};Object.defineProperties(Ya,JS);var Df=function(){this._pts=null,this._data=null;var e=arguments[0],t=arguments[1];this._pts=e,this._data=t};Df.prototype.getCoordinates=function(){return this._pts};Df.prototype.size=function(){return this._pts.length};Df.prototype.getCoordinate=function(e){return this._pts[e]};Df.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};Df.prototype.getSegmentOctant=function(e){return e===this._pts.length-1?-1:R_.octant(this.getCoordinate(e),this.getCoordinate(e+1))};Df.prototype.setData=function(e){this._data=e};Df.prototype.getData=function(){return this._data};Df.prototype.toString=function(){return Sh.toLineString(new Ro(this._pts))};Df.prototype.interfaces_=function(){return[bd]};Df.prototype.getClass=function(){return Df};var Ca=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new Un,this._intersectionCount=0,this._keepIntersections=!0;var e=arguments[0];this._li=e,this._interiorIntersection=null};Ca.prototype.getInteriorIntersection=function(){return this._interiorIntersection};Ca.prototype.setCheckEndSegmentsOnly=function(e){this._isCheckEndSegmentsOnly=e};Ca.prototype.getIntersectionSegments=function(){return this._intSegments};Ca.prototype.count=function(){return this._intersectionCount};Ca.prototype.getIntersections=function(){return this._intersections};Ca.prototype.setFindAllIntersections=function(e){this._findAllIntersections=e};Ca.prototype.setKeepIntersections=function(e){this._keepIntersections=e};Ca.prototype.processIntersections=function(e,t,i,r){if(!this._findAllIntersections&&this.hasIntersection()||e===i&&t===r)return null;if(this._isCheckEndSegmentsOnly){var a=this.isEndSegment(e,t)||this.isEndSegment(i,r);if(!a)return null}var l=e.getCoordinates()[t],s=e.getCoordinates()[t+1],d=i.getCoordinates()[r],g=i.getCoordinates()[r+1];this._li.computeIntersection(l,s,d,g),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=l,this._intSegments[1]=s,this._intSegments[2]=d,this._intSegments[3]=g,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)};Ca.prototype.isEndSegment=function(e,t){return t===0||t>=e.size()-2};Ca.prototype.hasIntersection=function(){return this._interiorIntersection!==null};Ca.prototype.isDone=function(){return this._findAllIntersections?!1:this._interiorIntersection!==null};Ca.prototype.interfaces_=function(){return[pg]};Ca.prototype.getClass=function(){return Ca};Ca.createAllIntersectionsFinder=function(e){var t=new Ca(e);return t.setFindAllIntersections(!0),t};Ca.createAnyIntersectionFinder=function(e){return new Ca(e)};Ca.createIntersectionCounter=function(e){var t=new Ca(e);return t.setFindAllIntersections(!0),t.setKeepIntersections(!1),t};var Ph=function(){this._li=new Ig,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var e=arguments[0];this._segStrings=e};Ph.prototype.execute=function(){if(this._segInt!==null)return null;this.checkInteriorIntersections()};Ph.prototype.getIntersections=function(){return this._segInt.getIntersections()};Ph.prototype.isValid=function(){return this.execute(),this._isValid};Ph.prototype.setFindAllIntersections=function(e){this._findAllIntersections=e};Ph.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Ca(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var e=new XS;if(e.setSegmentIntersector(this._segInt),e.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null};Ph.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new gp(this.getErrorMessage(),this._segInt.getInteriorIntersection())};Ph.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var e=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Sh.toLineString(e[0],e[1])+" and "+Sh.toLineString(e[2],e[3])};Ph.prototype.interfaces_=function(){return[]};Ph.prototype.getClass=function(){return Ph};Ph.computeIntersections=function(e){var t=new Ph(e);return t.setFindAllIntersections(!0),t.isValid(),t.getIntersections()};var _g=function n(){this._nv=null;var e=arguments[0];this._nv=new Ph(n.toSegmentStrings(e))};_g.prototype.checkValid=function(){this._nv.checkValid()};_g.prototype.interfaces_=function(){return[]};_g.prototype.getClass=function(){return _g};_g.toSegmentStrings=function(e){for(var t=new Un,i=e.iterator();i.hasNext();){var r=i.next();t.add(new Df(r.getCoordinates(),r))}return t};_g.checkValid=function(e){var t=new _g(e);t.checkValid()};var F_=function(e){this._mapOp=e};F_.prototype.map=function(e){for(var t=this,i=new Un,r=0;r<e.getNumGeometries();r++){var a=t._mapOp.map(e.getGeometryN(r));a.isEmpty()||i.add(a)}return e.getFactory().createGeometryCollection(Lr.toGeometryArray(i))};F_.prototype.interfaces_=function(){return[]};F_.prototype.getClass=function(){return F_};F_.map=function(e,t){var i=new F_(t);return i.map(e)};var Of=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new Un,this._resultLineList=new Un;var e=arguments[0],t=arguments[1],i=arguments[2];this._op=e,this._geometryFactory=t,this._ptLocator=i};Of.prototype.collectLines=function(e){for(var t=this,i=this._op.getGraph().getEdgeEnds().iterator();i.hasNext();){var r=i.next();t.collectLineEdge(r,e,t._lineEdgesList),t.collectBoundaryTouchEdge(r,e,t._lineEdgesList)}};Of.prototype.labelIsolatedLine=function(e,t){var i=this._ptLocator.locate(e.getCoordinate(),this._op.getArgGeometry(t));e.getLabel().setLocation(t,i)};Of.prototype.build=function(e){return this.findCoveredLineEdges(),this.collectLines(e),this.buildLines(e),this._resultLineList};Of.prototype.collectLineEdge=function(e,t,i){var r=e.getLabel(),a=e.getEdge();e.isLineEdge()&&!e.isVisited()&&cr.isResultOfOp(r,t)&&!a.isCovered()&&(i.add(a),e.setVisitedEdge(!0))};Of.prototype.findCoveredLineEdges=function(){for(var e=this,t=this._op.getGraph().getNodes().iterator();t.hasNext();){var i=t.next();i.getEdges().findCoveredLineEdges()}for(var r=this._op.getGraph().getEdgeEnds().iterator();r.hasNext();){var a=r.next(),l=a.getEdge();if(a.isLineEdge()&&!l.isCoveredSet()){var s=e._op.isCoveredByA(a.getCoordinate());l.setCovered(s)}}};Of.prototype.labelIsolatedLines=function(e){for(var t=this,i=e.iterator();i.hasNext();){var r=i.next(),a=r.getLabel();r.isIsolated()&&(a.isNull(0)?t.labelIsolatedLine(r,0):t.labelIsolatedLine(r,1))}};Of.prototype.buildLines=function(e){for(var t=this,i=this._lineEdgesList.iterator();i.hasNext();){var r=i.next(),a=t._geometryFactory.createLineString(r.getCoordinates());t._resultLineList.add(a),r.setInResult(!0)}};Of.prototype.collectBoundaryTouchEdge=function(e,t,i){var r=e.getLabel();if(e.isLineEdge()||e.isVisited()||e.isInteriorAreaEdge()||e.getEdge().isInResult())return null;dr.isTrue(!(e.isInResult()||e.getSym().isInResult())||!e.getEdge().isInResult()),cr.isResultOfOp(r,t)&&t===cr.INTERSECTION&&(i.add(e.getEdge()),e.setVisitedEdge(!0))};Of.prototype.interfaces_=function(){return[]};Of.prototype.getClass=function(){return Of};var B_=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new Un;var e=arguments[0],t=arguments[1];this._op=e,this._geometryFactory=t};B_.prototype.filterCoveredNodeToPoint=function(e){var t=e.getCoordinate();if(!this._op.isCoveredByLA(t)){var i=this._geometryFactory.createPoint(t);this._resultPointList.add(i)}};B_.prototype.extractNonCoveredResultNodes=function(e){for(var t=this,i=this._op.getGraph().getNodes().iterator();i.hasNext();){var r=i.next();if(!r.isInResult()&&!r.isIncidentEdgeInResult()&&(r.getEdges().getDegree()===0||e===cr.INTERSECTION)){var a=r.getLabel();cr.isResultOfOp(a,e)&&t.filterCoveredNodeToPoint(r)}}};B_.prototype.build=function(e){return this.extractNonCoveredResultNodes(e),this._resultPointList};B_.prototype.interfaces_=function(){return[]};B_.prototype.getClass=function(){return B_};var au=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};au.prototype.transformPoint=function(e,t){return this._factory.createPoint(this.transformCoordinates(e.getCoordinateSequence(),e))};au.prototype.transformPolygon=function(e,t){var i=this,r=!0,a=this.transformLinearRing(e.getExteriorRing(),e);(a===null||!(a instanceof yd)||a.isEmpty())&&(r=!1);for(var l=new Un,s=0;s<e.getNumInteriorRing();s++){var d=i.transformLinearRing(e.getInteriorRingN(s),e);d===null||d.isEmpty()||(d instanceof yd||(r=!1),l.add(d))}if(r)return this._factory.createPolygon(a,l.toArray([]));var g=new Un;return a!==null&&g.add(a),g.addAll(l),this._factory.buildGeometry(g)};au.prototype.createCoordinateSequence=function(e){return this._factory.getCoordinateSequenceFactory().create(e)};au.prototype.getInputGeometry=function(){return this._inputGeom};au.prototype.transformMultiLineString=function(e,t){for(var i=this,r=new Un,a=0;a<e.getNumGeometries();a++){var l=i.transformLineString(e.getGeometryN(a),e);l!==null&&(l.isEmpty()||r.add(l))}return this._factory.buildGeometry(r)};au.prototype.transformCoordinates=function(e,t){return this.copy(e)};au.prototype.transformLineString=function(e,t){return this._factory.createLineString(this.transformCoordinates(e.getCoordinateSequence(),e))};au.prototype.transformMultiPoint=function(e,t){for(var i=this,r=new Un,a=0;a<e.getNumGeometries();a++){var l=i.transformPoint(e.getGeometryN(a),e);l!==null&&(l.isEmpty()||r.add(l))}return this._factory.buildGeometry(r)};au.prototype.transformMultiPolygon=function(e,t){for(var i=this,r=new Un,a=0;a<e.getNumGeometries();a++){var l=i.transformPolygon(e.getGeometryN(a),e);l!==null&&(l.isEmpty()||r.add(l))}return this._factory.buildGeometry(r)};au.prototype.copy=function(e){return e.copy()};au.prototype.transformGeometryCollection=function(e,t){for(var i=this,r=new Un,a=0;a<e.getNumGeometries();a++){var l=i.transform(e.getGeometryN(a));l!==null&&(i._pruneEmptyGeometry&&l.isEmpty()||r.add(l))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(Lr.toGeometryArray(r)):this._factory.buildGeometry(r)};au.prototype.transform=function(e){if(this._inputGeom=e,this._factory=e.getFactory(),e instanceof Au)return this.transformPoint(e,null);if(e instanceof Hv)return this.transformMultiPoint(e,null);if(e instanceof yd)return this.transformLinearRing(e,null);if(e instanceof Io)return this.transformLineString(e,null);if(e instanceof hg)return this.transformMultiLineString(e,null);if(e instanceof oa)return this.transformPolygon(e,null);if(e instanceof pd)return this.transformMultiPolygon(e,null);if(e instanceof Nl)return this.transformGeometryCollection(e,null);throw new io("Unknown Geometry subtype: "+e.getClass().getName())};au.prototype.transformLinearRing=function(e,t){var i=this.transformCoordinates(e.getCoordinateSequence(),e);if(i===null)return this._factory.createLinearRing(null);var r=i.size();return r>0&&r<4&&!this._preserveType?this._factory.createLineString(i):this._factory.createLinearRing(i)};au.prototype.interfaces_=function(){return[]};au.prototype.getClass=function(){return au};var Id=function n(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new wi,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Io&&typeof arguments[1]=="number"){var e=arguments[0],t=arguments[1];n.call(this,e.getCoordinates(),t)}else if(arguments[0]instanceof Array&&typeof arguments[1]=="number"){var i=arguments[0],r=arguments[1];this._srcPts=i,this._isClosed=n.isClosed(i),this._snapTolerance=r}};Id.prototype.snapVertices=function(e,t){for(var i=this,r=this._isClosed?e.size()-1:e.size(),a=0;a<r;a++){var l=e.get(a),s=i.findSnapForVertex(l,t);s!==null&&(e.set(a,new mt(s)),a===0&&i._isClosed&&e.set(e.size()-1,new mt(s)))}};Id.prototype.findSnapForVertex=function(e,t){for(var i=this,r=0;r<t.length;r++){if(e.equals2D(t[r]))return null;if(e.distance(t[r])<i._snapTolerance)return t[r]}return null};Id.prototype.snapTo=function(e){var t=new mb(this._srcPts);this.snapVertices(t,e),this.snapSegments(t,e);var i=t.toCoordinateArray();return i};Id.prototype.snapSegments=function(e,t){var i=this;if(t.length===0)return null;var r=t.length;t[0].equals2D(t[t.length-1])&&(r=t.length-1);for(var a=0;a<r;a++){var l=t[a],s=i.findSegmentIndexToSnap(l,e);s>=0&&e.add(s+1,new mt(l),!1)}};Id.prototype.findSegmentIndexToSnap=function(e,t){for(var i=this,r=rr.MAX_VALUE,a=-1,l=0;l<t.size()-1;l++){if(i._seg.p0=t.get(l),i._seg.p1=t.get(l+1),i._seg.p0.equals2D(e)||i._seg.p1.equals2D(e)){if(i._allowSnappingToSourceVertices)continue;return-1}var s=i._seg.distance(e);s<i._snapTolerance&&s<r&&(r=s,a=l)}return a};Id.prototype.setAllowSnappingToSourceVertices=function(e){this._allowSnappingToSourceVertices=e};Id.prototype.interfaces_=function(){return[]};Id.prototype.getClass=function(){return Id};Id.isClosed=function(e){return e.length<=1?!1:e[0].equals2D(e[e.length-1])};var Po=function(e){this._srcGeom=e||null},wR={SNAP_PRECISION_FACTOR:{configurable:!0}};Po.prototype.snapTo=function(e,t){var i=this.extractTargetCoordinates(e),r=new SR(t,i);return r.transform(this._srcGeom)};Po.prototype.snapToSelf=function(e,t){var i=this.extractTargetCoordinates(this._srcGeom),r=new SR(e,i,!0),a=r.transform(this._srcGeom),l=a;return t&&Hi(l,cm)&&(l=a.buffer(0)),l};Po.prototype.computeSnapTolerance=function(e){var t=this.computeMinimumSegmentLength(e),i=t/10;return i};Po.prototype.extractTargetCoordinates=function(e){for(var t=new Sf,i=e.getCoordinates(),r=0;r<i.length;r++)t.add(i[r]);return t.toArray(new Array(0).fill(null))};Po.prototype.computeMinimumSegmentLength=function(e){for(var t=rr.MAX_VALUE,i=0;i<e.length-1;i++){var r=e[i].distance(e[i+1]);r<t&&(t=r)}return t};Po.prototype.interfaces_=function(){return[]};Po.prototype.getClass=function(){return Po};Po.snap=function(e,t,i){var r=new Array(2).fill(null),a=new Po(e);r[0]=a.snapTo(t,i);var l=new Po(t);return r[1]=l.snapTo(r[0],i),r};Po.computeOverlaySnapTolerance=function(){if(arguments.length===1){var e=arguments[0],t=Po.computeSizeBasedSnapTolerance(e),i=e.getPrecisionModel();if(i.getType()===ns.FIXED){var r=1/i.getScale()*2/1.415;r>t&&(t=r)}return t}else if(arguments.length===2){var a=arguments[0],l=arguments[1];return Math.min(Po.computeOverlaySnapTolerance(a),Po.computeOverlaySnapTolerance(l))}};Po.computeSizeBasedSnapTolerance=function(e){var t=e.getEnvelopeInternal(),i=Math.min(t.getHeight(),t.getWidth()),r=i*Po.SNAP_PRECISION_FACTOR;return r};Po.snapToSelf=function(e,t,i){var r=new Po(e);return r.snapToSelf(t,i)};wR.SNAP_PRECISION_FACTOR.get=function(){return 1e-9};Object.defineProperties(Po,wR);var SR=function(n){function e(t,i,r){n.call(this),this._snapTolerance=t||null,this._snapPts=i||null,this._isSelfSnap=r!==void 0?r:!1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.snapLine=function(i,r){var a=new Id(i,this._snapTolerance);return a.setAllowSnappingToSourceVertices(this._isSelfSnap),a.snapTo(r)},e.prototype.transformCoordinates=function(i,r){var a=i.toCoordinateArray(),l=this.snapLine(a,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(l)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(au),Ml=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};Ml.prototype.getCommon=function(){return rr.longBitsToDouble(this._commonBits)};Ml.prototype.add=function(e){var t=rr.doubleToLongBits(e);if(this._isFirst)return this._commonBits=t,this._commonSignExp=Ml.signExpBits(this._commonBits),this._isFirst=!1,null;var i=Ml.signExpBits(t);if(i!==this._commonSignExp)return this._commonBits=0,null;this._commonMantissaBitsCount=Ml.numCommonMostSigMantissaBits(this._commonBits,t),this._commonBits=Ml.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))};Ml.prototype.toString=function(){if(arguments.length===1){var e=arguments[0],t=rr.longBitsToDouble(e),i=rr.toBinaryString(e),r="0000000000000000000000000000000000000000000000000000000000000000"+i,a=r.substring(r.length-64),l=a.substring(0,1)+"  "+a.substring(1,12)+"(exp) "+a.substring(12)+" [ "+t+" ]";return l}};Ml.prototype.interfaces_=function(){return[]};Ml.prototype.getClass=function(){return Ml};Ml.getBit=function(e,t){var i=1<<t;return e&i?1:0};Ml.signExpBits=function(e){return e>>52};Ml.zeroLowerBits=function(e,t){var i=(1<<t)-1,r=~i,a=e&r;return a};Ml.numCommonMostSigMantissaBits=function(e,t){for(var i=0,r=52;r>=0;r--){if(Ml.getBit(e,r)!==Ml.getBit(t,r))return i;i++}return 52};var _m=function(){this._commonCoord=null,this._ccFilter=new z_},QS={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};_m.prototype.addCommonBits=function(e){var t=new ym(this._commonCoord);e.apply(t),e.geometryChanged()};_m.prototype.removeCommonBits=function(e){if(this._commonCoord.x===0&&this._commonCoord.y===0)return e;var t=new mt(this._commonCoord);t.x=-t.x,t.y=-t.y;var i=new ym(t);return e.apply(i),e.geometryChanged(),e};_m.prototype.getCommonCoordinate=function(){return this._commonCoord};_m.prototype.add=function(e){e.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()};_m.prototype.interfaces_=function(){return[]};_m.prototype.getClass=function(){return _m};QS.CommonCoordinateFilter.get=function(){return z_};QS.Translater.get=function(){return ym};Object.defineProperties(_m,QS);var z_=function(){this._commonBitsX=new Ml,this._commonBitsY=new Ml};z_.prototype.filter=function(e){this._commonBitsX.add(e.x),this._commonBitsY.add(e.y)};z_.prototype.getCommonCoordinate=function(){return new mt(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())};z_.prototype.interfaces_=function(){return[_d]};z_.prototype.getClass=function(){return z_};var ym=function(){this.trans=null;var e=arguments[0];this.trans=e};ym.prototype.filter=function(e,t){var i=e.getOrdinate(t,0)+this.trans.x,r=e.getOrdinate(t,1)+this.trans.y;e.setOrdinate(t,0,i),e.setOrdinate(t,1,r)};ym.prototype.isDone=function(){return!1};ym.prototype.isGeometryChanged=function(){return!0};ym.prototype.interfaces_=function(){return[Ch]};ym.prototype.getClass=function(){return ym};var Aa=function(e,t){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=e,this._geom[1]=t,this.computeSnapTolerance()};Aa.prototype.selfSnap=function(e){var t=new Po(e),i=t.snapTo(e,this._snapTolerance);return i};Aa.prototype.removeCommonBits=function(e){this._cbr=new _m,this._cbr.add(e[0]),this._cbr.add(e[1]);var t=new Array(2).fill(null);return t[0]=this._cbr.removeCommonBits(e[0].copy()),t[1]=this._cbr.removeCommonBits(e[1].copy()),t};Aa.prototype.prepareResult=function(e){return this._cbr.addCommonBits(e),e};Aa.prototype.getResultGeometry=function(e){var t=this.snap(this._geom),i=cr.overlayOp(t[0],t[1],e);return this.prepareResult(i)};Aa.prototype.checkValid=function(e){e.isValid()||Wa.out.println("Snapped geometry is invalid")};Aa.prototype.computeSnapTolerance=function(){this._snapTolerance=Po.computeOverlaySnapTolerance(this._geom[0],this._geom[1])};Aa.prototype.snap=function(e){var t=this.removeCommonBits(e),i=Po.snap(t[0],t[1],this._snapTolerance);return i};Aa.prototype.interfaces_=function(){return[]};Aa.prototype.getClass=function(){return Aa};Aa.overlayOp=function(e,t,i){var r=new Aa(e,t);return r.getResultGeometry(i)};Aa.union=function(e,t){return Aa.overlayOp(e,t,cr.UNION)};Aa.intersection=function(e,t){return Aa.overlayOp(e,t,cr.INTERSECTION)};Aa.symDifference=function(e,t){return Aa.overlayOp(e,t,cr.SYMDIFFERENCE)};Aa.difference=function(e,t){return Aa.overlayOp(e,t,cr.DIFFERENCE)};var Bl=function(e,t){this._geom=new Array(2).fill(null),this._geom[0]=e,this._geom[1]=t};Bl.prototype.getResultGeometry=function(e){var t=null,i=!1,r=null;try{t=cr.overlayOp(this._geom[0],this._geom[1],e);var a=!0;a&&(i=!0)}catch(l){if(l instanceof pp)r=l;else throw l}finally{}if(!i)try{t=Aa.overlayOp(this._geom[0],this._geom[1],e)}catch(l){throw l instanceof pp?r:l}finally{}return t};Bl.prototype.interfaces_=function(){return[]};Bl.prototype.getClass=function(){return Bl};Bl.overlayOp=function(e,t,i){var r=new Bl(e,t);return r.getResultGeometry(i)};Bl.union=function(e,t){return Bl.overlayOp(e,t,cr.UNION)};Bl.intersection=function(e,t){return Bl.overlayOp(e,t,cr.INTERSECTION)};Bl.symDifference=function(e,t){return Bl.overlayOp(e,t,cr.SYMDIFFERENCE)};Bl.difference=function(e,t){return Bl.overlayOp(e,t,cr.DIFFERENCE)};var eb=function(){this.mce=null,this.chainIndex=null;var e=arguments[0],t=arguments[1];this.mce=e,this.chainIndex=t};eb.prototype.computeIntersections=function(e,t){this.mce.computeIntersectsForChain(this.chainIndex,e.mce,e.chainIndex,t)};eb.prototype.interfaces_=function(){return[]};eb.prototype.getClass=function(){return eb};var Ru=function n(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,arguments.length===2){var e=arguments[0],t=arguments[1];this._eventType=n.DELETE,this._xValue=e,this._insertEvent=t}else if(arguments.length===3){var i=arguments[0],r=arguments[1],a=arguments[2];this._eventType=n.INSERT,this._label=i,this._xValue=r,this._obj=a}},$S={INSERT:{configurable:!0},DELETE:{configurable:!0}};Ru.prototype.isDelete=function(){return this._eventType===Ru.DELETE};Ru.prototype.setDeleteEventIndex=function(e){this._deleteEventIndex=e};Ru.prototype.getObject=function(){return this._obj};Ru.prototype.compareTo=function(e){var t=e;return this._xValue<t._xValue?-1:this._xValue>t._xValue?1:this._eventType<t._eventType?-1:this._eventType>t._eventType?1:0};Ru.prototype.getInsertEvent=function(){return this._insertEvent};Ru.prototype.isInsert=function(){return this._eventType===Ru.INSERT};Ru.prototype.isSameLabel=function(e){return this._label===null?!1:this._label===e._label};Ru.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex};Ru.prototype.interfaces_=function(){return[Kc]};Ru.prototype.getClass=function(){return Ru};$S.INSERT.get=function(){return 1};$S.DELETE.get=function(){return 2};Object.defineProperties(Ru,$S);var XE=function(){};XE.prototype.interfaces_=function(){return[]};XE.prototype.getClass=function(){return XE};var Ka=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var e=arguments[0],t=arguments[1],i=arguments[2];this._li=e,this._includeProper=t,this._recordIsolated=i};Ka.prototype.isTrivialIntersection=function(e,t,i,r){if(e===i&&this._li.getIntersectionNum()===1){if(Ka.isAdjacentSegments(t,r))return!0;if(e.isClosed()){var a=e.getNumPoints()-1;if(t===0&&r===a||r===0&&t===a)return!0}}return!1};Ka.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};Ka.prototype.setIsDoneIfProperInt=function(e){this._isDoneWhenProperInt=e};Ka.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};Ka.prototype.isBoundaryPointInternal=function(e,t){for(var i=t.iterator();i.hasNext();){var r=i.next(),a=r.getCoordinate();if(e.isIntersection(a))return!0}return!1};Ka.prototype.hasProperIntersection=function(){return this._hasProper};Ka.prototype.hasIntersection=function(){return this._hasIntersection};Ka.prototype.isDone=function(){return this._isDone};Ka.prototype.isBoundaryPoint=function(e,t){return t===null?!1:!!(this.isBoundaryPointInternal(e,t[0])||this.isBoundaryPointInternal(e,t[1]))};Ka.prototype.setBoundaryNodes=function(e,t){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=e,this._bdyNodes[1]=t};Ka.prototype.addIntersections=function(e,t,i,r){if(e===i&&t===r)return null;this.numTests++;var a=e.getCoordinates()[t],l=e.getCoordinates()[t+1],s=i.getCoordinates()[r],d=i.getCoordinates()[r+1];this._li.computeIntersection(a,l,s,d),this._li.hasIntersection()&&(this._recordIsolated&&(e.setIsolated(!1),i.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(e,t,i,r)||(this._hasIntersection=!0,(this._includeProper||!this._li.isProper())&&(e.addIntersections(this._li,t,0),i.addIntersections(this._li,r,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))};Ka.prototype.interfaces_=function(){return[]};Ka.prototype.getClass=function(){return Ka};Ka.isAdjacentSegments=function(e,t){return Math.abs(e-t)===1};var K5=function(n){function e(){n.call(this),this.events=new Un,this.nOverlaps=null}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.prepareEvents=function(){var i=this;Mh.sort(this.events);for(var r=0;r<this.events.size();r++){var a=i.events.get(r);a.isDelete()&&a.getInsertEvent().setDeleteEventIndex(r)}},e.prototype.computeIntersections=function(){var i=this;if(arguments.length===1){var r=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var a=0;a<this.events.size();a++){var l=i.events.get(a);if(l.isInsert()&&i.processOverlaps(a,l.getDeleteEventIndex(),l,r),r.isDone())break}}else if(arguments.length===3){if(arguments[2]instanceof Ka&&Hi(arguments[0],Th)&&Hi(arguments[1],Th)){var s=arguments[0],d=arguments[1],g=arguments[2];this.addEdges(s,s),this.addEdges(d,d),this.computeIntersections(g)}else if(typeof arguments[2]=="boolean"&&Hi(arguments[0],Th)&&arguments[1]instanceof Ka){var x=arguments[0],I=arguments[1],A=arguments[2];A?this.addEdges(x,null):this.addEdges(x),this.computeIntersections(I)}}},e.prototype.addEdge=function(i,r){for(var a=this,l=i.getMonotoneChainEdge(),s=l.getStartIndexes(),d=0;d<s.length-1;d++){var g=new eb(l,d),x=new Ru(r,l.getMinX(d),g);a.events.add(x),a.events.add(new Ru(l.getMaxX(d),x))}},e.prototype.processOverlaps=function(i,r,a,l){for(var s=this,d=a.getObject(),g=i;g<r;g++){var x=s.events.get(g);if(x.isInsert()){var I=x.getObject();a.isSameLabel(x)||(d.computeIntersections(I,l),s.nOverlaps++)}}},e.prototype.addEdges=function(){var i=this;if(arguments.length===1)for(var r=arguments[0],a=r.iterator();a.hasNext();){var l=a.next();i.addEdge(l,l)}else if(arguments.length===2)for(var s=arguments[0],d=arguments[1],g=s.iterator();g.hasNext();){var x=g.next();i.addEdge(x,d)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(XE),Td=function(){this._min=rr.POSITIVE_INFINITY,this._max=rr.NEGATIVE_INFINITY},CR={NodeComparator:{configurable:!0}};Td.prototype.getMin=function(){return this._min};Td.prototype.intersects=function(e,t){return!(this._min>t||this._max<e)};Td.prototype.getMax=function(){return this._max};Td.prototype.toString=function(){return Sh.toLineString(new mt(this._min,0),new mt(this._max,0))};Td.prototype.interfaces_=function(){return[]};Td.prototype.getClass=function(){return Td};CR.NodeComparator.get=function(){return tb};Object.defineProperties(Td,CR);var tb=function(){};tb.prototype.compare=function(e,t){var i=e,r=t,a=(i._min+i._max)/2,l=(r._min+r._max)/2;return a<l?-1:a>l?1:0};tb.prototype.interfaces_=function(){return[kv]};tb.prototype.getClass=function(){return tb};var J5=function(n){function e(){n.call(this),this._item=null;var t=arguments[0],i=arguments[1],r=arguments[2];this._min=t,this._max=i,this._item=r}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.query=function(i,r,a){if(!this.intersects(i,r))return null;a.visitItem(this._item)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Td),Q5=function(n){function e(){n.call(this),this._node1=null,this._node2=null;var t=arguments[0],i=arguments[1];this._node1=t,this._node2=i,this.buildExtent(this._node1,this._node2)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.buildExtent=function(i,r){this._min=Math.min(i._min,r._min),this._max=Math.max(i._max,r._max)},e.prototype.query=function(i,r,a){if(!this.intersects(i,r))return null;this._node1!==null&&this._node1.query(i,r,a),this._node2!==null&&this._node2.query(i,r,a)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Td),wd=function(){this._leaves=new Un,this._root=null,this._level=0};wd.prototype.buildTree=function(){var e=this;Mh.sort(this._leaves,new Td.NodeComparator);for(var t=this._leaves,i=null,r=new Un;;){if(e.buildLevel(t,r),r.size()===1)return r.get(0);i=t,t=r,r=i}};wd.prototype.insert=function(e,t,i){if(this._root!==null)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new J5(e,t,i))};wd.prototype.query=function(e,t,i){this.init(),this._root.query(e,t,i)};wd.prototype.buildRoot=function(){if(this._root!==null)return null;this._root=this.buildTree()};wd.prototype.printNode=function(e){Wa.out.println(Sh.toLineString(new mt(e._min,this._level),new mt(e._max,this._level)))};wd.prototype.init=function(){if(this._root!==null)return null;this.buildRoot()};wd.prototype.buildLevel=function(e,t){this._level++,t.clear();for(var i=0;i<e.size();i+=2){var r=e.get(i),a=i+1<e.size()?e.get(i):null;if(a===null)t.add(r);else{var l=new Q5(e.get(i),e.get(i+1));t.add(l)}}};wd.prototype.interfaces_=function(){return[]};wd.prototype.getClass=function(){return wd};var Yv=function(){this._items=new Un};Yv.prototype.visitItem=function(e){this._items.add(e)};Yv.prototype.getItems=function(){return this._items};Yv.prototype.interfaces_=function(){return[hm]};Yv.prototype.getClass=function(){return Yv};var Kv=function(){this._index=null;var e=arguments[0];if(!Hi(e,cm))throw new io("Argument must be Polygonal");this._index=new yg(e)},eC={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};Kv.prototype.locate=function(e){var t=new If(e),i=new Jv(t);return this._index.query(e.y,e.y,i),t.getLocation()};Kv.prototype.interfaces_=function(){return[Xv]};Kv.prototype.getClass=function(){return Kv};eC.SegmentVisitor.get=function(){return Jv};eC.IntervalIndexedGeometry.get=function(){return yg};Object.defineProperties(Kv,eC);var Jv=function(){this._counter=null;var e=arguments[0];this._counter=e};Jv.prototype.visitItem=function(e){var t=e;this._counter.countSegment(t.getCoordinate(0),t.getCoordinate(1))};Jv.prototype.interfaces_=function(){return[hm]};Jv.prototype.getClass=function(){return Jv};var yg=function(){this._index=new wd;var e=arguments[0];this.init(e)};yg.prototype.init=function(e){for(var t=this,i=Ha.getLines(e),r=i.iterator();r.hasNext();){var a=r.next(),l=a.getCoordinates();t.addLine(l)}};yg.prototype.addLine=function(e){for(var t=this,i=1;i<e.length;i++){var r=new wi(e[i-1],e[i]),a=Math.min(r.p0.y,r.p1.y),l=Math.max(r.p0.y,r.p1.y);t._index.insert(a,l,r)}};yg.prototype.query=function(){if(arguments.length===2){var e=arguments[0],t=arguments[1],i=new Yv;return this._index.query(e,t,i),i.getItems()}else if(arguments.length===3){var r=arguments[0],a=arguments[1],l=arguments[2];this._index.query(r,a,l)}};yg.prototype.interfaces_=function(){return[]};yg.prototype.getClass=function(){return yg};var x1=function(n){function e(){if(n.call(this),this._parentGeom=null,this._lineEdgeMap=new cR,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Rh,arguments.length===2){var t=arguments[0],i=arguments[1],r=qc.OGC_SFS_BOUNDARY_RULE;this._argIndex=t,this._parentGeom=i,this._boundaryNodeRule=r,i!==null&&this.add(i)}else if(arguments.length===3){var a=arguments[0],l=arguments[1],s=arguments[2];this._argIndex=a,this._parentGeom=l,this._boundaryNodeRule=s,l!==null&&this.add(l)}}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.insertBoundaryPoint=function(i,r){var a=this._nodes.addNode(r),l=a.getLabel(),s=1,d=wt.NONE;d=l.getLocation(i,Mn.ON),d===wt.BOUNDARY&&s++;var g=e.determineBoundary(this._boundaryNodeRule,s);l.setLocation(i,g)},e.prototype.computeSelfNodes=function(){if(arguments.length===2){var i=arguments[0],r=arguments[1];return this.computeSelfNodes(i,r,!1)}else if(arguments.length===3){var a=arguments[0],l=arguments[1],s=arguments[2],d=new Ka(a,!0,!1);d.setIsDoneIfProperInt(s);var g=this.createEdgeSetIntersector(),x=this._parentGeom instanceof yd||this._parentGeom instanceof oa||this._parentGeom instanceof pd,I=l||!x;return g.computeIntersections(this._edges,d,I),this.addSelfIntersectionNodes(this._argIndex),d}},e.prototype.computeSplitEdges=function(i){for(var r=this._edges.iterator();r.hasNext();){var a=r.next();a.eiList.addSplitEdges(i)}},e.prototype.computeEdgeIntersections=function(i,r,a){var l=new Ka(r,a,!0);l.setBoundaryNodes(this.getBoundaryNodes(),i.getBoundaryNodes());var s=this.createEdgeSetIntersector();return s.computeIntersections(this._edges,i._edges,l),l},e.prototype.getGeometry=function(){return this._parentGeom},e.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},e.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},e.prototype.addPoint=function(){if(arguments[0]instanceof Au){var i=arguments[0],r=i.getCoordinate();this.insertPoint(this._argIndex,r,wt.INTERIOR)}else if(arguments[0]instanceof mt){var a=arguments[0];this.insertPoint(this._argIndex,a,wt.INTERIOR)}},e.prototype.addPolygon=function(i){var r=this;this.addPolygonRing(i.getExteriorRing(),wt.EXTERIOR,wt.INTERIOR);for(var a=0;a<i.getNumInteriorRing();a++){var l=i.getInteriorRingN(a);r.addPolygonRing(l,wt.INTERIOR,wt.EXTERIOR)}},e.prototype.addEdge=function(i){this.insertEdge(i);var r=i.getCoordinates();this.insertPoint(this._argIndex,r[0],wt.BOUNDARY),this.insertPoint(this._argIndex,r[r.length-1],wt.BOUNDARY)},e.prototype.addLineString=function(i){var r=Rr.removeRepeatedPoints(i.getCoordinates());if(r.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=r[0],null;var a=new WE(r,new fs(this._argIndex,wt.INTERIOR));this._lineEdgeMap.put(i,a),this.insertEdge(a),dr.isTrue(r.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,r[0]),this.insertBoundaryPoint(this._argIndex,r[r.length-1])},e.prototype.getInvalidPoint=function(){return this._invalidPoint},e.prototype.getBoundaryPoints=function(){for(var i=this.getBoundaryNodes(),r=new Array(i.size()).fill(null),a=0,l=i.iterator();l.hasNext();){var s=l.next();r[a++]=s.getCoordinate().copy()}return r},e.prototype.getBoundaryNodes=function(){return this._boundaryNodes===null&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},e.prototype.addSelfIntersectionNode=function(i,r,a){if(this.isBoundaryNode(i,r))return null;a===wt.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(i,r):this.insertPoint(i,r,a)},e.prototype.addPolygonRing=function(i,r,a){if(i.isEmpty())return null;var l=Rr.removeRepeatedPoints(i.getCoordinates());if(l.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=l[0],null;var s=r,d=a;Jn.isCCW(l)&&(s=a,d=r);var g=new WE(l,new fs(this._argIndex,wt.BOUNDARY,s,d));this._lineEdgeMap.put(i,g),this.insertEdge(g),this.insertPoint(this._argIndex,l[0],wt.BOUNDARY)},e.prototype.insertPoint=function(i,r,a){var l=this._nodes.addNode(r),s=l.getLabel();s===null?l._label=new fs(i,a):s.setLocation(i,a)},e.prototype.createEdgeSetIntersector=function(){return new K5},e.prototype.addSelfIntersectionNodes=function(i){for(var r=this,a=this._edges.iterator();a.hasNext();)for(var l=a.next(),s=l.getLabel().getLocation(i),d=l.eiList.iterator();d.hasNext();){var g=d.next();r.addSelfIntersectionNode(i,g.coord,s)}},e.prototype.add=function(){if(arguments.length===1){var i=arguments[0];if(i.isEmpty())return null;if(i instanceof pd&&(this._useBoundaryDeterminationRule=!1),i instanceof oa)this.addPolygon(i);else if(i instanceof Io)this.addLineString(i);else if(i instanceof Au)this.addPoint(i);else if(i instanceof Hv)this.addCollection(i);else if(i instanceof hg)this.addCollection(i);else if(i instanceof pd)this.addCollection(i);else if(i instanceof Nl)this.addCollection(i);else throw new Error(i.getClass().getName())}else return n.prototype.add.apply(this,arguments)},e.prototype.addCollection=function(i){for(var r=this,a=0;a<i.getNumGeometries();a++){var l=i.getGeometryN(a);r.add(l)}},e.prototype.locate=function(i){return Hi(this._parentGeom,cm)&&this._parentGeom.getNumGeometries()>50?(this._areaPtLocator===null&&(this._areaPtLocator=new Kv(this._parentGeom)),this._areaPtLocator.locate(i)):this._ptLocator.locate(i,this._parentGeom)},e.prototype.findEdge=function(){if(arguments.length===1){var i=arguments[0];return this._lineEdgeMap.get(i)}else return n.prototype.findEdge.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.determineBoundary=function(i,r){return i.isInBoundary(r)?wt.BOUNDARY:wt.INTERIOR},e}(po),Qv=function(){if(this._li=new Ig,this._resultPrecisionModel=null,this._arg=null,arguments.length===1){var e=arguments[0];this.setComputationPrecision(e.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new x1(0,e)}else if(arguments.length===2){var t=arguments[0],i=arguments[1],r=qc.OGC_SFS_BOUNDARY_RULE;t.getPrecisionModel().compareTo(i.getPrecisionModel())>=0?this.setComputationPrecision(t.getPrecisionModel()):this.setComputationPrecision(i.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new x1(0,t,r),this._arg[1]=new x1(1,i,r)}else if(arguments.length===3){var a=arguments[0],l=arguments[1],s=arguments[2];a.getPrecisionModel().compareTo(l.getPrecisionModel())>=0?this.setComputationPrecision(a.getPrecisionModel()):this.setComputationPrecision(l.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new x1(0,a,s),this._arg[1]=new x1(1,l,s)}};Qv.prototype.getArgGeometry=function(e){return this._arg[e].getGeometry()};Qv.prototype.setComputationPrecision=function(e){this._resultPrecisionModel=e,this._li.setPrecisionModel(this._resultPrecisionModel)};Qv.prototype.interfaces_=function(){return[]};Qv.prototype.getClass=function(){return Qv};var sg=function(){};sg.prototype.interfaces_=function(){return[]};sg.prototype.getClass=function(){return sg};sg.map=function(){if(arguments[0]instanceof Bi&&Hi(arguments[1],sg.MapOp)){for(var e=arguments[0],t=arguments[1],i=new Un,r=0;r<e.getNumGeometries();r++){var a=t.map(e.getGeometryN(r));a!==null&&i.add(a)}return e.getFactory().buildGeometry(i)}else if(Hi(arguments[0],ta)&&Hi(arguments[1],sg.MapOp)){for(var l=arguments[0],s=arguments[1],d=new Un,g=l.iterator();g.hasNext();){var x=g.next(),I=s.map(x);I!==null&&d.add(I)}return d}};sg.MapOp=function(){};var cr=function(n){function e(){var t=arguments[0],i=arguments[1];n.call(this,t,i),this._ptLocator=new Rh,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Lh,this._resultPolyList=new Un,this._resultLineList=new Un,this._resultPointList=new Un,this._graph=new po(new yR),this._geomFact=t.getFactory()}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.insertUniqueEdge=function(i){var r=this._edgeList.findEqualEdge(i);if(r!==null){var a=r.getLabel(),l=i.getLabel();r.isPointwiseEqual(i)||(l=new fs(i.getLabel()),l.flip());var s=r.getDepth();s.isNull()&&s.add(a),s.add(l),a.merge(l)}else this._edgeList.add(i)},e.prototype.getGraph=function(){return this._graph},e.prototype.cancelDuplicateResultEdges=function(){for(var i=this._graph.getEdgeEnds().iterator();i.hasNext();){var r=i.next(),a=r.getSym();r.isInResult()&&a.isInResult()&&(r.setInResult(!1),a.setInResult(!1))}},e.prototype.isCoveredByLA=function(i){return!!(this.isCovered(i,this._resultLineList)||this.isCovered(i,this._resultPolyList))},e.prototype.computeGeometry=function(i,r,a,l){var s=new Un;return s.addAll(i),s.addAll(r),s.addAll(a),s.isEmpty()?e.createEmptyResult(l,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(s)},e.prototype.mergeSymLabels=function(){for(var i=this._graph.getNodes().iterator();i.hasNext();){var r=i.next();r.getEdges().mergeSymLabels()}},e.prototype.isCovered=function(i,r){for(var a=this,l=r.iterator();l.hasNext();){var s=l.next(),d=a._ptLocator.locate(i,s);if(d!==wt.EXTERIOR)return!0}return!1},e.prototype.replaceCollapsedEdges=function(){for(var i=new Un,r=this._edgeList.iterator();r.hasNext();){var a=r.next();a.isCollapsed()&&(r.remove(),i.add(a.getCollapsedEdge()))}this._edgeList.addAll(i)},e.prototype.updateNodeLabelling=function(){for(var i=this._graph.getNodes().iterator();i.hasNext();){var r=i.next(),a=r.getEdges().getLabel();r.getLabel().merge(a)}},e.prototype.getResultGeometry=function(i){return this.computeOverlay(i),this._resultGeom},e.prototype.insertUniqueEdges=function(i){for(var r=this,a=i.iterator();a.hasNext();){var l=a.next();r.insertUniqueEdge(l)}},e.prototype.computeOverlay=function(i){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var r=new Un;this._arg[0].computeSplitEdges(r),this._arg[1].computeSplitEdges(r),this.insertUniqueEdges(r),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),_g.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(i),this.cancelDuplicateResultEdges();var a=new Mu(this._geomFact);a.add(this._graph),this._resultPolyList=a.getPolygons();var l=new Of(this,this._geomFact,this._ptLocator);this._resultLineList=l.build(i);var s=new B_(this,this._geomFact,this._ptLocator);this._resultPointList=s.build(i),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,i)},e.prototype.labelIncompleteNode=function(i,r){var a=this._ptLocator.locate(i.getCoordinate(),this._arg[r].getGeometry());i.getLabel().setLocation(r,a)},e.prototype.copyPoints=function(i){for(var r=this,a=this._arg[i].getNodeIterator();a.hasNext();){var l=a.next(),s=r._graph.addNode(l.getCoordinate());s.setLabel(i,l.getLabel().getLocation(i))}},e.prototype.findResultAreaEdges=function(i){for(var r=this._graph.getEdgeEnds().iterator();r.hasNext();){var a=r.next(),l=a.getLabel();l.isArea()&&!a.isInteriorAreaEdge()&&e.isResultOfOp(l.getLocation(0,Mn.RIGHT),l.getLocation(1,Mn.RIGHT),i)&&a.setInResult(!0)}},e.prototype.computeLabelsFromDepths=function(){for(var i=this._edgeList.iterator();i.hasNext();){var r=i.next(),a=r.getLabel(),l=r.getDepth();if(!l.isNull()){l.normalize();for(var s=0;s<2;s++)!a.isNull(s)&&a.isArea()&&!l.isNull(s)&&(l.getDelta(s)===0?a.toLine(s):(dr.isTrue(!l.isNull(s,Mn.LEFT),"depth of LEFT side has not been initialized"),a.setLocation(s,Mn.LEFT,l.getLocation(s,Mn.LEFT)),dr.isTrue(!l.isNull(s,Mn.RIGHT),"depth of RIGHT side has not been initialized"),a.setLocation(s,Mn.RIGHT,l.getLocation(s,Mn.RIGHT))))}}},e.prototype.computeLabelling=function(){for(var i=this,r=this._graph.getNodes().iterator();r.hasNext();){var a=r.next();a.getEdges().computeLabelling(i._arg)}this.mergeSymLabels(),this.updateNodeLabelling()},e.prototype.labelIncompleteNodes=function(){for(var i=this,r=this._graph.getNodes().iterator();r.hasNext();){var a=r.next(),l=a.getLabel();a.isIsolated()&&(l.isNull(0)?i.labelIncompleteNode(a,0):i.labelIncompleteNode(a,1)),a.getEdges().updateLabelling(l)}},e.prototype.isCoveredByA=function(i){return!!this.isCovered(i,this._resultPolyList)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Qv);cr.overlayOp=function(n,e,t){var i=new cr(n,e),r=i.getResultGeometry(t);return r};cr.intersection=function(n,e){if(n.isEmpty()||e.isEmpty())return cr.createEmptyResult(cr.INTERSECTION,n,e,n.getFactory());if(n.isGeometryCollection()){var t=e;return F_.map(n,{interfaces_:function(){return[sg.MapOp]},map:function(i){return i.intersection(t)}})}return n.checkNotGeometryCollection(n),n.checkNotGeometryCollection(e),Bl.overlayOp(n,e,cr.INTERSECTION)};cr.symDifference=function(n,e){if(n.isEmpty()||e.isEmpty()){if(n.isEmpty()&&e.isEmpty())return cr.createEmptyResult(cr.SYMDIFFERENCE,n,e,n.getFactory());if(n.isEmpty())return e.copy();if(e.isEmpty())return n.copy()}return n.checkNotGeometryCollection(n),n.checkNotGeometryCollection(e),Bl.overlayOp(n,e,cr.SYMDIFFERENCE)};cr.resultDimension=function(n,e,t){var i=e.getDimension(),r=t.getDimension(),a=-1;switch(n){case cr.INTERSECTION:a=Math.min(i,r);break;case cr.UNION:a=Math.max(i,r);break;case cr.DIFFERENCE:a=i;break;case cr.SYMDIFFERENCE:a=Math.max(i,r);break}return a};cr.createEmptyResult=function(n,e,t,i){var r=null;switch(cr.resultDimension(n,e,t)){case-1:r=i.createGeometryCollection(new Array(0).fill(null));break;case 0:r=i.createPoint();break;case 1:r=i.createLineString();break;case 2:r=i.createPolygon();break}return r};cr.difference=function(n,e){return n.isEmpty()?cr.createEmptyResult(cr.DIFFERENCE,n,e,n.getFactory()):e.isEmpty()?n.copy():(n.checkNotGeometryCollection(n),n.checkNotGeometryCollection(e),Bl.overlayOp(n,e,cr.DIFFERENCE))};cr.isResultOfOp=function(){if(arguments.length===2){var n=arguments[0],e=arguments[1],t=n.getLocation(0),i=n.getLocation(1);return cr.isResultOfOp(t,i,e)}else if(arguments.length===3){var r=arguments[0],a=arguments[1],l=arguments[2];switch(r===wt.BOUNDARY&&(r=wt.INTERIOR),a===wt.BOUNDARY&&(a=wt.INTERIOR),l){case cr.INTERSECTION:return r===wt.INTERIOR&&a===wt.INTERIOR;case cr.UNION:return r===wt.INTERIOR||a===wt.INTERIOR;case cr.DIFFERENCE:return r===wt.INTERIOR&&a!==wt.INTERIOR;case cr.SYMDIFFERENCE:return r===wt.INTERIOR&&a!==wt.INTERIOR||r!==wt.INTERIOR&&a===wt.INTERIOR}return!1}};cr.INTERSECTION=1;cr.UNION=2;cr.DIFFERENCE=3;cr.SYMDIFFERENCE=4;var um=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Rh,this._seg=new wi;var e=arguments[0],t=arguments[1];this._g=e,this._boundaryDistanceTolerance=t,this._linework=this.extractLinework(e)};um.prototype.isWithinToleranceOfBoundary=function(e){for(var t=this,i=0;i<this._linework.getNumGeometries();i++)for(var r=t._linework.getGeometryN(i),a=r.getCoordinateSequence(),l=0;l<a.size()-1;l++){a.getCoordinate(l,t._seg.p0),a.getCoordinate(l+1,t._seg.p1);var s=t._seg.distance(e);if(s<=t._boundaryDistanceTolerance)return!0}return!1};um.prototype.getLocation=function(e){return this.isWithinToleranceOfBoundary(e)?wt.BOUNDARY:this._ptLocator.locate(e,this._g)};um.prototype.extractLinework=function(e){var t=new $v;e.apply(t);var i=t.getLinework(),r=Lr.toLineStringArray(i);return e.getFactory().createMultiLineString(r)};um.prototype.interfaces_=function(){return[]};um.prototype.getClass=function(){return um};var $v=function(){this._linework=null,this._linework=new Un};$v.prototype.getLinework=function(){return this._linework};$v.prototype.filter=function(e){var t=this;if(e instanceof oa){var i=e;this._linework.add(i.getExteriorRing());for(var r=0;r<i.getNumInteriorRing();r++)t._linework.add(i.getInteriorRingN(r))}};$v.prototype.interfaces_=function(){return[Cf]};$v.prototype.getClass=function(){return $v};var vg=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var e=arguments[0];this._g=e};vg.prototype.extractPoints=function(e,t,i){for(var r=this,a=e.getCoordinates(),l=0;l<a.length-1;l++)r.computeOffsetPoints(a[l],a[l+1],t,i)};vg.prototype.setSidesToGenerate=function(e,t){this._doLeft=e,this._doRight=t};vg.prototype.getPoints=function(e){for(var t=this,i=new Un,r=Ha.getLines(this._g),a=r.iterator();a.hasNext();){var l=a.next();t.extractPoints(l,e,i)}return i};vg.prototype.computeOffsetPoints=function(e,t,i,r){var a=t.x-e.x,l=t.y-e.y,s=Math.sqrt(a*a+l*l),d=i*a/s,g=i*l/s,x=(t.x+e.x)/2,I=(t.y+e.y)/2;if(this._doLeft){var A=new mt(x-g,I+d);r.add(A)}if(this._doRight){var L=new mt(x+g,I-d);r.add(L)}};vg.prototype.interfaces_=function(){return[]};vg.prototype.getClass=function(){return vg};var uc=function n(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=n.TOLERANCE,this._testCoords=new Un;var e=arguments[0],t=arguments[1],i=arguments[2];this._boundaryDistanceTolerance=n.computeBoundaryDistanceTolerance(e,t),this._geom=[e,t,i],this._locFinder=[new um(this._geom[0],this._boundaryDistanceTolerance),new um(this._geom[1],this._boundaryDistanceTolerance),new um(this._geom[2],this._boundaryDistanceTolerance)]},AR={TOLERANCE:{configurable:!0}};uc.prototype.reportResult=function(e,t,i){Wa.out.println("Overlay result invalid - A:"+wt.toLocationSymbol(t[0])+" B:"+wt.toLocationSymbol(t[1])+" expected:"+(i?"i":"e")+" actual:"+wt.toLocationSymbol(t[2]))};uc.prototype.isValid=function(e){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var t=this.checkValid(e);return t};uc.prototype.checkValid=function(){var e=this;if(arguments.length===1){for(var t=arguments[0],i=0;i<this._testCoords.size();i++){var r=e._testCoords.get(i);if(!e.checkValid(t,r))return e._invalidLocation=r,!1}return!0}else if(arguments.length===2){var a=arguments[0],l=arguments[1];return this._location[0]=this._locFinder[0].getLocation(l),this._location[1]=this._locFinder[1].getLocation(l),this._location[2]=this._locFinder[2].getLocation(l),uc.hasLocation(this._location,wt.BOUNDARY)?!0:this.isValidResult(a,this._location)}};uc.prototype.addTestPts=function(e){var t=new vg(e);this._testCoords.addAll(t.getPoints(5*this._boundaryDistanceTolerance))};uc.prototype.isValidResult=function(e,t){var i=cr.isResultOfOp(t[0],t[1],e),r=t[2]===wt.INTERIOR,a=!(i^r);return a||this.reportResult(e,t,i),a};uc.prototype.getInvalidLocation=function(){return this._invalidLocation};uc.prototype.interfaces_=function(){return[]};uc.prototype.getClass=function(){return uc};uc.hasLocation=function(e,t){for(var i=0;i<3;i++)if(e[i]===t)return!0;return!1};uc.computeBoundaryDistanceTolerance=function(e,t){return Math.min(Po.computeSizeBasedSnapTolerance(e),Po.computeSizeBasedSnapTolerance(t))};uc.isValid=function(e,t,i,r){var a=new uc(e,t,r);return a.isValid(i)};AR.TOLERANCE.get=function(){return 1e-6};Object.defineProperties(uc,AR);var ec=function n(e){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=n.extractFactory(e),this._inputGeoms=e};ec.prototype.extractElements=function(e,t){var i=this;if(e===null)return null;for(var r=0;r<e.getNumGeometries();r++){var a=e.getGeometryN(r);i._skipEmpty&&a.isEmpty()||t.add(a)}};ec.prototype.combine=function(){for(var e=this,t=new Un,i=this._inputGeoms.iterator();i.hasNext();){var r=i.next();e.extractElements(r,t)}return t.size()===0?this._geomFactory!==null?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(t)};ec.prototype.interfaces_=function(){return[]};ec.prototype.getClass=function(){return ec};ec.combine=function(){if(arguments.length===1){var e=arguments[0],t=new ec(e);return t.combine()}else if(arguments.length===2){var i=arguments[0],r=arguments[1],a=new ec(ec.createList(i,r));return a.combine()}else if(arguments.length===3){var l=arguments[0],s=arguments[1],d=arguments[2],g=new ec(ec.createList(l,s,d));return g.combine()}};ec.extractFactory=function(e){return e.isEmpty()?null:e.iterator().next().getFactory()};ec.createList=function(){if(arguments.length===2){var e=arguments[0],t=arguments[1],i=new Un;return i.add(e),i.add(t),i}else if(arguments.length===3){var r=arguments[0],a=arguments[1],l=arguments[2],s=new Un;return s.add(r),s.add(a),s.add(l),s}};var Ho=function(){this._inputPolys=null,this._geomFactory=null;var e=arguments[0];this._inputPolys=e,this._inputPolys===null&&(this._inputPolys=new Un)},MR={STRTREE_NODE_CAPACITY:{configurable:!0}};Ho.prototype.reduceToGeometries=function(e){for(var t=this,i=new Un,r=e.iterator();r.hasNext();){var a=r.next(),l=null;Hi(a,Th)?l=t.unionTree(a):a instanceof Bi&&(l=a),i.add(l)}return i};Ho.prototype.extractByEnvelope=function(e,t,i){for(var r=new Un,a=0;a<t.getNumGeometries();a++){var l=t.getGeometryN(a);l.getEnvelopeInternal().intersects(e)?r.add(l):i.add(l)}return this._geomFactory.buildGeometry(r)};Ho.prototype.unionOptimized=function(e,t){var i=e.getEnvelopeInternal(),r=t.getEnvelopeInternal();if(!i.intersects(r)){var a=ec.combine(e,t);return a}if(e.getNumGeometries()<=1&&t.getNumGeometries()<=1)return this.unionActual(e,t);var l=i.intersection(r);return this.unionUsingEnvelopeIntersection(e,t,l)};Ho.prototype.union=function(){if(this._inputPolys===null)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var e=new pR(Ho.STRTREE_NODE_CAPACITY),t=this._inputPolys.iterator();t.hasNext();){var i=t.next();e.insert(i.getEnvelopeInternal(),i)}this._inputPolys=null;var r=e.itemsTree(),a=this.unionTree(r);return a};Ho.prototype.binaryUnion=function(){if(arguments.length===1){var e=arguments[0];return this.binaryUnion(e,0,e.size())}else if(arguments.length===3){var t=arguments[0],i=arguments[1],r=arguments[2];if(r-i<=1){var a=Ho.getGeometry(t,i);return this.unionSafe(a,null)}else{if(r-i===2)return this.unionSafe(Ho.getGeometry(t,i),Ho.getGeometry(t,i+1));var l=Math.trunc((r+i)/2),s=this.binaryUnion(t,i,l),d=this.binaryUnion(t,l,r);return this.unionSafe(s,d)}}};Ho.prototype.repeatedUnion=function(e){for(var t=null,i=e.iterator();i.hasNext();){var r=i.next();t===null?t=r.copy():t=t.union(r)}return t};Ho.prototype.unionSafe=function(e,t){return e===null&&t===null?null:e===null?t.copy():t===null?e.copy():this.unionOptimized(e,t)};Ho.prototype.unionActual=function(e,t){return Ho.restrictToPolygons(e.union(t))};Ho.prototype.unionTree=function(e){var t=this.reduceToGeometries(e),i=this.binaryUnion(t);return i};Ho.prototype.unionUsingEnvelopeIntersection=function(e,t,i){var r=new Un,a=this.extractByEnvelope(i,e,r),l=this.extractByEnvelope(i,t,r),s=this.unionActual(a,l);r.add(s);var d=ec.combine(r);return d};Ho.prototype.bufferUnion=function(){if(arguments.length===1){var e=arguments[0],t=e.get(0).getFactory(),i=t.buildGeometry(e),r=i.buffer(0);return r}else if(arguments.length===2){var a=arguments[0],l=arguments[1],s=a.getFactory(),d=s.createGeometryCollection([a,l]),g=d.buffer(0);return g}};Ho.prototype.interfaces_=function(){return[]};Ho.prototype.getClass=function(){return Ho};Ho.restrictToPolygons=function(e){if(Hi(e,cm))return e;var t=fp.getPolygons(e);return t.size()===1?t.get(0):e.getFactory().createMultiPolygon(Lr.toPolygonArray(t))};Ho.getGeometry=function(e,t){return t>=e.size()?null:e.get(t)};Ho.union=function(e){var t=new Ho(e);return t.union()};MR.STRTREE_NODE_CAPACITY.get=function(){return 4};Object.defineProperties(Ho,MR);var ZE=function(){};ZE.prototype.interfaces_=function(){return[]};ZE.prototype.getClass=function(){return ZE};ZE.union=function(e,t){if(e.isEmpty()||t.isEmpty()){if(e.isEmpty()&&t.isEmpty())return cr.createEmptyResult(cr.UNION,e,t,e.getFactory());if(e.isEmpty())return t.copy();if(t.isEmpty())return e.copy()}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),Bl.overlayOp(e,t,cr.UNION)};function Tg(){return new YE}function YE(){this.reset()}YE.prototype={constructor:YE,reset:function(){this.s=this.t=0},add:function(n){lA(mE,n,this.t),lA(this,mE.s,this.s),this.s?this.t+=mE.t:this.s=mE.t},valueOf:function(){return this.s}};var mE=new YE;function lA(n,e,t){var i=n.s=e+t,r=i-e,a=i-r;n.t=e-a+(t-r)}var Eo=1e-6,Ls=Math.PI,up=Ls/2,uA=Ls/4,vp=Ls*2,Km=180/Ls,gf=Ls/180,Pl=Math.abs,$5=Math.atan,e0=Math.atan2,na=Math.cos,ia=Math.sin,h0=Math.sqrt;function LR(n){return n>1?0:n<-1?Ls:Math.acos(n)}function U_(n){return n>1?up:n<-1?-up:Math.asin(n)}function P1(){}function KE(n,e){n&&hA.hasOwnProperty(n.type)&&hA[n.type](n,e)}var cA={Feature:function(n,e){KE(n.geometry,e)},FeatureCollection:function(n,e){for(var t=n.features,i=-1,r=t.length;++i<r;)KE(t[i].geometry,e)}},hA={Sphere:function(n,e){e.sphere()},Point:function(n,e){n=n.coordinates,e.point(n[0],n[1],n[2])},MultiPoint:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)n=t[i],e.point(n[0],n[1],n[2])},LineString:function(n,e){nS(n.coordinates,e,0)},MultiLineString:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)nS(t[i],e,0)},Polygon:function(n,e){fA(n.coordinates,e)},MultiPolygon:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)fA(t[i],e)},GeometryCollection:function(n,e){for(var t=n.geometries,i=-1,r=t.length;++i<r;)KE(t[i],e)}};function nS(n,e,t){var i=-1,r=n.length-t,a;for(e.lineStart();++i<r;)a=n[i],e.point(a[0],a[1],a[2]);e.lineEnd()}function fA(n,e){var t=-1,i=n.length;for(e.polygonStart();++t<i;)nS(n[t],e,1);e.polygonEnd()}function ez(n,e){n&&cA.hasOwnProperty(n.type)?cA[n.type](n,e):KE(n,e)}Tg();Tg();function iS(n){return[e0(n[1],n[0]),U_(n[2])]}function t0(n){var e=n[0],t=n[1],i=na(t);return[i*na(e),i*ia(e),ia(t)]}function gE(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function JE(n,e){return[n[1]*e[2]-n[2]*e[1],n[2]*e[0]-n[0]*e[2],n[0]*e[1]-n[1]*e[0]]}function Nw(n,e){n[0]+=e[0],n[1]+=e[1],n[2]+=e[2]}function _E(n,e){return[n[0]*e,n[1]*e,n[2]*e]}function rS(n){var e=h0(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=e,n[1]/=e,n[2]/=e}Tg();function RR(n,e){function t(i,r){return i=n(i,r),e(i[0],i[1])}return n.invert&&e.invert&&(t.invert=function(i,r){return i=e.invert(i,r),i&&n.invert(i[0],i[1])}),t}function sS(n,e){return[n>Ls?n-vp:n<-Ls?n+vp:n,e]}sS.invert=sS;function tz(n,e,t){return(n%=vp)?e||t?RR(pA(n),mA(e,t)):pA(n):e||t?mA(e,t):sS}function dA(n){return function(e,t){return e+=n,[e>Ls?e-vp:e<-Ls?e+vp:e,t]}}function pA(n){var e=dA(n);return e.invert=dA(-n),e}function mA(n,e){var t=na(n),i=ia(n),r=na(e),a=ia(e);function l(s,d){var g=na(d),x=na(s)*g,I=ia(s)*g,A=ia(d),L=A*t+x*i;return[e0(I*r-L*a,x*t-A*i),U_(L*r+I*a)]}return l.invert=function(s,d){var g=na(d),x=na(s)*g,I=ia(s)*g,A=ia(d),L=A*r-I*a;return[e0(I*r+A*a,x*t+L*i),U_(L*t-x*i)]},l}function nz(n,e,t,i,r,a){if(t){var l=na(e),s=ia(e),d=i*t;r==null?(r=e+i*vp,a=e-d/2):(r=gA(l,r),a=gA(l,a),(i>0?r<a:r>a)&&(r+=i*vp));for(var g,x=r;i>0?x>a:x<a;x-=d)g=iS([l,-s*na(x),-s*ia(x)]),n.point(g[0],g[1])}}function gA(n,e){e=t0(e),e[0]-=n,rS(e);var t=LR(-e[1]);return((-e[2]<0?-t:t)+vp-Eo)%vp}function PR(){var n=[],e;return{point:function(t,i){e.push([t,i])},lineStart:function(){n.push(e=[])},lineEnd:P1,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var t=n;return n=[],e=null,t}}}function iz(n,e,t,i,r,a){var l=n[0],s=n[1],d=e[0],g=e[1],x=0,I=1,A=d-l,L=g-s,N;if(N=t-l,!(!A&&N>0)){if(N/=A,A<0){if(N<x)return;N<I&&(I=N)}else if(A>0){if(N>I)return;N>x&&(x=N)}if(N=r-l,!(!A&&N<0)){if(N/=A,A<0){if(N>I)return;N>x&&(x=N)}else if(A>0){if(N<x)return;N<I&&(I=N)}if(N=i-s,!(!L&&N>0)){if(N/=L,L<0){if(N<x)return;N<I&&(I=N)}else if(L>0){if(N>I)return;N>x&&(x=N)}if(N=a-s,!(!L&&N<0)){if(N/=L,L<0){if(N>I)return;N>x&&(x=N)}else if(L>0){if(N<x)return;N<I&&(I=N)}return x>0&&(n[0]=l+x*A,n[1]=s+x*L),I<1&&(e[0]=l+I*A,e[1]=s+I*L),!0}}}}}function LE(n,e){return Pl(n[0]-e[0])<Eo&&Pl(n[1]-e[1])<Eo}function yE(n,e,t,i){this.x=n,this.z=e,this.o=t,this.e=i,this.v=!1,this.n=this.p=null}function DR(n,e,t,i,r){var a=[],l=[],s,d;if(n.forEach(function(N){if(!((B=N.length-1)<=0)){var B,F=N[0],z=N[B],V;if(LE(F,z)){for(r.lineStart(),s=0;s<B;++s)r.point((F=N[s])[0],F[1]);r.lineEnd();return}a.push(V=new yE(F,N,null,!0)),l.push(V.o=new yE(F,null,V,!1)),a.push(V=new yE(z,N,null,!1)),l.push(V.o=new yE(z,null,V,!0))}}),!!a.length){for(l.sort(e),_A(a),_A(l),s=0,d=l.length;s<d;++s)l[s].e=t=!t;for(var g=a[0],x,I;;){for(var A=g,L=!0;A.v;)if((A=A.n)===g)return;x=A.z,r.lineStart();do{if(A.v=A.o.v=!0,A.e){if(L)for(s=0,d=x.length;s<d;++s)r.point((I=x[s])[0],I[1]);else i(A.x,A.n.x,1,r);A=A.n}else{if(L)for(x=A.p.z,s=x.length-1;s>=0;--s)r.point((I=x[s])[0],I[1]);else i(A.x,A.p.x,-1,r);A=A.p}A=A.o,x=A.z,L=!L}while(!A.v);r.lineEnd()}}}function _A(n){if(e=n.length){for(var e,t=0,i=n[0],r;++t<e;)i.n=r=n[t],r.p=i,i=r;i.n=r=n[0],r.p=i}}function OR(n,e){return n<e?-1:n>e?1:n>=e?0:NaN}function rz(n){return n.length===1&&(n=sz(n)),{left:function(e,t,i,r){for(i==null&&(i=0),r==null&&(r=e.length);i<r;){var a=i+r>>>1;n(e[a],t)<0?i=a+1:r=a}return i},right:function(e,t,i,r){for(i==null&&(i=0),r==null&&(r=e.length);i<r;){var a=i+r>>>1;n(e[a],t)>0?r=a:i=a+1}return i}}}function sz(n){return function(e,t){return OR(n(e),t)}}rz(OR);function NR(n){for(var e=n.length,t,i=-1,r=0,a,l;++i<e;)r+=n[i].length;for(a=new Array(r);--e>=0;)for(l=n[e],t=l.length;--t>=0;)a[--r]=l[t];return a}var D1=1e9,vE=-D1;function oz(n,e,t,i){function r(g,x){return n<=g&&g<=t&&e<=x&&x<=i}function a(g,x,I,A){var L=0,N=0;if(g==null||(L=l(g,I))!==(N=l(x,I))||d(g,x)<0^I>0)do A.point(L===0||L===3?n:t,L>1?i:e);while((L=(L+I+4)%4)!==N);else A.point(x[0],x[1])}function l(g,x){return Pl(g[0]-n)<Eo?x>0?0:3:Pl(g[0]-t)<Eo?x>0?2:1:Pl(g[1]-e)<Eo?x>0?1:0:x>0?3:2}function s(g,x){return d(g.x,x.x)}function d(g,x){var I=l(g,1),A=l(x,1);return I!==A?I-A:I===0?x[1]-g[1]:I===1?g[0]-x[0]:I===2?g[1]-x[1]:x[0]-g[0]}return function(g){var x=g,I=PR(),A,L,N,B,F,z,V,Y,Q,J,he,ee={point:ae,lineStart:Be,lineEnd:Pe,polygonStart:fe,polygonEnd:le};function ae(it,Et){r(it,Et)&&x.point(it,Et)}function De(){for(var it=0,Et=0,Ue=L.length;Et<Ue;++Et)for(var at=L[Et],ke=1,Dt=at.length,fn=at[0],Cn,Gt,Mt=fn[0],vt=fn[1];ke<Dt;++ke)Cn=Mt,Gt=vt,fn=at[ke],Mt=fn[0],vt=fn[1],Gt<=i?vt>i&&(Mt-Cn)*(i-Gt)>(vt-Gt)*(n-Cn)&&++it:vt<=i&&(Mt-Cn)*(i-Gt)<(vt-Gt)*(n-Cn)&&--it;return it}function fe(){x=I,A=[],L=[],he=!0}function le(){var it=De(),Et=he&&it,Ue=(A=NR(A)).length;(Et||Ue)&&(g.polygonStart(),Et&&(g.lineStart(),a(null,null,1,g),g.lineEnd()),Ue&&DR(A,s,it,a,g),g.polygonEnd()),x=g,A=L=N=null}function Be(){ee.point=Ce,L&&L.push(N=[]),J=!0,Q=!1,V=Y=NaN}function Pe(){A&&(Ce(B,F),z&&Q&&I.rejoin(),A.push(I.result())),ee.point=ae,Q&&x.lineEnd()}function Ce(it,Et){var Ue=r(it,Et);if(L&&N.push([it,Et]),J)B=it,F=Et,z=Ue,J=!1,Ue&&(x.lineStart(),x.point(it,Et));else if(Ue&&Q)x.point(it,Et);else{var at=[V=Math.max(vE,Math.min(D1,V)),Y=Math.max(vE,Math.min(D1,Y))],ke=[it=Math.max(vE,Math.min(D1,it)),Et=Math.max(vE,Math.min(D1,Et))];iz(at,ke,n,e,t,i)?(Q||(x.lineStart(),x.point(at[0],at[1])),x.point(ke[0],ke[1]),Ue||x.lineEnd(),he=!1):Ue&&(x.lineStart(),x.point(it,Et),he=!1)}V=it,Y=Et,Q=Ue}return ee}}var kw=Tg();function az(n,e){var t=e[0],i=e[1],r=[ia(t),-na(t),0],a=0,l=0;kw.reset();for(var s=0,d=n.length;s<d;++s)if(x=(g=n[s]).length)for(var g,x,I=g[x-1],A=I[0],L=I[1]/2+uA,N=ia(L),B=na(L),F=0;F<x;++F,A=V,N=Q,B=J,I=z){var z=g[F],V=z[0],Y=z[1]/2+uA,Q=ia(Y),J=na(Y),he=V-A,ee=he>=0?1:-1,ae=ee*he,De=ae>Ls,fe=N*Q;if(kw.add(e0(fe*ee*ia(ae),B*J+fe*na(ae))),a+=De?he+ee*vp:he,De^A>=t^V>=t){var le=JE(t0(I),t0(z));rS(le);var Be=JE(r,le);rS(Be);var Pe=(De^he>=0?-1:1)*U_(Be[2]);(i>Pe||i===Pe&&(le[0]||le[1]))&&(l+=De^he>=0?1:-1)}}return(a<-Eo||a<Eo&&kw<-Eo)^l&1}Tg();function yA(n){return n}Tg();Tg();var n0=1/0,QE=n0,nb=-n0,$E=nb,vA={point:lz,lineStart:P1,lineEnd:P1,polygonStart:P1,polygonEnd:P1,result:function(){var n=[[n0,QE],[nb,$E]];return nb=$E=-(QE=n0=1/0),n}};function lz(n,e){n<n0&&(n0=n),n>nb&&(nb=n),e<QE&&(QE=e),e>$E&&($E=e)}Tg();function kR(n,e,t,i){return function(r,a){var l=e(a),s=r.invert(i[0],i[1]),d=PR(),g=e(d),x=!1,I,A,L,N={point:B,lineStart:z,lineEnd:V,polygonStart:function(){N.point=Y,N.lineStart=Q,N.lineEnd=J,A=[],I=[]},polygonEnd:function(){N.point=B,N.lineStart=z,N.lineEnd=V,A=NR(A);var he=az(I,s);A.length?(x||(a.polygonStart(),x=!0),DR(A,cz,he,t,a)):he&&(x||(a.polygonStart(),x=!0),a.lineStart(),t(null,null,1,a),a.lineEnd()),x&&(a.polygonEnd(),x=!1),A=I=null},sphere:function(){a.polygonStart(),a.lineStart(),t(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function B(he,ee){var ae=r(he,ee);n(he=ae[0],ee=ae[1])&&a.point(he,ee)}function F(he,ee){var ae=r(he,ee);l.point(ae[0],ae[1])}function z(){N.point=F,l.lineStart()}function V(){N.point=B,l.lineEnd()}function Y(he,ee){L.push([he,ee]);var ae=r(he,ee);g.point(ae[0],ae[1])}function Q(){g.lineStart(),L=[]}function J(){Y(L[0][0],L[0][1]),g.lineEnd();var he=g.clean(),ee=d.result(),ae,De=ee.length,fe,le,Be;if(L.pop(),I.push(L),L=null,!!De){if(he&1){if(le=ee[0],(fe=le.length-1)>0){for(x||(a.polygonStart(),x=!0),a.lineStart(),ae=0;ae<fe;++ae)a.point((Be=le[ae])[0],Be[1]);a.lineEnd()}return}De>1&&he&2&&ee.push(ee.pop().concat(ee.shift())),A.push(ee.filter(uz))}}return N}}function uz(n){return n.length>1}function cz(n,e){return((n=n.x)[0]<0?n[1]-up-Eo:up-n[1])-((e=e.x)[0]<0?e[1]-up-Eo:up-e[1])}const bA=kR(function(){return!0},hz,dz,[-Ls,-up]);function hz(n){var e=NaN,t=NaN,i=NaN,r;return{lineStart:function(){n.lineStart(),r=1},point:function(a,l){var s=a>0?Ls:-Ls,d=Pl(a-e);Pl(d-Ls)<Eo?(n.point(e,t=(t+l)/2>0?up:-up),n.point(i,t),n.lineEnd(),n.lineStart(),n.point(s,t),n.point(a,t),r=0):i!==s&&d>=Ls&&(Pl(e-i)<Eo&&(e-=i*Eo),Pl(a-s)<Eo&&(a-=s*Eo),t=fz(e,t,a,l),n.point(i,t),n.lineEnd(),n.lineStart(),n.point(s,t),r=0),n.point(e=a,t=l),i=s},lineEnd:function(){n.lineEnd(),e=t=NaN},clean:function(){return 2-r}}}function fz(n,e,t,i){var r,a,l=ia(n-t);return Pl(l)>Eo?$5((ia(e)*(a=na(i))*ia(t)-ia(i)*(r=na(e))*ia(n))/(r*a*l)):(e+i)/2}function dz(n,e,t,i){var r;if(n==null)r=t*up,i.point(-Ls,r),i.point(0,r),i.point(Ls,r),i.point(Ls,0),i.point(Ls,-r),i.point(0,-r),i.point(-Ls,-r),i.point(-Ls,0),i.point(-Ls,r);else if(Pl(n[0]-e[0])>Eo){var a=n[0]<e[0]?Ls:-Ls;r=t*a/2,i.point(-a,r),i.point(0,r),i.point(a,r)}else i.point(e[0],e[1])}function pz(n,e){var t=na(n),i=t>0,r=Pl(t)>Eo;function a(x,I,A,L){nz(L,n,e,A,x,I)}function l(x,I){return na(x)*na(I)>t}function s(x){var I,A,L,N,B;return{lineStart:function(){N=L=!1,B=1},point:function(F,z){var V=[F,z],Y,Q=l(F,z),J=i?Q?0:g(F,z):Q?g(F+(F<0?Ls:-Ls),z):0;if(!I&&(N=L=Q)&&x.lineStart(),Q!==L&&(Y=d(I,V),(!Y||LE(I,Y)||LE(V,Y))&&(V[0]+=Eo,V[1]+=Eo,Q=l(V[0],V[1]))),Q!==L)B=0,Q?(x.lineStart(),Y=d(V,I),x.point(Y[0],Y[1])):(Y=d(I,V),x.point(Y[0],Y[1]),x.lineEnd()),I=Y;else if(r&&I&&i^Q){var he;!(J&A)&&(he=d(V,I,!0))&&(B=0,i?(x.lineStart(),x.point(he[0][0],he[0][1]),x.point(he[1][0],he[1][1]),x.lineEnd()):(x.point(he[1][0],he[1][1]),x.lineEnd(),x.lineStart(),x.point(he[0][0],he[0][1])))}Q&&(!I||!LE(I,V))&&x.point(V[0],V[1]),I=V,L=Q,A=J},lineEnd:function(){L&&x.lineEnd(),I=null},clean:function(){return B|(N&&L)<<1}}}function d(x,I,A){var L=t0(x),N=t0(I),B=[1,0,0],F=JE(L,N),z=gE(F,F),V=F[0],Y=z-V*V;if(!Y)return!A&&x;var Q=t*z/Y,J=-t*V/Y,he=JE(B,F),ee=_E(B,Q),ae=_E(F,J);Nw(ee,ae);var De=he,fe=gE(ee,De),le=gE(De,De),Be=fe*fe-le*(gE(ee,ee)-1);if(!(Be<0)){var Pe=h0(Be),Ce=_E(De,(-fe-Pe)/le);if(Nw(Ce,ee),Ce=iS(Ce),!A)return Ce;var it=x[0],Et=I[0],Ue=x[1],at=I[1],ke;Et<it&&(ke=it,it=Et,Et=ke);var Dt=Et-it,fn=Pl(Dt-Ls)<Eo,Cn=fn||Dt<Eo;if(!fn&&at<Ue&&(ke=Ue,Ue=at,at=ke),Cn?fn?Ue+at>0^Ce[1]<(Pl(Ce[0]-it)<Eo?Ue:at):Ue<=Ce[1]&&Ce[1]<=at:Dt>Ls^(it<=Ce[0]&&Ce[0]<=Et)){var Gt=_E(De,(-fe+Pe)/le);return Nw(Gt,ee),[Ce,iS(Gt)]}}}function g(x,I){var A=i?n:Ls-n,L=0;return x<-A?L|=1:x>A&&(L|=2),I<-A?L|=4:I>A&&(L|=8),L}return kR(l,s,a,i?[0,-n]:[-Ls,n-Ls])}function FR(n){return function(e){var t=new oS;for(var i in n)t[i]=n[i];return t.stream=e,t}}function oS(){}oS.prototype={constructor:oS,point:function(n,e){this.stream.point(n,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function BR(n,e,t){var i=e[1][0]-e[0][0],r=e[1][1]-e[0][1],a=n.clipExtent&&n.clipExtent();n.scale(150).translate([0,0]),a!=null&&n.clipExtent(null),ez(t,n.stream(vA));var l=vA.result(),s=Math.min(i/(l[1][0]-l[0][0]),r/(l[1][1]-l[0][1])),d=+e[0][0]+(i-s*(l[1][0]+l[0][0]))/2,g=+e[0][1]+(r-s*(l[1][1]+l[0][1]))/2;return a!=null&&n.clipExtent(a),n.scale(s*150).translate([d,g])}function mz(n,e,t){return BR(n,[[0,0],e],t)}var xA=16,gz=na(30*gf);function EA(n,e){return+e?yz(n,e):_z(n)}function _z(n){return FR({point:function(e,t){e=n(e,t),this.stream.point(e[0],e[1])}})}function yz(n,e){function t(i,r,a,l,s,d,g,x,I,A,L,N,B,F){var z=g-i,V=x-r,Y=z*z+V*V;if(Y>4*e&&B--){var Q=l+A,J=s+L,he=d+N,ee=h0(Q*Q+J*J+he*he),ae=U_(he/=ee),De=Pl(Pl(he)-1)<Eo||Pl(a-I)<Eo?(a+I)/2:e0(J,Q),fe=n(De,ae),le=fe[0],Be=fe[1],Pe=le-i,Ce=Be-r,it=V*Pe-z*Ce;(it*it/Y>e||Pl((z*Pe+V*Ce)/Y-.5)>.3||l*A+s*L+d*N<gz)&&(t(i,r,a,l,s,d,le,Be,De,Q/=ee,J/=ee,he,B,F),F.point(le,Be),t(le,Be,De,Q,J,he,g,x,I,A,L,N,B,F))}}return function(i){var r,a,l,s,d,g,x,I,A,L,N,B,F={point:z,lineStart:V,lineEnd:Q,polygonStart:function(){i.polygonStart(),F.lineStart=J},polygonEnd:function(){i.polygonEnd(),F.lineStart=V}};function z(ae,De){ae=n(ae,De),i.point(ae[0],ae[1])}function V(){I=NaN,F.point=Y,i.lineStart()}function Y(ae,De){var fe=t0([ae,De]),le=n(ae,De);t(I,A,x,L,N,B,I=le[0],A=le[1],x=ae,L=fe[0],N=fe[1],B=fe[2],xA,i),i.point(I,A)}function Q(){F.point=z,i.lineEnd()}function J(){V(),F.point=he,F.lineEnd=ee}function he(ae,De){Y(r=ae,De),a=I,l=A,s=L,d=N,g=B,F.point=Y}function ee(){t(I,A,x,L,N,B,a,l,r,s,d,g,xA,i),F.lineEnd=Q,Q()}return F}}var vz=FR({point:function(n,e){this.stream.point(n*gf,e*gf)}});function bz(n){return xz(function(){return n})()}function xz(n){var e,t=150,i=480,r=250,a,l,s=0,d=0,g=0,x=0,I=0,A,L,N=null,B=bA,F=null,z,V,Y,Q=yA,J=.5,he=EA(le,J),ee,ae;function De(Ce){return Ce=L(Ce[0]*gf,Ce[1]*gf),[Ce[0]*t+a,l-Ce[1]*t]}function fe(Ce){return Ce=L.invert((Ce[0]-a)/t,(l-Ce[1])/t),Ce&&[Ce[0]*Km,Ce[1]*Km]}function le(Ce,it){return Ce=e(Ce,it),[Ce[0]*t+a,l-Ce[1]*t]}De.stream=function(Ce){return ee&&ae===Ce?ee:ee=vz(B(A,he(Q(ae=Ce))))},De.clipAngle=function(Ce){return arguments.length?(B=+Ce?pz(N=Ce*gf,6*gf):(N=null,bA),Pe()):N*Km},De.clipExtent=function(Ce){return arguments.length?(Q=Ce==null?(F=z=V=Y=null,yA):oz(F=+Ce[0][0],z=+Ce[0][1],V=+Ce[1][0],Y=+Ce[1][1]),Pe()):F==null?null:[[F,z],[V,Y]]},De.scale=function(Ce){return arguments.length?(t=+Ce,Be()):t},De.translate=function(Ce){return arguments.length?(i=+Ce[0],r=+Ce[1],Be()):[i,r]},De.center=function(Ce){return arguments.length?(s=Ce[0]%360*gf,d=Ce[1]%360*gf,Be()):[s*Km,d*Km]},De.rotate=function(Ce){return arguments.length?(g=Ce[0]%360*gf,x=Ce[1]%360*gf,I=Ce.length>2?Ce[2]%360*gf:0,Be()):[g*Km,x*Km,I*Km]},De.precision=function(Ce){return arguments.length?(he=EA(le,J=Ce*Ce),Pe()):h0(J)},De.fitExtent=function(Ce,it){return BR(De,Ce,it)},De.fitSize=function(Ce,it){return mz(De,Ce,it)};function Be(){L=RR(A=tz(g,x,I),e);var Ce=e(s,d);return a=i-Ce[0]*t,l=r+Ce[1]*t,Pe()}function Pe(){return ee=ae=null,De}return function(){return e=n.apply(this,arguments),De.invert=e.invert&&fe,Be()}}function zR(n){return function(e,t){var i=na(e),r=na(t),a=n(i*r);return[a*r*ia(e),a*ia(t)]}}function UR(n){return function(e,t){var i=h0(e*e+t*t),r=n(i),a=ia(r),l=na(r);return[e0(e*a,i*l),U_(i&&t*a/i)]}}var Ez=zR(function(n){return h0(2/(1+n))});Ez.invert=UR(function(n){return 2*U_(n/2)});var VR=zR(function(n){return(n=LR(n))&&n/ia(n)});VR.invert=UR(function(n){return n});function Iz(){return bz(VR).scale(79.4188).clipAngle(180-.001)}function IA(n,e){return[n,e]}IA.invert=IA;function Tz(n,e,t){t=t||{};var i=t.units||"kilometers",r=t.steps||8;if(!n)throw new Error("geojson is required");if(typeof t!="object")throw new Error("options must be an object");if(typeof r!="number")throw new Error("steps must be an number");if(e===void 0)throw new Error("radius is required");if(r<=0)throw new Error("steps must be greater than 0");var a=[];switch(n.type){case"GeometryCollection":return BS(n,function(l){var s=RE(l,e,i,r);s&&a.push(s)}),Ov(a);case"FeatureCollection":return eS(n,function(l){var s=RE(l,e,i,r);s&&eS(s,function(d){d&&a.push(d)})}),Ov(a)}return RE(n,e,i,r)}function RE(n,e,t,i){var r=n.properties||{},a=n.type==="Feature"?n.geometry:n;if(a.type==="GeometryCollection"){var l=[];return BS(n,function(B){var F=RE(B,e,t,i);F&&l.push(F)}),Ov(l)}var s=wz(a),d={type:a.type,coordinates:HR(a.coordinates,s)},g=new WS,x=g.read(d),I=P5(D5(e,t),"meters"),A=ja.bufferOp(x,I,i),L=new fR;if(A=L.write(A),!GR(A.coordinates)){var N={type:A.type,coordinates:jR(A.coordinates,s)};return ug(N,r)}}function GR(n){return Array.isArray(n[0])?GR(n[0]):isNaN(n[0])}function HR(n,e){return typeof n[0]!="object"?e(n):n.map(function(t){return HR(t,e)})}function jR(n,e){return typeof n[0]!="object"?e.invert(n):n.map(function(t){return jR(t,e)})}function wz(n){var e=N5(n).geometry.coordinates,t=[-e[0],-e[1]];return Iz().rotate(t).scale(Qu)}function Sz(n,e){return n.map(i=>i.source.data).map(i=>Tz(i,(e==null?void 0:e.radius)||1,{units:(e==null?void 0:e.units)||"kilometers"})).filter(i=>i!==void 0)}function Cz(n){const e=n.map(t=>t.source.data);return n.length>0&&e.every(t=>gd(t))}const Az={processor:Sz,validator:Cz};function Mz(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return n.geometry.coordinates;if(n.type==="Point")return n.coordinates}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return n;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function qR(n,e,t){if(!n)throw new Error("No featureCollection passed");if(!t)throw new Error(".collectionOf() requires a name");if(!n||n.type!=="FeatureCollection")throw new Error("Invalid input to "+t+", FeatureCollection required");for(var i=0,r=n.features;i<r.length;i++){var a=r[i];if(!a||a.type!=="Feature"||!a.geometry)throw new Error("Invalid input to "+t+", Feature with geometry required");if(!a.geometry||a.geometry.type!==e)throw new Error("Invalid input to "+t+": must be a "+e+", given "+a.geometry.type)}}function bg(n){return n.type==="Feature"?n.geometry:n}/**
 * splaytree v3.1.2
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function Lz(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,r,a,l;return l={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function s(g){return function(x){return d([g,x])}}function d(g){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,r&&(a=g[0]&2?r.return:g[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,g[1])).done)return a;switch(r=0,a&&(g=[g[0]&2,a.value]),g[0]){case 0:case 1:a=g;break;case 4:return t.label++,{value:g[1],done:!1};case 5:t.label++,r=g[1],g=[0];continue;case 7:g=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(g[0]===6||g[0]===2)){t=0;continue}if(g[0]===3&&(!a||g[1]>a[0]&&g[1]<a[3])){t.label=g[1];break}if(g[0]===6&&t.label<a[1]){t.label=a[1],a=g;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(g);break}a[2]&&t.ops.pop(),t.trys.pop();continue}g=e.call(n,t)}catch(x){g=[6,x],r=0}finally{i=a=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}}var xg=function(){function n(e,t){this.next=null,this.key=e,this.data=t,this.left=null,this.right=null}return n}();function Rz(n,e){return n>e?1:n<e?-1:0}function $m(n,e,t){for(var i=new xg(null,null),r=i,a=i;;){var l=t(n,e.key);if(l<0){if(e.left===null)break;if(t(n,e.left.key)<0){var s=e.left;if(e.left=s.right,s.right=e,e=s,e.left===null)break}a.left=e,a=e,e=e.left}else if(l>0){if(e.right===null)break;if(t(n,e.right.key)>0){var s=e.right;if(e.right=s.left,s.left=e,e=s,e.right===null)break}r.right=e,r=e,e=e.right}else break}return r.right=e.left,a.left=e.right,e.left=i.right,e.right=i.left,e}function Fw(n,e,t,i){var r=new xg(n,e);if(t===null)return r.left=r.right=null,r;t=$m(n,t,i);var a=i(n,t.key);return a<0?(r.left=t.left,r.right=t,t.left=null):a>=0&&(r.right=t.right,r.left=t,t.right=null),r}function TA(n,e,t){var i=null,r=null;if(e){e=$m(n,e,t);var a=t(e.key,n);a===0?(i=e.left,r=e.right):a<0?(r=e.right,e.right=null,i=e):(i=e.left,e.left=null,r=e)}return{left:i,right:r}}function Pz(n,e,t){return e===null?n:(n===null||(e=$m(n.key,e,t),e.left=n),e)}function aS(n,e,t,i,r){if(n){i(""+e+(t?"└── ":"├── ")+r(n)+`
`);var a=e+(t?"    ":"│   ");n.left&&aS(n.left,a,!1,i,r),n.right&&aS(n.right,a,!0,i,r)}}var tC=function(){function n(e){e===void 0&&(e=Rz),this._root=null,this._size=0,this._comparator=e}return n.prototype.insert=function(e,t){return this._size++,this._root=Fw(e,t,this._root,this._comparator)},n.prototype.add=function(e,t){var i=new xg(e,t);this._root===null&&(i.left=i.right=null,this._size++,this._root=i);var r=this._comparator,a=$m(e,this._root,r),l=r(e,a.key);return l===0?this._root=a:(l<0?(i.left=a.left,i.right=a,a.left=null):l>0&&(i.right=a.right,i.left=a,a.right=null),this._size++,this._root=i),this._root},n.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},n.prototype._remove=function(e,t,i){var r;if(t===null)return null;t=$m(e,t,i);var a=i(e,t.key);return a===0?(t.left===null?r=t.right:(r=$m(e,t.left,i),r.right=t.right),this._size--,r):t},n.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=$m(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},n.prototype.findStatic=function(e){for(var t=this._root,i=this._comparator;t;){var r=i(e,t.key);if(r===0)return t;r<0?t=t.left:t=t.right}return null},n.prototype.find=function(e){return this._root&&(this._root=$m(e,this._root,this._comparator),this._comparator(e,this._root.key)!==0)?null:this._root},n.prototype.contains=function(e){for(var t=this._root,i=this._comparator;t;){var r=i(e,t.key);if(r===0)return!0;r<0?t=t.left:t=t.right}return!1},n.prototype.forEach=function(e,t){for(var i=this._root,r=[],a=!1;!a;)i!==null?(r.push(i),i=i.left):r.length!==0?(i=r.pop(),e.call(t,i),i=i.right):a=!0;return this},n.prototype.range=function(e,t,i,r){for(var a=[],l=this._comparator,s=this._root,d;a.length!==0||s;)if(s)a.push(s),s=s.left;else{if(s=a.pop(),d=l(s.key,t),d>0)break;if(l(s.key,e)>=0&&i.call(r,s))return this;s=s.right}return this},n.prototype.keys=function(){var e=[];return this.forEach(function(t){var i=t.key;return e.push(i)}),e},n.prototype.values=function(){var e=[];return this.forEach(function(t){var i=t.data;return e.push(i)}),e},n.prototype.min=function(){return this._root?this.minNode(this._root).key:null},n.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},n.prototype.minNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.left;)e=e.left;return e},n.prototype.maxNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.right;)e=e.right;return e},n.prototype.at=function(e){for(var t=this._root,i=!1,r=0,a=[];!i;)if(t)a.push(t),t=t.left;else if(a.length>0){if(t=a.pop(),r===e)return t;r++,t=t.right}else i=!0;return null},n.prototype.next=function(e){var t=this._root,i=null;if(e.right){for(i=e.right;i.left;)i=i.left;return i}for(var r=this._comparator;t;){var a=r(e.key,t.key);if(a===0)break;a<0?(i=t,t=t.left):t=t.right}return i},n.prototype.prev=function(e){var t=this._root,i=null;if(e.left!==null){for(i=e.left;i.right;)i=i.right;return i}for(var r=this._comparator;t;){var a=r(e.key,t.key);if(a===0)break;a<0?t=t.left:(i=t,t=t.right)}return i},n.prototype.clear=function(){return this._root=null,this._size=0,this},n.prototype.toList=function(){return Oz(this._root)},n.prototype.load=function(e,t,i){t===void 0&&(t=[]),i===void 0&&(i=!1);var r=e.length,a=this._comparator;if(i&&cS(e,t,0,r-1,a),this._root===null)this._root=lS(e,t,0,r),this._size=r;else{var l=Nz(this.toList(),Dz(e,t),a);r=this._size+r,this._root=uS({head:l},0,r)}return this},n.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(n.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),n.prototype.toString=function(e){e===void 0&&(e=function(i){return String(i.key)});var t=[];return aS(this._root,"",!0,function(i){return t.push(i)},e),t.join("")},n.prototype.update=function(e,t,i){var r=this._comparator,a=TA(e,this._root,r),l=a.left,s=a.right;r(e,t)<0?s=Fw(t,i,s,r):l=Fw(t,i,l,r),this._root=Pz(l,s,r)},n.prototype.split=function(e){return TA(e,this._root,this._comparator)},n.prototype[Symbol.iterator]=function(){var e,t,i;return Lz(this,function(r){switch(r.label){case 0:e=this._root,t=[],i=!1,r.label=1;case 1:return i?[3,6]:e===null?[3,2]:(t.push(e),e=e.left,[3,5]);case 2:return t.length===0?[3,4]:(e=t.pop(),[4,e]);case 3:return r.sent(),e=e.right,[3,5];case 4:i=!0,r.label=5;case 5:return[3,1];case 6:return[2]}})},n}();function lS(n,e,t,i){var r=i-t;if(r>0){var a=t+Math.floor(r/2),l=n[a],s=e[a],d=new xg(l,s);return d.left=lS(n,e,t,a),d.right=lS(n,e,a+1,i),d}return null}function Dz(n,e){for(var t=new xg(null,null),i=t,r=0;r<n.length;r++)i=i.next=new xg(n[r],e[r]);return i.next=null,t.next}function Oz(n){for(var e=n,t=[],i=!1,r=new xg(null,null),a=r;!i;)e?(t.push(e),e=e.left):t.length>0?(e=a=a.next=t.pop(),e=e.right):i=!0;return a.next=null,r.next}function uS(n,e,t){var i=t-e;if(i>0){var r=e+Math.floor(i/2),a=uS(n,e,r),l=n.head;return l.left=a,n.head=n.head.next,l.right=uS(n,r+1,t),l}return null}function Nz(n,e,t){for(var i=new xg(null,null),r=i,a=n,l=e;a!==null&&l!==null;)t(a.key,l.key)<0?(r.next=a,a=a.next):(r.next=l,l=l.next),r=r.next;return a!==null?r.next=a:l!==null&&(r.next=l),i.next}function cS(n,e,t,i,r){if(!(t>=i)){for(var a=n[t+i>>1],l=t-1,s=i+1;;){do l++;while(r(n[l],a)<0);do s--;while(r(n[s],a)>0);if(l>=s)break;var d=n[l];n[l]=n[s],n[s]=d,d=e[l],e[l]=e[s],e[s]=d}cS(n,e,t,s,r),cS(n,e,s+1,i,r)}}function Ff(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function wA(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function cc(n,e,t){return e&&wA(n.prototype,e),t&&wA(n,t),n}var E1=function(e,t){return e.ll.x<=t.x&&t.x<=e.ur.x&&e.ll.y<=t.y&&t.y<=e.ur.y},hS=function(e,t){if(t.ur.x<e.ll.x||e.ur.x<t.ll.x||t.ur.y<e.ll.y||e.ur.y<t.ll.y)return null;var i=e.ll.x<t.ll.x?t.ll.x:e.ll.x,r=e.ur.x<t.ur.x?e.ur.x:t.ur.x,a=e.ll.y<t.ll.y?t.ll.y:e.ll.y,l=e.ur.y<t.ur.y?e.ur.y:t.ur.y;return{ll:{x:i,y:a},ur:{x:r,y:l}}},tg=Number.EPSILON;tg===void 0&&(tg=Math.pow(2,-52));var kz=tg*tg,fS=function(e,t){if(-tg<e&&e<tg&&-tg<t&&t<tg)return 0;var i=e-t;return i*i<kz*e*t?0:e<t?-1:1},Fz=function(){function n(){Ff(this,n),this.reset()}return cc(n,[{key:"reset",value:function(){this.xRounder=new SA,this.yRounder=new SA}},{key:"round",value:function(t,i){return{x:this.xRounder.round(t),y:this.yRounder.round(i)}}}]),n}(),SA=function(){function n(){Ff(this,n),this.tree=new tC,this.round(0)}return cc(n,[{key:"round",value:function(t){var i=this.tree.add(t),r=this.tree.prev(i);if(r!==null&&fS(i.key,r.key)===0)return this.tree.remove(t),r.key;var a=this.tree.next(i);return a!==null&&fS(i.key,a.key)===0?(this.tree.remove(t),a.key):t}}]),n}(),ib=new Fz,k1=function(e,t){return e.x*t.y-e.y*t.x},WR=function(e,t){return e.x*t.x+e.y*t.y},CA=function(e,t,i){var r={x:t.x-e.x,y:t.y-e.y},a={x:i.x-e.x,y:i.y-e.y},l=k1(r,a);return fS(l,0)},eI=function(e){return Math.sqrt(WR(e,e))},Bz=function(e,t,i){var r={x:t.x-e.x,y:t.y-e.y},a={x:i.x-e.x,y:i.y-e.y};return k1(a,r)/eI(a)/eI(r)},zz=function(e,t,i){var r={x:t.x-e.x,y:t.y-e.y},a={x:i.x-e.x,y:i.y-e.y};return WR(a,r)/eI(a)/eI(r)},AA=function(e,t,i){return t.y===0?null:{x:e.x+t.x/t.y*(i-e.y),y:i}},MA=function(e,t,i){return t.x===0?null:{x:i,y:e.y+t.y/t.x*(i-e.x)}},Uz=function(e,t,i,r){if(t.x===0)return MA(i,r,e.x);if(r.x===0)return MA(e,t,i.x);if(t.y===0)return AA(i,r,e.y);if(r.y===0)return AA(e,t,i.y);var a=k1(t,r);if(a==0)return null;var l={x:i.x-e.x,y:i.y-e.y},s=k1(l,t)/a,d=k1(l,r)/a,g=e.x+d*t.x,x=i.x+s*r.x,I=e.y+d*t.y,A=i.y+s*r.y,L=(g+x)/2,N=(I+A)/2;return{x:L,y:N}},op=function(){cc(n,null,[{key:"compare",value:function(t,i){var r=n.comparePoints(t.point,i.point);return r!==0?r:(t.point!==i.point&&t.link(i),t.isLeft!==i.isLeft?t.isLeft?1:-1:tI.compare(t.segment,i.segment))}},{key:"comparePoints",value:function(t,i){return t.x<i.x?-1:t.x>i.x?1:t.y<i.y?-1:t.y>i.y?1:0}}]);function n(e,t){Ff(this,n),e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=t}return cc(n,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var i=t.point.events,r=0,a=i.length;r<a;r++){var l=i[r];this.point.events.push(l),l.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,i=0;i<t;i++){var r=this.point.events[i];if(r.segment.consumedBy===void 0)for(var a=i+1;a<t;a++){var l=this.point.events[a];l.consumedBy===void 0&&r.otherSE.point.events===l.otherSE.point.events&&r.segment.consume(l.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],i=0,r=this.point.events.length;i<r;i++){var a=this.point.events[i];a!==this&&!a.segment.ringOut&&a.segment.isInResult()&&t.push(a)}return t}},{key:"getLeftmostComparator",value:function(t){var i=this,r=new Map,a=function(s){var d=s.otherSE;r.set(s,{sine:Bz(i.point,t.point,d.point),cosine:zz(i.point,t.point,d.point)})};return function(l,s){r.has(l)||a(l),r.has(s)||a(s);var d=r.get(l),g=d.sine,x=d.cosine,I=r.get(s),A=I.sine,L=I.cosine;return g>=0&&A>=0?x<L?1:x>L?-1:0:g<0&&A<0?x<L?-1:x>L?1:0:A<g?-1:A>g?1:0}}}]),n}(),Vz=0,tI=function(){cc(n,null,[{key:"compare",value:function(t,i){var r=t.leftSE.point.x,a=i.leftSE.point.x,l=t.rightSE.point.x,s=i.rightSE.point.x;if(s<r)return 1;if(l<a)return-1;var d=t.leftSE.point.y,g=i.leftSE.point.y,x=t.rightSE.point.y,I=i.rightSE.point.y;if(r<a){if(g<d&&g<x)return 1;if(g>d&&g>x)return-1;var A=t.comparePoint(i.leftSE.point);if(A<0)return 1;if(A>0)return-1;var L=i.comparePoint(t.rightSE.point);return L!==0?L:-1}if(r>a){if(d<g&&d<I)return-1;if(d>g&&d>I)return 1;var N=i.comparePoint(t.leftSE.point);if(N!==0)return N;var B=t.comparePoint(i.rightSE.point);return B<0?1:B>0?-1:1}if(d<g)return-1;if(d>g)return 1;if(l<s){var F=i.comparePoint(t.rightSE.point);if(F!==0)return F}if(l>s){var z=t.comparePoint(i.rightSE.point);if(z<0)return 1;if(z>0)return-1}if(l!==s){var V=x-d,Y=l-r,Q=I-g,J=s-a;if(V>Y&&Q<J)return 1;if(V<Y&&Q>J)return-1}return l>s?1:l<s||x<I?-1:x>I?1:t.id<i.id?-1:t.id>i.id?1:0}}]);function n(e,t,i,r){Ff(this,n),this.id=++Vz,this.leftSE=e,e.segment=this,e.otherSE=t,this.rightSE=t,t.segment=this,t.otherSE=e,this.rings=i,this.windings=r}return cc(n,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,i=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<i?t:i},ur:{x:this.rightSE.point.x,y:t>i?t:i}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var i=this.leftSE.point,r=this.rightSE.point,a=this.vector();if(i.x===r.x)return t.x===i.x?0:t.x<i.x?1:-1;var l=(t.y-i.y)/a.y,s=i.x+l*a.x;if(t.x===s)return 0;var d=(t.x-i.x)/a.x,g=i.y+d*a.y;return t.y===g?0:t.y<g?-1:1}},{key:"getIntersection",value:function(t){var i=this.bbox(),r=t.bbox(),a=hS(i,r);if(a===null)return null;var l=this.leftSE.point,s=this.rightSE.point,d=t.leftSE.point,g=t.rightSE.point,x=E1(i,d)&&this.comparePoint(d)===0,I=E1(r,l)&&t.comparePoint(l)===0,A=E1(i,g)&&this.comparePoint(g)===0,L=E1(r,s)&&t.comparePoint(s)===0;if(I&&x)return L&&!A?s:!L&&A?g:null;if(I)return A&&l.x===g.x&&l.y===g.y?null:l;if(x)return L&&s.x===d.x&&s.y===d.y?null:d;if(L&&A)return null;if(L)return s;if(A)return g;var N=Uz(l,this.vector(),d,t.vector());return N===null||!E1(a,N)?null:ib.round(N.x,N.y)}},{key:"split",value:function(t){var i=[],r=t.events!==void 0,a=new op(t,!0),l=new op(t,!1),s=this.rightSE;this.replaceRightSE(l),i.push(l),i.push(a);var d=new n(a,s,this.rings.slice(),this.windings.slice());return op.comparePoints(d.leftSE.point,d.rightSE.point)>0&&d.swapEvents(),op.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(a.checkForConsuming(),l.checkForConsuming()),i}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var i=0,r=this.windings.length;i<r;i++)this.windings[i]*=-1}},{key:"consume",value:function(t){for(var i=this,r=t;i.consumedBy;)i=i.consumedBy;for(;r.consumedBy;)r=r.consumedBy;var a=n.compare(i,r);if(a!==0){if(a>0){var l=i;i=r,r=l}if(i.prev===r){var s=i;i=r,r=s}for(var d=0,g=r.rings.length;d<g;d++){var x=r.rings[d],I=r.windings[d],A=i.rings.indexOf(x);A===-1?(i.rings.push(x),i.windings.push(I)):i.windings[A]+=I}r.rings=null,r.windings=null,r.consumedBy=i,r.leftSE.consumedBy=i.leftSE,r.rightSE.consumedBy=i.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var i=this._afterState.rings,r=this._afterState.windings,a=this._afterState.multiPolys,l=0,s=this.rings.length;l<s;l++){var d=this.rings[l],g=this.windings[l],x=i.indexOf(d);x===-1?(i.push(d),r.push(g)):r[x]+=g}for(var I=[],A=[],L=0,N=i.length;L<N;L++)if(r[L]!==0){var B=i[L],F=B.poly;if(A.indexOf(F)===-1)if(B.isExterior)I.push(F);else{A.indexOf(F)===-1&&A.push(F);var z=I.indexOf(B.poly);z!==-1&&I.splice(z,1)}}for(var V=0,Y=I.length;V<Y;V++){var Q=I[V].multiPoly;a.indexOf(Q)===-1&&a.push(Q)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var t=this.beforeState().multiPolys,i=this.afterState().multiPolys;switch(fd.type){case"union":{var r=t.length===0,a=i.length===0;this._isInResult=r!==a;break}case"intersection":{var l,s;t.length<i.length?(l=t.length,s=i.length):(l=i.length,s=t.length),this._isInResult=s===fd.numMultiPolys&&l<s;break}case"xor":{var d=Math.abs(t.length-i.length);this._isInResult=d%2===1;break}case"difference":{var g=function(I){return I.length===1&&I[0].isSubject};this._isInResult=g(t)!==g(i);break}default:throw new Error("Unrecognized operation type found ".concat(fd.type))}return this._isInResult}}],[{key:"fromRing",value:function(t,i,r){var a,l,s,d=op.comparePoints(t,i);if(d<0)a=t,l=i,s=1;else if(d>0)a=i,l=t,s=-1;else throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));var g=new op(a,!0),x=new op(l,!1);return new n(g,x,[r],[s])}}]),n}(),LA=function(){function n(e,t,i){if(Ff(this,n),!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=t,this.isExterior=i,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var r=ib.round(e[0][0],e[0][1]);this.bbox={ll:{x:r.x,y:r.y},ur:{x:r.x,y:r.y}};for(var a=r,l=1,s=e.length;l<s;l++){if(typeof e[l][0]!="number"||typeof e[l][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var d=ib.round(e[l][0],e[l][1]);d.x===a.x&&d.y===a.y||(this.segments.push(tI.fromRing(a,d,this)),d.x<this.bbox.ll.x&&(this.bbox.ll.x=d.x),d.y<this.bbox.ll.y&&(this.bbox.ll.y=d.y),d.x>this.bbox.ur.x&&(this.bbox.ur.x=d.x),d.y>this.bbox.ur.y&&(this.bbox.ur.y=d.y),a=d)}(r.x!==a.x||r.y!==a.y)&&this.segments.push(tI.fromRing(a,r,this))}return cc(n,[{key:"getSweepEvents",value:function(){for(var t=[],i=0,r=this.segments.length;i<r;i++){var a=this.segments[i];t.push(a.leftSE),t.push(a.rightSE)}return t}}]),n}(),Gz=function(){function n(e,t){if(Ff(this,n),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new LA(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var i=1,r=e.length;i<r;i++){var a=new LA(e[i],this,!1);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.interiorRings.push(a)}this.multiPoly=t}return cc(n,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),i=0,r=this.interiorRings.length;i<r;i++)for(var a=this.interiorRings[i].getSweepEvents(),l=0,s=a.length;l<s;l++)t.push(a[l]);return t}}]),n}(),RA=function(){function n(e,t){if(Ff(this,n),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var i=0,r=e.length;i<r;i++){var a=new Gz(e[i],this);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.polys.push(a)}this.isSubject=t}return cc(n,[{key:"getSweepEvents",value:function(){for(var t=[],i=0,r=this.polys.length;i<r;i++)for(var a=this.polys[i].getSweepEvents(),l=0,s=a.length;l<s;l++)t.push(a[l]);return t}}]),n}(),Hz=function(){cc(n,null,[{key:"factory",value:function(t){for(var i=[],r=0,a=t.length;r<a;r++){var l=t[r];if(!(!l.isInResult()||l.ringOut)){for(var s=null,d=l.leftSE,g=l.rightSE,x=[d],I=d.point,A=[];s=d,d=g,x.push(d),d.point!==I;)for(;;){var L=d.getAvailableLinkedEvents();if(L.length===0){var N=x[0].point,B=x[x.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(N.x,",")+" ".concat(N.y,"]. Last matching segment found ends at")+" [".concat(B.x,", ").concat(B.y,"]."))}if(L.length===1){g=L[0].otherSE;break}for(var F=null,z=0,V=A.length;z<V;z++)if(A[z].point===d.point){F=z;break}if(F!==null){var Y=A.splice(F)[0],Q=x.splice(Y.index);Q.unshift(Q[0].otherSE),i.push(new n(Q.reverse()));continue}A.push({index:x.length,point:d.point});var J=d.getLeftmostComparator(s);g=L.sort(J)[0].otherSE;break}i.push(new n(x))}}return i}}]);function n(e){Ff(this,n),this.events=e;for(var t=0,i=e.length;t<i;t++)e[t].segment.ringOut=this;this.poly=null}return cc(n,[{key:"getGeom",value:function(){for(var t=this.events[0].point,i=[t],r=1,a=this.events.length-1;r<a;r++){var l=this.events[r].point,s=this.events[r+1].point;CA(l,t,s)!==0&&(i.push(l),t=l)}if(i.length===1)return null;var d=i[0],g=i[1];CA(d,t,g)===0&&i.shift(),i.push(i[0]);for(var x=this.isExteriorRing()?1:-1,I=this.isExteriorRing()?0:i.length-1,A=this.isExteriorRing()?i.length:-1,L=[],N=I;N!=A;N+=x)L.push([i[N].x,i[N].y]);return L}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var t=this.enclosingRing();this._isExteriorRing=t?!t.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],i=1,r=this.events.length;i<r;i++){var a=this.events[i];op.compare(t,a)>0&&(t=a)}for(var l=t.segment.prevInResult(),s=l?l.prevInResult():null;;){if(!l)return null;if(!s)return l.ringOut;if(s.ringOut!==l.ringOut)return s.ringOut.enclosingRing()!==l.ringOut?l.ringOut:l.ringOut.enclosingRing();l=s.prevInResult(),s=l?l.prevInResult():null}}}]),n}(),PA=function(){function n(e){Ff(this,n),this.exteriorRing=e,e.poly=this,this.interiorRings=[]}return cc(n,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(t[0]===null)return null;for(var i=0,r=this.interiorRings.length;i<r;i++){var a=this.interiorRings[i].getGeom();a!==null&&t.push(a)}return t}}]),n}(),jz=function(){function n(e){Ff(this,n),this.rings=e,this.polys=this._composePolys(e)}return cc(n,[{key:"getGeom",value:function(){for(var t=[],i=0,r=this.polys.length;i<r;i++){var a=this.polys[i].getGeom();a!==null&&t.push(a)}return t}},{key:"_composePolys",value:function(t){for(var i=[],r=0,a=t.length;r<a;r++){var l=t[r];if(!l.poly)if(l.isExteriorRing())i.push(new PA(l));else{var s=l.enclosingRing();s.poly||i.push(new PA(s)),s.poly.addInterior(l)}}return i}}]),n}(),qz=function(){function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:tI.compare;Ff(this,n),this.queue=e,this.tree=new tC(t),this.segments=[]}return cc(n,[{key:"process",value:function(t){var i=t.segment,r=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(i),r;var a=t.isLeft?this.tree.insert(i):this.tree.find(i);if(!a)throw new Error("Unable to find segment #".concat(i.id," ")+"[".concat(i.leftSE.point.x,", ").concat(i.leftSE.point.y,"] -> ")+"[".concat(i.rightSE.point.x,", ").concat(i.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var l=a,s=a,d=void 0,g=void 0;d===void 0;)l=this.tree.prev(l),l===null?d=null:l.key.consumedBy===void 0&&(d=l.key);for(;g===void 0;)s=this.tree.next(s),s===null?g=null:s.key.consumedBy===void 0&&(g=s.key);if(t.isLeft){var x=null;if(d){var I=d.getIntersection(i);if(I!==null&&(i.isAnEndpoint(I)||(x=I),!d.isAnEndpoint(I)))for(var A=this._splitSafely(d,I),L=0,N=A.length;L<N;L++)r.push(A[L])}var B=null;if(g){var F=g.getIntersection(i);if(F!==null&&(i.isAnEndpoint(F)||(B=F),!g.isAnEndpoint(F)))for(var z=this._splitSafely(g,F),V=0,Y=z.length;V<Y;V++)r.push(z[V])}if(x!==null||B!==null){var Q=null;if(x===null)Q=B;else if(B===null)Q=x;else{var J=op.comparePoints(x,B);Q=J<=0?x:B}this.queue.remove(i.rightSE),r.push(i.rightSE);for(var he=i.split(Q),ee=0,ae=he.length;ee<ae;ee++)r.push(he[ee])}r.length>0?(this.tree.remove(i),r.push(t)):(this.segments.push(i),i.prev=d)}else{if(d&&g){var De=d.getIntersection(g);if(De!==null){if(!d.isAnEndpoint(De))for(var fe=this._splitSafely(d,De),le=0,Be=fe.length;le<Be;le++)r.push(fe[le]);if(!g.isAnEndpoint(De))for(var Pe=this._splitSafely(g,De),Ce=0,it=Pe.length;Ce<it;Ce++)r.push(Pe[Ce])}}this.tree.remove(i)}return r}},{key:"_splitSafely",value:function(t,i){this.tree.remove(t);var r=t.rightSE;this.queue.remove(r);var a=t.split(i);return a.push(r),t.consumedBy===void 0&&this.tree.insert(t),a}}]),n}(),DA=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Wz=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,Xz=function(){function n(){Ff(this,n)}return cc(n,[{key:"run",value:function(t,i,r){fd.type=t,ib.reset();for(var a=[new RA(i,!0)],l=0,s=r.length;l<s;l++)a.push(new RA(r[l],!1));if(fd.numMultiPolys=a.length,fd.type==="difference")for(var d=a[0],g=1;g<a.length;)hS(a[g].bbox,d.bbox)!==null?g++:a.splice(g,1);if(fd.type==="intersection"){for(var x=0,I=a.length;x<I;x++)for(var A=a[x],L=x+1,N=a.length;L<N;L++)if(hS(A.bbox,a[L].bbox)===null)return[]}for(var B=new tC(op.compare),F=0,z=a.length;F<z;F++)for(var V=a[F].getSweepEvents(),Y=0,Q=V.length;Y<Q;Y++)if(B.insert(V[Y]),B.size>DA)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var J=new qz(B),he=B.size,ee=B.pop();ee;){var ae=ee.key;if(B.size===he){var De=ae.segment;throw new Error("Unable to pop() ".concat(ae.isLeft?"left":"right"," SweepEvent ")+"[".concat(ae.point.x,", ").concat(ae.point.y,"] from segment #").concat(De.id," ")+"[".concat(De.leftSE.point.x,", ").concat(De.leftSE.point.y,"] -> ")+"[".concat(De.rightSE.point.x,", ").concat(De.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(B.size>DA)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(J.segments.length>Wz)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var fe=J.process(ae),le=0,Be=fe.length;le<Be;le++){var Pe=fe[le];Pe.consumedBy===void 0&&B.insert(Pe)}he=B.size,ee=B.pop()}ib.reset();var Ce=Hz.factory(J.segments),it=new jz(Ce);return it.getGeom()}}]),n}(),fd=new Xz,Zz=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return fd.run("union",e,i)},Yz=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return fd.run("intersection",e,i)},Kz=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return fd.run("xor",e,i)},Jz=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return fd.run("difference",e,i)},Qz={union:Zz,intersection:Yz,xor:Kz,difference:Jz};const rb=Qz;function $z(n,e,t){t===void 0&&(t={});var i=bg(n),r=bg(e),a=rb.intersection(i.coordinates,r.coordinates);return a.length===0?null:a.length===1?o0(a[0],t.properties):Nv(a,t.properties)}function e6(n){const e=n.map(l=>l.source.data);let t=cI(e);const[i,r]=t;return[$z(i,r)]}function t6(n){const e=n.map(i=>i.source.data),t=cI(e).filter(i=>i!==null);return n.length===t.length&&t.length===2}const n6={processor:e6,validator:t6};function i6(n,e,t){t===void 0&&(t={});var i=bg(n),r=bg(e),a=rb.union(i.coordinates,r.coordinates);return a.length===0?null:a.length===1?o0(a[0],t.properties):Nv(a,t.properties)}function r6(n){const e=n.map(r=>r.source.data),[t,i]=e.map(r=>Ef(r)?r.features.every(a=>zc(a.geometry)||ud(a.geometry))?{type:"MultiPolygon",coordinates:r.features.flatMap(a=>ud(a.geometry)?a.geometry.coordinates:zc(a.geometry)?[a.geometry.coordinates]:[])}:null:r);return[i6(t,i)].filter(r=>r!==null)}function s6(n){const e=n.map(i=>i.source.data),t=cI(e).filter(i=>i!==null);return n.length===t.length&&t.length===2}const o6={processor:r6,validator:s6};function a6(n,e){var t=bg(n),i=bg(e),r=n.properties||{},a=rb.difference(t.coordinates,i.coordinates);return a.length===0?null:a.length===1?o0(a[0],r):Nv(a,r)}function l6(n,e){if(!e)return null;const{layerA:t,layerB:i}=e,r=[t,i].map(d=>d.source.data),[a,l]=r.map(d=>Ef(d)?d.features.every(g=>zc(g.geometry)||ud(g.geometry))?{type:"MultiPolygon",coordinates:d.features.flatMap(g=>ud(g.geometry)?g.geometry.coordinates:zc(g.geometry)?[g.geometry.coordinates]:[])}:null:d);return[a6(a,l)]}function u6(n){const e=n.map(i=>i.source.data),t=cI(e).filter(i=>i!==null);return n.length===t.length&&t.length===2}const c6={processor:l6,validator:u6};function dS(n,e){e===void 0&&(e={});var t=Number(n[0]),i=Number(n[1]),r=Number(n[2]),a=Number(n[3]);if(n.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var l=[t,i],s=[t,a],d=[r,a],g=[r,i];return o0([[l,g,d,s,l]],e.properties,{bbox:n,id:e.id})}function h6(n){const t=n.map(r=>r.source.data).map(cg).map(r=>dS(r)),i=cg({type:"FeatureCollection",features:t});return[dS(i)]}function f6(n){if(n.length===0)return!1;const e=n.map(t=>t.source.data).filter(VP);return n.length===e.length}const d6={processor:h6,validator:f6};function OA(n){return function(){return n}}function p6(n){return n[0]}function m6(n){return n[1]}function nI(){this._=null}function CI(n){n.U=n.C=n.L=n.R=n.P=n.N=null}nI.prototype={constructor:nI,insert:function(n,e){var t,i,r;if(n){if(e.P=n,e.N=n.N,n.N&&(n.N.P=e),n.N=e,n.R){for(n=n.R;n.L;)n=n.L;n.L=e}else n.R=e;t=n}else this._?(n=NA(this._),e.P=null,e.N=n,n.P=n.L=e,t=n):(e.P=e.N=null,this._=e,t=null);for(e.L=e.R=null,e.U=t,e.C=!0,n=e;t&&t.C;)i=t.U,t===i.L?(r=i.R,r&&r.C?(t.C=r.C=!1,i.C=!0,n=i):(n===t.R&&(I1(this,t),n=t,t=n.U),t.C=!1,i.C=!0,T1(this,i))):(r=i.L,r&&r.C?(t.C=r.C=!1,i.C=!0,n=i):(n===t.L&&(T1(this,t),n=t,t=n.U),t.C=!1,i.C=!0,I1(this,i))),t=n.U;this._.C=!1},remove:function(n){n.N&&(n.N.P=n.P),n.P&&(n.P.N=n.N),n.N=n.P=null;var e=n.U,t,i=n.L,r=n.R,a,l;if(i?r?a=NA(r):a=i:a=r,e?e.L===n?e.L=a:e.R=a:this._=a,i&&r?(l=a.C,a.C=n.C,a.L=i,i.U=a,a!==r?(e=a.U,a.U=n.U,n=a.R,e.L=n,a.R=r,r.U=a):(a.U=e,e=a,n=a.R)):(l=n.C,n=a),n&&(n.U=e),!l){if(n&&n.C){n.C=!1;return}do{if(n===this._)break;if(n===e.L){if(t=e.R,t.C&&(t.C=!1,e.C=!0,I1(this,e),t=e.R),t.L&&t.L.C||t.R&&t.R.C){(!t.R||!t.R.C)&&(t.L.C=!1,t.C=!0,T1(this,t),t=e.R),t.C=e.C,e.C=t.R.C=!1,I1(this,e),n=this._;break}}else if(t=e.L,t.C&&(t.C=!1,e.C=!0,T1(this,e),t=e.L),t.L&&t.L.C||t.R&&t.R.C){(!t.L||!t.L.C)&&(t.R.C=!1,t.C=!0,I1(this,t),t=e.L),t.C=e.C,e.C=t.L.C=!1,T1(this,e),n=this._;break}t.C=!0,n=e,e=e.U}while(!n.C);n&&(n.C=!1)}}};function I1(n,e){var t=e,i=e.R,r=t.U;r?r.L===t?r.L=i:r.R=i:n._=i,i.U=r,t.U=i,t.R=i.L,t.R&&(t.R.U=t),i.L=t}function T1(n,e){var t=e,i=e.L,r=t.U;r?r.L===t?r.L=i:r.R=i:n._=i,i.U=r,t.U=i,t.L=i.R,t.L&&(t.L.U=t),i.R=t}function NA(n){for(;n.L;)n=n.L;return n}function O1(n,e,t,i){var r=[null,null],a=wu.push(r)-1;return r.left=n,r.right=e,t&&iI(r,n,e,t),i&&iI(r,e,n,i),xh[n.index].halfedges.push(a),xh[e.index].halfedges.push(a),r}function w1(n,e,t){var i=[e,t];return i.left=n,i}function iI(n,e,t,i){!n[0]&&!n[1]?(n[0]=i,n.left=e,n.right=t):n.left===t?n[1]=i:n[0]=i}function g6(n,e,t,i,r){var a=n[0],l=n[1],s=a[0],d=a[1],g=l[0],x=l[1],I=0,A=1,L=g-s,N=x-d,B;if(B=e-s,!(!L&&B>0)){if(B/=L,L<0){if(B<I)return;B<A&&(A=B)}else if(L>0){if(B>A)return;B>I&&(I=B)}if(B=i-s,!(!L&&B<0)){if(B/=L,L<0){if(B>A)return;B>I&&(I=B)}else if(L>0){if(B<I)return;B<A&&(A=B)}if(B=t-d,!(!N&&B>0)){if(B/=N,N<0){if(B<I)return;B<A&&(A=B)}else if(N>0){if(B>A)return;B>I&&(I=B)}if(B=r-d,!(!N&&B<0)){if(B/=N,N<0){if(B>A)return;B>I&&(I=B)}else if(N>0){if(B<I)return;B<A&&(A=B)}return!(I>0)&&!(A<1)||(I>0&&(n[0]=[s+I*L,d+I*N]),A<1&&(n[1]=[s+A*L,d+A*N])),!0}}}}}function _6(n,e,t,i,r){var a=n[1];if(a)return!0;var l=n[0],s=n.left,d=n.right,g=s[0],x=s[1],I=d[0],A=d[1],L=(g+I)/2,N=(x+A)/2,B,F;if(A===x){if(L<e||L>=i)return;if(g>I){if(!l)l=[L,t];else if(l[1]>=r)return;a=[L,r]}else{if(!l)l=[L,r];else if(l[1]<t)return;a=[L,t]}}else if(B=(g-I)/(A-x),F=N-B*L,B<-1||B>1)if(g>I){if(!l)l=[(t-F)/B,t];else if(l[1]>=r)return;a=[(r-F)/B,r]}else{if(!l)l=[(r-F)/B,r];else if(l[1]<t)return;a=[(t-F)/B,t]}else if(x<A){if(!l)l=[e,B*e+F];else if(l[0]>=i)return;a=[i,B*i+F]}else{if(!l)l=[i,B*i+F];else if(l[0]<e)return;a=[e,B*e+F]}return n[0]=l,n[1]=a,!0}function y6(n,e,t,i){for(var r=wu.length,a;r--;)(!_6(a=wu[r],n,e,t,i)||!g6(a,n,e,t,i)||!(Math.abs(a[0][0]-a[1][0])>no||Math.abs(a[0][1]-a[1][1])>no))&&delete wu[r]}function v6(n){return xh[n.index]={site:n,halfedges:[]}}function b6(n,e){var t=n.site,i=e.left,r=e.right;return t===r&&(r=i,i=t),r?Math.atan2(r[1]-i[1],r[0]-i[0]):(t===i?(i=e[1],r=e[0]):(i=e[0],r=e[1]),Math.atan2(i[0]-r[0],r[1]-i[1]))}function XR(n,e){return e[+(e.left!==n.site)]}function x6(n,e){return e[+(e.left===n.site)]}function E6(){for(var n=0,e=xh.length,t,i,r,a;n<e;++n)if((t=xh[n])&&(a=(i=t.halfedges).length)){var l=new Array(a),s=new Array(a);for(r=0;r<a;++r)l[r]=r,s[r]=b6(t,wu[i[r]]);for(l.sort(function(d,g){return s[g]-s[d]}),r=0;r<a;++r)s[r]=i[l[r]];for(r=0;r<a;++r)i[r]=s[r]}}function I6(n,e,t,i){var r=xh.length,a,l,s,d,g,x,I,A,L,N,B,F,z=!0;for(a=0;a<r;++a)if(l=xh[a]){for(s=l.site,g=l.halfedges,d=g.length;d--;)wu[g[d]]||g.splice(d,1);for(d=0,x=g.length;d<x;)N=x6(l,wu[g[d]]),B=N[0],F=N[1],I=XR(l,wu[g[++d%x]]),A=I[0],L=I[1],(Math.abs(B-A)>no||Math.abs(F-L)>no)&&(g.splice(d,0,wu.push(w1(s,N,Math.abs(B-n)<no&&i-F>no?[n,Math.abs(A-n)<no?L:i]:Math.abs(F-i)<no&&t-B>no?[Math.abs(L-i)<no?A:t,i]:Math.abs(B-t)<no&&F-e>no?[t,Math.abs(A-t)<no?L:e]:Math.abs(F-e)<no&&B-n>no?[Math.abs(L-e)<no?A:n,e]:null))-1),++x);x&&(z=!1)}if(z){var V,Y,Q,J=1/0;for(a=0,z=null;a<r;++a)(l=xh[a])&&(s=l.site,V=s[0]-n,Y=s[1]-e,Q=V*V+Y*Y,Q<J&&(J=Q,z=l));if(z){var he=[n,e],ee=[n,i],ae=[t,i],De=[t,e];z.halfedges.push(wu.push(w1(s=z.site,he,ee))-1,wu.push(w1(s,ee,ae))-1,wu.push(w1(s,ae,De))-1,wu.push(w1(s,De,he))-1)}}for(a=0;a<r;++a)(l=xh[a])&&(l.halfedges.length||delete xh[a])}var ZR=[],nC;function T6(){CI(this),this.x=this.y=this.arc=this.site=this.cy=null}function _v(n){var e=n.P,t=n.N;if(!(!e||!t)){var i=e.site,r=n.site,a=t.site;if(i!==a){var l=r[0],s=r[1],d=i[0]-l,g=i[1]-s,x=a[0]-l,I=a[1]-s,A=2*(d*I-g*x);if(!(A>=-M6)){var L=d*d+g*g,N=x*x+I*I,B=(I*L-g*N)/A,F=(d*N-x*L)/A,z=ZR.pop()||new T6;z.arc=n,z.site=r,z.x=B+l,z.y=(z.cy=F+s)+Math.sqrt(B*B+F*F),n.circle=z;for(var V=null,Y=sb._;Y;)if(z.y<Y.y||z.y===Y.y&&z.x<=Y.x)if(Y.L)Y=Y.L;else{V=Y.P;break}else if(Y.R)Y=Y.R;else{V=Y;break}sb.insert(V,z),V||(nC=z)}}}}function wv(n){var e=n.circle;e&&(e.P||(nC=e.N),sb.remove(e),ZR.push(e),CI(e),n.circle=null)}var YR=[];function w6(){CI(this),this.edge=this.site=this.circle=null}function kA(n){var e=YR.pop()||new w6;return e.site=n,e}function Bw(n){wv(n),Sv.remove(n),YR.push(n),CI(n)}function S6(n){var e=n.circle,t=e.x,i=e.cy,r=[t,i],a=n.P,l=n.N,s=[n];Bw(n);for(var d=a;d.circle&&Math.abs(t-d.circle.x)<no&&Math.abs(i-d.circle.cy)<no;)a=d.P,s.unshift(d),Bw(d),d=a;s.unshift(d),wv(d);for(var g=l;g.circle&&Math.abs(t-g.circle.x)<no&&Math.abs(i-g.circle.cy)<no;)l=g.N,s.push(g),Bw(g),g=l;s.push(g),wv(g);var x=s.length,I;for(I=1;I<x;++I)g=s[I],d=s[I-1],iI(g.edge,d.site,g.site,r);d=s[0],g=s[x-1],g.edge=O1(d.site,g.site,null,r),_v(d),_v(g)}function C6(n){for(var e=n[0],t=n[1],i,r,a,l,s=Sv._;s;)if(a=KR(s,t)-e,a>no)s=s.L;else if(l=e-A6(s,t),l>no){if(!s.R){i=s;break}s=s.R}else{a>-no?(i=s.P,r=s):l>-no?(i=s,r=s.N):i=r=s;break}v6(n);var d=kA(n);if(Sv.insert(i,d),!(!i&&!r)){if(i===r){wv(i),r=kA(i.site),Sv.insert(d,r),d.edge=r.edge=O1(i.site,d.site),_v(i),_v(r);return}if(!r){d.edge=O1(i.site,d.site);return}wv(i),wv(r);var g=i.site,x=g[0],I=g[1],A=n[0]-x,L=n[1]-I,N=r.site,B=N[0]-x,F=N[1]-I,z=2*(A*F-L*B),V=A*A+L*L,Y=B*B+F*F,Q=[(F*V-L*Y)/z+x,(A*Y-B*V)/z+I];iI(r.edge,g,N,Q),d.edge=O1(g,n,null,Q),r.edge=O1(n,N,null,Q),_v(i),_v(r)}}function KR(n,e){var t=n.site,i=t[0],r=t[1],a=r-e;if(!a)return i;var l=n.P;if(!l)return-1/0;t=l.site;var s=t[0],d=t[1],g=d-e;if(!g)return s;var x=s-i,I=1/a-1/g,A=x/g;return I?(-A+Math.sqrt(A*A-2*I*(x*x/(-2*g)-d+g/2+r-a/2)))/I+i:(i+s)/2}function A6(n,e){var t=n.N;if(t)return KR(t,e);var i=n.site;return i[1]===e?i[0]:1/0}var no=1e-6,M6=1e-12,Sv,xh,sb,wu;function L6(n,e,t){return(n[0]-t[0])*(e[1]-n[1])-(n[0]-e[0])*(t[1]-n[1])}function R6(n,e){return e[1]-n[1]||e[0]-n[0]}function pS(n,e){var t=n.sort(R6).pop(),i,r,a;for(wu=[],xh=new Array(n.length),Sv=new nI,sb=new nI;;)if(a=nC,t&&(!a||t[1]<a.y||t[1]===a.y&&t[0]<a.x))(t[0]!==i||t[1]!==r)&&(C6(t),i=t[0],r=t[1]),t=n.pop();else if(a)S6(a.arc);else break;if(E6(),e){var l=+e[0][0],s=+e[0][1],d=+e[1][0],g=+e[1][1];y6(l,s,d,g),I6(l,s,d,g)}this.edges=wu,this.cells=xh,Sv=sb=wu=xh=null}pS.prototype={constructor:pS,polygons:function(){var n=this.edges;return this.cells.map(function(e){var t=e.halfedges.map(function(i){return XR(e,n[i])});return t.data=e.site.data,t})},triangles:function(){var n=[],e=this.edges;return this.cells.forEach(function(t,i){if(s=(a=t.halfedges).length)for(var r=t.site,a,l=-1,s,d,g=e[a[s-1]],x=g.left===r?g.right:g.left;++l<s;)d=x,g=e[a[l]],x=g.left===r?g.right:g.left,d&&x&&i<d.index&&i<x.index&&L6(r,d,x)<0&&n.push([r.data,d.data,x.data])}),n},links:function(){return this.edges.filter(function(n){return n.right}).map(function(n){return{source:n.left.data,target:n.right.data}})},find:function(n,e,t){for(var i=this,r,a=i._found||0,l=i.cells.length,s;!(s=i.cells[a]);)if(++a>=l)return null;var d=n-s.site[0],g=e-s.site[1],x=d*d+g*g;do s=i.cells[r=a],a=null,s.halfedges.forEach(function(I){var A=i.edges[I],L=A.left;if(!((L===s.site||!L)&&!(L=A.right))){var N=n-L[0],B=e-L[1],F=N*N+B*B;F<x&&(x=F,a=L.index)}});while(a!==null);return i._found=r,t==null||x<=t*t?s.site:null}};function P6(){var n=p6,e=m6,t=null;function i(r){return new pS(r.map(function(a,l){var s=[Math.round(n(a,l,r)/no)*no,Math.round(e(a,l,r)/no)*no];return s.index=l,s.data=a,s}),t)}return i.polygons=function(r){return i(r).polygons()},i.links=function(r){return i(r).links()},i.triangles=function(r){return i(r).triangles()},i.x=function(r){return arguments.length?(n=typeof r=="function"?r:OA(+r),i):n},i.y=function(r){return arguments.length?(e=typeof r=="function"?r:OA(+r),i):e},i.extent=function(r){return arguments.length?(t=r==null?null:[[+r[0][0],+r[0][1]],[+r[1][0],+r[1][1]]],i):t&&[[t[0][0],t[0][1]],[t[1][0],t[1][1]]]},i.size=function(r){return arguments.length?(t=r==null?null:[[0,0],[+r[0],+r[1]]],i):t&&[t[1][0]-t[0][0],t[1][1]-t[0][1]]},i}function D6(n){return n=n.slice(),n.push(n[0]),o0([n])}function O6(n,e){if(e=e||{},!tR(e))throw new Error("options is invalid");var t=e.bbox||[-180,-85,180,85];if(!n)throw new Error("points is required");if(!Array.isArray(t))throw new Error("bbox is invalid");return qR(n,"Point","points"),Ov(P6().x(function(i){return i.geometry.coordinates[0]}).y(function(i){return i.geometry.coordinates[1]}).extent([[t[0],t[1]],[t[2],t[3]]]).polygons(n.features).map(D6))}function mS(n){if(!n)throw new Error("geojson is required");var e=[];return O5(n,function(t){e.push(t)}),Ov(e)}function N6(n,e){return n.map(r=>r.source.data).map(r=>{H_(r)?r={type:"FeatureCollection",features:r.geometries.map(s=>({type:"Feature",geometry:s,properties:{}}))}:ob(r)&&(v_(r)||b_(r))?r={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:r.type,coordinates:r.coordinates},properties:{}}]}:bp(r)&&(r={type:"FeatureCollection",features:[r]});const a=mS(r),l=O6(a,{bbox:(e==null?void 0:e.bbox)||cg(a)});return l.features=l.features.filter(s=>s!==void 0),l}).filter(r=>r!==null)}function k6(n){return n.length===0?!1:n.map(t=>t.source.data).every(t=>{if(H_(t))return t.geometries.every(i=>v_(i)||b_(i));if(ob(t))return v_(t)||b_(t);if(bp(t))return v_(t.geometry)||b_(t.geometry);if(Ef(t))return t.features.every(i=>v_(i.geometry)||b_(i.geometry))})}const F6={processor:N6,validator:k6};function B6(n,e,t){var i=n.length,r=yv(n[0],e),a=[],l,s,d,g,x;for(t||(t=[]),l=1;l<i;l++){for(g=n[l-1],x=n[l],s=d=yv(x,e);;)if(r|s){if(r&s)break;r?(g=gS(g,x,r,e),r=yv(g,e)):(x=gS(g,x,s,e),s=yv(x,e))}else{a.push(g),s!==d?(a.push(x),l<i-1&&(t.push(a),a=[])):l===i-1&&a.push(x);break}r=d}return a.length&&t.push(a),t}function z6(n,e){var t,i,r,a,l,s,d;for(i=1;i<=8;i*=2){for(t=[],r=n[n.length-1],a=!(yv(r,e)&i),l=0;l<n.length;l++)s=n[l],d=!(yv(s,e)&i),d!==a&&t.push(gS(r,s,i,e)),d&&t.push(s),r=s,a=d;if(n=t,!n.length)break}return t}function gS(n,e,t,i){return t&8?[n[0]+(e[0]-n[0])*(i[3]-n[1])/(e[1]-n[1]),i[3]]:t&4?[n[0]+(e[0]-n[0])*(i[1]-n[1])/(e[1]-n[1]),i[1]]:t&2?[i[2],n[1]+(e[1]-n[1])*(i[2]-n[0])/(e[0]-n[0])]:t&1?[i[0],n[1]+(e[1]-n[1])*(i[0]-n[0])/(e[0]-n[0])]:null}function yv(n,e){var t=0;return n[0]<e[0]?t|=1:n[0]>e[2]&&(t|=2),n[1]<e[1]?t|=4:n[1]>e[3]&&(t|=8),t}function U6(n,e){var t=bg(n),i=t.type,r=n.type==="Feature"?n.properties:{},a=t.coordinates;switch(i){case"LineString":case"MultiLineString":{var l=[];return i==="LineString"&&(a=[a]),a.forEach(function(s){B6(s,e,l)}),l.length===1?L5(l[0],r):R5(l,r)}case"Polygon":return o0(FA(a,e),r);case"MultiPolygon":return Nv(a.map(function(s){return FA(s,e)}),r);default:throw new Error("geometry "+i+" not supported")}}function FA(n,e){for(var t=[],i=0,r=n;i<r.length;i++){var a=r[i],l=z6(a,e);l.length>0&&((l[0][0]!==l[l.length-1][0]||l[0][1]!==l[l.length-1][1])&&l.push(l[0]),l.length>=4&&t.push(l))}return t}function BA(n,e,t){if(t===void 0&&(t={}),!n)throw new Error("point is required");if(!e)throw new Error("polygon is required");var i=Mz(n),r=bg(e),a=r.type,l=e.bbox,s=r.coordinates;if(l&&V6(i,l)===!1)return!1;a==="Polygon"&&(s=[s]);for(var d=!1,g=0;g<s.length&&!d;g++)if(zA(i,s[g][0],t.ignoreBoundary)){for(var x=!1,I=1;I<s[g].length&&!x;)zA(i,s[g][I],!t.ignoreBoundary)&&(x=!0),I++;x||(d=!0)}return d}function zA(n,e,t){var i=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var r=0,a=e.length-1;r<e.length;a=r++){var l=e[r][0],s=e[r][1],d=e[a][0],g=e[a][1],x=n[1]*(l-d)+s*(d-n[0])+g*(n[0]-l)===0&&(l-n[0])*(d-n[0])<=0&&(s-n[1])*(g-n[1])<=0;if(x)return!t;var I=s>n[1]!=g>n[1]&&n[0]<(d-l)*(n[1]-s)/(g-s)+l;I&&(i=!i)}return i}function V6(n,e){return e[0]<=n[0]&&e[1]<=n[1]&&e[2]>=n[0]&&e[3]>=n[1]}function zw(n,e){let t;if(bp(n))t=n.geometry;else if(ob(n))t=n;else return[];const i=dS(e.bbox);if(v_(t)){if(BA(t,i))return{type:"Feature",geometry:t,properties:{}}}else if(b_(t))return{type:"Feature",geometry:{type:"MultiPoint",coordinates:t.coordinates.filter(r=>BA(r,i))},properties:{}};return pL(t)||mL(t)||zc(t)||ud(t)?U6(t,e.bbox):[]}function G6(n,e){return n.map(r=>r.source.data).map(r=>H_(r)?{type:"GeometryCollection",geometries:r.geometries.flatMap(a=>zw(a,e)).map(a=>a.geometry)}:Ef(r)?{type:"FeatureCollection",features:r.features.flatMap(a=>zw(a,e))}:bp(r)||ob(r)?zw(r,e):null).filter(r=>r!==void 0)}function H6(n,e){const t=n.map(i=>i.source.data);return n.length>0&&e!==void 0&&t.every(i=>gd(i))}const j6={processor:G6,validator:H6};function q6(n,e){if(e=e||{},!tR(e))throw new Error("options is invalid");var t=e.propertyName;qR(n,"Polygon","dissolve");var i=[];if(e.propertyName){var r={};eS(n,function(d){Object.prototype.hasOwnProperty.call(r,d.properties[t])||(r[d.properties[t]]=[]),r[d.properties[t]].push(d)});for(var a=Object.keys(r),l=0;l<a.length;l++){var s=Nv(rb.union.apply(null,r[a[l]].map(function(d){return d.geometry.coordinates})));s.properties[t]=a[l],i.push(s)}}else return mS(Nv(rb.union.apply(null,n.features.map(function(d){return d.geometry.coordinates}))));return mS(Ov(i))}function W6(n){return JR(n)?n.map(t=>t.source.data).map(t=>q6(t)):null}function JR(n){return n.length===0?!1:n.every(e=>{const t=e.source.data;return gd(t)&&Ef(t)&&t.features.every(i=>zc(i.geometry))})}const X6={processor:W6,validator:JR};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var za={DISABLED:"mdc-slider--disabled",DISCRETE:"mdc-slider--discrete",INPUT:"mdc-slider__input",RANGE:"mdc-slider--range",THUMB:"mdc-slider__thumb",THUMB_FOCUSED:"mdc-slider__thumb--focused",THUMB_KNOB:"mdc-slider__thumb-knob",THUMB_TOP:"mdc-slider__thumb--top",THUMB_WITH_INDICATOR:"mdc-slider__thumb--with-indicator",TICK_MARKS:"mdc-slider--tick-marks",TICK_MARKS_CONTAINER:"mdc-slider__tick-marks",TICK_MARK_ACTIVE:"mdc-slider__tick-mark--active",TICK_MARK_INACTIVE:"mdc-slider__tick-mark--inactive",TRACK:"mdc-slider__track",TRACK_ACTIVE:"mdc-slider__track--active_fill",VALUE_INDICATOR_CONTAINER:"mdc-slider__value-indicator-container",VALUE_INDICATOR_TEXT:"mdc-slider__value-indicator-text"},Uw={STEP_SIZE:1,MIN_RANGE:0,THUMB_UPDATE_MIN_PX:5},Ua={ARIA_VALUETEXT:"aria-valuetext",INPUT_DISABLED:"disabled",INPUT_MIN:"min",INPUT_MAX:"max",INPUT_VALUE:"value",INPUT_STEP:"step",DATA_MIN_RANGE:"data-min-range"},Al={VAR_VALUE_INDICATOR_CARET_LEFT:"--slider-value-indicator-caret-left",VAR_VALUE_INDICATOR_CARET_RIGHT:"--slider-value-indicator-caret-right",VAR_VALUE_INDICATOR_CARET_TRANSFORM:"--slider-value-indicator-caret-transform",VAR_VALUE_INDICATOR_CONTAINER_LEFT:"--slider-value-indicator-container-left",VAR_VALUE_INDICATOR_CONTAINER_RIGHT:"--slider-value-indicator-container-right",VAR_VALUE_INDICATOR_CONTAINER_TRANSFORM:"--slider-value-indicator-container-transform"};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var vf;(function(n){n[n.ACTIVE=0]="ACTIVE",n[n.INACTIVE=1]="INACTIVE"})(vf||(vf={}));var jt;(function(n){n[n.START=1]="START",n[n.END=2]="END"})(jt||(jt={}));/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var rI;(function(n){n.SLIDER_UPDATE="slider_update"})(rI||(rI={}));var Vw=typeof window<"u",Z6=function(n){Wo(e,n);function e(t){var i=n.call(this,zr(zr({},e.defaultAdapter),t))||this;return i.initialStylesRemoved=!1,i.isDisabled=!1,i.isDiscrete=!1,i.step=Uw.STEP_SIZE,i.minRange=Uw.MIN_RANGE,i.hasTickMarks=!1,i.isRange=!1,i.thumb=null,i.downEventClientX=null,i.startThumbKnobWidth=0,i.endThumbKnobWidth=0,i.animFrame=new AS,i}return Object.defineProperty(e,"defaultAdapter",{get:function(){return{hasClass:function(){return!1},addClass:function(){},removeClass:function(){},addThumbClass:function(){},removeThumbClass:function(){},getAttribute:function(){return null},getInputValue:function(){return""},setInputValue:function(){},getInputAttribute:function(){return null},setInputAttribute:function(){return null},removeInputAttribute:function(){return null},focusInput:function(){},isInputFocused:function(){return!1},shouldHideFocusStylesForPointerEvents:function(){return!1},getThumbKnobWidth:function(){return 0},getValueIndicatorContainerWidth:function(){return 0},getThumbBoundingClientRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},getBoundingClientRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},isRTL:function(){return!1},setThumbStyleProperty:function(){},removeThumbStyleProperty:function(){},setTrackActiveStyleProperty:function(){},removeTrackActiveStyleProperty:function(){},setValueIndicatorText:function(){},getValueToAriaValueTextFn:function(){return null},updateTickMarks:function(){},setPointerCapture:function(){},emitChangeEvent:function(){},emitInputEvent:function(){},emitDragStartEvent:function(){},emitDragEndEvent:function(){},registerEventHandler:function(){},deregisterEventHandler:function(){},registerThumbEventHandler:function(){},deregisterThumbEventHandler:function(){},registerInputEventHandler:function(){},deregisterInputEventHandler:function(){},registerBodyEventHandler:function(){},deregisterBodyEventHandler:function(){},registerWindowEventHandler:function(){},deregisterWindowEventHandler:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){var t=this;this.isDisabled=this.adapter.hasClass(za.DISABLED),this.isDiscrete=this.adapter.hasClass(za.DISCRETE),this.hasTickMarks=this.adapter.hasClass(za.TICK_MARKS),this.isRange=this.adapter.hasClass(za.RANGE);var i=this.convertAttributeValueToNumber(this.adapter.getInputAttribute(Ua.INPUT_MIN,this.isRange?jt.START:jt.END),Ua.INPUT_MIN),r=this.convertAttributeValueToNumber(this.adapter.getInputAttribute(Ua.INPUT_MAX,jt.END),Ua.INPUT_MAX),a=this.convertAttributeValueToNumber(this.adapter.getInputAttribute(Ua.INPUT_VALUE,jt.END),Ua.INPUT_VALUE),l=this.isRange?this.convertAttributeValueToNumber(this.adapter.getInputAttribute(Ua.INPUT_VALUE,jt.START),Ua.INPUT_VALUE):i,s=this.adapter.getInputAttribute(Ua.INPUT_STEP,jt.END),d=s?this.convertAttributeValueToNumber(s,Ua.INPUT_STEP):this.step,g=this.adapter.getAttribute(Ua.DATA_MIN_RANGE),x=g?this.convertAttributeValueToNumber(g,Ua.DATA_MIN_RANGE):this.minRange;this.validateProperties({min:i,max:r,value:a,valueStart:l,step:d,minRange:x}),this.min=i,this.max=r,this.value=a,this.valueStart=l,this.step=d,this.minRange=x,this.numDecimalPlaces=UA(this.step),this.valueBeforeDownEvent=a,this.valueStartBeforeDownEvent=l,this.mousedownOrTouchstartListener=this.handleMousedownOrTouchstart.bind(this),this.moveListener=this.handleMove.bind(this),this.pointerdownListener=this.handlePointerdown.bind(this),this.pointerupListener=this.handlePointerup.bind(this),this.thumbMouseenterListener=this.handleThumbMouseenter.bind(this),this.thumbMouseleaveListener=this.handleThumbMouseleave.bind(this),this.inputStartChangeListener=function(){t.handleInputChange(jt.START)},this.inputEndChangeListener=function(){t.handleInputChange(jt.END)},this.inputStartFocusListener=function(){t.handleInputFocus(jt.START)},this.inputEndFocusListener=function(){t.handleInputFocus(jt.END)},this.inputStartBlurListener=function(){t.handleInputBlur(jt.START)},this.inputEndBlurListener=function(){t.handleInputBlur(jt.END)},this.resizeListener=this.handleResize.bind(this),this.registerEventHandlers()},e.prototype.destroy=function(){this.deregisterEventHandlers()},e.prototype.setMin=function(t){this.min=t,this.isRange||(this.valueStart=t),this.updateUI()},e.prototype.setMax=function(t){this.max=t,this.updateUI()},e.prototype.getMin=function(){return this.min},e.prototype.getMax=function(){return this.max},e.prototype.getValue=function(){return this.value},e.prototype.setValue=function(t){if(this.isRange&&t<this.valueStart+this.minRange)throw new Error("end thumb value ("+t+") must be >= start thumb "+("value ("+this.valueStart+") + min range ("+this.minRange+")"));this.updateValue(t,jt.END)},e.prototype.getValueStart=function(){if(!this.isRange)throw new Error("`valueStart` is only applicable for range sliders.");return this.valueStart},e.prototype.setValueStart=function(t){if(!this.isRange)throw new Error("`valueStart` is only applicable for range sliders.");if(this.isRange&&t>this.value-this.minRange)throw new Error("start thumb value ("+t+") must be <= end thumb "+("value ("+this.value+") - min range ("+this.minRange+")"));this.updateValue(t,jt.START)},e.prototype.setStep=function(t){this.step=t,this.numDecimalPlaces=UA(t),this.updateUI()},e.prototype.setMinRange=function(t){if(!this.isRange)throw new Error("`minRange` is only applicable for range sliders.");if(t<0)throw new Error("`minRange` must be non-negative. "+("Current value: "+t));if(this.value-this.valueStart<t)throw new Error("start thumb value ("+this.valueStart+") and end thumb value "+("("+this.value+") must differ by at least "+t+"."));this.minRange=t},e.prototype.setIsDiscrete=function(t){this.isDiscrete=t,this.updateValueIndicatorUI(),this.updateTickMarksUI()},e.prototype.getStep=function(){return this.step},e.prototype.getMinRange=function(){if(!this.isRange)throw new Error("`minRange` is only applicable for range sliders.");return this.minRange},e.prototype.setHasTickMarks=function(t){this.hasTickMarks=t,this.updateTickMarksUI()},e.prototype.getDisabled=function(){return this.isDisabled},e.prototype.setDisabled=function(t){this.isDisabled=t,t?(this.adapter.addClass(za.DISABLED),this.isRange&&this.adapter.setInputAttribute(Ua.INPUT_DISABLED,"",jt.START),this.adapter.setInputAttribute(Ua.INPUT_DISABLED,"",jt.END)):(this.adapter.removeClass(za.DISABLED),this.isRange&&this.adapter.removeInputAttribute(Ua.INPUT_DISABLED,jt.START),this.adapter.removeInputAttribute(Ua.INPUT_DISABLED,jt.END))},e.prototype.getIsRange=function(){return this.isRange},e.prototype.layout=function(t){var i=t===void 0?{}:t,r=i.skipUpdateUI;this.rect=this.adapter.getBoundingClientRect(),this.isRange&&(this.startThumbKnobWidth=this.adapter.getThumbKnobWidth(jt.START),this.endThumbKnobWidth=this.adapter.getThumbKnobWidth(jt.END)),r||this.updateUI()},e.prototype.handleResize=function(){this.layout()},e.prototype.handleDown=function(t){if(!this.isDisabled){this.valueStartBeforeDownEvent=this.valueStart,this.valueBeforeDownEvent=this.value;var i=t.clientX!=null?t.clientX:t.targetTouches[0].clientX;this.downEventClientX=i;var r=this.mapClientXOnSliderScale(i);this.thumb=this.getThumbFromDownEvent(i,r),this.thumb!==null&&(this.handleDragStart(t,r,this.thumb),this.updateValue(r,this.thumb,{emitInputEvent:!0}))}},e.prototype.handleMove=function(t){if(!this.isDisabled){t.preventDefault();var i=t.clientX!=null?t.clientX:t.targetTouches[0].clientX,r=this.thumb!=null;if(this.thumb=this.getThumbFromMoveEvent(i),this.thumb!==null){var a=this.mapClientXOnSliderScale(i);r||(this.handleDragStart(t,a,this.thumb),this.adapter.emitDragStartEvent(a,this.thumb)),this.updateValue(a,this.thumb,{emitInputEvent:!0})}}},e.prototype.handleUp=function(){var t,i;if(!(this.isDisabled||this.thumb===null)){!((i=(t=this.adapter).shouldHideFocusStylesForPointerEvents)===null||i===void 0)&&i.call(t)&&this.handleInputBlur(this.thumb);var r=this.thumb===jt.START?this.valueStartBeforeDownEvent:this.valueBeforeDownEvent,a=this.thumb===jt.START?this.valueStart:this.value;r!==a&&this.adapter.emitChangeEvent(a,this.thumb),this.adapter.emitDragEndEvent(a,this.thumb),this.thumb=null}},e.prototype.handleThumbMouseenter=function(){!this.isDiscrete||!this.isRange||(this.adapter.addThumbClass(za.THUMB_WITH_INDICATOR,jt.START),this.adapter.addThumbClass(za.THUMB_WITH_INDICATOR,jt.END))},e.prototype.handleThumbMouseleave=function(){var t,i;!this.isDiscrete||!this.isRange||!(!((i=(t=this.adapter).shouldHideFocusStylesForPointerEvents)===null||i===void 0)&&i.call(t))&&(this.adapter.isInputFocused(jt.START)||this.adapter.isInputFocused(jt.END))||this.thumb||(this.adapter.removeThumbClass(za.THUMB_WITH_INDICATOR,jt.START),this.adapter.removeThumbClass(za.THUMB_WITH_INDICATOR,jt.END))},e.prototype.handleMousedownOrTouchstart=function(t){var i=this,r=t.type==="mousedown"?"mousemove":"touchmove";this.adapter.registerBodyEventHandler(r,this.moveListener);var a=function(){i.handleUp(),i.adapter.deregisterBodyEventHandler(r,i.moveListener),i.adapter.deregisterEventHandler("mouseup",a),i.adapter.deregisterEventHandler("touchend",a)};this.adapter.registerBodyEventHandler("mouseup",a),this.adapter.registerBodyEventHandler("touchend",a),this.handleDown(t)},e.prototype.handlePointerdown=function(t){var i=t.button===0;i&&(t.pointerId!=null&&this.adapter.setPointerCapture(t.pointerId),this.adapter.registerEventHandler("pointermove",this.moveListener),this.handleDown(t))},e.prototype.handleInputChange=function(t){var i=Number(this.adapter.getInputValue(t));t===jt.START?this.setValueStart(i):this.setValue(i),this.adapter.emitChangeEvent(t===jt.START?this.valueStart:this.value,t),this.adapter.emitInputEvent(t===jt.START?this.valueStart:this.value,t)},e.prototype.handleInputFocus=function(t){if(this.adapter.addThumbClass(za.THUMB_FOCUSED,t),!!this.isDiscrete&&(this.adapter.addThumbClass(za.THUMB_WITH_INDICATOR,t),this.isRange)){var i=t===jt.START?jt.END:jt.START;this.adapter.addThumbClass(za.THUMB_WITH_INDICATOR,i)}},e.prototype.handleInputBlur=function(t){if(this.adapter.removeThumbClass(za.THUMB_FOCUSED,t),!!this.isDiscrete&&(this.adapter.removeThumbClass(za.THUMB_WITH_INDICATOR,t),this.isRange)){var i=t===jt.START?jt.END:jt.START;this.adapter.removeThumbClass(za.THUMB_WITH_INDICATOR,i)}},e.prototype.handleDragStart=function(t,i,r){var a,l;this.adapter.emitDragStartEvent(i,r),this.adapter.focusInput(r),!((l=(a=this.adapter).shouldHideFocusStylesForPointerEvents)===null||l===void 0)&&l.call(a)&&this.handleInputFocus(r),t.preventDefault()},e.prototype.getThumbFromDownEvent=function(t,i){if(!this.isRange)return jt.END;var r=this.adapter.getThumbBoundingClientRect(jt.START),a=this.adapter.getThumbBoundingClientRect(jt.END),l=t>=r.left&&t<=r.right,s=t>=a.left&&t<=a.right;return l&&s?null:l?jt.START:s?jt.END:i<this.valueStart?jt.START:i>this.value?jt.END:i-this.valueStart<=this.value-i?jt.START:jt.END},e.prototype.getThumbFromMoveEvent=function(t){if(this.thumb!==null)return this.thumb;if(this.downEventClientX===null)throw new Error("`downEventClientX` is null after move event.");var i=Math.abs(this.downEventClientX-t)<Uw.THUMB_UPDATE_MIN_PX;if(i)return this.thumb;var r=t<this.downEventClientX;return r?this.adapter.isRTL()?jt.END:jt.START:this.adapter.isRTL()?jt.START:jt.END},e.prototype.updateUI=function(t){t?this.updateThumbAndInputAttributes(t):(this.updateThumbAndInputAttributes(jt.START),this.updateThumbAndInputAttributes(jt.END)),this.updateThumbAndTrackUI(t),this.updateValueIndicatorUI(t),this.updateTickMarksUI()},e.prototype.updateThumbAndInputAttributes=function(t){if(t){var i=this.isRange&&t===jt.START?this.valueStart:this.value,r=String(i);this.adapter.setInputAttribute(Ua.INPUT_VALUE,r,t),this.isRange&&t===jt.START?this.adapter.setInputAttribute(Ua.INPUT_MIN,String(i+this.minRange),jt.END):this.isRange&&t===jt.END&&this.adapter.setInputAttribute(Ua.INPUT_MAX,String(i-this.minRange),jt.START),this.adapter.getInputValue(t)!==r&&this.adapter.setInputValue(r,t);var a=this.adapter.getValueToAriaValueTextFn();a&&this.adapter.setInputAttribute(Ua.ARIA_VALUETEXT,a(i,t),t)}},e.prototype.updateValueIndicatorUI=function(t){if(this.isDiscrete){var i=this.isRange&&t===jt.START?this.valueStart:this.value;this.adapter.setValueIndicatorText(i,t===jt.START?jt.START:jt.END),!t&&this.isRange&&this.adapter.setValueIndicatorText(this.valueStart,jt.START)}},e.prototype.updateTickMarksUI=function(){if(!(!this.isDiscrete||!this.hasTickMarks)){var t=(this.valueStart-this.min)/this.step,i=(this.value-this.valueStart)/this.step+1,r=(this.max-this.value)/this.step,a=Array.from({length:t}).fill(vf.INACTIVE),l=Array.from({length:i}).fill(vf.ACTIVE),s=Array.from({length:r}).fill(vf.INACTIVE);this.adapter.updateTickMarks(a.concat(l).concat(s))}},e.prototype.mapClientXOnSliderScale=function(t){var i=t-this.rect.left,r=i/this.rect.width;this.adapter.isRTL()&&(r=1-r);var a=this.min+r*(this.max-this.min);return a===this.max||a===this.min?a:Number(this.quantize(a).toFixed(this.numDecimalPlaces))},e.prototype.quantize=function(t){var i=Math.round((t-this.min)/this.step);return this.min+i*this.step},e.prototype.updateValue=function(t,i,r){var a=r===void 0?{}:r,l=a.emitInputEvent;if(t=this.clampValue(t,i),this.isRange&&i===jt.START){if(this.valueStart===t)return;this.valueStart=t}else{if(this.value===t)return;this.value=t}this.updateUI(i),l&&this.adapter.emitInputEvent(i===jt.START?this.valueStart:this.value,i)},e.prototype.clampValue=function(t,i){t=Math.min(Math.max(t,this.min),this.max);var r=this.isRange&&i===jt.START&&t>this.value-this.minRange;if(r)return this.value-this.minRange;var a=this.isRange&&i===jt.END&&t<this.valueStart+this.minRange;return a?this.valueStart+this.minRange:t},e.prototype.updateThumbAndTrackUI=function(t){var i=this,r=this,a=r.max,l=r.min,s=(this.value-this.valueStart)/(a-l),d=s*this.rect.width,g=this.adapter.isRTL(),x=Vw?kE(window,"transform"):"transform";if(this.isRange){var I=this.adapter.isRTL()?(a-this.value)/(a-l)*this.rect.width:(this.valueStart-l)/(a-l)*this.rect.width,A=I+d;this.animFrame.request(rI.SLIDER_UPDATE,function(){var L=!g&&t===jt.START||g&&t!==jt.START;L?(i.adapter.setTrackActiveStyleProperty("transform-origin","right"),i.adapter.setTrackActiveStyleProperty("left","auto"),i.adapter.setTrackActiveStyleProperty("right",i.rect.width-A+"px")):(i.adapter.setTrackActiveStyleProperty("transform-origin","left"),i.adapter.setTrackActiveStyleProperty("right","auto"),i.adapter.setTrackActiveStyleProperty("left",I+"px")),i.adapter.setTrackActiveStyleProperty(x,"scaleX("+s+")");var N=g?A:I,B=i.adapter.isRTL()?I:A;(t===jt.START||!t||!i.initialStylesRemoved)&&(i.adapter.setThumbStyleProperty(x,"translateX("+N+"px)",jt.START),i.alignValueIndicator(jt.START,N)),(t===jt.END||!t||!i.initialStylesRemoved)&&(i.adapter.setThumbStyleProperty(x,"translateX("+B+"px)",jt.END),i.alignValueIndicator(jt.END,B)),i.removeInitialStyles(g),i.updateOverlappingThumbsUI(N,B,t)})}else this.animFrame.request(rI.SLIDER_UPDATE,function(){var L=g?i.rect.width-d:d;i.adapter.setThumbStyleProperty(x,"translateX("+L+"px)",jt.END),i.alignValueIndicator(jt.END,L),i.adapter.setTrackActiveStyleProperty(x,"scaleX("+s+")"),i.removeInitialStyles(g)})},e.prototype.alignValueIndicator=function(t,i){if(this.isDiscrete){var r=this.adapter.getThumbBoundingClientRect(t).width/2,a=this.adapter.getValueIndicatorContainerWidth(t),l=this.adapter.getBoundingClientRect().width;a/2>i+r?(this.adapter.setThumbStyleProperty(Al.VAR_VALUE_INDICATOR_CARET_LEFT,r+"px",t),this.adapter.setThumbStyleProperty(Al.VAR_VALUE_INDICATOR_CARET_RIGHT,"auto",t),this.adapter.setThumbStyleProperty(Al.VAR_VALUE_INDICATOR_CARET_TRANSFORM,"translateX(-50%)",t),this.adapter.setThumbStyleProperty(Al.VAR_VALUE_INDICATOR_CONTAINER_LEFT,"0",t),this.adapter.setThumbStyleProperty(Al.VAR_VALUE_INDICATOR_CONTAINER_RIGHT,"auto",t),this.adapter.setThumbStyleProperty(Al.VAR_VALUE_INDICATOR_CONTAINER_TRANSFORM,"none",t)):a/2>l-i+r?(this.adapter.setThumbStyleProperty(Al.VAR_VALUE_INDICATOR_CARET_LEFT,"auto",t),this.adapter.setThumbStyleProperty(Al.VAR_VALUE_INDICATOR_CARET_RIGHT,r+"px",t),this.adapter.setThumbStyleProperty(Al.VAR_VALUE_INDICATOR_CARET_TRANSFORM,"translateX(50%)",t),this.adapter.setThumbStyleProperty(Al.VAR_VALUE_INDICATOR_CONTAINER_LEFT,"auto",t),this.adapter.setThumbStyleProperty(Al.VAR_VALUE_INDICATOR_CONTAINER_RIGHT,"0",t),this.adapter.setThumbStyleProperty(Al.VAR_VALUE_INDICATOR_CONTAINER_TRANSFORM,"none",t)):(this.adapter.setThumbStyleProperty(Al.VAR_VALUE_INDICATOR_CARET_LEFT,"50%",t),this.adapter.setThumbStyleProperty(Al.VAR_VALUE_INDICATOR_CARET_RIGHT,"auto",t),this.adapter.setThumbStyleProperty(Al.VAR_VALUE_INDICATOR_CARET_TRANSFORM,"translateX(-50%)",t),this.adapter.setThumbStyleProperty(Al.VAR_VALUE_INDICATOR_CONTAINER_LEFT,"50%",t),this.adapter.setThumbStyleProperty(Al.VAR_VALUE_INDICATOR_CONTAINER_RIGHT,"auto",t),this.adapter.setThumbStyleProperty(Al.VAR_VALUE_INDICATOR_CONTAINER_TRANSFORM,"translateX(-50%)",t))}},e.prototype.removeInitialStyles=function(t){if(!this.initialStylesRemoved){var i=t?"right":"left";this.adapter.removeThumbStyleProperty(i,jt.END),this.isRange&&this.adapter.removeThumbStyleProperty(i,jt.START),this.initialStylesRemoved=!0,this.resetTrackAndThumbAnimation()}},e.prototype.resetTrackAndThumbAnimation=function(){var t=this;if(this.isDiscrete){var i=Vw?kE(window,"transition"):"transition",r="none 0s ease 0s";this.adapter.setThumbStyleProperty(i,r,jt.END),this.isRange&&this.adapter.setThumbStyleProperty(i,r,jt.START),this.adapter.setTrackActiveStyleProperty(i,r),requestAnimationFrame(function(){t.adapter.removeThumbStyleProperty(i,jt.END),t.adapter.removeTrackActiveStyleProperty(i),t.isRange&&t.adapter.removeThumbStyleProperty(i,jt.START)})}},e.prototype.updateOverlappingThumbsUI=function(t,i,r){var a=!1;if(this.adapter.isRTL()){var l=t-this.startThumbKnobWidth/2,s=i+this.endThumbKnobWidth/2;a=s>=l}else{var d=t+this.startThumbKnobWidth/2,g=i-this.endThumbKnobWidth/2;a=d>=g}a?(this.adapter.addThumbClass(za.THUMB_TOP,r||jt.END),this.adapter.removeThumbClass(za.THUMB_TOP,r===jt.START?jt.END:jt.START)):(this.adapter.removeThumbClass(za.THUMB_TOP,jt.START),this.adapter.removeThumbClass(za.THUMB_TOP,jt.END))},e.prototype.convertAttributeValueToNumber=function(t,i){if(t===null)throw new Error("MDCSliderFoundation: `"+i+"` must be non-null.");var r=Number(t);if(isNaN(r))throw new Error("MDCSliderFoundation: `"+i+"` value is `"+t+"`, but must be a number.");return r},e.prototype.validateProperties=function(t){var i=t.min,r=t.max,a=t.value,l=t.valueStart,s=t.step,d=t.minRange;if(i>=r)throw new Error("MDCSliderFoundation: min must be strictly less than max. "+("Current: [min: "+i+", max: "+r+"]"));if(s<=0)throw new Error("MDCSliderFoundation: step must be a positive number. "+("Current step: "+s));if(this.isRange){if(a<i||a>r||l<i||l>r)throw new Error("MDCSliderFoundation: values must be in [min, max] range. "+("Current values: [start value: "+l+", end value: ")+(a+", min: "+i+", max: "+r+"]"));if(l>a)throw new Error("MDCSliderFoundation: start value must be <= end value. "+("Current values: [start value: "+l+", end value: "+a+"]"));if(d<0)throw new Error("MDCSliderFoundation: minimum range must be non-negative. "+("Current min range: "+d));if(a-l<d)throw new Error("MDCSliderFoundation: start value and end value must differ by at least "+(d+". Current values: [start value: "+l+", ")+("end value: "+a+"]"));var g=(l-i)/s,x=(a-i)/s;if(!Number.isInteger(parseFloat(g.toFixed(6)))||!Number.isInteger(parseFloat(x.toFixed(6))))throw new Error("MDCSliderFoundation: Slider values must be valid based on the "+("step value ("+s+"). Current values: [start value: ")+(l+", end value: "+a+", min: "+i+"]"))}else{if(a<i||a>r)throw new Error("MDCSliderFoundation: value must be in [min, max] range. "+("Current values: [value: "+a+", min: "+i+", max: "+r+"]"));var x=(a-i)/s;if(!Number.isInteger(parseFloat(x.toFixed(6))))throw new Error("MDCSliderFoundation: Slider value must be valid based on the "+("step value ("+s+"). Current value: "+a))}},e.prototype.registerEventHandlers=function(){this.adapter.registerWindowEventHandler("resize",this.resizeListener),e.SUPPORTS_POINTER_EVENTS?(this.adapter.registerEventHandler("pointerdown",this.pointerdownListener),this.adapter.registerEventHandler("pointerup",this.pointerupListener)):(this.adapter.registerEventHandler("mousedown",this.mousedownOrTouchstartListener),this.adapter.registerEventHandler("touchstart",this.mousedownOrTouchstartListener)),this.isRange&&(this.adapter.registerThumbEventHandler(jt.START,"mouseenter",this.thumbMouseenterListener),this.adapter.registerThumbEventHandler(jt.START,"mouseleave",this.thumbMouseleaveListener),this.adapter.registerInputEventHandler(jt.START,"change",this.inputStartChangeListener),this.adapter.registerInputEventHandler(jt.START,"focus",this.inputStartFocusListener),this.adapter.registerInputEventHandler(jt.START,"blur",this.inputStartBlurListener)),this.adapter.registerThumbEventHandler(jt.END,"mouseenter",this.thumbMouseenterListener),this.adapter.registerThumbEventHandler(jt.END,"mouseleave",this.thumbMouseleaveListener),this.adapter.registerInputEventHandler(jt.END,"change",this.inputEndChangeListener),this.adapter.registerInputEventHandler(jt.END,"focus",this.inputEndFocusListener),this.adapter.registerInputEventHandler(jt.END,"blur",this.inputEndBlurListener)},e.prototype.deregisterEventHandlers=function(){this.adapter.deregisterWindowEventHandler("resize",this.resizeListener),e.SUPPORTS_POINTER_EVENTS?(this.adapter.deregisterEventHandler("pointerdown",this.pointerdownListener),this.adapter.deregisterEventHandler("pointerup",this.pointerupListener)):(this.adapter.deregisterEventHandler("mousedown",this.mousedownOrTouchstartListener),this.adapter.deregisterEventHandler("touchstart",this.mousedownOrTouchstartListener)),this.isRange&&(this.adapter.deregisterThumbEventHandler(jt.START,"mouseenter",this.thumbMouseenterListener),this.adapter.deregisterThumbEventHandler(jt.START,"mouseleave",this.thumbMouseleaveListener),this.adapter.deregisterInputEventHandler(jt.START,"change",this.inputStartChangeListener),this.adapter.deregisterInputEventHandler(jt.START,"focus",this.inputStartFocusListener),this.adapter.deregisterInputEventHandler(jt.START,"blur",this.inputStartBlurListener)),this.adapter.deregisterThumbEventHandler(jt.END,"mouseenter",this.thumbMouseenterListener),this.adapter.deregisterThumbEventHandler(jt.END,"mouseleave",this.thumbMouseleaveListener),this.adapter.deregisterInputEventHandler(jt.END,"change",this.inputEndChangeListener),this.adapter.deregisterInputEventHandler(jt.END,"focus",this.inputEndFocusListener),this.adapter.deregisterInputEventHandler(jt.END,"blur",this.inputEndBlurListener)},e.prototype.handlePointerup=function(){this.handleUp(),this.adapter.deregisterEventHandler("pointermove",this.moveListener)},e.SUPPORTS_POINTER_EVENTS=Vw&&!!window.PointerEvent&&!Y6(),e}(xl);function Y6(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function UA(n){var e=/(?:\.(\d+))?(?:[eE]([+\-]?\d+))?$/.exec(String(n));if(!e)return 0;var t=e[1]||"",i=e[2]||0;return Math.max(0,(t==="0"?0:t.length)-Number(i))}function VA(n,e,t){const i=n.slice();return i[92]=e[t],i}function K6(n){let e,t,i,r,a=[{class:t=In({[n[13]]:!0,"mdc-slider__input":!0})},{type:"range"},{disabled:n[5]},{step:n[9]},{min:n[10]},{max:n[11]},n[33],n[24],gi(n[37],"input$")],l={};for(let s=0;s<a.length;s+=1)l=zt(l,a[s]);return{c(){e=qt("input"),this.h()},l(s){e=Wt(s,"INPUT",{class:!0,type:!0,step:!0,min:!0,max:!0}),this.h()},h(){Xn(e,l)},m(s,d){tt(s,e,d),e.autofocus&&e.focus(),n[62](e),eg(e,n[0]),i||(r=[qn(e,"change",n[63]),qn(e,"input",n[63]),qn(e,"blur",n[56]),qn(e,"focus",n[57])],i=!0)},p(s,d){Xn(e,l=hi(a,[d[0]&8192&&t!==(t=In({[s[13]]:!0,"mdc-slider__input":!0}))&&{class:t},{type:"range"},d[0]&32&&{disabled:s[5]},d[0]&512&&{step:s[9]},d[0]&1024&&{min:s[10]},d[0]&2048&&{max:s[11]},s[33],d[0]&16777216&&s[24],d[1]&64&&gi(s[37],"input$")])),d[0]&1&&eg(e,s[0])},d(s){s&&de(e),n[62](null),i=!1,Ss(r)}}}function J6(n){let e,t,i,r,a,l,s,d=[{class:t=In({[n[13]]:!0,"mdc-slider__input":!0})},{type:"range"},{disabled:n[5]},{step:n[9]},{min:n[10]},{max:n[2]},n[25],gi(n[37],"input$")],g={};for(let A=0;A<d.length;A+=1)g=zt(g,d[A]);let x=[{class:a=In({[n[13]]:!0,"mdc-slider__input":!0})},{type:"range"},{disabled:n[5]},{step:n[9]},{min:n[1]},{max:n[11]},n[33],n[24],gi(n[37],"input$")],I={};for(let A=0;A<x.length;A+=1)I=zt(I,x[A]);return{c(){e=qt("input"),i=vn(),r=qt("input"),this.h()},l(A){e=Wt(A,"INPUT",{class:!0,type:!0,step:!0,min:!0,max:!0}),i=bn(A),r=Wt(A,"INPUT",{class:!0,type:!0,step:!0,min:!0,max:!0}),this.h()},h(){Xn(e,g),Xn(r,I)},m(A,L){tt(A,e,L),e.autofocus&&e.focus(),n[58](e),eg(e,n[1]),tt(A,i,L),tt(A,r,L),r.autofocus&&r.focus(),n[60](r),eg(r,n[2]),l||(s=[qn(e,"change",n[59]),qn(e,"input",n[59]),qn(e,"blur",n[54]),qn(e,"focus",n[55]),qn(r,"change",n[61]),qn(r,"input",n[61]),qn(r,"blur",n[52]),qn(r,"focus",n[53])],l=!0)},p(A,L){Xn(e,g=hi(d,[L[0]&8192&&t!==(t=In({[A[13]]:!0,"mdc-slider__input":!0}))&&{class:t},{type:"range"},L[0]&32&&{disabled:A[5]},L[0]&512&&{step:A[9]},L[0]&1024&&{min:A[10]},L[0]&4&&{max:A[2]},L[0]&33554432&&A[25],L[1]&64&&gi(A[37],"input$")])),L[0]&2&&eg(e,A[1]),Xn(r,I=hi(x,[L[0]&8192&&a!==(a=In({[A[13]]:!0,"mdc-slider__input":!0}))&&{class:a},{type:"range"},L[0]&32&&{disabled:A[5]},L[0]&512&&{step:A[9]},L[0]&2&&{min:A[1]},L[0]&2048&&{max:A[11]},A[33],L[0]&16777216&&A[24],L[1]&64&&gi(A[37],"input$")])),L[0]&4&&eg(r,A[2])},d(A){A&&de(e),n[58](null),A&&de(i),A&&de(r),n[60](null),l=!1,Ss(s)}}}function GA(n){let e,t=n[31],i=[];for(let r=0;r<t.length;r+=1)i[r]=HA(VA(n,t,r));return{c(){e=qt("div");for(let r=0;r<i.length;r+=1)i[r].c();this.h()},l(r){e=Wt(r,"DIV",{class:!0});var a=Qt(e);for(let l=0;l<i.length;l+=1)i[l].l(a);a.forEach(de),this.h()},h(){tn(e,"class","mdc-slider__tick-marks")},m(r,a){tt(r,e,a);for(let l=0;l<i.length;l+=1)i[l]&&i[l].m(e,null)},p(r,a){if(a[1]&1){t=r[31];let l;for(l=0;l<t.length;l+=1){const s=VA(r,t,l);i[l]?i[l].p(s,a):(i[l]=HA(s),i[l].c(),i[l].m(e,null))}for(;l<i.length;l+=1)i[l].d(1);i.length=t.length}},d(r){r&&de(e),vm(i,r)}}}function HA(n){let e,t;return{c(){e=qt("div"),this.h()},l(i){e=Wt(i,"DIV",{class:!0}),Qt(e).forEach(de),this.h()},h(){tn(e,"class",t=n[92]===vf.ACTIVE?"mdc-slider__tick-mark--active":"mdc-slider__tick-mark--inactive")},m(i,r){tt(i,e,r)},p(i,r){r[1]&1&&t!==(t=i[92]===vf.ACTIVE?"mdc-slider__tick-mark--active":"mdc-slider__tick-mark--inactive")&&tn(e,"class",t)},d(i){i&&de(e)}}}function Q6(n){let e,t,i,r,a,l,s,d,g=n[7]&&jA(n);return{c(){e=qt("div"),g&&g.c(),t=vn(),i=qt("div"),this.h()},l(x){e=Wt(x,"DIV",{class:!0,style:!0});var I=Qt(e);g&&g.l(I),t=bn(I),i=Wt(I,"DIV",{class:!0}),Qt(i).forEach(de),I.forEach(de),this.h()},h(){tn(i,"class","mdc-slider__thumb-knob"),tn(e,"class",r=In({"mdc-slider__thumb":!0,...n[23]})),tn(e,"style",a=Object.entries(n[27]).map(KA).join(" "))},m(x,I){tt(x,e,I),g&&g.m(e,null),Kt(e,t),Kt(e,i),n[74](i),n[75](e),s||(d=li(l=jc.call(null,e,{unbounded:!0,disabled:n[5],active:n[29],eventTarget:n[15],activeTarget:n[15],addClass:n[76],removeClass:n[77],addStyle:n[78]})),s=!0)},p(x,I){x[7]?g?g.p(x,I):(g=jA(x),g.c(),g.m(e,t)):g&&(g.d(1),g=null),I[0]&8388608&&r!==(r=In({"mdc-slider__thumb":!0,...x[23]}))&&tn(e,"class",r),I[0]&134217728&&a!==(a=Object.entries(x[27]).map(KA).join(" "))&&tn(e,"style",a),l&&Gi(l.update)&&I[0]&536903712&&l.update.call(null,{unbounded:!0,disabled:x[5],active:x[29],eventTarget:x[15],activeTarget:x[15],addClass:x[76],removeClass:x[77],addStyle:x[78]})},d(x){x&&de(e),g&&g.d(),n[74](null),n[75](null),s=!1,d()}}}function $6(n){let e,t,i,r,a,l,s,d,g,x,I,A,L,N,B,F=n[7]&&qA(n),z=n[7]&&WA(n);return{c(){e=qt("div"),F&&F.c(),t=vn(),i=qt("div"),s=vn(),d=qt("div"),z&&z.c(),g=vn(),x=qt("div"),this.h()},l(V){e=Wt(V,"DIV",{class:!0,style:!0});var Y=Qt(e);F&&F.l(Y),t=bn(Y),i=Wt(Y,"DIV",{class:!0}),Qt(i).forEach(de),Y.forEach(de),s=bn(V),d=Wt(V,"DIV",{class:!0,style:!0});var Q=Qt(d);z&&z.l(Q),g=bn(Q),x=Wt(Q,"DIV",{class:!0}),Qt(x).forEach(de),Q.forEach(de),this.h()},h(){tn(i,"class","mdc-slider__thumb-knob"),tn(e,"class",r=In({"mdc-slider__thumb":!0,...n[22]})),tn(e,"style",a=Object.entries(n[28]).map(ZA).join(" ")),tn(x,"class","mdc-slider__thumb-knob"),tn(d,"class",I=In({"mdc-slider__thumb":!0,...n[23]})),tn(d,"style",A=Object.entries(n[27]).map(YA).join(" "))},m(V,Y){tt(V,e,Y),F&&F.m(e,null),Kt(e,t),Kt(e,i),n[64](i),n[65](e),tt(V,s,Y),tt(V,d,Y),z&&z.m(d,null),Kt(d,g),Kt(d,x),n[69](x),n[70](d),N||(B=[li(l=jc.call(null,e,{unbounded:!0,disabled:n[5],active:n[30],eventTarget:n[16],activeTarget:n[16],addClass:n[66],removeClass:n[67],addStyle:n[68]})),li(L=jc.call(null,d,{unbounded:!0,disabled:n[5],active:n[29],eventTarget:n[15],activeTarget:n[15],addClass:n[71],removeClass:n[72],addStyle:n[73]}))],N=!0)},p(V,Y){V[7]?F?F.p(V,Y):(F=qA(V),F.c(),F.m(e,t)):F&&(F.d(1),F=null),Y[0]&4194304&&r!==(r=In({"mdc-slider__thumb":!0,...V[22]}))&&tn(e,"class",r),Y[0]&268435456&&a!==(a=Object.entries(V[28]).map(ZA).join(" "))&&tn(e,"style",a),l&&Gi(l.update)&&Y[0]&1073807392&&l.update.call(null,{unbounded:!0,disabled:V[5],active:V[30],eventTarget:V[16],activeTarget:V[16],addClass:V[66],removeClass:V[67],addStyle:V[68]}),V[7]?z?z.p(V,Y):(z=WA(V),z.c(),z.m(d,g)):z&&(z.d(1),z=null),Y[0]&8388608&&I!==(I=In({"mdc-slider__thumb":!0,...V[23]}))&&tn(d,"class",I),Y[0]&134217728&&A!==(A=Object.entries(V[27]).map(YA).join(" "))&&tn(d,"style",A),L&&Gi(L.update)&&Y[0]&536903712&&L.update.call(null,{unbounded:!0,disabled:V[5],active:V[29],eventTarget:V[15],activeTarget:V[15],addClass:V[71],removeClass:V[72],addStyle:V[73]})},d(V){V&&de(e),F&&F.d(),n[64](null),n[65](null),V&&de(s),V&&de(d),z&&z.d(),n[69](null),n[70](null),N=!1,Ss(B)}}}function jA(n){let e,t,i,r;return{c(){e=qt("div"),t=qt("div"),i=qt("span"),r=_i(n[0]),this.h()},l(a){e=Wt(a,"DIV",{class:!0,"aria-hidden":!0});var l=Qt(e);t=Wt(l,"DIV",{class:!0});var s=Qt(t);i=Wt(s,"SPAN",{class:!0});var d=Qt(i);r=yi(d,n[0]),d.forEach(de),s.forEach(de),l.forEach(de),this.h()},h(){tn(i,"class","mdc-slider__value-indicator-text"),tn(t,"class","mdc-slider__value-indicator"),tn(e,"class","mdc-slider__value-indicator-container"),tn(e,"aria-hidden","true")},m(a,l){tt(a,e,l),Kt(e,t),Kt(t,i),Kt(i,r)},p(a,l){l[0]&1&&ys(r,a[0])},d(a){a&&de(e)}}}function qA(n){let e,t,i,r;return{c(){e=qt("div"),t=qt("div"),i=qt("span"),r=_i(n[1]),this.h()},l(a){e=Wt(a,"DIV",{class:!0,"aria-hidden":!0});var l=Qt(e);t=Wt(l,"DIV",{class:!0});var s=Qt(t);i=Wt(s,"SPAN",{class:!0});var d=Qt(i);r=yi(d,n[1]),d.forEach(de),s.forEach(de),l.forEach(de),this.h()},h(){tn(i,"class","mdc-slider__value-indicator-text"),tn(t,"class","mdc-slider__value-indicator"),tn(e,"class","mdc-slider__value-indicator-container"),tn(e,"aria-hidden","true")},m(a,l){tt(a,e,l),Kt(e,t),Kt(t,i),Kt(i,r)},p(a,l){l[0]&2&&ys(r,a[1])},d(a){a&&de(e)}}}function WA(n){let e,t,i,r;return{c(){e=qt("div"),t=qt("div"),i=qt("span"),r=_i(n[2]),this.h()},l(a){e=Wt(a,"DIV",{class:!0,"aria-hidden":!0});var l=Qt(e);t=Wt(l,"DIV",{class:!0});var s=Qt(t);i=Wt(s,"SPAN",{class:!0});var d=Qt(i);r=yi(d,n[2]),d.forEach(de),s.forEach(de),l.forEach(de),this.h()},h(){tn(i,"class","mdc-slider__value-indicator-text"),tn(t,"class","mdc-slider__value-indicator"),tn(e,"class","mdc-slider__value-indicator-container"),tn(e,"aria-hidden","true")},m(a,l){tt(a,e,l),Kt(e,t),Kt(t,i),Kt(i,r)},p(a,l){l[0]&4&&ys(r,a[2])},d(a){a&&de(e)}}}function eU(n){let e,t,i,r,a,l,s,d,g,x,I,A,L,N;function B(ae,De){return ae[6]?J6:K6}let F=B(n),z=F(n),V=n[7]&&n[8]&&n[9]>0&&GA(n);function Y(ae,De){return ae[6]?$6:Q6}let Q=Y(n),J=Q(n),he=[{class:I=Object.entries({[n[4]]:!0,"mdc-slider":!0,"mdc-slider--range":n[6],"mdc-slider--discrete":n[7],"mdc-slider--tick-marks":n[7]&&n[8],"mdc-slider--disabled":n[5],...n[21]}).filter(JA).map(QA).join(" ")},n[6]?{"data-min-range":`${n[12]}`}:{},jo(n[37],["input$"])],ee={};for(let ae=0;ae<he.length;ae+=1)ee=zt(ee,he[ae]);return{c(){e=qt("div"),z.c(),t=vn(),i=qt("div"),r=qt("div"),a=vn(),l=qt("div"),s=qt("div"),g=vn(),V&&V.c(),x=vn(),J.c(),this.h()},l(ae){e=Wt(ae,"DIV",{class:!0});var De=Qt(e);z.l(De),t=bn(De),i=Wt(De,"DIV",{class:!0});var fe=Qt(i);r=Wt(fe,"DIV",{class:!0}),Qt(r).forEach(de),a=bn(fe),l=Wt(fe,"DIV",{class:!0});var le=Qt(l);s=Wt(le,"DIV",{class:!0,style:!0}),Qt(s).forEach(de),le.forEach(de),g=bn(fe),V&&V.l(fe),fe.forEach(de),x=bn(De),J.l(De),De.forEach(de),this.h()},h(){tn(r,"class","mdc-slider__track--inactive"),tn(s,"class","mdc-slider__track--active_fill"),tn(s,"style",d=Object.entries(n[26]).map(XA).join(" ")),tn(l,"class","mdc-slider__track--active"),tn(i,"class","mdc-slider__track"),Xn(e,ee)},m(ae,De){tt(ae,e,De),z.m(e,null),Kt(e,t),Kt(e,i),Kt(i,r),Kt(i,a),Kt(i,l),Kt(l,s),Kt(i,g),V&&V.m(i,null),Kt(e,x),J.m(e,null),n[79](e),L||(N=[li(A=jr.call(null,e,n[3])),li(n[32].call(null,e))],L=!0)},p(ae,De){F===(F=B(ae))&&z?z.p(ae,De):(z.d(1),z=F(ae),z&&(z.c(),z.m(e,t))),De[0]&67108864&&d!==(d=Object.entries(ae[26]).map(XA).join(" "))&&tn(s,"style",d),ae[7]&&ae[8]&&ae[9]>0?V?V.p(ae,De):(V=GA(ae),V.c(),V.m(i,null)):V&&(V.d(1),V=null),Q===(Q=Y(ae))&&J?J.p(ae,De):(J.d(1),J=Q(ae),J&&(J.c(),J.m(e,null))),Xn(e,ee=hi(he,[De[0]&2097648&&I!==(I=Object.entries({[ae[4]]:!0,"mdc-slider":!0,"mdc-slider--range":ae[6],"mdc-slider--discrete":ae[7],"mdc-slider--tick-marks":ae[7]&&ae[8],"mdc-slider--disabled":ae[5],...ae[21]}).filter(JA).map(QA).join(" "))&&{class:I},De[0]&4160&&(ae[6]?{"data-min-range":`${ae[12]}`}:{}),De[1]&64&&jo(ae[37],["input$"])])),A&&Gi(A.update)&&De[0]&8&&A.update.call(null,ae[3])},i:_l,o:_l,d(ae){ae&&de(e),z.d(),V&&V.d(),J.d(),n[79](null),L=!1,Ss(N)}}}const XA=([n,e])=>`${n}: ${e};`,ZA=([n,e])=>`${n}: ${e};`,YA=([n,e])=>`${n}: ${e};`,KA=([n,e])=>`${n}: ${e};`,JA=([n,e])=>n!==""&&e,QA=([n])=>n;function tU(n,e,t){const i=["use","class","disabled","range","discrete","tickMarks","step","min","max","minRange","value","start","end","valueToAriaValueTextFn","hideFocusStylesForPointerEvents","input$class","layout","getId","getElement"];let r=vi(e,i);var a;const l=ps(ds());let{use:s=[]}=e,{class:d=""}=e,{disabled:g=!1}=e,{range:x=!1}=e,{discrete:I=!1}=e,{tickMarks:A=!1}=e,{step:L=1}=e,{min:N=0}=e,{max:B=100}=e,{minRange:F=0}=e,{value:z=void 0}=e,{start:V=void 0}=e,{end:Y=void 0}=e,{valueToAriaValueTextFn:Q=pe=>`${pe}`}=e,{hideFocusStylesForPointerEvents:J=!1}=e,{input$class:he=""}=e,ee,ae,De,fe,le,Be,Pe,Ce,it={},Et={},Ue={},at={},ke={},Dt={},fn={},Cn={},Gt=!1,Mt=!1,vt,xn=(a=Fr("SMUI:generic:input:props"))!==null&&a!==void 0?a:{},En=Fr("SMUI:addLayoutListener"),_t,kt=N,Ct=B,Bt=L,Zn=I,mi=A;if(A&&L>0){const pe=B+Math.abs(N);if(x&&typeof V=="number"&&typeof Y=="number"){const nt=V+Math.abs(N),be=Y+Math.abs(N);vt=[...Array(nt/L).map(()=>vf.INACTIVE),...Array(pe/L-nt/L-(pe-be)/L+1).map(()=>vf.ACTIVE),...Array((pe-be)/L).map(()=>vf.INACTIVE)]}else if(typeof z=="number"){const nt=z+Math.abs(N);vt=[...Array(nt/L+1).map(()=>vf.ACTIVE),...Array((pe-nt)/L).map(()=>vf.INACTIVE)]}}if(x&&typeof V=="number"&&typeof Y=="number"){const pe=(Y-V)/(B-N),nt=V/(B-N),be=Y/(B-N);Dt.transform=`scaleX(${pe})`,fn.left=`calc(${be*100}% -24px)`,Cn.left=`calc(${nt*100}% -24px)`}else if(typeof z=="number"){const pe=z/(B-N);Dt.transform=`scaleX(${pe})`,fn.left=`calc(${pe*100}% -24px)`}En&&(_t=En(Hs));let yn=z,Pt=V,Yn=Y;ro(()=>{t(43,ae=new Z6({hasClass:si,addClass:Dr,removeClass:Ur,addThumbClass:He,removeThumbClass:Jt,getAttribute:nt=>Rn().getAttribute(nt),getInputValue:nt=>{var be;return`${(be=x?nt===jt.START?V:Y:z)!==null&&be!==void 0?be:0}`},setInputValue:(nt,be)=>{x?be===jt.START?(t(1,V=Number(nt)),t(50,Pt=V)):(t(2,Y=Number(nt)),t(51,Yn=Y)):(t(0,z=Number(nt)),t(49,yn=z))},getInputAttribute:kn,setInputAttribute:Ei,removeInputAttribute:ni,focusInput:nt=>{x&&nt===jt.START&&fe?fe.focus():De.focus()},isInputFocused:nt=>(x&&nt===jt.START?fe:De)===document.activeElement,shouldHideFocusStylesForPointerEvents:()=>J,getThumbKnobWidth:nt=>{var be;return((be=x&&nt===jt.START?Ce:Pe)!==null&&be!==void 0?be:Pe).getBoundingClientRect().width},getThumbBoundingClientRect:nt=>{var be;return((be=x&&nt===jt.START?Be:le)!==null&&be!==void 0?be:le).getBoundingClientRect()},getBoundingClientRect:()=>Rn().getBoundingClientRect(),getValueIndicatorContainerWidth:nt=>{var be;return((be=x&&nt===jt.START?Be:le)!==null&&be!==void 0?be:le).querySelector(".mdc-slider__value-indicator-container").getBoundingClientRect().width},isRTL:()=>getComputedStyle(Rn()).direction==="rtl",setThumbStyleProperty:ui,removeThumbStyleProperty:$e,setTrackActiveStyleProperty:Ln,removeTrackActiveStyleProperty:ki,setValueIndicatorText:(nt,be)=>{},getValueToAriaValueTextFn:()=>Q,updateTickMarks:nt=>{t(31,vt=nt)},setPointerCapture:nt=>{Rn().setPointerCapture(nt)},emitChangeEvent:(nt,be)=>{ji(Rn(),"SMUISlider:change",{value:nt,thumb:be},void 0,!0)},emitInputEvent:(nt,be)=>{ji(Rn(),"SMUISlider:input",{value:nt,thumb:be},void 0,!0)},emitDragStartEvent:(nt,be)=>{x&&be===jt.START?t(30,Mt=!0):t(29,Gt=!0)},emitDragEndEvent:(nt,be)=>{x&&be===jt.START?t(30,Mt=!1):t(29,Gt=!1)},registerEventHandler:(nt,be)=>{Rn().addEventListener(nt,be)},deregisterEventHandler:(nt,be)=>{Rn().removeEventListener(nt,be)},registerThumbEventHandler:(nt,be,Ot)=>{var On;(On=x&&nt===jt.START?Be:le)===null||On===void 0||On.addEventListener(be,Ot)},deregisterThumbEventHandler:(nt,be,Ot)=>{var On;(On=x&&nt===jt.START?Be:le)===null||On===void 0||On.removeEventListener(be,Ot)},registerInputEventHandler:(nt,be,Ot)=>{var On;(On=x&&nt===jt.START?fe:De)===null||On===void 0||On.addEventListener(be,Ot)},deregisterInputEventHandler:(nt,be,Ot)=>{var On;(On=x&&nt===jt.START?fe:De)===null||On===void 0||On.removeEventListener(be,Ot)},registerBodyEventHandler:(nt,be)=>{document.body.addEventListener(nt,be)},deregisterBodyEventHandler:(nt,be)=>{document.body.removeEventListener(nt,be)},registerWindowEventHandler:(nt,be)=>{window.addEventListener(nt,be)},deregisterWindowEventHandler:(nt,be)=>{window.removeEventListener(nt,be)}}));const pe={get element(){return Rn()},activateRipple(){g||t(29,Gt=!0)},deactivateRipple(){t(29,Gt=!1)}};return ji(ee,"SMUIGenericInput:mount",pe),ae.init(),ae.layout({skipUpdateUI:!0}),()=>{ji(ee,"SMUIGenericInput:unmount",pe),ae.destroy()}}),Dh(()=>{_t&&_t()});function si(pe){return pe in it?it[pe]:Rn().classList.contains(pe)}function Dr(pe){it[pe]||t(21,it[pe]=!0,it)}function Ur(pe){(!(pe in it)||it[pe])&&t(21,it[pe]=!1,it)}function He(pe,nt){x&&nt===jt.START?Et[pe]||t(22,Et[pe]=!0,Et):Ue[pe]||t(23,Ue[pe]=!0,Ue)}function Jt(pe,nt){x&&nt===jt.START?(!(pe in Et)||Et[pe])&&t(22,Et[pe]=!1,Et):(!(pe in Ue)||Ue[pe])&&t(23,Ue[pe]=!1,Ue)}function ui(pe,nt,be){x&&be===jt.START?Cn[pe]!=nt&&(nt===""||nt==null?(delete Cn[pe],t(28,Cn)):t(28,Cn[pe]=nt,Cn)):fn[pe]!=nt&&(nt===""||nt==null?(delete fn[pe],t(27,fn)):t(27,fn[pe]=nt,fn))}function $e(pe,nt){x&&nt===jt.START?pe in Cn&&(delete Cn[pe],t(28,Cn)):pe in fn&&(delete fn[pe],t(27,fn))}function kn(pe,nt){var be,Ot,On;return x&&nt===jt.START?pe==="value"?`${V}`:pe in ke?(be=ke[pe])!==null&&be!==void 0?be:null:(Ot=fe==null?void 0:fe.getAttribute(pe))!==null&&Ot!==void 0?Ot:null:pe==="value"?`${x?Y:z}`:pe in at?(On=at[pe])!==null&&On!==void 0?On:null:De.getAttribute(pe)}function Ei(pe,nt,be){x&&be===jt.START?ke[pe]!==nt&&t(25,ke[pe]=nt,ke):at[pe]!==nt&&t(24,at[pe]=nt,at)}function ni(pe,nt){x&&nt===jt.START?(!(pe in ke)||ke[pe]!=null)&&t(25,ke[pe]=void 0,ke):(!(pe in at)||at[pe]!=null)&&t(24,at[pe]=void 0,at)}function Ln(pe,nt){Dt[pe]!=nt&&(nt===""||nt==null?(delete Dt[pe],t(26,Dt)):t(26,Dt[pe]=nt,Dt))}function ki(pe){pe in Dt&&(delete Dt[pe],t(26,Dt))}function Hs(){return ae.layout()}function Xt(){return xn&&xn.id}function Rn(){return ee}function ti(pe){iu.call(this,n,pe)}function tr(pe){iu.call(this,n,pe)}function js(pe){iu.call(this,n,pe)}function mo(pe){iu.call(this,n,pe)}function ca(pe){iu.call(this,n,pe)}function Xo(pe){iu.call(this,n,pe)}function qs(pe){Sn[pe?"unshift":"push"](()=>{fe=pe,t(16,fe)})}function No(){V=bw(this.value),t(1,V)}function Ja(pe){Sn[pe?"unshift":"push"](()=>{De=pe,t(15,De)})}function go(){Y=bw(this.value),t(2,Y)}function Ma(pe){Sn[pe?"unshift":"push"](()=>{De=pe,t(15,De)})}function Vl(){z=bw(this.value),t(0,z)}function Qa(pe){Sn[pe?"unshift":"push"](()=>{Ce=pe,t(20,Ce)})}function ha(pe){Sn[pe?"unshift":"push"](()=>{Be=pe,t(18,Be)})}const $a=pe=>He(pe,jt.START),Zs=pe=>Jt(pe,jt.START),La=(pe,nt)=>ui(pe,nt,jt.START);function so(pe){Sn[pe?"unshift":"push"](()=>{Pe=pe,t(19,Pe)})}function Ra(pe){Sn[pe?"unshift":"push"](()=>{le=pe,t(17,le)})}const we=pe=>He(pe,jt.END),te=pe=>Jt(pe,jt.END),re=(pe,nt)=>ui(pe,nt,jt.END);function Ie(pe){Sn[pe?"unshift":"push"](()=>{Pe=pe,t(19,Pe)})}function Oe(pe){Sn[pe?"unshift":"push"](()=>{le=pe,t(17,le)})}const We=pe=>He(pe,jt.END),ut=pe=>Jt(pe,jt.END),ot=(pe,nt)=>ui(pe,nt,jt.END);function Je(pe){Sn[pe?"unshift":"push"](()=>{ee=pe,t(14,ee)})}return n.$$set=pe=>{e=zt(zt({},e),ls(pe)),t(37,r=vi(e,i)),"use"in pe&&t(3,s=pe.use),"class"in pe&&t(4,d=pe.class),"disabled"in pe&&t(5,g=pe.disabled),"range"in pe&&t(6,x=pe.range),"discrete"in pe&&t(7,I=pe.discrete),"tickMarks"in pe&&t(8,A=pe.tickMarks),"step"in pe&&t(9,L=pe.step),"min"in pe&&t(10,N=pe.min),"max"in pe&&t(11,B=pe.max),"minRange"in pe&&t(12,F=pe.minRange),"value"in pe&&t(0,z=pe.value),"start"in pe&&t(1,V=pe.start),"end"in pe&&t(2,Y=pe.end),"valueToAriaValueTextFn"in pe&&t(38,Q=pe.valueToAriaValueTextFn),"hideFocusStylesForPointerEvents"in pe&&t(39,J=pe.hideFocusStylesForPointerEvents),"input$class"in pe&&t(13,he=pe.input$class)},n.$$.update=()=>{n.$$.dirty[0]&1024|n.$$.dirty[1]&12288&&N!==kt&&(ae&&ae.setMin(N),t(44,kt=N)),n.$$.dirty[0]&2048|n.$$.dirty[1]&20480&&B!==Ct&&(ae&&ae.setMax(B),t(45,Ct=B)),n.$$.dirty[0]&512|n.$$.dirty[1]&36864&&L!==Bt&&(ae&&ae.setStep(L),t(46,Bt=L)),n.$$.dirty[0]&128|n.$$.dirty[1]&69632&&I!==Zn&&(ae&&ae.setIsDiscrete(I),t(47,Zn=I)),n.$$.dirty[0]&256|n.$$.dirty[1]&135168&&A!==mi&&(ae&&ae.setHasTickMarks(A),t(48,mi=A)),n.$$.dirty[0]&7|n.$$.dirty[1]&1839104&&ae&&(yn!==z&&typeof z=="number"&&ae.setValue(z),Pt!==V&&typeof V=="number"&&ae.setValueStart(V),Yn!==Y&&typeof Y=="number"&&ae.setValue(Y),t(49,yn=z),t(50,Pt=V),t(51,Yn=Y),ae.layout())},[z,V,Y,s,d,g,x,I,A,L,N,B,F,he,ee,De,fe,le,Be,Pe,Ce,it,Et,Ue,at,ke,Dt,fn,Cn,Gt,Mt,vt,l,xn,He,Jt,ui,r,Q,J,Hs,Xt,Rn,ae,kt,Ct,Bt,Zn,mi,yn,Pt,Yn,ti,tr,js,mo,ca,Xo,qs,No,Ja,go,Ma,Vl,Qa,ha,$a,Zs,La,so,Ra,we,te,re,Ie,Oe,We,ut,ot,Je]}class QR extends sr{constructor(e){super(),or(this,e,tU,eU,Qi,{use:3,class:4,disabled:5,range:6,discrete:7,tickMarks:8,step:9,min:10,max:11,minRange:12,value:0,start:1,end:2,valueToAriaValueTextFn:38,hideFocusStylesForPointerEvents:39,input$class:13,layout:40,getId:41,getElement:42},null,[-1,-1,-1,-1])}get layout(){return this.$$.ctx[40]}get getId(){return this.$$.ctx[41]}get getElement(){return this.$$.ctx[42]}}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var nU={ANCHOR:"mdc-menu-surface--anchor",ANIMATING_CLOSED:"mdc-menu-surface--animating-closed",ANIMATING_OPEN:"mdc-menu-surface--animating-open",FIXED:"mdc-menu-surface--fixed",IS_OPEN_BELOW:"mdc-menu-surface--is-open-below",OPEN:"mdc-menu-surface--open",ROOT:"mdc-menu-surface"},iU={CLOSED_EVENT:"MDCMenuSurface:closed",CLOSING_EVENT:"MDCMenuSurface:closing",OPENED_EVENT:"MDCMenuSurface:opened",OPENING_EVENT:"MDCMenuSurface:opening",FOCUSABLE_ELEMENTS:["button:not(:disabled)",'[href]:not([aria-disabled="true"])',"input:not(:disabled)","select:not(:disabled)","textarea:not(:disabled)",'[tabindex]:not([tabindex="-1"]):not([aria-disabled="true"])'].join(", ")},S1={TRANSITION_OPEN_DURATION:120,TRANSITION_CLOSE_DURATION:75,MARGIN_TO_EDGE:32,ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO:.67,TOUCH_EVENT_WAIT_MS:30},Ea;(function(n){n[n.BOTTOM=1]="BOTTOM",n[n.CENTER=2]="CENTER",n[n.RIGHT=4]="RIGHT",n[n.FLIP_RTL=8]="FLIP_RTL"})(Ea||(Ea={}));var w_;(function(n){n[n.TOP_LEFT=0]="TOP_LEFT",n[n.TOP_RIGHT=4]="TOP_RIGHT",n[n.BOTTOM_LEFT=1]="BOTTOM_LEFT",n[n.BOTTOM_RIGHT=5]="BOTTOM_RIGHT",n[n.TOP_START=8]="TOP_START",n[n.TOP_END=12]="TOP_END",n[n.BOTTOM_START=9]="BOTTOM_START",n[n.BOTTOM_END=13]="BOTTOM_END"})(w_||(w_={}));/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Jm,im,as={LIST_ITEM_ACTIVATED_CLASS:"mdc-list-item--activated",LIST_ITEM_CLASS:"mdc-list-item",LIST_ITEM_DISABLED_CLASS:"mdc-list-item--disabled",LIST_ITEM_SELECTED_CLASS:"mdc-list-item--selected",LIST_ITEM_TEXT_CLASS:"mdc-list-item__text",LIST_ITEM_PRIMARY_TEXT_CLASS:"mdc-list-item__primary-text",ROOT:"mdc-list"};Jm={},Jm[""+as.LIST_ITEM_ACTIVATED_CLASS]="mdc-list-item--activated",Jm[""+as.LIST_ITEM_CLASS]="mdc-list-item",Jm[""+as.LIST_ITEM_DISABLED_CLASS]="mdc-list-item--disabled",Jm[""+as.LIST_ITEM_SELECTED_CLASS]="mdc-list-item--selected",Jm[""+as.LIST_ITEM_PRIMARY_TEXT_CLASS]="mdc-list-item__primary-text",Jm[""+as.ROOT]="mdc-list";var lv=(im={},im[""+as.LIST_ITEM_ACTIVATED_CLASS]="mdc-deprecated-list-item--activated",im[""+as.LIST_ITEM_CLASS]="mdc-deprecated-list-item",im[""+as.LIST_ITEM_DISABLED_CLASS]="mdc-deprecated-list-item--disabled",im[""+as.LIST_ITEM_SELECTED_CLASS]="mdc-deprecated-list-item--selected",im[""+as.LIST_ITEM_TEXT_CLASS]="mdc-deprecated-list-item__text",im[""+as.LIST_ITEM_PRIMARY_TEXT_CLASS]="mdc-deprecated-list-item__primary-text",im[""+as.ROOT]="mdc-deprecated-list",im),Qm={ACTION_EVENT:"MDCList:action",SELECTION_CHANGE_EVENT:"MDCList:selectionChange",ARIA_CHECKED:"aria-checked",ARIA_CHECKED_CHECKBOX_SELECTOR:'[role="checkbox"][aria-checked="true"]',ARIA_CHECKED_RADIO_SELECTOR:'[role="radio"][aria-checked="true"]',ARIA_CURRENT:"aria-current",ARIA_DISABLED:"aria-disabled",ARIA_ORIENTATION:"aria-orientation",ARIA_ORIENTATION_HORIZONTAL:"horizontal",ARIA_ROLE_CHECKBOX_SELECTOR:'[role="checkbox"]',ARIA_SELECTED:"aria-selected",ARIA_INTERACTIVE_ROLES_SELECTOR:'[role="listbox"], [role="menu"]',ARIA_MULTI_SELECTABLE_SELECTOR:'[aria-multiselectable="true"]',CHECKBOX_RADIO_SELECTOR:'input[type="checkbox"], input[type="radio"]',CHECKBOX_SELECTOR:'input[type="checkbox"]',CHILD_ELEMENTS_TO_TOGGLE_TABINDEX:`
    .`+as.LIST_ITEM_CLASS+` button:not(:disabled),
    .`+as.LIST_ITEM_CLASS+` a,
    .`+lv[as.LIST_ITEM_CLASS]+` button:not(:disabled),
    .`+lv[as.LIST_ITEM_CLASS]+` a
  `,DEPRECATED_SELECTOR:".mdc-deprecated-list",FOCUSABLE_CHILD_ELEMENTS:`
    .`+as.LIST_ITEM_CLASS+` button:not(:disabled),
    .`+as.LIST_ITEM_CLASS+` a,
    .`+as.LIST_ITEM_CLASS+` input[type="radio"]:not(:disabled),
    .`+as.LIST_ITEM_CLASS+` input[type="checkbox"]:not(:disabled),
    .`+lv[as.LIST_ITEM_CLASS]+` button:not(:disabled),
    .`+lv[as.LIST_ITEM_CLASS]+` a,
    .`+lv[as.LIST_ITEM_CLASS]+` input[type="radio"]:not(:disabled),
    .`+lv[as.LIST_ITEM_CLASS]+` input[type="checkbox"]:not(:disabled)
  `,RADIO_SELECTOR:'input[type="radio"]',SELECTED_ITEM_SELECTOR:'[aria-selected="true"], [aria-current="true"]'},xa={UNSET_INDEX:-1,TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS:300};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var rU=["input","button","textarea","select"],mf=function(n){var e=n.target;if(e){var t=(""+e.tagName).toLowerCase();rU.indexOf(t)===-1&&n.preventDefault()}};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function sU(){var n={bufferClearTimeout:0,currentFirstChar:"",sortedIndexCursor:0,typeaheadBuffer:""};return n}function oU(n,e){for(var t=new Map,i=0;i<n;i++){var r=e(i).trim();if(r){var a=r[0].toLowerCase();t.has(a)||t.set(a,[]),t.get(a).push({text:r.toLowerCase(),index:i})}}return t.forEach(function(l){l.sort(function(s,d){return s.index-d.index})}),t}function _S(n,e){var t=n.nextChar,i=n.focusItemAtIndex,r=n.sortedIndexByFirstChar,a=n.focusedItemIndex,l=n.skipFocus,s=n.isItemAtIndexDisabled;clearTimeout(e.bufferClearTimeout),e.bufferClearTimeout=setTimeout(function(){eP(e)},xa.TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS),e.typeaheadBuffer=e.typeaheadBuffer+t;var d;return e.typeaheadBuffer.length===1?d=aU(r,a,s,e):d=lU(r,s,e),d!==-1&&!l&&i(d),d}function aU(n,e,t,i){var r=i.typeaheadBuffer[0],a=n.get(r);if(!a)return-1;if(r===i.currentFirstChar&&a[i.sortedIndexCursor].index===e){i.sortedIndexCursor=(i.sortedIndexCursor+1)%a.length;var l=a[i.sortedIndexCursor].index;if(!t(l))return l}i.currentFirstChar=r;var s=-1,d;for(d=0;d<a.length;d++)if(!t(a[d].index)){s=d;break}for(;d<a.length;d++)if(a[d].index>e&&!t(a[d].index)){s=d;break}return s!==-1?(i.sortedIndexCursor=s,a[i.sortedIndexCursor].index):-1}function lU(n,e,t){var i=t.typeaheadBuffer[0],r=n.get(i);if(!r)return-1;var a=r[t.sortedIndexCursor];if(a.text.lastIndexOf(t.typeaheadBuffer,0)===0&&!e(a.index))return a.index;for(var l=(t.sortedIndexCursor+1)%r.length,s=-1;l!==t.sortedIndexCursor;){var d=r[l],g=d.text.lastIndexOf(t.typeaheadBuffer,0)===0,x=!e(d.index);if(g&&x){s=l;break}l=(l+1)%r.length}return s!==-1?(t.sortedIndexCursor=s,r[t.sortedIndexCursor].index):-1}function $R(n){return n.typeaheadBuffer.length>0}function eP(n){n.typeaheadBuffer=""}function $A(n,e){var t=n.event,i=n.isTargetListItem,r=n.focusedItemIndex,a=n.focusItemAtIndex,l=n.sortedIndexByFirstChar,s=n.isItemAtIndexDisabled,d=Ia(t)==="ArrowLeft",g=Ia(t)==="ArrowUp",x=Ia(t)==="ArrowRight",I=Ia(t)==="ArrowDown",A=Ia(t)==="Home",L=Ia(t)==="End",N=Ia(t)==="Enter",B=Ia(t)==="Spacebar";if(t.altKey||t.ctrlKey||t.metaKey||d||g||x||I||A||L||N)return-1;var F=!B&&t.key.length===1;if(F){mf(t);var z={focusItemAtIndex:a,focusedItemIndex:r,nextChar:t.key.toLowerCase(),sortedIndexByFirstChar:l,skipFocus:!1,isItemAtIndexDisabled:s};return _S(z,e)}if(!B)return-1;i&&mf(t);var V=i&&$R(e);if(V){var z={focusItemAtIndex:a,focusedItemIndex:r,nextChar:" ",sortedIndexByFirstChar:l,skipFocus:!1,isItemAtIndexDisabled:s};return _S(z,e)}return-1}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function uU(n){return n instanceof Array}var cU=["Alt","Control","Meta","Shift"];function eM(n){var e=new Set(n?cU.filter(function(t){return n.getModifierState(t)}):[]);return function(t){return t.every(function(i){return e.has(i)})&&t.length===e.size}}var hU=function(n){Wo(e,n);function e(t){var i=n.call(this,zr(zr({},e.defaultAdapter),t))||this;return i.wrapFocus=!1,i.isVertical=!0,i.isSingleSelectionList=!1,i.areDisabledItemsFocusable=!0,i.selectedIndex=xa.UNSET_INDEX,i.focusedItemIndex=xa.UNSET_INDEX,i.useActivatedClass=!1,i.useSelectedAttr=!1,i.ariaCurrentAttrValue=null,i.isCheckboxList=!1,i.isRadioList=!1,i.lastSelectedIndex=null,i.hasTypeahead=!1,i.typeaheadState=sU(),i.sortedIndexByFirstChar=new Map,i}return Object.defineProperty(e,"strings",{get:function(){return Qm},enumerable:!1,configurable:!0}),Object.defineProperty(e,"cssClasses",{get:function(){return as},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return xa},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClassForElementIndex:function(){},focusItemAtIndex:function(){},getAttributeForElementIndex:function(){return null},getFocusedElementIndex:function(){return 0},getListItemCount:function(){return 0},hasCheckboxAtIndex:function(){return!1},hasRadioAtIndex:function(){return!1},isCheckboxCheckedAtIndex:function(){return!1},isFocusInsideList:function(){return!1},isRootFocused:function(){return!1},listItemAtIndexHasClass:function(){return!1},notifyAction:function(){},notifySelectionChange:function(){},removeClassForElementIndex:function(){},setAttributeForElementIndex:function(){},setCheckedCheckboxOrRadioAtIndex:function(){},setTabIndexForListItemChildren:function(){},getPrimaryTextAtIndex:function(){return""}}},enumerable:!1,configurable:!0}),e.prototype.layout=function(){this.adapter.getListItemCount()!==0&&(this.adapter.hasCheckboxAtIndex(0)?this.isCheckboxList=!0:this.adapter.hasRadioAtIndex(0)?this.isRadioList=!0:this.maybeInitializeSingleSelection(),this.hasTypeahead&&(this.sortedIndexByFirstChar=this.typeaheadInitSortedIndex()))},e.prototype.getFocusedItemIndex=function(){return this.focusedItemIndex},e.prototype.setWrapFocus=function(t){this.wrapFocus=t},e.prototype.setVerticalOrientation=function(t){this.isVertical=t},e.prototype.setSingleSelection=function(t){this.isSingleSelectionList=t,t&&(this.maybeInitializeSingleSelection(),this.selectedIndex=this.getSelectedIndexFromDOM())},e.prototype.setDisabledItemsFocusable=function(t){this.areDisabledItemsFocusable=t},e.prototype.maybeInitializeSingleSelection=function(){var t=this.getSelectedIndexFromDOM();if(t!==xa.UNSET_INDEX){var i=this.adapter.listItemAtIndexHasClass(t,as.LIST_ITEM_ACTIVATED_CLASS);i&&this.setUseActivatedClass(!0),this.isSingleSelectionList=!0,this.selectedIndex=t}},e.prototype.getSelectedIndexFromDOM=function(){for(var t=xa.UNSET_INDEX,i=this.adapter.getListItemCount(),r=0;r<i;r++){var a=this.adapter.listItemAtIndexHasClass(r,as.LIST_ITEM_SELECTED_CLASS),l=this.adapter.listItemAtIndexHasClass(r,as.LIST_ITEM_ACTIVATED_CLASS);if(a||l){t=r;break}}return t},e.prototype.setHasTypeahead=function(t){this.hasTypeahead=t,t&&(this.sortedIndexByFirstChar=this.typeaheadInitSortedIndex())},e.prototype.isTypeaheadInProgress=function(){return this.hasTypeahead&&$R(this.typeaheadState)},e.prototype.setUseActivatedClass=function(t){this.useActivatedClass=t},e.prototype.setUseSelectedAttribute=function(t){this.useSelectedAttr=t},e.prototype.getSelectedIndex=function(){return this.selectedIndex},e.prototype.setSelectedIndex=function(t,i){i===void 0&&(i={}),this.isIndexValid(t)&&(this.isCheckboxList?this.setCheckboxAtIndex(t,i):this.isRadioList?this.setRadioAtIndex(t,i):this.setSingleSelectionAtIndex(t,i))},e.prototype.handleFocusIn=function(t){t>=0&&(this.focusedItemIndex=t,this.adapter.setAttributeForElementIndex(t,"tabindex","0"),this.adapter.setTabIndexForListItemChildren(t,"0"))},e.prototype.handleFocusOut=function(t){var i=this;t>=0&&(this.adapter.setAttributeForElementIndex(t,"tabindex","-1"),this.adapter.setTabIndexForListItemChildren(t,"-1")),setTimeout(function(){i.adapter.isFocusInsideList()||i.setTabindexToFirstSelectedOrFocusedItem()},0)},e.prototype.isIndexDisabled=function(t){return this.adapter.listItemAtIndexHasClass(t,as.LIST_ITEM_DISABLED_CLASS)},e.prototype.handleKeydown=function(t,i,r){var a=this,l,s=Ia(t)==="ArrowLeft",d=Ia(t)==="ArrowUp",g=Ia(t)==="ArrowRight",x=Ia(t)==="ArrowDown",I=Ia(t)==="Home",A=Ia(t)==="End",L=Ia(t)==="Enter",N=Ia(t)==="Spacebar",B=this.isVertical&&x||!this.isVertical&&g,F=this.isVertical&&d||!this.isVertical&&s,z=t.key==="A"||t.key==="a",V=eM(t);if(this.adapter.isRootFocused()){if((F||A)&&V([]))t.preventDefault(),this.focusLastElement();else if((B||I)&&V([]))t.preventDefault(),this.focusFirstElement();else if(F&&V(["Shift"])&&this.isCheckboxList){t.preventDefault();var Y=this.focusLastElement();Y!==-1&&this.setSelectedIndexOnAction(Y,!1)}else if(B&&V(["Shift"])&&this.isCheckboxList){t.preventDefault();var Y=this.focusFirstElement();Y!==-1&&this.setSelectedIndexOnAction(Y,!1)}if(this.hasTypeahead){var Q={event:t,focusItemAtIndex:function(ee){a.focusItemAtIndex(ee)},focusedItemIndex:-1,isTargetListItem:i,sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:function(ee){return a.isIndexDisabled(ee)}};$A(Q,this.typeaheadState)}return}var J=this.adapter.getFocusedElementIndex();if(!(J===-1&&(J=r,J<0))){if(B&&V([]))mf(t),this.focusNextElement(J);else if(F&&V([]))mf(t),this.focusPrevElement(J);else if(B&&V(["Shift"])&&this.isCheckboxList){mf(t);var Y=this.focusNextElement(J);Y!==-1&&this.setSelectedIndexOnAction(Y,!1)}else if(F&&V(["Shift"])&&this.isCheckboxList){mf(t);var Y=this.focusPrevElement(J);Y!==-1&&this.setSelectedIndexOnAction(Y,!1)}else if(I&&V([]))mf(t),this.focusFirstElement();else if(A&&V([]))mf(t),this.focusLastElement();else if(I&&V(["Control","Shift"])&&this.isCheckboxList){if(mf(t),this.isIndexDisabled(J))return;this.focusFirstElement(),this.toggleCheckboxRange(0,J,J)}else if(A&&V(["Control","Shift"])&&this.isCheckboxList){if(mf(t),this.isIndexDisabled(J))return;this.focusLastElement(),this.toggleCheckboxRange(J,this.adapter.getListItemCount()-1,J)}else if(z&&V(["Control"])&&this.isCheckboxList)t.preventDefault(),this.checkboxListToggleAll(this.selectedIndex===xa.UNSET_INDEX?[]:this.selectedIndex,!0);else if((L||N)&&V([])){if(i){var he=t.target;if(he&&he.tagName==="A"&&L||(mf(t),this.isIndexDisabled(J)))return;this.isTypeaheadInProgress()||(this.isSelectableList()&&this.setSelectedIndexOnAction(J,!1),this.adapter.notifyAction(J))}}else if((L||N)&&V(["Shift"])&&this.isCheckboxList){var he=t.target;if(he&&he.tagName==="A"&&L||(mf(t),this.isIndexDisabled(J)))return;this.isTypeaheadInProgress()||(this.toggleCheckboxRange((l=this.lastSelectedIndex)!==null&&l!==void 0?l:J,J,J),this.adapter.notifyAction(J))}if(this.hasTypeahead){var Q={event:t,focusItemAtIndex:function(ae){a.focusItemAtIndex(ae)},focusedItemIndex:this.focusedItemIndex,isTargetListItem:i,sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:function(ae){return a.isIndexDisabled(ae)}};$A(Q,this.typeaheadState)}}},e.prototype.handleClick=function(t,i,r){var a,l=eM(r);t!==xa.UNSET_INDEX&&(this.isIndexDisabled(t)||(l([])?(this.isSelectableList()&&this.setSelectedIndexOnAction(t,i),this.adapter.notifyAction(t)):this.isCheckboxList&&l(["Shift"])&&(this.toggleCheckboxRange((a=this.lastSelectedIndex)!==null&&a!==void 0?a:t,t,t),this.adapter.notifyAction(t))))},e.prototype.focusNextElement=function(t){var i=this.adapter.getListItemCount(),r=t,a=null;do{if(r++,r>=i)if(this.wrapFocus)r=0;else return t;if(r===a)return-1;a=a??r}while(!this.areDisabledItemsFocusable&&this.isIndexDisabled(r));return this.focusItemAtIndex(r),r},e.prototype.focusPrevElement=function(t){var i=this.adapter.getListItemCount(),r=t,a=null;do{if(r--,r<0)if(this.wrapFocus)r=i-1;else return t;if(r===a)return-1;a=a??r}while(!this.areDisabledItemsFocusable&&this.isIndexDisabled(r));return this.focusItemAtIndex(r),r},e.prototype.focusFirstElement=function(){return this.focusNextElement(-1)},e.prototype.focusLastElement=function(){return this.focusPrevElement(this.adapter.getListItemCount())},e.prototype.focusInitialElement=function(){var t=this.getFirstSelectedOrFocusedItemIndex();return this.focusItemAtIndex(t),t},e.prototype.setEnabled=function(t,i){this.isIndexValid(t,!1)&&(i?(this.adapter.removeClassForElementIndex(t,as.LIST_ITEM_DISABLED_CLASS),this.adapter.setAttributeForElementIndex(t,Qm.ARIA_DISABLED,"false")):(this.adapter.addClassForElementIndex(t,as.LIST_ITEM_DISABLED_CLASS),this.adapter.setAttributeForElementIndex(t,Qm.ARIA_DISABLED,"true")))},e.prototype.setSingleSelectionAtIndex=function(t,i){if(i===void 0&&(i={}),!(this.selectedIndex===t&&!i.forceUpdate)){var r=as.LIST_ITEM_SELECTED_CLASS;this.useActivatedClass&&(r=as.LIST_ITEM_ACTIVATED_CLASS),this.selectedIndex!==xa.UNSET_INDEX&&this.adapter.removeClassForElementIndex(this.selectedIndex,r),this.setAriaForSingleSelectionAtIndex(t),this.setTabindexAtIndex(t),t!==xa.UNSET_INDEX&&this.adapter.addClassForElementIndex(t,r),this.selectedIndex=t,i.isUserInteraction&&!i.forceUpdate&&this.adapter.notifySelectionChange([t])}},e.prototype.setAriaForSingleSelectionAtIndex=function(t){this.selectedIndex===xa.UNSET_INDEX&&(this.ariaCurrentAttrValue=this.adapter.getAttributeForElementIndex(t,Qm.ARIA_CURRENT));var i=this.ariaCurrentAttrValue!==null,r=i?Qm.ARIA_CURRENT:Qm.ARIA_SELECTED;if(this.selectedIndex!==xa.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex,r,"false"),t!==xa.UNSET_INDEX){var a=i?this.ariaCurrentAttrValue:"true";this.adapter.setAttributeForElementIndex(t,r,a)}},e.prototype.getSelectionAttribute=function(){return this.useSelectedAttr?Qm.ARIA_SELECTED:Qm.ARIA_CHECKED},e.prototype.setRadioAtIndex=function(t,i){i===void 0&&(i={});var r=this.getSelectionAttribute();this.adapter.setCheckedCheckboxOrRadioAtIndex(t,!0),!(this.selectedIndex===t&&!i.forceUpdate)&&(this.selectedIndex!==xa.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex,r,"false"),this.adapter.setAttributeForElementIndex(t,r,"true"),this.selectedIndex=t,i.isUserInteraction&&!i.forceUpdate&&this.adapter.notifySelectionChange([t]))},e.prototype.setCheckboxAtIndex=function(t,i){i===void 0&&(i={});for(var r=this.selectedIndex,a=i.isUserInteraction?new Set(r===xa.UNSET_INDEX?[]:r):null,l=this.getSelectionAttribute(),s=[],d=0;d<this.adapter.getListItemCount();d++){var g=a==null?void 0:a.has(d),x=t.indexOf(d)>=0;x!==g&&s.push(d),this.adapter.setCheckedCheckboxOrRadioAtIndex(d,x),this.adapter.setAttributeForElementIndex(d,l,x?"true":"false")}this.selectedIndex=t,i.isUserInteraction&&s.length&&this.adapter.notifySelectionChange(s)},e.prototype.toggleCheckboxRange=function(t,i,r){this.lastSelectedIndex=r;for(var a=new Set(this.selectedIndex===xa.UNSET_INDEX?[]:this.selectedIndex),l=!(a!=null&&a.has(r)),s=Xw([t,i].sort(),2),d=s[0],g=s[1],x=this.getSelectionAttribute(),I=[],A=d;A<=g;A++)if(!this.isIndexDisabled(A)){var L=a.has(A);l!==L&&(I.push(A),this.adapter.setCheckedCheckboxOrRadioAtIndex(A,l),this.adapter.setAttributeForElementIndex(A,x,""+l),l?a.add(A):a.delete(A))}I.length&&(this.selectedIndex=QP([],Xw(a)),this.adapter.notifySelectionChange(I))},e.prototype.setTabindexAtIndex=function(t){this.focusedItemIndex===xa.UNSET_INDEX&&t!==0?this.adapter.setAttributeForElementIndex(0,"tabindex","-1"):this.focusedItemIndex>=0&&this.focusedItemIndex!==t&&this.adapter.setAttributeForElementIndex(this.focusedItemIndex,"tabindex","-1"),!(this.selectedIndex instanceof Array)&&this.selectedIndex!==t&&this.adapter.setAttributeForElementIndex(this.selectedIndex,"tabindex","-1"),t!==xa.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(t,"tabindex","0")},e.prototype.isSelectableList=function(){return this.isSingleSelectionList||this.isCheckboxList||this.isRadioList},e.prototype.setTabindexToFirstSelectedOrFocusedItem=function(){var t=this.getFirstSelectedOrFocusedItemIndex();this.setTabindexAtIndex(t)},e.prototype.getFirstSelectedOrFocusedItemIndex=function(){return this.isSelectableList()?typeof this.selectedIndex=="number"&&this.selectedIndex!==xa.UNSET_INDEX?this.selectedIndex:uU(this.selectedIndex)&&this.selectedIndex.length>0?this.selectedIndex.reduce(function(t,i){return Math.min(t,i)}):0:Math.max(this.focusedItemIndex,0)},e.prototype.isIndexValid=function(t,i){var r=this;if(i===void 0&&(i=!0),t instanceof Array){if(!this.isCheckboxList&&i)throw new Error("MDCListFoundation: Array of index is only supported for checkbox based list");return t.length===0?!0:t.some(function(a){return r.isIndexInRange(a)})}else if(typeof t=="number"){if(this.isCheckboxList&&i)throw new Error("MDCListFoundation: Expected array of index for checkbox based list but got number: "+t);return this.isIndexInRange(t)||this.isSingleSelectionList&&t===xa.UNSET_INDEX}else return!1},e.prototype.isIndexInRange=function(t){var i=this.adapter.getListItemCount();return t>=0&&t<i},e.prototype.setSelectedIndexOnAction=function(t,i){this.lastSelectedIndex=t,this.isCheckboxList?(this.toggleCheckboxAtIndex(t,i),this.adapter.notifySelectionChange([t])):this.setSelectedIndex(t,{isUserInteraction:!0})},e.prototype.toggleCheckboxAtIndex=function(t,i){var r=this.getSelectionAttribute(),a=this.adapter.isCheckboxCheckedAtIndex(t),l;i?l=a:(l=!a,this.adapter.setCheckedCheckboxOrRadioAtIndex(t,l)),this.adapter.setAttributeForElementIndex(t,r,l?"true":"false");var s=this.selectedIndex===xa.UNSET_INDEX?[]:this.selectedIndex.slice();l?s.push(t):s=s.filter(function(d){return d!==t}),this.selectedIndex=s},e.prototype.focusItemAtIndex=function(t){this.adapter.focusItemAtIndex(t),this.focusedItemIndex=t},e.prototype.checkboxListToggleAll=function(t,i){var r=this.adapter.getListItemCount();if(t.length===r)this.setCheckboxAtIndex([],{isUserInteraction:i});else{for(var a=[],l=0;l<r;l++)(!this.isIndexDisabled(l)||t.indexOf(l)>-1)&&a.push(l);this.setCheckboxAtIndex(a,{isUserInteraction:i})}},e.prototype.typeaheadMatchItem=function(t,i,r){var a=this;r===void 0&&(r=!1);var l={focusItemAtIndex:function(s){a.focusItemAtIndex(s)},focusedItemIndex:i||this.focusedItemIndex,nextChar:t,sortedIndexByFirstChar:this.sortedIndexByFirstChar,skipFocus:r,isItemAtIndexDisabled:function(s){return a.isIndexDisabled(s)}};return _S(l,this.typeaheadState)},e.prototype.typeaheadInitSortedIndex=function(){return oU(this.adapter.getListItemCount(),this.adapter.getPrimaryTextAtIndex)},e.prototype.clearTypeaheadBuffer=function(){eP(this.typeaheadState)},e}(xl);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var tP=function(n){Wo(e,n);function e(t){var i=n.call(this,zr(zr({},e.defaultAdapter),t))||this;return i.isSurfaceOpen=!1,i.isQuickOpen=!1,i.isHoistedElement=!1,i.isFixedPosition=!1,i.isHorizontallyCenteredOnViewport=!1,i.maxHeight=0,i.openBottomBias=0,i.openAnimationEndTimerId=0,i.closeAnimationEndTimerId=0,i.animationRequestId=0,i.anchorCorner=w_.TOP_START,i.originCorner=w_.TOP_START,i.anchorMargin={top:0,right:0,bottom:0,left:0},i.position={x:0,y:0},i}return Object.defineProperty(e,"cssClasses",{get:function(){return nU},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return iU},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return S1},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Corner",{get:function(){return w_},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},hasAnchor:function(){return!1},isElementInContainer:function(){return!1},isFocused:function(){return!1},isRtl:function(){return!1},getInnerDimensions:function(){return{height:0,width:0}},getAnchorDimensions:function(){return null},getWindowDimensions:function(){return{height:0,width:0}},getBodyDimensions:function(){return{height:0,width:0}},getWindowScroll:function(){return{x:0,y:0}},setPosition:function(){},setMaxHeight:function(){},setTransformOrigin:function(){},saveFocus:function(){},restoreFocus:function(){},notifyClose:function(){},notifyClosing:function(){},notifyOpen:function(){},notifyOpening:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){var t=e.cssClasses,i=t.ROOT,r=t.OPEN;if(!this.adapter.hasClass(i))throw new Error(i+" class required in root element.");this.adapter.hasClass(r)&&(this.isSurfaceOpen=!0)},e.prototype.destroy=function(){clearTimeout(this.openAnimationEndTimerId),clearTimeout(this.closeAnimationEndTimerId),cancelAnimationFrame(this.animationRequestId)},e.prototype.setAnchorCorner=function(t){this.anchorCorner=t},e.prototype.flipCornerHorizontally=function(){this.originCorner=this.originCorner^Ea.RIGHT},e.prototype.setAnchorMargin=function(t){this.anchorMargin.top=t.top||0,this.anchorMargin.right=t.right||0,this.anchorMargin.bottom=t.bottom||0,this.anchorMargin.left=t.left||0},e.prototype.setIsHoisted=function(t){this.isHoistedElement=t},e.prototype.setFixedPosition=function(t){this.isFixedPosition=t},e.prototype.isFixed=function(){return this.isFixedPosition},e.prototype.setAbsolutePosition=function(t,i){this.position.x=this.isFinite(t)?t:0,this.position.y=this.isFinite(i)?i:0},e.prototype.setIsHorizontallyCenteredOnViewport=function(t){this.isHorizontallyCenteredOnViewport=t},e.prototype.setQuickOpen=function(t){this.isQuickOpen=t},e.prototype.setMaxHeight=function(t){this.maxHeight=t},e.prototype.setOpenBottomBias=function(t){this.openBottomBias=t},e.prototype.isOpen=function(){return this.isSurfaceOpen},e.prototype.open=function(){var t=this;this.isSurfaceOpen||(this.adapter.notifyOpening(),this.adapter.saveFocus(),this.isQuickOpen?(this.isSurfaceOpen=!0,this.adapter.addClass(e.cssClasses.OPEN),this.dimensions=this.adapter.getInnerDimensions(),this.autoposition(),this.adapter.notifyOpen()):(this.adapter.addClass(e.cssClasses.ANIMATING_OPEN),this.animationRequestId=requestAnimationFrame(function(){t.dimensions=t.adapter.getInnerDimensions(),t.autoposition(),t.adapter.addClass(e.cssClasses.OPEN),t.openAnimationEndTimerId=setTimeout(function(){t.openAnimationEndTimerId=0,t.adapter.removeClass(e.cssClasses.ANIMATING_OPEN),t.adapter.notifyOpen()},S1.TRANSITION_OPEN_DURATION)}),this.isSurfaceOpen=!0))},e.prototype.close=function(t){var i=this;if(t===void 0&&(t=!1),!!this.isSurfaceOpen){if(this.adapter.notifyClosing(),this.isQuickOpen){this.isSurfaceOpen=!1,t||this.maybeRestoreFocus(),this.adapter.removeClass(e.cssClasses.OPEN),this.adapter.removeClass(e.cssClasses.IS_OPEN_BELOW),this.adapter.notifyClose();return}this.adapter.addClass(e.cssClasses.ANIMATING_CLOSED),requestAnimationFrame(function(){i.adapter.removeClass(e.cssClasses.OPEN),i.adapter.removeClass(e.cssClasses.IS_OPEN_BELOW),i.closeAnimationEndTimerId=setTimeout(function(){i.closeAnimationEndTimerId=0,i.adapter.removeClass(e.cssClasses.ANIMATING_CLOSED),i.adapter.notifyClose()},S1.TRANSITION_CLOSE_DURATION)}),this.isSurfaceOpen=!1,t||this.maybeRestoreFocus()}},e.prototype.handleBodyClick=function(t){var i=t.target;this.adapter.isElementInContainer(i)||this.close()},e.prototype.handleKeydown=function(t){var i=t.keyCode,r=t.key,a=r==="Escape"||i===27;a&&this.close()},e.prototype.autoposition=function(){var t;this.measurements=this.getAutoLayoutmeasurements();var i=this.getoriginCorner(),r=this.getMenuSurfaceMaxHeight(i),a=this.hasBit(i,Ea.BOTTOM)?"bottom":"top",l=this.hasBit(i,Ea.RIGHT)?"right":"left",s=this.getHorizontalOriginOffset(i),d=this.getVerticalOriginOffset(i),g=this.measurements,x=g.anchorSize,I=g.surfaceSize,A=(t={},t[l]=s,t[a]=d,t);x.width/I.width>S1.ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO&&(l="center"),(this.isHoistedElement||this.isFixedPosition)&&this.adjustPositionForHoistedElement(A),this.adapter.setTransformOrigin(l+" "+a),this.adapter.setPosition(A),this.adapter.setMaxHeight(r?r+"px":""),this.hasBit(i,Ea.BOTTOM)||this.adapter.addClass(e.cssClasses.IS_OPEN_BELOW)},e.prototype.getAutoLayoutmeasurements=function(){var t=this.adapter.getAnchorDimensions(),i=this.adapter.getBodyDimensions(),r=this.adapter.getWindowDimensions(),a=this.adapter.getWindowScroll();return t||(t={top:this.position.y,right:this.position.x,bottom:this.position.y,left:this.position.x,width:0,height:0}),{anchorSize:t,bodySize:i,surfaceSize:this.dimensions,viewportDistance:{top:t.top,right:r.width-t.right,bottom:r.height-t.bottom,left:t.left},viewportSize:r,windowScroll:a}},e.prototype.getoriginCorner=function(){var t=this.originCorner,i=this.measurements,r=i.viewportDistance,a=i.anchorSize,l=i.surfaceSize,s=e.numbers.MARGIN_TO_EDGE,d=this.hasBit(this.anchorCorner,Ea.BOTTOM),g,x;d?(g=r.top-s+this.anchorMargin.bottom,x=r.bottom-s-this.anchorMargin.bottom):(g=r.top-s+this.anchorMargin.top,x=r.bottom-s+a.height-this.anchorMargin.top);var I=x-l.height>0;!I&&g>x+this.openBottomBias&&(t=this.setBit(t,Ea.BOTTOM));var A=this.adapter.isRtl(),L=this.hasBit(this.anchorCorner,Ea.FLIP_RTL),N=this.hasBit(this.anchorCorner,Ea.RIGHT)||this.hasBit(t,Ea.RIGHT),B=!1;A&&L?B=!N:B=N;var F,z;B?(F=r.left+a.width+this.anchorMargin.right,z=r.right-this.anchorMargin.right):(F=r.left+this.anchorMargin.left,z=r.right+a.width-this.anchorMargin.left);var V=F-l.width>0,Y=z-l.width>0,Q=this.hasBit(t,Ea.FLIP_RTL)&&this.hasBit(t,Ea.RIGHT);return Y&&Q&&A||!V&&Q?t=this.unsetBit(t,Ea.RIGHT):(V&&B&&A||V&&!B&&N||!Y&&F>=z)&&(t=this.setBit(t,Ea.RIGHT)),t},e.prototype.getMenuSurfaceMaxHeight=function(t){if(this.maxHeight>0)return this.maxHeight;var i=this.measurements.viewportDistance,r=0,a=this.hasBit(t,Ea.BOTTOM),l=this.hasBit(this.anchorCorner,Ea.BOTTOM),s=e.numbers.MARGIN_TO_EDGE;return a?(r=i.top+this.anchorMargin.top-s,l||(r+=this.measurements.anchorSize.height)):(r=i.bottom-this.anchorMargin.bottom+this.measurements.anchorSize.height-s,l&&(r-=this.measurements.anchorSize.height)),r},e.prototype.getHorizontalOriginOffset=function(t){var i=this.measurements.anchorSize,r=this.hasBit(t,Ea.RIGHT),a=this.hasBit(this.anchorCorner,Ea.RIGHT);if(r){var l=a?i.width-this.anchorMargin.left:this.anchorMargin.right;return this.isHoistedElement||this.isFixedPosition?l-(this.measurements.viewportSize.width-this.measurements.bodySize.width):l}return a?i.width-this.anchorMargin.right:this.anchorMargin.left},e.prototype.getVerticalOriginOffset=function(t){var i=this.measurements.anchorSize,r=this.hasBit(t,Ea.BOTTOM),a=this.hasBit(this.anchorCorner,Ea.BOTTOM),l=0;return r?l=a?i.height-this.anchorMargin.top:-this.anchorMargin.bottom:l=a?i.height+this.anchorMargin.bottom:this.anchorMargin.top,l},e.prototype.adjustPositionForHoistedElement=function(t){var i,r,a=this.measurements,l=a.windowScroll,s=a.viewportDistance,d=a.surfaceSize,g=a.viewportSize,x=Object.keys(t);try{for(var I=nu(x),A=I.next();!A.done;A=I.next()){var L=A.value,N=t[L]||0;if(this.isHorizontallyCenteredOnViewport&&(L==="left"||L==="right")){t[L]=(g.width-d.width)/2;continue}N+=s[L],this.isFixedPosition||(L==="top"?N+=l.y:L==="bottom"?N-=l.y:L==="left"?N+=l.x:N-=l.x),t[L]=N}}catch(B){i={error:B}}finally{try{A&&!A.done&&(r=I.return)&&r.call(I)}finally{if(i)throw i.error}}},e.prototype.maybeRestoreFocus=function(){var t=this,i=this.adapter.isFocused(),r=this.adapter.getOwnerDocument?this.adapter.getOwnerDocument():document,a=r.activeElement&&this.adapter.isElementInContainer(r.activeElement);(i||a)&&setTimeout(function(){t.adapter.restoreFocus()},S1.TOUCH_EVENT_WAIT_MS)},e.prototype.hasBit=function(t,i){return!!(t&i)},e.prototype.setBit=function(t,i){return t|i},e.prototype.unsetBit=function(t,i){return t^i},e.prototype.isFinite=function(t){return typeof t=="number"&&isFinite(t)},e}(xl);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Cv={MENU_SELECTED_LIST_ITEM:"mdc-menu-item--selected",MENU_SELECTION_GROUP:"mdc-menu__selection-group",ROOT:"mdc-menu"},uv={ARIA_CHECKED_ATTR:"aria-checked",ARIA_DISABLED_ATTR:"aria-disabled",CHECKBOX_SELECTOR:'input[type="checkbox"]',LIST_SELECTOR:".mdc-list,.mdc-deprecated-list",SELECTED_EVENT:"MDCMenu:selected",SKIP_RESTORE_FOCUS:"data-menu-item-skip-restore-focus"},fU={FOCUS_ROOT_INDEX:-1},vv;(function(n){n[n.NONE=0]="NONE",n[n.LIST_ROOT=1]="LIST_ROOT",n[n.FIRST_ITEM=2]="FIRST_ITEM",n[n.LAST_ITEM=3]="LAST_ITEM"})(vv||(vv={}));/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var dU=function(n){Wo(e,n);function e(t){var i=n.call(this,zr(zr({},e.defaultAdapter),t))||this;return i.closeAnimationEndTimerId=0,i.defaultFocusState=vv.LIST_ROOT,i.selectedIndex=-1,i}return Object.defineProperty(e,"cssClasses",{get:function(){return Cv},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return uv},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return fU},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClassToElementAtIndex:function(){},removeClassFromElementAtIndex:function(){},addAttributeToElementAtIndex:function(){},removeAttributeFromElementAtIndex:function(){},getAttributeFromElementAtIndex:function(){return null},elementContainsClass:function(){return!1},closeSurface:function(){},getElementIndex:function(){return-1},notifySelected:function(){},getMenuItemCount:function(){return 0},focusItemAtIndex:function(){},focusListRoot:function(){},getSelectedSiblingOfItemAtIndex:function(){return-1},isSelectableItemAtIndex:function(){return!1}}},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){this.closeAnimationEndTimerId&&clearTimeout(this.closeAnimationEndTimerId),this.adapter.closeSurface()},e.prototype.handleKeydown=function(t){var i=t.key,r=t.keyCode,a=i==="Tab"||r===9;a&&this.adapter.closeSurface(!0)},e.prototype.handleItemAction=function(t){var i=this,r=this.adapter.getElementIndex(t);if(!(r<0)){this.adapter.notifySelected({index:r});var a=this.adapter.getAttributeFromElementAtIndex(r,uv.SKIP_RESTORE_FOCUS)==="true";this.adapter.closeSurface(a),this.closeAnimationEndTimerId=setTimeout(function(){var l=i.adapter.getElementIndex(t);l>=0&&i.adapter.isSelectableItemAtIndex(l)&&i.setSelectedIndex(l)},tP.numbers.TRANSITION_CLOSE_DURATION)}},e.prototype.handleMenuSurfaceOpened=function(){switch(this.defaultFocusState){case vv.FIRST_ITEM:this.adapter.focusItemAtIndex(0);break;case vv.LAST_ITEM:this.adapter.focusItemAtIndex(this.adapter.getMenuItemCount()-1);break;case vv.NONE:break;default:this.adapter.focusListRoot();break}},e.prototype.setDefaultFocusState=function(t){this.defaultFocusState=t},e.prototype.getSelectedIndex=function(){return this.selectedIndex},e.prototype.setSelectedIndex=function(t){if(this.validatedIndex(t),!this.adapter.isSelectableItemAtIndex(t))throw new Error("MDCMenuFoundation: No selection group at specified index.");var i=this.adapter.getSelectedSiblingOfItemAtIndex(t);i>=0&&(this.adapter.removeAttributeFromElementAtIndex(i,uv.ARIA_CHECKED_ATTR),this.adapter.removeClassFromElementAtIndex(i,Cv.MENU_SELECTED_LIST_ITEM)),this.adapter.addClassToElementAtIndex(t,Cv.MENU_SELECTED_LIST_ITEM),this.adapter.addAttributeToElementAtIndex(t,uv.ARIA_CHECKED_ATTR,"true"),this.selectedIndex=t},e.prototype.setEnabled=function(t,i){this.validatedIndex(t),i?(this.adapter.removeClassFromElementAtIndex(t,as.LIST_ITEM_DISABLED_CLASS),this.adapter.addAttributeToElementAtIndex(t,uv.ARIA_DISABLED_ATTR,"false")):(this.adapter.addClassToElementAtIndex(t,as.LIST_ITEM_DISABLED_CLASS),this.adapter.addAttributeToElementAtIndex(t,uv.ARIA_DISABLED_ATTR,"true"))},e.prototype.validatedIndex=function(t){var i=this.adapter.getMenuItemCount(),r=t>=0&&t<i;if(!r)throw new Error("MDCMenuFoundation: No list item at specified index.")},e}(xl);/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var $o={ACTIVATED:"mdc-select--activated",DISABLED:"mdc-select--disabled",FOCUSED:"mdc-select--focused",INVALID:"mdc-select--invalid",MENU_INVALID:"mdc-select__menu--invalid",OUTLINED:"mdc-select--outlined",REQUIRED:"mdc-select--required",ROOT:"mdc-select",WITH_LEADING_ICON:"mdc-select--with-leading-icon"},Gw={ARIA_CONTROLS:"aria-controls",ARIA_DESCRIBEDBY:"aria-describedby",ARIA_SELECTED_ATTR:"aria-selected",CHANGE_EVENT:"MDCSelect:change",HIDDEN_INPUT_SELECTOR:'input[type="hidden"]',LABEL_SELECTOR:".mdc-floating-label",LEADING_ICON_SELECTOR:".mdc-select__icon",LINE_RIPPLE_SELECTOR:".mdc-line-ripple",MENU_SELECTOR:".mdc-select__menu",OUTLINE_SELECTOR:".mdc-notched-outline",SELECTED_TEXT_SELECTOR:".mdc-select__selected-text",SELECT_ANCHOR_SELECTOR:".mdc-select__anchor",VALUE_ATTR:"data-value"},m_={LABEL_SCALE:.75,UNSET_INDEX:-1,CLICK_DEBOUNCE_TIMEOUT_MS:330};/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var pU=function(n){Wo(e,n);function e(t,i){i===void 0&&(i={});var r=n.call(this,zr(zr({},e.defaultAdapter),t))||this;return r.disabled=!1,r.isMenuOpen=!1,r.useDefaultValidation=!0,r.customValidity=!0,r.lastSelectedIndex=m_.UNSET_INDEX,r.clickDebounceTimeout=0,r.recentlyClicked=!1,r.leadingIcon=i.leadingIcon,r.helperText=i.helperText,r}return Object.defineProperty(e,"cssClasses",{get:function(){return $o},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return m_},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return Gw},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},activateBottomLine:function(){},deactivateBottomLine:function(){},getSelectedIndex:function(){return-1},setSelectedIndex:function(){},hasLabel:function(){return!1},floatLabel:function(){},getLabelWidth:function(){return 0},setLabelRequired:function(){},hasOutline:function(){return!1},notchOutline:function(){},closeOutline:function(){},setRippleCenter:function(){},notifyChange:function(){},setSelectedText:function(){},isSelectAnchorFocused:function(){return!1},getSelectAnchorAttr:function(){return""},setSelectAnchorAttr:function(){},removeSelectAnchorAttr:function(){},addMenuClass:function(){},removeMenuClass:function(){},openMenu:function(){},closeMenu:function(){},getAnchorElement:function(){return null},setMenuAnchorElement:function(){},setMenuAnchorCorner:function(){},setMenuWrapFocus:function(){},focusMenuItemAtIndex:function(){},getMenuItemCount:function(){return 0},getMenuItemValues:function(){return[]},getMenuItemTextAtIndex:function(){return""},isTypeaheadInProgress:function(){return!1},typeaheadMatchItem:function(){return-1}}},enumerable:!1,configurable:!0}),e.prototype.getSelectedIndex=function(){return this.adapter.getSelectedIndex()},e.prototype.setSelectedIndex=function(t,i,r){i===void 0&&(i=!1),r===void 0&&(r=!1),!(t>=this.adapter.getMenuItemCount())&&(t===m_.UNSET_INDEX?this.adapter.setSelectedText(""):this.adapter.setSelectedText(this.adapter.getMenuItemTextAtIndex(t).trim()),this.adapter.setSelectedIndex(t),i&&this.adapter.closeMenu(),!r&&this.lastSelectedIndex!==t&&this.handleChange(),this.lastSelectedIndex=t)},e.prototype.setValue=function(t,i){i===void 0&&(i=!1);var r=this.adapter.getMenuItemValues().indexOf(t);this.setSelectedIndex(r,!1,i)},e.prototype.getValue=function(){var t=this.adapter.getSelectedIndex(),i=this.adapter.getMenuItemValues();return t!==m_.UNSET_INDEX?i[t]:""},e.prototype.getDisabled=function(){return this.disabled},e.prototype.setDisabled=function(t){this.disabled=t,this.disabled?(this.adapter.addClass($o.DISABLED),this.adapter.closeMenu()):this.adapter.removeClass($o.DISABLED),this.leadingIcon&&this.leadingIcon.setDisabled(this.disabled),this.disabled?this.adapter.removeSelectAnchorAttr("tabindex"):this.adapter.setSelectAnchorAttr("tabindex","0"),this.adapter.setSelectAnchorAttr("aria-disabled",this.disabled.toString())},e.prototype.openMenu=function(){this.adapter.addClass($o.ACTIVATED),this.adapter.openMenu(),this.isMenuOpen=!0,this.adapter.setSelectAnchorAttr("aria-expanded","true")},e.prototype.setHelperTextContent=function(t){this.helperText&&this.helperText.setContent(t)},e.prototype.layout=function(){if(this.adapter.hasLabel()){var t=this.getValue().length>0,i=this.adapter.hasClass($o.FOCUSED),r=t||i,a=this.adapter.hasClass($o.REQUIRED);this.notchOutline(r),this.adapter.floatLabel(r),this.adapter.setLabelRequired(a)}},e.prototype.layoutOptions=function(){var t=this.adapter.getMenuItemValues(),i=t.indexOf(this.getValue());this.setSelectedIndex(i,!1,!0)},e.prototype.handleMenuOpened=function(){if(this.adapter.getMenuItemValues().length!==0){var t=this.getSelectedIndex(),i=t>=0?t:0;this.adapter.focusMenuItemAtIndex(i)}},e.prototype.handleMenuClosing=function(){this.adapter.setSelectAnchorAttr("aria-expanded","false")},e.prototype.handleMenuClosed=function(){this.adapter.removeClass($o.ACTIVATED),this.isMenuOpen=!1,this.adapter.isSelectAnchorFocused()||this.blur()},e.prototype.handleChange=function(){this.layout(),this.adapter.notifyChange(this.getValue());var t=this.adapter.hasClass($o.REQUIRED);t&&this.useDefaultValidation&&this.setValid(this.isValid())},e.prototype.handleMenuItemAction=function(t){this.setSelectedIndex(t,!0)},e.prototype.handleFocus=function(){this.adapter.addClass($o.FOCUSED),this.layout(),this.adapter.activateBottomLine()},e.prototype.handleBlur=function(){this.isMenuOpen||this.blur()},e.prototype.handleClick=function(t){if(!(this.disabled||this.recentlyClicked)){if(this.setClickDebounceTimeout(),this.isMenuOpen){this.adapter.closeMenu();return}this.adapter.setRippleCenter(t),this.openMenu()}},e.prototype.handleKeydown=function(t){if(!(this.isMenuOpen||!this.adapter.hasClass($o.FOCUSED))){var i=Ia(t)===Pr.ENTER,r=Ia(t)===Pr.SPACEBAR,a=Ia(t)===Pr.ARROW_UP,l=Ia(t)===Pr.ARROW_DOWN,s=t.ctrlKey||t.metaKey;if(!s&&(!r&&t.key&&t.key.length===1||r&&this.adapter.isTypeaheadInProgress())){var d=r?" ":t.key,g=this.adapter.typeaheadMatchItem(d,this.getSelectedIndex());g>=0&&this.setSelectedIndex(g),t.preventDefault();return}!i&&!r&&!a&&!l||(this.openMenu(),t.preventDefault())}},e.prototype.notchOutline=function(t){if(this.adapter.hasOutline()){var i=this.adapter.hasClass($o.FOCUSED);if(t){var r=m_.LABEL_SCALE,a=this.adapter.getLabelWidth()*r;this.adapter.notchOutline(a)}else i||this.adapter.closeOutline()}},e.prototype.setLeadingIconAriaLabel=function(t){this.leadingIcon&&this.leadingIcon.setAriaLabel(t)},e.prototype.setLeadingIconContent=function(t){this.leadingIcon&&this.leadingIcon.setContent(t)},e.prototype.getUseDefaultValidation=function(){return this.useDefaultValidation},e.prototype.setUseDefaultValidation=function(t){this.useDefaultValidation=t},e.prototype.setValid=function(t){this.useDefaultValidation||(this.customValidity=t),this.adapter.setSelectAnchorAttr("aria-invalid",(!t).toString()),t?(this.adapter.removeClass($o.INVALID),this.adapter.removeMenuClass($o.MENU_INVALID)):(this.adapter.addClass($o.INVALID),this.adapter.addMenuClass($o.MENU_INVALID)),this.syncHelperTextValidity(t)},e.prototype.isValid=function(){return this.useDefaultValidation&&this.adapter.hasClass($o.REQUIRED)&&!this.adapter.hasClass($o.DISABLED)?this.getSelectedIndex()!==m_.UNSET_INDEX&&(this.getSelectedIndex()!==0||!!this.getValue()):this.customValidity},e.prototype.setRequired=function(t){t?this.adapter.addClass($o.REQUIRED):this.adapter.removeClass($o.REQUIRED),this.adapter.setSelectAnchorAttr("aria-required",t.toString()),this.adapter.setLabelRequired(t)},e.prototype.getRequired=function(){return this.adapter.getSelectAnchorAttr("aria-required")==="true"},e.prototype.init=function(){var t=this.adapter.getAnchorElement();t&&(this.adapter.setMenuAnchorElement(t),this.adapter.setMenuAnchorCorner(w_.BOTTOM_START)),this.adapter.setMenuWrapFocus(!1),this.setDisabled(this.adapter.hasClass($o.DISABLED)),this.syncHelperTextValidity(!this.adapter.hasClass($o.INVALID)),this.layout(),this.layoutOptions()},e.prototype.blur=function(){this.adapter.removeClass($o.FOCUSED),this.layout(),this.adapter.deactivateBottomLine();var t=this.adapter.hasClass($o.REQUIRED);t&&this.useDefaultValidation&&this.setValid(this.isValid())},e.prototype.syncHelperTextValidity=function(t){if(this.helperText){this.helperText.setValidity(t);var i=this.helperText.isVisible(),r=this.helperText.getId();i&&r?this.adapter.setSelectAnchorAttr(Gw.ARIA_DESCRIBEDBY,r):this.adapter.removeSelectAnchorAttr(Gw.ARIA_DESCRIBEDBY)}},e.prototype.setClickDebounceTimeout=function(){var t=this;clearTimeout(this.clickDebounceTimeout),this.clickDebounceTimeout=setTimeout(function(){t.recentlyClicked=!1},m_.CLICK_DEBOUNCE_TIMEOUT_MS),this.recentlyClicked=!0},e}(xl);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var g_={ARIA_HIDDEN:"aria-hidden",ROLE:"role"},rm={HELPER_TEXT_VALIDATION_MSG:"mdc-select-helper-text--validation-msg",HELPER_TEXT_VALIDATION_MSG_PERSISTENT:"mdc-select-helper-text--validation-msg-persistent"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var mU=function(n){Wo(e,n);function e(t){return n.call(this,zr(zr({},e.defaultAdapter),t))||this}return Object.defineProperty(e,"cssClasses",{get:function(){return rm},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return g_},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setAttr:function(){},getAttr:function(){return null},removeAttr:function(){},setContent:function(){}}},enumerable:!1,configurable:!0}),e.prototype.getId=function(){return this.adapter.getAttr("id")},e.prototype.isVisible=function(){return this.adapter.getAttr(g_.ARIA_HIDDEN)!=="true"},e.prototype.setContent=function(t){this.adapter.setContent(t)},e.prototype.setValidation=function(t){t?this.adapter.addClass(rm.HELPER_TEXT_VALIDATION_MSG):this.adapter.removeClass(rm.HELPER_TEXT_VALIDATION_MSG)},e.prototype.setValidationMsgPersistent=function(t){t?this.adapter.addClass(rm.HELPER_TEXT_VALIDATION_MSG_PERSISTENT):this.adapter.removeClass(rm.HELPER_TEXT_VALIDATION_MSG_PERSISTENT)},e.prototype.getIsValidation=function(){return this.adapter.hasClass(rm.HELPER_TEXT_VALIDATION_MSG)},e.prototype.getIsValidationMsgPersistent=function(){return this.adapter.hasClass(rm.HELPER_TEXT_VALIDATION_MSG_PERSISTENT)},e.prototype.setValidity=function(t){var i=this.adapter.hasClass(rm.HELPER_TEXT_VALIDATION_MSG);if(i){var r=this.adapter.hasClass(rm.HELPER_TEXT_VALIDATION_MSG_PERSISTENT),a=!t||r;if(a){this.showToScreenReader(),t?this.adapter.removeAttr(g_.ROLE):this.adapter.setAttr(g_.ROLE,"alert");return}this.adapter.removeAttr(g_.ROLE),this.hide()}},e.prototype.showToScreenReader=function(){this.adapter.removeAttr(g_.ARIA_HIDDEN)},e.prototype.hide=function(){this.adapter.setAttr(g_.ARIA_HIDDEN,"true")},e}(xl);const{document:gU}=uL;function _U(n){let e,t,i,r,a,l,s,d;const g=n[34].default,x=Ri(g,n,n[33],null);let I=[{class:i=In({[n[1]]:!0,"mdc-menu-surface":!0,"mdc-menu-surface--fixed":n[4],"mdc-menu-surface--open":n[3],"smui-menu-surface--static":n[3],"mdc-menu-surface--fullwidth":n[5],...n[8]})},{style:r=Object.entries(n[9]).map(tM).concat([n[2]]).join(" ")},n[12]],A={};for(let L=0;L<I.length;L+=1)A=zt(A,I[L]);return{c(){e=vn(),t=qt("div"),x&&x.c(),this.h()},l(L){e=bn(L),t=Wt(L,"DIV",{class:!0,style:!0});var N=Qt(t);x&&x.l(N),N.forEach(de),this.h()},h(){Xn(t,A)},m(L,N){tt(L,e,N),tt(L,t,N),x&&x.m(t,null),n[35](t),l=!0,s||(d=[qn(gU.body,"click",n[11],!0),li(a=jr.call(null,t,n[0])),li(n[10].call(null,t)),qn(t,"keydown",function(){Gi(n[7]&&n[7].handleKeydown.bind(n[7]))&&(n[7]&&n[7].handleKeydown.bind(n[7])).apply(this,arguments)})],s=!0)},p(L,N){n=L,x&&x.p&&(!l||N[1]&4)&&Pi(x,g,n,n[33],l?Oi(g,n[33],N,null):Di(n[33]),null),Xn(t,A=hi(I,[(!l||N[0]&314&&i!==(i=In({[n[1]]:!0,"mdc-menu-surface":!0,"mdc-menu-surface--fixed":n[4],"mdc-menu-surface--open":n[3],"smui-menu-surface--static":n[3],"mdc-menu-surface--fullwidth":n[5],...n[8]})))&&{class:i},(!l||N[0]&516&&r!==(r=Object.entries(n[9]).map(tM).concat([n[2]]).join(" ")))&&{style:r},N[0]&4096&&n[12]])),a&&Gi(a.update)&&N[0]&1&&a.update.call(null,n[0])},i(L){l||(Te(x,L),l=!0)},o(L){Ne(x,L),l=!1},d(L){L&&de(e),L&&de(t),x&&x.d(L),n[35](null),s=!1,Ss(d)}}}const tM=([n,e])=>`${n}: ${e};`;function yU(n,e,t){const i=["use","class","style","static","anchor","fixed","open","managed","fullWidth","quickOpen","anchorElement","anchorCorner","anchorMargin","maxHeight","horizontallyCenteredOnViewport","openBottomBias","neverRestoreFocus","isOpen","setOpen","setAbsolutePosition","setIsHoisted","isFixed","getElement"];let r=vi(e,i),{$$slots:a={},$$scope:l}=e;var s,d,g;const x=ps(ds());let{use:I=[]}=e,{class:A=""}=e,{style:L=""}=e,{static:N=!1}=e,{anchor:B=!0}=e,{fixed:F=!1}=e,{open:z=N}=e,{managed:V=!1}=e,{fullWidth:Y=!1}=e,{quickOpen:Q=!1}=e,{anchorElement:J=void 0}=e,{anchorCorner:he=void 0}=e,{anchorMargin:ee={top:0,right:0,bottom:0,left:0}}=e,{maxHeight:ae=0}=e,{horizontallyCenteredOnViewport:De=!1}=e,{openBottomBias:fe=0}=e,{neverRestoreFocus:le=!1}=e,Be,Pe,Ce={},it={},Et;lr("SMUI:list:role","menu"),lr("SMUI:list:item:role","menuitem");const Ue=w_;ro(()=>(t(7,Pe=new tP({addClass:ke,removeClass:Dt,hasClass:at,hasAnchor:()=>!!J,notifyClose:()=>{V||t(13,z=N),z||ji(Be,"SMUIMenuSurface:closed",void 0,void 0,!0)},notifyClosing:()=>{V||t(13,z=N),z||ji(Be,"SMUIMenuSurface:closing",void 0,void 0,!0)},notifyOpen:()=>{V||t(13,z=!0),z&&ji(Be,"SMUIMenuSurface:opened",void 0,void 0,!0)},notifyOpening:()=>{z||ji(Be,"SMUIMenuSurface:opening",void 0,void 0,!0)},isElementInContainer:Bt=>Be.contains(Bt),isRtl:()=>getComputedStyle(Be).getPropertyValue("direction")==="rtl",setTransformOrigin:Bt=>{t(9,it["transform-origin"]=Bt,it)},isFocused:()=>document.activeElement===Be,saveFocus:()=>{var Bt;Et=(Bt=document.activeElement)!==null&&Bt!==void 0?Bt:void 0},restoreFocus:()=>{!le&&(!Be||Be.contains(document.activeElement))&&Et&&document.contains(Et)&&"focus"in Et&&Et.focus()},getInnerDimensions:()=>({width:Be.offsetWidth,height:Be.offsetHeight}),getAnchorDimensions:()=>J?J.getBoundingClientRect():null,getWindowDimensions:()=>({width:window.innerWidth,height:window.innerHeight}),getBodyDimensions:()=>({width:document.body.clientWidth,height:document.body.clientHeight}),getWindowScroll:()=>({x:window.pageXOffset,y:window.pageYOffset}),setPosition:Bt=>{t(9,it.left="left"in Bt?`${Bt.left}px`:"",it),t(9,it.right="right"in Bt?`${Bt.right}px`:"",it),t(9,it.top="top"in Bt?`${Bt.top}px`:"",it),t(9,it.bottom="bottom"in Bt?`${Bt.bottom}px`:"",it)},setMaxHeight:Bt=>{t(9,it["max-height"]=Bt,it)}})),ji(Be,"SMUIMenuSurface:mount",{get open(){return z},set open(Bt){t(13,z=Bt)},closeProgrammatic:fn}),Pe.init(),()=>{var Bt;const Zn=Pe.isHoistedElement;Pe.destroy(),Zn&&((Bt=Be.parentNode)===null||Bt===void 0||Bt.removeChild(Be))})),Dh(()=>{var Ct;B&&Be&&((Ct=Be.parentElement)===null||Ct===void 0||Ct.classList.remove("mdc-menu-surface--anchor"))});function at(Ct){return Ct in Ce?Ce[Ct]:_t().classList.contains(Ct)}function ke(Ct){Ce[Ct]||t(8,Ce[Ct]=!0,Ce)}function Dt(Ct){(!(Ct in Ce)||Ce[Ct])&&t(8,Ce[Ct]=!1,Ce)}function fn(Ct){Pe.close(Ct),t(13,z=!1)}function Cn(Ct){Pe&&z&&!V&&Pe.handleBodyClick(Ct)}function Gt(){return z}function Mt(Ct){t(13,z=Ct)}function vt(Ct,Bt){return Pe.setAbsolutePosition(Ct,Bt)}function xn(Ct){return Pe.setIsHoisted(Ct)}function En(){return Pe.isFixed()}function _t(){return Be}function kt(Ct){Sn[Ct?"unshift":"push"](()=>{Be=Ct,t(6,Be)})}return n.$$set=Ct=>{e=zt(zt({},e),ls(Ct)),t(12,r=vi(e,i)),"use"in Ct&&t(0,I=Ct.use),"class"in Ct&&t(1,A=Ct.class),"style"in Ct&&t(2,L=Ct.style),"static"in Ct&&t(3,N=Ct.static),"anchor"in Ct&&t(15,B=Ct.anchor),"fixed"in Ct&&t(4,F=Ct.fixed),"open"in Ct&&t(13,z=Ct.open),"managed"in Ct&&t(16,V=Ct.managed),"fullWidth"in Ct&&t(5,Y=Ct.fullWidth),"quickOpen"in Ct&&t(17,Q=Ct.quickOpen),"anchorElement"in Ct&&t(14,J=Ct.anchorElement),"anchorCorner"in Ct&&t(18,he=Ct.anchorCorner),"anchorMargin"in Ct&&t(19,ee=Ct.anchorMargin),"maxHeight"in Ct&&t(20,ae=Ct.maxHeight),"horizontallyCenteredOnViewport"in Ct&&t(21,De=Ct.horizontallyCenteredOnViewport),"openBottomBias"in Ct&&t(22,fe=Ct.openBottomBias),"neverRestoreFocus"in Ct&&t(23,le=Ct.neverRestoreFocus),"$$scope"in Ct&&t(33,l=Ct.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&1073774656|n.$$.dirty[1]&3&&Be&&B&&!(!(t(30,s=Be.parentElement)===null||s===void 0)&&s.classList.contains("mdc-menu-surface--anchor"))&&(t(31,d=Be.parentElement)===null||d===void 0||d.classList.add("mdc-menu-surface--anchor"),t(14,J=t(32,g=Be.parentElement)!==null&&g!==void 0?g:void 0)),n.$$.dirty[0]&8320&&Pe&&Pe.isOpen()!==z&&(z?Pe.open():Pe.close()),n.$$.dirty[0]&131200&&Pe&&Pe.setQuickOpen(Q),n.$$.dirty[0]&144&&Pe&&Pe.setFixedPosition(F),n.$$.dirty[0]&1048704&&Pe&&Pe.setMaxHeight(ae),n.$$.dirty[0]&2097280&&Pe&&Pe.setIsHorizontallyCenteredOnViewport(De),n.$$.dirty[0]&262272&&Pe&&he!=null&&(typeof he=="string"?Pe.setAnchorCorner(Ue[he]):Pe.setAnchorCorner(he)),n.$$.dirty[0]&524416&&Pe&&Pe.setAnchorMargin(ee),n.$$.dirty[0]&4194432&&Pe&&Pe.setOpenBottomBias(fe)},[I,A,L,N,F,Y,Be,Pe,Ce,it,x,Cn,r,z,J,B,V,Q,he,ee,ae,De,fe,le,Gt,Mt,vt,xn,En,_t,s,d,g,l,a,kt]}class vU extends sr{constructor(e){super(),or(this,e,yU,_U,Qi,{use:0,class:1,style:2,static:3,anchor:15,fixed:4,open:13,managed:16,fullWidth:5,quickOpen:17,anchorElement:14,anchorCorner:18,anchorMargin:19,maxHeight:20,horizontallyCenteredOnViewport:21,openBottomBias:22,neverRestoreFocus:23,isOpen:24,setOpen:25,setAbsolutePosition:26,setIsHoisted:27,isFixed:28,getElement:29},null,[-1,-1])}get isOpen(){return this.$$.ctx[24]}get setOpen(){return this.$$.ctx[25]}get setAbsolutePosition(){return this.$$.ctx[26]}get setIsHoisted(){return this.$$.ctx[27]}get isFixed(){return this.$$.ctx[28]}get getElement(){return this.$$.ctx[29]}}function bU(n,{addClass:e=i=>n.classList.add(i),removeClass:t=i=>n.classList.remove(i)}={}){return e("mdc-menu-surface--anchor"),{destroy(){t("mdc-menu-surface--anchor")}}}function xU(n){let e;const t=n[17].default,i=Ri(t,n,n[22],null);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a&4194304)&&Pi(i,t,r,r[22],e?Oi(t,r[22],a,null):Di(r[22]),null)},i(r){e||(Te(i,r),e=!0)},o(r){Ne(i,r),e=!1},d(r){i&&i.d(r)}}}function EU(n){let e,t,i;const r=[{use:n[5]},{class:In({[n[1]]:!0,"mdc-menu":!0})},n[9]];function a(s){n[19](s)}let l={$$slots:{default:[xU]},$$scope:{ctx:n}};for(let s=0;s<r.length;s+=1)l=zt(l,r[s]);return n[0]!==void 0&&(l.open=n[0]),e=new vU({props:l}),n[18](e),Sn.push(()=>Xr(e,"open",a)),e.$on("SMUIMenuSurface:mount",n[7]),e.$on("SMUIList:mount",n[8]),e.$on("SMUIMenuSurface:opened",n[20]),e.$on("keydown",n[6]),e.$on("SMUIList:action",n[21]),{c(){sn(e.$$.fragment)},l(s){dn(e.$$.fragment,s)},m(s,d){on(e,s,d),i=!0},p(s,[d]){const g=d&546?hi(r,[d&32&&{use:s[5]},d&2&&{class:In({[s[1]]:!0,"mdc-menu":!0})},d&512&&Mr(s[9])]):{};d&4194304&&(g.$$scope={dirty:d,ctx:s}),!t&&d&1&&(t=!0,g.open=s[0],Qr(()=>t=!1)),e.$set(g)},i(s){i||(Te(e.$$.fragment,s),i=!0)},o(s){Ne(e.$$.fragment,s),i=!1},d(s){n[18](null),an(e,s)}}}function IU(n,e,t){let i;const r=["use","class","open","isOpen","setOpen","setDefaultFocusState","getSelectedIndex","getMenuSurface","getElement"];let a=vi(e,r),{$$slots:l={},$$scope:s}=e;const{closest:d}=r0,g=ps(ds());let{use:x=[]}=e,{class:I=""}=e,{open:A=!1}=e,L,N,B,F;ro(()=>(t(3,N=new dU({addClassToElementAtIndex:(Ce,it)=>{F.addClassForElementIndex(Ce,it)},removeClassFromElementAtIndex:(Ce,it)=>{F.removeClassForElementIndex(Ce,it)},addAttributeToElementAtIndex:(Ce,it,Et)=>{F.setAttributeForElementIndex(Ce,it,Et)},removeAttributeFromElementAtIndex:(Ce,it)=>{F.removeAttributeForElementIndex(Ce,it)},getAttributeFromElementAtIndex:(Ce,it)=>F.getAttributeFromElementIndex(Ce,it),elementContainsClass:(Ce,it)=>Ce.classList.contains(it),closeSurface:Ce=>{B.closeProgrammatic(Ce),ji(De(),"SMUIMenu:closedProgrammatically")},getElementIndex:Ce=>F.getOrderedList().map(it=>it.element).indexOf(Ce),notifySelected:Ce=>ji(De(),"SMUIMenu:selected",{index:Ce.index,item:F.getOrderedList()[Ce.index].element},void 0,!0),getMenuItemCount:()=>F.items.length,focusItemAtIndex:Ce=>F.focusItemAtIndex(Ce),focusListRoot:()=>"focus"in F.element&&F.element.focus(),isSelectableItemAtIndex:Ce=>!!d(F.getOrderedList()[Ce].element,`.${Cv.MENU_SELECTION_GROUP}`),getSelectedSiblingOfItemAtIndex:Ce=>{const it=F.getOrderedList(),Et=d(it[Ce].element,`.${Cv.MENU_SELECTION_GROUP}`),Ue=Et==null?void 0:Et.querySelector(`.${Cv.MENU_SELECTED_LIST_ITEM}`);return Ue?it.map(at=>at.element).indexOf(Ue):-1}})),ji(De(),"SMUIMenu:mount",N),N.init(),()=>{N.destroy()}));function z(Ce){N&&N.handleKeydown(Ce)}function V(Ce){B||(B=Ce.detail)}function Y(Ce){F||t(4,F=Ce.detail)}function Q(){return A}function J(Ce){t(0,A=Ce)}function he(Ce){N.setDefaultFocusState(Ce)}function ee(){return N.getSelectedIndex()}function ae(){return L}function De(){return L.getElement()}function fe(Ce){Sn[Ce?"unshift":"push"](()=>{L=Ce,t(2,L)})}function le(Ce){A=Ce,t(0,A)}const Be=()=>N&&N.handleMenuSurfaceOpened(),Pe=Ce=>N&&N.handleItemAction(F.getOrderedList()[Ce.detail.index].element);return n.$$set=Ce=>{e=zt(zt({},e),ls(Ce)),t(9,a=vi(e,r)),"use"in Ce&&t(10,x=Ce.use),"class"in Ce&&t(1,I=Ce.class),"open"in Ce&&t(0,A=Ce.open),"$$scope"in Ce&&t(22,s=Ce.$$scope)},n.$$.update=()=>{n.$$.dirty&1024&&t(5,i=[g,...x])},[A,I,L,N,F,i,z,V,Y,a,x,Q,J,he,ee,ae,De,l,fe,le,Be,Pe,s]}class TU extends sr{constructor(e){super(),or(this,e,IU,EU,Qi,{use:10,class:1,open:0,isOpen:11,setOpen:12,setDefaultFocusState:13,getSelectedIndex:14,getMenuSurface:15,getElement:16})}get isOpen(){return this.$$.ctx[11]}get setOpen(){return this.$$.ctx[12]}get setDefaultFocusState(){return this.$$.ctx[13]}get getSelectedIndex(){return this.$$.ctx[14]}get getMenuSurface(){return this.$$.ctx[15]}get getElement(){return this.$$.ctx[16]}}function wU(n){let e;const t=n[42].default,i=Ri(t,n,n[44],null);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a[1]&8192)&&Pi(i,t,r,r[44],e?Oi(t,r[44],a,null):Di(r[44]),null)},i(r){e||(Te(i,r),e=!0)},o(r){Ne(i,r),e=!1},d(r){i&&i.d(r)}}}function SU(n){let e,t,i;const r=[{tag:n[13]},{use:[n[16],...n[0]]},{class:In({[n[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":n[2],"mdc-deprecated-list--dense":n[3],"mdc-deprecated-list--textual-list":n[4],"mdc-deprecated-list--avatar-list":n[5]||n[17],"mdc-deprecated-list--icon-list":n[6],"mdc-deprecated-list--image-list":n[7],"mdc-deprecated-list--thumbnail-list":n[8],"mdc-deprecated-list--video-list":n[9],"mdc-deprecated-list--two-line":n[10],"smui-list--three-line":n[11]&&!n[10]})},{role:n[15]},n[25]];var a=n[12];function l(s){let d={$$slots:{default:[wU]},$$scope:{ctx:s}};for(let g=0;g<r.length;g+=1)d=zt(d,r[g]);return{props:d}}return a&&(e=Xa(a,l(n)),n[43](e),e.$on("keydown",n[20]),e.$on("focusin",n[21]),e.$on("focusout",n[22]),e.$on("click",n[23]),e.$on("SMUIListItem:mount",n[18]),e.$on("SMUIListItem:unmount",n[19]),e.$on("SMUI:action",n[24])),{c(){e&&sn(e.$$.fragment),t=pi()},l(s){e&&dn(e.$$.fragment,s),t=pi()},m(s,d){e&&on(e,s,d),tt(s,t,d),i=!0},p(s,d){const g=d[0]&33796095?hi(r,[d[0]&8192&&{tag:s[13]},d[0]&65537&&{use:[s[16],...s[0]]},d[0]&135166&&{class:In({[s[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":s[2],"mdc-deprecated-list--dense":s[3],"mdc-deprecated-list--textual-list":s[4],"mdc-deprecated-list--avatar-list":s[5]||s[17],"mdc-deprecated-list--icon-list":s[6],"mdc-deprecated-list--image-list":s[7],"mdc-deprecated-list--thumbnail-list":s[8],"mdc-deprecated-list--video-list":s[9],"mdc-deprecated-list--two-line":s[10],"smui-list--three-line":s[11]&&!s[10]})},d[0]&32768&&{role:s[15]},d[0]&33554432&&Mr(s[25])]):{};if(d[1]&8192&&(g.$$scope={dirty:d,ctx:s}),d[0]&4096&&a!==(a=s[12])){if(e){Wi();const x=e;Ne(x.$$.fragment,1,0,()=>{an(x,1)}),Xi()}a?(e=Xa(a,l(s)),s[43](e),e.$on("keydown",s[20]),e.$on("focusin",s[21]),e.$on("focusout",s[22]),e.$on("click",s[23]),e.$on("SMUIListItem:mount",s[18]),e.$on("SMUIListItem:unmount",s[19]),e.$on("SMUI:action",s[24]),sn(e.$$.fragment),Te(e.$$.fragment,1),on(e,t.parentNode,t)):e=null}else a&&e.$set(g)},i(s){i||(e&&Te(e.$$.fragment,s),i=!0)},o(s){e&&Ne(e.$$.fragment,s),i=!1},d(s){n[43](null),s&&de(t),e&&an(e,s)}}}function CU(n,e,t){const i=["use","class","nonInteractive","dense","textualList","avatarList","iconList","imageList","thumbnailList","videoList","twoLine","threeLine","vertical","wrapFocus","singleSelection","disabledItemsFocusable","selectedIndex","radioList","checkList","hasTypeahead","component","tag","layout","setEnabled","getTypeaheadInProgress","getSelectedIndex","getFocusedItemIndex","focusItemAtIndex","getElement"];let r=vi(e,i),{$$slots:a={},$$scope:l}=e;var s;const{closest:d,matches:g}=r0,x=ps(ds());let{use:I=[]}=e,{class:A=""}=e,{nonInteractive:L=!1}=e,{dense:N=!1}=e,{textualList:B=!1}=e,{avatarList:F=!1}=e,{iconList:z=!1}=e,{imageList:V=!1}=e,{thumbnailList:Y=!1}=e,{videoList:Q=!1}=e,{twoLine:J=!1}=e,{threeLine:he=!1}=e,{vertical:ee=!0}=e,{wrapFocus:ae=(s=Fr("SMUI:list:wrapFocus"))!==null&&s!==void 0?s:!1}=e,{singleSelection:De=!1}=e,{disabledItemsFocusable:fe=!1}=e,{selectedIndex:le=-1}=e,{radioList:Be=!1}=e,{checkList:Pe=!1}=e,{hasTypeahead:Ce=!1}=e,it,Et,Ue=[],at=Fr("SMUI:list:role"),ke=Fr("SMUI:list:nav");const Dt=new WeakMap;let fn=Fr("SMUI:dialog:selection"),Cn=Fr("SMUI:addLayoutListener"),Gt,{component:Mt=Cu}=e,{tag:vt=Mt===Cu?ke?"nav":"ul":void 0}=e;lr("SMUI:list:nonInteractive",L),lr("SMUI:separator:context","list"),at||(De?(at="listbox",lr("SMUI:list:item:role","option")):Be?(at="radiogroup",lr("SMUI:list:item:role","radio")):Pe?(at="group",lr("SMUI:list:item:role","checkbox")):(at="list",lr("SMUI:list:item:role",void 0))),Cn&&(Gt=Cn(ui)),ro(()=>{t(41,Et=new hU({addClassForElementIndex:Pt,focusItemAtIndex:Ln,getAttributeForElementIndex:(Rn,ti)=>{var tr,js;return(js=(tr=mi()[Rn])===null||tr===void 0?void 0:tr.getAttr(ti))!==null&&js!==void 0?js:null},getFocusedElementIndex:()=>document.activeElement?mi().map(Rn=>Rn.element).indexOf(document.activeElement):-1,getListItemCount:()=>Ue.length,getPrimaryTextAtIndex:He,hasCheckboxAtIndex:Rn=>{var ti,tr;return(tr=(ti=mi()[Rn])===null||ti===void 0?void 0:ti.hasCheckbox)!==null&&tr!==void 0?tr:!1},hasRadioAtIndex:Rn=>{var ti,tr;return(tr=(ti=mi()[Rn])===null||ti===void 0?void 0:ti.hasRadio)!==null&&tr!==void 0?tr:!1},isCheckboxCheckedAtIndex:Rn=>{var ti;const tr=mi()[Rn];return(ti=(tr==null?void 0:tr.hasCheckbox)&&tr.checked)!==null&&ti!==void 0?ti:!1},isFocusInsideList:()=>it!=null&&ki()!==document.activeElement&&ki().contains(document.activeElement),isRootFocused:()=>it!=null&&document.activeElement===ki(),listItemAtIndexHasClass:yn,notifyAction:Rn=>{t(26,le=Rn),it!=null&&ji(ki(),"SMUIList:action",{index:Rn},void 0,!0)},notifySelectionChange:Rn=>{it!=null&&ji(ki(),"SMUIList:selectionChange",{changedIndices:Rn})},removeClassForElementIndex:Yn,setAttributeForElementIndex:si,setCheckedCheckboxOrRadioAtIndex:(Rn,ti)=>{mi()[Rn].checked=ti},setTabIndexForListItemChildren:(Rn,ti)=>{const tr=mi()[Rn],js="button:not(:disabled), a";Array.prototype.forEach.call(tr.element.querySelectorAll(js),mo=>{mo.setAttribute("tabindex",ti)})}}));const Xt={get element(){return ki()},get items(){return Ue},get typeaheadInProgress(){return Et.isTypeaheadInProgress()},typeaheadMatchItem(Rn,ti){return Et.typeaheadMatchItem(Rn,ti,!0)},getOrderedList:mi,focusItemAtIndex:Ln,addClassForElementIndex:Pt,removeClassForElementIndex:Yn,setAttributeForElementIndex:si,removeAttributeForElementIndex:Dr,getAttributeFromElementIndex:Ur,getPrimaryTextAtIndex:He};return ji(ki(),"SMUIList:mount",Xt),Et.init(),Et.layout(),()=>{Et.destroy()}}),Dh(()=>{Gt&&Gt()});function xn(Xt){Ue.push(Xt.detail),Dt.set(Xt.detail.element,Xt.detail),De&&Xt.detail.selected&&t(26,le=Jt(Xt.detail.element)),Xt.stopPropagation()}function En(Xt){var Rn;const ti=(Rn=Xt.detail&&Ue.indexOf(Xt.detail))!==null&&Rn!==void 0?Rn:-1;ti!==-1&&(Ue.splice(ti,1),Ue=Ue,Dt.delete(Xt.detail.element)),Xt.stopPropagation()}function _t(Xt){Et&&Xt.target&&Et.handleKeydown(Xt,Xt.target.classList.contains("mdc-deprecated-list-item"),Jt(Xt.target))}function kt(Xt){Et&&Xt.target&&Et.handleFocusIn(Jt(Xt.target))}function Ct(Xt){Et&&Xt.target&&Et.handleFocusOut(Jt(Xt.target))}function Bt(Xt){Et&&Xt.target&&Et.handleClick(Jt(Xt.target),!g(Xt.target,'input[type="checkbox"], input[type="radio"]'),Xt)}function Zn(Xt){if(Be||Pe){const Rn=Jt(Xt.target);if(Rn!==-1){const ti=mi()[Rn];ti&&(Be&&!ti.checked||Pe)&&(g(Xt.detail.target,'input[type="checkbox"], input[type="radio"]')||(ti.checked=!ti.checked),ti.activateRipple(),window.requestAnimationFrame(()=>{ti.deactivateRipple()}))}}}function mi(){return it==null?[]:[...ki().children].map(Xt=>Dt.get(Xt)).filter(Xt=>Xt&&Xt._smui_list_item_accessor)}function yn(Xt,Rn){var ti;const tr=mi()[Xt];return(ti=tr&&tr.hasClass(Rn))!==null&&ti!==void 0?ti:!1}function Pt(Xt,Rn){const ti=mi()[Xt];ti&&ti.addClass(Rn)}function Yn(Xt,Rn){const ti=mi()[Xt];ti&&ti.removeClass(Rn)}function si(Xt,Rn,ti){const tr=mi()[Xt];tr&&tr.addAttr(Rn,ti)}function Dr(Xt,Rn){const ti=mi()[Xt];ti&&ti.removeAttr(Rn)}function Ur(Xt,Rn){const ti=mi()[Xt];return ti?ti.getAttr(Rn):null}function He(Xt){var Rn;const ti=mi()[Xt];return(Rn=ti&&ti.getPrimaryText())!==null&&Rn!==void 0?Rn:""}function Jt(Xt){const Rn=d(Xt,".mdc-deprecated-list-item, .mdc-deprecated-list");return Rn&&g(Rn,".mdc-deprecated-list-item")?mi().map(ti=>ti==null?void 0:ti.element).indexOf(Rn):-1}function ui(){return Et.layout()}function $e(Xt,Rn){return Et.setEnabled(Xt,Rn)}function kn(){return Et.isTypeaheadInProgress()}function Ei(){return Et.getSelectedIndex()}function ni(){return Et.getFocusedItemIndex()}function Ln(Xt){const Rn=mi()[Xt];Rn&&"focus"in Rn.element&&Rn.element.focus()}function ki(){return it.getElement()}function Hs(Xt){Sn[Xt?"unshift":"push"](()=>{it=Xt,t(14,it)})}return n.$$set=Xt=>{e=zt(zt({},e),ls(Xt)),t(25,r=vi(e,i)),"use"in Xt&&t(0,I=Xt.use),"class"in Xt&&t(1,A=Xt.class),"nonInteractive"in Xt&&t(2,L=Xt.nonInteractive),"dense"in Xt&&t(3,N=Xt.dense),"textualList"in Xt&&t(4,B=Xt.textualList),"avatarList"in Xt&&t(5,F=Xt.avatarList),"iconList"in Xt&&t(6,z=Xt.iconList),"imageList"in Xt&&t(7,V=Xt.imageList),"thumbnailList"in Xt&&t(8,Y=Xt.thumbnailList),"videoList"in Xt&&t(9,Q=Xt.videoList),"twoLine"in Xt&&t(10,J=Xt.twoLine),"threeLine"in Xt&&t(11,he=Xt.threeLine),"vertical"in Xt&&t(27,ee=Xt.vertical),"wrapFocus"in Xt&&t(28,ae=Xt.wrapFocus),"singleSelection"in Xt&&t(29,De=Xt.singleSelection),"disabledItemsFocusable"in Xt&&t(30,fe=Xt.disabledItemsFocusable),"selectedIndex"in Xt&&t(26,le=Xt.selectedIndex),"radioList"in Xt&&t(31,Be=Xt.radioList),"checkList"in Xt&&t(32,Pe=Xt.checkList),"hasTypeahead"in Xt&&t(33,Ce=Xt.hasTypeahead),"component"in Xt&&t(12,Mt=Xt.component),"tag"in Xt&&t(13,vt=Xt.tag),"$$scope"in Xt&&t(44,l=Xt.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&134217728|n.$$.dirty[1]&1024&&Et&&Et.setVerticalOrientation(ee),n.$$.dirty[0]&268435456|n.$$.dirty[1]&1024&&Et&&Et.setWrapFocus(ae),n.$$.dirty[1]&1028&&Et&&Et.setHasTypeahead(Ce),n.$$.dirty[0]&536870912|n.$$.dirty[1]&1024&&Et&&Et.setSingleSelection(De),n.$$.dirty[0]&1073741824|n.$$.dirty[1]&1024&&Et&&Et.setDisabledItemsFocusable(fe),n.$$.dirty[0]&603979776|n.$$.dirty[1]&1024&&Et&&De&&Ei()!==le&&Et.setSelectedIndex(le)},[I,A,L,N,B,F,z,V,Y,Q,J,he,Mt,vt,it,at,x,fn,xn,En,_t,kt,Ct,Bt,Zn,r,le,ee,ae,De,fe,Be,Pe,Ce,ui,$e,kn,Ei,ni,Ln,ki,Et,a,Hs,l]}class AU extends sr{constructor(e){super(),or(this,e,CU,SU,Qi,{use:0,class:1,nonInteractive:2,dense:3,textualList:4,avatarList:5,iconList:6,imageList:7,thumbnailList:8,videoList:9,twoLine:10,threeLine:11,vertical:27,wrapFocus:28,singleSelection:29,disabledItemsFocusable:30,selectedIndex:26,radioList:31,checkList:32,hasTypeahead:33,component:12,tag:13,layout:34,setEnabled:35,getTypeaheadInProgress:36,getSelectedIndex:37,getFocusedItemIndex:38,focusItemAtIndex:39,getElement:40},null,[-1,-1])}get layout(){return this.$$.ctx[34]}get setEnabled(){return this.$$.ctx[35]}get getTypeaheadInProgress(){return this.$$.ctx[36]}get getSelectedIndex(){return this.$$.ctx[37]}get getFocusedItemIndex(){return this.$$.ctx[38]}get focusItemAtIndex(){return this.$$.ctx[39]}get getElement(){return this.$$.ctx[40]}}function nM(n){let e;return{c(){e=qt("span"),this.h()},l(t){e=Wt(t,"SPAN",{class:!0}),Qt(e).forEach(de),this.h()},h(){tn(e,"class","mdc-deprecated-list-item__ripple")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function MU(n){let e,t,i=n[7]&&nM();const r=n[34].default,a=Ri(r,n,n[37],null);return{c(){i&&i.c(),e=pi(),a&&a.c()},l(l){i&&i.l(l),e=pi(),a&&a.l(l)},m(l,s){i&&i.m(l,s),tt(l,e,s),a&&a.m(l,s),t=!0},p(l,s){l[7]?i||(i=nM(),i.c(),i.m(e.parentNode,e)):i&&(i.d(1),i=null),a&&a.p&&(!t||s[1]&64)&&Pi(a,r,l,l[37],t?Oi(r,l[37],s,null):Di(l[37]),null)},i(l){t||(Te(a,l),t=!0)},o(l){Ne(a,l),t=!1},d(l){i&&i.d(l),l&&de(e),a&&a.d(l)}}}function LU(n){let e,t,i;const r=[{tag:n[14]},{use:[...n[6]?[]:[[jc,{ripple:!n[16],unbounded:!1,color:(n[1]||n[0])&&n[5]==null?"primary":n[5],disabled:n[10],addClass:n[24],removeClass:n[25],addStyle:n[26]}]],n[22],...n[2]]},{class:In({[n[3]]:!0,"mdc-deprecated-list-item":!n[8],"mdc-deprecated-list-item__wrapper":n[8],"mdc-deprecated-list-item--activated":n[1],"mdc-deprecated-list-item--selected":n[0],"mdc-deprecated-list-item--disabled":n[10],"mdc-menu-item--selected":!n[23]&&n[9]==="menuitem"&&n[0],"smui-menu-item--non-interactive":n[6],...n[18]})},{style:Object.entries(n[19]).map(iM).concat([n[4]]).join(" ")},n[23]&&n[1]?{"aria-current":"page"}:{},!n[23]||n[8]?{role:n[9]}:{},!n[23]&&n[9]==="option"?{"aria-selected":n[0]?"true":"false"}:{},!n[23]&&(n[9]==="radio"||n[9]==="checkbox")?{"aria-checked":n[16]&&n[16].checked?"true":"false"}:{},n[23]?{}:{"aria-disabled":n[10]?"true":"false"},{"data-menu-item-skip-restore-focus":n[11]||void 0},{tabindex:n[21]},{href:n[12]},n[20],n[29]];var a=n[13];function l(s){let d={$$slots:{default:[MU]},$$scope:{ctx:s}};for(let g=0;g<r.length;g+=1)d=zt(d,r[g]);return{props:d}}return a&&(e=Xa(a,l(n)),n[35](e),e.$on("click",n[15]),e.$on("keydown",n[27]),e.$on("SMUIGenericInput:mount",n[28]),e.$on("SMUIGenericInput:unmount",n[36])),{c(){e&&sn(e.$$.fragment),t=pi()},l(s){e&&dn(e.$$.fragment,s),t=pi()},m(s,d){e&&on(e,s,d),tt(s,t,d),i=!0},p(s,d){const g=d[0]&670916479?hi(r,[d[0]&16384&&{tag:s[14]},d[0]&121701479&&{use:[...s[6]?[]:[[jc,{ripple:!s[16],unbounded:!1,color:(s[1]||s[0])&&s[5]==null?"primary":s[5],disabled:s[10],addClass:s[24],removeClass:s[25],addStyle:s[26]}]],s[22],...s[2]]},d[0]&8652619&&{class:In({[s[3]]:!0,"mdc-deprecated-list-item":!s[8],"mdc-deprecated-list-item__wrapper":s[8],"mdc-deprecated-list-item--activated":s[1],"mdc-deprecated-list-item--selected":s[0],"mdc-deprecated-list-item--disabled":s[10],"mdc-menu-item--selected":!s[23]&&s[9]==="menuitem"&&s[0],"smui-menu-item--non-interactive":s[6],...s[18]})},d[0]&524304&&{style:Object.entries(s[19]).map(iM).concat([s[4]]).join(" ")},d[0]&8388610&&Mr(s[23]&&s[1]?{"aria-current":"page"}:{}),d[0]&8389376&&Mr(!s[23]||s[8]?{role:s[9]}:{}),d[0]&8389121&&Mr(!s[23]&&s[9]==="option"?{"aria-selected":s[0]?"true":"false"}:{}),d[0]&8454656&&Mr(!s[23]&&(s[9]==="radio"||s[9]==="checkbox")?{"aria-checked":s[16]&&s[16].checked?"true":"false"}:{}),d[0]&8389632&&Mr(s[23]?{}:{"aria-disabled":s[10]?"true":"false"}),d[0]&2048&&{"data-menu-item-skip-restore-focus":s[11]||void 0},d[0]&2097152&&{tabindex:s[21]},d[0]&4096&&{href:s[12]},d[0]&1048576&&Mr(s[20]),d[0]&536870912&&Mr(s[29])]):{};if(d[0]&128|d[1]&64&&(g.$$scope={dirty:d,ctx:s}),d[0]&8192&&a!==(a=s[13])){if(e){Wi();const x=e;Ne(x.$$.fragment,1,0,()=>{an(x,1)}),Xi()}a?(e=Xa(a,l(s)),s[35](e),e.$on("click",s[15]),e.$on("keydown",s[27]),e.$on("SMUIGenericInput:mount",s[28]),e.$on("SMUIGenericInput:unmount",s[36]),sn(e.$$.fragment),Te(e.$$.fragment,1),on(e,t.parentNode,t)):e=null}else a&&e.$set(g)},i(s){i||(e&&Te(e.$$.fragment,s),i=!0)},o(s){e&&Ne(e.$$.fragment,s),i=!1},d(s){n[35](null),s&&de(t),e&&an(e,s)}}}let RU=0;const iM=([n,e])=>`${n}: ${e};`;function PU(n,e,t){let i;const r=["use","class","style","color","nonInteractive","ripple","wrapper","activated","role","selected","disabled","skipRestoreFocus","tabindex","inputId","href","component","tag","action","getPrimaryText","getElement"];let a=vi(e,r),{$$slots:l={},$$scope:s}=e;var d;const g=ps(ds());let x=()=>{};function I(Pt){return Pt===x}let{use:A=[]}=e,{class:L=""}=e,{style:N=""}=e,{color:B=void 0}=e,{nonInteractive:F=(d=Fr("SMUI:list:nonInteractive"))!==null&&d!==void 0?d:!1}=e;lr("SMUI:list:nonInteractive",void 0);let{ripple:z=!F}=e,{wrapper:V=!1}=e,{activated:Y=!1}=e,{role:Q=V?"presentation":Fr("SMUI:list:item:role")}=e;lr("SMUI:list:item:role",void 0);let{selected:J=!1}=e,{disabled:he=!1}=e,{skipRestoreFocus:ee=!1}=e,{tabindex:ae=x}=e,{inputId:De="SMUI-form-field-list-"+RU++}=e,{href:fe=void 0}=e,le,Be={},Pe={},Ce={},it,Et,Ue=Fr("SMUI:list:item:nav"),{component:at=Cu}=e,{tag:ke=at===Cu?Ue?fe?"a":"span":"li":void 0}=e;lr("SMUI:generic:input:props",{id:De}),lr("SMUI:separator:context",void 0),ro(()=>{if(!J&&!F){let Yn=!0,si=le.getElement();for(;si.previousSibling;)if(si=si.previousSibling,si.nodeType===1&&si.classList.contains("mdc-deprecated-list-item")&&!si.classList.contains("mdc-deprecated-list-item--disabled")){Yn=!1;break}Yn&&(Et=window.requestAnimationFrame(()=>En(si)))}const Pt={_smui_list_item_accessor:!0,get element(){return Zn()},get selected(){return J},set selected(Yn){t(0,J=Yn)},hasClass:Dt,addClass:fn,removeClass:Cn,getAttr:Mt,addAttr:vt,removeAttr:xn,getPrimaryText:Bt,get checked(){var Yn;return(Yn=it&&it.checked)!==null&&Yn!==void 0?Yn:!1},set checked(Yn){it&&t(16,it.checked=!!Yn,it)},get hasCheckbox(){return!!(it&&"_smui_checkbox_accessor"in it)},get hasRadio(){return!!(it&&"_smui_radio_accessor"in it)},activateRipple(){it&&it.activateRipple()},deactivateRipple(){it&&it.deactivateRipple()},getValue(){return a.value},action:Ct,get tabindex(){return i},set tabindex(Yn){t(30,ae=Yn)},get disabled(){return he},get activated(){return Y},set activated(Yn){t(1,Y=Yn)}};return ji(Zn(),"SMUIListItem:mount",Pt),()=>{ji(Zn(),"SMUIListItem:unmount",Pt)}}),Dh(()=>{Et&&window.cancelAnimationFrame(Et)});function Dt(Pt){return Pt in Be?Be[Pt]:Zn().classList.contains(Pt)}function fn(Pt){Be[Pt]||t(18,Be[Pt]=!0,Be)}function Cn(Pt){(!(Pt in Be)||Be[Pt])&&t(18,Be[Pt]=!1,Be)}function Gt(Pt,Yn){Pe[Pt]!=Yn&&(Yn===""||Yn==null?(delete Pe[Pt],t(19,Pe)):t(19,Pe[Pt]=Yn,Pe))}function Mt(Pt){var Yn;return Pt in Ce?(Yn=Ce[Pt])!==null&&Yn!==void 0?Yn:null:Zn().getAttribute(Pt)}function vt(Pt,Yn){Ce[Pt]!==Yn&&t(20,Ce[Pt]=Yn,Ce)}function xn(Pt){(!(Pt in Ce)||Ce[Pt]!=null)&&t(20,Ce[Pt]=void 0,Ce)}function En(Pt){let Yn=!0;for(;Pt.nextElementSibling;)if(Pt=Pt.nextElementSibling,Pt.nodeType===1&&Pt.classList.contains("mdc-deprecated-list-item")){const si=Pt.attributes.getNamedItem("tabindex");if(si&&si.value==="0"){Yn=!1;break}}Yn&&t(21,i=0)}function _t(Pt){const Yn=Pt.key==="Enter",si=Pt.key==="Space";(Yn||si)&&Ct(Pt)}function kt(Pt){("_smui_checkbox_accessor"in Pt.detail||"_smui_radio_accessor"in Pt.detail)&&t(16,it=Pt.detail)}function Ct(Pt){he||ji(Zn(),"SMUI:action",Pt)}function Bt(){var Pt,Yn,si;const Dr=Zn(),Ur=Dr.querySelector(".mdc-deprecated-list-item__primary-text");if(Ur)return(Pt=Ur.textContent)!==null&&Pt!==void 0?Pt:"";const He=Dr.querySelector(".mdc-deprecated-list-item__text");return He?(Yn=He.textContent)!==null&&Yn!==void 0?Yn:"":(si=Dr.textContent)!==null&&si!==void 0?si:""}function Zn(){return le.getElement()}function mi(Pt){Sn[Pt?"unshift":"push"](()=>{le=Pt,t(17,le)})}const yn=()=>t(16,it=void 0);return n.$$set=Pt=>{e=zt(zt({},e),ls(Pt)),t(29,a=vi(e,r)),"use"in Pt&&t(2,A=Pt.use),"class"in Pt&&t(3,L=Pt.class),"style"in Pt&&t(4,N=Pt.style),"color"in Pt&&t(5,B=Pt.color),"nonInteractive"in Pt&&t(6,F=Pt.nonInteractive),"ripple"in Pt&&t(7,z=Pt.ripple),"wrapper"in Pt&&t(8,V=Pt.wrapper),"activated"in Pt&&t(1,Y=Pt.activated),"role"in Pt&&t(9,Q=Pt.role),"selected"in Pt&&t(0,J=Pt.selected),"disabled"in Pt&&t(10,he=Pt.disabled),"skipRestoreFocus"in Pt&&t(11,ee=Pt.skipRestoreFocus),"tabindex"in Pt&&t(30,ae=Pt.tabindex),"inputId"in Pt&&t(31,De=Pt.inputId),"href"in Pt&&t(12,fe=Pt.href),"component"in Pt&&t(13,at=Pt.component),"tag"in Pt&&t(14,ke=Pt.tag),"$$scope"in Pt&&t(37,s=Pt.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&1073808449&&t(21,i=I(ae)?!F&&!he&&(J||it&&it.checked)?0:-1:ae)},[J,Y,A,L,N,B,F,z,V,Q,he,ee,fe,at,ke,Ct,it,le,Be,Pe,Ce,i,g,Ue,fn,Cn,Gt,_t,kt,a,ae,De,Bt,Zn,l,mi,yn,s]}class DU extends sr{constructor(e){super(),or(this,e,PU,LU,Qi,{use:2,class:3,style:4,color:5,nonInteractive:6,ripple:7,wrapper:8,activated:1,role:9,selected:0,disabled:10,skipRestoreFocus:11,tabindex:30,inputId:31,href:12,component:13,tag:14,action:15,getPrimaryText:32,getElement:33},null,[-1,-1])}get action(){return this.$$.ctx[15]}get getPrimaryText(){return this.$$.ctx[32]}get getElement(){return this.$$.ctx[33]}}zl({class:"mdc-deprecated-list-item__text",tag:"span"});zl({class:"mdc-deprecated-list-item__primary-text",tag:"span"});zl({class:"mdc-deprecated-list-item__secondary-text",tag:"span"});function OU(n){let e,t,i,r,a,l;const s=n[8].default,d=Ri(s,n,n[7],null);let g=[{class:t=In({[n[1]]:!0,"mdc-deprecated-list-item__graphic":!0,"mdc-menu__selection-group-icon":n[4]})},n[5]],x={};for(let I=0;I<g.length;I+=1)x=zt(x,g[I]);return{c(){e=qt("span"),d&&d.c(),this.h()},l(I){e=Wt(I,"SPAN",{class:!0});var A=Qt(e);d&&d.l(A),A.forEach(de),this.h()},h(){Xn(e,x)},m(I,A){tt(I,e,A),d&&d.m(e,null),n[9](e),r=!0,a||(l=[li(i=jr.call(null,e,n[0])),li(n[3].call(null,e))],a=!0)},p(I,[A]){d&&d.p&&(!r||A&128)&&Pi(d,s,I,I[7],r?Oi(s,I[7],A,null):Di(I[7]),null),Xn(e,x=hi(g,[(!r||A&2&&t!==(t=In({[I[1]]:!0,"mdc-deprecated-list-item__graphic":!0,"mdc-menu__selection-group-icon":I[4]})))&&{class:t},A&32&&I[5]])),i&&Gi(i.update)&&A&1&&i.update.call(null,I[0])},i(I){r||(Te(d,I),r=!0)},o(I){Ne(d,I),r=!1},d(I){I&&de(e),d&&d.d(I),n[9](null),a=!1,Ss(l)}}}function NU(n,e,t){const i=["use","class","getElement"];let r=vi(e,i),{$$slots:a={},$$scope:l}=e;const s=ps(ds());let{use:d=[]}=e,{class:g=""}=e,x,I=Fr("SMUI:list:graphic:menu-selection-group");function A(){return x}function L(N){Sn[N?"unshift":"push"](()=>{x=N,t(2,x)})}return n.$$set=N=>{e=zt(zt({},e),ls(N)),t(5,r=vi(e,i)),"use"in N&&t(0,d=N.use),"class"in N&&t(1,g=N.class),"$$scope"in N&&t(7,l=N.$$scope)},[d,g,x,s,I,r,A,l,a,L]}class kU extends sr{constructor(e){super(),or(this,e,NU,OU,Qi,{use:0,class:1,getElement:6})}get getElement(){return this.$$.ctx[6]}}zl({class:"mdc-deprecated-list-item__meta",tag:"span"});zl({class:"mdc-deprecated-list-group",tag:"div"});zl({class:"mdc-deprecated-list-group__subheader",tag:"h3"});zl({class:"mdc-menu__selection-group-icon",component:kU});function FU(n){let e;return{c(){e=_i(n[8])},l(t){e=yi(t,n[8])},m(t,i){tt(t,e,i)},p(t,i){i&256&&ys(e,t[8])},i:_l,o:_l,d(t){t&&de(e)}}}function BU(n){let e;const t=n[13].default,i=Ri(t,n,n[12],null);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a&4096)&&Pi(i,t,r,r[12],e?Oi(t,r[12],a,null):Di(r[12]),null)},i(r){e||(Te(i,r),e=!0)},o(r){Ne(i,r),e=!1},d(r){i&&i.d(r)}}}function zU(n){let e,t,i,r,a,l,s,d,g;const x=[BU,FU],I=[];function A(B,F){return B[8]==null?0:1}t=A(n),i=I[t]=x[t](n);let L=[{class:r=In({[n[1]]:!0,"mdc-select-helper-text":!0,"mdc-select-helper-text--validation-msg":n[4],"mdc-select-helper-text--validation-msg-persistent":n[3],...n[6]})},{"aria-hidden":a=n[3]?void 0:"true"},{id:n[2]},n[7],n[10]],N={};for(let B=0;B<L.length;B+=1)N=zt(N,L[B]);return{c(){e=qt("div"),i.c(),this.h()},l(B){e=Wt(B,"DIV",{class:!0,"aria-hidden":!0,id:!0});var F=Qt(e);i.l(F),F.forEach(de),this.h()},h(){Xn(e,N)},m(B,F){tt(B,e,F),I[t].m(e,null),n[14](e),s=!0,d||(g=[li(l=jr.call(null,e,n[0])),li(n[9].call(null,e))],d=!0)},p(B,[F]){let z=t;t=A(B),t===z?I[t].p(B,F):(Wi(),Ne(I[z],1,1,()=>{I[z]=null}),Xi(),i=I[t],i?i.p(B,F):(i=I[t]=x[t](B),i.c()),Te(i,1),i.m(e,null)),Xn(e,N=hi(L,[(!s||F&90&&r!==(r=In({[B[1]]:!0,"mdc-select-helper-text":!0,"mdc-select-helper-text--validation-msg":B[4],"mdc-select-helper-text--validation-msg-persistent":B[3],...B[6]})))&&{class:r},(!s||F&8&&a!==(a=B[3]?void 0:"true"))&&{"aria-hidden":a},(!s||F&4)&&{id:B[2]},F&128&&B[7],F&1024&&B[10]])),l&&Gi(l.update)&&F&1&&l.update.call(null,B[0])},i(B){s||(Te(i),s=!0)},o(B){Ne(i),s=!1},d(B){B&&de(e),I[t].d(),n[14](null),d=!1,Ss(g)}}}let UU=0;function VU(n,e,t){const i=["use","class","id","persistent","validationMsg","getElement"];let r=vi(e,i),{$$slots:a={},$$scope:l}=e;const s=ps(ds());let{use:d=[]}=e,{class:g=""}=e,{id:x="SMUI-select-helper-text-"+UU++}=e,{persistent:I=!1}=e,{validationMsg:A=!1}=e,L,N,B={},F={},z;ro(()=>(N=new mU({addClass:Y,removeClass:Q,hasClass:V,getAttr:J,setAttr:he,removeAttr:ee,setContent:fe=>{t(8,z=fe)}}),x.startsWith("SMUI-select-helper-text-")&&ji(ae(),"SMUISelectHelperText:id",x),ji(ae(),"SMUISelectHelperText:mount",N),N.init(),()=>{ji(ae(),"SMUISelectHelperText:unmount",N),N.destroy()}));function V(fe){return fe in B?B[fe]:ae().classList.contains(fe)}function Y(fe){B[fe]||t(6,B[fe]=!0,B)}function Q(fe){(!(fe in B)||B[fe])&&t(6,B[fe]=!1,B)}function J(fe){var le;return fe in F?(le=F[fe])!==null&&le!==void 0?le:null:ae().getAttribute(fe)}function he(fe,le){F[fe]!==le&&t(7,F[fe]=le,F)}function ee(fe){(!(fe in F)||F[fe]!=null)&&t(7,F[fe]=void 0,F)}function ae(){return L}function De(fe){Sn[fe?"unshift":"push"](()=>{L=fe,t(5,L)})}return n.$$set=fe=>{e=zt(zt({},e),ls(fe)),t(10,r=vi(e,i)),"use"in fe&&t(0,d=fe.use),"class"in fe&&t(1,g=fe.class),"id"in fe&&t(2,x=fe.id),"persistent"in fe&&t(3,I=fe.persistent),"validationMsg"in fe&&t(4,A=fe.validationMsg),"$$scope"in fe&&t(12,l=fe.$$scope)},[d,g,x,I,A,L,B,F,z,s,r,ae,l,a,De]}class GU extends sr{constructor(e){super(),or(this,e,VU,zU,Qi,{use:0,class:1,id:2,persistent:3,validationMsg:4,getElement:11})}get getElement(){return this.$$.ctx[11]}}const HU=n=>({}),rM=n=>({}),jU=n=>({}),sM=n=>({}),qU=n=>({}),oM=n=>({}),WU=n=>({}),aM=n=>({});function lM(n){let e,t=[{type:"hidden"},{required:n[10]},{disabled:n[6]},{value:n[0]},gi(n[53],"input$")],i={};for(let r=0;r<t.length;r+=1)i=zt(i,t[r]);return{c(){e=qt("input"),this.h()},l(r){e=Wt(r,"INPUT",{type:!0}),this.h()},h(){Xn(e,i)},m(r,a){tt(r,e,a),e.autofocus&&e.focus()},p(r,a){Xn(e,i=hi(t,[{type:"hidden"},a[0]&1024&&{required:r[10]},a[0]&64&&{disabled:r[6]},a[0]&1&&{value:r[0]},a[1]&4194304&&gi(r[53],"input$")]))},d(r){r&&de(e)}}}function uM(n){let e;return{c(){e=qt("span"),this.h()},l(t){e=Wt(t,"SPAN",{class:!0}),Qt(e).forEach(de),this.h()},h(){tn(e,"class","mdc-select__ripple")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function cM(n){let e,t;const i=[{id:n[11]+"-smui-label"},{floatAbove:n[42]!==""},{required:n[10]},gi(n[53],"label$")];let r={$$slots:{default:[XU]},$$scope:{ctx:n}};for(let a=0;a<i.length;a+=1)r=zt(r,i[a]);return e=new pI({props:r}),n[66](e),{c(){sn(e.$$.fragment)},l(a){dn(e.$$.fragment,a)},m(a,l){on(e,a,l),t=!0},p(a,l){const s=l[0]&3072|l[1]&4196352?hi(i,[l[0]&2048&&{id:a[11]+"-smui-label"},l[1]&2048&&{floatAbove:a[42]!==""},l[0]&1024&&{required:a[10]},l[1]&4194304&&Mr(gi(a[53],"label$"))]):{};l[0]&512|l[2]&16777216&&(s.$$scope={dirty:l,ctx:a}),e.$set(s)},i(a){t||(Te(e.$$.fragment,a),t=!0)},o(a){Ne(e.$$.fragment,a),t=!1},d(a){n[66](null),an(e,a)}}}function XU(n){let e=(n[9]==null?"":n[9])+"",t,i;const r=n[63].label,a=Ri(r,n,n[86],aM);return{c(){t=_i(e),a&&a.c()},l(l){t=yi(l,e),a&&a.l(l)},m(l,s){tt(l,t,s),a&&a.m(l,s),i=!0},p(l,s){(!i||s[0]&512)&&e!==(e=(l[9]==null?"":l[9])+"")&&ys(t,e),a&&a.p&&(!i||s[2]&16777216)&&Pi(a,r,l,l[86],i?Oi(r,l[86],s,WU):Di(l[86]),aM)},i(l){i||(Te(a,l),i=!0)},o(l){Ne(a,l),i=!1},d(l){l&&de(t),a&&a.d(l)}}}function hM(n){let e,t;const i=[{noLabel:n[8]||n[9]==null&&!n[52].label},gi(n[53],"outline$")];let r={$$slots:{default:[YU]},$$scope:{ctx:n}};for(let a=0;a<i.length;a+=1)r=zt(r,i[a]);return e=new QL({props:r}),n[68](e),{c(){sn(e.$$.fragment)},l(a){dn(e.$$.fragment,a)},m(a,l){on(e,a,l),t=!0},p(a,l){const s=l[0]&768|l[1]&6291456?hi(i,[l[0]&768|l[1]&2097152&&{noLabel:a[8]||a[9]==null&&!a[52].label},l[1]&4194304&&Mr(gi(a[53],"outline$"))]):{};l[0]&3840|l[1]&6293760|l[2]&16777216&&(s.$$scope={dirty:l,ctx:a}),e.$set(s)},i(a){t||(Te(e.$$.fragment,a),t=!0)},o(a){Ne(e.$$.fragment,a),t=!1},d(a){n[68](null),an(e,a)}}}function fM(n){let e,t;const i=[{id:n[11]+"-smui-label"},{floatAbove:n[42]!==""},{required:n[10]},gi(n[53],"label$")];let r={$$slots:{default:[ZU]},$$scope:{ctx:n}};for(let a=0;a<i.length;a+=1)r=zt(r,i[a]);return e=new pI({props:r}),n[67](e),{c(){sn(e.$$.fragment)},l(a){dn(e.$$.fragment,a)},m(a,l){on(e,a,l),t=!0},p(a,l){const s=l[0]&3072|l[1]&4196352?hi(i,[l[0]&2048&&{id:a[11]+"-smui-label"},l[1]&2048&&{floatAbove:a[42]!==""},l[0]&1024&&{required:a[10]},l[1]&4194304&&Mr(gi(a[53],"label$"))]):{};l[0]&512|l[2]&16777216&&(s.$$scope={dirty:l,ctx:a}),e.$set(s)},i(a){t||(Te(e.$$.fragment,a),t=!0)},o(a){Ne(e.$$.fragment,a),t=!1},d(a){n[67](null),an(e,a)}}}function ZU(n){let e=(n[9]==null?"":n[9])+"",t,i;const r=n[63].label,a=Ri(r,n,n[86],oM);return{c(){t=_i(e),a&&a.c()},l(l){t=yi(l,e),a&&a.l(l)},m(l,s){tt(l,t,s),a&&a.m(l,s),i=!0},p(l,s){(!i||s[0]&512)&&e!==(e=(l[9]==null?"":l[9])+"")&&ys(t,e),a&&a.p&&(!i||s[2]&16777216)&&Pi(a,r,l,l[86],i?Oi(r,l[86],s,qU):Di(l[86]),oM)},i(l){i||(Te(a,l),i=!0)},o(l){Ne(a,l),i=!1},d(l){l&&de(t),a&&a.d(l)}}}function YU(n){let e,t,i=!n[8]&&(n[9]!=null||n[52].label)&&fM(n);return{c(){i&&i.c(),e=pi()},l(r){i&&i.l(r),e=pi()},m(r,a){i&&i.m(r,a),tt(r,e,a),t=!0},p(r,a){!r[8]&&(r[9]!=null||r[52].label)?i?(i.p(r,a),a[0]&768|a[1]&2097152&&Te(i,1)):(i=fM(r),i.c(),Te(i,1),i.m(e.parentNode,e)):i&&(Wi(),Ne(i,1,1,()=>{i=null}),Xi())},i(r){t||(Te(i),t=!0)},o(r){Ne(i),t=!1},d(r){i&&i.d(r),r&&de(e)}}}function dM(n){let e,t;const i=[gi(n[53],"ripple$")];let r={};for(let a=0;a<i.length;a+=1)r=zt(r,i[a]);return e=new JL({props:r}),n[69](e),{c(){sn(e.$$.fragment)},l(a){dn(e.$$.fragment,a)},m(a,l){on(e,a,l),t=!0},p(a,l){const s=l[1]&4194304?hi(i,[Mr(gi(a[53],"ripple$"))]):{};e.$set(s)},i(a){t||(Te(e.$$.fragment,a),t=!0)},o(a){Ne(e.$$.fragment,a),t=!1},d(a){n[69](null),an(e,a)}}}function KU(n){let e;const t=n[63].default,i=Ri(t,n,n[86],null);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a[2]&16777216)&&Pi(i,t,r,r[86],e?Oi(t,r[86],a,null):Di(r[86]),null)},i(r){e||(Te(i,r),e=!0)},o(r){Ne(i,r),e=!1},d(r){i&&i.d(r)}}}function JU(n){let e,t,i;const r=[{role:"listbox"},{wrapFocus:n[35]},gi(n[53],"list$")];function a(s){n[74](s)}let l={$$slots:{default:[KU]},$$scope:{ctx:n}};for(let s=0;s<r.length;s+=1)l=zt(l,r[s]);return n[24]!==void 0&&(l.selectedIndex=n[24]),e=new AU({props:l}),Sn.push(()=>Xr(e,"selectedIndex",a)),e.$on("SMUIList:mount",n[75]),{c(){sn(e.$$.fragment)},l(s){dn(e.$$.fragment,s)},m(s,d){on(e,s,d),i=!0},p(s,d){const g=d[1]&4194320?hi(r,[r[0],d[1]&16&&{wrapFocus:s[35]},d[1]&4194304&&Mr(gi(s[53],"list$"))]):{};d[2]&16777216&&(g.$$scope={dirty:d,ctx:s}),!t&&d[0]&16777216&&(t=!0,g.selectedIndex=s[24],Qr(()=>t=!1)),e.$set(g)},i(s){i||(Te(e.$$.fragment,s),i=!0)},o(s){Ne(e.$$.fragment,s),i=!1},d(s){an(e,s)}}}function pM(n){let e,t;const i=[gi(n[53],"helperText$")];let r={$$slots:{default:[QU]},$$scope:{ctx:n}};for(let a=0;a<i.length;a+=1)r=zt(r,i[a]);return e=new GU({props:r}),e.$on("SMUISelectHelperText:id",n[83]),e.$on("SMUISelectHelperText:mount",n[84]),e.$on("SMUISelectHelperText:unmount",n[85]),{c(){sn(e.$$.fragment)},l(a){dn(e.$$.fragment,a)},m(a,l){on(e,a,l),t=!0},p(a,l){const s=l[1]&4194304?hi(i,[Mr(gi(a[53],"helperText$"))]):{};l[2]&16777216&&(s.$$scope={dirty:l,ctx:a}),e.$set(s)},i(a){t||(Te(e.$$.fragment,a),t=!0)},o(a){Ne(e.$$.fragment,a),t=!1},d(a){an(e,a)}}}function QU(n){let e;const t=n[63].helperText,i=Ri(t,n,n[86],rM);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a[2]&16777216)&&Pi(i,t,r,r[86],e?Oi(t,r[86],a,HU):Di(r[86]),rM)},i(r){e||(Te(i,r),e=!0)},o(r){Ne(i,r),e=!1},d(r){i&&i.d(r)}}}function $U(n){let e,t,i,r,a,l,s,d,g,x,I,A,L,N,B,F,z,V,Y,Q,J,he,ee,ae,De,fe,le,Be,Pe,Ce,it,Et,Ue,at,ke,Dt,fn,Cn,Gt,Mt,vt=n[12]&&lM(n),xn=n[7]==="filled"&&uM(),En=n[7]!=="outlined"&&!n[8]&&(n[9]!=null||n[52].label)&&cM(n),_t=n[7]==="outlined"&&hM(n);const kt=n[63].leadingIcon,Ct=Ri(kt,n,n[86],sM);let Bt=[{id:I=n[11]+"-smui-selected-text"},{class:A=In({[n[19]]:!0,"mdc-select__selected-text":!0})},{role:"button"},{"aria-haspopup":"listbox"},{"aria-labelledby":L=n[11]+"-smui-label"},gi(n[53],"selectedText$")],Zn={};for(let ni=0;ni<Bt.length;ni+=1)Zn=zt(Zn,Bt[ni]);let mi=[{class:B=In({[n[17]]:!0,"mdc-select__selected-text-container":!0})},gi(n[53],"selectedTextContainer$")],yn={};for(let ni=0;ni<mi.length;ni+=1)yn=zt(yn,mi[ni]);let Pt=[{class:he=In({[n[21]]:!0,"mdc-select__dropdown-icon":!0})},gi(n[53],"dropdownIcon$")],Yn={};for(let ni=0;ni<Pt.length;ni+=1)Yn=zt(Yn,Pt[ni]);let si=n[7]!=="outlined"&&n[5]&&dM(n),Dr=[{class:De=In({[n[15]]:!0,"mdc-select__anchor":!0})},{"aria-required":fe=n[10]?"true":void 0},{"aria-disabled":le=n[6]?"true":void 0},{"aria-controls":n[30]},{"aria-describedby":n[30]},n[29],gi(n[53],"anchor$")],Ur={};for(let ni=0;ni<Dr.length;ni+=1)Ur=zt(Ur,Dr[ni]);const He=[{class:In({[n[22]]:!0,"mdc-select__menu":!0,...n[32]})},{fullWidth:!0},{anchor:!1},{anchorElement:n[33]},{anchorCorner:n[34]},gi(n[53],"menu$")];function Jt(ni){n[76](ni)}let ui={$$slots:{default:[JU]},$$scope:{ctx:n}};for(let ni=0;ni<He.length;ni+=1)ui=zt(ui,He[ni]);n[31]!==void 0&&(ui.open=n[31]),Ce=new TU({props:ui}),Sn.push(()=>Xr(Ce,"open",Jt)),Ce.$on("SMUIMenu:selected",n[77]),Ce.$on("SMUIMenuSurface:closing",n[78]),Ce.$on("SMUIMenuSurface:closed",n[79]),Ce.$on("SMUIMenuSurface:opened",n[80]);let $e=[{class:Et=In({[n[3]]:!0,"mdc-select":!0,"mdc-select--required":n[10],"mdc-select--disabled":n[6],"mdc-select--filled":n[7]==="filled","mdc-select--outlined":n[7]==="outlined","smui-select--standard":n[7]==="standard","mdc-select--with-leading-icon":n[44](n[13])?n[52].leadingIcon:n[13],"mdc-select--no-label":n[8]||n[9]==null&&!n[52].label,"mdc-select--invalid":n[1],"mdc-select--activated":n[31],"mdc-data-table__pagination-rows-per-page-select":n[45]==="data-table:pagination",...n[26]})},{style:Ue=Object.entries(n[27]).map(mM).concat([n[4]]).join(" ")},jo(n[53],["input$","anchor$","label$","outline$","selectedTextContainer$","selectedText$","dropdownIcon$","ripple$","menu$","list$","helperText$"])],kn={};for(let ni=0;ni<$e.length;ni+=1)kn=zt(kn,$e[ni]);let Ei=n[52].helperText&&pM(n);return{c(){e=qt("div"),vt&&vt.c(),t=vn(),i=qt("div"),xn&&xn.c(),r=vn(),En&&En.c(),a=vn(),_t&&_t.c(),l=vn(),Ct&&Ct.c(),s=vn(),d=qt("span"),g=qt("span"),x=_i(n[42]),z=vn(),V=qt("span"),Y=TE("svg"),Q=TE("polygon"),J=TE("polygon"),ae=vn(),si&&si.c(),Pe=vn(),sn(Ce.$$.fragment),Dt=vn(),Ei&&Ei.c(),fn=pi(),this.h()},l(ni){e=Wt(ni,"DIV",{class:!0,style:!0});var Ln=Qt(e);vt&&vt.l(Ln),t=bn(Ln),i=Wt(Ln,"DIV",{class:!0,"aria-required":!0,"aria-disabled":!0,"aria-controls":!0,"aria-describedby":!0});var ki=Qt(i);xn&&xn.l(ki),r=bn(ki),En&&En.l(ki),a=bn(ki),_t&&_t.l(ki),l=bn(ki),Ct&&Ct.l(ki),s=bn(ki),d=Wt(ki,"SPAN",{class:!0});var Hs=Qt(d);g=Wt(Hs,"SPAN",{id:!0,class:!0,role:!0,"aria-haspopup":!0,"aria-labelledby":!0});var Xt=Qt(g);x=yi(Xt,n[42]),Xt.forEach(de),Hs.forEach(de),z=bn(ki),V=Wt(ki,"SPAN",{class:!0});var Rn=Qt(V);Y=wE(Rn,"svg",{class:!0,viewBox:!0,focusable:!0});var ti=Qt(Y);Q=wE(ti,"polygon",{class:!0,stroke:!0,"fill-rule":!0,points:!0}),Qt(Q).forEach(de),J=wE(ti,"polygon",{class:!0,stroke:!0,"fill-rule":!0,points:!0}),Qt(J).forEach(de),ti.forEach(de),Rn.forEach(de),ae=bn(ki),si&&si.l(ki),ki.forEach(de),Pe=bn(Ln),dn(Ce.$$.fragment,Ln),Ln.forEach(de),Dt=bn(ni),Ei&&Ei.l(ni),fn=pi(),this.h()},h(){Xn(g,Zn),Xn(d,yn),tn(Q,"class","mdc-select__dropdown-icon-inactive"),tn(Q,"stroke","none"),tn(Q,"fill-rule","evenodd"),tn(Q,"points","7 10 12 15 17 10"),tn(J,"class","mdc-select__dropdown-icon-active"),tn(J,"stroke","none"),tn(J,"fill-rule","evenodd"),tn(J,"points","7 15 12 10 17 15"),tn(Y,"class","mdc-select__dropdown-icon-graphic"),tn(Y,"viewBox","7 10 10 5"),tn(Y,"focusable","false"),Xn(V,Yn),Xn(i,Ur),Xn(e,kn)},m(ni,Ln){tt(ni,e,Ln),vt&&vt.m(e,null),Kt(e,t),Kt(e,i),xn&&xn.m(i,null),Kt(i,r),En&&En.m(i,null),Kt(i,a),_t&&_t.m(i,null),Kt(i,l),Ct&&Ct.m(i,null),Kt(i,s),Kt(i,d),Kt(d,g),Kt(g,x),Kt(i,z),Kt(i,V),Kt(V,Y),Kt(Y,Q),Kt(Y,J),Kt(i,ae),si&&si.m(i,null),n[70](i),Kt(e,Pe),on(Ce,e,null),n[81](e),tt(ni,Dt,Ln),Ei&&Ei.m(ni,Ln),tt(ni,fn,Ln),Cn=!0,Gt||(Mt=[li(N=jr.call(null,g,n[18])),li(F=jr.call(null,d,n[16])),li(ee=jr.call(null,V,n[20])),li(Be=jr.call(null,i,n[14])),qn(i,"focus",n[71]),qn(i,"blur",n[72]),qn(i,"click",n[73]),qn(i,"keydown",function(){Gi(n[23]&&n[23].handleKeydown.bind(n[23]))&&(n[23]&&n[23].handleKeydown.bind(n[23])).apply(this,arguments)}),qn(i,"focus",n[64]),qn(i,"blur",n[65]),li(at=jc.call(null,e,{ripple:n[7]==="filled",unbounded:!1,addClass:n[49],removeClass:n[50],addStyle:n[51]})),li(bU.call(null,e,{addClass:n[49],removeClass:n[50]})),li(ke=jr.call(null,e,n[2])),li(n[43].call(null,e)),qn(e,"SMUISelectLeadingIcon:mount",n[48]),qn(e,"SMUISelectLeadingIcon:unmount",n[82])],Gt=!0)},p(ni,Ln){n=ni,n[12]?vt?vt.p(n,Ln):(vt=lM(n),vt.c(),vt.m(e,t)):vt&&(vt.d(1),vt=null),n[7]==="filled"?xn||(xn=uM(),xn.c(),xn.m(i,r)):xn&&(xn.d(1),xn=null),n[7]!=="outlined"&&!n[8]&&(n[9]!=null||n[52].label)?En?(En.p(n,Ln),Ln[0]&896|Ln[1]&2097152&&Te(En,1)):(En=cM(n),En.c(),Te(En,1),En.m(i,a)):En&&(Wi(),Ne(En,1,1,()=>{En=null}),Xi()),n[7]==="outlined"?_t?(_t.p(n,Ln),Ln[0]&128&&Te(_t,1)):(_t=hM(n),_t.c(),Te(_t,1),_t.m(i,l)):_t&&(Wi(),Ne(_t,1,1,()=>{_t=null}),Xi()),Ct&&Ct.p&&(!Cn||Ln[2]&16777216)&&Pi(Ct,kt,n,n[86],Cn?Oi(kt,n[86],Ln,jU):Di(n[86]),sM),(!Cn||Ln[1]&2048)&&ys(x,n[42]),Xn(g,Zn=hi(Bt,[(!Cn||Ln[0]&2048&&I!==(I=n[11]+"-smui-selected-text"))&&{id:I},(!Cn||Ln[0]&524288&&A!==(A=In({[n[19]]:!0,"mdc-select__selected-text":!0})))&&{class:A},{role:"button"},{"aria-haspopup":"listbox"},(!Cn||Ln[0]&2048&&L!==(L=n[11]+"-smui-label"))&&{"aria-labelledby":L},Ln[1]&4194304&&gi(n[53],"selectedText$")])),N&&Gi(N.update)&&Ln[0]&262144&&N.update.call(null,n[18]),Xn(d,yn=hi(mi,[(!Cn||Ln[0]&131072&&B!==(B=In({[n[17]]:!0,"mdc-select__selected-text-container":!0})))&&{class:B},Ln[1]&4194304&&gi(n[53],"selectedTextContainer$")])),F&&Gi(F.update)&&Ln[0]&65536&&F.update.call(null,n[16]),Xn(V,Yn=hi(Pt,[(!Cn||Ln[0]&2097152&&he!==(he=In({[n[21]]:!0,"mdc-select__dropdown-icon":!0})))&&{class:he},Ln[1]&4194304&&gi(n[53],"dropdownIcon$")])),ee&&Gi(ee.update)&&Ln[0]&1048576&&ee.update.call(null,n[20]),n[7]!=="outlined"&&n[5]?si?(si.p(n,Ln),Ln[0]&160&&Te(si,1)):(si=dM(n),si.c(),Te(si,1),si.m(i,null)):si&&(Wi(),Ne(si,1,1,()=>{si=null}),Xi()),Xn(i,Ur=hi(Dr,[(!Cn||Ln[0]&32768&&De!==(De=In({[n[15]]:!0,"mdc-select__anchor":!0})))&&{class:De},(!Cn||Ln[0]&1024&&fe!==(fe=n[10]?"true":void 0))&&{"aria-required":fe},(!Cn||Ln[0]&64&&le!==(le=n[6]?"true":void 0))&&{"aria-disabled":le},(!Cn||Ln[0]&1073741824)&&{"aria-controls":n[30]},(!Cn||Ln[0]&1073741824)&&{"aria-describedby":n[30]},Ln[0]&536870912&&n[29],Ln[1]&4194304&&gi(n[53],"anchor$")])),Be&&Gi(Be.update)&&Ln[0]&16384&&Be.update.call(null,n[14]);const ki=Ln[0]&4194304|Ln[1]&4194318?hi(He,[Ln[0]&4194304|Ln[1]&2&&{class:In({[n[22]]:!0,"mdc-select__menu":!0,...n[32]})},He[1],He[2],Ln[1]&4&&{anchorElement:n[33]},Ln[1]&8&&{anchorCorner:n[34]},Ln[1]&4194304&&Mr(gi(n[53],"menu$"))]):{};Ln[0]&16777216|Ln[1]&4194352|Ln[2]&16777216&&(ki.$$scope={dirty:Ln,ctx:n}),!it&&Ln[1]&1&&(it=!0,ki.open=n[31],Qr(()=>it=!1)),Ce.$set(ki),Xn(e,kn=hi($e,[(!Cn||Ln[0]&67119050|Ln[1]&2097153&&Et!==(Et=In({[n[3]]:!0,"mdc-select":!0,"mdc-select--required":n[10],"mdc-select--disabled":n[6],"mdc-select--filled":n[7]==="filled","mdc-select--outlined":n[7]==="outlined","smui-select--standard":n[7]==="standard","mdc-select--with-leading-icon":n[44](n[13])?n[52].leadingIcon:n[13],"mdc-select--no-label":n[8]||n[9]==null&&!n[52].label,"mdc-select--invalid":n[1],"mdc-select--activated":n[31],"mdc-data-table__pagination-rows-per-page-select":n[45]==="data-table:pagination",...n[26]})))&&{class:Et},(!Cn||Ln[0]&134217744&&Ue!==(Ue=Object.entries(n[27]).map(mM).concat([n[4]]).join(" ")))&&{style:Ue},Ln[1]&4194304&&jo(n[53],["input$","anchor$","label$","outline$","selectedTextContainer$","selectedText$","dropdownIcon$","ripple$","menu$","list$","helperText$"])])),at&&Gi(at.update)&&Ln[0]&128&&at.update.call(null,{ripple:n[7]==="filled",unbounded:!1,addClass:n[49],removeClass:n[50],addStyle:n[51]}),ke&&Gi(ke.update)&&Ln[0]&4&&ke.update.call(null,n[2]),n[52].helperText?Ei?(Ei.p(n,Ln),Ln[1]&2097152&&Te(Ei,1)):(Ei=pM(n),Ei.c(),Te(Ei,1),Ei.m(fn.parentNode,fn)):Ei&&(Wi(),Ne(Ei,1,1,()=>{Ei=null}),Xi())},i(ni){Cn||(Te(En),Te(_t),Te(Ct,ni),Te(si),Te(Ce.$$.fragment,ni),Te(Ei),Cn=!0)},o(ni){Ne(En),Ne(_t),Ne(Ct,ni),Ne(si),Ne(Ce.$$.fragment,ni),Ne(Ei),Cn=!1},d(ni){ni&&de(e),vt&&vt.d(),xn&&xn.d(),En&&En.d(),_t&&_t.d(),Ct&&Ct.d(ni),si&&si.d(),n[70](null),an(Ce),n[81](null),ni&&de(Dt),Ei&&Ei.d(ni),ni&&de(fn),Gt=!1,Ss(Mt)}}}let e8=0;function t8(n){const e=n.currentTarget.getBoundingClientRect();return(n8(n)?n.touches[0].clientX:n.clientX)-e.left}function n8(n){return"touches"in n}const mM=([n,e])=>`${n}: ${e};`;function i8(n,e,t){const i=["use","class","style","ripple","disabled","variant","noLabel","label","value","key","dirty","invalid","updateInvalid","required","inputId","hiddenInput","withLeadingIcon","anchor$use","anchor$class","selectedTextContainer$use","selectedTextContainer$class","selectedText$use","selectedText$class","dropdownIcon$use","dropdownIcon$class","menu$class","getUseDefaultValidation","setUseDefaultValidation","focus","layout","getElement"];let r=vi(e,i),a,l,{$$slots:s={},$$scope:d}=e;const g=uI(s),x=ps(ds());let I=()=>{};function A(Ye){return Ye===I}let{use:L=[]}=e,{class:N=""}=e,{style:B=""}=e,{ripple:F=!0}=e,{disabled:z=!1}=e,{variant:V="standard"}=e,{noLabel:Y=!1}=e,{label:Q=void 0}=e,{value:J=""}=e,{key:he=Ye=>Ye}=e,{dirty:ee=!1}=e,{invalid:ae=I}=e,{updateInvalid:De=A(ae)}=e;const fe=A(ae);A(ae)&&(ae=!1);let{required:le=!1}=e,{inputId:Be="SMUI-select-"+e8++}=e,{hiddenInput:Pe=!1}=e,{withLeadingIcon:Ce=I}=e,{anchor$use:it=[]}=e,{anchor$class:Et=""}=e,{selectedTextContainer$use:Ue=[]}=e,{selectedTextContainer$class:at=""}=e,{selectedText$use:ke=[]}=e,{selectedText$class:Dt=""}=e,{dropdownIcon$use:fn=[]}=e,{dropdownIcon$class:Cn=""}=e,{menu$class:Gt=""}=e,Mt,vt,xn={},En={},_t,kt={},Ct=-1,Bt,Zn=Fr("SMUI:addLayoutListener"),mi,yn=!1,Pt={},Yn,si,Dr=!1,Ur,He=Fr("SMUI:select:context"),Jt,ui,$e,kn,Ei;lr("SMUI:list:role",""),lr("SMUI:list:nav",!1);const ni=Eh("");Dl(n,ni,Ye=>t(42,a=Ye)),lr("SMUI:select:selectedText",ni);const Ln=Eh(J);Dl(n,Ln,Ye=>t(88,l=Ye)),lr("SMUI:select:value",Ln);let ki=Ct;Zn&&(mi=Zn(Vl)),ro(()=>(t(23,vt=new pU({setSelectedText:Ye=>{bf(ni,a=Ye,a)},isSelectAnchorFocused:()=>document.activeElement===_t,getSelectAnchorAttr:ca,setSelectAnchorAttr:Xo,removeSelectAnchorAttr:qs,addMenuClass:js,removeMenuClass:mo,openMenu:()=>{t(31,yn=!0)},closeMenu:()=>{t(31,yn=!1)},getAnchorElement:()=>_t,setMenuAnchorElement:Ye=>{t(33,Yn=Ye)},setMenuAnchorCorner:Ye=>{t(34,si=Ye)},setMenuWrapFocus:Ye=>{t(35,Dr=Ye)},getSelectedIndex:()=>Ct,setSelectedIndex:Ye=>{t(62,ki=Ye),t(24,Ct=Ye),t(0,J=No()[Ct])},focusMenuItemAtIndex:Ye=>{Ur.focusItemAtIndex(Ye)},getMenuItemCount:()=>Ur.items.length,getMenuItemValues:()=>No().map(he),getMenuItemTextAtIndex:Ye=>Ur.getPrimaryTextAtIndex(Ye),isTypeaheadInProgress:()=>Ur.typeaheadInProgress,typeaheadMatchItem:(Ye,Qn)=>Ur.typeaheadMatchItem(Ye,Qn),addClass:Rn,removeClass:ti,hasClass:Xt,setRippleCenter:Ye=>kn&&kn.setRippleCenter(Ye),activateBottomLine:()=>kn&&kn.activate(),deactivateBottomLine:()=>kn&&kn.deactivate(),notifyChange:Ye=>{t(54,ee=!0),De&&t(1,ae=!vt.isValid()),ji(Qa(),"SMUISelect:change",{value:J,index:Ct},void 0,!0)},hasOutline:()=>!!Ei,notchOutline:Ye=>Ei&&Ei.notch(Ye),closeOutline:()=>Ei&&Ei.closeNotch(),hasLabel:()=>!!$e,floatLabel:Ye=>$e&&$e.float(Ye),getLabelWidth:()=>$e?$e.getWidth():0,setLabelRequired:Ye=>$e&&$e.setRequired(Ye)},{get helperText(){return ui},get leadingIcon(){return Jt}})),t(24,Ct=No().indexOf(J)),vt.init(),go(fe),()=>{vt.destroy()})),Dh(()=>{mi&&mi()});function Hs(Ye){t(37,Jt=Ye.detail)}function Xt(Ye){return Ye in xn?xn[Ye]:Qa().classList.contains(Ye)}function Rn(Ye){xn[Ye]||t(26,xn[Ye]=!0,xn)}function ti(Ye){(!(Ye in xn)||xn[Ye])&&t(26,xn[Ye]=!1,xn)}function tr(Ye,Qn){En[Ye]!=Qn&&(Qn===""||Qn==null?(delete En[Ye],t(27,En)):t(27,En[Ye]=Qn,En))}function js(Ye){Pt[Ye]||t(32,Pt[Ye]=!0,Pt)}function mo(Ye){(!(Ye in Pt)||Pt[Ye])&&t(32,Pt[Ye]=!1,Pt)}function ca(Ye){var Qn;return Ye in kt?(Qn=kt[Ye])!==null&&Qn!==void 0?Qn:null:Qa().getAttribute(Ye)}function Xo(Ye,Qn){kt[Ye]!==Qn&&t(29,kt[Ye]=Qn,kt)}function qs(Ye){(!(Ye in kt)||kt[Ye]!=null)&&t(29,kt[Ye]=void 0,kt)}function No(){return Ur.getOrderedList().map(Ye=>Ye.getValue())}function Ja(){return vt.getUseDefaultValidation()}function go(Ye){vt.setUseDefaultValidation(Ye)}function Ma(){_t.focus()}function Vl(){vt.layout()}function Qa(){return Mt}function ha(Ye){iu.call(this,n,Ye)}function $a(Ye){iu.call(this,n,Ye)}function Zs(Ye){Sn[Ye?"unshift":"push"](()=>{$e=Ye,t(39,$e)})}function La(Ye){Sn[Ye?"unshift":"push"](()=>{$e=Ye,t(39,$e)})}function so(Ye){Sn[Ye?"unshift":"push"](()=>{Ei=Ye,t(41,Ei)})}function Ra(Ye){Sn[Ye?"unshift":"push"](()=>{kn=Ye,t(40,kn)})}function we(Ye){Sn[Ye?"unshift":"push"](()=>{_t=Ye,t(28,_t)})}const te=()=>vt&&vt.handleFocus(),re=()=>vt&&vt.handleBlur(),Ie=Ye=>{_t.focus(),vt&&vt.handleClick(t8(Ye))};function Oe(Ye){Ct=Ye,t(24,Ct)}const We=Ye=>t(36,Ur=Ye.detail);function ut(Ye){yn=Ye,t(31,yn)}const ot=Ye=>vt&&vt.handleMenuItemAction(Ye.detail.index),Je=()=>vt&&vt.handleMenuClosing(),pe=()=>vt&&vt.handleMenuClosed(),nt=()=>vt&&vt.handleMenuOpened();function be(Ye){Sn[Ye?"unshift":"push"](()=>{Mt=Ye,t(25,Mt)})}const Ot=()=>t(37,Jt=void 0),On=Ye=>t(30,Bt=Ye.detail),ii=Ye=>t(38,ui=Ye.detail),ei=()=>{t(30,Bt=void 0),t(38,ui=void 0)};return n.$$set=Ye=>{e=zt(zt({},e),ls(Ye)),t(53,r=vi(e,i)),"use"in Ye&&t(2,L=Ye.use),"class"in Ye&&t(3,N=Ye.class),"style"in Ye&&t(4,B=Ye.style),"ripple"in Ye&&t(5,F=Ye.ripple),"disabled"in Ye&&t(6,z=Ye.disabled),"variant"in Ye&&t(7,V=Ye.variant),"noLabel"in Ye&&t(8,Y=Ye.noLabel),"label"in Ye&&t(9,Q=Ye.label),"value"in Ye&&t(0,J=Ye.value),"key"in Ye&&t(55,he=Ye.key),"dirty"in Ye&&t(54,ee=Ye.dirty),"invalid"in Ye&&t(1,ae=Ye.invalid),"updateInvalid"in Ye&&t(56,De=Ye.updateInvalid),"required"in Ye&&t(10,le=Ye.required),"inputId"in Ye&&t(11,Be=Ye.inputId),"hiddenInput"in Ye&&t(12,Pe=Ye.hiddenInput),"withLeadingIcon"in Ye&&t(13,Ce=Ye.withLeadingIcon),"anchor$use"in Ye&&t(14,it=Ye.anchor$use),"anchor$class"in Ye&&t(15,Et=Ye.anchor$class),"selectedTextContainer$use"in Ye&&t(16,Ue=Ye.selectedTextContainer$use),"selectedTextContainer$class"in Ye&&t(17,at=Ye.selectedTextContainer$class),"selectedText$use"in Ye&&t(18,ke=Ye.selectedText$use),"selectedText$class"in Ye&&t(19,Dt=Ye.selectedText$class),"dropdownIcon$use"in Ye&&t(20,fn=Ye.dropdownIcon$use),"dropdownIcon$class"in Ye&&t(21,Cn=Ye.dropdownIcon$class),"menu$class"in Ye&&t(22,Gt=Ye.menu$class),"$$scope"in Ye&&t(86,d=Ye.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&25165825|n.$$.dirty[2]&1&&ki!==Ct)if(t(62,ki=Ct),vt)vt.setSelectedIndex(Ct,!1,!0);else{const Ye=No();J!==Ye[Ct]&&t(0,J=Ye[Ct])}n.$$.dirty[0]&1&&bf(Ln,l=J,l),n.$$.dirty[0]&8388609|n.$$.dirty[1]&16777216&&vt&&vt.getValue()!==he(J)&&vt.setValue(he(J)),n.$$.dirty[0]&8388672&&vt&&vt.getDisabled()!==z&&vt.setDisabled(z),n.$$.dirty[0]&8388610|n.$$.dirty[1]&41943040&&vt&&ee&&vt.isValid()!==!ae&&(De?t(1,ae=!vt.isValid()):vt.setValid(!ae)),n.$$.dirty[0]&8389632&&vt&&vt.getRequired()!==le&&vt.setRequired(le)},[J,ae,L,N,B,F,z,V,Y,Q,le,Be,Pe,Ce,it,Et,Ue,at,ke,Dt,fn,Cn,Gt,vt,Ct,Mt,xn,En,_t,kt,Bt,yn,Pt,Yn,si,Dr,Ur,Jt,ui,$e,kn,Ei,a,x,A,He,ni,Ln,Hs,Rn,ti,tr,g,r,ee,he,De,Ja,go,Ma,Vl,Qa,ki,s,ha,$a,Zs,La,so,Ra,we,te,re,Ie,Oe,We,ut,ot,Je,pe,nt,be,Ot,On,ii,ei,d]}class sI extends sr{constructor(e){super(),or(this,e,i8,$U,Qi,{use:2,class:3,style:4,ripple:5,disabled:6,variant:7,noLabel:8,label:9,value:0,key:55,dirty:54,invalid:1,updateInvalid:56,required:10,inputId:11,hiddenInput:12,withLeadingIcon:13,anchor$use:14,anchor$class:15,selectedTextContainer$use:16,selectedTextContainer$class:17,selectedText$use:18,selectedText$class:19,dropdownIcon$use:20,dropdownIcon$class:21,menu$class:22,getUseDefaultValidation:57,setUseDefaultValidation:58,focus:59,layout:60,getElement:61},null,[-1,-1,-1,-1])}get getUseDefaultValidation(){return this.$$.ctx[57]}get setUseDefaultValidation(){return this.$$.ctx[58]}get focus(){return this.$$.ctx[59]}get layout(){return this.$$.ctx[60]}get getElement(){return this.$$.ctx[61]}}function r8(n){let e;const t=n[11].default,i=Ri(t,n,n[13],null);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a&8192)&&Pi(i,t,r,r[13],e?Oi(t,r[13],a,null):Di(r[13]),null)},i(r){e||(Te(i,r),e=!0)},o(r){Ne(i,r),e=!1},d(r){i&&i.d(r)}}}function s8(n){let e,t;const i=[{use:n[3]},{"data-value":n[0]},{value:n[0]},{selected:n[2]},n[6]];let r={$$slots:{default:[r8]},$$scope:{ctx:n}};for(let a=0;a<i.length;a+=1)r=zt(r,i[a]);return e=new DU({props:r}),n[12](e),{c(){sn(e.$$.fragment)},l(a){dn(e.$$.fragment,a)},m(a,l){on(e,a,l),t=!0},p(a,[l]){const s=l&77?hi(i,[l&8&&{use:a[3]},l&1&&{"data-value":a[0]},l&1&&{value:a[0]},l&4&&{selected:a[2]},l&64&&Mr(a[6])]):{};l&8192&&(s.$$scope={dirty:l,ctx:a}),e.$set(s)},i(a){t||(Te(e.$$.fragment,a),t=!0)},o(a){Ne(e.$$.fragment,a),t=!1},d(a){n[12](null),an(e,a)}}}function o8(n,e,t){let i,r;const a=["use","class","value","getElement"];let l=vi(e,a),s,d,{$$slots:g={},$$scope:x}=e;const I=ps(ds());let{use:A=[]}=e;const L="";let{value:N=""}=e,B;const F=Fr("SMUI:select:selectedText");Dl(n,F,J=>t(14,s=J));const z=Fr("SMUI:select:value");Dl(n,z,J=>t(10,d=J)),lr("SMUI:list:item:role","option"),ro(V),Dh(V);function V(){r&&B&&bf(F,s=B.getPrimaryText(),s)}function Y(){return B.getElement()}function Q(J){Sn[J?"unshift":"push"](()=>{B=J,t(1,B)})}return n.$$set=J=>{e=zt(zt({},e),ls(J)),t(6,l=vi(e,a)),"use"in J&&t(7,A=J.use),"value"in J&&t(0,N=J.value),"$$scope"in J&&t(13,x=J.$$scope)},n.$$.update=()=>{n.$$.dirty&128&&t(3,i=[I,...A]),n.$$.dirty&1025&&t(2,r=N!=null&&N!==""&&d===N)},[N,B,r,i,F,z,l,A,L,Y,d,g,Q,x]}class Av extends sr{constructor(e){super(),or(this,e,o8,s8,Qi,{use:7,class:8,value:0,getElement:9})}get class(){return this.$$.ctx[8]}get getElement(){return this.$$.ctx[9]}}function gM(n,e,t){const i=n.slice();return i[9]=e[t],i}function a8(n){let e,t,i;function r(l){n[7](l)}let a={style:"width: 100%;",min:1,max:1e3,step:1};return n[1]!==void 0&&(a.value=n[1]),e=new QR({props:a}),Sn.push(()=>Xr(e,"value",r)),{c(){sn(e.$$.fragment)},l(l){dn(e.$$.fragment,l)},m(l,s){on(e,l,s),i=!0},p(l,s){const d={};!t&&s&2&&(t=!0,d.value=l[1],Qr(()=>t=!1)),e.$set(d)},i(l){i||(Te(e.$$.fragment,l),i=!0)},o(l){Ne(e.$$.fragment,l),i=!1},d(l){an(e,l)}}}function l8(n){let e,t,i;function r(l){n[6](l)}let a={style:"width: 100%;",min:1,max:50,step:1};return n[1]!==void 0&&(a.value=n[1]),e=new QR({props:a}),Sn.push(()=>Xr(e,"value",r)),{c(){sn(e.$$.fragment)},l(l){dn(e.$$.fragment,l)},m(l,s){on(e,l,s),i=!0},p(l,s){const d={};!t&&s&2&&(t=!0,d.value=l[1],Qr(()=>t=!1)),e.$set(d)},i(l){i||(Te(e.$$.fragment,l),i=!0)},o(l){Ne(e.$$.fragment,l),i=!1},d(l){an(e,l)}}}function u8(n){let e=n[9].charAt(0).toUpperCase()+n[9].slice(1)+"",t;return{c(){t=_i(e)},l(i){t=yi(i,e)},m(i,r){tt(i,t,r)},p:_l,d(i){i&&de(t)}}}function _M(n){let e,t;return e=new Av({props:{value:n[9],$$slots:{default:[u8]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,r){on(e,i,r),t=!0},p(i,r){const a={};r&4096&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Te(e.$$.fragment,i),t=!0)},o(i){Ne(e.$$.fragment,i),t=!1},d(i){an(e,i)}}}function c8(n){let e,t,i=n[2],r=[];for(let l=0;l<i.length;l+=1)r[l]=_M(gM(n,i,l));const a=l=>Ne(r[l],1,1,()=>{r[l]=null});return{c(){for(let l=0;l<r.length;l+=1)r[l].c();e=pi()},l(l){for(let s=0;s<r.length;s+=1)r[s].l(l);e=pi()},m(l,s){for(let d=0;d<r.length;d+=1)r[d]&&r[d].m(l,s);tt(l,e,s),t=!0},p(l,s){if(s&4){i=l[2];let d;for(d=0;d<i.length;d+=1){const g=gM(l,i,d);r[d]?(r[d].p(g,s),Te(r[d],1)):(r[d]=_M(g),r[d].c(),Te(r[d],1),r[d].m(e.parentNode,e))}for(Wi(),d=i.length;d<r.length;d+=1)a(d);Xi()}},i(l){if(!t){for(let s=0;s<i.length;s+=1)Te(r[s]);t=!0}},o(l){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)Ne(r[s]);t=!1},d(l){vm(r,l),l&&de(e)}}}function h8(n){let e,t,i,r,a,l=n[1].toFixed(0)+"",s,d,g,x,I,A,L;const N=[l8,a8],B=[];function F(Y,Q){return Y[0]==="kilometers"?0:Y[0]==="meters"?1:-1}~(t=F(n))&&(i=B[t]=N[t](n));function z(Y){n[8](Y)}let V={label:"Unit: ",$$slots:{default:[c8]},$$scope:{ctx:n}};return n[0]!==void 0&&(V.value=n[0]),g=new sI({props:V}),Sn.push(()=>Xr(g,"value",z)),{c(){e=qt("span"),i&&i.c(),r=vn(),a=qt("p"),s=_i(l),d=vn(),sn(g.$$.fragment),I=vn(),A=qt("span"),this.h()},l(Y){e=Wt(Y,"SPAN",{style:!0});var Q=Qt(e);i&&i.l(Q),r=bn(Q),a=Wt(Q,"P",{});var J=Qt(a);s=yi(J,l),J.forEach(de),Q.forEach(de),d=bn(Y),dn(g.$$.fragment,Y),I=bn(Y),A=Wt(Y,"SPAN",{style:!0}),Qt(A).forEach(de),this.h()},h(){wa(e,"display","flex"),wa(e,"align-items","center"),wa(A,"margin-top","20px")},m(Y,Q){tt(Y,e,Q),~t&&B[t].m(e,null),Kt(e,r),Kt(e,a),Kt(a,s),tt(Y,d,Q),on(g,Y,Q),tt(Y,I,Q),tt(Y,A,Q),L=!0},p(Y,[Q]){let J=t;t=F(Y),t===J?~t&&B[t].p(Y,Q):(i&&(Wi(),Ne(B[J],1,1,()=>{B[J]=null}),Xi()),~t?(i=B[t],i?i.p(Y,Q):(i=B[t]=N[t](Y),i.c()),Te(i,1),i.m(e,r)):i=null),(!L||Q&2)&&l!==(l=Y[1].toFixed(0)+"")&&ys(s,l);const he={};Q&4096&&(he.$$scope={dirty:Q,ctx:Y}),!x&&Q&1&&(x=!0,he.value=Y[0],Qr(()=>x=!1)),g.$set(he)},i(Y){L||(Te(i),Te(g.$$.fragment,Y),L=!0)},o(Y){Ne(i),Ne(g.$$.fragment,Y),L=!1},d(Y){Y&&de(e),~t&&B[t].d(),Y&&de(d),an(g,Y),Y&&de(I),Y&&de(A)}}}function f8(n,e,t){let{updateOptions:i}=e;const r=["meters","kilometers"];let a="kilometers",l=1,s=l.toString(),d=s;function g(A){l=A,t(1,l),t(4,s),t(5,d),t(3,i),t(0,a)}function x(A){l=A,t(1,l),t(4,s),t(5,d),t(3,i),t(0,a)}function I(A){a=A,t(0,a)}return n.$$set=A=>{"updateOptions"in A&&t(3,i=A.updateOptions)},n.$$.update=()=>{n.$$.dirty&59&&(s&&s!==d&&t(1,l=parseInt(s)),t(4,s=l.toString()),t(5,d=s),i({args:{radius:l,units:a}}))},[a,l,r,i,s,d,g,x,I]}class d8 extends sr{constructor(e){super(),or(this,e,f8,h8,Qi,{updateOptions:3})}}function yM(n,e,t){const i=n.slice();return i[7]=e[t],i}function vM(n,e,t){const i=n.slice();return i[7]=e[t],i}function p8(n){let e=n[7].displayName+"",t;return{c(){t=_i(e)},l(i){t=yi(i,e)},m(i,r){tt(i,t,r)},p(i,r){r&8&&e!==(e=i[7].displayName+"")&&ys(t,e)},d(i){i&&de(t)}}}function bM(n){let e,t;return e=new Av({props:{value:n[7].id,$$slots:{default:[p8]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,r){on(e,i,r),t=!0},p(i,r){const a={};r&8&&(a.value=i[7].id),r&4104&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Te(e.$$.fragment,i),t=!0)},o(i){Ne(e.$$.fragment,i),t=!1},d(i){an(e,i)}}}function m8(n){let e,t,i=n[3],r=[];for(let l=0;l<i.length;l+=1)r[l]=bM(vM(n,i,l));const a=l=>Ne(r[l],1,1,()=>{r[l]=null});return{c(){for(let l=0;l<r.length;l+=1)r[l].c();e=pi()},l(l){for(let s=0;s<r.length;s+=1)r[s].l(l);e=pi()},m(l,s){for(let d=0;d<r.length;d+=1)r[d]&&r[d].m(l,s);tt(l,e,s),t=!0},p(l,s){if(s&8){i=l[3];let d;for(d=0;d<i.length;d+=1){const g=vM(l,i,d);r[d]?(r[d].p(g,s),Te(r[d],1)):(r[d]=bM(g),r[d].c(),Te(r[d],1),r[d].m(e.parentNode,e))}for(Wi(),d=i.length;d<r.length;d+=1)a(d);Xi()}},i(l){if(!t){for(let s=0;s<i.length;s+=1)Te(r[s]);t=!0}},o(l){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)Ne(r[s]);t=!1},d(l){vm(r,l),l&&de(e)}}}function g8(n){let e=n[7].displayName+"",t;return{c(){t=_i(e)},l(i){t=yi(i,e)},m(i,r){tt(i,t,r)},p(i,r){r&4&&e!==(e=i[7].displayName+"")&&ys(t,e)},d(i){i&&de(t)}}}function xM(n){let e,t;return e=new Av({props:{value:n[7].id,$$slots:{default:[g8]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,r){on(e,i,r),t=!0},p(i,r){const a={};r&4&&(a.value=i[7].id),r&4100&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Te(e.$$.fragment,i),t=!0)},o(i){Ne(e.$$.fragment,i),t=!1},d(i){an(e,i)}}}function _8(n){let e,t,i=n[2],r=[];for(let l=0;l<i.length;l+=1)r[l]=xM(yM(n,i,l));const a=l=>Ne(r[l],1,1,()=>{r[l]=null});return{c(){for(let l=0;l<r.length;l+=1)r[l].c();e=pi()},l(l){for(let s=0;s<r.length;s+=1)r[s].l(l);e=pi()},m(l,s){for(let d=0;d<r.length;d+=1)r[d]&&r[d].m(l,s);tt(l,e,s),t=!0},p(l,s){if(s&4){i=l[2];let d;for(d=0;d<i.length;d+=1){const g=yM(l,i,d);r[d]?(r[d].p(g,s),Te(r[d],1)):(r[d]=xM(g),r[d].c(),Te(r[d],1),r[d].m(e.parentNode,e))}for(Wi(),d=i.length;d<r.length;d+=1)a(d);Xi()}},i(l){if(!t){for(let s=0;s<i.length;s+=1)Te(r[s]);t=!0}},o(l){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)Ne(r[s]);t=!1},d(l){vm(r,l),l&&de(e)}}}function y8(n){let e,t,i,r,a,l,s,d;function g(L){n[5](L)}let x={label:"Layer A",$$slots:{default:[m8]},$$scope:{ctx:n}};n[0]!==void 0&&(x.value=n[0]),e=new sI({props:x}),Sn.push(()=>Xr(e,"value",g));function I(L){n[6](L)}let A={label:"Layer B",$$slots:{default:[_8]},$$scope:{ctx:n}};return n[1]!==void 0&&(A.value=n[1]),r=new sI({props:A}),Sn.push(()=>Xr(r,"value",I)),{c(){sn(e.$$.fragment),i=vn(),sn(r.$$.fragment),l=vn(),s=qt("span"),this.h()},l(L){dn(e.$$.fragment,L),i=bn(L),dn(r.$$.fragment,L),l=bn(L),s=Wt(L,"SPAN",{style:!0}),Qt(s).forEach(de),this.h()},h(){wa(s,"margin-top","20px")},m(L,N){on(e,L,N),tt(L,i,N),on(r,L,N),tt(L,l,N),tt(L,s,N),d=!0},p(L,[N]){const B={};N&4104&&(B.$$scope={dirty:N,ctx:L}),!t&&N&1&&(t=!0,B.value=L[0],Qr(()=>t=!1)),e.$set(B);const F={};N&4100&&(F.$$scope={dirty:N,ctx:L}),!a&&N&2&&(a=!0,F.value=L[1],Qr(()=>a=!1)),r.$set(F)},i(L){d||(Te(e.$$.fragment,L),Te(r.$$.fragment,L),d=!0)},o(L){Ne(e.$$.fragment,L),Ne(r.$$.fragment,L),d=!1},d(L){an(e,L),L&&de(i),an(r,L),L&&de(l),L&&de(s)}}}function v8(n,e,t){let i,r,{updateOptions:a}=e,l,s;function d(x){l=x,t(0,l)}function g(x){s=x,t(1,s)}return n.$$set=x=>{"updateOptions"in x&&t(4,a=x.updateOptions)},n.$$.update=()=>{n.$$.dirty&2&&t(3,i=ap(Lo).filter(x=>x.id!==s)),n.$$.dirty&1&&t(2,r=ap(Lo).filter(x=>x.id!==l)),n.$$.dirty&19&&a({args:{layerA:ap(Lo).find(x=>x.id===l),layerB:ap(Lo).find(x=>x.id===s)},layerSelection:ap(Lo).filter(x=>[l,s].includes(x.id))})},[l,s,r,i,a,d,g]}class b8 extends sr{constructor(e){super(),or(this,e,v8,y8,Qi,{updateOptions:4})}}function x8(n){let e;return{c(){e=_i("arrow_forward")},l(t){e=yi(t,"arrow_forward")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function E8(n){let e;return{c(){e=_i("mode_edit")},l(t){e=yi(t,"mode_edit")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function I8(n){let e,t,i,r,a,l,s,d,g,x;return a=new MS({props:{class:"material-icons",on:!0,$$slots:{default:[x8]},$$scope:{ctx:n}}}),d=new xf({props:{class:"material-icons",$$slots:{default:[E8]},$$scope:{ctx:n}}}),d.$on("click",n[1]),{c(){e=qt("div"),t=qt("h4"),i=_i("Draw bounding box"),r=vn(),sn(a.$$.fragment),l=vn(),s=qt("span"),sn(d.$$.fragment),this.h()},l(I){e=Wt(I,"DIV",{style:!0});var A=Qt(e);t=Wt(A,"H4",{});var L=Qt(t);i=yi(L,"Draw bounding box"),L.forEach(de),r=bn(A),dn(a.$$.fragment,A),l=bn(A),s=Wt(A,"SPAN",{class:!0});var N=Qt(s);dn(d.$$.fragment,N),N.forEach(de),A.forEach(de),this.h()},h(){tn(s,"class",g=TC(n[0]?"drawing":"")+" svelte-1pq5lgy"),wa(e,"display","flex"),wa(e,"align-items","center")},m(I,A){tt(I,e,A),Kt(e,t),Kt(t,i),Kt(e,r),on(a,e,null),Kt(e,l),Kt(e,s),on(d,s,null),x=!0},p(I,[A]){const L={};A&64&&(L.$$scope={dirty:A,ctx:I}),a.$set(L);const N={};A&64&&(N.$$scope={dirty:A,ctx:I}),d.$set(N),(!x||A&1&&g!==(g=TC(I[0]?"drawing":"")+" svelte-1pq5lgy"))&&tn(s,"class",g)},i(I){x||(Te(a.$$.fragment,I),Te(d.$$.fragment,I),x=!0)},o(I){Ne(a.$$.fragment,I),Ne(d.$$.fragment,I),x=!1},d(I){I&&de(e),an(a),an(d)}}}function T8(n,e,t){let{updateOptions:i}=e,{map:r}=e,{draw:a}=e,l=a.getMode()==="draw_rectangle",s;function d(){a.getMode()==="draw_rectangle"?a.changeMode("simple_select"):a.changeMode("draw_rectangle"),t(0,l=!l)}return r.on("draw.create",g=>{const x=g.features[0];!bp(x)||!zc(x.geometry)||(t(5,s={id:x.id,bbox:cg(x.geometry)}),t(0,l=!l))}),n.$$set=g=>{"updateOptions"in g&&t(2,i=g.updateOptions),"map"in g&&t(3,r=g.map),"draw"in g&&t(4,a=g.draw)},n.$$.update=()=>{n.$$.dirty&52&&s&&i({args:{bbox:s.bbox}},()=>{a.delete(s.id),console.log(a.getAll())})},[l,d,i,r,a,s]}class w8 extends sr{constructor(e){super(),or(this,e,T8,I8,Qi,{updateOptions:2,map:3,draw:4})}}function S8(n){let e;return{c(){e=_i("Draw new BBox")},l(t){e=yi(t,"Draw new BBox")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function C8(n){let e,t;return e=new j_({props:{$$slots:{default:[S8]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,r){on(e,i,r),t=!0},p(i,r){const a={};r&128&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Te(e.$$.fragment,i),t=!0)},o(i){Ne(e.$$.fragment,i),t=!1},d(i){an(e,i)}}}function A8(n){let e,t,i,r;function a(s){n[5](s)}let l={variant:"unelevated",$$slots:{default:[C8]},$$scope:{ctx:n}};return n[0]!==void 0&&(l.disabled=n[0]),t=new cp({props:l}),Sn.push(()=>Xr(t,"disabled",a)),t.$on("click",n[6]),{c(){e=qt("span"),sn(t.$$.fragment),this.h()},l(s){e=Wt(s,"SPAN",{class:!0});var d=Qt(e);dn(t.$$.fragment,d),d.forEach(de),this.h()},h(){tn(e,"class","draw-btn svelte-1big6lk")},m(s,d){tt(s,e,d),on(t,e,null),r=!0},p(s,[d]){const g={};d&128&&(g.$$scope={dirty:d,ctx:s}),!i&&d&1&&(i=!0,g.disabled=s[0],Qr(()=>i=!1)),t.$set(g)},i(s){r||(Te(t.$$.fragment,s),r=!0)},o(s){Ne(t.$$.fragment,s),r=!1},d(s){s&&de(e),an(t)}}}function M8(n,e,t){let{updateOptions:i}=e,{map:r}=e,{draw:a}=e,l=!0,s;r.on("draw.create",x=>{const I=x.features[0];!bp(I)||!zc(I.geometry)||(s&&a.delete(s.id),t(4,s={id:I.id,bbox:cg(I.geometry)}),t(0,l=!1))});function d(x){l=x,t(0,l)}const g=()=>{t(0,l=!0)};return n.$$set=x=>{"updateOptions"in x&&t(1,i=x.updateOptions),"map"in x&&t(2,r=x.map),"draw"in x&&t(3,a=x.draw)},n.$$.update=()=>{n.$$.dirty&9&&(l?a.changeMode("draw_rectangle"):a.changeMode("simple_select")),n.$$.dirty&26&&s&&i({args:{bbox:s.bbox}},()=>{a.delete(s.id)})},[l,i,r,a,s,d,g]}class L8 extends sr{constructor(e){super(),or(this,e,M8,A8,Qi,{updateOptions:1,map:2,draw:3})}}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var R8={ACTIVE:"mdc-tab-indicator--active",FADE:"mdc-tab-indicator--fade",NO_TRANSITION:"mdc-tab-indicator--no-transition"},P8={CONTENT_SELECTOR:".mdc-tab-indicator__content"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var om=function(n){Wo(e,n);function e(t){return n.call(this,zr(zr({},e.defaultAdapter),t))||this}return Object.defineProperty(e,"cssClasses",{get:function(){return R8},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return P8},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},computeContentClientRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},setContentStyleProperty:function(){}}},enumerable:!1,configurable:!0}),e.prototype.computeContentClientRect=function(){return this.adapter.computeContentClientRect()},e}(xl);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var D8=function(n){Wo(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.activate=function(){this.adapter.addClass(om.cssClasses.ACTIVE)},e.prototype.deactivate=function(){this.adapter.removeClass(om.cssClasses.ACTIVE)},e}(om);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var EM=function(n){Wo(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.activate=function(t){if(!t){this.adapter.addClass(om.cssClasses.ACTIVE);return}var i=this.computeContentClientRect(),r=t.width/i.width,a=t.left-i.left;this.adapter.addClass(om.cssClasses.NO_TRANSITION),this.adapter.setContentStyleProperty("transform","translateX("+a+"px) scaleX("+r+")"),this.computeContentClientRect(),this.adapter.removeClass(om.cssClasses.NO_TRANSITION),this.adapter.addClass(om.cssClasses.ACTIVE),this.adapter.setContentStyleProperty("transform","")},e.prototype.deactivate=function(){this.adapter.removeClass(om.cssClasses.ACTIVE)},e}(om);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var bE={ACTIVE:"mdc-tab--active"},C1={ARIA_SELECTED:"aria-selected",CONTENT_SELECTOR:".mdc-tab__content",INTERACTED_EVENT:"MDCTab:interacted",RIPPLE_SELECTOR:".mdc-tab__ripple",TABINDEX:"tabIndex",TAB_INDICATOR_SELECTOR:".mdc-tab-indicator"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var O8=function(n){Wo(e,n);function e(t){var i=n.call(this,zr(zr({},e.defaultAdapter),t))||this;return i.focusOnActivate=!0,i}return Object.defineProperty(e,"cssClasses",{get:function(){return bE},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return C1},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setAttr:function(){},activateIndicator:function(){},deactivateIndicator:function(){},notifyInteracted:function(){},getOffsetLeft:function(){return 0},getOffsetWidth:function(){return 0},getContentOffsetLeft:function(){return 0},getContentOffsetWidth:function(){return 0},focus:function(){}}},enumerable:!1,configurable:!0}),e.prototype.handleClick=function(){this.adapter.notifyInteracted()},e.prototype.isActive=function(){return this.adapter.hasClass(bE.ACTIVE)},e.prototype.setFocusOnActivate=function(t){this.focusOnActivate=t},e.prototype.activate=function(t){this.adapter.addClass(bE.ACTIVE),this.adapter.setAttr(C1.ARIA_SELECTED,"true"),this.adapter.setAttr(C1.TABINDEX,"0"),this.adapter.activateIndicator(t),this.focusOnActivate&&this.adapter.focus()},e.prototype.deactivate=function(){this.isActive()&&(this.adapter.removeClass(bE.ACTIVE),this.adapter.setAttr(C1.ARIA_SELECTED,"false"),this.adapter.setAttr(C1.TABINDEX,"-1"),this.adapter.deactivateIndicator())},e.prototype.computeDimensions=function(){var t=this.adapter.getOffsetWidth(),i=this.adapter.getOffsetLeft(),r=this.adapter.getContentOffsetWidth(),a=this.adapter.getContentOffsetLeft();return{contentLeft:i+a,contentRight:i+a+r,rootLeft:i,rootRight:i+t}},e}(xl);function N8(n){let e,t,i,r,a,l,s,d,g,x,I;const A=n[21].default,L=Ri(A,n,n[20],null);let N=[{class:i=In({[n[6]]:!0,"mdc-tab-indicator__content":!0,"mdc-tab-indicator__content--underline":n[3]==="underline","mdc-tab-indicator__content--icon":n[3]==="icon"})},{style:r=Object.entries(n[10]).map(IM).join(" ")},{"aria-hidden":a=n[3]==="icon"?"true":void 0},gi(n[12],"content$")],B={};for(let V=0;V<N.length;V+=1)B=zt(B,N[V]);let F=[{class:s=In({[n[2]]:!0,"mdc-tab-indicator":!0,"mdc-tab-indicator--active":n[0],"mdc-tab-indicator--fade":n[4]==="fade",...n[9]})},jo(n[12],["content$"])],z={};for(let V=0;V<F.length;V+=1)z=zt(z,F[V]);return{c(){e=qt("span"),t=qt("span"),L&&L.c(),this.h()},l(V){e=Wt(V,"SPAN",{class:!0});var Y=Qt(e);t=Wt(Y,"SPAN",{class:!0,style:!0,"aria-hidden":!0});var Q=Qt(t);L&&L.l(Q),Q.forEach(de),Y.forEach(de),this.h()},h(){Xn(t,B),Xn(e,z)},m(V,Y){tt(V,e,Y),Kt(e,t),L&&L.m(t,null),n[22](t),n[23](e),g=!0,x||(I=[li(l=jr.call(null,t,n[5])),li(d=jr.call(null,e,n[1])),li(n[11].call(null,e))],x=!0)},p(V,[Y]){L&&L.p&&(!g||Y&1048576)&&Pi(L,A,V,V[20],g?Oi(A,V[20],Y,null):Di(V[20]),null),Xn(t,B=hi(N,[(!g||Y&72&&i!==(i=In({[V[6]]:!0,"mdc-tab-indicator__content":!0,"mdc-tab-indicator__content--underline":V[3]==="underline","mdc-tab-indicator__content--icon":V[3]==="icon"})))&&{class:i},(!g||Y&1024&&r!==(r=Object.entries(V[10]).map(IM).join(" ")))&&{style:r},(!g||Y&8&&a!==(a=V[3]==="icon"?"true":void 0))&&{"aria-hidden":a},Y&4096&&gi(V[12],"content$")])),l&&Gi(l.update)&&Y&32&&l.update.call(null,V[5]),Xn(e,z=hi(F,[(!g||Y&533&&s!==(s=In({[V[2]]:!0,"mdc-tab-indicator":!0,"mdc-tab-indicator--active":V[0],"mdc-tab-indicator--fade":V[4]==="fade",...V[9]})))&&{class:s},Y&4096&&jo(V[12],["content$"])])),d&&Gi(d.update)&&Y&2&&d.update.call(null,V[1])},i(V){g||(Te(L,V),g=!0)},o(V){Ne(L,V),g=!1},d(V){V&&de(e),L&&L.d(V),n[22](null),n[23](null),x=!1,Ss(I)}}}const IM=([n,e])=>`${n}: ${e};`;function k8(n,e,t){const i=["use","class","active","type","transition","content$use","content$class","activate","deactivate","computeContentClientRect","getElement"];let r=vi(e,i),{$$slots:a={},$$scope:l}=e;const s=ps(ds());let{use:d=[]}=e,{class:g=""}=e,{active:x=!1}=e,{type:I="underline"}=e,{transition:A="slide"}=e,{content$use:L=[]}=e,{content$class:N=""}=e,B,F,z,V={},Y={},Q=[],J=A;ro(()=>(t(17,F=he()),F.init(),()=>{F.destroy()}));function he(){const Ue={fade:D8,slide:EM}[A]||EM;return new Ue({addClass:(...at)=>ee(()=>ae(...at)),removeClass:(...at)=>ee(()=>De(...at)),computeContentClientRect:Pe,setContentStyleProperty:(...at)=>ee(()=>fe(...at))})}function ee(Ue){Q.length?Q[Q.length-1].push(Ue):Ue()}function ae(Ue){V[Ue]||t(9,V[Ue]=!0,V)}function De(Ue){(!(Ue in V)||V[Ue])&&t(9,V[Ue]=!1,V)}function fe(Ue,at){Y[Ue]!=at&&(at===""||at==null?(delete Y[Ue],t(10,Y),t(19,J),t(4,A),t(17,F)):t(10,Y[Ue]=at,Y))}function le(Ue){t(0,x=!0),F.activate(Ue)}function Be(){t(0,x=!1),F.deactivate()}function Pe(){return Q.push([]),t(18,Q),z.getBoundingClientRect()}function Ce(){return B}function it(Ue){Sn[Ue?"unshift":"push"](()=>{z=Ue,t(8,z)})}function Et(Ue){Sn[Ue?"unshift":"push"](()=>{B=Ue,t(7,B)})}return n.$$set=Ue=>{e=zt(zt({},e),ls(Ue)),t(12,r=vi(e,i)),"use"in Ue&&t(1,d=Ue.use),"class"in Ue&&t(2,g=Ue.class),"active"in Ue&&t(0,x=Ue.active),"type"in Ue&&t(3,I=Ue.type),"transition"in Ue&&t(4,A=Ue.transition),"content$use"in Ue&&t(5,L=Ue.content$use),"content$class"in Ue&&t(6,N=Ue.content$class),"$$scope"in Ue&&t(20,l=Ue.$$scope)},n.$$.update=()=>{n.$$.dirty&655376&&J!==A&&(t(19,J=A),F&&F.destroy(),t(9,V={}),t(10,Y={}),t(17,F=he()),F.init()),n.$$.dirty&262144&&Q.length&&requestAnimationFrame(()=>{var Ue;const at=(Ue=Q.shift())!==null&&Ue!==void 0?Ue:[];t(18,Q);for(const ke of at)ke()})},[x,d,g,I,A,L,N,B,z,V,Y,s,r,le,Be,Pe,Ce,F,Q,J,l,a,it,Et]}class nP extends sr{constructor(e){super(),or(this,e,k8,N8,Qi,{use:1,class:2,active:0,type:3,transition:4,content$use:5,content$class:6,activate:13,deactivate:14,computeContentClientRect:15,getElement:16})}get activate(){return this.$$.ctx[13]}get deactivate(){return this.$$.ctx[14]}get computeContentClientRect(){return this.$$.ctx[15]}get getElement(){return this.$$.ctx[16]}}const F8=n=>({}),TM=n=>({}),B8=n=>({}),wM=n=>({});function SM(n){let e,t;const i=[{active:n[18]},gi(n[25],"tabIndicator$")];let r={$$slots:{default:[z8]},$$scope:{ctx:n}};for(let a=0;a<i.length;a+=1)r=zt(r,i[a]);return e=new nP({props:r}),n[33](e),{c(){sn(e.$$.fragment)},l(a){dn(e.$$.fragment,a)},m(a,l){on(e,a,l),t=!0},p(a,l){const s=l[0]&33816576?hi(i,[l[0]&262144&&{active:a[18]},l[0]&33554432&&Mr(gi(a[25],"tabIndicator$"))]):{};l[1]&64&&(s.$$scope={dirty:l,ctx:a}),e.$set(s)},i(a){t||(Te(e.$$.fragment,a),t=!0)},o(a){Ne(e.$$.fragment,a),t=!1},d(a){n[33](null),an(e,a)}}}function z8(n){let e;const t=n[32]["tab-indicator"],i=Ri(t,n,n[37],wM);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a[1]&64)&&Pi(i,t,r,r[37],e?Oi(t,r[37],a,B8):Di(r[37]),wM)},i(r){e||(Te(i,r),e=!0)},o(r){Ne(i,r),e=!1},d(r){i&&i.d(r)}}}function CM(n){let e,t;const i=[{active:n[18]},gi(n[25],"tabIndicator$")];let r={$$slots:{default:[U8]},$$scope:{ctx:n}};for(let a=0;a<i.length;a+=1)r=zt(r,i[a]);return e=new nP({props:r}),n[35](e),{c(){sn(e.$$.fragment)},l(a){dn(e.$$.fragment,a)},m(a,l){on(e,a,l),t=!0},p(a,l){const s=l[0]&33816576?hi(i,[l[0]&262144&&{active:a[18]},l[0]&33554432&&Mr(gi(a[25],"tabIndicator$"))]):{};l[1]&64&&(s.$$scope={dirty:l,ctx:a}),e.$set(s)},i(a){t||(Te(e.$$.fragment,a),t=!0)},o(a){Ne(e.$$.fragment,a),t=!1},d(a){n[35](null),an(e,a)}}}function U8(n){let e;const t=n[32]["tab-indicator"],i=Ri(t,n,n[37],TM);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a[1]&64)&&Pi(i,t,r,r[37],e?Oi(t,r[37],a,F8):Di(r[37]),TM)},i(r){e||(Te(i,r),e=!0)},o(r){Ne(i,r),e=!1},d(r){i&&i.d(r)}}}function V8(n){let e,t,i,r,a,l,s,d,g,x;const I=n[32].default,A=Ri(I,n,n[37],null);let L=n[6]&&SM(n),N=[{class:i=In({[n[9]]:!0,"mdc-tab__content":!0})},gi(n[25],"content$")],B={};for(let z=0;z<N.length;z+=1)B=zt(B,N[z]);let F=!n[6]&&CM(n);return{c(){e=qt("span"),A&&A.c(),t=vn(),L&&L.c(),a=vn(),F&&F.c(),l=vn(),s=qt("span"),this.h()},l(z){e=Wt(z,"SPAN",{class:!0});var V=Qt(e);A&&A.l(V),t=bn(V),L&&L.l(V),V.forEach(de),a=bn(z),F&&F.l(z),l=bn(z),s=Wt(z,"SPAN",{class:!0}),Qt(s).forEach(de),this.h()},h(){Xn(e,B),tn(s,"class","mdc-tab__ripple")},m(z,V){tt(z,e,V),A&&A.m(e,null),Kt(e,t),L&&L.m(e,null),n[34](e),tt(z,a,V),F&&F.m(z,V),tt(z,l,V),tt(z,s,V),d=!0,g||(x=li(r=jr.call(null,e,n[8])),g=!0)},p(z,V){A&&A.p&&(!d||V[1]&64)&&Pi(A,I,z,z[37],d?Oi(I,z[37],V,null):Di(z[37]),null),z[6]?L?(L.p(z,V),V[0]&64&&Te(L,1)):(L=SM(z),L.c(),Te(L,1),L.m(e,null)):L&&(Wi(),Ne(L,1,1,()=>{L=null}),Xi()),Xn(e,B=hi(N,[(!d||V[0]&512&&i!==(i=In({[z[9]]:!0,"mdc-tab__content":!0})))&&{class:i},V[0]&33554432&&gi(z[25],"content$")])),r&&Gi(r.update)&&V[0]&256&&r.update.call(null,z[8]),z[6]?F&&(Wi(),Ne(F,1,1,()=>{F=null}),Xi()):F?(F.p(z,V),V[0]&64&&Te(F,1)):(F=CM(z),F.c(),Te(F,1),F.m(l.parentNode,l))},i(z){d||(Te(A,z),Te(L),Te(F),d=!0)},o(z){Ne(A,z),Ne(L),Ne(F),d=!1},d(z){z&&de(e),A&&A.d(z),L&&L.d(),n[34](null),z&&de(a),F&&F.d(z),z&&de(l),z&&de(s),g=!1,x()}}}function G8(n){let e,t,i;const r=[{tag:n[11]},{use:[[jc,{ripple:n[3],unbounded:!1,addClass:n[21],removeClass:n[22],addStyle:n[23]}],n[20],...n[0]]},{class:In({[n[1]]:!0,"mdc-tab":!0,"mdc-tab--active":n[18],"mdc-tab--stacked":n[4],"mdc-tab--min-width":n[5],...n[15]})},{style:Object.entries(n[16]).map(AM).concat([n[2]]).join(" ")},{role:"tab"},{"aria-selected":n[18]?"true":"false"},{tabindex:n[18]||n[19]?"0":"-1"},{href:n[7]},n[17],jo(n[25],["content$","tabIndicator$"])];var a=n[10];function l(s){let d={$$slots:{default:[V8]},$$scope:{ctx:s}};for(let g=0;g<r.length;g+=1)d=zt(d,r[g]);return{props:d}}return a&&(e=Xa(a,l(n)),n[36](e),e.$on("click",n[24])),{c(){e&&sn(e.$$.fragment),t=pi()},l(s){e&&dn(e.$$.fragment,s),t=pi()},m(s,d){e&&on(e,s,d),tt(s,t,d),i=!0},p(s,d){const g=d[0]&50301119?hi(r,[d[0]&2048&&{tag:s[11]},d[0]&15728649&&{use:[[jc,{ripple:s[3],unbounded:!1,addClass:s[21],removeClass:s[22],addStyle:s[23]}],s[20],...s[0]]},d[0]&294962&&{class:In({[s[1]]:!0,"mdc-tab":!0,"mdc-tab--active":s[18],"mdc-tab--stacked":s[4],"mdc-tab--min-width":s[5],...s[15]})},d[0]&65540&&{style:Object.entries(s[16]).map(AM).concat([s[2]]).join(" ")},r[4],d[0]&262144&&{"aria-selected":s[18]?"true":"false"},d[0]&786432&&{tabindex:s[18]||s[19]?"0":"-1"},d[0]&128&&{href:s[7]},d[0]&131072&&Mr(s[17]),d[0]&33554432&&Mr(jo(s[25],["content$","tabIndicator$"]))]):{};if(d[0]&33841984|d[1]&64&&(g.$$scope={dirty:d,ctx:s}),d[0]&1024&&a!==(a=s[10])){if(e){Wi();const x=e;Ne(x.$$.fragment,1,0,()=>{an(x,1)}),Xi()}a?(e=Xa(a,l(s)),s[36](e),e.$on("click",s[24]),sn(e.$$.fragment),Te(e.$$.fragment,1),on(e,t.parentNode,t)):e=null}else a&&e.$set(g)},i(s){i||(e&&Te(e.$$.fragment,s),i=!0)},o(s){e&&Ne(e.$$.fragment,s),i=!1},d(s){n[36](null),s&&de(t),e&&an(e,s)}}}const AM=([n,e])=>`${n}: ${e};`;function H8(n,e,t){const i=["use","class","style","tab","ripple","stacked","minWidth","indicatorSpanOnlyContent","href","content$use","content$class","component","tag","activate","deactivate","focus","getElement"];let r=vi(e,i),{$$slots:a={},$$scope:l}=e;const s=ps(ds());let{use:d=[]}=e,{class:g=""}=e,{style:x=""}=e,{tab:I}=e,{ripple:A=!0}=e,{stacked:L=!1}=e,{minWidth:N=!1}=e,{indicatorSpanOnlyContent:B=!1}=e,{href:F=void 0}=e,{content$use:z=[]}=e,{content$class:V=""}=e,Y,Q,J,he,ee={},ae={},De={},fe=Fr("SMUI:tab:focusOnActivate"),le=I===Fr("SMUI:tab:initialActive"),Be=!1,{component:Pe=Cu}=e,{tag:Ce=Pe===Cu?F==null?"button":"a":void 0}=e;if(lr("SMUI:label:context","tab"),lr("SMUI:icon:context","tab"),!I)throw new Error("The tab property is required! It should be passed down from the TabBar to the Tab.");ro(()=>{t(31,Q=new O8({setAttr:ke,addClass:Et,removeClass:Ue,hasClass:it,activateIndicator:Ct=>he.activate(Ct),deactivateIndicator:()=>he.deactivate(),notifyInteracted:()=>ji(Mt(),"SMUITab:interacted",{tabId:I},void 0,!0),getOffsetLeft:()=>Mt().offsetLeft,getOffsetWidth:()=>Mt().offsetWidth,getContentOffsetLeft:()=>J.offsetLeft,getContentOffsetWidth:()=>J.offsetWidth,focus:Gt}));const kt={tabId:I,get element(){return Mt()},get active(){return le},forceAccessible(Ct){t(19,Be=Ct)},computeIndicatorClientRect:()=>he.computeContentClientRect(),computeDimensions:()=>Q.computeDimensions(),focus:Gt,activate:fn,deactivate:Cn};return ji(Mt(),"SMUITab:mount",kt),Q.init(),()=>{ji(Mt(),"SMUITab:unmount",kt),Q.destroy()}});function it(kt){return kt in ee?ee[kt]:Mt().classList.contains(kt)}function Et(kt){ee[kt]||t(15,ee[kt]=!0,ee)}function Ue(kt){(!(kt in ee)||ee[kt])&&t(15,ee[kt]=!1,ee)}function at(kt,Ct){ae[kt]!=Ct&&(Ct===""||Ct==null?(delete ae[kt],t(16,ae)):t(16,ae[kt]=Ct,ae))}function ke(kt,Ct){De[kt]!==Ct&&t(17,De[kt]=Ct,De)}function Dt(kt){!kt.defaultPrevented&&Q&&Q.handleClick()}function fn(kt,Ct){t(18,le=!0),Ct&&Q.setFocusOnActivate(!1),Q.activate(kt),Ct&&Q.setFocusOnActivate(fe)}function Cn(){t(18,le=!1),Q.deactivate()}function Gt(){Mt().focus()}function Mt(){return Y.getElement()}function vt(kt){Sn[kt?"unshift":"push"](()=>{he=kt,t(14,he)})}function xn(kt){Sn[kt?"unshift":"push"](()=>{J=kt,t(13,J)})}function En(kt){Sn[kt?"unshift":"push"](()=>{he=kt,t(14,he)})}function _t(kt){Sn[kt?"unshift":"push"](()=>{Y=kt,t(12,Y)})}return n.$$set=kt=>{e=zt(zt({},e),ls(kt)),t(25,r=vi(e,i)),"use"in kt&&t(0,d=kt.use),"class"in kt&&t(1,g=kt.class),"style"in kt&&t(2,x=kt.style),"tab"in kt&&t(26,I=kt.tab),"ripple"in kt&&t(3,A=kt.ripple),"stacked"in kt&&t(4,L=kt.stacked),"minWidth"in kt&&t(5,N=kt.minWidth),"indicatorSpanOnlyContent"in kt&&t(6,B=kt.indicatorSpanOnlyContent),"href"in kt&&t(7,F=kt.href),"content$use"in kt&&t(8,z=kt.content$use),"content$class"in kt&&t(9,V=kt.content$class),"component"in kt&&t(10,Pe=kt.component),"tag"in kt&&t(11,Ce=kt.tag),"$$scope"in kt&&t(37,l=kt.$$scope)},n.$$.update=()=>{n.$$.dirty[1]&1&&Q&&Q.setFocusOnActivate(fe)},[d,g,x,A,L,N,B,F,z,V,Pe,Ce,Y,J,he,ee,ae,De,le,Be,s,Et,Ue,at,Dt,r,I,fn,Cn,Gt,Mt,Q,a,vt,xn,En,_t,l]}class j8 extends sr{constructor(e){super(),or(this,e,H8,G8,Qi,{use:0,class:1,style:2,tab:26,ripple:3,stacked:4,minWidth:5,indicatorSpanOnlyContent:6,href:7,content$use:8,content$class:9,component:10,tag:11,activate:27,deactivate:28,focus:29,getElement:30},null,[-1,-1])}get activate(){return this.$$.ctx[27]}get deactivate(){return this.$$.ctx[28]}get focus(){return this.$$.ctx[29]}get getElement(){return this.$$.ctx[30]}}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var iP={ANIMATING:"mdc-tab-scroller--animating",SCROLL_AREA_SCROLL:"mdc-tab-scroller__scroll-area--scroll",SCROLL_TEST:"mdc-tab-scroller__test"},q8={AREA_SELECTOR:".mdc-tab-scroller__scroll-area",CONTENT_SELECTOR:".mdc-tab-scroller__scroll-content"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var iC=function(){function n(e){this.adapter=e}return n}();/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var W8=function(n){Wo(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getScrollPositionRTL=function(){var t=this.adapter.getScrollAreaScrollLeft(),i=this.calculateScrollEdges().right;return Math.round(i-t)},e.prototype.scrollToRTL=function(t){var i=this.calculateScrollEdges(),r=this.adapter.getScrollAreaScrollLeft(),a=this.clampScrollValue(i.right-t);return{finalScrollPosition:a,scrollDelta:a-r}},e.prototype.incrementScrollRTL=function(t){var i=this.adapter.getScrollAreaScrollLeft(),r=this.clampScrollValue(i-t);return{finalScrollPosition:r,scrollDelta:r-i}},e.prototype.getAnimatingScrollPosition=function(t){return t},e.prototype.calculateScrollEdges=function(){var t=this.adapter.getScrollContentOffsetWidth(),i=this.adapter.getScrollAreaOffsetWidth();return{left:0,right:t-i}},e.prototype.clampScrollValue=function(t){var i=this.calculateScrollEdges();return Math.min(Math.max(i.left,t),i.right)},e}(iC);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var X8=function(n){Wo(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getScrollPositionRTL=function(t){var i=this.adapter.getScrollAreaScrollLeft();return Math.round(t-i)},e.prototype.scrollToRTL=function(t){var i=this.adapter.getScrollAreaScrollLeft(),r=this.clampScrollValue(-t);return{finalScrollPosition:r,scrollDelta:r-i}},e.prototype.incrementScrollRTL=function(t){var i=this.adapter.getScrollAreaScrollLeft(),r=this.clampScrollValue(i-t);return{finalScrollPosition:r,scrollDelta:r-i}},e.prototype.getAnimatingScrollPosition=function(t,i){return t-i},e.prototype.calculateScrollEdges=function(){var t=this.adapter.getScrollContentOffsetWidth(),i=this.adapter.getScrollAreaOffsetWidth();return{left:i-t,right:0}},e.prototype.clampScrollValue=function(t){var i=this.calculateScrollEdges();return Math.max(Math.min(i.right,t),i.left)},e}(iC);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Z8=function(n){Wo(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getScrollPositionRTL=function(t){var i=this.adapter.getScrollAreaScrollLeft();return Math.round(i-t)},e.prototype.scrollToRTL=function(t){var i=this.adapter.getScrollAreaScrollLeft(),r=this.clampScrollValue(t);return{finalScrollPosition:r,scrollDelta:i-r}},e.prototype.incrementScrollRTL=function(t){var i=this.adapter.getScrollAreaScrollLeft(),r=this.clampScrollValue(i+t);return{finalScrollPosition:r,scrollDelta:i-r}},e.prototype.getAnimatingScrollPosition=function(t,i){return t+i},e.prototype.calculateScrollEdges=function(){var t=this.adapter.getScrollContentOffsetWidth(),i=this.adapter.getScrollAreaOffsetWidth();return{left:t-i,right:0}},e.prototype.clampScrollValue=function(t){var i=this.calculateScrollEdges();return Math.min(Math.max(i.right,t),i.left)},e}(iC);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Y8=function(n){Wo(e,n);function e(t){var i=n.call(this,zr(zr({},e.defaultAdapter),t))||this;return i.isAnimating=!1,i}return Object.defineProperty(e,"cssClasses",{get:function(){return iP},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return q8},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{eventTargetMatchesSelector:function(){return!1},addClass:function(){},removeClass:function(){},addScrollAreaClass:function(){},setScrollAreaStyleProperty:function(){},setScrollContentStyleProperty:function(){},getScrollContentStyleValue:function(){return""},setScrollAreaScrollLeft:function(){},getScrollAreaScrollLeft:function(){return 0},getScrollContentOffsetWidth:function(){return 0},getScrollAreaOffsetWidth:function(){return 0},computeScrollAreaClientRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},computeScrollContentClientRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},computeHorizontalScrollbarHeight:function(){return 0}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){var t=this.adapter.computeHorizontalScrollbarHeight();this.adapter.setScrollAreaStyleProperty("margin-bottom",-t+"px"),this.adapter.addScrollAreaClass(e.cssClasses.SCROLL_AREA_SCROLL)},e.prototype.getScrollPosition=function(){if(this.isRTL())return this.computeCurrentScrollPositionRTL();var t=this.calculateCurrentTranslateX(),i=this.adapter.getScrollAreaScrollLeft();return i-t},e.prototype.handleInteraction=function(){this.isAnimating&&this.stopScrollAnimation()},e.prototype.handleTransitionEnd=function(t){var i=t.target;!this.isAnimating||!this.adapter.eventTargetMatchesSelector(i,e.strings.CONTENT_SELECTOR)||(this.isAnimating=!1,this.adapter.removeClass(e.cssClasses.ANIMATING))},e.prototype.incrementScroll=function(t){t!==0&&this.animate(this.getIncrementScrollOperation(t))},e.prototype.incrementScrollImmediate=function(t){if(t!==0){var i=this.getIncrementScrollOperation(t);i.scrollDelta!==0&&(this.stopScrollAnimation(),this.adapter.setScrollAreaScrollLeft(i.finalScrollPosition))}},e.prototype.scrollTo=function(t){if(this.isRTL()){this.scrollToImplRTL(t);return}this.scrollToImpl(t)},e.prototype.getRTLScroller=function(){return this.rtlScrollerInstance||(this.rtlScrollerInstance=this.rtlScrollerFactory()),this.rtlScrollerInstance},e.prototype.calculateCurrentTranslateX=function(){var t=this.adapter.getScrollContentStyleValue("transform");if(t==="none")return 0;var i=/\((.+?)\)/.exec(t);if(!i)return 0;var r=i[1],a=Xw(r.split(","),6);a[0],a[1],a[2],a[3];var l=a[4];return a[5],parseFloat(l)},e.prototype.clampScrollValue=function(t){var i=this.calculateScrollEdges();return Math.min(Math.max(i.left,t),i.right)},e.prototype.computeCurrentScrollPositionRTL=function(){var t=this.calculateCurrentTranslateX();return this.getRTLScroller().getScrollPositionRTL(t)},e.prototype.calculateScrollEdges=function(){var t=this.adapter.getScrollContentOffsetWidth(),i=this.adapter.getScrollAreaOffsetWidth();return{left:0,right:t-i}},e.prototype.scrollToImpl=function(t){var i=this.getScrollPosition(),r=this.clampScrollValue(t),a=r-i;this.animate({finalScrollPosition:r,scrollDelta:a})},e.prototype.scrollToImplRTL=function(t){var i=this.getRTLScroller().scrollToRTL(t);this.animate(i)},e.prototype.getIncrementScrollOperation=function(t){if(this.isRTL())return this.getRTLScroller().incrementScrollRTL(t);var i=this.getScrollPosition(),r=t+i,a=this.clampScrollValue(r),l=a-i;return{finalScrollPosition:a,scrollDelta:l}},e.prototype.animate=function(t){var i=this;t.scrollDelta!==0&&(this.stopScrollAnimation(),this.adapter.setScrollAreaScrollLeft(t.finalScrollPosition),this.adapter.setScrollContentStyleProperty("transform","translateX("+t.scrollDelta+"px)"),this.adapter.computeScrollAreaClientRect(),requestAnimationFrame(function(){i.adapter.addClass(e.cssClasses.ANIMATING),i.adapter.setScrollContentStyleProperty("transform","none")}),this.isAnimating=!0)},e.prototype.stopScrollAnimation=function(){this.isAnimating=!1;var t=this.getAnimatingScrollPosition();this.adapter.removeClass(e.cssClasses.ANIMATING),this.adapter.setScrollContentStyleProperty("transform","translateX(0px)"),this.adapter.setScrollAreaScrollLeft(t)},e.prototype.getAnimatingScrollPosition=function(){var t=this.calculateCurrentTranslateX(),i=this.adapter.getScrollAreaScrollLeft();return this.isRTL()?this.getRTLScroller().getAnimatingScrollPosition(i,t):i-t},e.prototype.rtlScrollerFactory=function(){var t=this.adapter.getScrollAreaScrollLeft();this.adapter.setScrollAreaScrollLeft(t-1);var i=this.adapter.getScrollAreaScrollLeft();if(i<0)return this.adapter.setScrollAreaScrollLeft(t),new X8(this.adapter);var r=this.adapter.computeScrollAreaClientRect(),a=this.adapter.computeScrollContentClientRect(),l=Math.round(a.right-r.right);return this.adapter.setScrollAreaScrollLeft(t),l===i?new Z8(this.adapter):new W8(this.adapter)},e.prototype.isRTL=function(){return this.adapter.getScrollContentStyleValue("direction")==="rtl"},e}(xl);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Hw;function K8(n,e){if(e===void 0&&(e=!0),e&&typeof Hw<"u")return Hw;var t=n.createElement("div");t.classList.add(iP.SCROLL_TEST),n.body.appendChild(t);var i=t.offsetHeight-t.clientHeight;return n.body.removeChild(t),e&&(Hw=i),i}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Ga={ARROW_LEFT_KEY:"ArrowLeft",ARROW_RIGHT_KEY:"ArrowRight",END_KEY:"End",ENTER_KEY:"Enter",HOME_KEY:"Home",SPACE_KEY:"Space",TAB_ACTIVATED_EVENT:"MDCTabBar:activated",TAB_SCROLLER_SELECTOR:".mdc-tab-scroller",TAB_SELECTOR:".mdc-tab"},hd={ARROW_LEFT_KEYCODE:37,ARROW_RIGHT_KEYCODE:39,END_KEYCODE:35,ENTER_KEYCODE:13,EXTRA_SCROLL_AMOUNT:20,HOME_KEYCODE:36,SPACE_KEYCODE:32};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var K_=new Set;K_.add(Ga.ARROW_LEFT_KEY);K_.add(Ga.ARROW_RIGHT_KEY);K_.add(Ga.END_KEY);K_.add(Ga.HOME_KEY);K_.add(Ga.ENTER_KEY);K_.add(Ga.SPACE_KEY);var J_=new Map;J_.set(hd.ARROW_LEFT_KEYCODE,Ga.ARROW_LEFT_KEY);J_.set(hd.ARROW_RIGHT_KEYCODE,Ga.ARROW_RIGHT_KEY);J_.set(hd.END_KEYCODE,Ga.END_KEY);J_.set(hd.HOME_KEYCODE,Ga.HOME_KEY);J_.set(hd.ENTER_KEYCODE,Ga.ENTER_KEY);J_.set(hd.SPACE_KEYCODE,Ga.SPACE_KEY);var J8=function(n){Wo(e,n);function e(t){var i=n.call(this,zr(zr({},e.defaultAdapter),t))||this;return i.useAutomaticActivation=!1,i}return Object.defineProperty(e,"strings",{get:function(){return Ga},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return hd},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{scrollTo:function(){},incrementScroll:function(){},getScrollPosition:function(){return 0},getScrollContentWidth:function(){return 0},getOffsetWidth:function(){return 0},isRTL:function(){return!1},setActiveTab:function(){},activateTabAtIndex:function(){},deactivateTabAtIndex:function(){},focusTabAtIndex:function(){},getTabIndicatorClientRectAtIndex:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},getTabDimensionsAtIndex:function(){return{rootLeft:0,rootRight:0,contentLeft:0,contentRight:0}},getPreviousActiveTabIndex:function(){return-1},getFocusedTabIndex:function(){return-1},getIndexOfTabById:function(){return-1},getTabListLength:function(){return 0},notifyTabActivated:function(){}}},enumerable:!1,configurable:!0}),e.prototype.setUseAutomaticActivation=function(t){this.useAutomaticActivation=t},e.prototype.activateTab=function(t){var i=this.adapter.getPreviousActiveTabIndex();if(!(!this.indexIsInRange(t)||t===i)){var r;i!==-1&&(this.adapter.deactivateTabAtIndex(i),r=this.adapter.getTabIndicatorClientRectAtIndex(i)),this.adapter.activateTabAtIndex(t,r),this.scrollIntoView(t),this.adapter.notifyTabActivated(t)}},e.prototype.handleKeyDown=function(t){var i=this.getKeyFromEvent(t);if(i!==void 0)if(this.isActivationKey(i)||t.preventDefault(),this.useAutomaticActivation){if(this.isActivationKey(i))return;var r=this.determineTargetFromKey(this.adapter.getPreviousActiveTabIndex(),i);this.adapter.setActiveTab(r),this.scrollIntoView(r)}else{var a=this.adapter.getFocusedTabIndex();if(this.isActivationKey(i))this.adapter.setActiveTab(a);else{var r=this.determineTargetFromKey(a,i);this.adapter.focusTabAtIndex(r),this.scrollIntoView(r)}}},e.prototype.handleTabInteraction=function(t){this.adapter.setActiveTab(this.adapter.getIndexOfTabById(t.detail.tabId))},e.prototype.scrollIntoView=function(t){if(this.indexIsInRange(t)){if(t===0){this.adapter.scrollTo(0);return}if(t===this.adapter.getTabListLength()-1){this.adapter.scrollTo(this.adapter.getScrollContentWidth());return}if(this.isRTL()){this.scrollIntoViewImplRTL(t);return}this.scrollIntoViewImpl(t)}},e.prototype.determineTargetFromKey=function(t,i){var r=this.isRTL(),a=this.adapter.getTabListLength()-1,l=i===Ga.END_KEY,s=i===Ga.ARROW_LEFT_KEY&&!r||i===Ga.ARROW_RIGHT_KEY&&r,d=i===Ga.ARROW_RIGHT_KEY&&!r||i===Ga.ARROW_LEFT_KEY&&r,g=t;return l?g=a:s?g-=1:d?g+=1:g=0,g<0?g=a:g>a&&(g=0),g},e.prototype.calculateScrollIncrement=function(t,i,r,a){var l=this.adapter.getTabDimensionsAtIndex(i),s=l.contentLeft-r-a,d=l.contentRight-r,g=d-hd.EXTRA_SCROLL_AMOUNT,x=s+hd.EXTRA_SCROLL_AMOUNT;return i<t?Math.min(g,0):Math.max(x,0)},e.prototype.calculateScrollIncrementRTL=function(t,i,r,a,l){var s=this.adapter.getTabDimensionsAtIndex(i),d=l-s.contentLeft-r,g=l-s.contentRight-r-a,x=g+hd.EXTRA_SCROLL_AMOUNT,I=d-hd.EXTRA_SCROLL_AMOUNT;return i>t?Math.max(x,0):Math.min(I,0)},e.prototype.findAdjacentTabIndexClosestToEdge=function(t,i,r,a){var l=i.rootLeft-r,s=i.rootRight-r-a,d=l+s,g=l<0||d<0,x=s>0||d>0;return g?t-1:x?t+1:-1},e.prototype.findAdjacentTabIndexClosestToEdgeRTL=function(t,i,r,a,l){var s=l-i.rootLeft-a-r,d=l-i.rootRight-r,g=s+d,x=s>0||g>0,I=d<0||g<0;return x?t+1:I?t-1:-1},e.prototype.getKeyFromEvent=function(t){return K_.has(t.key)?t.key:J_.get(t.keyCode)},e.prototype.isActivationKey=function(t){return t===Ga.SPACE_KEY||t===Ga.ENTER_KEY},e.prototype.indexIsInRange=function(t){return t>=0&&t<this.adapter.getTabListLength()},e.prototype.isRTL=function(){return this.adapter.isRTL()},e.prototype.scrollIntoViewImpl=function(t){var i=this.adapter.getScrollPosition(),r=this.adapter.getOffsetWidth(),a=this.adapter.getTabDimensionsAtIndex(t),l=this.findAdjacentTabIndexClosestToEdge(t,a,i,r);if(this.indexIsInRange(l)){var s=this.calculateScrollIncrement(t,l,i,r);this.adapter.incrementScroll(s)}},e.prototype.scrollIntoViewImplRTL=function(t){var i=this.adapter.getScrollPosition(),r=this.adapter.getOffsetWidth(),a=this.adapter.getTabDimensionsAtIndex(t),l=this.adapter.getScrollContentWidth(),s=this.findAdjacentTabIndexClosestToEdgeRTL(t,a,i,r,l);if(this.indexIsInRange(s)){var d=this.calculateScrollIncrementRTL(t,s,i,r,l);this.adapter.incrementScroll(d)}},e}(xl);function Q8(n){let e,t,i,r,a,l,s,d,g,x,I,A,L,N;const B=n[23].default,F=Ri(B,n,n[22],null);let z=[{class:r=In({[n[6]]:!0,"mdc-tab-scroller__scroll-content":!0})},{style:a=Object.entries(n[14]).map(MM).join(" ")},gi(n[16],"scrollContent$")],V={};for(let ee=0;ee<z.length;ee+=1)V=zt(V,z[ee]);let Y=[{class:s=In({[n[4]]:!0,"mdc-tab-scroller__scroll-area":!0,...n[12]})},{style:d=Object.entries(n[13]).map(LM).join(" ")},gi(n[16],"scrollArea$")],Q={};for(let ee=0;ee<Y.length;ee+=1)Q=zt(Q,Y[ee]);let J=[{class:x=In({[n[1]]:!0,"mdc-tab-scroller":!0,"mdc-tab-scroller--align-start":n[2]==="start","mdc-tab-scroller--align-end":n[2]==="end","mdc-tab-scroller--align-center":n[2]==="center",...n[11]})},jo(n[16],["scrollArea$","scrollContent$"])],he={};for(let ee=0;ee<J.length;ee+=1)he=zt(he,J[ee]);return{c(){e=qt("div"),t=qt("div"),i=qt("div"),F&&F.c(),this.h()},l(ee){e=Wt(ee,"DIV",{class:!0});var ae=Qt(e);t=Wt(ae,"DIV",{class:!0,style:!0});var De=Qt(t);i=Wt(De,"DIV",{class:!0,style:!0});var fe=Qt(i);F&&F.l(fe),fe.forEach(de),De.forEach(de),ae.forEach(de),this.h()},h(){Xn(i,V),Xn(t,Q),Xn(e,he)},m(ee,ae){tt(ee,e,ae),Kt(e,t),Kt(t,i),F&&F.m(i,null),n[24](i),n[26](t),n[32](e),A=!0,L||(N=[li(l=jr.call(null,i,n[5])),qn(i,"transitionend",n[25]),li(g=jr.call(null,t,n[3])),qn(t,"wheel",n[27],{passive:!0}),qn(t,"touchstart",n[28],{passive:!0}),qn(t,"pointerdown",n[29]),qn(t,"mousedown",n[30]),qn(t,"keydown",n[31]),li(I=jr.call(null,e,n[0])),li(n[15].call(null,e))],L=!0)},p(ee,ae){F&&F.p&&(!A||ae[0]&4194304)&&Pi(F,B,ee,ee[22],A?Oi(B,ee[22],ae,null):Di(ee[22]),null),Xn(i,V=hi(z,[(!A||ae[0]&64&&r!==(r=In({[ee[6]]:!0,"mdc-tab-scroller__scroll-content":!0})))&&{class:r},(!A||ae[0]&16384&&a!==(a=Object.entries(ee[14]).map(MM).join(" ")))&&{style:a},ae[0]&65536&&gi(ee[16],"scrollContent$")])),l&&Gi(l.update)&&ae[0]&32&&l.update.call(null,ee[5]),Xn(t,Q=hi(Y,[(!A||ae[0]&4112&&s!==(s=In({[ee[4]]:!0,"mdc-tab-scroller__scroll-area":!0,...ee[12]})))&&{class:s},(!A||ae[0]&8192&&d!==(d=Object.entries(ee[13]).map(LM).join(" ")))&&{style:d},ae[0]&65536&&gi(ee[16],"scrollArea$")])),g&&Gi(g.update)&&ae[0]&8&&g.update.call(null,ee[3]),Xn(e,he=hi(J,[(!A||ae[0]&2054&&x!==(x=In({[ee[1]]:!0,"mdc-tab-scroller":!0,"mdc-tab-scroller--align-start":ee[2]==="start","mdc-tab-scroller--align-end":ee[2]==="end","mdc-tab-scroller--align-center":ee[2]==="center",...ee[11]})))&&{class:x},ae[0]&65536&&jo(ee[16],["scrollArea$","scrollContent$"])])),I&&Gi(I.update)&&ae[0]&1&&I.update.call(null,ee[0])},i(ee){A||(Te(F,ee),A=!0)},o(ee){Ne(F,ee),A=!1},d(ee){ee&&de(e),F&&F.d(ee),n[24](null),n[26](null),n[32](null),L=!1,Ss(N)}}}const MM=([n,e])=>`${n}: ${e};`,LM=([n,e])=>`${n}: ${e};`;function $8(n,e,t){const i=["use","class","align","scrollArea$use","scrollArea$class","scrollContent$use","scrollContent$class","getScrollPosition","getScrollContentWidth","incrementScroll","scrollTo","getElement"];let r=vi(e,i),{$$slots:a={},$$scope:l}=e;const{matches:s}=r0,d=ps(ds());let{use:g=[]}=e,{class:x=""}=e,{align:I=void 0}=e,{scrollArea$use:A=[]}=e,{scrollArea$class:L=""}=e,{scrollContent$use:N=[]}=e,{scrollContent$class:B=""}=e,F,z,V,Y,Q={},J={},he={},ee={};ro(()=>(t(8,z=new Y8({eventTargetMatchesSelector:(_t,kt)=>s(_t,kt),addClass:ae,removeClass:De,addScrollAreaClass:fe,setScrollAreaStyleProperty:le,setScrollContentStyleProperty:Be,getScrollContentStyleValue:Pe,setScrollAreaScrollLeft:_t=>t(9,V.scrollLeft=_t,V),getScrollAreaScrollLeft:()=>V.scrollLeft,getScrollContentOffsetWidth:()=>Y.offsetWidth,getScrollAreaOffsetWidth:()=>V.offsetWidth,computeScrollAreaClientRect:()=>V.getBoundingClientRect(),computeScrollContentClientRect:()=>Y.getBoundingClientRect(),computeHorizontalScrollbarHeight:()=>K8(document)})),z.init(),()=>{z.destroy()}));function ae(_t){Q[_t]||t(11,Q[_t]=!0,Q)}function De(_t){(!(_t in Q)||Q[_t])&&t(11,Q[_t]=!1,Q)}function fe(_t){J[_t]||t(12,J[_t]=!0,J)}function le(_t,kt){he[_t]!=kt&&(kt===""||kt==null?(delete he[_t],t(13,he)):t(13,he[_t]=kt,he))}function Be(_t,kt){ee[_t]!=kt&&(kt===""||kt==null?(delete ee[_t],t(14,ee)):t(14,ee[_t]=kt,ee))}function Pe(_t){return _t in ee?ee[_t]:getComputedStyle(Y).getPropertyValue(_t)}function Ce(){return z.getScrollPosition()}function it(){return Y.offsetWidth}function Et(_t){z.incrementScroll(_t)}function Ue(_t){z.scrollTo(_t)}function at(){return F}function ke(_t){Sn[_t?"unshift":"push"](()=>{Y=_t,t(10,Y)})}const Dt=_t=>z&&z.handleTransitionEnd(_t);function fn(_t){Sn[_t?"unshift":"push"](()=>{V=_t,t(9,V)})}const Cn=()=>z&&z.handleInteraction(),Gt=()=>z&&z.handleInteraction(),Mt=()=>z&&z.handleInteraction(),vt=()=>z&&z.handleInteraction(),xn=()=>z&&z.handleInteraction();function En(_t){Sn[_t?"unshift":"push"](()=>{F=_t,t(7,F)})}return n.$$set=_t=>{e=zt(zt({},e),ls(_t)),t(16,r=vi(e,i)),"use"in _t&&t(0,g=_t.use),"class"in _t&&t(1,x=_t.class),"align"in _t&&t(2,I=_t.align),"scrollArea$use"in _t&&t(3,A=_t.scrollArea$use),"scrollArea$class"in _t&&t(4,L=_t.scrollArea$class),"scrollContent$use"in _t&&t(5,N=_t.scrollContent$use),"scrollContent$class"in _t&&t(6,B=_t.scrollContent$class),"$$scope"in _t&&t(22,l=_t.$$scope)},[g,x,I,A,L,N,B,F,z,V,Y,Q,J,he,ee,d,r,Ce,it,Et,Ue,at,l,a,ke,Dt,fn,Cn,Gt,Mt,vt,xn,En]}class eV extends sr{constructor(e){super(),or(this,e,$8,Q8,Qi,{use:0,class:1,align:2,scrollArea$use:3,scrollArea$class:4,scrollContent$use:5,scrollContent$class:6,getScrollPosition:17,getScrollContentWidth:18,incrementScroll:19,scrollTo:20,getElement:21},null,[-1,-1])}get getScrollPosition(){return this.$$.ctx[17]}get getScrollContentWidth(){return this.$$.ctx[18]}get incrementScroll(){return this.$$.ctx[19]}get scrollTo(){return this.$$.ctx[20]}get getElement(){return this.$$.ctx[21]}}function RM(n,e,t){const i=n.slice();return i[29]=e[t],i}const tV=n=>({tab:n[0]&4}),PM=n=>({tab:n[29]});function DM(n,e){let t,i;const r=e[21].default,a=Ri(r,e,e[24],PM);return{key:n,first:null,c(){t=pi(),a&&a.c(),this.h()},l(l){t=pi(),a&&a.l(l),this.h()},h(){this.first=t},m(l,s){tt(l,t,s),a&&a.m(l,s),i=!0},p(l,s){e=l,a&&a.p&&(!i||s[0]&16777220)&&Pi(a,r,e,e[24],i?Oi(r,e[24],s,tV):Di(e[24]),PM)},i(l){i||(Te(a,l),i=!0)},o(l){Ne(a,l),i=!1},d(l){l&&de(t),a&&a.d(l)}}}function nV(n){let e=[],t=new Map,i,r,a=n[2];const l=s=>s[3](s[29]);for(let s=0;s<a.length;s+=1){let d=RM(n,a,s),g=l(d);t.set(g,e[s]=DM(g,d))}return{c(){for(let s=0;s<e.length;s+=1)e[s].c();i=pi()},l(s){for(let d=0;d<e.length;d+=1)e[d].l(s);i=pi()},m(s,d){for(let g=0;g<e.length;g+=1)e[g]&&e[g].m(s,d);tt(s,i,d),r=!0},p(s,d){d[0]&16777228&&(a=s[2],Wi(),e=lL(e,d,l,1,s,a,t,i.parentNode,FP,DM,i,RM),Xi())},i(s){if(!r){for(let d=0;d<a.length;d+=1)Te(e[d]);r=!0}},o(s){for(let d=0;d<e.length;d+=1)Ne(e[d]);r=!1},d(s){for(let d=0;d<e.length;d+=1)e[d].d(s);s&&de(i)}}}function iV(n){let e,t,i,r,a,l,s;const d=[gi(n[11],"tabScroller$")];let g={$$slots:{default:[nV]},$$scope:{ctx:n}};for(let A=0;A<d.length;A+=1)g=zt(g,d[A]);t=new eV({props:g}),n[22](t);let x=[{class:i=In({[n[1]]:!0,"mdc-tab-bar":!0})},{role:"tablist"},{tabindex:n[4]},jo(n[11],["tabScroller$"])],I={};for(let A=0;A<x.length;A+=1)I=zt(I,x[A]);return{c(){e=qt("div"),sn(t.$$.fragment),this.h()},l(A){e=Wt(A,"DIV",{class:!0,role:!0,tabindex:!0});var L=Qt(e);dn(t.$$.fragment,L),L.forEach(de),this.h()},h(){Xn(e,I)},m(A,L){tt(A,e,L),on(t,e,null),n[23](e),a=!0,l||(s=[li(r=jr.call(null,e,n[0])),li(n[8].call(null,e)),qn(e,"SMUITab:mount",n[9]),qn(e,"SMUITab:unmount",n[10]),qn(e,"SMUITab:interacted",function(){Gi(n[5]&&n[5].handleTabInteraction.bind(n[5]))&&(n[5]&&n[5].handleTabInteraction.bind(n[5])).apply(this,arguments)}),qn(e,"keydown",function(){Gi(n[5]&&n[5].handleKeyDown.bind(n[5]))&&(n[5]&&n[5].handleKeyDown.bind(n[5])).apply(this,arguments)})],l=!0)},p(A,L){n=A;const N=L[0]&2048?hi(d,[Mr(gi(n[11],"tabScroller$"))]):{};L[0]&16777220&&(N.$$scope={dirty:L,ctx:n}),t.$set(N),Xn(e,I=hi(x,[(!a||L[0]&2&&i!==(i=In({[n[1]]:!0,"mdc-tab-bar":!0})))&&{class:i},{role:"tablist"},(!a||L[0]&16)&&{tabindex:n[4]},L[0]&2048&&jo(n[11],["tabScroller$"])])),r&&Gi(r.update)&&L[0]&1&&r.update.call(null,n[0])},i(A){a||(Te(t.$$.fragment,A),a=!0)},o(A){Ne(t.$$.fragment,A),a=!1},d(A){A&&de(e),n[22](null),an(t),n[23](null),l=!1,Ss(s)}}}function rV(n,e,t){const i=["use","class","tabs","key","focusOnActivate","focusOnProgrammatic","useAutomaticActivation","active","tabindex","scrollIntoView","getElement"];let r=vi(e,i),{$$slots:a={},$$scope:l}=e;const s=ps(ds());let{use:d=[]}=e,{class:g=""}=e,{tabs:x=[]}=e,{key:I=Ue=>Ue}=e,{focusOnActivate:A=!0}=e,{focusOnProgrammatic:L=!1}=e,{useAutomaticActivation:N=!0}=e,{active:B=void 0}=e,{tabindex:F=0}=e,z,V,Y,Q=x.indexOf(B),J={},he=new WeakMap,ee=!1;lr("SMUI:tab:focusOnActivate",A),lr("SMUI:tab:initialActive",B),ro(()=>(t(5,V=new J8({scrollTo:Ue=>Y.scrollTo(Ue),incrementScroll:Ue=>Y.incrementScroll(Ue),getScrollPosition:()=>Y.getScrollPosition(),getScrollContentWidth:()=>Y.getScrollContentWidth(),getOffsetWidth:()=>Ce().offsetWidth,isRTL:()=>getComputedStyle(Ce()).getPropertyValue("direction")==="rtl",setActiveTab:Ue=>{t(12,B=x[Ue]),t(18,Q=Ue),V.activateTab(Ue)},activateTabAtIndex:(Ue,at)=>{var ke;return(ke=fe(x[Ue]))===null||ke===void 0?void 0:ke.activate(at,ee)},deactivateTabAtIndex:Ue=>{var at;return(at=fe(x[Ue]))===null||at===void 0?void 0:at.deactivate()},focusTabAtIndex:Ue=>{var at;return(at=fe(x[Ue]))===null||at===void 0?void 0:at.focus()},getTabIndicatorClientRectAtIndex:Ue=>{var at,ke;return(ke=(at=fe(x[Ue]))===null||at===void 0?void 0:at.computeIndicatorClientRect())!==null&&ke!==void 0?ke:new DOMRect},getTabDimensionsAtIndex:Ue=>{var at,ke;return(ke=(at=fe(x[Ue]))===null||at===void 0?void 0:at.computeDimensions())!==null&&ke!==void 0?ke:{rootLeft:0,rootRight:0,contentLeft:0,contentRight:0}},getPreviousActiveTabIndex:()=>{var Ue;for(let at=0;at<x.length;at++)if(!((Ue=fe(x[at]))===null||Ue===void 0)&&Ue.active)return at;return-1},getFocusedTabIndex:()=>{const Ue=x.map(ke=>{var Dt;return(Dt=fe(ke))===null||Dt===void 0?void 0:Dt.element}),at=document.activeElement;return Ue.indexOf(at)},getIndexOfTabById:Ue=>x.indexOf(Ue),getTabListLength:()=>x.length,notifyTabActivated:Ue=>ji(Ce(),"SMUITabBar:activated",{index:Ue},void 0,!0)})),V.init(),()=>{V.destroy()}));function ae(Ue){const at=Ue.detail;le(at.tabId,at)}function De(Ue){const at=Ue.detail;Be(at.tabId)}function fe(Ue){return Ue instanceof Object?he.get(Ue):J[Ue]}function le(Ue,at){Ue instanceof Object?(he.set(Ue,at),t(20,he)):(t(19,J[Ue]=at,J),t(19,J))}function Be(Ue){Ue instanceof Object?(he.delete(Ue),t(20,he)):(delete J[Ue],t(19,J))}function Pe(Ue){V.scrollIntoView(Ue)}function Ce(){return z}function it(Ue){Sn[Ue?"unshift":"push"](()=>{Y=Ue,t(7,Y)})}function Et(Ue){Sn[Ue?"unshift":"push"](()=>{z=Ue,t(6,z)})}return n.$$set=Ue=>{e=zt(zt({},e),ls(Ue)),t(11,r=vi(e,i)),"use"in Ue&&t(0,d=Ue.use),"class"in Ue&&t(1,g=Ue.class),"tabs"in Ue&&t(2,x=Ue.tabs),"key"in Ue&&t(3,I=Ue.key),"focusOnActivate"in Ue&&t(13,A=Ue.focusOnActivate),"focusOnProgrammatic"in Ue&&t(14,L=Ue.focusOnProgrammatic),"useAutomaticActivation"in Ue&&t(15,N=Ue.useAutomaticActivation),"active"in Ue&&t(12,B=Ue.active),"tabindex"in Ue&&t(4,F=Ue.tabindex),"$$scope"in Ue&&t(24,l=Ue.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&282660&&B!==x[Q]&&(t(18,Q=x.indexOf(B)),V&&(ee=!L,V.activateTab(Q),ee=!1)),n.$$.dirty[0]&1835012&&x.length){const Ue=x[0]instanceof Object?he.get(x[0]):J[x[0]];Ue&&Ue.forceAccessible(Q===-1)}n.$$.dirty[0]&32800&&V&&V.setUseAutomaticActivation(N)},[d,g,x,I,F,V,z,Y,s,ae,De,r,B,A,L,N,Pe,Ce,Q,J,he,a,it,Et,l]}class sV extends sr{constructor(e){super(),or(this,e,rV,iV,Qi,{use:0,class:1,tabs:2,key:3,focusOnActivate:13,focusOnProgrammatic:14,useAutomaticActivation:15,active:12,tabindex:4,scrollIntoView:16,getElement:17},null,[-1,-1])}get scrollIntoView(){return this.$$.ctx[16]}get getElement(){return this.$$.ctx[17]}}/*!
 * iro.js v5.5.2
 * 2016-2021 James Daniel
 * Licensed under MPL 2.0
 * github.com/jaames/iro.js
 */var sa,oI,rP,yS,sP,og={},rC=[],oV=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i;function ng(n,e){for(var t in e)n[t]=e[t];return n}function oP(n){var e=n.parentNode;e&&e.removeChild(n)}function ho(n,e,t){var i,r,a,l,s=arguments;if(e=ng({},e),arguments.length>3)for(t=[t],i=3;i<arguments.length;i++)t.push(s[i]);if(t!=null&&(e.children=t),n!=null&&n.defaultProps!=null)for(r in n.defaultProps)e[r]===void 0&&(e[r]=n.defaultProps[r]);return l=e.key,(a=e.ref)!=null&&delete e.ref,l!=null&&delete e.key,vS(n,e,l,a)}function vS(n,e,t,i){var r={type:n,props:e,key:t,ref:i,__k:null,__p:null,__b:0,__e:null,l:null,__c:null,constructor:void 0};return sa.vnode&&sa.vnode(r),r}function AI(n){return n.children}function aV(n){if(n==null||typeof n=="boolean")return null;if(typeof n=="string"||typeof n=="number")return vS(null,n,null,null);if(n.__e!=null||n.__c!=null){var e=vS(n.type,n.props,n.key,null);return e.__e=n.__e,e}return n}function Mv(n,e){this.props=n,this.context=e}function aI(n,e){if(e==null)return n.__p?aI(n.__p,n.__p.__k.indexOf(n)+1):null;for(var t;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null)return t.__e;return typeof n.type=="function"?aI(n):null}function aP(n){var e,t;if((n=n.__p)!=null&&n.__c!=null){for(n.__e=n.__c.base=null,e=0;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null){n.__e=n.__c.base=t.__e;break}return aP(n)}}function jw(n){(!n.__d&&(n.__d=!0)&&oI.push(n)===1||yS!==sa.debounceRendering)&&(yS=sa.debounceRendering,(sa.debounceRendering||rP)(lV))}function lV(){var n,e,t,i,r,a,l,s;for(oI.sort(function(d,g){return g.__v.__b-d.__v.__b});n=oI.pop();)n.__d&&(t=void 0,i=void 0,a=(r=(e=n).__v).__e,l=e.__P,s=e.u,e.u=!1,l&&(t=[],i=oC(l,r,ng({},r),e.__n,l.ownerSVGElement!==void 0,null,t,s,a??aI(r)),uP(t,r),i!=a&&aP(r)))}function lP(n,e,t,i,r,a,l,s,d){var g,x,I,A,L,N,B,F=t&&t.__k||rC,z=F.length;if(s==og&&(s=a!=null?a[0]:z?aI(t,0):null),g=0,e.__k=sC(e.__k,function(V){if(V!=null){if(V.__p=e,V.__b=e.__b+1,(I=F[g])===null||I&&V.key==I.key&&V.type===I.type)F[g]=void 0;else for(x=0;x<z;x++){if((I=F[x])&&V.key==I.key&&V.type===I.type){F[x]=void 0;break}I=null}if(A=oC(n,V,I=I||og,i,r,a,l,null,s,d),(x=V.ref)&&I.ref!=x&&(B||(B=[])).push(x,V.__c||A,V),A!=null){if(N==null&&(N=A),V.l!=null)A=V.l,V.l=null;else if(a==I||A!=s||A.parentNode==null){e:if(s==null||s.parentNode!==n)n.appendChild(A);else{for(L=s,x=0;(L=L.nextSibling)&&x<z;x+=2)if(L==A)break e;n.insertBefore(A,s)}e.type=="option"&&(n.value="")}s=A.nextSibling,typeof e.type=="function"&&(e.l=A)}}return g++,V}),e.__e=N,a!=null&&typeof e.type!="function")for(g=a.length;g--;)a[g]!=null&&oP(a[g]);for(g=z;g--;)F[g]!=null&&hP(F[g],F[g]);if(B)for(g=0;g<B.length;g++)cP(B[g],B[++g],B[++g])}function sC(n,e,t){if(t==null&&(t=[]),n==null||typeof n=="boolean")e&&t.push(e(null));else if(Array.isArray(n))for(var i=0;i<n.length;i++)sC(n[i],e,t);else t.push(e?e(aV(n)):n);return t}function uV(n,e,t,i,r){var a;for(a in t)a in e||NM(n,a,null,t[a],i);for(a in e)r&&typeof e[a]!="function"||a==="value"||a==="checked"||t[a]===e[a]||NM(n,a,e[a],t[a],i)}function OM(n,e,t){e[0]==="-"?n.setProperty(e,t):n[e]=typeof t=="number"&&oV.test(e)===!1?t+"px":t??""}function NM(n,e,t,i,r){var a,l,s,d,g;if(!((e=r?e==="className"?"class":e:e==="class"?"className":e)==="key"||e==="children"))if(e==="style")if(a=n.style,typeof t=="string")a.cssText=t;else{if(typeof i=="string"&&(a.cssText="",i=null),i)for(l in i)t&&l in t||OM(a,l,"");if(t)for(s in t)i&&t[s]===i[s]||OM(a,s,t[s])}else e[0]==="o"&&e[1]==="n"?(d=e!==(e=e.replace(/Capture$/,"")),g=e.toLowerCase(),e=(g in n?g:e).slice(2),t?(i||n.addEventListener(e,kM,d),(n.t||(n.t={}))[e]=t):n.removeEventListener(e,kM,d)):e!=="list"&&e!=="tagName"&&e!=="form"&&!r&&e in n?n[e]=t??"":typeof t!="function"&&e!=="dangerouslySetInnerHTML"&&(e!==(e=e.replace(/^xlink:?/,""))?t==null||t===!1?n.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):n.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),t):t==null||t===!1?n.removeAttribute(e):n.setAttribute(e,t))}function kM(n){return this.t[n.type](sa.event?sa.event(n):n)}function oC(n,e,t,i,r,a,l,s,d,g){var x,I,A,L,N,B,F,z,V,Y,Q=e.type;if(e.constructor!==void 0)return null;(x=sa.__b)&&x(e);try{e:if(typeof Q=="function"){if(z=e.props,V=(x=Q.contextType)&&i[x.__c],Y=x?V?V.props.value:x.__p:i,t.__c?F=(I=e.__c=t.__c).__p=I.__E:("prototype"in Q&&Q.prototype.render?e.__c=I=new Q(z,Y):(e.__c=I=new Mv(z,Y),I.constructor=Q,I.render=hV),V&&V.sub(I),I.props=z,I.state||(I.state={}),I.context=Y,I.__n=i,A=I.__d=!0,I.__h=[]),I.__s==null&&(I.__s=I.state),Q.getDerivedStateFromProps!=null&&ng(I.__s==I.state?I.__s=ng({},I.__s):I.__s,Q.getDerivedStateFromProps(z,I.__s)),A)Q.getDerivedStateFromProps==null&&I.componentWillMount!=null&&I.componentWillMount(),I.componentDidMount!=null&&l.push(I);else{if(Q.getDerivedStateFromProps==null&&s==null&&I.componentWillReceiveProps!=null&&I.componentWillReceiveProps(z,Y),!s&&I.shouldComponentUpdate!=null&&I.shouldComponentUpdate(z,I.__s,Y)===!1){for(I.props=z,I.state=I.__s,I.__d=!1,I.__v=e,e.__e=d!=null?d!==t.__e?d:t.__e:null,e.__k=t.__k,x=0;x<e.__k.length;x++)e.__k[x]&&(e.__k[x].__p=e);break e}I.componentWillUpdate!=null&&I.componentWillUpdate(z,I.__s,Y)}for(L=I.props,N=I.state,I.context=Y,I.props=z,I.state=I.__s,(x=sa.__r)&&x(e),I.__d=!1,I.__v=e,I.__P=n,x=I.render(I.props,I.state,I.context),e.__k=sC(x!=null&&x.type==AI&&x.key==null?x.props.children:x),I.getChildContext!=null&&(i=ng(ng({},i),I.getChildContext())),A||I.getSnapshotBeforeUpdate==null||(B=I.getSnapshotBeforeUpdate(L,N)),lP(n,e,t,i,r,a,l,d,g),I.base=e.__e;x=I.__h.pop();)I.__s&&(I.state=I.__s),x.call(I);A||L==null||I.componentDidUpdate==null||I.componentDidUpdate(L,N,B),F&&(I.__E=I.__p=null)}else e.__e=cV(t.__e,e,t,i,r,a,l,g);(x=sa.diffed)&&x(e)}catch(J){sa.__e(J,e,t)}return e.__e}function uP(n,e){for(var t;t=n.pop();)try{t.componentDidMount()}catch(i){sa.__e(i,t.__v)}sa.__c&&sa.__c(e)}function cV(n,e,t,i,r,a,l,s){var d,g,x,I,A=t.props,L=e.props;if(r=e.type==="svg"||r,n==null&&a!=null){for(d=0;d<a.length;d++)if((g=a[d])!=null&&(e.type===null?g.nodeType===3:g.localName===e.type)){n=g,a[d]=null;break}}if(n==null){if(e.type===null)return document.createTextNode(L);n=r?document.createElementNS("http://www.w3.org/2000/svg",e.type):document.createElement(e.type),a=null}return e.type===null?A!==L&&(a!=null&&(a[a.indexOf(n)]=null),n.data=L):e!==t&&(a!=null&&(a=rC.slice.call(n.childNodes)),x=(A=t.props||og).dangerouslySetInnerHTML,I=L.dangerouslySetInnerHTML,s||(I||x)&&(I&&x&&I.__html==x.__html||(n.innerHTML=I&&I.__html||"")),uV(n,L,A,r,s),e.__k=e.props.children,I||lP(n,e,t,i,e.type!=="foreignObject"&&r,a,l,og,s),s||("value"in L&&L.value!==void 0&&L.value!==n.value&&(n.value=L.value==null?"":L.value),"checked"in L&&L.checked!==void 0&&L.checked!==n.checked&&(n.checked=L.checked))),n}function cP(n,e,t){try{typeof n=="function"?n(e):n.current=e}catch(i){sa.__e(i,t)}}function hP(n,e,t){var i,r,a;if(sa.unmount&&sa.unmount(n),(i=n.ref)&&cP(i,null,e),t||typeof n.type=="function"||(t=(r=n.__e)!=null),n.__e=n.l=null,(i=n.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(l){sa.__e(l,e)}i.base=i.__P=null}if(i=n.__k)for(a=0;a<i.length;a++)i[a]&&hP(i[a],e,t);r!=null&&oP(r)}function hV(n,e,t){return this.constructor(n,t)}function fV(n,e,t){var i,r,a;sa.__p&&sa.__p(n,e),r=(i=t===sP)?null:t&&t.__k||e.__k,n=ho(AI,null,[n]),a=[],oC(e,i?e.__k=n:(t||e).__k=n,r||og,og,e.ownerSVGElement!==void 0,t&&!i?[t]:r?null:rC.slice.call(e.childNodes),a,!1,t||og,i),uP(a,n)}sa={},Mv.prototype.setState=function(n,e){var t=this.__s!==this.state&&this.__s||(this.__s=ng({},this.state));(typeof n!="function"||(n=n(t,this.props)))&&ng(t,n),n!=null&&this.__v&&(this.u=!1,e&&this.__h.push(e),jw(this))},Mv.prototype.forceUpdate=function(n){this.__v&&(n&&this.__h.push(n),this.u=!0,jw(this))},Mv.prototype.render=AI,oI=[],rP=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,yS=sa.debounceRendering,sa.__e=function(n,e,t){for(var i;e=e.__p;)if((i=e.__c)&&!i.__p)try{if(i.constructor&&i.constructor.getDerivedStateFromError!=null)i.setState(i.constructor.getDerivedStateFromError(n));else{if(i.componentDidCatch==null)continue;i.componentDidCatch(n)}return jw(i.__E=i)}catch(r){n=r}throw n},sP=og;function FM(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function dV(n,e,t){return e&&FM(n.prototype,e),t&&FM(n,t),n}function Bc(){return Bc=Object.assign||function(n){for(var e=arguments,t=1;t<arguments.length;t++){var i=e[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n},Bc.apply(this,arguments)}var pV="[-\\+]?\\d+%?",mV="[-\\+]?\\d*\\.\\d+%?",E_="(?:"+mV+")|(?:"+pV+")",fP="[\\s|\\(]+("+E_+")[,|\\s]+("+E_+")[,|\\s]+("+E_+")\\s*\\)?",dP="[\\s|\\(]+("+E_+")[,|\\s]+("+E_+")[,|\\s]+("+E_+")[,|\\s]+("+E_+")\\s*\\)?",gV=new RegExp("rgb"+fP),_V=new RegExp("rgba"+dP),yV=new RegExp("hsl"+fP),vV=new RegExp("hsla"+dP),MI="^(?:#?|0x?)",I_="([0-9a-fA-F]{1})",T_="([0-9a-fA-F]{2})",bV=new RegExp(MI+I_+I_+I_+"$"),xV=new RegExp(MI+I_+I_+I_+I_+"$"),EV=new RegExp(MI+T_+T_+T_+"$"),IV=new RegExp(MI+T_+T_+T_+T_+"$"),TV=2e3,wV=4e4,xE=Math.log,cv=Math.round,A1=Math.floor;function ff(n,e,t){return Math.min(Math.max(n,e),t)}function Nc(n,e){var t=n.indexOf("%")>-1,i=parseFloat(n);return t?e/100*i:i}function kc(n){return parseInt(n,16)}function __(n){return n.toString(16).padStart(2,"0")}var bv=function(){function n(t,i){this.$={h:0,s:0,v:0,a:1},t&&this.set(t),this.onChange=i,this.initialValue=Bc({},this.$)}var e=n.prototype;return e.set=function(i){if(typeof i=="string")/^(?:#?|0x?)[0-9a-fA-F]{3,8}$/.test(i)?this.hexString=i:/^rgba?/.test(i)?this.rgbString=i:/^hsla?/.test(i)&&(this.hslString=i);else if(typeof i=="object")i instanceof n?this.hsva=i.hsva:"r"in i&&"g"in i&&"b"in i?this.rgb=i:"h"in i&&"s"in i&&"v"in i?this.hsv=i:"h"in i&&"s"in i&&"l"in i?this.hsl=i:"kelvin"in i&&(this.kelvin=i.kelvin);else throw new Error("Invalid color value")},e.setChannel=function(i,r,a){var l;this[i]=Bc({},this[i],(l={},l[r]=a,l))},e.reset=function(){this.hsva=this.initialValue},e.clone=function(){return new n(this)},e.unbind=function(){this.onChange=void 0},n.hsvToRgb=function(i){var r=i.h/60,a=i.s/100,l=i.v/100,s=A1(r),d=r-s,g=l*(1-a),x=l*(1-d*a),I=l*(1-(1-d)*a),A=s%6,L=[l,x,g,g,I,l][A],N=[I,l,l,x,g,g][A],B=[g,g,I,l,l,x][A];return{r:ff(L*255,0,255),g:ff(N*255,0,255),b:ff(B*255,0,255)}},n.rgbToHsv=function(i){var r=i.r/255,a=i.g/255,l=i.b/255,s=Math.max(r,a,l),d=Math.min(r,a,l),g=s-d,x=0,I=s,A=s===0?0:g/s;switch(s){case d:x=0;break;case r:x=(a-l)/g+(a<l?6:0);break;case a:x=(l-r)/g+2;break;case l:x=(r-a)/g+4;break}return{h:x*60%360,s:ff(A*100,0,100),v:ff(I*100,0,100)}},n.hsvToHsl=function(i){var r=i.s/100,a=i.v/100,l=(2-r)*a,s=l<=1?l:2-l,d=s<1e-9?0:r*a/s;return{h:i.h,s:ff(d*100,0,100),l:ff(l*50,0,100)}},n.hslToHsv=function(i){var r=i.l*2,a=i.s*(r<=100?r:200-r)/100,l=r+a<1e-9?0:2*a/(r+a);return{h:i.h,s:ff(l*100,0,100),v:ff((r+a)/2,0,100)}},n.kelvinToRgb=function(i){var r=i/100,a,l,s;return r<66?(a=255,l=-155.25485562709179-.44596950469579133*(l=r-2)+104.49216199393888*xE(l),s=r<20?0:-254.76935184120902+.8274096064007395*(s=r-10)+115.67994401066147*xE(s)):(a=351.97690566805693+.114206453784165*(a=r-55)-40.25366309332127*xE(a),l=325.4494125711974+.07943456536662342*(l=r-50)-28.0852963507957*xE(l),s=255),{r:ff(A1(a),0,255),g:ff(A1(l),0,255),b:ff(A1(s),0,255)}},n.rgbToKelvin=function(i){for(var r=i.r,a=i.b,l=.4,s=TV,d=wV,g;d-s>l;){g=(d+s)*.5;var x=n.kelvinToRgb(g);x.b/x.r>=a/r?d=g:s=g}return g},dV(n,[{key:"hsv",get:function(){var i=this.$;return{h:i.h,s:i.s,v:i.v}},set:function(i){var r=this.$;if(i=Bc({},r,i),this.onChange){var a={h:!1,v:!1,s:!1,a:!1};for(var l in r)a[l]=i[l]!=r[l];this.$=i,(a.h||a.s||a.v||a.a)&&this.onChange(this,a)}else this.$=i}},{key:"hsva",get:function(){return Bc({},this.$)},set:function(i){this.hsv=i}},{key:"hue",get:function(){return this.$.h},set:function(i){this.hsv={h:i}}},{key:"saturation",get:function(){return this.$.s},set:function(i){this.hsv={s:i}}},{key:"value",get:function(){return this.$.v},set:function(i){this.hsv={v:i}}},{key:"alpha",get:function(){return this.$.a},set:function(i){this.hsv=Bc({},this.hsv,{a:i})}},{key:"kelvin",get:function(){return n.rgbToKelvin(this.rgb)},set:function(i){this.rgb=n.kelvinToRgb(i)}},{key:"red",get:function(){var i=this.rgb;return i.r},set:function(i){this.rgb=Bc({},this.rgb,{r:i})}},{key:"green",get:function(){var i=this.rgb;return i.g},set:function(i){this.rgb=Bc({},this.rgb,{g:i})}},{key:"blue",get:function(){var i=this.rgb;return i.b},set:function(i){this.rgb=Bc({},this.rgb,{b:i})}},{key:"rgb",get:function(){var i=n.hsvToRgb(this.$),r=i.r,a=i.g,l=i.b;return{r:cv(r),g:cv(a),b:cv(l)}},set:function(i){this.hsv=Bc({},n.rgbToHsv(i),{a:i.a===void 0?1:i.a})}},{key:"rgba",get:function(){return Bc({},this.rgb,{a:this.alpha})},set:function(i){this.rgb=i}},{key:"hsl",get:function(){var i=n.hsvToHsl(this.$),r=i.h,a=i.s,l=i.l;return{h:cv(r),s:cv(a),l:cv(l)}},set:function(i){this.hsv=Bc({},n.hslToHsv(i),{a:i.a===void 0?1:i.a})}},{key:"hsla",get:function(){return Bc({},this.hsl,{a:this.alpha})},set:function(i){this.hsl=i}},{key:"rgbString",get:function(){var i=this.rgb;return"rgb("+i.r+", "+i.g+", "+i.b+")"},set:function(i){var r,a,l,s,d=1;if((r=gV.exec(i))?(a=Nc(r[1],255),l=Nc(r[2],255),s=Nc(r[3],255)):(r=_V.exec(i))&&(a=Nc(r[1],255),l=Nc(r[2],255),s=Nc(r[3],255),d=Nc(r[4],1)),r)this.rgb={r:a,g:l,b:s,a:d};else throw new Error("Invalid rgb string")}},{key:"rgbaString",get:function(){var i=this.rgba;return"rgba("+i.r+", "+i.g+", "+i.b+", "+i.a+")"},set:function(i){this.rgbString=i}},{key:"hexString",get:function(){var i=this.rgb;return"#"+__(i.r)+__(i.g)+__(i.b)},set:function(i){var r,a,l,s,d=255;if((r=bV.exec(i))?(a=kc(r[1])*17,l=kc(r[2])*17,s=kc(r[3])*17):(r=xV.exec(i))?(a=kc(r[1])*17,l=kc(r[2])*17,s=kc(r[3])*17,d=kc(r[4])*17):(r=EV.exec(i))?(a=kc(r[1]),l=kc(r[2]),s=kc(r[3])):(r=IV.exec(i))&&(a=kc(r[1]),l=kc(r[2]),s=kc(r[3]),d=kc(r[4])),r)this.rgb={r:a,g:l,b:s,a:d/255};else throw new Error("Invalid hex string")}},{key:"hex8String",get:function(){var i=this.rgba;return"#"+__(i.r)+__(i.g)+__(i.b)+__(A1(i.a*255))},set:function(i){this.hexString=i}},{key:"hslString",get:function(){var i=this.hsl;return"hsl("+i.h+", "+i.s+"%, "+i.l+"%)"},set:function(i){var r,a,l,s,d=1;if((r=yV.exec(i))?(a=Nc(r[1],360),l=Nc(r[2],100),s=Nc(r[3],100)):(r=vV.exec(i))&&(a=Nc(r[1],360),l=Nc(r[2],100),s=Nc(r[3],100),d=Nc(r[4],1)),r)this.hsl={h:a,s:l,l:s,a:d};else throw new Error("Invalid hsl string")}},{key:"hslaString",get:function(){var i=this.hsla;return"hsla("+i.h+", "+i.s+"%, "+i.l+"%, "+i.a+")"},set:function(i){this.hslString=i}}]),n}(),SV={sliderShape:"bar",sliderType:"value",minTemperature:2200,maxTemperature:11e3};function aC(n){var e,t=n.width,i=n.sliderSize,r=n.borderWidth,a=n.handleRadius,l=n.padding,s=n.sliderShape,d=n.layoutDirection==="horizontal";return i=(e=i)!=null?e:l*2+a*2,s==="circle"?{handleStart:n.padding+n.handleRadius,handleRange:t-l*2-a*2,width:t,height:t,cx:t/2,cy:t/2,radius:t/2-r/2}:{handleStart:i/2,handleRange:t-i,radius:i/2,x:0,y:0,width:d?i:t,height:d?t:i}}function CV(n,e){var t=e.hsva,i=e.rgb;switch(n.sliderType){case"red":return i.r/2.55;case"green":return i.g/2.55;case"blue":return i.b/2.55;case"alpha":return t.a*100;case"kelvin":var r=n.minTemperature,a=n.maxTemperature,l=a-r,s=(e.kelvin-r)/l*100;return Math.max(0,Math.min(s,100));case"hue":return t.h/=3.6;case"saturation":return t.s;case"value":default:return t.v}}function AV(n,e,t){var i=aC(n),r=i.handleRange,a=i.handleStart,l;n.layoutDirection==="horizontal"?l=-1*t+r+a:l=e-a,l=Math.max(Math.min(l,r),0);var s=Math.round(100/r*l);switch(n.sliderType){case"kelvin":var d=n.minTemperature,g=n.maxTemperature,x=g-d;return d+x*(s/100);case"alpha":return s/100;case"hue":return s*3.6;case"red":case"blue":case"green":return s*2.55;default:return s}}function MV(n,e){var t=aC(n),i=t.width,r=t.height,a=t.handleRange,l=t.handleStart,s=n.layoutDirection==="horizontal",d=CV(n,e),g=s?i/2:r/2,x=l+d/100*a;return s&&(x=-1*x+a+l*2),{x:s?g:x,y:s?x:g}}function LV(n,e){var t=e.hsv,i=e.rgb;switch(n.sliderType){case"red":return[[0,"rgb(0,"+i.g+","+i.b+")"],[100,"rgb(255,"+i.g+","+i.b+")"]];case"green":return[[0,"rgb("+i.r+",0,"+i.b+")"],[100,"rgb("+i.r+",255,"+i.b+")"]];case"blue":return[[0,"rgb("+i.r+","+i.g+",0)"],[100,"rgb("+i.r+","+i.g+",255)"]];case"alpha":return[[0,"rgba("+i.r+","+i.g+","+i.b+",0)"],[100,"rgb("+i.r+","+i.g+","+i.b+")"]];case"kelvin":for(var r=[],a=n.minTemperature,l=n.maxTemperature,s=8,d=l-a,g=a,x=0;g<l;g+=d/s,x+=1){var I=bv.kelvinToRgb(g),A=I.r,L=I.g,N=I.b;r.push([100/s*x,"rgb("+A+","+L+","+N+")"])}return r;case"hue":return[[0,"#f00"],[16.666,"#ff0"],[33.333,"#0f0"],[50,"#0ff"],[66.666,"#00f"],[83.333,"#f0f"],[100,"#f00"]];case"saturation":var B=bv.hsvToHsl({h:t.h,s:0,v:t.v}),F=bv.hsvToHsl({h:t.h,s:100,v:t.v});return[[0,"hsl("+B.h+","+B.s+"%,"+B.l+"%)"],[100,"hsl("+F.h+","+F.s+"%,"+F.l+"%)"]];case"value":default:var z=bv.hsvToHsl({h:t.h,s:t.s,v:100});return[[0,"#000"],[100,"hsl("+z.h+","+z.s+"%,"+z.l+"%)"]]}}var pP=Math.PI*2,RV=function(e,t){return(e%t+t)%t},mP=function(e,t){return Math.sqrt(e*e+t*t)};function gP(n){return n.width/2-n.padding-n.handleRadius-n.borderWidth}function PV(n,e,t){var i=LI(n),r=i.cx,a=i.cy,l=n.width/2;return mP(r-e,a-t)<l}function LI(n){var e=n.width/2;return{width:n.width,radius:e-n.borderWidth,cx:e,cy:e}}function _P(n,e,t){var i=n.wheelAngle,r=n.wheelDirection;return t&&r==="clockwise"?e=i+e:r==="clockwise"?e=360-i+e:t&&r==="anticlockwise"?e=i+180-e:r==="anticlockwise"&&(e=i-e),RV(e,360)}function DV(n,e){var t=e.hsv,i=LI(n),r=i.cx,a=i.cy,l=gP(n),s=(180+_P(n,t.h,!0))*(pP/360),d=t.s/100*l,g=n.wheelDirection==="clockwise"?-1:1;return{x:r+d*Math.cos(s)*g,y:a+d*Math.sin(s)*g}}function BM(n,e,t){var i=LI(n),r=i.cx,a=i.cy,l=gP(n);e=r-e,t=a-t;var s=_P(n,Math.atan2(-t,-e)*(360/pP)),d=Math.min(mP(e,t),l);return{h:Math.round(s),s:Math.round(100/l*d)}}function lC(n){var e=n.width,t=n.boxHeight,i=n.padding,r=n.handleRadius;return{width:e,height:t??e,radius:i+r}}function zM(n,e,t){var i=lC(n),r=i.width,a=i.height,l=i.radius,s=l,d=r-l*2,g=a-l*2,x=(e-s)/d*100,I=(t-s)/g*100;return{s:Math.max(0,Math.min(x,100)),v:Math.max(0,Math.min(100-I,100))}}function OV(n,e){var t=lC(n),i=t.width,r=t.height,a=t.radius,l=e.hsv,s=a,d=i-a*2,g=r-a*2;return{x:s+l.s/100*d,y:s+(g-l.v/100*g)}}function NV(n,e){var t=e.hue;return[[[0,"#fff"],[100,"hsl("+t+",100%,50%)"]],[[0,"rgba(0,0,0,0)"],[100,"#000"]]]}var qw;function kV(n){qw||(qw=document.getElementsByTagName("base"));var e=window.navigator.userAgent,t=/^((?!chrome|android).)*safari/i.test(e),i=/iPhone|iPod|iPad/i.test(e),r=window.location;return(t||i)&&qw.length>0?r.protocol+"//"+r.host+r.pathname+r.search+n:n}function yP(n,e,t,i){for(var r=0;r<i.length;r++){var a=i[r].x-e,l=i[r].y-t,s=Math.sqrt(a*a+l*l);if(s<n.handleRadius)return r}return null}function uC(n){return{boxSizing:"border-box",border:n.borderWidth+"px solid "+n.borderColor}}function bS(n,e,t){return n+"-gradient("+e+", "+t.map(function(i){var r=i[0],a=i[1];return a+" "+r+"%"}).join(",")+")"}function tc(n){return typeof n=="string"?n:n+"px"}var FV={width:300,height:300,color:"#fff",colors:[],padding:6,layoutDirection:"vertical",borderColor:"#fff",borderWidth:0,handleRadius:8,activeHandleRadius:null,handleSvg:null,handleProps:{x:0,y:0},wheelLightness:!0,wheelAngle:0,wheelDirection:"anticlockwise",sliderSize:null,sliderMargin:12,boxHeight:null},UM=["mousemove","touchmove","mouseup","touchend"],RI=function(n){function e(t){n.call(this,t),this.uid=(Math.random()+1).toString(36).substring(5)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.render=function(i){var r=this.handleEvent.bind(this),a={onMouseDown:r,ontouchstart:r},l=i.layoutDirection==="horizontal",s=i.margin===null?i.sliderMargin:i.margin,d={overflow:"visible",display:l?"inline-block":"block"};return i.index>0&&(d[l?"marginLeft":"marginTop"]=s),ho(AI,null,i.children(this.uid,a,d))},e.prototype.handleEvent=function(i){var r=this,a=this.props.onInput,l=this.base.getBoundingClientRect();i.preventDefault();var s=i.touches?i.changedTouches[0]:i,d=s.clientX-l.left,g=s.clientY-l.top;switch(i.type){case"mousedown":case"touchstart":var x=a(d,g,0);x!==!1&&UM.forEach(function(I){document.addEventListener(I,r,{passive:!1})});break;case"mousemove":case"touchmove":a(d,g,1);break;case"mouseup":case"touchend":a(d,g,2),UM.forEach(function(I){document.removeEventListener(I,r,{passive:!1})});break}},e}(Mv);function V_(n){var e=n.r,t=n.url,i=e,r=e;return ho("svg",{className:"IroHandle IroHandle--"+n.index+" "+(n.isActive?"IroHandle--isActive":""),style:{"-webkit-tap-highlight-color":"rgba(0, 0, 0, 0);",transform:"translate("+tc(n.x)+", "+tc(n.y)+")",willChange:"transform",top:tc(-e),left:tc(-e),width:tc(e*2),height:tc(e*2),position:"absolute",overflow:"visible"}},t&&ho("use",Object.assign({xlinkHref:kV(t)},n.props)),!t&&ho("circle",{cx:i,cy:r,r:e,fill:"none","stroke-width":2,stroke:"#000"}),!t&&ho("circle",{cx:i,cy:r,r:e-2,fill:n.fill,"stroke-width":2,stroke:"#fff"}))}V_.defaultProps={fill:"none",x:0,y:0,r:8,url:null,props:{x:0,y:0}};function lI(n){var e=n.activeIndex,t=e!==void 0&&e<n.colors.length?n.colors[e]:n.color,i=aC(n),r=i.width,a=i.height,l=i.radius,s=MV(n,t),d=LV(n,t);function g(x,I,A){var L=AV(n,x,I);n.parent.inputActive=!0,t[n.sliderType]=L,n.onInput(A,n.id)}return ho(RI,Object.assign({},n,{onInput:g}),function(x,I,A){return ho("div",Object.assign({},I,{className:"IroSlider",style:Object.assign({},{position:"relative",width:tc(r),height:tc(a),borderRadius:tc(l),background:"conic-gradient(#ccc 25%, #fff 0 50%, #ccc 0 75%, #fff 0)",backgroundSize:"8px 8px"},A)}),ho("div",{className:"IroSliderGradient",style:Object.assign({},{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:tc(l),background:bS("linear",n.layoutDirection==="horizontal"?"to top":"to right",d)},uC(n))}),ho(V_,{isActive:!0,index:t.index,r:n.handleRadius,url:n.handleSvg,props:n.handleProps,x:s.x,y:s.y}))})}lI.defaultProps=Object.assign({},SV);function BV(n){var e=lC(n),t=e.width,i=e.height,r=e.radius,a=n.colors,l=n.parent,s=n.activeIndex,d=s!==void 0&&s<n.colors.length?n.colors[s]:n.color,g=NV(n,d),x=a.map(function(A){return OV(n,A)});function I(A,L,N){if(N===0){var B=yP(n,A,L,x);B!==null?l.setActiveColor(B):(l.inputActive=!0,d.hsv=zM(n,A,L),n.onInput(N,n.id))}else N===1&&(l.inputActive=!0,d.hsv=zM(n,A,L));n.onInput(N,n.id)}return ho(RI,Object.assign({},n,{onInput:I}),function(A,L,N){return ho("div",Object.assign({},L,{className:"IroBox",style:Object.assign({},{width:tc(t),height:tc(i),position:"relative"},N)}),ho("div",{className:"IroBox",style:Object.assign({},{width:"100%",height:"100%",borderRadius:tc(r)},uC(n),{background:bS("linear","to bottom",g[1])+","+bS("linear","to right",g[0])})}),a.filter(function(B){return B!==d}).map(function(B){return ho(V_,{isActive:!1,index:B.index,fill:B.hslString,r:n.handleRadius,url:n.handleSvg,props:n.handleProps,x:x[B.index].x,y:x[B.index].y})}),ho(V_,{isActive:!0,index:d.index,fill:d.hslString,r:n.activeHandleRadius||n.handleRadius,url:n.handleSvg,props:n.handleProps,x:x[d.index].x,y:x[d.index].y}))})}var zV="conic-gradient(red, yellow, lime, aqua, blue, magenta, red)",UV="conic-gradient(red, magenta, blue, aqua, lime, yellow, red)";function vP(n){var e=LI(n),t=e.width,i=n.colors;n.borderWidth;var r=n.parent,a=n.color,l=a.hsv,s=i.map(function(x){return DV(n,x)}),d={position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",boxSizing:"border-box"};function g(x,I,A){if(A===0){if(!PV(n,x,I))return!1;var L=yP(n,x,I,s);L!==null?r.setActiveColor(L):(r.inputActive=!0,a.hsv=BM(n,x,I),n.onInput(A,n.id))}else A===1&&(r.inputActive=!0,a.hsv=BM(n,x,I));n.onInput(A,n.id)}return ho(RI,Object.assign({},n,{onInput:g}),function(x,I,A){return ho("div",Object.assign({},I,{className:"IroWheel",style:Object.assign({},{width:tc(t),height:tc(t),position:"relative"},A)}),ho("div",{className:"IroWheelHue",style:Object.assign({},d,{transform:"rotateZ("+(n.wheelAngle+90)+"deg)",background:n.wheelDirection==="clockwise"?zV:UV})}),ho("div",{className:"IroWheelSaturation",style:Object.assign({},d,{background:"radial-gradient(circle closest-side, #fff, transparent)"})}),n.wheelLightness&&ho("div",{className:"IroWheelLightness",style:Object.assign({},d,{background:"#000",opacity:1-l.v/100})}),ho("div",{className:"IroWheelBorder",style:Object.assign({},d,uC(n))}),i.filter(function(L){return L!==a}).map(function(L){return ho(V_,{isActive:!1,index:L.index,fill:L.hslString,r:n.handleRadius,url:n.handleSvg,props:n.handleProps,x:s[L.index].x,y:s[L.index].y})}),ho(V_,{isActive:!0,index:a.index,fill:a.hslString,r:n.activeHandleRadius||n.handleRadius,url:n.handleSvg,props:n.handleProps,x:s[a.index].x,y:s[a.index].y}))})}function VV(n){var e=function(t,i){var r,a=document.createElement("div");fV(ho(n,Object.assign({},{ref:function(s){return r=s}},i)),a);function l(){var s=t instanceof Element?t:document.querySelector(t);s.appendChild(r.base),r.onMount(s)}return document.readyState!=="loading"?l():document.addEventListener("DOMContentLoaded",l),r};return e.prototype=n.prototype,Object.assign(e,n),e.__component=n,e}var bP=function(n){function e(t){var i=this;n.call(this,t),this.colors=[],this.inputActive=!1,this.events={},this.activeEvents={},this.deferredEvents={},this.id=t.id;var r=t.colors.length>0?t.colors:[t.color];r.forEach(function(a){return i.addColor(a)}),this.setActiveColor(0),this.state=Object.assign({},t,{color:this.color,colors:this.colors,layout:t.layout})}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.addColor=function(i,r){r===void 0&&(r=this.colors.length);var a=new bv(i,this.onColorChange.bind(this));this.colors.splice(r,0,a),this.colors.forEach(function(l,s){return l.index=s}),this.state&&this.setState({colors:this.colors}),this.deferredEmit("color:init",a)},e.prototype.removeColor=function(i){var r=this.colors.splice(i,1)[0];r.unbind(),this.colors.forEach(function(a,l){return a.index=l}),this.state&&this.setState({colors:this.colors}),r.index===this.color.index&&this.setActiveColor(0),this.emit("color:remove",r)},e.prototype.setActiveColor=function(i){this.color=this.colors[i],this.state&&this.setState({color:this.color}),this.emit("color:setActive",this.color)},e.prototype.setColors=function(i,r){var a=this;r===void 0&&(r=0),this.colors.forEach(function(l){return l.unbind()}),this.colors=[],i.forEach(function(l){return a.addColor(l)}),this.setActiveColor(r),this.emit("color:setAll",this.colors)},e.prototype.on=function(i,r){var a=this,l=this.events;(Array.isArray(i)?i:[i]).forEach(function(s){(l[s]||(l[s]=[])).push(r),a.deferredEvents[s]&&(a.deferredEvents[s].forEach(function(d){r.apply(null,d)}),a.deferredEvents[s]=[])})},e.prototype.off=function(i,r){var a=this;(Array.isArray(i)?i:[i]).forEach(function(l){var s=a.events[l];s&&s.splice(s.indexOf(r),1)})},e.prototype.emit=function(i){for(var r=this,a=[],l=arguments.length-1;l-- >0;)a[l]=arguments[l+1];var s=this.activeEvents,d=s.hasOwnProperty(i)?s[i]:!1;if(!d){s[i]=!0;var g=this.events[i]||[];g.forEach(function(x){return x.apply(r,a)}),s[i]=!1}},e.prototype.deferredEmit=function(i){for(var r,a=[],l=arguments.length-1;l-- >0;)a[l]=arguments[l+1];var s=this.deferredEvents;(r=this).emit.apply(r,[i].concat(a)),(s[i]||(s[i]=[])).push(a)},e.prototype.setOptions=function(i){this.setState(i)},e.prototype.resize=function(i){this.setOptions({width:i})},e.prototype.reset=function(){this.colors.forEach(function(i){return i.reset()}),this.setState({colors:this.colors})},e.prototype.onMount=function(i){this.el=i,this.deferredEmit("mount",this)},e.prototype.onColorChange=function(i,r){this.setState({color:this.color}),this.inputActive&&(this.inputActive=!1,this.emit("input:change",i,r)),this.emit("color:change",i,r)},e.prototype.emitInputEvent=function(i,r){i===0?this.emit("input:start",this.color,r):i===1?this.emit("input:move",this.color,r):i===2&&this.emit("input:end",this.color,r)},e.prototype.render=function(i,r){var a=this,l=r.layout;if(!Array.isArray(l)){switch(l){default:l=[{component:vP},{component:lI}]}r.transparency&&l.push({component:lI,options:{sliderType:"alpha"}})}return ho("div",{class:"IroColorPicker",id:r.id,style:{display:r.display}},l.map(function(s,d){var g=s.component,x=s.options;return ho(g,Object.assign({},r,x,{ref:void 0,onInput:a.emitInputEvent.bind(a),parent:a,index:d}))}))},e}(Mv);bP.defaultProps=Object.assign({},FV,{colors:[],display:"block",id:null,layout:"default",margin:null});var GV=VV(bP),xS;(function(n){n.version="5.5.2",n.Color=bv,n.ColorPicker=GV,function(e){e.h=ho,e.ComponentBase=RI,e.Handle=V_,e.Slider=lI,e.Wheel=vP,e.Box=BV}(n.ui||(n.ui={}))})(xS||(xS={}));var EE=xS;function HV(n){let e;return{c(){e=_i("Apply")},l(t){e=yi(t,"Apply")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function jV(n){let e;return{c(){e=_i("Cancel")},l(t){e=yi(t,"Cancel")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function qV(n){let e,t,i,r,a,l,s,d,g,x,I,A,L;function N(F){n[6](F)}let B={label:"Layer name"};return n[0]!==void 0&&(B.value=n[0]),i=new FS({props:B}),Sn.push(()=>Xr(i,"value",N)),x=new cp({props:{variant:"unelevated",$$slots:{default:[HV]},$$scope:{ctx:n}}}),x.$on("click",n[2]),A=new cp({props:{variant:"outlined",$$slots:{default:[jV]},$$scope:{ctx:n}}}),A.$on("click",n[7]),{c(){e=qt("span"),t=vn(),sn(i.$$.fragment),a=vn(),l=qt("div"),s=vn(),d=qt("span"),g=qt("span"),sn(x.$$.fragment),I=vn(),sn(A.$$.fragment),this.h()},l(F){e=Wt(F,"SPAN",{style:!0}),Qt(e).forEach(de),t=bn(F),dn(i.$$.fragment,F),a=bn(F),l=Wt(F,"DIV",{class:!0,id:!0}),Qt(l).forEach(de),s=bn(F),d=Wt(F,"SPAN",{class:!0});var z=Qt(d);g=Wt(z,"SPAN",{id:!0,class:!0});var V=Qt(g);dn(x.$$.fragment,V),V.forEach(de),I=bn(z),dn(A.$$.fragment,z),z.forEach(de),this.h()},h(){wa(e,"height","10px"),tn(l,"class","wheel svelte-sxmi40"),tn(l,"id","colorWheel"),tn(g,"id","apply-btn"),tn(g,"class","svelte-sxmi40"),tn(d,"class","btn-row svelte-sxmi40")},m(F,z){tt(F,e,z),tt(F,t,z),on(i,F,z),tt(F,a,z),tt(F,l,z),tt(F,s,z),tt(F,d,z),Kt(d,g),on(x,g,null),Kt(d,I),on(A,d,null),L=!0},p(F,[z]){const V={};!r&&z&1&&(r=!0,V.value=F[0],Qr(()=>r=!1)),i.$set(V);const Y={};z&256&&(Y.$$scope={dirty:z,ctx:F}),x.$set(Y);const Q={};z&256&&(Q.$$scope={dirty:z,ctx:F}),A.$set(Q)},i(F){L||(Te(i.$$.fragment,F),Te(x.$$.fragment,F),Te(A.$$.fragment,F),L=!0)},o(F){Ne(i.$$.fragment,F),Ne(x.$$.fragment,F),Ne(A.$$.fragment,F),L=!1},d(F){F&&de(e),F&&de(t),an(i,F),F&&de(a),F&&de(l),F&&de(s),F&&de(d),an(x),an(A)}}}function WV(n){return{color:"#"+((n.r|256).toString(16).slice(1)+(n.g|256).toString(16).slice(1)+(n.b|256).toString(16).slice(1)),opacity:n.a}}function XV(n){var e=Math.round(n*255),t=e.toString(16).padStart(2,"0");return t}function ZV(n,e,t){let i,r,{layer:a}=e,l;const s=i0();function d(){s("propertiesSet",{layer:a,newName:r,...WV(l.color.rgba)})}ro(()=>{t(4,l=EE.ColorPicker("#colorWheel",{width:250,color:"#fff",layoutDirection:"vertical",padding:4,handleRadius:8,wheelLightness:!0,wheelDirection:"anticlockwise",sliderSize:void 0,sliderMargin:12,layout:[{component:EE.ui.Wheel,options:{wheelLightness:!0,wheelAngle:0,wheelDirection:"anticlockwise"}},{component:EE.ui.Slider,options:{sliderType:"value"}},{component:EE.ui.Slider,options:{sliderType:"alpha",activeIndex:2}}]}))});function g(I){r=I,t(0,r),t(5,i),t(3,a)}const x=()=>s("closeProperties");return n.$$set=I=>{"layer"in I&&t(3,a=I.layer)},n.$$.update=()=>{if(n.$$.dirty&8&&t(5,i=a.displayName),n.$$.dirty&32&&t(0,r=i),n.$$.dirty&24&&l){const I=a.paint[`${a.type}-color`],A=a.paint[`${a.type}-opacity`],L=XV(A||1);l.color.set(I+L)}},[r,s,d,a,l,i,g,x]}class YV extends sr{constructor(e){super(),or(this,e,ZV,qV,Qi,{layer:3})}}/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Va={CELL:"mdc-data-table__cell",CELL_NUMERIC:"mdc-data-table__cell--numeric",CONTENT:"mdc-data-table__content",HEADER_CELL:"mdc-data-table__header-cell",HEADER_CELL_LABEL:"mdc-data-table__header-cell-label",HEADER_CELL_SORTED:"mdc-data-table__header-cell--sorted",HEADER_CELL_SORTED_DESCENDING:"mdc-data-table__header-cell--sorted-descending",HEADER_CELL_WITH_SORT:"mdc-data-table__header-cell--with-sort",HEADER_CELL_WRAPPER:"mdc-data-table__header-cell-wrapper",HEADER_ROW:"mdc-data-table__header-row",HEADER_ROW_CHECKBOX:"mdc-data-table__header-row-checkbox",IN_PROGRESS:"mdc-data-table--in-progress",LINEAR_PROGRESS:"mdc-data-table__linear-progress",PAGINATION_ROWS_PER_PAGE_LABEL:"mdc-data-table__pagination-rows-per-page-label",PAGINATION_ROWS_PER_PAGE_SELECT:"mdc-data-table__pagination-rows-per-page-select",PROGRESS_INDICATOR:"mdc-data-table__progress-indicator",ROOT:"mdc-data-table",ROW:"mdc-data-table__row",ROW_CHECKBOX:"mdc-data-table__row-checkbox",ROW_SELECTED:"mdc-data-table__row--selected",SORT_ICON_BUTTON:"mdc-data-table__sort-icon-button",SORT_STATUS_LABEL:"mdc-data-table__sort-status-label",TABLE_CONTAINER:"mdc-data-table__table-container"},VM={ARIA_SELECTED:"aria-selected",ARIA_SORT:"aria-sort"},KV={COLUMN_ID:"data-column-id",ROW_ID:"data-row-id"},IE={CONTENT:"."+Va.CONTENT,HEADER_CELL:"."+Va.HEADER_CELL,HEADER_CELL_WITH_SORT:"."+Va.HEADER_CELL_WITH_SORT,HEADER_ROW:"."+Va.HEADER_ROW,HEADER_ROW_CHECKBOX:"."+Va.HEADER_ROW_CHECKBOX,PROGRESS_INDICATOR:"."+Va.PROGRESS_INDICATOR,ROW:"."+Va.ROW,ROW_CHECKBOX:"."+Va.ROW_CHECKBOX,ROW_SELECTED:"."+Va.ROW_SELECTED,SORT_ICON_BUTTON:"."+Va.SORT_ICON_BUTTON,SORT_STATUS_LABEL:"."+Va.SORT_STATUS_LABEL},y_={ARIA_SELECTED:VM.ARIA_SELECTED,ARIA_SORT:VM.ARIA_SORT,DATA_ROW_ID_ATTR:KV.ROW_ID,HEADER_ROW_CHECKBOX_SELECTOR:IE.HEADER_ROW_CHECKBOX,ROW_CHECKBOX_SELECTOR:IE.ROW_CHECKBOX,ROW_SELECTED_SELECTOR:IE.ROW_SELECTED,ROW_SELECTOR:IE.ROW},bh;(function(n){n.ASCENDING="ascending",n.DESCENDING="descending",n.NONE="none",n.OTHER="other"})(bh||(bh={}));/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var JV=function(n){Wo(e,n);function e(t){return n.call(this,zr(zr({},e.defaultAdapter),t))||this}return Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},addClassAtRowIndex:function(){},getAttributeByHeaderCellIndex:function(){return""},getHeaderCellCount:function(){return 0},getHeaderCellElements:function(){return[]},getRowCount:function(){return 0},getRowElements:function(){return[]},getRowIdAtIndex:function(){return""},getRowIndexByChildElement:function(){return 0},getSelectedRowCount:function(){return 0},getTableContainerHeight:function(){return 0},getTableHeaderHeight:function(){return 0},isCheckboxAtRowIndexChecked:function(){return!1},isHeaderRowCheckboxChecked:function(){return!1},isRowsSelectable:function(){return!1},notifyRowSelectionChanged:function(){},notifySelectedAll:function(){},notifySortAction:function(){},notifyUnselectedAll:function(){},notifyRowClick:function(){},registerHeaderRowCheckbox:function(){},registerRowCheckboxes:function(){},removeClass:function(){},removeClassAtRowIndex:function(){},removeClassNameByHeaderCellIndex:function(){},setAttributeAtRowIndex:function(){},setAttributeByHeaderCellIndex:function(){},setClassNameByHeaderCellIndex:function(){},setHeaderRowCheckboxChecked:function(){},setHeaderRowCheckboxIndeterminate:function(){},setProgressIndicatorStyles:function(){},setRowCheckboxCheckedAtIndex:function(){},setSortStatusLabelByHeaderCellIndex:function(){}}},enumerable:!1,configurable:!0}),e.prototype.layout=function(){this.adapter.isRowsSelectable()&&(this.adapter.registerHeaderRowCheckbox(),this.adapter.registerRowCheckboxes(),this.setHeaderRowCheckboxState())},e.prototype.layoutAsync=function(){return KP(this,void 0,void 0,function(){return JP(this,function(t){switch(t.label){case 0:return this.adapter.isRowsSelectable()?[4,this.adapter.registerHeaderRowCheckbox()]:[3,3];case 1:return t.sent(),[4,this.adapter.registerRowCheckboxes()];case 2:t.sent(),this.setHeaderRowCheckboxState(),t.label=3;case 3:return[2]}})})},e.prototype.getRows=function(){return this.adapter.getRowElements()},e.prototype.getHeaderCells=function(){return this.adapter.getHeaderCellElements()},e.prototype.setSelectedRowIds=function(t){for(var i=0;i<this.adapter.getRowCount();i++){var r=this.adapter.getRowIdAtIndex(i),a=!1;r&&t.indexOf(r)>=0&&(a=!0),this.adapter.setRowCheckboxCheckedAtIndex(i,a),this.selectRowAtIndex(i,a)}this.setHeaderRowCheckboxState()},e.prototype.getRowIds=function(){for(var t=[],i=0;i<this.adapter.getRowCount();i++)t.push(this.adapter.getRowIdAtIndex(i));return t},e.prototype.getSelectedRowIds=function(){for(var t=[],i=0;i<this.adapter.getRowCount();i++)this.adapter.isCheckboxAtRowIndexChecked(i)&&t.push(this.adapter.getRowIdAtIndex(i));return t},e.prototype.handleHeaderRowCheckboxChange=function(){for(var t=this.adapter.isHeaderRowCheckboxChecked(),i=0;i<this.adapter.getRowCount();i++)this.adapter.setRowCheckboxCheckedAtIndex(i,t),this.selectRowAtIndex(i,t);t?this.adapter.notifySelectedAll():this.adapter.notifyUnselectedAll()},e.prototype.handleRowCheckboxChange=function(t){var i=this.adapter.getRowIndexByChildElement(t.target);if(i!==-1){var r=this.adapter.isCheckboxAtRowIndexChecked(i);this.selectRowAtIndex(i,r),this.setHeaderRowCheckboxState();var a=this.adapter.getRowIdAtIndex(i);this.adapter.notifyRowSelectionChanged({rowId:a,rowIndex:i,selected:r})}},e.prototype.handleSortAction=function(t){for(var i=t.columnId,r=t.columnIndex,a=t.headerCell,l=0;l<this.adapter.getHeaderCellCount();l++)l!==r&&(this.adapter.removeClassNameByHeaderCellIndex(l,Va.HEADER_CELL_SORTED),this.adapter.removeClassNameByHeaderCellIndex(l,Va.HEADER_CELL_SORTED_DESCENDING),this.adapter.setAttributeByHeaderCellIndex(l,y_.ARIA_SORT,bh.NONE),this.adapter.setSortStatusLabelByHeaderCellIndex(l,bh.NONE));this.adapter.setClassNameByHeaderCellIndex(r,Va.HEADER_CELL_SORTED);var s=this.adapter.getAttributeByHeaderCellIndex(r,y_.ARIA_SORT),d=bh.NONE;s===bh.ASCENDING?(this.adapter.setClassNameByHeaderCellIndex(r,Va.HEADER_CELL_SORTED_DESCENDING),this.adapter.setAttributeByHeaderCellIndex(r,y_.ARIA_SORT,bh.DESCENDING),d=bh.DESCENDING):s===bh.DESCENDING?(this.adapter.removeClassNameByHeaderCellIndex(r,Va.HEADER_CELL_SORTED_DESCENDING),this.adapter.setAttributeByHeaderCellIndex(r,y_.ARIA_SORT,bh.ASCENDING),d=bh.ASCENDING):(this.adapter.setAttributeByHeaderCellIndex(r,y_.ARIA_SORT,bh.ASCENDING),d=bh.ASCENDING),this.adapter.setSortStatusLabelByHeaderCellIndex(r,d),this.adapter.notifySortAction({columnId:i,columnIndex:r,headerCell:a,sortValue:d})},e.prototype.handleRowClick=function(t){var i=t.rowId,r=t.row;this.adapter.notifyRowClick({rowId:i,row:r})},e.prototype.showProgress=function(){var t=this.adapter.getTableHeaderHeight(),i=this.adapter.getTableContainerHeight()-t,r=t;this.adapter.setProgressIndicatorStyles({height:i+"px",top:r+"px"}),this.adapter.addClass(Va.IN_PROGRESS)},e.prototype.hideProgress=function(){this.adapter.removeClass(Va.IN_PROGRESS)},e.prototype.setHeaderRowCheckboxState=function(){this.adapter.getSelectedRowCount()===0?(this.adapter.setHeaderRowCheckboxChecked(!1),this.adapter.setHeaderRowCheckboxIndeterminate(!1)):this.adapter.getSelectedRowCount()===this.adapter.getRowCount()?(this.adapter.setHeaderRowCheckboxChecked(!0),this.adapter.setHeaderRowCheckboxIndeterminate(!1)):(this.adapter.setHeaderRowCheckboxIndeterminate(!0),this.adapter.setHeaderRowCheckboxChecked(!1))},e.prototype.selectRowAtIndex=function(t,i){i?(this.adapter.addClassAtRowIndex(t,Va.ROW_SELECTED),this.adapter.setAttributeAtRowIndex(t,y_.ARIA_SELECTED,"true")):(this.adapter.removeClassAtRowIndex(t,Va.ROW_SELECTED),this.adapter.setAttributeAtRowIndex(t,y_.ARIA_SELECTED,"false"))},e}(xl);const QV=n=>({}),GM=n=>({}),$V=n=>({}),HM=n=>({});function jM(n){let e,t,i,r,a;const l=n[36].progress,s=Ri(l,n,n[35],HM);return{c(){e=qt("div"),t=qt("div"),i=vn(),s&&s.c(),this.h()},l(d){e=Wt(d,"DIV",{class:!0,style:!0});var g=Qt(e);t=Wt(g,"DIV",{class:!0}),Qt(t).forEach(de),i=bn(g),s&&s.l(g),g.forEach(de),this.h()},h(){tn(t,"class","mdc-data-table__scrim"),tn(e,"class","mdc-data-table__progress-indicator"),tn(e,"style",r=Object.entries(n[13]).map(qM).join(" "))},m(d,g){tt(d,e,g),Kt(e,t),Kt(e,i),s&&s.m(e,null),a=!0},p(d,g){s&&s.p&&(!a||g[1]&16)&&Pi(s,l,d,d[35],a?Oi(l,d[35],g,$V):Di(d[35]),HM),(!a||g[0]&8192&&r!==(r=Object.entries(d[13]).map(qM).join(" ")))&&tn(e,"style",r)},i(d){a||(Te(s,d),a=!0)},o(d){Ne(s,d),a=!1},d(d){d&&de(e),s&&s.d(d)}}}function eG(n){let e,t,i,r,a,l,s,d,g,x,I,A,L,N;const B=n[36].default,F=Ri(B,n,n[35],null);let z=[{class:r=In({[n[6]]:!0,"mdc-data-table__table":!0})},gi(n[25],"table$")],V={};for(let fe=0;fe<z.length;fe+=1)V=zt(V,z[fe]);let Y=[{class:l=In({[n[4]]:!0,"mdc-data-table__table-container":!0})},gi(n[25],"container$")],Q={};for(let fe=0;fe<Y.length;fe+=1)Q=zt(Q,Y[fe]);let J=n[24].progress&&jM(n);const he=n[36].paginate,ee=Ri(he,n,n[35],GM);let ae=[{class:x=In({[n[1]]:!0,"mdc-data-table":!0,"mdc-data-table--sticky-header":n[2],...n[12]})},jo(n[25],["container$","table$"])],De={};for(let fe=0;fe<ae.length;fe+=1)De=zt(De,ae[fe]);return{c(){e=qt("div"),t=qt("div"),i=qt("table"),F&&F.c(),d=vn(),J&&J.c(),g=vn(),ee&&ee.c(),this.h()},l(fe){e=Wt(fe,"DIV",{class:!0});var le=Qt(e);t=Wt(le,"DIV",{class:!0});var Be=Qt(t);i=Wt(Be,"TABLE",{class:!0});var Pe=Qt(i);F&&F.l(Pe),Pe.forEach(de),Be.forEach(de),d=bn(le),J&&J.l(le),g=bn(le),ee&&ee.l(le),le.forEach(de),this.h()},h(){Xn(i,V),Xn(t,Q),Xn(e,De)},m(fe,le){tt(fe,e,le),Kt(e,t),Kt(t,i),F&&F.m(i,null),n[37](t),Kt(e,d),J&&J.m(e,null),Kt(e,g),ee&&ee.m(e,null),n[38](e),A=!0,L||(N=[li(a=jr.call(null,i,n[5])),li(s=jr.call(null,t,n[3])),li(I=jr.call(null,e,n[0])),li(n[15].call(null,e)),qn(e,"SMUICheckbox:mount",n[39]),qn(e,"SMUIDataTableHeader:mount",n[19]),qn(e,"SMUIDataTableHeader:unmount",n[40]),qn(e,"SMUIDataTableBody:mount",n[20]),qn(e,"SMUIDataTableBody:unmount",n[41]),qn(e,"SMUIDataTableHeaderCheckbox:change",n[42]),qn(e,"SMUIDataTableHeader:click",n[22]),qn(e,"SMUIDataTableRow:click",n[23]),qn(e,"SMUIDataTableBodyCheckbox:change",n[21])],L=!0)},p(fe,le){F&&F.p&&(!A||le[1]&16)&&Pi(F,B,fe,fe[35],A?Oi(B,fe[35],le,null):Di(fe[35]),null),Xn(i,V=hi(z,[(!A||le[0]&64&&r!==(r=In({[fe[6]]:!0,"mdc-data-table__table":!0})))&&{class:r},le[0]&33554432&&gi(fe[25],"table$")])),a&&Gi(a.update)&&le[0]&32&&a.update.call(null,fe[5]),Xn(t,Q=hi(Y,[(!A||le[0]&16&&l!==(l=In({[fe[4]]:!0,"mdc-data-table__table-container":!0})))&&{class:l},le[0]&33554432&&gi(fe[25],"container$")])),s&&Gi(s.update)&&le[0]&8&&s.update.call(null,fe[3]),fe[24].progress?J?(J.p(fe,le),le[0]&16777216&&Te(J,1)):(J=jM(fe),J.c(),Te(J,1),J.m(e,g)):J&&(Wi(),Ne(J,1,1,()=>{J=null}),Xi()),ee&&ee.p&&(!A||le[1]&16)&&Pi(ee,he,fe,fe[35],A?Oi(he,fe[35],le,QV):Di(fe[35]),GM),Xn(e,De=hi(ae,[(!A||le[0]&4102&&x!==(x=In({[fe[1]]:!0,"mdc-data-table":!0,"mdc-data-table--sticky-header":fe[2],...fe[12]})))&&{class:x},le[0]&33554432&&jo(fe[25],["container$","table$"])])),I&&Gi(I.update)&&le[0]&1&&I.update.call(null,fe[0])},i(fe){A||(Te(F,fe),Te(J),Te(ee,fe),A=!0)},o(fe){Ne(F,fe),Ne(J),Ne(ee,fe),A=!1},d(fe){fe&&de(e),F&&F.d(fe),n[37](null),J&&J.d(),ee&&ee.d(fe),n[38](null),L=!1,Ss(N)}}}const qM=([n,e])=>`${n}: ${e};`;function tG(n,e,t){const i=["use","class","stickyHeader","sortable","sort","sortDirection","sortAscendingAriaLabel","sortDescendingAriaLabel","container$use","container$class","table$use","table$class","layout","getElement"];let r=vi(e,i),a,l,s,{$$slots:d={},$$scope:g}=e;const x=uI(d),{closest:I}=r0,A=ps(ds());let{use:L=[]}=e,{class:N=""}=e,{stickyHeader:B=!1}=e,{sortable:F=!1}=e,{sort:z=null}=e,{sortDirection:V="ascending"}=e,{sortAscendingAriaLabel:Y="sorted, ascending"}=e,{sortDescendingAriaLabel:Q="sorted, descending"}=e,{container$use:J=[]}=e,{container$class:he=""}=e,{table$use:ee=[]}=e,{table$class:ae=""}=e,De,fe,le,Be,Pe,Ce={},it={height:"auto",top:"initial"},Et=Fr("SMUI:addLayoutListener"),Ue,at=!1,ke=Eh(!1);Dl(n,ke,He=>t(34,a=He));let Dt=Eh(z);Dl(n,Dt,He=>t(45,s=He));let fn=Eh(V);Dl(n,fn,He=>t(44,l=He)),lr("SMUI:checkbox:context","data-table"),lr("SMUI:linear-progress:context","data-table"),lr("SMUI:linear-progress:closed",ke),lr("SMUI:data-table:sortable",F),lr("SMUI:data-table:sort",Dt),lr("SMUI:data-table:sortDirection",fn),lr("SMUI:data-table:sortAscendingAriaLabel",Y),lr("SMUI:data-table:sortDescendingAriaLabel",Q),Et&&(Ue=Et(Zn));let Cn;ro(()=>(t(7,fe=new JV({addClass:xn,removeClass:En,getHeaderCellElements:()=>{var He;return(He=Be==null?void 0:Be.cells.map(Jt=>Jt.element))!==null&&He!==void 0?He:[]},getHeaderCellCount:()=>{var He;return(He=Be==null?void 0:Be.cells.length)!==null&&He!==void 0?He:0},getAttributeByHeaderCellIndex:(He,Jt)=>{var ui;return(ui=Be==null?void 0:Be.orderedCells[He].getAttr(Jt))!==null&&ui!==void 0?ui:null},setAttributeByHeaderCellIndex:(He,Jt,ui)=>{Be==null||Be.orderedCells[He].addAttr(Jt,ui)},setClassNameByHeaderCellIndex:(He,Jt)=>{Be==null||Be.orderedCells[He].addClass(Jt)},removeClassNameByHeaderCellIndex:(He,Jt)=>{Be==null||Be.orderedCells[He].removeClass(Jt)},notifySortAction:He=>{t(26,z=He.columnId),t(27,V=He.sortValue),ji(mi(),"SMUIDataTable:sorted",He,void 0,!0)},getTableContainerHeight:()=>le.getBoundingClientRect().height,getTableHeaderHeight:()=>{const He=mi().querySelector(".mdc-data-table__header-row");if(!He)throw new Error("MDCDataTable: Table header element not found.");return He.getBoundingClientRect().height},setProgressIndicatorStyles:He=>{t(13,it=He)},addClassAtRowIndex:(He,Jt)=>{Pe==null||Pe.orderedRows[He].addClass(Jt)},getRowCount:()=>{var He;return(He=Pe==null?void 0:Pe.rows.length)!==null&&He!==void 0?He:0},getRowElements:()=>{var He;return(He=Pe==null?void 0:Pe.rows.map(Jt=>Jt.element))!==null&&He!==void 0?He:[]},getRowIdAtIndex:He=>{var Jt;return(Jt=Pe==null?void 0:Pe.orderedRows[He].rowId)!==null&&Jt!==void 0?Jt:null},getRowIndexByChildElement:He=>{var Jt;return(Jt=Pe==null?void 0:Pe.orderedRows.map(ui=>ui.element).indexOf(I(He,".mdc-data-table__row")))!==null&&Jt!==void 0?Jt:-1},getSelectedRowCount:()=>{var He;return(He=Pe==null?void 0:Pe.rows.filter(Jt=>Jt.selected).length)!==null&&He!==void 0?He:0},isCheckboxAtRowIndexChecked:He=>{const Jt=Pe==null?void 0:Pe.orderedRows[He].checkbox;return Jt?Jt.checked:!1},isHeaderRowCheckboxChecked:()=>{const He=Be==null?void 0:Be.checkbox;return He?He.checked:!1},isRowsSelectable:()=>!!mi().querySelector(".mdc-data-table__row-checkbox")||!!mi().querySelector(".mdc-data-table__header-row-checkbox"),notifyRowSelectionChanged:He=>{const Jt=Pe==null?void 0:Pe.orderedRows[He.rowIndex];Jt&&ji(mi(),"SMUIDataTable:rowSelectionChanged",{row:Jt.element,rowId:Jt.rowId,rowIndex:He.rowIndex,selected:He.selected},void 0,!0)},notifySelectedAll:()=>{_t(!1),ji(mi(),"SMUIDataTable:selectedAll",void 0,void 0,!0)},notifyUnselectedAll:()=>{_t(!1),ji(mi(),"SMUIDataTable:unselectedAll",void 0,void 0,!0)},notifyRowClick:He=>{ji(mi(),"SMUIDataTable:rowClick",He,void 0,!0)},registerHeaderRowCheckbox:()=>{},registerRowCheckboxes:()=>{},removeClassAtRowIndex:(He,Jt)=>{Pe==null||Pe.orderedRows[He].removeClass(Jt)},setAttributeAtRowIndex:(He,Jt,ui)=>{Pe==null||Pe.orderedRows[He].addAttr(Jt,ui)},setHeaderRowCheckboxChecked:He=>{const Jt=Be==null?void 0:Be.checkbox;Jt&&(Jt.checked=He)},setHeaderRowCheckboxIndeterminate:_t,setRowCheckboxCheckedAtIndex:(He,Jt)=>{const ui=Pe==null?void 0:Pe.orderedRows[He].checkbox;ui&&(ui.checked=Jt)},setSortStatusLabelByHeaderCellIndex:(He,Jt)=>{}})),fe.init(),fe.layout(),t(14,at=!0),()=>{fe.destroy()})),Dh(()=>{Ue&&Ue()});function Gt(He){t(10,Be=He.detail)}function Mt(He){t(11,Pe=He.detail)}function vt(He){fe&&fe.handleRowCheckboxChange(He)}function xn(He){Ce[He]||t(12,Ce[He]=!0,Ce)}function En(He){(!(He in Ce)||Ce[He])&&t(12,Ce[He]=!1,Ce)}function _t(He){const Jt=Be==null?void 0:Be.checkbox;Jt&&(Jt.indeterminate=He)}function kt(He){if(!fe||!He.detail.target)return;const Jt=I(He.detail.target,".mdc-data-table__header-cell--with-sort");Jt&&Bt(Jt)}function Ct(He){if(!fe||!He.detail.target)return;const Jt=I(He.detail.target,".mdc-data-table__row");Jt&&fe&&fe.handleRowClick({rowId:He.detail.rowId,row:Jt})}function Bt(He){var Jt,ui;const $e=(Jt=Be==null?void 0:Be.orderedCells)!==null&&Jt!==void 0?Jt:[],kn=$e.map(ni=>ni.element).indexOf(He);if(kn===-1)return;const Ei=(ui=$e[kn].columnId)!==null&&ui!==void 0?ui:null;fe.handleSortAction({columnId:Ei,columnIndex:kn,headerCell:He})}function Zn(){return fe.layout()}function mi(){return De}function yn(He){Sn[He?"unshift":"push"](()=>{le=He,t(9,le)})}function Pt(He){Sn[He?"unshift":"push"](()=>{De=He,t(8,De)})}const Yn=()=>fe&&at&&fe.layout(),si=()=>t(10,Be=void 0),Dr=()=>t(11,Pe=void 0),Ur=()=>fe&&fe.handleHeaderRowCheckboxChange();return n.$$set=He=>{e=zt(zt({},e),ls(He)),t(25,r=vi(e,i)),"use"in He&&t(0,L=He.use),"class"in He&&t(1,N=He.class),"stickyHeader"in He&&t(2,B=He.stickyHeader),"sortable"in He&&t(28,F=He.sortable),"sort"in He&&t(26,z=He.sort),"sortDirection"in He&&t(27,V=He.sortDirection),"sortAscendingAriaLabel"in He&&t(29,Y=He.sortAscendingAriaLabel),"sortDescendingAriaLabel"in He&&t(30,Q=He.sortDescendingAriaLabel),"container$use"in He&&t(3,J=He.container$use),"container$class"in He&&t(4,he=He.container$class),"table$use"in He&&t(5,ee=He.table$use),"table$class"in He&&t(6,ae=He.table$class),"$$scope"in He&&t(35,g=He.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&67108864&&bf(Dt,s=z,s),n.$$.dirty[0]&134217728&&bf(fn,l=V,l),n.$$.dirty[0]&128|n.$$.dirty[1]&12&&x.progress&&fe&&Cn!==a&&(t(33,Cn=a),a?fe.hideProgress():fe.showProgress())},[L,N,B,J,he,ee,ae,fe,De,le,Be,Pe,Ce,it,at,A,ke,Dt,fn,Gt,Mt,vt,kt,Ct,x,r,z,V,F,Y,Q,Zn,mi,Cn,a,g,d,yn,Pt,Yn,si,Dr,Ur]}class nG extends sr{constructor(e){super(),or(this,e,tG,eG,Qi,{use:0,class:1,stickyHeader:2,sortable:28,sort:26,sortDirection:27,sortAscendingAriaLabel:29,sortDescendingAriaLabel:30,container$use:3,container$class:4,table$use:5,table$class:6,layout:31,getElement:32},null,[-1,-1])}get layout(){return this.$$.ctx[31]}get getElement(){return this.$$.ctx[32]}}function iG(n){let e,t,i,r,a;const l=n[10].default,s=Ri(l,n,n[9],null);let d=[n[7]],g={};for(let x=0;x<d.length;x+=1)g=zt(g,d[x]);return{c(){e=qt("thead"),s&&s.c(),this.h()},l(x){e=Wt(x,"THEAD",{});var I=Qt(e);s&&s.l(I),I.forEach(de),this.h()},h(){Xn(e,g)},m(x,I){tt(x,e,I),s&&s.m(e,null),n[11](e),i=!0,r||(a=[li(t=jr.call(null,e,n[0])),li(n[3].call(null,e)),qn(e,"SMUICheckbox:mount",n[4]),qn(e,"SMUICheckbox:unmount",n[12]),qn(e,"SMUIDataTableCell:mount",n[5]),qn(e,"SMUIDataTableCell:unmount",n[6])],r=!0)},p(x,[I]){s&&s.p&&(!i||I&512)&&Pi(s,l,x,x[9],i?Oi(l,x[9],I,null):Di(x[9]),null),Xn(e,g=hi(d,[I&128&&x[7]])),t&&Gi(t.update)&&I&1&&t.update.call(null,x[0])},i(x){i||(Te(s,x),i=!0)},o(x){Ne(s,x),i=!1},d(x){x&&de(e),s&&s.d(x),n[11](null),r=!1,Ss(a)}}}function rG(n,e,t){const i=["use","getElement"];let r=vi(e,i),{$$slots:a={},$$scope:l}=e;const s=ps(ds());let{use:d=[]}=e,g,x,I=[];const A=new WeakMap;lr("SMUI:data-table:row:header",!0),ro(()=>{const Q={get cells(){return I},get orderedCells(){return F()},get checkbox(){return x}};return ji(z(),"SMUIDataTableHeader:mount",Q),()=>{ji(z(),"SMUIDataTableHeader:unmount",Q)}});function L(Q){t(2,x=Q.detail)}function N(Q){I.push(Q.detail),A.set(Q.detail.element,Q.detail),Q.stopPropagation()}function B(Q){const J=I.indexOf(Q.detail);J!==-1&&(I.splice(J,1),I=I),A.delete(Q.detail.element),Q.stopPropagation()}function F(){return[...z().querySelectorAll(".mdc-data-table__header-cell")].map(Q=>A.get(Q)).filter(Q=>Q&&Q._smui_data_table_header_cell_accessor)}function z(){return g}function V(Q){Sn[Q?"unshift":"push"](()=>{g=Q,t(1,g)})}const Y=()=>t(2,x=void 0);return n.$$set=Q=>{e=zt(zt({},e),ls(Q)),t(7,r=vi(e,i)),"use"in Q&&t(0,d=Q.use),"$$scope"in Q&&t(9,l=Q.$$scope)},[d,g,x,s,L,N,B,r,z,l,a,V,Y]}class sG extends sr{constructor(e){super(),or(this,e,rG,iG,Qi,{use:0,getElement:8})}get getElement(){return this.$$.ctx[8]}}function oG(n){let e,t,i,r,a,l;const s=n[9].default,d=Ri(s,n,n[8],null);let g=[{class:t=In({[n[1]]:!0,"mdc-data-table__content":!0})},n[6]],x={};for(let I=0;I<g.length;I+=1)x=zt(x,g[I]);return{c(){e=qt("tbody"),d&&d.c(),this.h()},l(I){e=Wt(I,"TBODY",{class:!0});var A=Qt(e);d&&d.l(A),A.forEach(de),this.h()},h(){Xn(e,x)},m(I,A){tt(I,e,A),d&&d.m(e,null),n[10](e),r=!0,a||(l=[li(i=jr.call(null,e,n[0])),li(n[3].call(null,e)),qn(e,"SMUIDataTableRow:mount",n[4]),qn(e,"SMUIDataTableRow:unmount",n[5])],a=!0)},p(I,[A]){d&&d.p&&(!r||A&256)&&Pi(d,s,I,I[8],r?Oi(s,I[8],A,null):Di(I[8]),null),Xn(e,x=hi(g,[(!r||A&2&&t!==(t=In({[I[1]]:!0,"mdc-data-table__content":!0})))&&{class:t},A&64&&I[6]])),i&&Gi(i.update)&&A&1&&i.update.call(null,I[0])},i(I){r||(Te(d,I),r=!0)},o(I){Ne(d,I),r=!1},d(I){I&&de(e),d&&d.d(I),n[10](null),a=!1,Ss(l)}}}function aG(n,e,t){const i=["use","class","getElement"];let r=vi(e,i),{$$slots:a={},$$scope:l}=e;const s=ps(ds());let{use:d=[]}=e,{class:g=""}=e,x,I=[];const A=new WeakMap;lr("SMUI:data-table:row:header",!1),ro(()=>{const V={get rows(){return I},get orderedRows(){return B()}};return ji(F(),"SMUIDataTableBody:mount",V),()=>{ji(F(),"SMUIDataTableBody:unmount",V)}});function L(V){I.push(V.detail),A.set(V.detail.element,V.detail),V.stopPropagation()}function N(V){const Y=I.indexOf(V.detail);Y!==-1&&(I.splice(Y,1),I=I),A.delete(V.detail.element),V.stopPropagation()}function B(){return[...F().querySelectorAll(".mdc-data-table__row")].map(V=>A.get(V)).filter(V=>V&&V._smui_data_table_row_accessor)}function F(){return x}function z(V){Sn[V?"unshift":"push"](()=>{x=V,t(2,x)})}return n.$$set=V=>{e=zt(zt({},e),ls(V)),t(6,r=vi(e,i)),"use"in V&&t(0,d=V.use),"class"in V&&t(1,g=V.class),"$$scope"in V&&t(8,l=V.$$scope)},[d,g,x,s,L,N,r,F,l,a,z]}class lG extends sr{constructor(e){super(),or(this,e,aG,oG,Qi,{use:0,class:1,getElement:7})}get getElement(){return this.$$.ctx[7]}}function uG(n){let e,t,i,r,a,l,s;const d=n[15].default,g=Ri(d,n,n[14],null);let x=[{class:t=In({[n[1]]:!0,"mdc-data-table__header-row":n[7],"mdc-data-table__row":!n[7],"mdc-data-table__row--selected":!n[7]&&n[3]&&n[3].checked,...n[4]})},{"aria-selected":i=n[3]?n[3].checked?"true":"false":void 0},n[5],n[11]],I={};for(let A=0;A<x.length;A+=1)I=zt(I,x[A]);return{c(){e=qt("tr"),g&&g.c(),this.h()},l(A){e=Wt(A,"TR",{class:!0,"aria-selected":!0});var L=Qt(e);g&&g.l(L),L.forEach(de),this.h()},h(){Xn(e,I)},m(A,L){tt(A,e,L),g&&g.m(e,null),n[16](e),a=!0,l||(s=[li(r=jr.call(null,e,n[0])),li(n[6].call(null,e)),qn(e,"click",n[17]),qn(e,"SMUICheckbox:mount",n[8]),qn(e,"SMUICheckbox:unmount",n[18])],l=!0)},p(A,[L]){g&&g.p&&(!a||L&16384)&&Pi(g,d,A,A[14],a?Oi(d,A[14],L,null):Di(A[14]),null),Xn(e,I=hi(x,[(!a||L&26&&t!==(t=In({[A[1]]:!0,"mdc-data-table__header-row":A[7],"mdc-data-table__row":!A[7],"mdc-data-table__row--selected":!A[7]&&A[3]&&A[3].checked,...A[4]})))&&{class:t},(!a||L&8&&i!==(i=A[3]?A[3].checked?"true":"false":void 0))&&{"aria-selected":i},L&32&&A[5],L&2048&&A[11]])),r&&Gi(r.update)&&L&1&&r.update.call(null,A[0])},i(A){a||(Te(g,A),a=!0)},o(A){Ne(g,A),a=!1},d(A){A&&de(e),g&&g.d(A),n[16](null),l=!1,Ss(s)}}}let cG=0;function hG(n,e,t){const i=["use","class","rowId","getElement"];let r=vi(e,i),{$$slots:a={},$$scope:l}=e;const s=ps(ds());let{use:d=[]}=e,{class:g=""}=e,{rowId:x="SMUI-data-table-row-"+cG++}=e,I,A,L={},N={},B=Fr("SMUI:data-table:row:header");ro(()=>{const le=B?{_smui_data_table_row_accessor:!1,get element(){return ee()},get checkbox(){return A},get rowId(){},get selected(){var Be;return(Be=A&&A.checked)!==null&&Be!==void 0?Be:!1},addClass:z,removeClass:V,getAttr:Y,addAttr:Q}:{_smui_data_table_row_accessor:!0,get element(){return ee()},get checkbox(){return A},get rowId(){return x},get selected(){var Be;return(Be=A&&A.checked)!==null&&Be!==void 0?Be:!1},addClass:z,removeClass:V,getAttr:Y,addAttr:Q};return ji(ee(),"SMUIDataTableRow:mount",le),()=>{ji(ee(),"SMUIDataTableRow:unmount",le)}});function F(le){t(3,A=le.detail)}function z(le){L[le]||t(4,L[le]=!0,L)}function V(le){(!(le in L)||L[le])&&t(4,L[le]=!1,L)}function Y(le){var Be;return le in N?(Be=N[le])!==null&&Be!==void 0?Be:null:ee().getAttribute(le)}function Q(le,Be){N[le]!==Be&&t(5,N[le]=Be,N)}function J(le){ji(ee(),"SMUIDataTableHeader:click",le)}function he(le){ji(ee(),"SMUIDataTableRow:click",{rowId:x,target:le.target})}function ee(){return I}function ae(le){Sn[le?"unshift":"push"](()=>{I=le,t(2,I)})}const De=le=>B?J(le):he(le),fe=()=>t(3,A=void 0);return n.$$set=le=>{e=zt(zt({},e),ls(le)),t(11,r=vi(e,i)),"use"in le&&t(0,d=le.use),"class"in le&&t(1,g=le.class),"rowId"in le&&t(12,x=le.rowId),"$$scope"in le&&t(14,l=le.$$scope)},[d,g,I,A,L,N,s,B,F,J,he,r,x,ee,l,a,ae,De,fe]}class xP extends sr{constructor(e){super(),or(this,e,hG,uG,Qi,{use:0,class:1,rowId:12,getElement:13})}get getElement(){return this.$$.ctx[13]}}function fG(n){let e,t,i,r,a,l;const s=n[22].default,d=Ri(s,n,n[21],null);let g=[{class:t=In({[n[1]]:!0,"mdc-data-table__cell":!0,"mdc-data-table__cell--numeric":n[2],"mdc-data-table__cell--checkbox":n[3],...n[7]})},n[8],n[19]],x={};for(let I=0;I<g.length;I+=1)x=zt(x,g[I]);return{c(){e=qt("td"),d&&d.c(),this.h()},l(I){e=Wt(I,"TD",{class:!0});var A=Qt(e);d&&d.l(A),A.forEach(de),this.h()},h(){Xn(e,x)},m(I,A){tt(I,e,A),d&&d.m(e,null),n[25](e),r=!0,a||(l=[li(i=jr.call(null,e,n[0])),li(n[11].call(null,e)),qn(e,"change",n[26])],a=!0)},p(I,A){d&&d.p&&(!r||A&2097152)&&Pi(d,s,I,I[21],r?Oi(s,I[21],A,null):Di(I[21]),null),Xn(e,x=hi(g,[(!r||A&142&&t!==(t=In({[I[1]]:!0,"mdc-data-table__cell":!0,"mdc-data-table__cell--numeric":I[2],"mdc-data-table__cell--checkbox":I[3],...I[7]})))&&{class:t},A&256&&I[8],A&524288&&I[19]])),i&&Gi(i.update)&&A&1&&i.update.call(null,I[0])},i(I){r||(Te(d,I),r=!0)},o(I){Ne(d,I),r=!1},d(I){I&&de(e),d&&d.d(I),n[25](null),a=!1,Ss(l)}}}function dG(n){let e,t,i,r,a,l,s,d,g;const x=[mG,pG],I=[];function A(B,F){return B[5]?0:1}t=A(n),i=I[t]=x[t](n);let L=[{class:r=In({[n[1]]:!0,"mdc-data-table__header-cell":!0,"mdc-data-table__header-cell--numeric":n[2],"mdc-data-table__header-cell--checkbox":n[3],"mdc-data-table__header-cell--with-sort":n[5],"mdc-data-table__header-cell--sorted":n[5]&&n[9]===n[4],...n[7]})},{role:"columnheader"},{scope:"col"},{"data-column-id":n[4]},{"aria-sort":a=n[5]?n[9]===n[4]?n[10]:"none":void 0},n[8],n[19]],N={};for(let B=0;B<L.length;B+=1)N=zt(N,L[B]);return{c(){e=qt("th"),i.c(),this.h()},l(B){e=Wt(B,"TH",{class:!0,role:!0,scope:!0,"data-column-id":!0,"aria-sort":!0});var F=Qt(e);i.l(F),F.forEach(de),this.h()},h(){Xn(e,N)},m(B,F){tt(B,e,F),I[t].m(e,null),n[23](e),s=!0,d||(g=[li(l=jr.call(null,e,n[0])),li(n[11].call(null,e)),qn(e,"change",n[24])],d=!0)},p(B,F){let z=t;t=A(B),t===z?I[t].p(B,F):(Wi(),Ne(I[z],1,1,()=>{I[z]=null}),Xi(),i=I[t],i?i.p(B,F):(i=I[t]=x[t](B),i.c()),Te(i,1),i.m(e,null)),Xn(e,N=hi(L,[(!s||F&702&&r!==(r=In({[B[1]]:!0,"mdc-data-table__header-cell":!0,"mdc-data-table__header-cell--numeric":B[2],"mdc-data-table__header-cell--checkbox":B[3],"mdc-data-table__header-cell--with-sort":B[5],"mdc-data-table__header-cell--sorted":B[5]&&B[9]===B[4],...B[7]})))&&{class:r},{role:"columnheader"},{scope:"col"},(!s||F&16)&&{"data-column-id":B[4]},(!s||F&1584&&a!==(a=B[5]?B[9]===B[4]?B[10]:"none":void 0))&&{"aria-sort":a},F&256&&B[8],F&524288&&B[19]])),l&&Gi(l.update)&&F&1&&l.update.call(null,B[0])},i(B){s||(Te(i),s=!0)},o(B){Ne(i),s=!1},d(B){B&&de(e),I[t].d(),n[23](null),d=!1,Ss(g)}}}function pG(n){let e;const t=n[22].default,i=Ri(t,n,n[21],null);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a&2097152)&&Pi(i,t,r,r[21],e?Oi(t,r[21],a,null):Di(r[21]),null)},i(r){e||(Te(i,r),e=!0)},o(r){Ne(i,r),e=!1},d(r){i&&i.d(r)}}}function mG(n){let e,t,i,r=(n[9]===n[4]?n[10]==="ascending"?n[15]:n[16]:"")+"",a,l,s;const d=n[22].default,g=Ri(d,n,n[21],null);return{c(){e=qt("div"),g&&g.c(),t=vn(),i=qt("div"),a=_i(r),this.h()},l(x){e=Wt(x,"DIV",{class:!0});var I=Qt(e);g&&g.l(I),t=bn(I),i=Wt(I,"DIV",{class:!0,"aria-hidden":!0,id:!0});var A=Qt(i);a=yi(A,r),A.forEach(de),I.forEach(de),this.h()},h(){tn(i,"class","mdc-data-table__sort-status-label"),tn(i,"aria-hidden","true"),tn(i,"id",l=n[4]+"-status-label"),tn(e,"class","mdc-data-table__header-cell-wrapper")},m(x,I){tt(x,e,I),g&&g.m(e,null),Kt(e,t),Kt(e,i),Kt(i,a),s=!0},p(x,I){g&&g.p&&(!s||I&2097152)&&Pi(g,d,x,x[21],s?Oi(d,x[21],I,null):Di(x[21]),null),(!s||I&1552)&&r!==(r=(x[9]===x[4]?x[10]==="ascending"?x[15]:x[16]:"")+"")&&ys(a,r),(!s||I&16&&l!==(l=x[4]+"-status-label"))&&tn(i,"id",l)},i(x){s||(Te(g,x),s=!0)},o(x){Ne(g,x),s=!1},d(x){x&&de(e),g&&g.d(x)}}}function gG(n){let e,t,i,r;const a=[dG,fG],l=[];function s(d,g){return d[12]?0:1}return e=s(n),t=l[e]=a[e](n),{c(){t.c(),i=pi()},l(d){t.l(d),i=pi()},m(d,g){l[e].m(d,g),tt(d,i,g),r=!0},p(d,[g]){t.p(d,g)},i(d){r||(Te(t),r=!0)},o(d){Ne(t),r=!1},d(d){l[e].d(d),d&&de(i)}}}let _G=0;function yG(n,e,t){const i=["use","class","numeric","checkbox","columnId","sortable","getElement"];let r=vi(e,i),a,l,{$$slots:s={},$$scope:d}=e;const g=ps(ds());let x=Fr("SMUI:data-table:row:header"),{use:I=[]}=e,{class:A=""}=e,{numeric:L=!1}=e,{checkbox:N=!1}=e,{columnId:B=x?"SMUI-data-table-column-"+_G++:"SMUI-data-table-unused"}=e,{sortable:F=Fr("SMUI:data-table:sortable")}=e,z,V={},Y={},Q=Fr("SMUI:data-table:sort");Dl(n,Q,ke=>t(9,a=ke));let J=Fr("SMUI:data-table:sortDirection");Dl(n,J,ke=>t(10,l=ke));let he=Fr("SMUI:data-table:sortAscendingAriaLabel"),ee=Fr("SMUI:data-table:sortDescendingAriaLabel");F&&(lr("SMUI:label:context","data-table:sortable-header-cell"),lr("SMUI:icon-button:context","data-table:sortable-header-cell"),lr("SMUI:icon-button:aria-describedby",B+"-status-label")),ro(()=>{const ke=x?{_smui_data_table_header_cell_accessor:!0,get element(){return Ce()},get columnId(){return B},addClass:ae,removeClass:De,getAttr:fe,addAttr:le}:{_smui_data_table_header_cell_accessor:!1,get element(){return Ce()},get columnId(){},addClass:ae,removeClass:De,getAttr:fe,addAttr:le};return ji(Ce(),"SMUIDataTableCell:mount",ke),()=>{ji(Ce(),"SMUIDataTableCell:unmount",ke)}});function ae(ke){V[ke]||t(7,V[ke]=!0,V)}function De(ke){(!(ke in V)||V[ke])&&t(7,V[ke]=!1,V)}function fe(ke){var Dt;return ke in Y?(Dt=Y[ke])!==null&&Dt!==void 0?Dt:null:Ce().getAttribute(ke)}function le(ke,Dt){Y[ke]!==Dt&&t(8,Y[ke]=Dt,Y)}function Be(ke){ji(Ce(),"SMUIDataTableHeaderCheckbox:change",ke)}function Pe(ke){ji(Ce(),"SMUIDataTableBodyCheckbox:change",ke)}function Ce(){return z}function it(ke){Sn[ke?"unshift":"push"](()=>{z=ke,t(6,z)})}const Et=ke=>N&&Be(ke);function Ue(ke){Sn[ke?"unshift":"push"](()=>{z=ke,t(6,z)})}const at=ke=>N&&Pe(ke);return n.$$set=ke=>{e=zt(zt({},e),ls(ke)),t(19,r=vi(e,i)),"use"in ke&&t(0,I=ke.use),"class"in ke&&t(1,A=ke.class),"numeric"in ke&&t(2,L=ke.numeric),"checkbox"in ke&&t(3,N=ke.checkbox),"columnId"in ke&&t(4,B=ke.columnId),"sortable"in ke&&t(5,F=ke.sortable),"$$scope"in ke&&t(21,d=ke.$$scope)},[I,A,L,N,B,F,z,V,Y,a,l,g,x,Q,J,he,ee,Be,Pe,r,Ce,d,s,it,Et,Ue,at]}class EP extends sr{constructor(e){super(),or(this,e,yG,gG,Qi,{use:0,class:1,numeric:2,checkbox:3,columnId:4,sortable:5,getElement:20})}get getElement(){return this.$$.ctx[20]}}const vG=n=>({}),WM=n=>({}),bG=n=>({}),XM=n=>({});function ZM(n){let e,t;const i=n[10].rowsPerPage,r=Ri(i,n,n[9],XM);return{c(){e=qt("div"),r&&r.c(),this.h()},l(a){e=Wt(a,"DIV",{class:!0});var l=Qt(e);r&&r.l(l),l.forEach(de),this.h()},h(){tn(e,"class","mdc-data-table__pagination-rows-per-page")},m(a,l){tt(a,e,l),r&&r.m(e,null),t=!0},p(a,l){r&&r.p&&(!t||l&512)&&Pi(r,i,a,a[9],t?Oi(i,a[9],l,bG):Di(a[9]),XM)},i(a){t||(Te(r,a),t=!0)},o(a){Ne(r,a),t=!1},d(a){a&&de(e),r&&r.d(a)}}}function YM(n){let e,t;const i=n[10].total,r=Ri(i,n,n[9],WM);return{c(){e=qt("div"),r&&r.c(),this.h()},l(a){e=Wt(a,"DIV",{class:!0});var l=Qt(e);r&&r.l(l),l.forEach(de),this.h()},h(){tn(e,"class","mdc-data-table__pagination-total")},m(a,l){tt(a,e,l),r&&r.m(e,null),t=!0},p(a,l){r&&r.p&&(!t||l&512)&&Pi(r,i,a,a[9],t?Oi(i,a[9],l,vG):Di(a[9]),WM)},i(a){t||(Te(r,a),t=!0)},o(a){Ne(r,a),t=!1},d(a){a&&de(e),r&&r.d(a)}}}function xG(n){let e,t,i,r,a,l,s,d,g,x,I,A,L=n[7].rowsPerPage&&ZM(n),N=n[7].total&&YM(n);const B=n[10].default,F=Ri(B,n,n[9],null);let z=[{class:l=In({[n[3]]:!0,"mdc-data-table__pagination-trailing":!0})},gi(n[6],"trailing$")],V={};for(let J=0;J<z.length;J+=1)V=zt(V,z[J]);let Y=[{class:d=In({[n[1]]:!0,"mdc-data-table__pagination":!0})},jo(n[6],["trailing$"])],Q={};for(let J=0;J<Y.length;J+=1)Q=zt(Q,Y[J]);return{c(){e=qt("div"),t=qt("div"),L&&L.c(),i=vn(),r=qt("div"),N&&N.c(),a=vn(),F&&F.c(),this.h()},l(J){e=Wt(J,"DIV",{class:!0});var he=Qt(e);t=Wt(he,"DIV",{class:!0});var ee=Qt(t);L&&L.l(ee),i=bn(ee),r=Wt(ee,"DIV",{class:!0});var ae=Qt(r);N&&N.l(ae),a=bn(ae),F&&F.l(ae),ae.forEach(de),ee.forEach(de),he.forEach(de),this.h()},h(){tn(r,"class","mdc-data-table__pagination-navigation"),Xn(t,V),Xn(e,Q)},m(J,he){tt(J,e,he),Kt(e,t),L&&L.m(t,null),Kt(t,i),Kt(t,r),N&&N.m(r,null),Kt(r,a),F&&F.m(r,null),n[11](e),x=!0,I||(A=[li(s=jr.call(null,t,n[2])),li(g=jr.call(null,e,n[0])),li(n[5].call(null,e))],I=!0)},p(J,[he]){J[7].rowsPerPage?L?(L.p(J,he),he&128&&Te(L,1)):(L=ZM(J),L.c(),Te(L,1),L.m(t,i)):L&&(Wi(),Ne(L,1,1,()=>{L=null}),Xi()),J[7].total?N?(N.p(J,he),he&128&&Te(N,1)):(N=YM(J),N.c(),Te(N,1),N.m(r,a)):N&&(Wi(),Ne(N,1,1,()=>{N=null}),Xi()),F&&F.p&&(!x||he&512)&&Pi(F,B,J,J[9],x?Oi(B,J[9],he,null):Di(J[9]),null),Xn(t,V=hi(z,[(!x||he&8&&l!==(l=In({[J[3]]:!0,"mdc-data-table__pagination-trailing":!0})))&&{class:l},he&64&&gi(J[6],"trailing$")])),s&&Gi(s.update)&&he&4&&s.update.call(null,J[2]),Xn(e,Q=hi(Y,[(!x||he&2&&d!==(d=In({[J[1]]:!0,"mdc-data-table__pagination":!0})))&&{class:d},he&64&&jo(J[6],["trailing$"])])),g&&Gi(g.update)&&he&1&&g.update.call(null,J[0])},i(J){x||(Te(L),Te(N),Te(F,J),x=!0)},o(J){Ne(L),Ne(N),Ne(F,J),x=!1},d(J){J&&de(e),L&&L.d(),N&&N.d(),F&&F.d(J),n[11](null),I=!1,Ss(A)}}}function EG(n,e,t){const i=["use","class","trailing$use","trailing$class","getElement"];let r=vi(e,i),{$$slots:a={},$$scope:l}=e;const s=uI(a),d=ps(ds());let{use:g=[]}=e,{class:x=""}=e,{trailing$use:I=[]}=e,{trailing$class:A=""}=e,L;lr("SMUI:label:context","data-table:pagination"),lr("SMUI:select:context","data-table:pagination"),lr("SMUI:icon-button:context","data-table:pagination");function N(){return L}function B(F){Sn[F?"unshift":"push"](()=>{L=F,t(4,L)})}return n.$$set=F=>{e=zt(zt({},e),ls(F)),t(6,r=vi(e,i)),"use"in F&&t(0,g=F.use),"class"in F&&t(1,x=F.class),"trailing$use"in F&&t(2,I=F.trailing$use),"trailing$class"in F&&t(3,A=F.trailing$class),"$$scope"in F&&t(9,l=F.$$scope)},[g,x,I,A,L,d,r,s,N,l,a,B]}class IG extends sr{constructor(e){super(),or(this,e,EG,xG,Qi,{use:0,class:1,trailing$use:2,trailing$class:3,getElement:8})}get getElement(){return this.$$.ctx[8]}}function KM(n,e,t){const i=n.slice();return i[15]=e[t],i}function JM(n,e,t){const i=n.slice();return i[18]=e[t],i}function QM(n,e,t){const i=n.slice();return i[18]=e[t],i}function TG(n){let e=n[18]+"",t;return{c(){t=_i(e)},l(i){t=yi(i,e)},m(i,r){tt(i,t,r)},p(i,r){r&4&&e!==(e=i[18]+"")&&ys(t,e)},d(i){i&&de(t)}}}function $M(n){let e,t;return e=new EP({props:{$$slots:{default:[TG]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,r){on(e,i,r),t=!0},p(i,r){const a={};r&8388612&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Te(e.$$.fragment,i),t=!0)},o(i){Ne(e.$$.fragment,i),t=!1},d(i){an(e,i)}}}function wG(n){let e,t,i=Object.keys(n[2]),r=[];for(let l=0;l<i.length;l+=1)r[l]=$M(QM(n,i,l));const a=l=>Ne(r[l],1,1,()=>{r[l]=null});return{c(){for(let l=0;l<r.length;l+=1)r[l].c();e=pi()},l(l){for(let s=0;s<r.length;s+=1)r[s].l(l);e=pi()},m(l,s){for(let d=0;d<r.length;d+=1)r[d]&&r[d].m(l,s);tt(l,e,s),t=!0},p(l,s){if(s&4){i=Object.keys(l[2]);let d;for(d=0;d<i.length;d+=1){const g=QM(l,i,d);r[d]?(r[d].p(g,s),Te(r[d],1)):(r[d]=$M(g),r[d].c(),Te(r[d],1),r[d].m(e.parentNode,e))}for(Wi(),d=i.length;d<r.length;d+=1)a(d);Xi()}},i(l){if(!t){for(let s=0;s<i.length;s+=1)Te(r[s]);t=!0}},o(l){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)Ne(r[s]);t=!1},d(l){vm(r,l),l&&de(e)}}}function SG(n){let e,t;return e=new xP({props:{$$slots:{default:[wG]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,r){on(e,i,r),t=!0},p(i,r){const a={};r&8388612&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Te(e.$$.fragment,i),t=!0)},o(i){Ne(e.$$.fragment,i),t=!1},d(i){an(e,i)}}}function CG(n){let e=n[15].properties[n[18]]+"",t;return{c(){t=_i(e)},l(i){t=yi(i,e)},m(i,r){tt(i,t,r)},p(i,r){r&260&&e!==(e=i[15].properties[i[18]]+"")&&ys(t,e)},d(i){i&&de(t)}}}function eL(n){let e,t;return e=new EP({props:{$$slots:{default:[CG]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,r){on(e,i,r),t=!0},p(i,r){const a={};r&8388868&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Te(e.$$.fragment,i),t=!0)},o(i){Ne(e.$$.fragment,i),t=!1},d(i){an(e,i)}}}function AG(n){let e,t,i=Object.keys(n[2]),r=[];for(let l=0;l<i.length;l+=1)r[l]=eL(JM(n,i,l));const a=l=>Ne(r[l],1,1,()=>{r[l]=null});return{c(){for(let l=0;l<r.length;l+=1)r[l].c();e=vn()},l(l){for(let s=0;s<r.length;s+=1)r[s].l(l);e=bn(l)},m(l,s){for(let d=0;d<r.length;d+=1)r[d]&&r[d].m(l,s);tt(l,e,s),t=!0},p(l,s){if(s&260){i=Object.keys(l[2]);let d;for(d=0;d<i.length;d+=1){const g=JM(l,i,d);r[d]?(r[d].p(g,s),Te(r[d],1)):(r[d]=eL(g),r[d].c(),Te(r[d],1),r[d].m(e.parentNode,e))}for(Wi(),d=i.length;d<r.length;d+=1)a(d);Xi()}},i(l){if(!t){for(let s=0;s<i.length;s+=1)Te(r[s]);t=!0}},o(l){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)Ne(r[s]);t=!1},d(l){vm(r,l),l&&de(e)}}}function tL(n){let e,t;return e=new xP({props:{$$slots:{default:[AG]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,r){on(e,i,r),t=!0},p(i,r){const a={};r&8388868&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Te(e.$$.fragment,i),t=!0)},o(i){Ne(e.$$.fragment,i),t=!1},d(i){an(e,i)}}}function MG(n){let e,t,i=n[8],r=[];for(let l=0;l<i.length;l+=1)r[l]=tL(KM(n,i,l));const a=l=>Ne(r[l],1,1,()=>{r[l]=null});return{c(){for(let l=0;l<r.length;l+=1)r[l].c();e=pi()},l(l){for(let s=0;s<r.length;s+=1)r[s].l(l);e=pi()},m(l,s){for(let d=0;d<r.length;d+=1)r[d]&&r[d].m(l,s);tt(l,e,s),t=!0},p(l,s){if(s&260){i=l[8];let d;for(d=0;d<i.length;d+=1){const g=KM(l,i,d);r[d]?(r[d].p(g,s),Te(r[d],1)):(r[d]=tL(g),r[d].c(),Te(r[d],1),r[d].m(e.parentNode,e))}for(Wi(),d=i.length;d<r.length;d+=1)a(d);Xi()}},i(l){if(!t){for(let s=0;s<i.length;s+=1)Te(r[s]);t=!0}},o(l){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)Ne(r[s]);t=!1},d(l){vm(r,l),l&&de(e)}}}function LG(n){let e,t,i,r;return e=new sG({props:{$$slots:{default:[SG]},$$scope:{ctx:n}}}),i=new lG({props:{$$slots:{default:[MG]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment),t=vn(),sn(i.$$.fragment)},l(a){dn(e.$$.fragment,a),t=bn(a),dn(i.$$.fragment,a)},m(a,l){on(e,a,l),tt(a,t,l),on(i,a,l),r=!0},p(a,l){const s={};l&8388612&&(s.$$scope={dirty:l,ctx:a}),e.$set(s);const d={};l&8388868&&(d.$$scope={dirty:l,ctx:a}),i.$set(d)},i(a){r||(Te(e.$$.fragment,a),Te(i.$$.fragment,a),r=!0)},o(a){Ne(e.$$.fragment,a),Ne(i.$$.fragment,a),r=!1},d(a){an(e,a),a&&de(t),an(i,a)}}}function RG(n){let e;return{c(){e=_i("first_page")},l(t){e=yi(t,"first_page")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function PG(n){let e;return{c(){e=_i("chevron_left")},l(t){e=yi(t,"chevron_left")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function DG(n){let e;return{c(){e=_i("chevron_right")},l(t){e=yi(t,"chevron_right")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function OG(n){let e;return{c(){e=_i("last_page")},l(t){e=yi(t,"last_page")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function NG(n){let e,t,i,r,a,l,s,d;return e=new xf({props:{class:"material-icons",action:"first-page",title:"First page",disabled:n[4]===0,$$slots:{default:[RG]},$$scope:{ctx:n}}}),e.$on("click",n[10]),i=new xf({props:{class:"material-icons",action:"prev-page",title:"Prev page",disabled:n[4]===0,$$slots:{default:[PG]},$$scope:{ctx:n}}}),i.$on("click",n[11]),a=new xf({props:{class:"material-icons",action:"next-page",title:"Next page",disabled:n[4]===n[5],$$slots:{default:[DG]},$$scope:{ctx:n}}}),a.$on("click",n[12]),s=new xf({props:{class:"material-icons",action:"last-page",title:"Last page",disabled:n[4]===n[5],$$slots:{default:[OG]},$$scope:{ctx:n}}}),s.$on("click",n[13]),{c(){sn(e.$$.fragment),t=vn(),sn(i.$$.fragment),r=vn(),sn(a.$$.fragment),l=vn(),sn(s.$$.fragment)},l(g){dn(e.$$.fragment,g),t=bn(g),dn(i.$$.fragment,g),r=bn(g),dn(a.$$.fragment,g),l=bn(g),dn(s.$$.fragment,g)},m(g,x){on(e,g,x),tt(g,t,x),on(i,g,x),tt(g,r,x),on(a,g,x),tt(g,l,x),on(s,g,x),d=!0},p(g,x){const I={};x&16&&(I.disabled=g[4]===0),x&8388608&&(I.$$scope={dirty:x,ctx:g}),e.$set(I);const A={};x&16&&(A.disabled=g[4]===0),x&8388608&&(A.$$scope={dirty:x,ctx:g}),i.$set(A);const L={};x&48&&(L.disabled=g[4]===g[5]),x&8388608&&(L.$$scope={dirty:x,ctx:g}),a.$set(L);const N={};x&48&&(N.disabled=g[4]===g[5]),x&8388608&&(N.$$scope={dirty:x,ctx:g}),s.$set(N)},i(g){d||(Te(e.$$.fragment,g),Te(i.$$.fragment,g),Te(a.$$.fragment,g),Te(s.$$.fragment,g),d=!0)},o(g){Ne(e.$$.fragment,g),Ne(i.$$.fragment,g),Ne(a.$$.fragment,g),Ne(s.$$.fragment,g),d=!1},d(g){an(e,g),g&&de(t),an(i,g),g&&de(r),an(a,g),g&&de(l),an(s,g)}}}function kG(n){let e;return{c(){e=_i("Rows Per Page")},l(t){e=yi(t,"Rows Per Page")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function FG(n){let e;return{c(){e=_i("10")},l(t){e=yi(t,"10")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function BG(n){let e;return{c(){e=_i("25")},l(t){e=yi(t,"25")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function zG(n){let e;return{c(){e=_i("100")},l(t){e=yi(t,"100")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function UG(n){let e,t,i,r,a,l;return e=new Av({props:{value:10,$$slots:{default:[FG]},$$scope:{ctx:n}}}),i=new Av({props:{value:25,$$slots:{default:[BG]},$$scope:{ctx:n}}}),a=new Av({props:{value:100,$$slots:{default:[zG]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment),t=vn(),sn(i.$$.fragment),r=vn(),sn(a.$$.fragment)},l(s){dn(e.$$.fragment,s),t=bn(s),dn(i.$$.fragment,s),r=bn(s),dn(a.$$.fragment,s)},m(s,d){on(e,s,d),tt(s,t,d),on(i,s,d),tt(s,r,d),on(a,s,d),l=!0},p(s,d){const g={};d&8388608&&(g.$$scope={dirty:d,ctx:s}),e.$set(g);const x={};d&8388608&&(x.$$scope={dirty:d,ctx:s}),i.$set(x);const I={};d&8388608&&(I.$$scope={dirty:d,ctx:s}),a.$set(I)},i(s){l||(Te(e.$$.fragment,s),Te(i.$$.fragment,s),Te(a.$$.fragment,s),l=!0)},o(s){Ne(e.$$.fragment,s),Ne(i.$$.fragment,s),Ne(a.$$.fragment,s),l=!1},d(s){an(e,s),s&&de(t),an(i,s),s&&de(r),an(a,s)}}}function VG(n){let e,t,i,r,a;e=new j_({props:{$$slots:{default:[kG]},$$scope:{ctx:n}}});function l(d){n[9](d)}let s={variant:"outlined",noLabel:!0,$$slots:{default:[UG]},$$scope:{ctx:n}};return n[3]!==void 0&&(s.value=n[3]),i=new sI({props:s}),Sn.push(()=>Xr(i,"value",l)),{c(){sn(e.$$.fragment),t=vn(),sn(i.$$.fragment)},l(d){dn(e.$$.fragment,d),t=bn(d),dn(i.$$.fragment,d)},m(d,g){on(e,d,g),tt(d,t,g),on(i,d,g),a=!0},p(d,g){const x={};g&8388608&&(x.$$scope={dirty:g,ctx:d}),e.$set(x);const I={};g&8388608&&(I.$$scope={dirty:g,ctx:d}),!r&&g&8&&(r=!0,I.value=d[3],Qr(()=>r=!1)),i.$set(I)},i(d){a||(Te(e.$$.fragment,d),Te(i.$$.fragment,d),a=!0)},o(d){Ne(e.$$.fragment,d),Ne(i.$$.fragment,d),a=!1},d(d){an(e,d),d&&de(t),an(i,d)}}}function GG(n){let e=n[7]+1+"",t,i,r,a,l=n[1].data.features.length+"",s;return{c(){t=_i(e),i=_i("-"),r=_i(n[6]),a=_i(" of "),s=_i(l)},l(d){t=yi(d,e),i=yi(d,"-"),r=yi(d,n[6]),a=yi(d," of "),s=yi(d,l)},m(d,g){tt(d,t,g),tt(d,i,g),tt(d,r,g),tt(d,a,g),tt(d,s,g)},p(d,g){g&128&&e!==(e=d[7]+1+"")&&ys(t,e),g&64&&ys(r,d[6]),g&2&&l!==(l=d[1].data.features.length+"")&&ys(s,l)},d(d){d&&de(t),d&&de(i),d&&de(r),d&&de(a),d&&de(s)}}}function HG(n){let e,t;return e=new IG({props:{slot:"paginate",$$slots:{total:[GG],rowsPerPage:[VG],default:[NG]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,r){on(e,i,r),t=!0},p(i,r){const a={};r&8388858&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Te(e.$$.fragment,i),t=!0)},o(i){Ne(e.$$.fragment,i),t=!1},d(i){an(e,i)}}}function jG(n){let e,t;return e=new nG({props:{"table$aria-label":"Todo list",style:"width: 100%;",$$slots:{paginate:[HG],default:[LG]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,r){on(e,i,r),t=!0},p(i,r){const a={};r&8389118&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Te(e.$$.fragment,i),t=!0)},o(i){Ne(e.$$.fragment,i),t=!1},d(i){an(e,i)}}}function qG(n){let e,t,i;function r(l){n[14](l)}let a={fullscreen:!0,$$slots:{default:[jG]},$$scope:{ctx:n}};return n[0]!==void 0&&(a.open=n[0]),e=new KL({props:a}),Sn.push(()=>Xr(e,"open",r)),{c(){sn(e.$$.fragment)},l(l){dn(e.$$.fragment,l)},m(l,s){on(e,l,s),i=!0},p(l,[s]){const d={};s&8389118&&(d.$$scope={dirty:s,ctx:l}),!t&&s&1&&(t=!0,d.open=l[0],Qr(()=>t=!1)),e.$set(d)},i(l){i||(Te(e.$$.fragment,l),i=!0)},o(l){Ne(e.$$.fragment,l),i=!1},d(l){an(e,l)}}}function WG(n,e,t){let i,r,a,l,{open:s}=e,{geojson:d}=e,g={},x=10,I=0;function A(V){x=V,t(3,x)}const L=()=>t(4,I=0),N=()=>t(4,I--,I),B=()=>t(4,I++,I),F=()=>t(4,I=l);function z(V){s=V,t(0,s)}return n.$$set=V=>{"open"in V&&t(0,s=V.open),"geojson"in V&&t(1,d=V.geojson)},n.$$.update=()=>{if(n.$$.dirty&7&&(t(2,g={}),s))for(const V of d.data.features)for(const Y in V.properties)g[Y]?g[Y].push(V.properties[Y]):t(2,g[Y]=[V.properties[Y]],g);n.$$.dirty&10&&t(5,l=Math.max(Math.ceil(d.data.features.length/x)-1,0)),n.$$.dirty&48&&I>l&&t(4,I=l),n.$$.dirty&24&&t(7,i=I*x),n.$$.dirty&138&&t(6,r=Math.min(i+x,d.data.features.length)),n.$$.dirty&194&&t(8,a=d.data.features.slice(i,r))},[s,d,g,x,I,l,r,i,a,A,L,N,B,F,z]}class XG extends sr{constructor(e){super(),or(this,e,WG,qG,Qi,{open:0,geojson:1})}}function nL(n,e,t){const i=n.slice();return i[14]=e[t][0],i[15]=e[t][1],i}function iL(n){let e,t,i=n[14]+"",r,a,l=n[15]+"",s;return{c(){e=qt("div"),t=qt("span"),r=_i(i),a=_i(": "),s=_i(l),this.h()},l(d){e=Wt(d,"DIV",{class:!0});var g=Qt(e);t=Wt(g,"SPAN",{class:!0});var x=Qt(t);r=yi(x,i),x.forEach(de),a=yi(g,": "),s=yi(g,l),g.forEach(de),this.h()},h(){tn(t,"class","key svelte-1ldkyrh"),tn(e,"class","stat svelte-1ldkyrh")},m(d,g){tt(d,e,g),Kt(e,t),Kt(t,r),Kt(e,a),Kt(e,s)},p(d,g){g&2&&i!==(i=d[14]+"")&&ys(r,i),g&2&&l!==(l=d[15]+"")&&ys(s,l)},d(d){d&&de(e)}}}function rL(n){let e,t,i,r,a,l,s,d;i=new cp({props:{variant:"unelevated",$$slots:{default:[ZG]},$$scope:{ctx:n}}}),i.$on("click",n[9]);function g(A){n[10](A)}function x(A){n[11](A)}let I={};return n[3]!==void 0&&(I.open=n[3]),n[2].geojson!==void 0&&(I.geojson=n[2].geojson),a=new XG({props:I}),Sn.push(()=>Xr(a,"open",g)),Sn.push(()=>Xr(a,"geojson",x)),{c(){e=qt("span"),t=vn(),sn(i.$$.fragment),r=vn(),sn(a.$$.fragment),this.h()},l(A){e=Wt(A,"SPAN",{style:!0}),Qt(e).forEach(de),t=bn(A),dn(i.$$.fragment,A),r=bn(A),dn(a.$$.fragment,A),this.h()},h(){wa(e,"margin-top","30px")},m(A,L){tt(A,e,L),tt(A,t,L),on(i,A,L),tt(A,r,L),on(a,A,L),d=!0},p(A,L){const N={};L&262144&&(N.$$scope={dirty:L,ctx:A}),i.$set(N);const B={};!l&&L&8&&(l=!0,B.open=A[3],Qr(()=>l=!1)),!s&&L&4&&(s=!0,B.geojson=A[2].geojson,Qr(()=>s=!1)),a.$set(B)},i(A){d||(Te(i.$$.fragment,A),Te(a.$$.fragment,A),d=!0)},o(A){Ne(i.$$.fragment,A),Ne(a.$$.fragment,A),d=!1},d(A){A&&de(e),A&&de(t),an(i,A),A&&de(r),an(a,A)}}}function ZG(n){let e;return{c(){e=_i("Show attribute table")},l(t){e=yi(t,"Show attribute table")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function sL(n){let e,t,i,r,a,l,s;function d(I){n[12](I)}function g(I){n[13](I)}let x={label:"EPSG"};return n[4]!==void 0&&(x.value=n[4]),n[5]!==void 0&&(x.invalid=n[5]),t=new FS({props:x}),Sn.push(()=>Xr(t,"value",d)),Sn.push(()=>Xr(t,"invalid",g)),l=new cp({props:{variant:"unelevated",style:"flex: 1;",$$slots:{default:[YG]},$$scope:{ctx:n}}}),l.$on("click",n[7]),{c(){e=qt("span"),sn(t.$$.fragment),a=vn(),sn(l.$$.fragment),this.h()},l(I){e=Wt(I,"SPAN",{style:!0});var A=Qt(e);dn(t.$$.fragment,A),a=bn(A),dn(l.$$.fragment,A),A.forEach(de),this.h()},h(){wa(e,"display","flex"),wa(e,"align-items","center"),wa(e,"gap","20px"),wa(e,"margin-top","20px")},m(I,A){tt(I,e,A),on(t,e,null),Kt(e,a),on(l,e,null),s=!0},p(I,A){const L={};!i&&A&16&&(i=!0,L.value=I[4],Qr(()=>i=!1)),!r&&A&32&&(r=!0,L.invalid=I[5],Qr(()=>r=!1)),t.$set(L);const N={};A&262144&&(N.$$scope={dirty:A,ctx:I}),l.$set(N)},i(I){s||(Te(t.$$.fragment,I),Te(l.$$.fragment,I),s=!0)},o(I){Ne(t.$$.fragment,I),Ne(l.$$.fragment,I),s=!1},d(I){I&&de(e),an(t),an(l)}}}function YG(n){let e;return{c(){e=_i("Set")},l(t){e=yi(t,"Set")},m(t,i){tt(t,e,i)},d(t){t&&de(e)}}}function KG(n){let e,t,i,r,a,l,s=Array.from(n[1]),d=[];for(let I=0;I<s.length;I+=1)d[I]=iL(nL(n,s,I));let g=n[2]&&n[6]&&rL(n),x=n[0].projectionName===void 0&&sL(n);return{c(){e=qt("span"),t=vn();for(let I=0;I<d.length;I+=1)d[I].c();i=vn(),g&&g.c(),r=vn(),x&&x.c(),a=pi(),this.h()},l(I){e=Wt(I,"SPAN",{style:!0}),Qt(e).forEach(de),t=bn(I);for(let A=0;A<d.length;A+=1)d[A].l(I);i=bn(I),g&&g.l(I),r=bn(I),x&&x.l(I),a=pi(),this.h()},h(){wa(e,"margin-top","20px")},m(I,A){tt(I,e,A),tt(I,t,A);for(let L=0;L<d.length;L+=1)d[L]&&d[L].m(I,A);tt(I,i,A),g&&g.m(I,A),tt(I,r,A),x&&x.m(I,A),tt(I,a,A),l=!0},p(I,[A]){if(A&2){s=Array.from(I[1]);let L;for(L=0;L<s.length;L+=1){const N=nL(I,s,L);d[L]?d[L].p(N,A):(d[L]=iL(N),d[L].c(),d[L].m(i.parentNode,i))}for(;L<d.length;L+=1)d[L].d(1);d.length=s.length}I[2]&&I[6]?g?(g.p(I,A),A&68&&Te(g,1)):(g=rL(I),g.c(),Te(g,1),g.m(r.parentNode,r)):g&&(Wi(),Ne(g,1,1,()=>{g=null}),Xi()),I[0].projectionName===void 0?x?(x.p(I,A),A&1&&Te(x,1)):(x=sL(I),x.c(),Te(x,1),x.m(a.parentNode,a)):x&&(Wi(),Ne(x,1,1,()=>{x=null}),Xi())},i(I){l||(Te(g),Te(x),l=!0)},o(I){Ne(g),Ne(x),l=!1},d(I){I&&de(e),I&&de(t),vm(d,I),I&&de(i),g&&g.d(I),I&&de(r),x&&x.d(I),I&&de(a)}}}function JG(n,e,t){let i,r,{layer:a}=e,{map:l}=e,s=new Map,d=!1,g="",x=!1;async function I(){try{const z=await G1(g),V=await G1("4326"),Y=rc(z,V),Q=a.source.data;Ef(Q)&&Q.features.forEach(J=>{J.geometry=F1(J.geometry,Y)}),t(0,a.epsg=g,a),t(0,a.projectionName=await x4(g),a),l.removeLayer(a.id),l.removeSource(a.id),l.addLayer(a)}catch{t(5,x=!0),console.error("Could not convert")}}const A=()=>{t(3,d=!0)};function L(z){d=z,t(3,d)}function N(z){n.$$.not_equal(i.geojson,z)&&(i.geojson=z,t(2,i),t(0,a))}function B(z){g=z,t(4,g)}function F(z){x=z,t(5,x)}return n.$$set=z=>{"layer"in z&&t(0,a=z.layer),"map"in z&&t(8,l=z.map)},n.$$.update=()=>{if(n.$$.dirty&3){const z=a.source.data;if(t(1,s=new Map),gd(z))if(s.set("Layer name",a.displayName),s.set("Type",z.type),a.projectionName&&s.set("From projection",a.projectionName),Ef(z)){s.set("Total number of features",z.features.length.toString());const V=wh.groupBy(z.features,Y=>Y.geometry.type);wh.forEach(V,(Y,Q)=>{s.set(`	- ${Q}s`,Y.length.toString())})}else bp(z)&&s.set("Geometry type",z.geometry.type)}n.$$.dirty&1&&t(2,i=ap(G_).find(z=>z.id===a.id.split("-")[0])),n.$$.dirty&4&&t(6,r=i&&i.geojson&&gd(i.geojson.data)&&Ef(i.geojson.data)&&i.geojson.data.features.every(z=>"properties"in z&&Object.keys(z.properties).length>0))},[a,s,i,d,g,x,r,I,l,A,L,N,B,F]}class QG extends sr{constructor(e){super(),or(this,e,JG,KG,Qi,{layer:0,map:8})}}function $G(n){let e=n[8].tabName+"",t;return{c(){t=_i(e)},l(i){t=yi(i,e)},m(i,r){tt(i,t,r)},p(i,r){r&256&&e!==(e=i[8].tabName+"")&&ys(t,e)},d(i){i&&de(t)}}}function e7(n){let e,t;return e=new j_({props:{$$slots:{default:[$G]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,r){on(e,i,r),t=!0},p(i,r){const a={};r&768&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Te(e.$$.fragment,i),t=!0)},o(i){Ne(e.$$.fragment,i),t=!1},d(i){an(e,i)}}}function t7(n){let e,t;return e=new j8({props:{tab:n[8],$$slots:{default:[e7]},$$scope:{ctx:n}}}),{c(){sn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,r){on(e,i,r),t=!0},p(i,r){const a={};r&256&&(a.tab=i[8]),r&768&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Te(e.$$.fragment,i),t=!0)},o(i){Ne(e.$$.fragment,i),t=!1},d(i){an(e,i)}}}function oL(n){let e,t,i,r;function a(d){n[5](d)}var l=n[2].component;function s(d){let g={map:d[1]};return d[0]!==void 0&&(g.layer=d[0]),{props:g}}return l&&(e=Xa(l,s(n)),Sn.push(()=>Xr(e,"layer",a)),e.$on("propertiesSet",n[6]),e.$on("closeProperties",n[7])),{c(){e&&sn(e.$$.fragment),i=pi()},l(d){e&&dn(e.$$.fragment,d),i=pi()},m(d,g){e&&on(e,d,g),tt(d,i,g),r=!0},p(d,g){const x={};if(g&2&&(x.map=d[1]),!t&&g&1&&(t=!0,x.layer=d[0],Qr(()=>t=!1)),g&4&&l!==(l=d[2].component)){if(e){Wi();const I=e;Ne(I.$$.fragment,1,0,()=>{an(I,1)}),Xi()}l?(e=Xa(l,s(d)),Sn.push(()=>Xr(e,"layer",a)),e.$on("propertiesSet",d[6]),e.$on("closeProperties",d[7]),sn(e.$$.fragment),Te(e.$$.fragment,1),on(e,i.parentNode,i)):e=null}else l&&e.$set(x)},i(d){r||(e&&Te(e.$$.fragment,d),r=!0)},o(d){e&&Ne(e.$$.fragment,d),r=!1},d(d){d&&de(i),e&&an(e,d)}}}function n7(n){let e,t,i,r,a,l;function s(x){n[4](x)}let d={tabs:n[3],$$slots:{default:[t7,({tab:x})=>({8:x}),({tab:x})=>x?256:0]},$$scope:{ctx:n}};n[2]!==void 0&&(d.active=n[2]),i=new sV({props:d}),Sn.push(()=>Xr(i,"active",s));let g=n[0]&&oL(n);return{c(){e=qt("div"),t=qt("div"),sn(i.$$.fragment),a=vn(),g&&g.c(),this.h()},l(x){e=Wt(x,"DIV",{class:!0});var I=Qt(e);t=Wt(I,"DIV",{class:!0});var A=Qt(t);dn(i.$$.fragment,A),a=bn(A),g&&g.l(A),A.forEach(de),I.forEach(de),this.h()},h(){tn(t,"class","content svelte-qwyr07"),tn(e,"class","container svelte-qwyr07")},m(x,I){tt(x,e,I),Kt(e,t),on(i,t,null),Kt(t,a),g&&g.m(t,null),l=!0},p(x,[I]){const A={};I&768&&(A.$$scope={dirty:I,ctx:x}),!r&&I&4&&(r=!0,A.active=x[2],Qr(()=>r=!1)),i.$set(A),x[0]?g?(g.p(x,I),I&1&&Te(g,1)):(g=oL(x),g.c(),Te(g,1),g.m(t,null)):g&&(Wi(),Ne(g,1,1,()=>{g=null}),Xi())},i(x){l||(Te(i.$$.fragment,x),Te(g),l=!0)},o(x){Ne(i.$$.fragment,x),Ne(g),l=!1},d(x){x&&de(e),an(i),g&&g.d()}}}function i7(n,e,t){let{layer:i}=e,{map:r}=e;const a=[{tabName:"Styling",component:YV},{tabName:"Info",component:QG}];let l=a[0];function s(I){l=I,t(2,l)}function d(I){i=I,t(0,i)}function g(I){iu.call(this,n,I)}function x(I){iu.call(this,n,I)}return n.$$set=I=>{"layer"in I&&t(0,i=I.layer),"map"in I&&t(1,r=I.map)},[i,r,l,a,s,d,g,x]}class r7 extends sr{constructor(e){super(),or(this,e,i7,n7,Qi,{layer:0,map:1})}}function aL(n){let e,t,i,r;function a(s){n[10](s)}let l={map:n[0]};return n[4]!==void 0&&(l.layer=n[4]),t=new r7({props:l}),Sn.push(()=>Xr(t,"layer",a)),t.$on("propertiesSet",n[6]),t.$on("closeProperties",n[11]),{c(){e=qt("span"),sn(t.$$.fragment),this.h()},l(s){e=Wt(s,"SPAN",{style:!0});var d=Qt(e);dn(t.$$.fragment,d),d.forEach(de),this.h()},h(){wa(e,"margin-left","auto")},m(s,d){tt(s,e,d),on(t,e,null),r=!0},p(s,d){const g={};d&1&&(g.map=s[0]),!i&&d&16&&(i=!0,g.layer=s[4],Qr(()=>i=!1)),t.$set(g)},i(s){r||(Te(t.$$.fragment,s),r=!0)},o(s){Ne(t.$$.fragment,s),r=!1},d(s){s&&de(e),an(t)}}}function s7(n){let e,t,i,r,a,l,s,d,g,x;function I(F){n[7](F)}let A={map:n[0],draw:n[1],tools:n[2]};n[3]!==void 0&&(A.selectedTool=n[3]),r=new b5({props:A}),Sn.push(()=>Xr(r,"selectedTool",I)),r.$on("singleLayerSelect",n[5]);function L(F){n[8](F)}let N={tools:n[2]};n[3]!==void 0&&(N.selectedTool=n[3]),s=new S5({props:N}),Sn.push(()=>Xr(s,"selectedTool",L)),s.$on("toolSelected",n[9]);let B=n[4]&&n[0]&&aL(n);return{c(){e=qt("div"),t=vn(),i=qt("div"),sn(r.$$.fragment),l=vn(),sn(s.$$.fragment),g=vn(),B&&B.c(),this.h()},l(F){e=Wt(F,"DIV",{id:!0,class:!0}),Qt(e).forEach(de),t=bn(F),i=Wt(F,"DIV",{id:!0,class:!0});var z=Qt(i);dn(r.$$.fragment,z),l=bn(z),dn(s.$$.fragment,z),g=bn(z),B&&B.l(z),z.forEach(de),this.h()},h(){tn(e,"id","map"),tn(e,"class","svelte-7s216m"),tn(i,"id","overlay"),tn(i,"class","svelte-7s216m")},m(F,z){tt(F,e,z),tt(F,t,z),tt(F,i,z),on(r,i,null),Kt(i,l),on(s,i,null),Kt(i,g),B&&B.m(i,null),x=!0},p(F,[z]){const V={};z&1&&(V.map=F[0]),z&2&&(V.draw=F[1]),z&4&&(V.tools=F[2]),!a&&z&8&&(a=!0,V.selectedTool=F[3],Qr(()=>a=!1)),r.$set(V);const Y={};z&4&&(Y.tools=F[2]),!d&&z&8&&(d=!0,Y.selectedTool=F[3],Qr(()=>d=!1)),s.$set(Y),F[4]&&F[0]?B?(B.p(F,z),z&17&&Te(B,1)):(B=aL(F),B.c(),Te(B,1),B.m(i,null)):B&&(Wi(),Ne(B,1,1,()=>{B=null}),Xi())},i(F){x||(Te(r.$$.fragment,F),Te(s.$$.fragment,F),Te(B),x=!0)},o(F){Ne(r.$$.fragment,F),Ne(s.$$.fragment,F),Ne(B),x=!1},d(F){F&&de(e),F&&de(t),F&&de(i),an(r),an(s),B&&B.d()}}}function o7(n,e,t){let i;Dl(n,Lo,F=>t(13,i=F));let r,a,l,s=null,d;function g(F){t(4,d=F.detail.layer)}ro(()=>{wC.accessToken="pk.eyJ1Ijoia29ob2xtIiwiYSI6ImNremUzM2tsMzJmZWsybm54d20xazFicWQifQ.uZRVptXit_O5hkkSFBKXug",t(0,r=new wC.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[10.345053,63.430515],zoom:11})),t(1,a=new SC({modes:{...SC.modes,draw_rectangle:A5},displayControlsDefault:!1,defaultMode:"simple_select"})),r.addControl(a,"top-left"),t(2,l=[{name:"bbox",iconPath:"button-icons/bbox.png",geoProcessor:d6,tooltip:"Takes a set of features, calculates the bbox of all input features, and returns a bounding box."},{name:"buffer",iconPath:"button-icons/buffer.png",geoProcessor:Az,tooltip:"Calculates a buffer for input features for a given radius. For FeatureCollections, individual buffers are calculated for each feature, but you can use dissolve to combine them.",optionsComponent:{component:d8,props:{}}},{name:"clip",iconPath:"button-icons/clip.png",geoProcessor:j6,tooltip:"Clips a selected feature to the bbox (bounding box) using lineclip. Select two positions in the map to create the bbox.",optionsComponent:{component:L8,props:{map:r,draw:a}}},{name:"difference",iconPath:"button-icons/difference.png",geoProcessor:c6,tooltip:"Finds the difference between two polygons by clipping the second polygon from the first.",optionsComponent:{component:b8,props:{}}},{name:"intersect",iconPath:"button-icons/intersection.png",geoProcessor:n6,tooltip:"Takes two polygon or multi-polygon geometries and finds their polygonal intersection, if there is one."},{name:"union",iconPath:"button-icons/union.png",geoProcessor:o6,tooltip:"Takes two (Multi)Polygon(s) and returns a combined polygon. If the input polygons are not contiguous, this function returns a MultiPolygon feature."},{name:"voronoi",iconPath:"button-icons/voronoi.png",geoProcessor:F6,tooltip:"Takes a FeatureCollection of points, and an optional bounding box, and returns a FeatureCollection of Voronoi polygons.",optionsComponent:{component:w8,props:{map:r,draw:a}}},{name:"dissolve",iconPath:"button-icons/dissolve.png",geoProcessor:X6,tooltip:"Dissolves a FeatureCollection of polygon features, filtered by an optional property name. Like a union reduction on a single FeatureCollection."}]),r.on("load",function(){Lo.subscribeNewLayerIndex(F=>{if(!F)return;const{index:z}=F,V=i[z],Y=i[z-1];Y?r.moveLayer(V.id,Y.id):r.moveLayer(V.id)})}),Lo.subscribe(F=>{F.forEach(z=>{r.getLayer(z.id)&&r.setLayoutProperty(z.id,"visibility",z.isVisible?"visible":"none")})})}),G_.subscribe(F=>{F.forEach(z=>{if(r.getSource(z.id))return;const V=z.geojson.data;if(!gd(V))return;const Y={type:"geojson",data:V};r.addSource(z.id,Y),TS(r,z,{epsg:z.epsg,projectionName:z.projectionName})})});function x(F){const{layer:z,newName:V,color:Y,opacity:Q}=F.detail;Lo.update(J=>{const he=J.find(ee=>ee.id===z.id);return he&&(he.displayName=V,he.paint[`${z.type}-color`]=Y,he.paint[`${z.type}-opacity`]=Q),J}),r.setPaintProperty(z.id,`${z.type}-color`,Y),r.setPaintProperty(z.id,`${z.type}-opacity`,Q)}function I(F){s=F,t(3,s)}function A(F){s=F,t(3,s)}const L=F=>t(3,s=F.detail);function N(F){d=F,t(4,d)}return[r,a,l,s,d,g,x,I,A,L,N,()=>{t(4,d=null)}]}let a7=class extends sr{constructor(e){super(),or(this,e,o7,s7,Qi,{})}};function l7(n){let e,t;return e=new a7({}),e.$on("variableUpdated",n[0]),{c(){sn(e.$$.fragment)},l(i){dn(e.$$.fragment,i)},m(i,r){on(e,i,r),t=!0},p:_l,i(i){t||(Te(e.$$.fragment,i),t=!0)},o(i){Ne(e.$$.fragment,i),t=!1},d(i){an(e,i)}}}function u7(n){function e(t){iu.call(this,n,t)}return[e]}class d7 extends sr{constructor(e){super(),or(this,e,u7,l7,Qi,{})}}export{d7 as component};
