import{J as Xp,K as Vi,L as Zl,M as gP,N as _P,S as Fr,i as Br,s as Lr,C as Sr,O as dn,k as un,l as cn,m as _n,h as Oe,P as Ki,b as Tt,G as an,Q as tr,D as Cr,E as Ar,F as Mr,R as Gi,T as as,g as Ke,d as rt,U as sa,V as Ji,W as zo,X as Ws,I as id,o as Ll,Y as cv,Z as pd,_ as So,w as $n,e as Ei,v as vr,f as xr,$ as xo,x as Tl,y as Pn,z as Zn,A as Rn,a0 as kr,B as Dn,H as za,a1 as fE,a2 as rE,a3 as sE,a4 as $S,a as qn,c as Hn,n as tn,a5 as z1,a6 as yP,a7 as hv,a8 as vP,a9 as xP,aa as bP,ab as EP,ac as wP,ad as IP,ae as TP,q as _r,r as yr,u as Ao,af as dE,p as Wu,ag as ho,ah as Eo,ai as U1,aj as KI,ak as Um,al as rM,t as SP,am as CP,an as eC}from"../chunks/index.7f787515.js";import{w as Xm}from"../chunks/index.8651d173.js";var Kf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function AP(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var vT={},MP={get exports(){return vT},set exports(n){vT=n}};(function(n,e){(function(t,i){n.exports=i()})(Kf,function(){var t,i,r;function a(s,p){if(!t)t=p;else if(!i)i=p;else{var x="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+t+")(sharedChunk); ("+i+")(sharedChunk); self.onerror = null;",I={};t(I),r=p(I),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(r.workerUrl=window.URL.createObjectURL(new Blob([x],{type:"text/javascript"})))}}a(["exports"],function(s){var p=typeof self<"u"?self:{},x="2.13.0";let I;const C={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(I==null){const l=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{I={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):l}catch{I=l}}return I},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},M={supported:!1,testSupport:function(l){!z&&k&&(G?q(l):O=l)}};let O,k,z=!1,G=!1;function q(l){const o=l.createTexture();l.bindTexture(l.TEXTURE_2D,o);try{if(l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,k),l.isContextLost())return;M.supported=!0}catch{}l.deleteTexture(o),z=!0}p.document&&(k=p.document.createElement("img"),k.onload=function(){O&&q(O),O=null,G=!0},k.onerror=function(){z=!0,O=null},k.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Z="01";var K=te;function te(l,o,u,f){this.cx=3*l,this.bx=3*(u-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(f-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=o,this.p2x=u,this.p2y=f}te.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,o){if(o===void 0&&(o=1e-6),l<0)return 0;if(l>1)return 1;for(var u=l,f=0;f<8;f++){var m=this.sampleCurveX(u)-l;if(Math.abs(m)<o)return u;var y=this.sampleCurveDerivativeX(u);if(Math.abs(y)<1e-6)break;u-=m/y}var b=0,T=1;for(u=l,f=0;f<20&&(m=this.sampleCurveX(u),!(Math.abs(m-l)<o));f++)l>m?b=u:T=u,u=.5*(T-b)+b;return u},solve:function(l,o){return this.sampleCurveY(this.solveCurveX(l,o))}};var ie=Te;function Te(l,o){this.x=l,this.y=o}Te.prototype={clone:function(){return new Te(this.x,this.y)},add:function(l){return this.clone()._add(l)},sub:function(l){return this.clone()._sub(l)},multByPoint:function(l){return this.clone()._multByPoint(l)},divByPoint:function(l){return this.clone()._divByPoint(l)},mult:function(l){return this.clone()._mult(l)},div:function(l){return this.clone()._div(l)},rotate:function(l){return this.clone()._rotate(l)},rotateAround:function(l,o){return this.clone()._rotateAround(l,o)},matMult:function(l){return this.clone()._matMult(l)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(l){return this.x===l.x&&this.y===l.y},dist:function(l){return Math.sqrt(this.distSqr(l))},distSqr:function(l){var o=l.x-this.x,u=l.y-this.y;return o*o+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(l){return Math.atan2(this.y-l.y,this.x-l.x)},angleWith:function(l){return this.angleWithSep(l.x,l.y)},angleWithSep:function(l,o){return Math.atan2(this.x*o-this.y*l,this.x*l+this.y*o)},_matMult:function(l){var o=l[2]*this.x+l[3]*this.y;return this.x=l[0]*this.x+l[1]*this.y,this.y=o,this},_add:function(l){return this.x+=l.x,this.y+=l.y,this},_sub:function(l){return this.x-=l.x,this.y-=l.y,this},_mult:function(l){return this.x*=l,this.y*=l,this},_div:function(l){return this.x/=l,this.y/=l,this},_multByPoint:function(l){return this.x*=l.x,this.y*=l.y,this},_divByPoint:function(l){return this.x/=l.x,this.y/=l.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var l=this.y;return this.y=this.x,this.x=-l,this},_rotate:function(l){var o=Math.cos(l),u=Math.sin(l),f=u*this.x+o*this.y;return this.x=o*this.x-u*this.y,this.y=f,this},_rotateAround:function(l,o){var u=Math.cos(l),f=Math.sin(l),m=o.y+f*(this.x-o.x)+u*(this.y-o.y);return this.x=o.x+u*(this.x-o.x)-f*(this.y-o.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Te.convert=function(l){return l instanceof Te?l:Array.isArray(l)?new Te(l[0],l[1]):l};const le=Math.PI/180,fe=180/Math.PI;function Fe(l){return l*le}function Ne(l){return l*fe}const Ue=[[0,0],[1,0],[1,1],[0,1]];function dt(l){if(l<=0)return 0;if(l>=1)return 1;const o=l*l,u=o*l;return 4*(l<.5?u:3*(l-o)+u-.75)}function Ge(l,o,u,f){const m=new K(l,o,u,f);return function(y){return m.solve(y)}}const Le=Ge(.25,.1,.25,1);function nt(l,o,u){return Math.min(u,Math.max(o,l))}function zt(l,o,u){return(u=nt((u-l)/(o-l),0,1))*u*(3-2*u)}function Ot(l,o,u){const f=u-o,m=((l-o)%f+f)%f+o;return m===o?u:m}function et(l,o,u){if(!l.length)return u(null,[]);let f=l.length;const m=new Array(l.length);let y=null;l.forEach((b,T)=>{o(b,(A,L)=>{A&&(y=A),m[T]=L,--f==0&&u(y,m)})})}function Ze(l){const o=[];for(const u in l)o.push(l[u]);return o}function At(l,...o){for(const u of o)for(const f in u)l[f]=u[f];return l}let Kt=1;function sn(){return Kt++}function zn(){return function l(o){return o?(o^Math.random()*(16>>o/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,l)}()}function ri(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))}function Yt(l){return!!l&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(l)}function ii(l,o){l.forEach(u=>{o[u]&&(o[u]=o[u].bind(o))})}function kn(l,o){return l.indexOf(o,l.length-o.length)!==-1}function on(l,o,u){const f={};for(const m in l)f[m]=o.call(u||this,l[m],m,l);return f}function Di(l,o,u){const f={};for(const m in l)o.call(u||this,l[m],m,l)&&(f[m]=l[m]);return f}function Ut(l){return Array.isArray(l)?l.map(Ut):typeof l=="object"&&l?on(l,Ut):l}const Nt={};function Gn(l){Nt[l]||(typeof console<"u"&&console.warn(l),Nt[l]=!0)}function Ci(l,o,u){return(u.y-l.y)*(o.x-l.x)>(o.y-l.y)*(u.x-l.x)}function ln(l){let o=0;for(let u,f,m=0,y=l.length,b=y-1;m<y;b=m++)u=l[m],f=l[b],o+=(f.x-u.x)*(u.y+f.y);return o}function Mt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Un(l){const o={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(u,f,m,y)=>{const b=m||y;return o[f]=!b||b.toLowerCase(),""}),o["max-age"]){const u=parseInt(o["max-age"],10);isNaN(u)?delete o["max-age"]:o["max-age"]=u}return o}let ti=null;function jr(l){if(ti==null){const o=l.navigator?l.navigator.userAgent:null;ti=!!l.safari||!(!o||!(/\b(iPad|iPhone|iPod)\b/.test(o)||o.match("Safari")&&!o.match("Chrome")))}return ti}function Yr(l){try{const o=p[l];return o.setItem("_mapbox_test_",1),o.removeItem("_mapbox_test_"),!0}catch{return!1}}function hi(l,o){return[l[4*o],l[4*o+1],l[4*o+2],l[4*o+3]]}const Hi="mapbox-tiles";let or,$e,Tn=500,fi=50;function Kn(){try{return p.caches}catch{}}function pn(){Kn()&&!or&&(or=p.caches.open(Hi))}function vi(l){const o=l.indexOf("?");if(o<0)return l;const u=function(m){const y=m.indexOf("?");return y>0?m.slice(y+1).split("&"):[]}(l),f=u.filter(m=>{const y=m.split("=");return y[0]==="language"||y[0]==="worldview"});return f.length?`${l.slice(0,o)}?${f.join("&")}`:l.slice(0,o)}let Rs=1/0;const kt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(kt);class mn extends Error{constructor(o,u,f){u===401&&Ia(f)&&(o+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(o),this.status=u,this.url=f}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const jn=Mt()?()=>self.worker&&self.worker.referrer:()=>(p.location.protocol==="blob:"?p.parent:p).location.href,ki=function(l,o){if(!(/^file:/.test(u=l.url)||/^file:/.test(jn())&&!/^\w+:/.test(u))){if(p.fetch&&p.Request&&p.AbortController&&p.Request.prototype.hasOwnProperty("signal"))return function(f,m){const y=new p.AbortController,b=new p.Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:jn(),signal:y.signal});let T=!1,A=!1;const L=(F=b.url).indexOf("sku=")>0&&Ia(F);var F;f.type==="json"&&b.headers.set("Accept","application/json");const U=(Y,J,ee)=>{if(A)return;if(Y&&Y.message!=="SecurityError"&&Gn(Y),J&&ee)return j(J);const ce=Date.now();p.fetch(b).then(we=>{if(we.ok){const Pe=L?we.clone():null;return j(we,Pe,ce)}return m(new mn(we.statusText,we.status,f.url))}).catch(we=>{we.name!=="AbortError"&&m(new Error(`${we.message} ${f.url}`))})},j=(Y,J,ee)=>{(f.type==="arrayBuffer"?Y.arrayBuffer():f.type==="json"?Y.json():Y.text()).then(ce=>{A||(J&&ee&&function(we,Pe,be){if(pn(),!or)return;const Me={status:Pe.status,statusText:Pe.statusText,headers:new p.Headers};Pe.headers.forEach((_t,mt)=>Me.headers.set(mt,_t));const Ve=Un(Pe.headers.get("Cache-Control")||"");if(Ve["no-store"])return;Ve["max-age"]&&Me.headers.set("Expires",new Date(be+1e3*Ve["max-age"]).toUTCString());const ke=Me.headers.get("Expires");ke&&(new Date(ke).getTime()-be<42e4||function(_t,mt){if($e===void 0)try{new Response(new ReadableStream),$e=!0}catch{$e=!1}$e?mt(_t.body):_t.blob().then(mt)}(Pe,_t=>{const mt=new p.Response(_t,Me);pn(),or&&or.then(Pt=>Pt.put(vi(we.url),mt)).catch(Pt=>Gn(Pt.message))}))}(b,J,ee),T=!0,m(null,ce,Y.headers.get("Cache-Control"),Y.headers.get("Expires")))}).catch(ce=>{A||m(new Error(ce.message))})};return L?function(Y,J){if(pn(),!or)return J(null);const ee=vi(Y.url);or.then(ce=>{ce.match(ee).then(we=>{const Pe=function(be){if(!be)return!1;const Me=new Date(be.headers.get("Expires")||0),Ve=Un(be.headers.get("Cache-Control")||"");return Me>Date.now()&&!Ve["no-cache"]}(we);ce.delete(ee),Pe&&ce.put(ee,we.clone()),J(null,we,Pe)}).catch(J)}).catch(J)}(b,U):U(null,null),{cancel:()=>{A=!0,T||y.abort()}}}(l,o);if(Mt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",l,o,void 0,!0)}var u;return function(f,m){const y=new p.XMLHttpRequest;y.open(f.method||"GET",f.url,!0),f.type==="arrayBuffer"&&(y.responseType="arraybuffer");for(const b in f.headers)y.setRequestHeader(b,f.headers[b]);return f.type==="json"&&(y.responseType="text",y.setRequestHeader("Accept","application/json")),y.withCredentials=f.credentials==="include",y.onerror=()=>{m(new Error(y.statusText))},y.onload=()=>{if((y.status>=200&&y.status<300||y.status===0)&&y.response!==null){let b=y.response;if(f.type==="json")try{b=JSON.parse(y.response)}catch(T){return m(T)}m(null,b,y.getResponseHeader("Cache-Control"),y.getResponseHeader("Expires"))}else m(new mn(y.statusText,y.status,f.url))},y.send(f.body),{cancel:()=>y.abort()}}(l,o)},Ds=function(l,o){return ki(At(l,{type:"arrayBuffer"}),o)};function io(l){const o=p.document.createElement("a");return o.href=l,o.protocol===p.document.location.protocol&&o.host===p.document.location.host}const oa="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Vo,Os;Vo=[],Os=0;const Mo=function(l,o){if(M.supported&&(l.headers||(l.headers={}),l.headers.accept="image/webp,*/*"),Os>=C.MAX_PARALLEL_IMAGE_REQUESTS){const y={requestParameters:l,callback:o,cancelled:!1,cancel(){this.cancelled=!0}};return Vo.push(y),y}Os++;let u=!1;const f=()=>{if(!u)for(u=!0,Os--;Vo.length&&Os<C.MAX_PARALLEL_IMAGE_REQUESTS;){const y=Vo.shift(),{requestParameters:b,callback:T,cancelled:A}=y;A||(y.cancel=Mo(b,T).cancel)}},m=Ds(l,(y,b,T,A)=>{f(),y?o(y):b&&(p.createImageBitmap?function(L,F){const U=new p.Blob([new Uint8Array(L)],{type:"image/png"});p.createImageBitmap(U).then(j=>{F(null,j)}).catch(j=>{F(new Error(`Could not load image because of ${j.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(b,(L,F)=>o(L,F,T,A)):function(L,F){const U=new p.Image,j=p.URL;U.onload=()=>{F(null,U),j.revokeObjectURL(U.src),U.onload=null,p.requestAnimationFrame(()=>{U.src=oa})},U.onerror=()=>F(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const Y=new p.Blob([new Uint8Array(L)],{type:"image/png"});U.src=L.byteLength?j.createObjectURL(Y):oa}(b,(L,F)=>o(L,F,T,A)))});return{cancel:()=>{m.cancel(),f()}}},qa="NO_ACCESS_TOKEN";function ro(l){return l.indexOf("mapbox:")===0}function Ia(l){return C.API_URL_REGEX.test(l)}function Rl(l){return C.API_CDN_URL_REGEX.test(l)}function Ha(l){return C.API_STYLE_REGEX.test(l)&&!aa(l)}function aa(l){return C.API_SPRITE_REGEX.test(l)}const Wa=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Bs(l){const o=l.match(Wa);if(!o)throw new Error("Unable to parse URL object");return{protocol:o[1],authority:o[2],path:o[3]||"/",params:o[4]?o[4].split("&"):[]}}function Ta(l){const o=l.params.length?`?${l.params.join("&")}`:"";return`${l.protocol}://${l.authority}${l.path}${o}`}function Zs(l){if(!l)return null;const o=l.split(".");if(!o||o.length!==3)return null;try{return JSON.parse(decodeURIComponent(p.atob(o[1]).split("").map(u=>"%"+("00"+u.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Sa{constructor(o){this.type=o,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(o){const u=Zs(C.ACCESS_TOKEN);let f="";return f=u&&u.u?p.btoa(encodeURIComponent(u.u).replace(/%([0-9A-F]{2})/g,(m,y)=>String.fromCharCode(+("0x"+y)))):C.ACCESS_TOKEN||"",o?`mapbox.eventData.${o}:${f}`:`mapbox.eventData:${f}`}fetchEventData(){const o=Yr("localStorage"),u=this.getStorageKey(),f=this.getStorageKey("uuid");if(o)try{const m=p.localStorage.getItem(u);m&&(this.eventData=JSON.parse(m));const y=p.localStorage.getItem(f);y&&(this.anonId=y)}catch{Gn("Unable to read from LocalStorage")}}saveEventData(){const o=Yr("localStorage"),u=this.getStorageKey(),f=this.getStorageKey("uuid");if(o)try{p.localStorage.setItem(f,this.anonId),Object.keys(this.eventData).length>=1&&p.localStorage.setItem(u,JSON.stringify(this.eventData))}catch{Gn("Unable to write to LocalStorage")}}processRequests(o){}postEvent(o,u,f,m){if(!C.EVENTS_URL)return;const y=Bs(C.EVENTS_URL);y.params.push(`access_token=${m||C.ACCESS_TOKEN||""}`);const b={event:this.type,created:new Date(o).toISOString()},T=u?At(b,u):b,A={url:Ta(y),headers:{"Content-Type":"text/plain"},body:JSON.stringify([T])};this.pendingRequest=function(L,F){return ki(At(L,{method:"POST"}),F)}(A,L=>{this.pendingRequest=null,f(L),this.saveEventData(),this.processRequests(m)})}queueRequest(o,u){this.queue.push(o),this.processRequests(u)}}const xe=new class extends Sa{constructor(l){super("appUserTurnstile"),this._customAccessToken=l}postTurnstileEvent(l,o){C.EVENTS_URL&&C.ACCESS_TOKEN&&Array.isArray(l)&&l.some(u=>ro(u)||Ia(u))&&this.queueRequest(Date.now(),o)}processRequests(l){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const o=Zs(C.ACCESS_TOKEN),u=o?o.u:C.ACCESS_TOKEN;let f=u!==this.eventData.tokenU;Yt(this.anonId)||(this.anonId=zn(),f=!0);const m=this.queue.shift();if(this.eventData.lastSuccess){const y=new Date(this.eventData.lastSuccess),b=new Date(m),T=(m-this.eventData.lastSuccess)/864e5;f=f||T>=1||T<-1||y.getDate()!==b.getDate()}else f=!0;f?this.postEvent(m,{sdkIdentifier:"mapbox-gl-js",sdkVersion:x,skuId:Z,"enabled.telemetry":!1,userId:this.anonId},y=>{y||(this.eventData.lastSuccess=m,this.eventData.tokenU=u)},l):this.processRequests()}},Q=xe.postTurnstileEvent.bind(xe),ne=new class extends Sa{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(l,o,u,f){this.skuToken=o,this.errorCb=f,C.EVENTS_URL&&(u||C.ACCESS_TOKEN?this.queueRequest({id:l,timestamp:Date.now()},u):this.errorCb(new Error(qa)))}processRequests(l){if(this.pendingRequest||this.queue.length===0)return;const{id:o,timestamp:u}=this.queue.shift();o&&this.success[o]||(this.anonId||this.fetchEventData(),Yt(this.anonId)||(this.anonId=zn()),this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:x,skuId:Z,skuToken:this.skuToken,userId:this.anonId},f=>{f?this.errorCb(f):o&&(this.success[o]=!0)},l))}},ve=ne.postMapLoadEvent.bind(ne),Ce=new class extends Sa{constructor(){super("gljs.performance")}postPerformanceEvent(l,o){C.EVENTS_URL&&(l||C.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:o},l)}processRequests(l){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:o,performanceData:u}=this.queue.shift(),f=function(m){const y=p.performance.getEntriesByType("resource"),b=p.performance.getEntriesByType("mark"),T=function(j){const Y={};if(j){for(const J in j)if(J!=="other")for(const ee of j[J]){const ce=`${J}ResolveRangeMin`,we=`${J}ResolveRangeMax`,Pe=`${J}RequestCount`,be=`${J}RequestCachedCount`;Y[ce]=Math.min(Y[ce]||1/0,ee.startTime),Y[we]=Math.max(Y[we]||-1/0,ee.responseEnd);const Me=Ve=>{Y[Ve]===void 0&&(Y[Ve]=0),++Y[Ve]};ee.transferSize!==void 0&&ee.transferSize===0&&Me(be),Me(Pe)}}return Y}(function(j,Y){const J={};if(j)for(const ee of j){const ce=Y(ee);J[ce]===void 0&&(J[ce]=[]),J[ce].push(ee)}return J}(y,ge)),A=p.devicePixelRatio,L=p.navigator.connection||p.navigator.mozConnection||p.navigator.webkitConnection,F={counters:[],metadata:[],attributes:[]},U=(j,Y,J)=>{J!=null&&j.push({name:Y,value:J.toString()})};for(const j in T)U(F.counters,j,T[j]);if(m.interactionRange[0]!==1/0&&m.interactionRange[1]!==-1/0&&(U(F.counters,"interactionRangeMin",m.interactionRange[0]),U(F.counters,"interactionRangeMax",m.interactionRange[1])),b)for(const j of Object.keys(ue)){const Y=ue[j],J=b.find(ee=>ee.name===Y);J&&U(F.counters,Y,J.startTime)}return U(F.counters,"visibilityHidden",m.visibilityHidden),U(F.attributes,"style",function(j){if(j)for(const Y of j){const J=Y.name.split("?")[0];if(Ha(J)){const ee=J.split("/").slice(-2);if(ee.length===2)return`mapbox://styles/${ee[0]}/${ee[1]}`}}}(y)),U(F.attributes,"terrainEnabled",m.terrainEnabled?"true":"false"),U(F.attributes,"fogEnabled",m.fogEnabled?"true":"false"),U(F.attributes,"projection",m.projection),U(F.attributes,"zoom",m.zoom),U(F.metadata,"devicePixelRatio",A),U(F.metadata,"connectionEffectiveType",L?L.effectiveType:void 0),U(F.metadata,"navigatorUserAgent",p.navigator.userAgent),U(F.metadata,"screenWidth",p.screen.width),U(F.metadata,"screenHeight",p.screen.height),U(F.metadata,"windowWidth",p.innerWidth),U(F.metadata,"windowHeight",p.innerHeight),U(F.metadata,"mapWidth",m.width/A),U(F.metadata,"mapHeight",m.height/A),U(F.metadata,"webglRenderer",m.renderer),U(F.metadata,"webglVendor",m.vendor),U(F.metadata,"sdkVersion",x),U(F.metadata,"sdkIdentifier","mapbox-gl-js"),F}(u);for(const m of f.metadata);for(const m of f.counters);for(const m of f.attributes);this.postEvent(o,f,()=>{},l)}},Be=Ce.postPerformanceEvent.bind(Ce),st=new class extends Sa{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(l,o,u,f){if(!C.API_URL||!C.SESSION_PATH)return;const m=Bs(C.API_URL+C.SESSION_PATH);m.params.push(`sku=${o||""}`),m.params.push(`access_token=${f||C.ACCESS_TOKEN||""}`);const y={url:Ta(m),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(b,T){return ki(At(b,{method:"GET"}),T)}(y,b=>{this.pendingRequest=null,u(b),this.saveEventData(),this.processRequests(f)})}getSessionAPI(l,o,u,f){this.skuToken=o,this.errorCb=f,C.SESSION_PATH&&C.API_URL&&(u||C.ACCESS_TOKEN?this.queueRequest({id:l,timestamp:Date.now()},u):this.errorCb(new Error(qa)))}processRequests(l){if(this.pendingRequest||this.queue.length===0)return;const{id:o,timestamp:u}=this.queue.shift();o&&this.success[o]||this.getSession(u,this.skuToken,f=>{f?this.errorCb(f):o&&(this.success[o]=!0)},l)}},tt=st.getSessionAPI.bind(st),He=new Set,ue={create:"create",load:"load",fullLoad:"fullLoad"},Ye={mark(l){p.performance.mark(l)},measure(l,o,u){p.performance.measure(l,o,u)}};function ge(l){const o=l.name.split("?")[0];return Rl(o)&&o.includes("mapbox-gl.js")?"javascript":Rl(o)&&o.includes("mapbox-gl.css")?"css":function(u){return C.API_FONTS_REGEX.test(u)}(o)?"fontRange":aa(o)?"sprite":Ha(o)?"style":function(u){return C.API_TILEJSON_REGEX.test(u)}(o)?"tilejson":"other"}const It=p.performance;function vn(l){const o=l?l.url.toString():void 0;return It.getEntriesByName(o)}let Wn,Vn,je,Fn;const ar={now:()=>je!==void 0?je:p.performance.now(),setNow(l){je=l},restoreNow(){je=void 0},frame(l){const o=p.requestAnimationFrame(l);return{cancel:()=>p.cancelAnimationFrame(o)}},getImageData(l,o=0){const{width:u,height:f}=l;Fn||(Fn=p.document.createElement("canvas"));const m=Fn.getContext("2d",{willReadFrequently:!0});if(!m)throw new Error("failed to create canvas 2d context");return(u>Fn.width||f>Fn.height)&&(Fn.width=u,Fn.height=f),m.clearRect(-o,-o,u+2*o,f+2*o),m.drawImage(l,0,0,u,f),m.getImageData(-o,-o,u+2*o,f+2*o)},resolveURL:l=>(Wn||(Wn=p.document.createElement("a")),Wn.href=l,Wn.href),get devicePixelRatio(){return p.devicePixelRatio},get prefersReducedMotion(){return!!p.matchMedia&&(Vn==null&&(Vn=p.matchMedia("(prefers-reduced-motion: reduce)")),Vn.matches)}};function ui(l,o,u){u[l]&&u[l].indexOf(o)!==-1||(u[l]=u[l]||[],u[l].push(o))}function Qi(l,o,u){if(u&&u[l]){const f=u[l].indexOf(o);f!==-1&&u[l].splice(f,1)}}class nr{constructor(o,u={}){At(this,u),this.type=o}}class Dl extends nr{constructor(o,u={}){super("error",At({error:o},u))}}class la{on(o,u){return this._listeners=this._listeners||{},ui(o,u,this._listeners),this}off(o,u){return Qi(o,u,this._listeners),Qi(o,u,this._oneTimeListeners),this}once(o,u){return u?(this._oneTimeListeners=this._oneTimeListeners||{},ui(o,u,this._oneTimeListeners),this):new Promise(f=>this.once(o,f))}fire(o,u){typeof o=="string"&&(o=new nr(o,u||{}));const f=o.type;if(this.listens(f)){o.target=this;const m=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const T of m)T.call(this,o);const y=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const T of y)Qi(f,T,this._oneTimeListeners),T.call(this,o);const b=this._eventedParent;b&&(At(o,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),b.fire(o))}else o instanceof Dl&&console.error(o.error);return this}listens(o){return!!(this._listeners&&this._listeners[o]&&this._listeners[o].length>0||this._oneTimeListeners&&this._oneTimeListeners[o]&&this._oneTimeListeners[o].length>0||this._eventedParent&&this._eventedParent.listens(o))}setEventedParent(o,u){return this._eventedParent=o,this._eventedParentData=u,this}}var wt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Ol(l,...o){for(const u of o)for(const f in u)l[f]=u[f];return l}function zs(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function ic(l){if(Array.isArray(l))return l.map(ic);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){const o={};for(const u in l)o[u]=ic(l[u]);return o}return zs(l)}class am extends Error{constructor(o,u){super(u),this.message=u,this.key=o}}var Nl=am;class Eu{constructor(o,u=[]){this.parent=o,this.bindings={};for(const[f,m]of u)this.bindings[f]=m}concat(o){return new Eu(this,o)}get(o){if(this.bindings[o])return this.bindings[o];if(this.parent)return this.parent.get(o);throw new Error(`${o} not found in scope.`)}has(o){return!!this.bindings[o]||!!this.parent&&this.parent.has(o)}}var cp=Eu;const rc={kind:"null"},hn={kind:"number"},Wi={kind:"string"},Yi={kind:"boolean"},Ca={kind:"color"},D={kind:"object"},V={kind:"value"},oe={kind:"collator"},Ae={kind:"formatted"},Xe={kind:"resolvedImage"};function We(l,o){return{kind:"array",itemType:l,N:o}}function Qe(l){if(l.kind==="array"){const o=Qe(l.itemType);return typeof l.N=="number"?`array<${o}, ${l.N}>`:l.itemType.kind==="value"?"array":`array<${o}>`}return l.kind}const en=[rc,hn,Wi,Yi,Ca,Ae,D,We(V),Xe];function Qt(l,o){if(o.kind==="error")return null;if(l.kind==="array"){if(o.kind==="array"&&(o.N===0&&o.itemType.kind==="value"||!Qt(l.itemType,o.itemType))&&(typeof l.N!="number"||l.N===o.N))return null}else{if(l.kind===o.kind)return null;if(l.kind==="value"){for(const u of en)if(!Qt(u,o))return null}}return`Expected ${Qe(l)} but found ${Qe(o)} instead.`}function Ln(l,o){return o.some(u=>u.kind===l.kind)}function gn(l,o){return o.some(u=>u==="null"?l===null:u==="array"?Array.isArray(l):u==="object"?l&&!Array.isArray(l)&&typeof l=="object":u===typeof l)}var bn,xi={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function ls(l){return(l=Math.round(l))<0?0:l>255?255:l}function wi(l){return ls(l[l.length-1]==="%"?parseFloat(l)/100*255:parseInt(l))}function ms(l){return(o=l[l.length-1]==="%"?parseFloat(l)/100:parseFloat(l))<0?0:o>1?1:o;var o}function jt(l,o,u){return u<0?u+=1:u>1&&(u-=1),6*u<1?l+(o-l)*u*6:2*u<1?o:3*u<2?l+(o-l)*(2/3-u)*6:l}try{bn={}.parseCSSColor=function(l){var o,u=l.replace(/ /g,"").toLowerCase();if(u in xi)return xi[u].slice();if(u[0]==="#")return u.length===4?(o=parseInt(u.substr(1),16))>=0&&o<=4095?[(3840&o)>>4|(3840&o)>>8,240&o|(240&o)>>4,15&o|(15&o)<<4,1]:null:u.length===7&&(o=parseInt(u.substr(1),16))>=0&&o<=16777215?[(16711680&o)>>16,(65280&o)>>8,255&o,1]:null;var f=u.indexOf("("),m=u.indexOf(")");if(f!==-1&&m+1===u.length){var y=u.substr(0,f),b=u.substr(f+1,m-(f+1)).split(","),T=1;switch(y){case"rgba":if(b.length!==4)return null;T=ms(b.pop());case"rgb":return b.length!==3?null:[wi(b[0]),wi(b[1]),wi(b[2]),T];case"hsla":if(b.length!==4)return null;T=ms(b.pop());case"hsl":if(b.length!==3)return null;var A=(parseFloat(b[0])%360+360)%360/360,L=ms(b[1]),F=ms(b[2]),U=F<=.5?F*(L+1):F+L-F*L,j=2*F-U;return[ls(255*jt(j,U,A+1/3)),ls(255*jt(j,U,A)),ls(255*jt(j,U,A-1/3)),T];default:return null}}return null}}catch{}class On{constructor(o,u,f,m=1){this.r=o,this.g=u,this.b=f,this.a=m}static parse(o){if(!o)return;if(o instanceof On)return o;if(typeof o!="string")return;const u=bn(o);return u?new On(u[0]/255*u[3],u[1]/255*u[3],u[2]/255*u[3],u[3]):void 0}toString(){const[o,u,f,m]=this.toArray();return`rgba(${Math.round(o)},${Math.round(u)},${Math.round(f)},${m})`}toArray(){const{r:o,g:u,b:f,a:m}=this;return m===0?[0,0,0,0]:[255*o/m,255*u/m,255*f/m,m]}toArray01(){const{r:o,g:u,b:f,a:m}=this;return m===0?[0,0,0,0]:[o/m,u/m,f/m,m]}toArray01PremultipliedAlpha(){const{r:o,g:u,b:f,a:m}=this;return[o,u,f,m]}}On.black=new On(0,0,0,1),On.white=new On(1,1,1,1),On.transparent=new On(0,0,0,0),On.red=new On(1,0,0,1),On.blue=new On(0,0,1,1);var Ai=On;class Ys{constructor(o,u,f){this.sensitivity=o?u?"variant":"case":u?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(o,u){return this.collator.compare(o,u)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ss{constructor(o,u,f,m,y){this.text=o.normalize?o.normalize():o,this.image=u,this.scale=f,this.fontStack=m,this.textColor=y}}class Go{constructor(o){this.sections=o}static fromString(o){return new Go([new Ss(o,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(o=>o.text.length!==0||o.image&&o.image.name.length!==0)}static factory(o){return o instanceof Go?o:Go.fromString(o)}toString(){return this.sections.length===0?"":this.sections.map(o=>o.text).join("")}serialize(){const o=["format"];for(const u of this.sections){if(u.image){o.push(["image",u.image.name]);continue}o.push(u.text);const f={};u.fontStack&&(f["text-font"]=["literal",u.fontStack.split(",")]),u.scale&&(f["font-scale"]=u.scale),u.textColor&&(f["text-color"]=["rgba"].concat(u.textColor.toArray())),o.push(f)}return o}}class ua{constructor(o){this.name=o.name,this.available=o.available}toString(){return this.name}static fromString(o){return o?new ua({name:o,available:!1}):null}serialize(){return["image",this.name]}}function gs(l,o,u,f){return typeof l=="number"&&l>=0&&l<=255&&typeof o=="number"&&o>=0&&o<=255&&typeof u=="number"&&u>=0&&u<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[l,o,u,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[l,o,u,f]:[l,o,u]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Sf(l){if(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number"||l instanceof Ai||l instanceof Ys||l instanceof Go||l instanceof ua)return!0;if(Array.isArray(l)){for(const o of l)if(!Sf(o))return!1;return!0}if(typeof l=="object"){for(const o in l)if(!Sf(l[o]))return!1;return!0}return!1}function so(l){if(l===null)return rc;if(typeof l=="string")return Wi;if(typeof l=="boolean")return Yi;if(typeof l=="number")return hn;if(l instanceof Ai)return Ca;if(l instanceof Ys)return oe;if(l instanceof Go)return Ae;if(l instanceof ua)return Xe;if(Array.isArray(l)){const o=l.length;let u;for(const f of l){const m=so(f);if(u){if(u===m)continue;u=V;break}u=m}return We(u||V,o)}return D}function ca(l){const o=typeof l;return l===null?"":o==="string"||o==="number"||o==="boolean"?String(l):l instanceof Ai||l instanceof Go||l instanceof ua?l.toString():JSON.stringify(l)}class gd{constructor(o,u){this.type=o,this.value=u}static parse(o,u){if(o.length!==2)return u.error(`'literal' expression requires exactly one argument, but found ${o.length-1} instead.`);if(!Sf(o[1]))return u.error("invalid value");const f=o[1];let m=so(f);const y=u.expectedType;return m.kind!=="array"||m.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(m=y),new gd(m,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Ai?["rgba"].concat(this.value.toArray()):this.value instanceof Go?this.value.serialize():this.value}}var Sh=gd,Lo=class{constructor(l){this.name="ExpressionEvaluationError",this.message=l}toJSON(){return this.message}};const Ch={string:Wi,number:hn,boolean:Yi,object:D};class jc{constructor(o,u){this.type=o,this.args=u}static parse(o,u){if(o.length<2)return u.error("Expected at least one argument.");let f,m=1;const y=o[0];if(y==="array"){let T,A;if(o.length>2){const L=o[1];if(typeof L!="string"||!(L in Ch)||L==="object")return u.error('The item type argument of "array" must be one of string, number, boolean',1);T=Ch[L],m++}else T=V;if(o.length>3){if(o[2]!==null&&(typeof o[2]!="number"||o[2]<0||o[2]!==Math.floor(o[2])))return u.error('The length argument to "array" must be a positive integer literal',2);A=o[2],m++}f=We(T,A)}else f=Ch[y];const b=[];for(;m<o.length;m++){const T=u.parse(o[m],m,V);if(!T)return null;b.push(T)}return new jc(f,b)}evaluate(o){for(let u=0;u<this.args.length;u++){const f=this.args[u].evaluate(o);if(!Qt(this.type,so(f)))return f;if(u===this.args.length-1)throw new Lo(`Expected value to be of type ${Qe(this.type)}, but found ${Qe(so(f))} instead.`)}return null}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=this.type,u=[o.kind];if(o.kind==="array"){const f=o.itemType;if(f.kind==="string"||f.kind==="number"||f.kind==="boolean"){u.push(f.kind);const m=o.N;(typeof m=="number"||this.args.length>1)&&u.push(m)}}return u.concat(this.args.map(f=>f.serialize()))}}var Pr=jc;class Kr{constructor(o){this.type=Ae,this.sections=o}static parse(o,u){if(o.length<2)return u.error("Expected at least one argument.");const f=o[1];if(!Array.isArray(f)&&typeof f=="object")return u.error("First argument must be an image or text section.");const m=[];let y=!1;for(let b=1;b<=o.length-1;++b){const T=o[b];if(y&&typeof T=="object"&&!Array.isArray(T)){y=!1;let A=null;if(T["font-scale"]&&(A=u.parse(T["font-scale"],1,hn),!A))return null;let L=null;if(T["text-font"]&&(L=u.parse(T["text-font"],1,We(Wi)),!L))return null;let F=null;if(T["text-color"]&&(F=u.parse(T["text-color"],1,Ca),!F))return null;const U=m[m.length-1];U.scale=A,U.font=L,U.textColor=F}else{const A=u.parse(o[b],1,V);if(!A)return null;const L=A.type.kind;if(L!=="string"&&L!=="value"&&L!=="null"&&L!=="resolvedImage")return u.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,m.push({content:A,scale:null,font:null,textColor:null})}}return new Kr(m)}evaluate(o){return new Go(this.sections.map(u=>{const f=u.content.evaluate(o);return so(f)===Xe?new Ss("",f,null,null,null):new Ss(ca(f),null,u.scale?u.scale.evaluate(o):null,u.font?u.font.evaluate(o).join(","):null,u.textColor?u.textColor.evaluate(o):null)}))}eachChild(o){for(const u of this.sections)o(u.content),u.scale&&o(u.scale),u.font&&o(u.font),u.textColor&&o(u.textColor)}outputDefined(){return!1}serialize(){const o=["format"];for(const u of this.sections){o.push(u.content.serialize());const f={};u.scale&&(f["font-scale"]=u.scale.serialize()),u.font&&(f["text-font"]=u.font.serialize()),u.textColor&&(f["text-color"]=u.textColor.serialize()),o.push(f)}return o}}class _d{constructor(o){this.type=Xe,this.input=o}static parse(o,u){if(o.length!==2)return u.error("Expected two arguments.");const f=u.parse(o[1],1,Wi);return f?new _d(f):u.error("No image name provided.")}evaluate(o){const u=this.input.evaluate(o),f=ua.fromString(u);return f&&o.availableImages&&(f.available=o.availableImages.indexOf(u)>-1),f}eachChild(o){o(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const pg={"to-boolean":Yi,"to-color":Ca,"to-number":hn,"to-string":Wi};class yd{constructor(o,u){this.type=o,this.args=u}static parse(o,u){if(o.length<2)return u.error("Expected at least one argument.");const f=o[0];if((f==="to-boolean"||f==="to-string")&&o.length!==2)return u.error("Expected one argument.");const m=pg[f],y=[];for(let b=1;b<o.length;b++){const T=u.parse(o[b],b,V);if(!T)return null;y.push(T)}return new yd(m,y)}evaluate(o){if(this.type.kind==="boolean")return!!this.args[0].evaluate(o);if(this.type.kind==="color"){let u,f;for(const m of this.args){if(u=m.evaluate(o),f=null,u instanceof Ai)return u;if(typeof u=="string"){const y=o.parseColor(u);if(y)return y}else if(Array.isArray(u)&&(f=u.length<3||u.length>4?`Invalid rbga value ${JSON.stringify(u)}: expected an array containing either three or four numeric values.`:gs(u[0],u[1],u[2],u[3]),!f))return new Ai(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new Lo(f||`Could not parse color from value '${typeof u=="string"?u:String(JSON.stringify(u))}'`)}if(this.type.kind==="number"){let u=null;for(const f of this.args){if(u=f.evaluate(o),u===null)return 0;const m=Number(u);if(!isNaN(m))return m}throw new Lo(`Could not convert ${JSON.stringify(u)} to number.`)}return this.type.kind==="formatted"?Go.fromString(ca(this.args[0].evaluate(o))):this.type.kind==="resolvedImage"?ua.fromString(ca(this.args[0].evaluate(o))):ca(this.args[0].evaluate(o))}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Kr([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new _d(this.args[0]).serialize();const o=[`to-${this.type.kind}`];return this.eachChild(u=>{o.push(u.serialize())}),o}}var qc=yd;const hp=["Unknown","Point","LineString","Polygon"];var Cf=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?hp[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const l=this.featureDistanceData.center,o=this.featureDistanceData.scale,{x:u,y:f}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*o-l[0])+this.featureDistanceData.bearing[1]*(f*o-l[1])}return 0}parseColor(l){let o=this._parseColorCache[l];return o||(o=this._parseColorCache[l]=Ai.parse(l)),o}};class Hc{constructor(o,u,f,m){this.name=o,this.type=u,this._evaluate=f,this.args=m}evaluate(o){return this._evaluate(o,this.args)}eachChild(o){this.args.forEach(o)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(o=>o.serialize()))}static parse(o,u){const f=o[0],m=Hc.definitions[f];if(!m)return u.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(m)?m[0]:m.type,b=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,T=b.filter(([L])=>!Array.isArray(L)||L.length===o.length-1);let A=null;for(const[L,F]of T){A=new dp(u.registry,u.path,null,u.scope);const U=[];let j=!1;for(let Y=1;Y<o.length;Y++){const J=o[Y],ee=Array.isArray(L)?L[Y-1]:L.type,ce=A.parse(J,1+U.length,ee);if(!ce){j=!0;break}U.push(ce)}if(!j)if(Array.isArray(L)&&L.length!==U.length)A.error(`Expected ${L.length} arguments, but found ${U.length} instead.`);else{for(let Y=0;Y<U.length;Y++){const J=Array.isArray(L)?L[Y]:L.type,ee=U[Y];A.concat(Y+1).checkSubtype(J,ee.type)}if(A.errors.length===0)return new Hc(f,y,F,U)}}if(T.length===1)u.errors.push(...A.errors);else{const L=(T.length?T:b).map(([U])=>{return j=U,Array.isArray(j)?`(${j.map(Qe).join(", ")})`:`(${Qe(j.type)}...)`;var j}).join(" | "),F=[];for(let U=1;U<o.length;U++){const j=u.parse(o[U],1+F.length);if(!j)return null;F.push(Qe(j.type))}u.error(`Expected arguments of type ${L}, but found (${F.join(", ")}) instead.`)}return null}static register(o,u){Hc.definitions=u;for(const f in u)o[f]=Hc}}var kl=Hc;class Us{constructor(o,u,f){this.type=oe,this.locale=f,this.caseSensitive=o,this.diacriticSensitive=u}static parse(o,u){if(o.length!==2)return u.error("Expected one argument.");const f=o[1];if(typeof f!="object"||Array.isArray(f))return u.error("Collator options argument must be an object.");const m=u.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,Yi);if(!m)return null;const y=u.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,Yi);if(!y)return null;let b=null;return f.locale&&(b=u.parse(f.locale,1,Wi),!b)?null:new Us(m,y,b)}evaluate(o){return new Ys(this.caseSensitive.evaluate(o),this.diacriticSensitive.evaluate(o),this.locale?this.locale.evaluate(o):null)}eachChild(o){o(this.caseSensitive),o(this.diacriticSensitive),this.locale&&o(this.locale)}outputDefined(){return!1}serialize(){const o={};return o["case-sensitive"]=this.caseSensitive.serialize(),o["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(o.locale=this.locale.serialize()),["collator",o]}}const Fl=8192;function us(l,o){l[0]=Math.min(l[0],o[0]),l[1]=Math.min(l[1],o[1]),l[2]=Math.max(l[2],o[0]),l[3]=Math.max(l[3],o[1])}function Wc(l,o){return!(l[0]<=o[0]||l[2]>=o[2]||l[1]<=o[1]||l[3]>=o[3])}function Af(l,o){const u=(180+l[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,m=Math.pow(2,o.z);return[Math.round(u*m*Fl),Math.round(f*m*Fl)]}function Xa(l,o,u){const f=l[0]-o[0],m=l[1]-o[1],y=l[0]-u[0],b=l[1]-u[1];return f*b-y*m==0&&f*y<=0&&m*b<=0}function Ah(l,o){let u=!1;for(let b=0,T=o.length;b<T;b++){const A=o[b];for(let L=0,F=A.length;L<F-1;L++){if(Xa(l,A[L],A[L+1]))return!1;(m=A[L])[1]>(f=l)[1]!=(y=A[L+1])[1]>f[1]&&f[0]<(y[0]-m[0])*(f[1]-m[1])/(y[1]-m[1])+m[0]&&(u=!u)}}var f,m,y;return u}function Mh(l,o){for(let u=0;u<o.length;u++)if(Ah(l,o[u]))return!0;return!1}function Mf(l,o,u,f){const m=f[0]-u[0],y=f[1]-u[1],b=(l[0]-u[0])*y-m*(l[1]-u[1]),T=(o[0]-u[0])*y-m*(o[1]-u[1]);return b>0&&T<0||b<0&&T>0}function Lf(l,o,u){for(const L of u)for(let F=0;F<L.length-1;++F)if((T=[(b=L[F+1])[0]-(y=L[F])[0],b[1]-y[1]])[0]*(A=[(m=o)[0]-(f=l)[0],m[1]-f[1]])[1]-T[1]*A[0]!=0&&Mf(f,m,y,b)&&Mf(y,b,f,m))return!0;var f,m,y,b,T,A;return!1}function Xc(l,o){for(let u=0;u<l.length;++u)if(!Ah(l[u],o))return!1;for(let u=0;u<l.length-1;++u)if(Lf(l[u],l[u+1],o))return!1;return!0}function wu(l,o){for(let u=0;u<o.length;u++)if(Xc(l,o[u]))return!0;return!1}function jo(l,o,u){const f=[];for(let m=0;m<l.length;m++){const y=[];for(let b=0;b<l[m].length;b++){const T=Af(l[m][b],u);us(o,T),y.push(T)}f.push(y)}return f}function vd(l,o,u){const f=[];for(let m=0;m<l.length;m++){const y=jo(l[m],o,u);f.push(y)}return f}function Aa(l,o,u,f){if(l[0]<u[0]||l[0]>u[2]){const m=.5*f;let y=l[0]-u[0]>m?-f:u[0]-l[0]>m?f:0;y===0&&(y=l[0]-u[2]>m?-f:u[2]-l[0]>m?f:0),l[0]+=y}us(o,l)}function Iu(l,o,u,f){const m=Math.pow(2,f.z)*Fl,y=[f.x*Fl,f.y*Fl],b=[];if(!l)return b;for(const T of l)for(const A of T){const L=[A.x+y[0],A.y+y[1]];Aa(L,o,u,m),b.push(L)}return b}function lr(l,o,u,f){const m=Math.pow(2,f.z)*Fl,y=[f.x*Fl,f.y*Fl],b=[];if(!l)return b;for(const A of l){const L=[];for(const F of A){const U=[F.x+y[0],F.y+y[1]];us(o,U),L.push(U)}b.push(L)}if(o[2]-o[0]<=m/2){(T=o)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const A of b)for(const L of A)Aa(L,o,u,m)}var T;return b}class Ma{constructor(o,u){this.type=Yi,this.geojson=o,this.geometries=u}static parse(o,u){if(o.length!==2)return u.error(`'within' expression requires exactly one argument, but found ${o.length-1} instead.`);if(Sf(o[1])){const f=o[1];if(f.type==="FeatureCollection")for(let m=0;m<f.features.length;++m){const y=f.features[m].geometry.type;if(y==="Polygon"||y==="MultiPolygon")return new Ma(f,f.features[m].geometry)}else if(f.type==="Feature"){const m=f.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Ma(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new Ma(f,f)}return u.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(o){if(o.geometry()!=null&&o.canonicalID()!=null){if(o.geometryType()==="Point")return function(u,f){const m=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],b=u.canonicalID();if(!b)return!1;if(f.type==="Polygon"){const T=jo(f.coordinates,y,b),A=Iu(u.geometry(),m,y,b);if(!Wc(m,y))return!1;for(const L of A)if(!Ah(L,T))return!1}if(f.type==="MultiPolygon"){const T=vd(f.coordinates,y,b),A=Iu(u.geometry(),m,y,b);if(!Wc(m,y))return!1;for(const L of A)if(!Mh(L,T))return!1}return!0}(o,this.geometries);if(o.geometryType()==="LineString")return function(u,f){const m=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],b=u.canonicalID();if(!b)return!1;if(f.type==="Polygon"){const T=jo(f.coordinates,y,b),A=lr(u.geometry(),m,y,b);if(!Wc(m,y))return!1;for(const L of A)if(!Xc(L,T))return!1}if(f.type==="MultiPolygon"){const T=vd(f.coordinates,y,b),A=lr(u.geometry(),m,y,b);if(!Wc(m,y))return!1;for(const L of A)if(!wu(L,T))return!1}return!0}(o,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var sc=Ma;function Tu(l){if(l instanceof kl&&(l.name==="get"&&l.args.length===1||l.name==="feature-state"||l.name==="has"&&l.args.length===1||l.name==="properties"||l.name==="geometry-type"||l.name==="id"||/^filter-/.test(l.name))||l instanceof sc)return!1;let o=!0;return l.eachChild(u=>{o&&!Tu(u)&&(o=!1)}),o}function zr(l){if(l instanceof kl&&l.name==="feature-state")return!1;let o=!0;return l.eachChild(u=>{o&&!zr(u)&&(o=!1)}),o}function Bl(l,o){if(l instanceof kl&&o.indexOf(l.name)>=0)return!1;let u=!0;return l.eachChild(f=>{u&&!Bl(f,o)&&(u=!1)}),u}class Lh{constructor(o,u){this.type=u.type,this.name=o,this.boundExpression=u}static parse(o,u){if(o.length!==2||typeof o[1]!="string")return u.error("'var' expression requires exactly one string literal argument.");const f=o[1];return u.scope.has(f)?new Lh(f,u.scope.get(f)):u.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(o){return this.boundExpression.evaluate(o)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var fp=Lh;class Ph{constructor(o,u=[],f,m=new cp,y=[]){this.registry=o,this.path=u,this.key=u.map(b=>`[${b}]`).join(""),this.scope=m,this.errors=y,this.expectedType=f}parse(o,u,f,m,y={}){return u?this.concat(u,f,m)._parse(o,y):this._parse(o,y)}_parse(o,u){function f(m,y,b){return b==="assert"?new Pr(y,[m]):b==="coerce"?new qc(y,[m]):m}if(o!==null&&typeof o!="string"&&typeof o!="boolean"&&typeof o!="number"||(o=["literal",o]),Array.isArray(o)){if(o.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=o[0];if(typeof m!="string")return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[m];if(y){let b=y.parse(o,this);if(!b)return null;if(this.expectedType){const T=this.expectedType,A=b.type;if(T.kind!=="string"&&T.kind!=="number"&&T.kind!=="boolean"&&T.kind!=="object"&&T.kind!=="array"||A.kind!=="value")if(T.kind!=="color"&&T.kind!=="formatted"&&T.kind!=="resolvedImage"||A.kind!=="value"&&A.kind!=="string"){if(this.checkSubtype(T,A))return null}else b=f(b,T,u.typeAnnotation||"coerce");else b=f(b,T,u.typeAnnotation||"assert")}if(!(b instanceof Sh)&&b.type.kind!=="resolvedImage"&&Su(b)){const T=new Cf;try{b=new Sh(b.type,b.evaluate(T))}catch(A){return this.error(A.message),null}}return b}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(o===void 0?"'undefined' value invalid. Use null instead.":typeof o=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof o} instead.`)}concat(o,u,f){const m=typeof o=="number"?this.path.concat(o):this.path,y=f?this.scope.concat(f):this.scope;return new Ph(this.registry,m,u||null,y,this.errors)}error(o,...u){const f=`${this.key}${u.map(m=>`[${m}]`).join("")}`;this.errors.push(new Nl(f,o))}checkSubtype(o,u){const f=Qt(o,u);return f&&this.error(f),f}}var dp=Ph;function Su(l){if(l instanceof fp)return Su(l.boundExpression);if(l instanceof kl&&l.name==="error"||l instanceof Us||l instanceof sc)return!1;const o=l instanceof qc||l instanceof Pr;let u=!0;return l.eachChild(f=>{u=o?u&&Su(f):u&&f instanceof Sh}),!!u&&Tu(l)&&Bl(l,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Cu(l,o){const u=l.length-1;let f,m,y=0,b=u,T=0;for(;y<=b;)if(T=Math.floor((y+b)/2),f=l[T],m=l[T+1],f<=o){if(T===u||o<m)return T;y=T+1}else{if(!(f>o))throw new Lo("Input is not a number.");b=T-1}return 0}class zl{constructor(o,u,f){this.type=o,this.input=u,this.labels=[],this.outputs=[];for(const[m,y]of f)this.labels.push(m),this.outputs.push(y)}static parse(o,u){if(o.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return u.error("Expected an even number of arguments.");const f=u.parse(o[1],1,hn);if(!f)return null;const m=[];let y=null;u.expectedType&&u.expectedType.kind!=="value"&&(y=u.expectedType);for(let b=1;b<o.length;b+=2){const T=b===1?-1/0:o[b],A=o[b+1],L=b,F=b+1;if(typeof T!="number")return u.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(m.length&&m[m.length-1][0]>=T)return u.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',L);const U=u.parse(A,F,y);if(!U)return null;y=y||U.type,m.push([T,U])}return new zl(y,f,m)}evaluate(o){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(o);const m=this.input.evaluate(o);if(m<=u[0])return f[0].evaluate(o);const y=u.length;return m>=u[y-1]?f[y-1].evaluate(o):f[Cu(u,m)].evaluate(o)}eachChild(o){o(this.input);for(const u of this.outputs)o(u)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){const o=["step",this.input.serialize()];for(let u=0;u<this.labels.length;u++)u>0&&o.push(this.labels[u]),o.push(this.outputs[u].serialize());return o}}var La=zl;function Mi(l,o,u){return l*(1-u)+o*u}var oc=Object.freeze({__proto__:null,number:Mi,color:function(l,o,u){return new Ai(Mi(l.r,o.r,u),Mi(l.g,o.g,u),Mi(l.b,o.b,u),Mi(l.a,o.a,u))},array:function(l,o,u){return l.map((f,m)=>Mi(f,o[m],u))}});const $l=.95047,pp=1.08883,ac=4/29,Au=6/29,Pf=3*Au*Au,mp=Math.PI/180,gp=180/Math.PI;function Rh(l){return l>.008856451679035631?Math.pow(l,1/3):l/Pf+ac}function xd(l){return l>Au?l*l*l:Pf*(l-ac)}function Dh(l){return 255*(l<=.0031308?12.92*l:1.055*Math.pow(l,1/2.4)-.055)}function mo(l){return(l/=255)<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function Mu(l){const o=mo(l.r),u=mo(l.g),f=mo(l.b),m=Rh((.4124564*o+.3575761*u+.1804375*f)/$l),y=Rh((.2126729*o+.7151522*u+.072175*f)/1);return{l:116*y-16,a:500*(m-y),b:200*(y-Rh((.0193339*o+.119192*u+.9503041*f)/pp)),alpha:l.a}}function Oh(l){let o=(l.l+16)/116,u=isNaN(l.a)?o:o+l.a/500,f=isNaN(l.b)?o:o-l.b/200;return o=1*xd(o),u=$l*xd(u),f=pp*xd(f),new Ai(Dh(3.2404542*u-1.5371385*o-.4985314*f),Dh(-.969266*u+1.8760108*o+.041556*f),Dh(.0556434*u-.2040259*o+1.0572252*f),l.alpha)}function Lu(l,o,u){const f=o-l;return l+u*(f>180||f<-180?f-360*Math.round(f/360):f)}const Nh={forward:Mu,reverse:Oh,interpolate:function(l,o,u){return{l:Mi(l.l,o.l,u),a:Mi(l.a,o.a,u),b:Mi(l.b,o.b,u),alpha:Mi(l.alpha,o.alpha,u)}}},Ul={forward:function(l){const{l:o,a:u,b:f}=Mu(l),m=Math.atan2(f,u)*gp;return{h:m<0?m+360:m,c:Math.sqrt(u*u+f*f),l:o,alpha:l.a}},reverse:function(l){const o=l.h*mp,u=l.c;return Oh({l:l.l,a:Math.cos(o)*u,b:Math.sin(o)*u,alpha:l.alpha})},interpolate:function(l,o,u){return{h:Lu(l.h,o.h,u),c:Mi(l.c,o.c,u),l:Mi(l.l,o.l,u),alpha:Mi(l.alpha,o.alpha,u)}}};var _p=Object.freeze({__proto__:null,lab:Nh,hcl:Ul});class Rf{constructor(o,u,f,m,y){this.type=o,this.operator=u,this.interpolation=f,this.input=m,this.labels=[],this.outputs=[];for(const[b,T]of y)this.labels.push(b),this.outputs.push(T)}static interpolationFactor(o,u,f,m){let y=0;if(o.name==="exponential")y=kh(u,o.base,f,m);else if(o.name==="linear")y=kh(u,1,f,m);else if(o.name==="cubic-bezier"){const b=o.controlPoints;y=new K(b[0],b[1],b[2],b[3]).solve(kh(u,1,f,m))}return y}static parse(o,u){let[f,m,y,...b]=o;if(!Array.isArray(m)||m.length===0)return u.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const L=m[1];if(typeof L!="number")return u.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:L}}else{if(m[0]!=="cubic-bezier")return u.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const L=m.slice(1);if(L.length!==4||L.some(F=>typeof F!="number"||F<0||F>1))return u.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:L}}}if(o.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return u.error("Expected an even number of arguments.");if(y=u.parse(y,2,hn),!y)return null;const T=[];let A=null;f==="interpolate-hcl"||f==="interpolate-lab"?A=Ca:u.expectedType&&u.expectedType.kind!=="value"&&(A=u.expectedType);for(let L=0;L<b.length;L+=2){const F=b[L],U=b[L+1],j=L+3,Y=L+4;if(typeof F!="number")return u.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(T.length&&T[T.length-1][0]>=F)return u.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',j);const J=u.parse(U,Y,A);if(!J)return null;A=A||J.type,T.push([F,J])}return A.kind==="number"||A.kind==="color"||A.kind==="array"&&A.itemType.kind==="number"&&typeof A.N=="number"?new Rf(A,f,m,y,T):u.error(`Type ${Qe(A)} is not interpolatable.`)}evaluate(o){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(o);const m=this.input.evaluate(o);if(m<=u[0])return f[0].evaluate(o);const y=u.length;if(m>=u[y-1])return f[y-1].evaluate(o);const b=Cu(u,m),T=Rf.interpolationFactor(this.interpolation,m,u[b],u[b+1]),A=f[b].evaluate(o),L=f[b+1].evaluate(o);return this.operator==="interpolate"?oc[this.type.kind.toLowerCase()](A,L,T):this.operator==="interpolate-hcl"?Ul.reverse(Ul.interpolate(Ul.forward(A),Ul.forward(L),T)):Nh.reverse(Nh.interpolate(Nh.forward(A),Nh.forward(L),T))}eachChild(o){o(this.input);for(const u of this.outputs)o(u)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){let o;o=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const u=[this.operator,o,this.input.serialize()];for(let f=0;f<this.labels.length;f++)u.push(this.labels[f],this.outputs[f].serialize());return u}}function kh(l,o,u,f){const m=f-u,y=l-u;return m===0?0:o===1?y/m:(Math.pow(o,y)-1)/(Math.pow(o,m)-1)}var dl=Rf;class Pu{constructor(o,u){this.type=o,this.args=u}static parse(o,u){if(o.length<2)return u.error("Expectected at least one argument.");let f=null;const m=u.expectedType;m&&m.kind!=="value"&&(f=m);const y=[];for(const T of o.slice(1)){const A=u.parse(T,1+y.length,f,void 0,{typeAnnotation:"omit"});if(!A)return null;f=f||A.type,y.push(A)}const b=m&&y.some(T=>Qt(m,T.type));return new Pu(b?V:f,y)}evaluate(o){let u,f=null,m=0;for(const y of this.args){if(m++,f=y.evaluate(o),f&&f instanceof ua&&!f.available&&(u||(u=f),f=null,m===this.args.length))return u;if(f!==null)break}return f}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=["coalesce"];return this.eachChild(u=>{o.push(u.serialize())}),o}}var yp=Pu;class Df{constructor(o,u){this.type=u.type,this.bindings=[].concat(o),this.result=u}evaluate(o){return this.result.evaluate(o)}eachChild(o){for(const u of this.bindings)o(u[1]);o(this.result)}static parse(o,u){if(o.length<4)return u.error(`Expected at least 3 arguments, but found ${o.length-1} instead.`);const f=[];for(let y=1;y<o.length-1;y+=2){const b=o[y];if(typeof b!="string")return u.error(`Expected string, but found ${typeof b} instead.`,y);if(/[^a-zA-Z0-9_]/.test(b))return u.error("Variable names must contain only alphanumeric characters or '_'.",y);const T=u.parse(o[y+1],y+1);if(!T)return null;f.push([b,T])}const m=u.parse(o[o.length-1],o.length-1,u.expectedType,f);return m?new Df(f,m):null}outputDefined(){return this.result.outputDefined()}serialize(){const o=["let"];for(const[u,f]of this.bindings)o.push(u,f.serialize());return o.push(this.result.serialize()),o}}var Ru=Df;class Fh{constructor(o,u,f){this.type=o,this.index=u,this.input=f}static parse(o,u){if(o.length!==3)return u.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const f=u.parse(o[1],1,hn),m=u.parse(o[2],2,We(u.expectedType||V));return f&&m?new Fh(m.type.itemType,f,m):null}evaluate(o){const u=this.index.evaluate(o),f=this.input.evaluate(o);if(u<0)throw new Lo(`Array index out of bounds: ${u} < 0.`);if(u>=f.length)throw new Lo(`Array index out of bounds: ${u} > ${f.length-1}.`);if(u!==Math.floor(u))throw new Lo(`Array index must be an integer, but found ${u} instead.`);return f[u]}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var lc=Fh;class ot{constructor(o,u){this.type=Yi,this.needle=o,this.haystack=u}static parse(o,u){if(o.length!==3)return u.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const f=u.parse(o[1],1,V),m=u.parse(o[2],2,V);return f&&m?Ln(f.type,[Yi,Wi,hn,rc,V])?new ot(f,m):u.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qe(f.type)} instead`):null}evaluate(o){const u=this.needle.evaluate(o),f=this.haystack.evaluate(o);if(f==null)return!1;if(!gn(u,["boolean","string","number","null"]))throw new Lo(`Expected first argument to be of type boolean, string, number or null, but found ${Qe(so(u))} instead.`);if(!gn(f,["string","array"]))throw new Lo(`Expected second argument to be of type array or string, but found ${Qe(so(f))} instead.`);return f.indexOf(u)>=0}eachChild(o){o(this.needle),o(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Lt=ot;class wn{constructor(o,u,f){this.type=hn,this.needle=o,this.haystack=u,this.fromIndex=f}static parse(o,u){if(o.length<=2||o.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const f=u.parse(o[1],1,V),m=u.parse(o[2],2,V);if(!f||!m)return null;if(!Ln(f.type,[Yi,Wi,hn,rc,V]))return u.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qe(f.type)} instead`);if(o.length===4){const y=u.parse(o[3],3,hn);return y?new wn(f,m,y):null}return new wn(f,m)}evaluate(o){const u=this.needle.evaluate(o),f=this.haystack.evaluate(o);if(!gn(u,["boolean","string","number","null"]))throw new Lo(`Expected first argument to be of type boolean, string, number or null, but found ${Qe(so(u))} instead.`);if(!gn(f,["string","array"]))throw new Lo(`Expected second argument to be of type array or string, but found ${Qe(so(f))} instead.`);if(this.fromIndex){const m=this.fromIndex.evaluate(o);return f.indexOf(u,m)}return f.indexOf(u)}eachChild(o){o(this.needle),o(this.haystack),this.fromIndex&&o(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const o=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),o]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var di=wn;class Ur{constructor(o,u,f,m,y,b){this.inputType=o,this.type=u,this.input=f,this.cases=m,this.outputs=y,this.otherwise=b}static parse(o,u){if(o.length<5)return u.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length%2!=1)return u.error("Expected an even number of arguments.");let f,m;u.expectedType&&u.expectedType.kind!=="value"&&(m=u.expectedType);const y={},b=[];for(let L=2;L<o.length-1;L+=2){let F=o[L];const U=o[L+1];Array.isArray(F)||(F=[F]);const j=u.concat(L);if(F.length===0)return j.error("Expected at least one branch label.");for(const J of F){if(typeof J!="number"&&typeof J!="string")return j.error("Branch labels must be numbers or strings.");if(typeof J=="number"&&Math.abs(J)>Number.MAX_SAFE_INTEGER)return j.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof J=="number"&&Math.floor(J)!==J)return j.error("Numeric branch labels must be integer values.");if(f){if(j.checkSubtype(f,so(J)))return null}else f=so(J);if(y[String(J)]!==void 0)return j.error("Branch labels must be unique.");y[String(J)]=b.length}const Y=u.parse(U,L,m);if(!Y)return null;m=m||Y.type,b.push(Y)}const T=u.parse(o[1],1,V);if(!T)return null;const A=u.parse(o[o.length-1],o.length-1,m);return A?T.type.kind!=="value"&&u.concat(1).checkSubtype(f,T.type)?null:new Ur(f,m,T,y,b,A):null}evaluate(o){const u=this.input.evaluate(o);return(so(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(o)}eachChild(o){o(this.input),this.outputs.forEach(o),o(this.otherwise)}outputDefined(){return this.outputs.every(o=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["match",this.input.serialize()],u=Object.keys(this.cases).sort(),f=[],m={};for(const b of u){const T=m[this.cases[b]];T===void 0?(m[this.cases[b]]=f.length,f.push([this.cases[b],[b]])):f[T][1].push(b)}const y=b=>this.inputType.kind==="number"?Number(b):b;for(const[b,T]of f)o.push(T.length===1?y(T[0]):T.map(y)),o.push(this.outputs[b].serialize());return o.push(this.otherwise.serialize()),o}}var Fi=Ur;class xs{constructor(o,u,f){this.type=o,this.branches=u,this.otherwise=f}static parse(o,u){if(o.length<4)return u.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length%2!=0)return u.error("Expected an odd number of arguments.");let f;u.expectedType&&u.expectedType.kind!=="value"&&(f=u.expectedType);const m=[];for(let b=1;b<o.length-1;b+=2){const T=u.parse(o[b],b,Yi);if(!T)return null;const A=u.parse(o[b+1],b+1,f);if(!A)return null;m.push([T,A]),f=f||A.type}const y=u.parse(o[o.length-1],o.length-1,f);return y?new xs(f,m,y):null}evaluate(o){for(const[u,f]of this.branches)if(u.evaluate(o))return f.evaluate(o);return this.otherwise.evaluate(o)}eachChild(o){for(const[u,f]of this.branches)o(u),o(f);o(this.otherwise)}outputDefined(){return this.branches.every(([o,u])=>u.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["case"];return this.eachChild(u=>{o.push(u.serialize())}),o}}var oo=xs;class qo{constructor(o,u,f,m){this.type=o,this.input=u,this.beginIndex=f,this.endIndex=m}static parse(o,u){if(o.length<=2||o.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const f=u.parse(o[1],1,V),m=u.parse(o[2],2,hn);if(!f||!m)return null;if(!Ln(f.type,[We(V),Wi,V]))return u.error(`Expected first argument to be of type array or string, but found ${Qe(f.type)} instead`);if(o.length===4){const y=u.parse(o[3],3,hn);return y?new qo(f.type,f,m,y):null}return new qo(f.type,f,m)}evaluate(o){const u=this.input.evaluate(o),f=this.beginIndex.evaluate(o);if(!gn(u,["string","array"]))throw new Lo(`Expected first argument to be of type array or string, but found ${Qe(so(u))} instead.`);if(this.endIndex){const m=this.endIndex.evaluate(o);return u.slice(f,m)}return u.slice(f)}eachChild(o){o(this.input),o(this.beginIndex),this.endIndex&&o(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const o=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),o]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var ao=qo;function Ks(l,o){return l==="=="||l==="!="?o.kind==="boolean"||o.kind==="string"||o.kind==="number"||o.kind==="null"||o.kind==="value":o.kind==="string"||o.kind==="number"||o.kind==="value"}function Vl(l,o,u,f){return f.compare(o,u)===0}function go(l,o,u){const f=l!=="=="&&l!=="!=";return class sM{constructor(y,b,T){this.type=Yi,this.lhs=y,this.rhs=b,this.collator=T,this.hasUntypedArgument=y.type.kind==="value"||b.type.kind==="value"}static parse(y,b){if(y.length!==3&&y.length!==4)return b.error("Expected two or three arguments.");const T=y[0];let A=b.parse(y[1],1,V);if(!A)return null;if(!Ks(T,A.type))return b.concat(1).error(`"${T}" comparisons are not supported for type '${Qe(A.type)}'.`);let L=b.parse(y[2],2,V);if(!L)return null;if(!Ks(T,L.type))return b.concat(2).error(`"${T}" comparisons are not supported for type '${Qe(L.type)}'.`);if(A.type.kind!==L.type.kind&&A.type.kind!=="value"&&L.type.kind!=="value")return b.error(`Cannot compare types '${Qe(A.type)}' and '${Qe(L.type)}'.`);f&&(A.type.kind==="value"&&L.type.kind!=="value"?A=new Pr(L.type,[A]):A.type.kind!=="value"&&L.type.kind==="value"&&(L=new Pr(A.type,[L])));let F=null;if(y.length===4){if(A.type.kind!=="string"&&L.type.kind!=="string"&&A.type.kind!=="value"&&L.type.kind!=="value")return b.error("Cannot use collator to compare non-string types.");if(F=b.parse(y[3],3,oe),!F)return null}return new sM(A,L,F)}evaluate(y){const b=this.lhs.evaluate(y),T=this.rhs.evaluate(y);if(f&&this.hasUntypedArgument){const A=so(b),L=so(T);if(A.kind!==L.kind||A.kind!=="string"&&A.kind!=="number")throw new Lo(`Expected arguments for "${l}" to be (string, string) or (number, number), but found (${A.kind}, ${L.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const A=so(b),L=so(T);if(A.kind!=="string"||L.kind!=="string")return o(y,b,T)}return this.collator?u(y,b,T,this.collator.evaluate(y)):o(y,b,T)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}serialize(){const y=[l];return this.eachChild(b=>{y.push(b.serialize())}),y}}}const it=go("==",function(l,o,u){return o===u},Vl),Rt=go("!=",function(l,o,u){return o!==u},function(l,o,u,f){return!Vl(0,o,u,f)}),St=go("<",function(l,o,u){return o<u},function(l,o,u,f){return f.compare(o,u)<0}),Yn=go(">",function(l,o,u){return o>u},function(l,o,u,f){return f.compare(o,u)>0}),Ii=go("<=",function(l,o,u){return o<=u},function(l,o,u,f){return f.compare(o,u)<=0}),Er=go(">=",function(l,o,u){return o>=u},function(l,o,u,f){return f.compare(o,u)>=0});class Vs{constructor(o,u,f,m,y,b){this.type=Wi,this.number=o,this.locale=u,this.currency=f,this.unit=m,this.minFractionDigits=y,this.maxFractionDigits=b}static parse(o,u){if(o.length!==3)return u.error("Expected two arguments.");const f=u.parse(o[1],1,hn);if(!f)return null;const m=o[2];if(typeof m!="object"||Array.isArray(m))return u.error("NumberFormat options argument must be an object.");let y=null;if(m.locale&&(y=u.parse(m.locale,1,Wi),!y))return null;let b=null;if(m.currency&&(b=u.parse(m.currency,1,Wi),!b))return null;let T=null;if(m.unit&&(T=u.parse(m.unit,1,Wi),!T))return null;let A=null;if(m["min-fraction-digits"]&&(A=u.parse(m["min-fraction-digits"],1,hn),!A))return null;let L=null;return m["max-fraction-digits"]&&(L=u.parse(m["max-fraction-digits"],1,hn),!L)?null:new Vs(f,y,b,T,A,L)}evaluate(o){return new Intl.NumberFormat(this.locale?this.locale.evaluate(o):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(o):void 0,unit:this.unit?this.unit.evaluate(o):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(o):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(o):void 0}).format(this.number.evaluate(o))}eachChild(o){o(this.number),this.locale&&o(this.locale),this.currency&&o(this.currency),this.unit&&o(this.unit),this.minFractionDigits&&o(this.minFractionDigits),this.maxFractionDigits&&o(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const o={};return this.locale&&(o.locale=this.locale.serialize()),this.currency&&(o.currency=this.currency.serialize()),this.unit&&(o.unit=this.unit.serialize()),this.minFractionDigits&&(o["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(o["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),o]}}class es{constructor(o){this.type=hn,this.input=o}static parse(o,u){if(o.length!==2)return u.error(`Expected 1 argument, but found ${o.length-1} instead.`);const f=u.parse(o[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?u.error(`Expected argument of type string or array, but found ${Qe(f.type)} instead.`):new es(f):null}evaluate(o){const u=this.input.evaluate(o);if(typeof u=="string"||Array.isArray(u))return u.length;throw new Lo(`Expected value to be of type string or array, but found ${Qe(so(u))} instead.`)}eachChild(o){o(this.input)}outputDefined(){return!1}serialize(){const o=["length"];return this.eachChild(u=>{o.push(u.serialize())}),o}}const bd={"==":it,"!=":Rt,">":Yn,"<":St,">=":Er,"<=":Ii,array:Pr,at:lc,boolean:Pr,case:oo,coalesce:yp,collator:Us,format:Kr,image:_d,in:Lt,"index-of":di,interpolate:dl,"interpolate-hcl":dl,"interpolate-lab":dl,length:es,let:Ru,literal:Sh,match:Fi,number:Pr,"number-format":Vs,object:Pr,slice:ao,step:La,string:Pr,"to-boolean":qc,"to-color":qc,"to-number":qc,"to-string":qc,var:fp,within:sc};function rs(l,[o,u,f,m]){o=o.evaluate(l),u=u.evaluate(l),f=f.evaluate(l);const y=m?m.evaluate(l):1,b=gs(o,u,f,y);if(b)throw new Lo(b);return new Ai(o/255*y,u/255*y,f/255*y,y)}function $i(l,o){return l in o}function Du(l,o){const u=o[l];return u===void 0?null:u}function ha(l){return{type:l}}kl.register(bd,{error:[{kind:"error"},[Wi],(l,[o])=>{throw new Lo(o.evaluate(l))}],typeof:[Wi,[V],(l,[o])=>Qe(so(o.evaluate(l)))],"to-rgba":[We(hn,4),[Ca],(l,[o])=>o.evaluate(l).toArray()],rgb:[Ca,[hn,hn,hn],rs],rgba:[Ca,[hn,hn,hn,hn],rs],has:{type:Yi,overloads:[[[Wi],(l,[o])=>$i(o.evaluate(l),l.properties())],[[Wi,D],(l,[o,u])=>$i(o.evaluate(l),u.evaluate(l))]]},get:{type:V,overloads:[[[Wi],(l,[o])=>Du(o.evaluate(l),l.properties())],[[Wi,D],(l,[o,u])=>Du(o.evaluate(l),u.evaluate(l))]]},"feature-state":[V,[Wi],(l,[o])=>Du(o.evaluate(l),l.featureState||{})],properties:[D,[],l=>l.properties()],"geometry-type":[Wi,[],l=>l.geometryType()],id:[V,[],l=>l.id()],zoom:[hn,[],l=>l.globals.zoom],pitch:[hn,[],l=>l.globals.pitch||0],"distance-from-center":[hn,[],l=>l.distanceFromCenter()],"heatmap-density":[hn,[],l=>l.globals.heatmapDensity||0],"line-progress":[hn,[],l=>l.globals.lineProgress||0],"sky-radial-progress":[hn,[],l=>l.globals.skyRadialProgress||0],accumulated:[V,[],l=>l.globals.accumulated===void 0?null:l.globals.accumulated],"+":[hn,ha(hn),(l,o)=>{let u=0;for(const f of o)u+=f.evaluate(l);return u}],"*":[hn,ha(hn),(l,o)=>{let u=1;for(const f of o)u*=f.evaluate(l);return u}],"-":{type:hn,overloads:[[[hn,hn],(l,[o,u])=>o.evaluate(l)-u.evaluate(l)],[[hn],(l,[o])=>-o.evaluate(l)]]},"/":[hn,[hn,hn],(l,[o,u])=>o.evaluate(l)/u.evaluate(l)],"%":[hn,[hn,hn],(l,[o,u])=>o.evaluate(l)%u.evaluate(l)],ln2:[hn,[],()=>Math.LN2],pi:[hn,[],()=>Math.PI],e:[hn,[],()=>Math.E],"^":[hn,[hn,hn],(l,[o,u])=>Math.pow(o.evaluate(l),u.evaluate(l))],sqrt:[hn,[hn],(l,[o])=>Math.sqrt(o.evaluate(l))],log10:[hn,[hn],(l,[o])=>Math.log(o.evaluate(l))/Math.LN10],ln:[hn,[hn],(l,[o])=>Math.log(o.evaluate(l))],log2:[hn,[hn],(l,[o])=>Math.log(o.evaluate(l))/Math.LN2],sin:[hn,[hn],(l,[o])=>Math.sin(o.evaluate(l))],cos:[hn,[hn],(l,[o])=>Math.cos(o.evaluate(l))],tan:[hn,[hn],(l,[o])=>Math.tan(o.evaluate(l))],asin:[hn,[hn],(l,[o])=>Math.asin(o.evaluate(l))],acos:[hn,[hn],(l,[o])=>Math.acos(o.evaluate(l))],atan:[hn,[hn],(l,[o])=>Math.atan(o.evaluate(l))],min:[hn,ha(hn),(l,o)=>Math.min(...o.map(u=>u.evaluate(l)))],max:[hn,ha(hn),(l,o)=>Math.max(...o.map(u=>u.evaluate(l)))],abs:[hn,[hn],(l,[o])=>Math.abs(o.evaluate(l))],round:[hn,[hn],(l,[o])=>{const u=o.evaluate(l);return u<0?-Math.round(-u):Math.round(u)}],floor:[hn,[hn],(l,[o])=>Math.floor(o.evaluate(l))],ceil:[hn,[hn],(l,[o])=>Math.ceil(o.evaluate(l))],"filter-==":[Yi,[Wi,V],(l,[o,u])=>l.properties()[o.value]===u.value],"filter-id-==":[Yi,[V],(l,[o])=>l.id()===o.value],"filter-type-==":[Yi,[Wi],(l,[o])=>l.geometryType()===o.value],"filter-<":[Yi,[Wi,V],(l,[o,u])=>{const f=l.properties()[o.value],m=u.value;return typeof f==typeof m&&f<m}],"filter-id-<":[Yi,[V],(l,[o])=>{const u=l.id(),f=o.value;return typeof u==typeof f&&u<f}],"filter->":[Yi,[Wi,V],(l,[o,u])=>{const f=l.properties()[o.value],m=u.value;return typeof f==typeof m&&f>m}],"filter-id->":[Yi,[V],(l,[o])=>{const u=l.id(),f=o.value;return typeof u==typeof f&&u>f}],"filter-<=":[Yi,[Wi,V],(l,[o,u])=>{const f=l.properties()[o.value],m=u.value;return typeof f==typeof m&&f<=m}],"filter-id-<=":[Yi,[V],(l,[o])=>{const u=l.id(),f=o.value;return typeof u==typeof f&&u<=f}],"filter->=":[Yi,[Wi,V],(l,[o,u])=>{const f=l.properties()[o.value],m=u.value;return typeof f==typeof m&&f>=m}],"filter-id->=":[Yi,[V],(l,[o])=>{const u=l.id(),f=o.value;return typeof u==typeof f&&u>=f}],"filter-has":[Yi,[V],(l,[o])=>o.value in l.properties()],"filter-has-id":[Yi,[],l=>l.id()!==null&&l.id()!==void 0],"filter-type-in":[Yi,[We(Wi)],(l,[o])=>o.value.indexOf(l.geometryType())>=0],"filter-id-in":[Yi,[We(V)],(l,[o])=>o.value.indexOf(l.id())>=0],"filter-in-small":[Yi,[Wi,We(V)],(l,[o,u])=>u.value.indexOf(l.properties()[o.value])>=0],"filter-in-large":[Yi,[Wi,We(V)],(l,[o,u])=>function(f,m,y,b){for(;y<=b;){const T=y+b>>1;if(m[T]===f)return!0;m[T]>f?b=T-1:y=T+1}return!1}(l.properties()[o.value],u.value,0,u.value.length-1)],all:{type:Yi,overloads:[[[Yi,Yi],(l,[o,u])=>o.evaluate(l)&&u.evaluate(l)],[ha(Yi),(l,o)=>{for(const u of o)if(!u.evaluate(l))return!1;return!0}]]},any:{type:Yi,overloads:[[[Yi,Yi],(l,[o,u])=>o.evaluate(l)||u.evaluate(l)],[ha(Yi),(l,o)=>{for(const u of o)if(u.evaluate(l))return!0;return!1}]]},"!":[Yi,[Yi],(l,[o])=>!o.evaluate(l)],"is-supported-script":[Yi,[Wi],(l,[o])=>{const u=l.globals&&l.globals.isSupportedScript;return!u||u(o.evaluate(l))}],upcase:[Wi,[Wi],(l,[o])=>o.evaluate(l).toUpperCase()],downcase:[Wi,[Wi],(l,[o])=>o.evaluate(l).toLowerCase()],concat:[Wi,ha(V),(l,o)=>o.map(u=>ca(u.evaluate(l))).join("")],"resolved-locale":[Wi,[oe],(l,[o])=>o.evaluate(l).resolvedLocale()]});var Za=bd;function _o(l){return{result:"success",value:l}}function Ho(l){return{result:"error",value:l}}function er(l){return l["property-type"]==="data-driven"}function Ya(l){return!!l.expression&&l.expression.parameters.indexOf("zoom")>-1}function uc(l){return!!l.expression&&l.expression.interpolated}function Oi(l){return l instanceof Number?"number":l instanceof String?"string":l instanceof Boolean?"boolean":Array.isArray(l)?"array":l===null?"null":typeof l}function eu(l){return typeof l=="object"&&l!==null&&!Array.isArray(l)}function lm(l){return l}function Bh(l,o){const u=o.type==="color",f=l.stops&&typeof l.stops[0][0]=="object",m=f||!(f||l.property!==void 0),y=l.type||(uc(o)?"exponential":"interval");if(u&&((l=Ol({},l)).stops&&(l.stops=l.stops.map(L=>[L[0],Ai.parse(L[1])])),l.default=Ai.parse(l.default?l.default:o.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!_p[l.colorSpace])throw new Error(`Unknown color space: ${l.colorSpace}`);let b,T,A;if(y==="exponential")b=zh;else if(y==="interval")b=cc;else if(y==="categorical"){b=Ka,T=Object.create(null);for(const L of l.stops)T[L[0]]=L[1];A=typeof l.stops[0][0]}else{if(y!=="identity")throw new Error(`Unknown function type "${y}"`);b=hc}if(f){const L={},F=[];for(let Y=0;Y<l.stops.length;Y++){const J=l.stops[Y],ee=J[0].zoom;L[ee]===void 0&&(L[ee]={zoom:ee,type:l.type,property:l.property,default:l.default,stops:[]},F.push(ee)),L[ee].stops.push([J[0].value,J[1]])}const U=[];for(const Y of F)U.push([L[Y].zoom,Bh(L[Y],o)]);const j={name:"linear"};return{kind:"composite",interpolationType:j,interpolationFactor:dl.interpolationFactor.bind(void 0,j),zoomStops:U.map(Y=>Y[0]),evaluate:({zoom:Y},J)=>zh({stops:U,base:l.base},o,Y).evaluate(Y,J)}}if(m){const L=y==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:L,interpolationFactor:dl.interpolationFactor.bind(void 0,L),zoomStops:l.stops.map(F=>F[0]),evaluate:({zoom:F})=>b(l,o,F,T,A)}}return{kind:"source",evaluate(L,F){const U=F&&F.properties?F.properties[l.property]:void 0;return U===void 0?tu(l.default,o.default):b(l,o,U,T,A)}}}function tu(l,o,u){return l!==void 0?l:o!==void 0?o:u!==void 0?u:void 0}function Ka(l,o,u,f,m){return tu(typeof u===m?f[u]:void 0,l.default,o.default)}function cc(l,o,u){if(Oi(u)!=="number")return tu(l.default,o.default);const f=l.stops.length;if(f===1||u<=l.stops[0][0])return l.stops[0][1];if(u>=l.stops[f-1][0])return l.stops[f-1][1];const m=Cu(l.stops.map(y=>y[0]),u);return l.stops[m][1]}function zh(l,o,u){const f=l.base!==void 0?l.base:1;if(Oi(u)!=="number")return tu(l.default,o.default);const m=l.stops.length;if(m===1||u<=l.stops[0][0])return l.stops[0][1];if(u>=l.stops[m-1][0])return l.stops[m-1][1];const y=Cu(l.stops.map(F=>F[0]),u),b=function(F,U,j,Y){const J=Y-j,ee=F-j;return J===0?0:U===1?ee/J:(Math.pow(U,ee)-1)/(Math.pow(U,J)-1)}(u,f,l.stops[y][0],l.stops[y+1][0]),T=l.stops[y][1],A=l.stops[y+1][1];let L=oc[o.type]||lm;if(l.colorSpace&&l.colorSpace!=="rgb"){const F=_p[l.colorSpace];L=(U,j)=>F.reverse(F.interpolate(F.forward(U),F.forward(j),b))}return typeof T.evaluate=="function"?{evaluate(...F){const U=T.evaluate.apply(void 0,F),j=A.evaluate.apply(void 0,F);if(U!==void 0&&j!==void 0)return L(U,j,b)}}:L(T,A,b)}function hc(l,o,u){return o.type==="color"?u=Ai.parse(u):o.type==="formatted"?u=Go.fromString(u.toString()):o.type==="resolvedImage"?u=ua.fromString(u.toString()):Oi(u)===o.type||o.type==="enum"&&o.values[u]||(u=void 0),tu(u,l.default,o.default)}class fc{constructor(o,u){this.expression=o,this._warningHistory={},this._evaluator=new Cf,this._defaultValue=u?function(f){return f.type==="color"&&(eu(f.default)||Array.isArray(f.default))?new Ai(0,0,0,0):f.type==="color"?Ai.parse(f.default)||null:f.default===void 0?null:f.default}(u):null,this._enumValues=u&&u.type==="enum"?u.values:null}evaluateWithoutErrorHandling(o,u,f,m,y,b,T,A){return this._evaluator.globals=o,this._evaluator.feature=u,this._evaluator.featureState=f,this._evaluator.canonical=m||null,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=b,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=A||null,this.expression.evaluate(this._evaluator)}evaluate(o,u,f,m,y,b,T,A){this._evaluator.globals=o,this._evaluator.feature=u||null,this._evaluator.featureState=f||null,this._evaluator.canonical=m||null,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=b||null,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=A||null;try{const L=this.expression.evaluate(this._evaluator);if(L==null||typeof L=="number"&&L!=L)return this._defaultValue;if(this._enumValues&&!(L in this._enumValues))throw new Lo(`Expected value to be one of ${Object.keys(this._enumValues).map(F=>JSON.stringify(F)).join(", ")}, but found ${JSON.stringify(L)} instead.`);return L}catch(L){return this._warningHistory[L.message]||(this._warningHistory[L.message]=!0,typeof console<"u"&&console.warn(L.message)),this._defaultValue}}}function Of(l){return Array.isArray(l)&&l.length>0&&typeof l[0]=="string"&&l[0]in Za}function Zc(l,o){const u=new dp(Za,[],o?function(m){const y={color:Ca,string:Wi,number:hn,enum:Wi,boolean:Yi,formatted:Ae,resolvedImage:Xe};return m.type==="array"?We(y[m.value]||V,m.length):y[m.type]}(o):void 0),f=u.parse(l,void 0,void 0,void 0,o&&o.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?_o(new fc(f,o)):Ho(u.errors)}class vp{constructor(o,u){this.kind=o,this._styleExpression=u,this.isStateDependent=o!=="constant"&&!zr(u.expression)}evaluateWithoutErrorHandling(o,u,f,m,y,b){return this._styleExpression.evaluateWithoutErrorHandling(o,u,f,m,y,b)}evaluate(o,u,f,m,y,b){return this._styleExpression.evaluate(o,u,f,m,y,b)}}class Ou{constructor(o,u,f,m){this.kind=o,this.zoomStops=f,this._styleExpression=u,this.isStateDependent=o!=="camera"&&!zr(u.expression),this.interpolationType=m}evaluateWithoutErrorHandling(o,u,f,m,y,b){return this._styleExpression.evaluateWithoutErrorHandling(o,u,f,m,y,b)}evaluate(o,u,f,m,y,b){return this._styleExpression.evaluate(o,u,f,m,y,b)}interpolationFactor(o,u,f){return this.interpolationType?dl.interpolationFactor(this.interpolationType,o,u,f):0}}function Gl(l,o){if((l=Zc(l,o)).result==="error")return l;const u=l.value.expression,f=Tu(u);if(!f&&!er(o))return Ho([new Nl("","data expressions not supported")]);const m=Bl(u,["zoom","pitch","distance-from-center"]);if(!m&&!Ya(o))return Ho([new Nl("","zoom expressions not supported")]);const y=xp(u);return y||m?y instanceof Nl?Ho([y]):y instanceof dl&&!uc(o)?Ho([new Nl("",'"interpolate" expressions cannot be used with this property')]):_o(y?new Ou(f?"camera":"composite",l.value,y.labels,y instanceof dl?y.interpolation:void 0):new vp(f?"constant":"source",l.value)):Ho([new Nl("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Uh{constructor(o,u){this._parameters=o,this._specification=u,Ol(this,Bh(this._parameters,this._specification))}static deserialize(o){return new Uh(o._parameters,o._specification)}static serialize(o){return{_parameters:o._parameters,_specification:o._specification}}}function xp(l){let o=null;if(l instanceof Ru)o=xp(l.result);else if(l instanceof yp){for(const u of l.args)if(o=xp(u),o)break}else(l instanceof La||l instanceof dl)&&l.input instanceof kl&&l.input.name==="zoom"&&(o=l);return o instanceof Nl||l.eachChild(u=>{const f=xp(u);f instanceof Nl?o=f:!o&&f?o=new Nl("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):o&&f&&o!==f&&(o=new Nl("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),o}class Sn{constructor(o,u,f,m){this.message=(o?`${o}: `:"")+f,m&&(this.identifier=m),u!=null&&u.__line__&&(this.line=u.__line__)}}function nu(l){const o=l.key,u=l.value,f=l.valueSpec||{},m=l.objectElementValidators||{},y=l.style,b=l.styleSpec;let T=[];const A=Oi(u);if(A!=="object")return[new Sn(o,u,`object expected, ${A} found`)];for(const L in u){const F=L.split(".")[0],U=f[F]||f["*"];let j;m[F]?j=m[F]:f[F]?j=Li:m["*"]?j=m["*"]:f["*"]&&(j=Li),j?T=T.concat(j({key:(o&&`${o}.`)+L,value:u[L],valueSpec:U,style:y,styleSpec:b,object:u,objectKey:L},u)):T.push(new Sn(o,u[L],`unknown property "${L}"`))}for(const L in f)m[L]||f[L].required&&f[L].default===void 0&&u[L]===void 0&&T.push(new Sn(o,u,`missing required property "${L}"`));return T}function bp(l){const o=l.value,u=l.valueSpec,f=l.style,m=l.styleSpec,y=l.key,b=l.arrayElementValidator||Li;if(Oi(o)!=="array")return[new Sn(y,o,`array expected, ${Oi(o)} found`)];if(u.length&&o.length!==u.length)return[new Sn(y,o,`array length ${u.length} expected, length ${o.length} found`)];if(u["min-length"]&&o.length<u["min-length"])return[new Sn(y,o,`array length at least ${u["min-length"]} expected, length ${o.length} found`)];let T={type:u.value,values:u.values,minimum:u.minimum,maximum:u.maximum,function:void 0};m.$version<7&&(T.function=u.function),Oi(u.value)==="object"&&(T=u.value);let A=[];for(let L=0;L<o.length;L++)A=A.concat(b({array:o,arrayIndex:L,value:o[L],valueSpec:T,style:f,styleSpec:m,key:`${y}[${L}]`}));return A}function Ed(l){const o=l.key,u=l.value,f=l.valueSpec;let m=Oi(u);if(m==="number"&&u!=u&&(m="NaN"),m!=="number")return[new Sn(o,u,`number expected, ${m} found`)];if("minimum"in f){let y=f.minimum;if(Oi(f.minimum)==="array"&&(y=f.minimum[l.arrayIndex]),u<y)return[new Sn(o,u,`${u} is less than the minimum value ${y}`)]}if("maximum"in f){let y=f.maximum;if(Oi(f.maximum)==="array"&&(y=f.maximum[l.arrayIndex]),u>y)return[new Sn(o,u,`${u} is greater than the maximum value ${y}`)]}return[]}function Nf(l){const o=l.valueSpec,u=zs(l.value.type);let f,m,y,b={};const T=u!=="categorical"&&l.value.property===void 0,A=!T,L=Oi(l.value.stops)==="array"&&Oi(l.value.stops[0])==="array"&&Oi(l.value.stops[0][0])==="object",F=nu({key:l.key,value:l.value,valueSpec:l.styleSpec.function,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{stops:function(Y){if(u==="identity")return[new Sn(Y.key,Y.value,'identity function may not have a "stops" property')];let J=[];const ee=Y.value;return J=J.concat(bp({key:Y.key,value:ee,valueSpec:Y.valueSpec,style:Y.style,styleSpec:Y.styleSpec,arrayElementValidator:U})),Oi(ee)==="array"&&ee.length===0&&J.push(new Sn(Y.key,ee,"array must have at least one stop")),J},default:function(Y){return Li({key:Y.key,value:Y.value,valueSpec:o,style:Y.style,styleSpec:Y.styleSpec})}}});return u==="identity"&&T&&F.push(new Sn(l.key,l.value,'missing required property "property"')),u==="identity"||l.value.stops||F.push(new Sn(l.key,l.value,'missing required property "stops"')),u==="exponential"&&l.valueSpec.expression&&!uc(l.valueSpec)&&F.push(new Sn(l.key,l.value,"exponential functions not supported")),l.styleSpec.$version>=8&&(A&&!er(l.valueSpec)?F.push(new Sn(l.key,l.value,"property functions not supported")):T&&!Ya(l.valueSpec)&&F.push(new Sn(l.key,l.value,"zoom functions not supported"))),u!=="categorical"&&!L||l.value.property!==void 0||F.push(new Sn(l.key,l.value,'"property" property is required')),F;function U(Y){let J=[];const ee=Y.value,ce=Y.key;if(Oi(ee)!=="array")return[new Sn(ce,ee,`array expected, ${Oi(ee)} found`)];if(ee.length!==2)return[new Sn(ce,ee,`array length 2 expected, length ${ee.length} found`)];if(L){if(Oi(ee[0])!=="object")return[new Sn(ce,ee,`object expected, ${Oi(ee[0])} found`)];if(ee[0].zoom===void 0)return[new Sn(ce,ee,"object stop key must have zoom")];if(ee[0].value===void 0)return[new Sn(ce,ee,"object stop key must have value")];const we=zs(ee[0].zoom);if(typeof we!="number")return[new Sn(ce,ee[0].zoom,"stop zoom values must be numbers")];if(y&&y>we)return[new Sn(ce,ee[0].zoom,"stop zoom values must appear in ascending order")];we!==y&&(y=we,m=void 0,b={}),J=J.concat(nu({key:`${ce}[0]`,value:ee[0],valueSpec:{zoom:{}},style:Y.style,styleSpec:Y.styleSpec,objectElementValidators:{zoom:Ed,value:j}}))}else J=J.concat(j({key:`${ce}[0]`,value:ee[0],valueSpec:{},style:Y.style,styleSpec:Y.styleSpec},ee));return Of(ic(ee[1]))?J.concat([new Sn(`${ce}[1]`,ee[1],"expressions are not allowed in function stops.")]):J.concat(Li({key:`${ce}[1]`,value:ee[1],valueSpec:o,style:Y.style,styleSpec:Y.styleSpec}))}function j(Y,J){const ee=Oi(Y.value),ce=zs(Y.value),we=Y.value!==null?Y.value:J;if(f){if(ee!==f)return[new Sn(Y.key,we,`${ee} stop domain type must match previous stop domain type ${f}`)]}else f=ee;if(ee!=="number"&&ee!=="string"&&ee!=="boolean"&&typeof ce!="number"&&typeof ce!="string"&&typeof ce!="boolean")return[new Sn(Y.key,we,"stop domain value must be a number, string, or boolean")];if(ee!=="number"&&u!=="categorical"){let Pe=`number expected, ${ee} found`;return er(o)&&u===void 0&&(Pe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Sn(Y.key,we,Pe)]}return u!=="categorical"||ee!=="number"||typeof ce=="number"&&isFinite(ce)&&Math.floor(ce)===ce?u!=="categorical"&&ee==="number"&&typeof ce=="number"&&typeof m=="number"&&m!==void 0&&ce<m?[new Sn(Y.key,we,"stop domain values must appear in ascending order")]:(m=ce,u==="categorical"&&ce in b?[new Sn(Y.key,we,"stop domain values must be unique")]:(b[ce]=!0,[])):[new Sn(Y.key,we,`integer expected, found ${String(ce)}`)]}}function wd(l){const o=(l.expressionContext==="property"?Gl:Zc)(ic(l.value),l.valueSpec);if(o.result==="error")return o.value.map(f=>new Sn(`${l.key}${f.key}`,l.value,f.message));const u=o.value.expression||o.value._styleExpression.expression;if(l.expressionContext==="property"&&l.propertyKey==="text-font"&&!u.outputDefined())return[new Sn(l.key,l.value,`Invalid data expression for "${l.propertyKey}". Output values must be contained as literals within the expression.`)];if(l.expressionContext==="property"&&l.propertyType==="layout"&&!zr(u))return[new Sn(l.key,l.value,'"feature-state" data expressions are not supported with layout properties.')];if(l.expressionContext==="filter")return mg(u,l);if(l.expressionContext&&l.expressionContext.indexOf("cluster")===0){if(!Bl(u,["zoom","feature-state"]))return[new Sn(l.key,l.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(l.expressionContext==="cluster-initial"&&!Tu(u))return[new Sn(l.key,l.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function mg(l,o){const u=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(o.valueSpec&&o.valueSpec.expression)for(const m of o.valueSpec.expression.parameters)u.delete(m);if(u.size===0)return[];const f=[];return l instanceof kl&&u.has(l.name)?[new Sn(o.key,o.value,`["${l.name}"] expression is not supported in a filter for a ${o.object.type} layer with id: ${o.object.id}`)]:(l.eachChild(m=>{f.push(...mg(m,o))}),f)}function um(l){const o=l.key,u=l.value,f=l.valueSpec,m=[];return Array.isArray(f.values)?f.values.indexOf(zs(u))===-1&&m.push(new Sn(o,u,`expected one of [${f.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(f.values).indexOf(zs(u))===-1&&m.push(new Sn(o,u,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(u)} found`)),m}function gg(l){if(l===!0||l===!1)return!0;if(!Array.isArray(l)||l.length===0)return!1;switch(l[0]){case"has":return l.length>=2&&l[1]!=="$id"&&l[1]!=="$type";case"in":return l.length>=3&&(typeof l[1]!="string"||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return l.length!==3||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(const o of l.slice(1))if(!gg(o)&&typeof o!="boolean")return!1;return!0;default:return!0}}function lo(l,o="fill"){if(l==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};gg(l)||(l=Vh(l));const u=l;let f=!0;try{f=function(L){if(!ta(L))return L;let F=ic(L);return Ep(F),F=Po(F),F}(u)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(u,null,2)}
        `)}const m=wt[`filter_${o}`],y=Zc(f,m);let b=null;if(y.result==="error")throw new Error(y.value.map(L=>`${L.key}: ${L.message}`).join(", "));b=(L,F,U)=>y.value.evaluate(L,F,{},U);let T=null,A=null;if(f!==u){const L=Zc(u,m);if(L.result==="error")throw new Error(L.value.map(F=>`${F.key}: ${F.message}`).join(", "));T=(F,U,j,Y,J)=>L.value.evaluate(F,U,{},j,void 0,void 0,Y,J),A=!Tu(L.value.expression)}return{filter:b,dynamicFilter:T||void 0,needGeometry:cm(f),needFeature:!!A}}function Po(l){if(!Array.isArray(l))return l;const o=function(u){if(wp.has(u[0])){for(let f=1;f<u.length;f++)if(ta(u[f]))return!0}return u}(l);return o===!0?o:o.map(u=>Po(u))}function Ep(l){let o=!1;const u=[];if(l[0]==="case"){for(let f=1;f<l.length-1;f+=2)o=o||ta(l[f]),u.push(l[f+1]);u.push(l[l.length-1])}else if(l[0]==="match"){o=o||ta(l[1]);for(let f=2;f<l.length-1;f+=2)u.push(l[f+1]);u.push(l[l.length-1])}else if(l[0]==="step"){o=o||ta(l[1]);for(let f=1;f<l.length-1;f+=2)u.push(l[f+1])}o&&(l.length=0,l.push("any",...u));for(let f=1;f<l.length;f++)Ep(l[f])}function ta(l){if(!Array.isArray(l))return!1;if((o=l[0])==="pitch"||o==="distance-from-center")return!0;var o;for(let u=1;u<l.length;u++)if(ta(l[u]))return!0;return!1}const wp=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Zv(l,o){return l<o?-1:l>o?1:0}function cm(l){if(!Array.isArray(l))return!1;if(l[0]==="within")return!0;for(let o=1;o<l.length;o++)if(cm(l[o]))return!0;return!1}function Vh(l){if(!l)return!0;const o=l[0];return l.length<=1?o!=="any":o==="=="?Ip(l[1],l[2],"=="):o==="!="?dc(Ip(l[1],l[2],"==")):o==="<"||o===">"||o==="<="||o===">="?Ip(l[1],l[2],o):o==="any"?(u=l.slice(1),["any"].concat(u.map(Vh))):o==="all"?["all"].concat(l.slice(1).map(Vh)):o==="none"?["all"].concat(l.slice(1).map(Vh).map(dc)):o==="in"?Yc(l[1],l.slice(2)):o==="!in"?dc(Yc(l[1],l.slice(2))):o==="has"?Id(l[1]):o==="!has"?dc(Id(l[1])):o!=="within"||l;var u}function Ip(l,o,u){switch(l){case"$type":return[`filter-type-${u}`,o];case"$id":return[`filter-id-${u}`,o];default:return[`filter-${u}`,l,o]}}function Yc(l,o){if(o.length===0)return!1;switch(l){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(u=>typeof u!=typeof o[0])?["filter-in-large",l,["literal",o.sort(Zv)]]:["filter-in-small",l,["literal",o]]}}function Id(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function dc(l){return["!",l]}function Td(l){return gg(ic(l.value))?wd(Ol({},l,{expressionContext:"filter",valueSpec:l.styleSpec[`filter_${l.layerType||"fill"}`]})):kf(l)}function kf(l){const o=l.value,u=l.key;if(Oi(o)!=="array")return[new Sn(u,o,`array expected, ${Oi(o)} found`)];const f=l.styleSpec;let m,y=[];if(o.length<1)return[new Sn(u,o,"filter array must have at least 1 element")];switch(y=y.concat(um({key:`${u}[0]`,value:o[0],valueSpec:f.filter_operator,style:l.style,styleSpec:l.styleSpec})),zs(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&zs(o[1])==="$type"&&y.push(new Sn(u,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":o.length!==3&&y.push(new Sn(u,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(m=Oi(o[1]),m!=="string"&&y.push(new Sn(`${u}[1]`,o[1],`string expected, ${m} found`)));for(let b=2;b<o.length;b++)m=Oi(o[b]),zs(o[1])==="$type"?y=y.concat(um({key:`${u}[${b}]`,value:o[b],valueSpec:f.geometry_type,style:l.style,styleSpec:l.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&y.push(new Sn(`${u}[${b}]`,o[b],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let b=1;b<o.length;b++)y=y.concat(kf({key:`${u}[${b}]`,value:o[b],style:l.style,styleSpec:l.styleSpec}));break;case"has":case"!has":m=Oi(o[1]),o.length!==2?y.push(new Sn(u,o,`filter array for "${o[0]}" operator must have 2 elements`)):m!=="string"&&y.push(new Sn(`${u}[1]`,o[1],`string expected, ${m} found`));break;case"within":m=Oi(o[1]),o.length!==2?y.push(new Sn(u,o,`filter array for "${o[0]}" operator must have 2 elements`)):m!=="object"&&y.push(new Sn(`${u}[1]`,o[1],`object expected, ${m} found`))}return y}function hm(l,o){const u=l.key,f=l.style,m=l.styleSpec,y=l.value,b=l.objectKey,T=m[`${o}_${l.layerType}`];if(!T)return[];const A=b.match(/^(.*)-transition$/);if(o==="paint"&&A&&T[A[1]]&&T[A[1]].transition)return Li({key:u,value:y,valueSpec:m.transition,style:f,styleSpec:m});const L=l.valueSpec||T[b];if(!L)return[new Sn(u,y,`unknown property "${b}"`)];let F;if(Oi(y)==="string"&&er(L)&&!L.tokens&&(F=/^{([^}]+)}$/.exec(y)))return[new Sn(u,y,`"${b}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(F[1])} }\`.`)];const U=[];return l.layerType==="symbol"&&(b==="text-field"&&f&&!f.glyphs&&U.push(new Sn(u,y,'use of "text-field" requires a style "glyphs" property')),b==="text-font"&&eu(ic(y))&&zs(y.type)==="identity"&&U.push(new Sn(u,y,'"text-font" does not support identity functions'))),U.concat(Li({key:l.key,value:y,valueSpec:L,style:f,styleSpec:m,expressionContext:"property",propertyType:o,propertyKey:b}))}function D_(l){return hm(l,"paint")}function _g(l){return hm(l,"layout")}function yg(l){let o=[];const u=l.value,f=l.key,m=l.style,y=l.styleSpec;u.type||u.ref||o.push(new Sn(f,u,'either "type" or "ref" is required'));let b=zs(u.type);const T=zs(u.ref);if(u.id){const A=zs(u.id);for(let L=0;L<l.arrayIndex;L++){const F=m.layers[L];zs(F.id)===A&&o.push(new Sn(f,u.id,`duplicate layer id "${u.id}", previously used at line ${F.id.__line__}`))}}if("ref"in u){let A;["type","source","source-layer","filter","layout"].forEach(L=>{L in u&&o.push(new Sn(f,u[L],`"${L}" is prohibited for ref layers`))}),m.layers.forEach(L=>{zs(L.id)===T&&(A=L)}),A?A.ref?o.push(new Sn(f,u.ref,"ref cannot reference another ref layer")):b=zs(A.type):typeof T=="string"&&o.push(new Sn(f,u.ref,`ref layer "${T}" not found`))}else if(b!=="background"&&b!=="sky")if(u.source){const A=m.sources&&m.sources[u.source],L=A&&zs(A.type);A?L==="vector"&&b==="raster"?o.push(new Sn(f,u.source,`layer "${u.id}" requires a raster source`)):L==="raster"&&b!=="raster"?o.push(new Sn(f,u.source,`layer "${u.id}" requires a vector source`)):L!=="vector"||u["source-layer"]?L==="raster-dem"&&b!=="hillshade"?o.push(new Sn(f,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):b!=="line"||!u.paint||!u.paint["line-gradient"]&&!u.paint["line-trim-offset"]||L==="geojson"&&A.lineMetrics||o.push(new Sn(f,u,`layer "${u.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):o.push(new Sn(f,u,`layer "${u.id}" must specify a "source-layer"`)):o.push(new Sn(f,u.source,`source "${u.source}" not found`))}else o.push(new Sn(f,u,'missing required property "source"'));return o=o.concat(nu({key:f,value:u,valueSpec:y.layer,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Li({key:`${f}.type`,value:u.type,valueSpec:y.layer.type,style:l.style,styleSpec:l.styleSpec,object:u,objectKey:"type"}),filter:A=>Td(Ol({layerType:b},A)),layout:A=>nu({layer:u,key:A.key,value:A.value,valueSpec:{},style:A.style,styleSpec:A.styleSpec,objectElementValidators:{"*":L=>_g(Ol({layerType:b},L))}}),paint:A=>nu({layer:u,key:A.key,value:A.value,valueSpec:{},style:A.style,styleSpec:A.styleSpec,objectElementValidators:{"*":L=>D_(Ol({layerType:b},L))}})}})),o}function Sd(l){const o=l.value,u=l.key,f=Oi(o);return f!=="string"?[new Sn(u,o,`string expected, ${f} found`)]:[]}const Ff={promoteId:function({key:l,value:o}){if(Oi(o)==="string")return Sd({key:l,value:o});{const u=[];for(const f in o)u.push(...Sd({key:`${l}.${f}`,value:o[f]}));return u}}};function Kc(l){const o=l.value,u=l.key,f=l.styleSpec,m=l.style;if(!o.type)return[new Sn(u,o,'"type" is required')];const y=zs(o.type);let b;switch(y){case"vector":case"raster":case"raster-dem":return b=nu({key:u,value:o,valueSpec:f[`source_${y.replace("-","_")}`],style:l.style,styleSpec:f,objectElementValidators:Ff}),b;case"geojson":if(b=nu({key:u,value:o,valueSpec:f.source_geojson,style:m,styleSpec:f,objectElementValidators:Ff}),o.cluster)for(const T in o.clusterProperties){const[A,L]=o.clusterProperties[T],F=typeof A=="string"?[A,["accumulated"],["get",T]]:A;b.push(...wd({key:`${u}.${T}.map`,value:L,expressionContext:"cluster-map"})),b.push(...wd({key:`${u}.${T}.reduce`,value:F,expressionContext:"cluster-reduce"}))}return b;case"video":return nu({key:u,value:o,valueSpec:f.source_video,style:m,styleSpec:f});case"image":return nu({key:u,value:o,valueSpec:f.source_image,style:m,styleSpec:f});case"canvas":return[new Sn(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return um({key:`${u}.type`,value:o.type,valueSpec:{values:vg(f)},style:m,styleSpec:f})}}function vg(l){return l.source.reduce((o,u)=>{const f=l[u];return f.type.type==="enum"&&(o=o.concat(Object.keys(f.type.values))),o},[])}function he(l){const o=l.value,u=l.styleSpec,f=u.light,m=l.style;let y=[];const b=Oi(o);if(o===void 0)return y;if(b!=="object")return y=y.concat([new Sn("light",o,`object expected, ${b} found`)]),y;for(const T in o){const A=T.match(/^(.*)-transition$/);y=y.concat(A&&f[A[1]]&&f[A[1]].transition?Li({key:T,value:o[T],valueSpec:u.transition,style:m,styleSpec:u}):f[T]?Li({key:T,value:o[T],valueSpec:f[T],style:m,styleSpec:u}):[new Sn(T,o[T],`unknown property "${T}"`)])}return y}function Gh(l){const o=l.value,u=l.key,f=l.style,m=l.styleSpec,y=m.terrain;let b=[];const T=Oi(o);if(o===void 0)return b;if(T!=="object")return b=b.concat([new Sn("terrain",o,`object expected, ${T} found`)]),b;for(const A in o){const L=A.match(/^(.*)-transition$/);b=b.concat(L&&y[L[1]]&&y[L[1]].transition?Li({key:A,value:o[A],valueSpec:m.transition,style:f,styleSpec:m}):y[A]?Li({key:A,value:o[A],valueSpec:y[A],style:f,styleSpec:m}):[new Sn(A,o[A],`unknown property "${A}"`)])}if(o.source){const A=f.sources&&f.sources[o.source],L=A&&zs(A.type);A?L!=="raster-dem"&&b.push(new Sn(u,o.source,`terrain cannot be used with a source of type ${String(L)}, it only be used with a "raster-dem" source type`)):b.push(new Sn(u,o.source,`source "${o.source}" not found`))}else b.push(new Sn(u,o,'terrain is missing required property "source"'));return b}function Tp(l){const o=l.value,u=l.style,f=l.styleSpec,m=f.fog;let y=[];const b=Oi(o);if(o===void 0)return y;if(b!=="object")return y=y.concat([new Sn("fog",o,`object expected, ${b} found`)]),y;for(const T in o){const A=T.match(/^(.*)-transition$/);y=y.concat(A&&m[A[1]]&&m[A[1]].transition?Li({key:T,value:o[T],valueSpec:f.transition,style:u,styleSpec:f}):m[T]?Li({key:T,value:o[T],valueSpec:m[T],style:u,styleSpec:f}):[new Sn(T,o[T],`unknown property "${T}"`)])}return y}const Ja={"*":()=>[],array:bp,boolean:function(l){const o=l.value,u=l.key,f=Oi(o);return f!=="boolean"?[new Sn(u,o,`boolean expected, ${f} found`)]:[]},number:Ed,color:function(l){const o=l.key,u=l.value,f=Oi(u);return f!=="string"?[new Sn(o,u,`color expected, ${f} found`)]:bn(u)===null?[new Sn(o,u,`color expected, "${u}" found`)]:[]},enum:um,filter:Td,function:Nf,layer:yg,object:nu,source:Kc,light:he,terrain:Gh,fog:Tp,string:Sd,formatted:function(l){return Sd(l).length===0?[]:wd(l)},resolvedImage:function(l){return Sd(l).length===0?[]:wd(l)},projection:function(l){const o=l.value,u=l.styleSpec,f=u.projection,m=l.style;let y=[];const b=Oi(o);if(b==="object")for(const T in o)y=y.concat(Li({key:T,value:o[T],valueSpec:f[T],style:m,styleSpec:u}));else b!=="string"&&(y=y.concat([new Sn("projection",o,`object or string expected, ${b} found`)]));return y}};function Li(l){const o=l.value,u=l.valueSpec,f=l.styleSpec;return u.expression&&eu(zs(o))?Nf(l):u.expression&&Of(ic(o))?wd(l):u.type&&Ja[u.type]?Ja[u.type](l):nu(Ol({},l,{valueSpec:u.type?f[u.type]:u}))}function Yv(l){const o=l.value,u=l.key,f=Sd(l);return f.length||(o.indexOf("{fontstack}")===-1&&f.push(new Sn(u,o,'"glyphs" url must include a "{fontstack}" token')),o.indexOf("{range}")===-1&&f.push(new Sn(u,o,'"glyphs" url must include a "{range}" token'))),f}function O_(l,o=wt){return Jc(Li({key:"",value:l,valueSpec:o.$root,styleSpec:o,style:l,objectElementValidators:{glyphs:Yv,"*":()=>[]}}))}const Kv=l=>Jc(D_(l)),jh=l=>Jc(_g(l));function Jc(l){return l.slice().sort((o,u)=>o.line&&u.line?o.line-u.line:0)}function N_(l,o){let u=!1;if(o&&o.length)for(const f of o)l.fire(new Dl(new Error(f.message))),u=!0;return u}var Cd=pc;function pc(l,o,u){var f=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;var m=new Int32Array(this.arrayBuffer);l=m[0],this.d=(o=m[1])+2*(u=m[2]);for(var y=0;y<this.d*this.d;y++){var b=m[3+y],T=m[3+y+1];f.push(b===T?null:m.subarray(b,T))}var A=m[3+f.length+1];this.keys=m.subarray(m[3+f.length],A),this.bboxes=m.subarray(A),this.insert=this._insertReadonly}else{this.d=o+2*u;for(var L=0;L<this.d*this.d;L++)f.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=l,this.padding=u,this.scale=o/l,this.uid=0;var F=u/o*l;this.min=-F,this.max=l+F}pc.prototype.insert=function(l,o,u,f,m){this._forEachCell(o,u,f,m,this._insertCell,this.uid++),this.keys.push(l),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(m)},pc.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},pc.prototype._insertCell=function(l,o,u,f,m,y){this.cells[m].push(y)},pc.prototype.query=function(l,o,u,f,m){var y=this.min,b=this.max;if(l<=y&&o<=y&&b<=u&&b<=f&&!m)return Array.prototype.slice.call(this.keys);var T=[];return this._forEachCell(l,o,u,f,this._queryCell,T,{},m),T},pc.prototype._queryCell=function(l,o,u,f,m,y,b,T){var A=this.cells[m];if(A!==null)for(var L=this.keys,F=this.bboxes,U=0;U<A.length;U++){var j=A[U];if(b[j]===void 0){var Y=4*j;(T?T(F[Y+0],F[Y+1],F[Y+2],F[Y+3]):l<=F[Y+2]&&o<=F[Y+3]&&u>=F[Y+0]&&f>=F[Y+1])?(b[j]=!0,y.push(L[j])):b[j]=!1}}},pc.prototype._forEachCell=function(l,o,u,f,m,y,b,T){for(var A=this._convertToCellCoord(l),L=this._convertToCellCoord(o),F=this._convertToCellCoord(u),U=this._convertToCellCoord(f),j=A;j<=F;j++)for(var Y=L;Y<=U;Y++){var J=this.d*Y+j;if((!T||T(this._convertFromCellCoord(j),this._convertFromCellCoord(Y),this._convertFromCellCoord(j+1),this._convertFromCellCoord(Y+1)))&&m.call(this,l,o,u,f,J,y,b,T))return}},pc.prototype._convertFromCellCoord=function(l){return(l-this.padding)/this.scale},pc.prototype._convertToCellCoord=function(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))},pc.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var l=this.cells,o=3+this.cells.length+1+1,u=0,f=0;f<this.cells.length;f++)u+=this.cells[f].length;var m=new Int32Array(o+u+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;for(var y=o,b=0;b<l.length;b++){var T=l[b];m[3+b]=y,m.set(T,y),y+=T.length}return m[3+l.length]=y,m.set(this.keys,y),m[3+l.length+1]=y+=this.keys.length,m.set(this.bboxes,y),y+=this.bboxes.length,m.buffer};const fm={};function Cn(l,o,u={}){Object.defineProperty(l,"_classRegistryKey",{value:o,writeable:!1}),fm[o]={klass:l,omit:u.omit||[]}}Cn(Object,"Object"),Cd.serialize=function(l,o){const u=l.toArrayBuffer();return o&&o.push(u),{buffer:u}},Cd.deserialize=function(l){return new Cd(l.buffer)},Object.defineProperty(Cd,"name",{value:"Grid"}),Cn(Cd,"Grid"),Cn(Ai,"Color"),Cn(Error,"Error"),Cn(mn,"AJAXError"),Cn(ua,"ResolvedImage"),Cn(Uh,"StylePropertyFunction"),Cn(fc,"StyleExpression",{omit:["_evaluator"]}),Cn(Ou,"ZoomDependentExpression"),Cn(vp,"ZoomConstantExpression"),Cn(kl,"CompoundExpression",{omit:["_evaluate"]});for(const l in Za)fm[Za[l]._classRegistryKey]||Cn(Za[l],`Expression${l}`);function k_(l){return l&&typeof ArrayBuffer<"u"&&(l instanceof ArrayBuffer||l.constructor&&l.constructor.name==="ArrayBuffer")}function Sp(l){return p.ImageBitmap&&l instanceof p.ImageBitmap}function Cp(l,o){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp)return l;if(k_(l)||Sp(l))return o&&o.push(l),l;if(ArrayBuffer.isView(l)){const u=l;return o&&o.push(u.buffer),u}if(l instanceof p.ImageData)return o&&o.push(l.data.buffer),l;if(Array.isArray(l)){const u=[];for(const f of l)u.push(Cp(f,o));return u}if(typeof l=="object"){const u=l.constructor,f=u._classRegistryKey;if(!f)throw new Error(`can't serialize object of unregistered class ${f}`);const m=u.serialize?u.serialize(l,o):{};if(!u.serialize){for(const y in l)l.hasOwnProperty(y)&&(fm[f].omit.indexOf(y)>=0||(m[y]=Cp(l[y],o)));l instanceof Error&&(m.message=l.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return f!=="Object"&&(m.$name=f),m}throw new Error("can't serialize object of type "+typeof l)}function Ap(l){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||k_(l)||Sp(l)||ArrayBuffer.isView(l)||l instanceof p.ImageData)return l;if(Array.isArray(l))return l.map(Ap);if(typeof l=="object"){const o=l.$name||"Object",{klass:u}=fm[o];if(!u)throw new Error(`can't deserialize unregistered class ${o}`);if(u.deserialize)return u.deserialize(l);const f=Object.create(u.prototype);for(const m of Object.keys(l))m!=="$name"&&(f[m]=Ap(l[m]));return f}throw new Error("can't deserialize object of type "+typeof l)}const Mp=l=>l>=1536&&l<=1791,mc=l=>l>=1872&&l<=1919,xg=l=>l>=2208&&l<=2303,F_=l=>l>=11904&&l<=12031,bg=l=>l>=12032&&l<=12255,Eg=l=>l>=12272&&l<=12287,Lp=l=>l>=12288&&l<=12351,gc=l=>l>=12352&&l<=12447,Ad=l=>l>=12448&&l<=12543,dm=l=>l>=12544&&l<=12591,iu=l=>l>=12704&&l<=12735,B_=l=>l>=12736&&l<=12783,wg=l=>l>=12784&&l<=12799,z_=l=>l>=12800&&l<=13055,U_=l=>l>=13056&&l<=13311,V_=l=>l>=13312&&l<=19903,pm=l=>l>=19968&&l<=40959,Ig=l=>l>=40960&&l<=42127,G_=l=>l>=42128&&l<=42191,j_=l=>l>=44032&&l<=55215,mm=l=>l>=63744&&l<=64255,qh=l=>l>=64336&&l<=65023,Hh=l=>l>=65040&&l<=65055,_=l=>l>=65072&&l<=65103,c=l=>l>=65104&&l<=65135,d=l=>l>=65136&&l<=65279,v=l=>l>=65280&&l<=65519;function w(l){for(const o of l)if(N(o.charCodeAt(0)))return!0;return!1}function S(l){for(const o of l)if(!P(o.charCodeAt(0)))return!1;return!0}function P(l){return!(Mp(l)||mc(l)||xg(l)||qh(l)||d(l))}function N(l){return!(l!==746&&l!==747&&(l<4352||!(iu(l)||dm(l)||_(l)&&!(l>=65097&&l<=65103)||mm(l)||U_(l)||F_(l)||B_(l)||!(!Lp(l)||l>=12296&&l<=12305||l>=12308&&l<=12319||l===12336)||V_(l)||pm(l)||z_(l)||(o=>o>=12592&&o<=12687)(l)||(o=>o>=43360&&o<=43391)(l)||(o=>o>=55216&&o<=55295)(l)||(o=>o>=4352&&o<=4607)(l)||j_(l)||gc(l)||Eg(l)||(o=>o>=12688&&o<=12703)(l)||bg(l)||wg(l)||Ad(l)&&l!==12540||!(!v(l)||l===65288||l===65289||l===65293||l>=65306&&l<=65310||l===65339||l===65341||l===65343||l>=65371&&l<=65503||l===65507||l>=65512&&l<=65519)||!(!c(l)||l>=65112&&l<=65118||l>=65123&&l<=65126)||(o=>o>=5120&&o<=5759)(l)||(o=>o>=6320&&o<=6399)(l)||Hh(l)||(o=>o>=19904&&o<=19967)(l)||Ig(l)||G_(l))))}function B(l){return!(N(l)||function(o){return!!((u=>u>=128&&u<=255)(o)&&(o===167||o===169||o===174||o===177||o===188||o===189||o===190||o===215||o===247)||(u=>u>=8192&&u<=8303)(o)&&(o===8214||o===8224||o===8225||o===8240||o===8241||o===8251||o===8252||o===8258||o===8263||o===8264||o===8265||o===8273)||(u=>u>=8448&&u<=8527)(o)||(u=>u>=8528&&u<=8591)(o)||(u=>u>=8960&&u<=9215)(o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||o===9003||o>=9085&&o<=9114||o>=9150&&o<=9165||o===9167||o>=9169&&o<=9179||o>=9186&&o<=9215)||(u=>u>=9216&&u<=9279)(o)&&o!==9251||(u=>u>=9280&&u<=9311)(o)||(u=>u>=9312&&u<=9471)(o)||(u=>u>=9632&&u<=9727)(o)||(u=>u>=9728&&u<=9983)(o)&&!(o>=9754&&o<=9759)||(u=>u>=11008&&u<=11263)(o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||Lp(o)||Ad(o)||(u=>u>=57344&&u<=63743)(o)||_(o)||c(o)||v(o)||o===8734||o===8756||o===8757||o>=9984&&o<=10087||o>=10102&&o<=10131||o===65532||o===65533)}(l))}function H(l){return l>=1424&&l<=2303||qh(l)||d(l)}function W(l,o){return!(!o&&H(l)||l>=2304&&l<=3583||l>=3840&&l<=4255||(u=>u>=6016&&u<=6143)(l))}function $(l){for(const o of l)if(H(o.charCodeAt(0)))return!0;return!1}const ae="deferred",pe="loading",de="loaded";let me=null,_e="unavailable",re=null;const Ie=function(l){l&&typeof l=="string"&&l.indexOf("NetworkError")>-1&&(_e="error"),me&&me(l)};function Ee(){Se.fire(new nr("pluginStateChange",{pluginStatus:_e,pluginURL:re}))}const Se=new la,ze=function(){return _e},De=function(){if(_e!==ae||!re)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");_e=pe,Ee(),re&&Ds({url:re},l=>{l?Ie(l):(_e=de,Ee())})},qe={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>_e===de||qe.applyArabicShaping!=null,isLoading:()=>_e===pe,setState(l){_e=l.pluginStatus,re=l.pluginURL},isParsed:()=>qe.applyArabicShaping!=null&&qe.processBidirectionalText!=null&&qe.processStyledBidirectionalText!=null,getPluginURL:()=>re};class lt{constructor(o,u){this.zoom=o,u?(this.now=u.now,this.fadeDuration=u.fadeDuration,this.transition=u.transition,this.pitch=u.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(o){return function(u,f){for(const m of u)if(!W(m.charCodeAt(0),f))return!1;return!0}(o,qe.isLoaded())}}class ut{constructor(o,u){this.property=o,this.value=u,this.expression=function(f,m){if(eu(f))return new Uh(f,m);if(Of(f)){const y=Gl(f,m);if(y.result==="error")throw new Error(y.value.map(b=>`${b.key}: ${b.message}`).join(", "));return y.value}{let y=f;return typeof f=="string"&&m.type==="color"&&(y=Ai.parse(f)),{kind:"constant",evaluate:()=>y}}}(u===void 0?o.specification.default:u,o.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(o,u,f){return this.property.possiblyEvaluate(this,o,u,f)}}class gt{constructor(o){this.property=o,this.value=new ut(o,void 0)}transitioned(o,u){return new ft(this.property,this.value,u,At({},o.transition,this.transition),o.now)}untransitioned(){return new ft(this.property,this.value,null,{},0)}}class nn{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues)}getValue(o){return Ut(this._values[o].value.value)}setValue(o,u){this._values.hasOwnProperty(o)||(this._values[o]=new gt(this._values[o].property)),this._values[o].value=new ut(this._values[o].property,u===null?void 0:Ut(u))}getTransition(o){return Ut(this._values[o].transition)}setTransition(o,u){this._values.hasOwnProperty(o)||(this._values[o]=new gt(this._values[o].property)),this._values[o].transition=Ut(u)||void 0}serialize(){const o={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(o[u]=f);const m=this.getTransition(u);m!==void 0&&(o[`${u}-transition`]=m)}return o}transitioned(o,u){const f=new Ft(this._properties);for(const m of Object.keys(this._values))f._values[m]=this._values[m].transitioned(o,u._values[m]);return f}untransitioned(){const o=new Ft(this._properties);for(const u of Object.keys(this._values))o._values[u]=this._values[u].untransitioned();return o}}class ft{constructor(o,u,f,m,y){const b=m.delay||0,T=m.duration||0;y=y||0,this.property=o,this.value=u,this.begin=y+b,this.end=this.begin+T,o.specification.transition&&(m.delay||m.duration)&&(this.prior=f)}possiblyEvaluate(o,u,f){const m=o.now||0,y=this.value.possiblyEvaluate(o,u,f),b=this.prior;if(b){if(m>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(m<this.begin)return b.possiblyEvaluate(o,u,f);{const T=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(o,u,f),y,dt(T))}}return y}}class Ft{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)}possiblyEvaluate(o,u,f){const m=new pt(this._properties);for(const y of Object.keys(this._values))m._values[y]=this._values[y].possiblyEvaluate(o,u,f);return m}hasTransition(){for(const o of Object.keys(this._values))if(this._values[o].prior)return!0;return!1}}class xt{constructor(o){this._properties=o,this._values=Object.create(o.defaultPropertyValues)}getValue(o){return Ut(this._values[o].value)}setValue(o,u){this._values[o]=new ut(this._values[o].property,u===null?void 0:Ut(u))}serialize(){const o={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(o[u]=f)}return o}possiblyEvaluate(o,u,f){const m=new pt(this._properties);for(const y of Object.keys(this._values))m._values[y]=this._values[y].possiblyEvaluate(o,u,f);return m}}class Wt{constructor(o,u,f){this.property=o,this.value=u,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(o){return this.value.kind==="constant"?this.value.value:o}evaluate(o,u,f,m){return this.property.evaluate(this.value,this.parameters,o,u,f,m)}}class pt{constructor(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)}get(o){return this._values[o]}}class at{constructor(o){this.specification=o}possiblyEvaluate(o,u){return o.expression.evaluate(u)}interpolate(o,u,f){const m=oc[this.specification.type];return m?m(o,u,f):o}}class yt{constructor(o,u){this.specification=o,this.overrides=u}possiblyEvaluate(o,u,f,m){return new Wt(this,o.expression.kind==="constant"||o.expression.kind==="camera"?{kind:"constant",value:o.expression.evaluate(u,null,{},f,m)}:o.expression,u)}interpolate(o,u,f){if(o.value.kind!=="constant"||u.value.kind!=="constant")return o;if(o.value.value===void 0||u.value.value===void 0)return new Wt(this,{kind:"constant",value:void 0},o.parameters);const m=oc[this.specification.type];return m?new Wt(this,{kind:"constant",value:m(o.value.value,u.value.value,f)},o.parameters):o}evaluate(o,u,f,m,y,b){return o.kind==="constant"?o.value:o.evaluate(u,f,m,y,b)}}class Gt{constructor(o){this.specification=o}possiblyEvaluate(o,u,f,m){return!!o.expression.evaluate(u,null,{},f,m)}interpolate(){return!1}}class Ht{constructor(o){this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const u=new lt(0,{});for(const f in o){const m=o[f];m.specification.overridable&&this.overridableProperties.push(f);const y=this.defaultPropertyValues[f]=new ut(m,void 0),b=this.defaultTransitionablePropertyValues[f]=new gt(m);this.defaultTransitioningPropertyValues[f]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[f]=y.possiblyEvaluate(u)}}}function Qn(l,o){return 256*(l=nt(Math.floor(l),0,255))+nt(Math.floor(o),0,255)}Cn(yt,"DataDrivenProperty"),Cn(at,"DataConstantProperty"),Cn(Gt,"ColorRampProperty");const ji={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Bn{constructor(o,u){this._structArray=o,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class An{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(o,u){return o._trim(),u&&(o.isTransferred=!0,u.push(o.arrayBuffer)),{length:o.length,arrayBuffer:o.arrayBuffer}}static deserialize(o){const u=Object.create(this.prototype);return u.arrayBuffer=o.arrayBuffer,u.length=o.length,u.capacity=o.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(o){this.reserve(o),this.length=o}reserve(o){if(o>this.capacity){this.capacity=Math.max(o,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function ni(l,o=1){let u=0,f=0;return{members:l.map(m=>{const y=ji[m.type].BYTES_PER_ELEMENT,b=u=ir(u,Math.max(o,y)),T=m.components||1;return f=Math.max(f,y),u+=y*T,{name:m.name,type:m.type,components:T,offset:b}}),size:ir(u,Math.max(f,o)),alignment:o}}function ir(l,o){return Math.ceil(l/o)*o}class oi extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u){const f=this.length;return this.resize(f+1),this.emplace(f,o,u)}emplace(o,u,f){const m=2*o;return this.int16[m+0]=u,this.int16[m+1]=f,o}}oi.prototype.bytesPerElement=4,Cn(oi,"StructArrayLayout2i4");class Nr extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,f){const m=this.length;return this.resize(m+1),this.emplace(m,o,u,f)}emplace(o,u,f,m){const y=3*o;return this.int16[y+0]=u,this.int16[y+1]=f,this.int16[y+2]=m,o}}Nr.prototype.bytesPerElement=6,Cn(Nr,"StructArrayLayout3i6");class qr extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,f,m){const y=this.length;return this.resize(y+1),this.emplace(y,o,u,f,m)}emplace(o,u,f,m,y){const b=4*o;return this.int16[b+0]=u,this.int16[b+1]=f,this.int16[b+2]=m,this.int16[b+3]=y,o}}qr.prototype.bytesPerElement=8,Cn(qr,"StructArrayLayout4i8");class cs extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f,m,y,b,T){const A=this.length;return this.resize(A+1),this.emplace(A,o,u,f,m,y,b,T)}emplace(o,u,f,m,y,b,T,A){const L=6*o,F=12*o,U=3*o;return this.int16[L+0]=u,this.int16[L+1]=f,this.uint8[F+4]=m,this.uint8[F+5]=y,this.uint8[F+6]=b,this.uint8[F+7]=T,this.float32[U+2]=A,o}}cs.prototype.bytesPerElement=12,Cn(cs,"StructArrayLayout2i4ub1f12");class Jr extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f,m){const y=this.length;return this.resize(y+1),this.emplace(y,o,u,f,m)}emplace(o,u,f,m,y){const b=4*o;return this.float32[b+0]=u,this.float32[b+1]=f,this.float32[b+2]=m,this.float32[b+3]=y,o}}Jr.prototype.bytesPerElement=16,Cn(Jr,"StructArrayLayout4f16");class uo extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f,m,y){const b=this.length;return this.resize(b+1),this.emplace(b,o,u,f,m,y)}emplace(o,u,f,m,y,b){const T=6*o,A=3*o;return this.uint16[T+0]=u,this.uint16[T+1]=f,this.uint16[T+2]=m,this.uint16[T+3]=y,this.float32[A+2]=b,o}}uo.prototype.bytesPerElement=12,Cn(uo,"StructArrayLayout4ui1f12");class Qa extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u,f,m){const y=this.length;return this.resize(y+1),this.emplace(y,o,u,f,m)}emplace(o,u,f,m,y){const b=4*o;return this.uint16[b+0]=u,this.uint16[b+1]=f,this.uint16[b+2]=m,this.uint16[b+3]=y,o}}Qa.prototype.bytesPerElement=8,Cn(Qa,"StructArrayLayout4ui8");class ru extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,f,m,y,b){const T=this.length;return this.resize(T+1),this.emplace(T,o,u,f,m,y,b)}emplace(o,u,f,m,y,b,T){const A=6*o;return this.int16[A+0]=u,this.int16[A+1]=f,this.int16[A+2]=m,this.int16[A+3]=y,this.int16[A+4]=b,this.int16[A+5]=T,o}}ru.prototype.bytesPerElement=12,Cn(ru,"StructArrayLayout6i12");class su extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u,f,m,y,b,T,A,L,F,U,j){const Y=this.length;return this.resize(Y+1),this.emplace(Y,o,u,f,m,y,b,T,A,L,F,U,j)}emplace(o,u,f,m,y,b,T,A,L,F,U,j,Y){const J=12*o;return this.int16[J+0]=u,this.int16[J+1]=f,this.int16[J+2]=m,this.int16[J+3]=y,this.uint16[J+4]=b,this.uint16[J+5]=T,this.uint16[J+6]=A,this.uint16[J+7]=L,this.int16[J+8]=F,this.int16[J+9]=U,this.int16[J+10]=j,this.int16[J+11]=Y,o}}su.prototype.bytesPerElement=24,Cn(su,"StructArrayLayout4i4ui4i24");class bs extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f,m,y,b){const T=this.length;return this.resize(T+1),this.emplace(T,o,u,f,m,y,b)}emplace(o,u,f,m,y,b,T){const A=10*o,L=5*o;return this.int16[A+0]=u,this.int16[A+1]=f,this.int16[A+2]=m,this.float32[L+2]=y,this.float32[L+3]=b,this.float32[L+4]=T,o}}bs.prototype.bytesPerElement=20,Cn(bs,"StructArrayLayout3i3f20");class ts extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o){const u=this.length;return this.resize(u+1),this.emplace(u,o)}emplace(o,u){return this.uint32[1*o+0]=u,o}}ts.prototype.bytesPerElement=4,Cn(ts,"StructArrayLayout1ul4");class wr extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u,f,m,y,b,T,A,L,F,U,j,Y){const J=this.length;return this.resize(J+1),this.emplace(J,o,u,f,m,y,b,T,A,L,F,U,j,Y)}emplace(o,u,f,m,y,b,T,A,L,F,U,j,Y,J){const ee=20*o,ce=10*o;return this.int16[ee+0]=u,this.int16[ee+1]=f,this.int16[ee+2]=m,this.int16[ee+3]=y,this.int16[ee+4]=b,this.float32[ce+3]=T,this.float32[ce+4]=A,this.float32[ce+5]=L,this.float32[ce+6]=F,this.int16[ee+14]=U,this.uint32[ce+8]=j,this.uint16[ee+18]=Y,this.uint16[ee+19]=J,o}}wr.prototype.bytesPerElement=40,Cn(wr,"StructArrayLayout5i4f1i1ul2ui40");class Js extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,f,m,y,b,T){const A=this.length;return this.resize(A+1),this.emplace(A,o,u,f,m,y,b,T)}emplace(o,u,f,m,y,b,T,A){const L=8*o;return this.int16[L+0]=u,this.int16[L+1]=f,this.int16[L+2]=m,this.int16[L+4]=y,this.int16[L+5]=b,this.int16[L+6]=T,this.int16[L+7]=A,o}}Js.prototype.bytesPerElement=16,Cn(Js,"StructArrayLayout3i2i2i16");class fa extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,f,m,y){const b=this.length;return this.resize(b+1),this.emplace(b,o,u,f,m,y)}emplace(o,u,f,m,y,b){const T=4*o,A=8*o;return this.float32[T+0]=u,this.float32[T+1]=f,this.float32[T+2]=m,this.int16[A+6]=y,this.int16[A+7]=b,o}}fa.prototype.bytesPerElement=16,Cn(fa,"StructArrayLayout2f1f2i16");class _s extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f,m){const y=this.length;return this.resize(y+1),this.emplace(y,o,u,f,m)}emplace(o,u,f,m,y){const b=12*o,T=3*o;return this.uint8[b+0]=u,this.uint8[b+1]=f,this.float32[T+1]=m,this.float32[T+2]=y,o}}_s.prototype.bytesPerElement=12,Cn(_s,"StructArrayLayout2ub2f12");class na extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f){const m=this.length;return this.resize(m+1),this.emplace(m,o,u,f)}emplace(o,u,f,m){const y=3*o;return this.float32[y+0]=u,this.float32[y+1]=f,this.float32[y+2]=m,o}}na.prototype.bytesPerElement=12,Cn(na,"StructArrayLayout3f12");class da extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u,f){const m=this.length;return this.resize(m+1),this.emplace(m,o,u,f)}emplace(o,u,f,m){const y=3*o;return this.uint16[y+0]=u,this.uint16[y+1]=f,this.uint16[y+2]=m,o}}da.prototype.bytesPerElement=6,Cn(da,"StructArrayLayout3ui6");class _c extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,u,f,m,y,b,T,A,L,F,U,j,Y,J,ee,ce,we,Pe,be,Me,Ve){const ke=this.length;return this.resize(ke+1),this.emplace(ke,o,u,f,m,y,b,T,A,L,F,U,j,Y,J,ee,ce,we,Pe,be,Me,Ve)}emplace(o,u,f,m,y,b,T,A,L,F,U,j,Y,J,ee,ce,we,Pe,be,Me,Ve,ke){const _t=30*o,mt=15*o,Pt=60*o;return this.int16[_t+0]=u,this.int16[_t+1]=f,this.int16[_t+2]=m,this.float32[mt+2]=y,this.float32[mt+3]=b,this.uint16[_t+8]=T,this.uint16[_t+9]=A,this.uint32[mt+5]=L,this.uint32[mt+6]=F,this.uint32[mt+7]=U,this.uint16[_t+16]=j,this.uint16[_t+17]=Y,this.uint16[_t+18]=J,this.float32[mt+10]=ee,this.float32[mt+11]=ce,this.uint8[Pt+48]=we,this.uint8[Pt+49]=Pe,this.uint8[Pt+50]=be,this.uint32[mt+13]=Me,this.int16[_t+28]=Ve,this.uint8[Pt+58]=ke,o}}_c.prototype.bytesPerElement=60,Cn(_c,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Md extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,u,f,m,y,b,T,A,L,F,U,j,Y,J,ee,ce,we,Pe,be,Me,Ve,ke,_t,mt,Pt,Jt,bt,Bt,Vt,Zt){const $t=this.length;return this.resize($t+1),this.emplace($t,o,u,f,m,y,b,T,A,L,F,U,j,Y,J,ee,ce,we,Pe,be,Me,Ve,ke,_t,mt,Pt,Jt,bt,Bt,Vt,Zt)}emplace(o,u,f,m,y,b,T,A,L,F,U,j,Y,J,ee,ce,we,Pe,be,Me,Ve,ke,_t,mt,Pt,Jt,bt,Bt,Vt,Zt,$t){const Et=38*o,yn=19*o;return this.int16[Et+0]=u,this.int16[Et+1]=f,this.int16[Et+2]=m,this.float32[yn+2]=y,this.float32[yn+3]=b,this.int16[Et+8]=T,this.int16[Et+9]=A,this.int16[Et+10]=L,this.int16[Et+11]=F,this.int16[Et+12]=U,this.int16[Et+13]=j,this.uint16[Et+14]=Y,this.uint16[Et+15]=J,this.uint16[Et+16]=ee,this.uint16[Et+17]=ce,this.uint16[Et+18]=we,this.uint16[Et+19]=Pe,this.uint16[Et+20]=be,this.uint16[Et+21]=Me,this.uint16[Et+22]=Ve,this.uint16[Et+23]=ke,this.uint16[Et+24]=_t,this.uint16[Et+25]=mt,this.uint16[Et+26]=Pt,this.uint16[Et+27]=Jt,this.uint16[Et+28]=bt,this.uint32[yn+15]=Bt,this.float32[yn+16]=Vt,this.float32[yn+17]=Zt,this.float32[yn+18]=$t,o}}Md.prototype.bytesPerElement=76,Cn(Md,"StructArrayLayout3i2f6i15ui1ul3f76");class $a extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o){const u=this.length;return this.resize(u+1),this.emplace(u,o)}emplace(o,u){return this.float32[1*o+0]=u,o}}$a.prototype.bytesPerElement=4,Cn($a,"StructArrayLayout1f4");class Pi extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f,m,y){const b=this.length;return this.resize(b+1),this.emplace(b,o,u,f,m,y)}emplace(o,u,f,m,y,b){const T=5*o;return this.float32[T+0]=u,this.float32[T+1]=f,this.float32[T+2]=m,this.float32[T+3]=y,this.float32[T+4]=b,o}}Pi.prototype.bytesPerElement=20,Cn(Pi,"StructArrayLayout5f20");class Qc extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u,f,m){const y=this.length;return this.resize(y+1),this.emplace(y,o,u,f,m)}emplace(o,u,f,m,y){const b=6*o;return this.uint32[3*o+0]=u,this.uint16[b+2]=f,this.uint16[b+3]=m,this.uint16[b+4]=y,o}}Qc.prototype.bytesPerElement=12,Cn(Qc,"StructArrayLayout1ul3ui12");class Wh extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u){const f=this.length;return this.resize(f+1),this.emplace(f,o,u)}emplace(o,u,f){const m=2*o;return this.uint16[m+0]=u,this.uint16[m+1]=f,o}}Wh.prototype.bytesPerElement=4,Cn(Wh,"StructArrayLayout2ui4");class ou extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o){const u=this.length;return this.resize(u+1),this.emplace(u,o)}emplace(o,u){return this.uint16[1*o+0]=u,o}}ou.prototype.bytesPerElement=2,Cn(ou,"StructArrayLayout1ui2");class Bf extends An{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u){const f=this.length;return this.resize(f+1),this.emplace(f,o,u)}emplace(o,u,f){const m=2*o;return this.float32[m+0]=u,this.float32[m+1]=f,o}}Bf.prototype.bytesPerElement=8,Cn(Bf,"StructArrayLayout2f8");class nx extends Bn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}nx.prototype.size=40;class Jv extends wr{get(o){return new nx(this,o)}}Cn(Jv,"CollisionBoxArray");class Nu extends Bn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(o){this._structArray.uint8[this._pos1+49]=o}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(o){this._structArray.uint8[this._pos1+50]=o}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(o){this._structArray.uint32[this._pos4+13]=o}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(o){this._structArray.uint8[this._pos1+58]=o}}Nu.prototype.size=60;class ix extends _c{get(o){return new Nu(this,o)}}Cn(ix,"PlacedSymbolArray");class Tg extends Bn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(o){this._structArray.uint32[this._pos4+15]=o}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Tg.prototype.size=76;class q_ extends Md{get(o){return new Tg(this,o)}}Cn(q_,"SymbolInstanceArray");class Qv extends $a{getoffsetX(o){return this.float32[1*o+0]}}Cn(Qv,"GlyphOffsetArray");class $v extends oi{getx(o){return this.int16[2*o+0]}gety(o){return this.int16[2*o+1]}}Cn($v,"SymbolLineVertexArray");class au extends Bn{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}au.prototype.size=12;class zf extends Qc{get(o){return new au(this,o)}}Cn(zf,"FeatureIndexArray");class H_ extends Wh{geta_centroid_pos0(o){return this.uint16[2*o+0]}geta_centroid_pos1(o){return this.uint16[2*o+1]}}Cn(H_,"FillExtrusionCentroidArray");const rx=ni([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),W_=ni([{name:"a_dash",components:4,type:"Uint16"}]);var Ld={},e0={get exports(){return Ld},set exports(l){Ld=l}},X_={};({get exports(){return X_},set exports(l){X_=l}}).exports=function(l,o){var u,f,m,y,b,T,A,L;for(f=l.length-(u=3&l.length),m=o,b=3432918353,T=461845907,L=0;L<f;)A=255&l.charCodeAt(L)|(255&l.charCodeAt(++L))<<8|(255&l.charCodeAt(++L))<<16|(255&l.charCodeAt(++L))<<24,++L,m=27492+(65535&(y=5*(65535&(m=(m^=A=(65535&(A=(A=(65535&A)*b+(((A>>>16)*b&65535)<<16)&4294967295)<<15|A>>>17))*T+(((A>>>16)*T&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(A=0,u){case 3:A^=(255&l.charCodeAt(L+2))<<16;case 2:A^=(255&l.charCodeAt(L+1))<<8;case 1:m^=A=(65535&(A=(A=(65535&(A^=255&l.charCodeAt(L)))*b+(((A>>>16)*b&65535)<<16)&4294967295)<<15|A>>>17))*T+(((A>>>16)*T&65535)<<16)&4294967295}return m^=l.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0};var Sg={};({get exports(){return Sg},set exports(l){Sg=l}}).exports=function(l,o){for(var u,f=l.length,m=o^f,y=0;f>=4;)u=1540483477*(65535&(u=255&l.charCodeAt(y)|(255&l.charCodeAt(++y))<<8|(255&l.charCodeAt(++y))<<16|(255&l.charCodeAt(++y))<<24))+((1540483477*(u>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),f-=4,++y;switch(f){case 3:m^=(255&l.charCodeAt(y+2))<<16;case 2:m^=(255&l.charCodeAt(y+1))<<8;case 1:m=1540483477*(65535&(m^=255&l.charCodeAt(y)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0};var Z_=X_,Pd=Sg;e0.exports=Z_,Ld.murmur3=Z_,Ld.murmur2=Pd;class Y_{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(o,u,f,m){this.ids.push(Uf(o)),this.positions.push(u,f,m)}getPositions(o){const u=Uf(o);let f=0,m=this.ids.length-1;for(;f<m;){const b=f+m>>1;this.ids[b]>=u?m=b:f=b+1}const y=[];for(;this.ids[f]===u;)y.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return y}static serialize(o,u){const f=new Float64Array(o.ids),m=new Uint32Array(o.positions);return K_(f,m,0,f.length-1),u&&u.push(f.buffer,m.buffer),{ids:f,positions:m}}static deserialize(o){const u=new Y_;return u.ids=o.ids,u.positions=o.positions,u.indexed=!0,u}}function Uf(l){const o=+l;return!isNaN(o)&&Number.MIN_SAFE_INTEGER<=o&&o<=Number.MAX_SAFE_INTEGER?o:Ld(String(l))}function K_(l,o,u,f){for(;u<f;){const m=l[u+f>>1];let y=u-1,b=f+1;for(;;){do y++;while(l[y]<m);do b--;while(l[b]>m);if(y>=b)break;Cg(l,y,b),Cg(o,3*y,3*b),Cg(o,3*y+1,3*b+1),Cg(o,3*y+2,3*b+2)}b-u<f-b?(K_(l,o,u,b),u=b+1):(K_(l,o,b+1,f),f=b)}}function Cg(l,o,u){const f=l[o];l[o]=l[u],l[u]=f}Cn(Y_,"FeaturePositionMap");class $c{constructor(o){this.gl=o.gl,this.initialized=!1}fetchUniformLocation(o,u){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(o,u),this.initialized=!0),!!this.location}}class J_ extends $c{constructor(o){super(o),this.current=0}set(o,u,f){this.fetchUniformLocation(o,u)&&this.current!==f&&(this.current=f,this.gl.uniform1f(this.location,f))}}class sx extends $c{constructor(o){super(o),this.current=[0,0,0,0]}set(o,u,f){this.fetchUniformLocation(o,u)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]&&f[3]===this.current[3]||(this.current=f,this.gl.uniform4f(this.location,f[0],f[1],f[2],f[3])))}}class ox extends $c{constructor(o){super(o),this.current=Ai.transparent}set(o,u,f){this.fetchUniformLocation(o,u)&&(f.r===this.current.r&&f.g===this.current.g&&f.b===this.current.b&&f.a===this.current.a||(this.current=f,this.gl.uniform4f(this.location,f.r,f.g,f.b,f.a)))}}const ax=new Float32Array(16),lx=new Float32Array(9),lw=new Float32Array(4);function Q_(l){return[Qn(255*l.r,255*l.g),Qn(255*l.b,255*l.a)]}class gm{constructor(o,u,f){this.value=o,this.uniformNames=u.map(m=>`u_${m}`),this.type=f}setUniform(o,u,f,m,y){u.set(o,y,m.constantOr(this.value))}getBinding(o,u){return this.type==="color"?new ox(o):new J_(o)}}class pa{constructor(o,u){this.uniformNames=u.map(f=>`u_${f}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(o){this.pixelRatio=o.pixelRatio||1,this.pattern=o.tl.concat(o.br)}setUniform(o,u,f,m,y){const b=y==="u_pattern"||y==="u_dash"?this.pattern:y==="u_pixel_ratio"?this.pixelRatio:null;b&&u.set(o,y,b)}getBinding(o,u){return u==="u_pattern"||u==="u_dash"?new sx(o):new J_(o)}}class Pa{constructor(o,u,f,m){this.expression=o,this.type=f,this.maxValue=0,this.paintVertexAttributes=u.map(y=>({name:`a_${y}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(o,u,f,m,y,b){const T=this.paintVertexArray.length,A=this.expression.evaluate(new lt(0),u,{},y,m,b);this.paintVertexArray.resize(o),this._setPaintValue(T,o,A)}updatePaintArray(o,u,f,m,y){const b=this.expression.evaluate({zoom:0},f,m,void 0,y);this._setPaintValue(o,u,b)}_setPaintValue(o,u,f){if(this.type==="color"){const m=Q_(f);for(let y=o;y<u;y++)this.paintVertexArray.emplace(y,m[0],m[1])}else{for(let m=o;m<u;m++)this.paintVertexArray.emplace(m,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class eh{constructor(o,u,f,m,y,b){this.expression=o,this.uniformNames=u.map(T=>`u_${T}_t`),this.type=f,this.useIntegerZoom=m,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=u.map(T=>({name:`a_${T}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new b}populatePaintArray(o,u,f,m,y,b){const T=this.expression.evaluate(new lt(this.zoom),u,{},y,m,b),A=this.expression.evaluate(new lt(this.zoom+1),u,{},y,m,b),L=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValue(L,o,T,A)}updatePaintArray(o,u,f,m,y){const b=this.expression.evaluate({zoom:this.zoom},f,m,void 0,y),T=this.expression.evaluate({zoom:this.zoom+1},f,m,void 0,y);this._setPaintValue(o,u,b,T)}_setPaintValue(o,u,f,m){if(this.type==="color"){const y=Q_(f),b=Q_(m);for(let T=o;T<u;T++)this.paintVertexArray.emplace(T,y[0],y[1],b[0],b[1])}else{for(let y=o;y<u;y++)this.paintVertexArray.emplace(y,f,m);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(m))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(o,u,f,m,y){const b=this.useIntegerZoom?Math.floor(f.zoom):f.zoom,T=nt(this.expression.interpolationFactor(b,this.zoom,this.zoom+1),0,1);u.set(o,y,T)}getBinding(o,u){return new J_(o)}}class Rd{constructor(o,u,f,m,y){this.expression=o,this.layerId=y,this.paintVertexAttributes=(f==="array"?W_:rx).members;for(let b=0;b<u.length;++b);this.paintVertexArray=new m}populatePaintArray(o,u,f){const m=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValues(m,o,u.patterns&&u.patterns[this.layerId],f)}updatePaintArray(o,u,f,m,y,b){this._setPaintValues(o,u,f.patterns&&f.patterns[this.layerId],b)}_setPaintValues(o,u,f,m){if(!m||!f)return;const y=m[f];if(!y)return;const{tl:b,br:T,pixelRatio:A}=y;for(let L=o;L<u;L++)this.paintVertexArray.emplace(L,b[0],b[1],T[0],T[1],A)}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class th{constructor(o,u,f=()=>!0){this.binders={},this._buffers=[];const m=[];for(const y in o.paint._values){if(!f(y))continue;const b=o.paint.get(y);if(!(b instanceof Wt&&er(b.property.specification)))continue;const T=cx(y,o.type),A=b.value,L=b.property.specification.type,F=b.property.useIntegerZoom,U=y==="line-dasharray"||y.endsWith("pattern"),j=y==="line-dasharray"&&o.layout.get("line-cap").value.kind!=="constant";if(A.kind!=="constant"||j)if(A.kind==="source"||j||U){const Y=Pp(y,L,"source");this.binders[y]=U?new Rd(A,T,L,Y,o.id):new Pa(A,T,L,Y),m.push(`/a_${y}`)}else{const Y=Pp(y,L,"composite");this.binders[y]=new eh(A,T,L,F,u,Y),m.push(`/z_${y}`)}else this.binders[y]=U?new pa(A.value,T):new gm(A.value,T,L),m.push(`/u_${y}`)}this.cacheKey=m.sort().join("")}getMaxValue(o){const u=this.binders[o];return u instanceof Pa||u instanceof eh?u.maxValue:0}populatePaintArrays(o,u,f,m,y,b){for(const T in this.binders){const A=this.binders[T];(A instanceof Pa||A instanceof eh||A instanceof Rd)&&A.populatePaintArray(o,u,f,m,y,b)}}setConstantPatternPositions(o){for(const u in this.binders){const f=this.binders[u];f instanceof pa&&f.setConstantPatternPositions(o)}}updatePaintArrays(o,u,f,m,y,b){let T=!1;for(const A in o){const L=u.getPositions(A);for(const F of L){const U=f.feature(F.index);for(const j in this.binders){const Y=this.binders[j];if((Y instanceof Pa||Y instanceof eh||Y instanceof Rd)&&Y.expression.isStateDependent===!0){const J=m.paint.get(j);Y.expression=J.value,Y.updatePaintArray(F.start,F.end,U,o[A],y,b),T=!0}}}}return T}defines(){const o=[];for(const u in this.binders){const f=this.binders[u];(f instanceof gm||f instanceof pa)&&o.push(...f.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return o}getBinderAttributes(){const o=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof Pa||f instanceof eh||f instanceof Rd)for(let m=0;m<f.paintVertexAttributes.length;m++)o.push(f.paintVertexAttributes[m].name)}return o}getBinderUniforms(){const o=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof gm||f instanceof pa||f instanceof eh)for(const m of f.uniformNames)o.push(m)}return o}getPaintVertexBuffers(){return this._buffers}getUniforms(o){const u=[];for(const f in this.binders){const m=this.binders[f];if(m instanceof gm||m instanceof pa||m instanceof eh)for(const y of m.uniformNames)u.push({name:y,property:f,binding:m.getBinding(o,y)})}return u}setUniforms(o,u,f,m,y){for(const{name:b,property:T,binding:A}of f)this.binders[T].setUniform(o,A,y,m.get(T),b)}updatePaintBuffers(){this._buffers=[];for(const o in this.binders){const u=this.binders[o];(u instanceof Pa||u instanceof eh||u instanceof Rd)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(o){for(const u in this.binders){const f=this.binders[u];(f instanceof Pa||f instanceof eh||f instanceof Rd)&&f.upload(o)}this.updatePaintBuffers()}destroy(){for(const o in this.binders){const u=this.binders[o];(u instanceof Pa||u instanceof eh||u instanceof Rd)&&u.destroy()}}}class yc{constructor(o,u,f=()=>!0){this.programConfigurations={};for(const m of o)this.programConfigurations[m.id]=new th(m,u,f);this.needsUpload=!1,this._featureMap=new Y_,this._bufferOffset=0}populatePaintArrays(o,u,f,m,y,b,T){for(const A in this.programConfigurations)this.programConfigurations[A].populatePaintArrays(o,u,m,y,b,T);u.id!==void 0&&this._featureMap.add(u.id,f,this._bufferOffset,o),this._bufferOffset=o,this.needsUpload=!0}updatePaintArrays(o,u,f,m,y){for(const b of f)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(o,this._featureMap,u,b,m,y)||this.needsUpload}get(o){return this.programConfigurations[o]}upload(o){if(this.needsUpload){for(const u in this.programConfigurations)this.programConfigurations[u].upload(o);this.needsUpload=!1}}destroy(){for(const o in this.programConfigurations)this.programConfigurations[o].destroy()}}const ux={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function cx(l,o){return ux[l]||[l.replace(`${o}-`,"").replace(/-/g,"_")]}const uw={"line-pattern":{source:uo,composite:uo},"fill-pattern":{source:uo,composite:uo},"fill-extrusion-pattern":{source:uo,composite:uo},"line-dasharray":{source:Qa,composite:Qa}},hx={color:{source:Bf,composite:Jr},number:{source:$a,composite:Bf}};function Pp(l,o,u){const f=uw[l];return f&&f[u]||hx[o][u]}Cn(gm,"ConstantBinder"),Cn(pa,"PatternConstantBinder"),Cn(Pa,"SourceExpressionBinder"),Cn(Rd,"PatternCompositeBinder"),Cn(eh,"CompositeExpressionBinder"),Cn(th,"ProgramConfiguration",{omit:["_buffers"]}),Cn(yc,"ProgramConfigurationSet");const Dd="-transition";class nh extends la{constructor(o,u){if(super(),this.id=o.id,this.type=o.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,o.type!=="custom"&&(this.metadata=o.metadata,this.minzoom=o.minzoom,this.maxzoom=o.maxzoom,o.type!=="background"&&o.type!=="sky"&&(this.source=o.source,this.sourceLayer=o["source-layer"],this.filter=o.filter),u.layout&&(this._unevaluatedLayout=new xt(u.layout)),u.paint)){this._transitionablePaint=new nn(u.paint);for(const f in o.paint)this.setPaintProperty(f,o.paint[f],{validate:!1});for(const f in o.layout)this.setLayoutProperty(f,o.layout[f],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new pt(u.paint)}}getLayoutProperty(o){return o==="visibility"?this.visibility:this._unevaluatedLayout.getValue(o)}setLayoutProperty(o,u,f={}){u!=null&&this._validate(jh,`layers.${this.id}.layout.${o}`,o,u,f)||(o!=="visibility"?this._unevaluatedLayout.setValue(o,u):this.visibility=u)}getPaintProperty(o){return kn(o,Dd)?this._transitionablePaint.getTransition(o.slice(0,-Dd.length)):this._transitionablePaint.getValue(o)}setPaintProperty(o,u,f={}){if(u!=null&&this._validate(Kv,`layers.${this.id}.paint.${o}`,o,u,f))return!1;if(kn(o,Dd))return this._transitionablePaint.setTransition(o.slice(0,-Dd.length),u||void 0),!1;{const m=this._transitionablePaint._values[o],y=m.value.isDataDriven(),b=m.value;this._transitionablePaint.setValue(o,u),this._handleSpecialPaintPropertyUpdate(o);const T=this._transitionablePaint._values[o].value,A=T.isDataDriven(),L=kn(o,"pattern")||o==="line-dasharray";return A||y||L||this._handleOverridablePaintPropertyUpdate(o,b,T)}}_handleSpecialPaintPropertyUpdate(o){}getProgramIds(){return null}getProgramConfiguration(o){return null}_handleOverridablePaintPropertyUpdate(o,u,f){return!1}isHidden(o){return!!(this.minzoom&&o<this.minzoom)||!!(this.maxzoom&&o>=this.maxzoom)||this.visibility==="none"}updateTransitions(o){this._transitioningPaint=this._transitionablePaint.transitioned(o,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(o,u){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(o,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(o,void 0,u)}serialize(){const o={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(o.layout=o.layout||{},o.layout.visibility=this.visibility),Di(o,(u,f)=>!(u===void 0||f==="layout"&&!Object.keys(u).length||f==="paint"&&!Object.keys(u).length))}_validate(o,u,f,m,y={}){return(!y||y.validate!==!1)&&N_(this,o.call(O_,{key:u,layerType:this.type,objectKey:f,value:m,styleSpec:wt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const o in this.paint._values){const u=this.paint.get(o);if(u instanceof Wt&&er(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=lo(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const fx=ni([{name:"a_pos",components:2,type:"Int16"}],4),dx=ni([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Gs{constructor(o=[]){this.segments=o}prepareSegment(o,u,f,m){let y=this.segments[this.segments.length-1];return o>Gs.MAX_VERTEX_ARRAY_LENGTH&&Gn(`Max vertices per segment is ${Gs.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${o}`),(!y||y.vertexLength+o>Gs.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==m)&&(y={vertexOffset:u.length,primitiveOffset:f.length,vertexLength:0,primitiveLength:0},m!==void 0&&(y.sortKey=m),this.segments.push(y)),y}get(){return this.segments}destroy(){for(const o of this.segments)for(const u in o.vaos)o.vaos[u].destroy()}static simpleSegment(o,u,f,m){return new Gs([{vertexOffset:o,primitiveOffset:u,vertexLength:f,primitiveLength:m,vaos:{},sortKey:0}])}}Gs.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Cn(Gs,"SegmentVector");var gi=8192;class ih{constructor(o,u){o&&(u?this.setSouthWest(o).setNorthEast(u):o.length===4?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1]))}setNorthEast(o){return this._ne=o instanceof Ir?new Ir(o.lng,o.lat):Ir.convert(o),this}setSouthWest(o){return this._sw=o instanceof Ir?new Ir(o.lng,o.lat):Ir.convert(o),this}extend(o){const u=this._sw,f=this._ne;let m,y;if(o instanceof Ir)m=o,y=o;else{if(!(o instanceof ih))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(ih.convert(o)):this.extend(Ir.convert(o)):typeof o=="object"&&o!==null&&o.hasOwnProperty("lat")&&o.hasOwnProperty("lon")?this.extend(Ir.convert(o)):this;if(m=o._sw,y=o._ne,!m||!y)return this}return u||f?(u.lng=Math.min(m.lng,u.lng),u.lat=Math.min(m.lat,u.lat),f.lng=Math.max(y.lng,f.lng),f.lat=Math.max(y.lat,f.lat)):(this._sw=new Ir(m.lng,m.lat),this._ne=new Ir(y.lng,y.lat)),this}getCenter(){return new Ir((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Ir(this.getWest(),this.getNorth())}getSouthEast(){return new Ir(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:u,lat:f}=Ir.convert(o);let m=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&m}static convert(o){return!o||o instanceof ih?o:new ih(o)}}var _m=1e-6,el=typeof Float32Array<"u"?Float32Array:Array;function px(){var l=new el(9);return el!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[5]=0,l[6]=0,l[7]=0),l[0]=1,l[4]=1,l[8]=1,l}function t0(l,o,u){var f=o[0],m=o[1],y=o[2],b=o[3],T=o[4],A=o[5],L=o[6],F=o[7],U=o[8],j=u[0],Y=u[1],J=u[2],ee=u[3],ce=u[4],we=u[5],Pe=u[6],be=u[7],Me=u[8];return l[0]=j*f+Y*b+J*L,l[1]=j*m+Y*T+J*F,l[2]=j*y+Y*A+J*U,l[3]=ee*f+ce*b+we*L,l[4]=ee*m+ce*T+we*F,l[5]=ee*y+ce*A+we*U,l[6]=Pe*f+be*b+Me*L,l[7]=Pe*m+be*T+Me*F,l[8]=Pe*y+be*A+Me*U,l}function lu(l){return l[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function $_(l,o){var u=o[0],f=o[1],m=o[2],y=o[3],b=o[4],T=o[5],A=o[6],L=o[7],F=o[8],U=o[9],j=o[10],Y=o[11],J=o[12],ee=o[13],ce=o[14],we=o[15],Pe=u*T-f*b,be=u*A-m*b,Me=u*L-y*b,Ve=f*A-m*T,ke=f*L-y*T,_t=m*L-y*A,mt=F*ee-U*J,Pt=F*ce-j*J,Jt=F*we-Y*J,bt=U*ce-j*ee,Bt=U*we-Y*ee,Vt=j*we-Y*ce,Zt=Pe*Vt-be*Bt+Me*bt+Ve*Jt-ke*Pt+_t*mt;return Zt?(l[0]=(T*Vt-A*Bt+L*bt)*(Zt=1/Zt),l[1]=(m*Bt-f*Vt-y*bt)*Zt,l[2]=(ee*_t-ce*ke+we*Ve)*Zt,l[3]=(j*ke-U*_t-Y*Ve)*Zt,l[4]=(A*Jt-b*Vt-L*Pt)*Zt,l[5]=(u*Vt-m*Jt+y*Pt)*Zt,l[6]=(ce*Me-J*_t-we*be)*Zt,l[7]=(F*_t-j*Me+Y*be)*Zt,l[8]=(b*Bt-T*Jt+L*mt)*Zt,l[9]=(f*Jt-u*Bt-y*mt)*Zt,l[10]=(J*ke-ee*Me+we*Pe)*Zt,l[11]=(U*Me-F*ke-Y*Pe)*Zt,l[12]=(T*Pt-b*bt-A*mt)*Zt,l[13]=(u*bt-f*Pt+m*mt)*Zt,l[14]=(ee*be-J*Ve-ce*Pe)*Zt,l[15]=(F*Ve-U*be+j*Pe)*Zt,l):null}function Vf(l,o,u){var f=o[0],m=o[1],y=o[2],b=o[3],T=o[4],A=o[5],L=o[6],F=o[7],U=o[8],j=o[9],Y=o[10],J=o[11],ee=o[12],ce=o[13],we=o[14],Pe=o[15],be=u[0],Me=u[1],Ve=u[2],ke=u[3];return l[0]=be*f+Me*T+Ve*U+ke*ee,l[1]=be*m+Me*A+Ve*j+ke*ce,l[2]=be*y+Me*L+Ve*Y+ke*we,l[3]=be*b+Me*F+Ve*J+ke*Pe,l[4]=(be=u[4])*f+(Me=u[5])*T+(Ve=u[6])*U+(ke=u[7])*ee,l[5]=be*m+Me*A+Ve*j+ke*ce,l[6]=be*y+Me*L+Ve*Y+ke*we,l[7]=be*b+Me*F+Ve*J+ke*Pe,l[8]=(be=u[8])*f+(Me=u[9])*T+(Ve=u[10])*U+(ke=u[11])*ee,l[9]=be*m+Me*A+Ve*j+ke*ce,l[10]=be*y+Me*L+Ve*Y+ke*we,l[11]=be*b+Me*F+Ve*J+ke*Pe,l[12]=(be=u[12])*f+(Me=u[13])*T+(Ve=u[14])*U+(ke=u[15])*ee,l[13]=be*m+Me*A+Ve*j+ke*ce,l[14]=be*y+Me*L+Ve*Y+ke*we,l[15]=be*b+Me*F+Ve*J+ke*Pe,l}function Ag(l,o,u){var f,m,y,b,T,A,L,F,U,j,Y,J,ee=u[0],ce=u[1],we=u[2];return o===l?(l[12]=o[0]*ee+o[4]*ce+o[8]*we+o[12],l[13]=o[1]*ee+o[5]*ce+o[9]*we+o[13],l[14]=o[2]*ee+o[6]*ce+o[10]*we+o[14],l[15]=o[3]*ee+o[7]*ce+o[11]*we+o[15]):(m=o[1],y=o[2],b=o[3],T=o[4],A=o[5],L=o[6],F=o[7],U=o[8],j=o[9],Y=o[10],J=o[11],l[0]=f=o[0],l[1]=m,l[2]=y,l[3]=b,l[4]=T,l[5]=A,l[6]=L,l[7]=F,l[8]=U,l[9]=j,l[10]=Y,l[11]=J,l[12]=f*ee+T*ce+U*we+o[12],l[13]=m*ee+A*ce+j*we+o[13],l[14]=y*ee+L*ce+Y*we+o[14],l[15]=b*ee+F*ce+J*we+o[15]),l}function Od(l,o,u){var f=u[0],m=u[1],y=u[2];return l[0]=o[0]*f,l[1]=o[1]*f,l[2]=o[2]*f,l[3]=o[3]*f,l[4]=o[4]*m,l[5]=o[5]*m,l[6]=o[6]*m,l[7]=o[7]*m,l[8]=o[8]*y,l[9]=o[9]*y,l[10]=o[10]*y,l[11]=o[11]*y,l[12]=o[12],l[13]=o[13],l[14]=o[14],l[15]=o[15],l}function rh(l,o,u){var f=Math.sin(u),m=Math.cos(u),y=o[4],b=o[5],T=o[6],A=o[7],L=o[8],F=o[9],U=o[10],j=o[11];return o!==l&&(l[0]=o[0],l[1]=o[1],l[2]=o[2],l[3]=o[3],l[12]=o[12],l[13]=o[13],l[14]=o[14],l[15]=o[15]),l[4]=y*m+L*f,l[5]=b*m+F*f,l[6]=T*m+U*f,l[7]=A*m+j*f,l[8]=L*m-y*f,l[9]=F*m-b*f,l[10]=U*m-T*f,l[11]=j*m-A*f,l}function Mg(l,o,u){var f=Math.sin(u),m=Math.cos(u),y=o[0],b=o[1],T=o[2],A=o[3],L=o[8],F=o[9],U=o[10],j=o[11];return o!==l&&(l[4]=o[4],l[5]=o[5],l[6]=o[6],l[7]=o[7],l[12]=o[12],l[13]=o[13],l[14]=o[14],l[15]=o[15]),l[0]=y*m-L*f,l[1]=b*m-F*f,l[2]=T*m-U*f,l[3]=A*m-j*f,l[8]=y*f+L*m,l[9]=b*f+F*m,l[10]=T*f+U*m,l[11]=A*f+j*m,l}function n0(l,o){return l[0]=o[0],l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=o[1],l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=o[2],l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function mx(l,o,u){var f,m,y,b=u[0],T=u[1],A=u[2],L=Math.hypot(b,T,A);return L<_m?null:(b*=L=1/L,T*=L,A*=L,f=Math.sin(o),m=Math.cos(o),l[0]=b*b*(y=1-m)+m,l[1]=T*b*y+A*f,l[2]=A*b*y-T*f,l[3]=0,l[4]=b*T*y-A*f,l[5]=T*T*y+m,l[6]=A*T*y+b*f,l[7]=0,l[8]=b*A*y+T*f,l[9]=T*A*y-b*f,l[10]=A*A*y+m,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l)}Math.hypot||(Math.hypot=function(){for(var l=0,o=arguments.length;o--;)l+=arguments[o]*arguments[o];return Math.sqrt(l)});var gx=Vf;function i0(){var l=new el(3);return el!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l}function _x(l){var o=new el(3);return o[0]=l[0],o[1]=l[1],o[2]=l[2],o}function ku(l){return Math.hypot(l[0],l[1],l[2])}function Nd(l,o,u){var f=new el(3);return f[0]=l,f[1]=o,f[2]=u,f}function sh(l,o,u){return l[0]=o[0]+u[0],l[1]=o[1]+u[1],l[2]=o[2]+u[2],l}function Lg(l,o,u){return l[0]=o[0]-u[0],l[1]=o[1]-u[1],l[2]=o[2]-u[2],l}function Pg(l,o,u){return l[0]=o[0]*u[0],l[1]=o[1]*u[1],l[2]=o[2]*u[2],l}function Xh(l,o,u){return l[0]=Math.min(o[0],u[0]),l[1]=Math.min(o[1],u[1]),l[2]=Math.min(o[2],u[2]),l}function Ti(l,o,u){return l[0]=Math.max(o[0],u[0]),l[1]=Math.max(o[1],u[1]),l[2]=Math.max(o[2],u[2]),l}function pl(l,o,u){return l[0]=o[0]*u,l[1]=o[1]*u,l[2]=o[2]*u,l}function Rp(l,o,u,f){return l[0]=o[0]+u[0]*f,l[1]=o[1]+u[1]*f,l[2]=o[2]+u[2]*f,l}function Ro(l,o){var u=o[0],f=o[1],m=o[2],y=u*u+f*f+m*m;return y>0&&(y=1/Math.sqrt(y)),l[0]=o[0]*y,l[1]=o[1]*y,l[2]=o[2]*y,l}function vc(l,o){return l[0]*o[0]+l[1]*o[1]+l[2]*o[2]}function Rg(l,o,u){var f=o[0],m=o[1],y=o[2],b=u[0],T=u[1],A=u[2];return l[0]=m*A-y*T,l[1]=y*b-f*A,l[2]=f*T-m*b,l}function Qs(l,o,u){var f=o[0],m=o[1],y=o[2],b=u[3]*f+u[7]*m+u[11]*y+u[15];return l[0]=(u[0]*f+u[4]*m+u[8]*y+u[12])/(b=b||1),l[1]=(u[1]*f+u[5]*m+u[9]*y+u[13])/b,l[2]=(u[2]*f+u[6]*m+u[10]*y+u[14])/b,l}function tl(l,o,u){var f=u[0],m=u[1],y=u[2],b=o[0],T=o[1],A=o[2],L=m*A-y*T,F=y*b-f*A,U=f*T-m*b,j=m*U-y*F,Y=y*L-f*U,J=f*F-m*L,ee=2*u[3];return F*=ee,U*=ee,Y*=2,J*=2,l[0]=b+(L*=ee)+(j*=2),l[1]=T+F+Y,l[2]=A+U+J,l}var Dg,oh=Lg,yx=Pg,cw=ku;function r0(l,o,u){return l[0]=o[0]*u,l[1]=o[1]*u,l[2]=o[2]*u,l[3]=o[3]*u,l}function vx(l,o){var u=o[0],f=o[1],m=o[2],y=o[3],b=u*u+f*f+m*m+y*y;return b>0&&(b=1/Math.sqrt(b)),l[0]=u*b,l[1]=f*b,l[2]=m*b,l[3]=y*b,l}function Dp(l,o,u){var f=o[0],m=o[1],y=o[2],b=o[3];return l[0]=u[0]*f+u[4]*m+u[8]*y+u[12]*b,l[1]=u[1]*f+u[5]*m+u[9]*y+u[13]*b,l[2]=u[2]*f+u[6]*m+u[10]*y+u[14]*b,l[3]=u[3]*f+u[7]*m+u[11]*y+u[15]*b,l}function xx(){var l=new el(4);return el!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l[3]=1,l}function Zh(l){return l[0]=0,l[1]=0,l[2]=0,l[3]=1,l}function ml(l,o,u){u*=.5;var f=o[0],m=o[1],y=o[2],b=o[3],T=Math.sin(u),A=Math.cos(u);return l[0]=f*A+b*T,l[1]=m*A+y*T,l[2]=y*A-m*T,l[3]=b*A-f*T,l}function ey(l,o,u){u*=.5;var f=o[0],m=o[1],y=o[2],b=o[3],T=Math.sin(u),A=Math.cos(u);return l[0]=f*A-y*T,l[1]=m*A+b*T,l[2]=y*A+f*T,l[3]=b*A-m*T,l}i0(),Dg=new el(4),el!=Float32Array&&(Dg[0]=0,Dg[1]=0,Dg[2]=0,Dg[3]=0);var hw=vx;i0(),Nd(1,0,0),Nd(0,1,0),xx(),xx(),px();const s0=ni([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:bx}=s0,Ex=ni([{name:"a_pos_3",components:3,type:"Int16"}]);var Gf=ni([{name:"a_pos",type:"Int16",components:2}]);class ty{constructor(o,u){this.pos=o,this.dir=u}intersectsPlane(o,u,f){const m=vc(u,this.dir);if(Math.abs(m)<1e-6)return!1;const y=((o[0]-this.pos[0])*u[0]+(o[1]-this.pos[1])*u[1]+(o[2]-this.pos[2])*u[2])/m;return f[0]=this.pos[0]+this.dir[0]*y,f[1]=this.pos[1]+this.dir[1]*y,f[2]=this.pos[2]+this.dir[2]*y,!0}closestPointOnSphere(o,u,f){if(function(Y,J){var ee=Y[0],ce=Y[1],we=Y[2],Pe=J[0],be=J[1],Me=J[2];return Math.abs(ee-Pe)<=_m*Math.max(1,Math.abs(ee),Math.abs(Pe))&&Math.abs(ce-be)<=_m*Math.max(1,Math.abs(ce),Math.abs(be))&&Math.abs(we-Me)<=_m*Math.max(1,Math.abs(we),Math.abs(Me))}(this.pos,o)||u===0)return f[0]=f[1]=f[2]=0,!1;const[m,y,b]=this.dir,T=this.pos[0]-o[0],A=this.pos[1]-o[1],L=this.pos[2]-o[2],F=m*m+y*y+b*b,U=2*(T*m+A*y+L*b),j=U*U-4*F*(T*T+A*A+L*L-u*u);if(j<0){const Y=Math.max(-U/2,0),J=T+m*Y,ee=A+y*Y,ce=L+b*Y,we=Math.hypot(J,ee,ce);return f[0]=J*u/we,f[1]=ee*u/we,f[2]=ce*u/we,!1}{const Y=(-U-Math.sqrt(j))/(2*F);if(Y<0){const J=Math.hypot(T,A,L);return f[0]=T*u/J,f[1]=A*u/J,f[2]=L*u/J,!1}return f[0]=T+m*Y,f[1]=A+y*Y,f[2]=L+b*Y,!0}}}class ny{constructor(o,u,f,m,y){this.TL=o,this.TR=u,this.BR=f,this.BL=m,this.horizon=y}static fromInvProjectionMatrix(o,u,f){const m=[-1,1,1],y=[1,1,1],b=[1,-1,1],T=[-1,-1,1],A=Qs(m,m,o),L=Qs(y,y,o),F=Qs(b,b,o),U=Qs(T,T,o);return new ny(A,L,F,U,u/f)}}class o0{constructor(o,u){this.points=o,this.planes=u}static fromInvProjectionMatrix(o,u,f,m){const y=Math.pow(2,f),b=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(A=>{const L=Dp([],A,o),F=1/L[3]/u*y;return function(U,j,Y){return U[0]=j[0]*Y[0],U[1]=j[1]*Y[1],U[2]=j[2]*Y[2],U[3]=j[3]*Y[3],U}(L,L,[F,F,m?1/L[3]:F,F])}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(A=>{const L=Ro([],Rg([],oh([],b[A[0]],b[A[1]]),oh([],b[A[2]],b[A[1]]))),F=-vc(L,b[A[1]]);return L.concat(F)});return new o0(b,T)}}class gl{static fromPoints(o){const u=[1/0,1/0,1/0],f=[-1/0,-1/0,-1/0];for(const m of o)Xh(u,u,m),Ti(f,f,m);return new gl(u,f)}static applyTransform(o,u){const f=o.getCorners();for(let m=0;m<f.length;++m)Qs(f[m],f[m],u);return gl.fromPoints(f)}constructor(o,u){this.min=o,this.max=u,this.center=pl([],sh([],this.min,this.max),.5)}quadrant(o){const u=[o%2==0,o<2],f=_x(this.min),m=_x(this.max);for(let y=0;y<u.length;y++)f[y]=u[y]?this.min[y]:this.center[y],m[y]=u[y]?this.center[y]:this.max[y];return m[2]=this.max[2],new gl(f,m)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}distanceZ(o){return Math.max(Math.min(this.max[2],o[2]),this.min[2])-o[2]}getCorners(){const o=this.min,u=this.max;return[[o[0],o[1],o[2]],[u[0],o[1],o[2]],[u[0],u[1],o[2]],[o[0],u[1],o[2]],[o[0],o[1],u[2]],[u[0],o[1],u[2]],[u[0],u[1],u[2]],[o[0],u[1],u[2]]]}intersects(o){const u=this.getCorners();let f=!0;for(let m=0;m<o.planes.length;m++){const y=o.planes[m];let b=0;for(let T=0;T<u.length;T++)b+=vc(y,u[T])+y[3]>=0;if(b===0)return 0;b!==u.length&&(f=!1)}if(f)return 2;for(let m=0;m<3;m++){let y=Number.MAX_VALUE,b=-Number.MAX_VALUE;for(let T=0;T<o.points.length;T++){const A=o.points[T][m]-this.min[m];y=Math.min(y,A),b=Math.max(b,A)}if(b<0||y>this.max[m]-this.min[m])return 0}return 1}}const Yh=gi/Math.PI/2,Op=64,ym=[Op,32,16],Fu=-Yh,xc=Yh,a0=[new gl([Fu,Fu,Fu],[xc,xc,xc]),new gl([Fu,Fu,Fu],[0,0,xc]),new gl([0,Fu,Fu],[xc,0,xc]),new gl([Fu,0,Fu],[0,xc,xc]),new gl([0,0,Fu],[xc,xc,xc])];function Og(l){return l*Yh/Fg}function vm(l,o,u,f=!0){const m=pl([],l._camera.position,l.worldSize),y=[o,u,1,1];Dp(y,y,l.pixelMatrixInverse),r0(y,y,1/y[3]);const b=Ro([],oh([],y,m)),T=l.globeMatrix,A=[T[12],T[13],T[14]],L=oh([],A,m),F=ku(L),U=Ro([],L),j=l.worldSize/(2*Math.PI),Y=vc(U,b),J=Math.asin(j/F);if(J<Math.acos(Y)){if(!f)return null;const Jt=[],bt=[];pl(Jt,b,F/Y),Ro(bt,oh(bt,Jt,L)),Ro(b,sh(b,L,pl(b,bt,Math.tan(J)*F)))}const ee=[];new ty(m,b).closestPointOnSphere(A,j,ee);const ce=Ro([],hi(T,0)),we=Ro([],hi(T,1)),Pe=Ro([],hi(T,2)),be=vc(ce,ee),Me=vc(we,ee),Ve=vc(Pe,ee),ke=Ne(Math.asin(-Me/j));let _t=Ne(Math.atan2(be,Ve));_t=l.center.lng+function(Jt,bt){const Bt=(bt-Jt+180)%360-180;return Bt<-180?Bt+360:Bt}(l.center.lng,_t);const mt=Jh(_t),Pt=nt(Qh(ke),0,1);return new wm(mt,Pt)}class l0{constructor(o,u,f){this.a=oh([],o,f),this.b=oh([],u,f),this.center=f;const m=Ro([],this.a),y=Ro([],this.b);this.angle=Math.acos(vc(m,y))}}function iy(l,o){if(l.angle===0)return null;let u;return u=l.a[o]===0?1/l.angle*.5*Math.PI:1/l.angle*Math.atan(l.b[o]/l.a[o]/Math.sin(l.angle)-1/Math.tan(l.angle)),u<0||u>1?null:function(f,m,y,b){const T=Math.sin(y);return f*(Math.sin((1-b)*y)/T)+m*(Math.sin(b*y)/T)}(l.a[o],l.b[o],l.angle,nt(u,0,1))+l.center[o]}function ah(l){if(l.z<=1)return a0[l.z+2*l.y+l.x];const o=sy(ry(l));return gl.fromPoints(o)}function Kh(l,o,u){return pl(l,l,1-u),Rp(l,l,o,u)}function u0(l,o){const u=Em(o.zoom);if(u===0)return ah(l);const f=ry(l),m=sy(f),y=Jh(f.getWest())*o.worldSize,b=Jh(f.getEast())*o.worldSize,T=Qh(f.getNorth())*o.worldSize,A=Qh(f.getSouth())*o.worldSize,L=[y,T,0],F=[b,T,0],U=[y,A,0],j=[b,A,0],Y=$_([],o.globeMatrix);return Qs(L,L,Y),Qs(F,F,Y),Qs(U,U,Y),Qs(j,j,Y),m[0]=Kh(m[0],U,u),m[1]=Kh(m[1],j,u),m[2]=Kh(m[2],F,u),m[3]=Kh(m[3],L,u),gl.fromPoints(m)}function lh(l,o,u){for(const f of l)Qs(f,f,o),pl(f,f,u)}function Np(l,o,u){const f=o/l.worldSize,m=l.globeMatrix;if(u.z<=1){const mt=ah(u).getCorners();return lh(mt,m,f),gl.fromPoints(mt)}const y=ry(u),b=sy(y);lh(b,m,f);const T=Number.MAX_VALUE,A=[-T,-T,-T],L=[T,T,T];if(y.contains(l.center)){for(const Jt of b)Xh(L,L,Jt),Ti(A,A,Jt);A[2]=0;const mt=l.point,Pt=[mt.x*f,mt.y*f,0];return Xh(L,L,Pt),Ti(A,A,Pt),new gl(L,A)}const F=[m[12]*f,m[13]*f,m[14]*f],U=y.getCenter(),j=nt(l.center.lat,-Es,Es),Y=nt(U.lat,-Es,Es),J=Jh(l.center.lng),ee=Qh(j);let ce=J-Jh(U.lng);const we=ee-Qh(Y);ce>.5?ce-=1:ce<-.5&&(ce+=1);let Pe=0;Math.abs(ce)>Math.abs(we)?Pe=ce>=0?1:3:(Pe=we>=0?0:2,Rp(F,F,[m[4]*f,m[5]*f,m[6]*f],-Math.sin(Fe(we>=0?y.getSouth():y.getNorth()))*Yh));const be=b[Pe],Me=b[(Pe+1)%4],Ve=new l0(be,Me,F),ke=[iy(Ve,0)||be[0],iy(Ve,1)||be[1],iy(Ve,2)||be[2]],_t=Em(l.zoom);if(_t>0){const mt=function({x:Jt,y:bt,z:Bt},Vt,Zt,$t,Et){const yn=1/(1<<Bt);let mi=Jt*yn,Mn=mi+yn,Jn=bt*yn,xn=Jn+yn,_i=0;const dr=(mi+Mn)/2-$t;return dr>.5?_i=-1:dr<-.5&&(_i=1),mi=((mi+_i)*Vt-($t*=Vt))*Zt+$t,Mn=((Mn+_i)*Vt-$t)*Zt+$t,Jn=(Jn*Vt-(Et*=Vt))*Zt+Et,xn=(xn*Vt-Et)*Zt+Et,[[mi,xn,0],[Mn,xn,0],[Mn,Jn,0],[mi,Jn,0]]}(u,o,l._pixelsPerMercatorPixel,J,ee);for(let Jt=0;Jt<b.length;Jt++)Kh(b[Jt],mt[Jt],_t);const Pt=sh([],mt[Pe],mt[(Pe+1)%4]);pl(Pt,Pt,.5),Kh(ke,Pt,_t)}for(const mt of b)Xh(L,L,mt),Ti(A,A,mt);return L[2]=Math.min(be[2],Me[2]),Xh(L,L,ke),Ti(A,A,ke),new gl(L,A)}function ry({x:l,y:o,z:u}){const f=1/(1<<u),m=new Ir(Bu(l*f),Ra((o+1)*f)),y=new Ir(Bu((l+1)*f),Ra(o*f));return new ih(m,y)}function sy(l){const o=Fe(l.getNorth()),u=Fe(l.getSouth()),f=Math.cos(o),m=Math.cos(u),y=Math.sin(o),b=Math.sin(u),T=l.getWest(),A=l.getEast();return[xm(m,b,T),xm(m,b,A),xm(f,y,A),xm(f,y,T)]}function xm(l,o,u,f=Yh){return u=Fe(u),[l*Math.sin(u)*f,-o*f,l*Math.cos(u)*f]}function bm(l,o,u){return xm(Math.cos(Fe(l)),Math.sin(Fe(l)),o,u)}function Ng(l,o,u,f){const m=1<<u.z,y=(l/gi+u.x)/m;return bm(Ra((o/gi+u.y)/m),Bu(y),f)}function oy({min:l,max:o}){return 16383/Math.max(o[0]-l[0],o[1]-l[1],o[2]-l[2])}const wx=new Float64Array(16);function kg(l){const o=oy(l),u=n0(wx,[o,o,o]);return Ag(u,u,((f=[])[0]=-(m=l.min)[0],f[1]=-m[1],f[2]=-m[2],f));var f,m}function c0(l){const o=(f=l.min,(u=wx)[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=f[0],u[13]=f[1],u[14]=f[2],u[15]=1,u);var u,f;const m=1/oy(l);return Od(o,o,[m,m,m])}function Ix(l,o,u,f,m){const y=function(A){const L=gi/(2*Math.PI);return A/(2*Math.PI)/L}(u),b=[l,o,-u/(2*Math.PI)],T=lu(new Float64Array(16));return Ag(T,T,b),Od(T,T,[y,y,y]),rh(T,T,Fe(-m)),Mg(T,T,Fe(-f)),T}function Em(l){return zt(5,6,l)}function Tx(l,o){const u=bm(o.lat,o.lng),f=function(J){const ee=bm(J._center.lat,J._center.lng);let ce=Rg([],Nd(0,1,0),ee);const we=mx([],-J.angle,ee);ce=Qs(ce,ce,we),mx(we,-J._pitch,ce);const Pe=Ro([],ee);return pl(Pe,Pe,Og(J.cameraToCenterDistance/J.pixelsPerMeter)),Qs(Pe,Pe,we),sh([],ee,Pe)}(l);return b=(m=Lg([],f,u))[0],T=m[1],A=m[2],L=(y=u)[0],F=y[1],U=y[2],Y=(j=Math.sqrt(b*b+T*T+A*A)*Math.sqrt(L*L+F*F+U*U))&&vc(m,y)/j,Math.acos(Math.min(Math.max(Y,-1),1));var m,y,b,T,A,L,F,U,j,Y}function h0(l,o){return Tx(l,o)>Math.PI/2*1.01}const f0=Fe(85),Sx=Math.cos(f0),Cx=Math.sin(f0),Fg=63710088e-1,Ax=2*Math.PI*Fg;class Ir{constructor(o,u){if(isNaN(o)||isNaN(u))throw new Error(`Invalid LngLat object: (${o}, ${u})`);if(this.lng=+o,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ir(Ot(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(o){const u=Math.PI/180,f=this.lat*u,m=o.lat*u,y=Math.sin(f)*Math.sin(m)+Math.cos(f)*Math.cos(m)*Math.cos((o.lng-this.lng)*u);return Fg*Math.acos(Math.min(y,1))}toBounds(o=0){const u=360*o/40075017,f=u/Math.cos(Math.PI/180*this.lat);return new ih(new Ir(this.lng-f,this.lat-u),new Ir(this.lng+f,this.lat+u))}toEcef(o){const u=Og(o);return bm(this.lat,this.lng,Yh+u)}static convert(o){if(o instanceof Ir)return o;if(Array.isArray(o)&&(o.length===2||o.length===3))return new Ir(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&typeof o=="object"&&o!==null)return new Ir(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}function ay(l){return Ax*Math.cos(l*Math.PI/180)}function Jh(l){return(180+l)/360}function Qh(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function uh(l,o){return l/ay(o)}function Bu(l){return 360*l-180}function Ra(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function Mx(l,o){return l*ay(Ra(o))}const Es=85.051129;function Lx(l){return 1/Math.cos(l*Math.PI/180)}class wm{constructor(o,u,f=0){this.x=+o,this.y=+u,this.z=+f}static fromLngLat(o,u=0){const f=Ir.convert(o);return new wm(Jh(f.lng),Qh(f.lat),uh(u,f.lat))}toLngLat(){return new Ir(Bu(this.x),Ra(this.y))}toAltitude(){return Mx(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Ax*Lx(Ra(this.y))}}function d0(l,o,u,f,m,y,b,T,A){const L=(o+f)/2,F=(u+m)/2,U=new ie(L,F);T(U),function(j,Y,J,ee,ce,we){const Pe=J-ce,be=ee-we;return Math.abs((ee-Y)*Pe-(J-j)*be)/Math.hypot(Pe,be)}(U.x,U.y,y.x,y.y,b.x,b.y)>=A?(d0(l,o,u,L,F,y,U,T,A),d0(l,L,F,f,m,U,b,T,A)):l.push(b)}function p0(l,o,u){let f=l[0],m=f.x,y=f.y;o(f);const b=[f];for(let T=1;T<l.length;T++){const A=l[T],{x:L,y:F}=A;o(A),d0(b,m,y,L,F,f,A,o,u),m=L,y=F,f=A}return b}function m0(l,o,u,f){if(f(o,u)){const m=o.add(u)._mult(.5);m0(l,o,m,f),m0(l,m,u,f)}else l.push(u)}function fw(l,o){let u=l[0];const f=[u];for(let m=1;m<l.length;m++){const y=l[m];m0(f,u,y,o),u=y}return f}const g0=Math.pow(2,14)-1,Px=-g0-1;function _0(l,o){const u=Math.round(l.x*o),f=Math.round(l.y*o);return l.x=nt(u,Px,g0),l.y=nt(f,Px,g0),(u<l.x||u>l.x+1||f<l.y||f>l.y+1)&&Gn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),l}function jf(l,o,u){const f=l.loadGeometry(),m=l.extent,y=gi/m;if(o&&u&&u.projection.isReprojectedInTileSpace){const b=1<<o.z,{scale:T,x:A,y:L,projection:F}=u,U=j=>{const Y=Bu((o.x+j.x/m)/b),J=Ra((o.y+j.y/m)/b),ee=F.project(Y,J);j.x=(ee.x*T-A)*m,j.y=(ee.y*T-L)*m};for(let j=0;j<f.length;j++)if(l.type!==1)f[j]=p0(f[j],U,1);else{const Y=[];for(const J of f[j])J.x<0||J.x>=m||J.y<0||J.y>=m||(U(J),Y.push(J));f[j]=Y}}for(const b of f)for(const T of b)_0(T,y);return f}function kp(l,o){return{type:l.type,id:l.id,properties:l.properties,geometry:o?jf(l):[]}}function ly(l,o,u,f,m){l.emplaceBack(2*o+(f+1)/2,2*u+(m+1)/2)}function uy(l,o,u){l.emplaceBack(o.x,o.y,o.z,u[0]*16384,u[1]*16384,u[2]*16384)}class y0{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(u=>u.id),this.index=o.index,this.hasPattern=!1,this.projection=o.projection,this.layoutVertexArray=new oi,this.indexArray=new da,this.segments=new Gs,this.programConfigurations=new yc(o.layers,o.zoom),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(o,u,f,m){const y=this.layers[0],b=[];let T=null;y.type==="circle"&&(T=y.layout.get("circle-sort-key"));for(const{feature:L,id:F,index:U,sourceLayerIndex:j}of o){const Y=this.layers[0]._featureFilter.needGeometry,J=kp(L,Y);if(!this.layers[0]._featureFilter.filter(new lt(this.zoom),J,f))continue;const ee=T?T.evaluate(J,{},f):void 0,ce={id:F,properties:L.properties,type:L.type,sourceLayerIndex:j,index:U,geometry:Y?J.geometry:jf(L,f,m),patterns:{},sortKey:ee};b.push(ce)}T&&b.sort((L,F)=>L.sortKey-F.sortKey);let A=null;m.projection.name==="globe"&&(this.globeExtVertexArray=new ru,A=m.projection);for(const L of b){const{geometry:F,index:U,sourceLayerIndex:j}=L,Y=o[U].feature;this.addFeature(L,F,U,u.availableImages,f,A),u.featureIndex.insert(Y,F,U,j,this.index)}}update(o,u,f,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,u,this.stateDependentLayers,f,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,fx.members),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,dx.members))),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(o,u,f,m,y,b){for(const T of u)for(const A of T){const L=A.x,F=A.y;if(L<0||L>=gi||F<0||F>=gi)continue;if(b){const Y=b.projectTilePoint(L,F,y),J=b.upVector(y,L,F),ee=this.globeExtVertexArray;uy(ee,Y,J),uy(ee,Y,J),uy(ee,Y,J),uy(ee,Y,J)}const U=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,o.sortKey),j=U.vertexLength;ly(this.layoutVertexArray,L,F,-1,-1),ly(this.layoutVertexArray,L,F,1,-1),ly(this.layoutVertexArray,L,F,1,1),ly(this.layoutVertexArray,L,F,-1,1),this.indexArray.emplaceBack(j,j+1,j+2),this.indexArray.emplaceBack(j,j+2,j+3),U.vertexLength+=4,U.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,{},m,y)}}function Rx(l,o){for(let u=0;u<l.length;u++)if(Fp(o,l[u]))return!0;for(let u=0;u<o.length;u++)if(Fp(l,o[u]))return!0;return!!v0(l,o)}function dw(l,o,u){return!!Fp(l,o)||!!x0(o,l,u)}function Dx(l,o){if(l.length===1)return Nx(o,l[0]);for(let u=0;u<o.length;u++){const f=o[u];for(let m=0;m<f.length;m++)if(Fp(l,f[m]))return!0}for(let u=0;u<l.length;u++)if(Nx(o,l[u]))return!0;for(let u=0;u<o.length;u++)if(v0(l,o[u]))return!0;return!1}function pw(l,o,u){if(l.length>1){if(v0(l,o))return!0;for(let f=0;f<o.length;f++)if(x0(o[f],l,u))return!0}for(let f=0;f<l.length;f++)if(x0(l[f],o,u))return!0;return!1}function v0(l,o){if(l.length===0||o.length===0)return!1;for(let u=0;u<l.length-1;u++){const f=l[u],m=l[u+1];for(let y=0;y<o.length-1;y++)if(mw(f,m,o[y],o[y+1]))return!0}return!1}function mw(l,o,u,f){return Ci(l,u,f)!==Ci(o,u,f)&&Ci(l,o,u)!==Ci(l,o,f)}function x0(l,o,u){const f=u*u;if(o.length===1)return l.distSqr(o[0])<f;for(let m=1;m<o.length;m++)if(Ox(l,o[m-1],o[m])<f)return!0;return!1}function Ox(l,o,u){const f=o.distSqr(u);if(f===0)return l.distSqr(o);const m=((l.x-o.x)*(u.x-o.x)+(l.y-o.y)*(u.y-o.y))/f;return l.distSqr(m<0?o:m>1?u:u.sub(o)._mult(m)._add(o))}function Nx(l,o){let u,f,m,y=!1;for(let b=0;b<l.length;b++){u=l[b];for(let T=0,A=u.length-1;T<u.length;A=T++)f=u[T],m=u[A],f.y>o.y!=m.y>o.y&&o.x<(m.x-f.x)*(o.y-f.y)/(m.y-f.y)+f.x&&(y=!y)}return y}function Fp(l,o){let u=!1;for(let f=0,m=l.length-1;f<l.length;m=f++){const y=l[f],b=l[m];y.y>o.y!=b.y>o.y&&o.x<(b.x-y.x)*(o.y-y.y)/(b.y-y.y)+y.x&&(u=!u)}return u}function kx(l,o,u,f,m){for(const b of l)if(o<=b.x&&u<=b.y&&f>=b.x&&m>=b.y)return!0;const y=[new ie(o,u),new ie(o,m),new ie(f,m),new ie(f,u)];if(l.length>2){for(const b of y)if(Fp(l,b))return!0}for(let b=0;b<l.length-1;b++)if(gw(l[b],l[b+1],y))return!0;return!1}function gw(l,o,u){const f=u[0],m=u[2];if(l.x<f.x&&o.x<f.x||l.x>m.x&&o.x>m.x||l.y<f.y&&o.y<f.y||l.y>m.y&&o.y>m.y)return!1;const y=Ci(l,o,u[0]);return y!==Ci(l,o,u[1])||y!==Ci(l,o,u[2])||y!==Ci(l,o,u[3])}function Im(l,o,u){const f=o.paint.get(l).value;return f.kind==="constant"?f.value:u.programConfigurations.get(o.id).getMaxValue(l)}function cy(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function Fx(l,o,u,f,m){if(!o[0]&&!o[1])return l;const y=ie.convert(o)._mult(m);u==="viewport"&&y._rotate(-f);const b=[];for(let T=0;T<l.length;T++)b.push(l[T].sub(y));return b}function hy(l,o,u,f){const m=ie.convert(l)._mult(f);return o==="viewport"&&m._rotate(-u),m}Cn(y0,"CircleBucket",{omit:["layers"]});const Bx=new Ht({"circle-sort-key":new yt(wt.layout_circle["circle-sort-key"])});var _w={paint:new Ht({"circle-radius":new yt(wt.paint_circle["circle-radius"]),"circle-color":new yt(wt.paint_circle["circle-color"]),"circle-blur":new yt(wt.paint_circle["circle-blur"]),"circle-opacity":new yt(wt.paint_circle["circle-opacity"]),"circle-translate":new at(wt.paint_circle["circle-translate"]),"circle-translate-anchor":new at(wt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new at(wt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new at(wt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new yt(wt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new yt(wt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new yt(wt.paint_circle["circle-stroke-opacity"])}),layout:Bx};function zx(l,o,u,f,m,y,b,T,A){if(y&&l.queryGeometry.isAboveHorizon)return!1;y&&(A*=l.pixelToTileUnitsFactor);const L=l.tileID.canonical,F=u.projection.upVectorScale(L,u.center.lat,u.worldSize).metersToTile;for(const U of o)for(const j of U){const Y=j.add(T),J=m&&u.elevation?u.elevation.exaggeration()*m.getElevationAt(Y.x,Y.y,!0):0,ee=u.projection.projectTilePoint(Y.x,Y.y,L);if(J>0){const be=u.projection.upVector(L,Y.x,Y.y);ee.x+=be[0]*F*J,ee.y+=be[1]*F*J,ee.z+=be[2]*F*J}const ce=y?Y:yw(ee.x,ee.y,ee.z,f),we=y?l.tilespaceRays.map(be=>xw(be,J)):l.queryGeometry.screenGeometry,Pe=Dp([],[ee.x,ee.y,ee.z,1],f);if(!b&&y?A*=Pe[3]/u.cameraToCenterDistance:b&&!y&&(A*=u.cameraToCenterDistance/Pe[3]),y){const be=Ra((j.y/gi+L.y)/(1<<L.z));A/=u.projection.pixelsPerMeter(be,1)/uh(1,be)}if(dw(we,ce,A))return!0}return!1}function yw(l,o,u,f){const m=Dp([],[l,o,u,1],f);return new ie(m[0]/m[3],m[1]/m[3])}const Ux=Nd(0,0,0),vw=Nd(0,0,1);function xw(l,o){const u=i0();return Ux[2]=o,l.intersectsPlane(Ux,vw,u),new ie(u[0],u[1])}class Vx extends y0{}function Gx(l,{width:o,height:u},f,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==o*u*f)throw new RangeError("mismatched image size")}else m=new Uint8Array(o*u*f);return l.width=o,l.height=u,l.data=m,l}function b0(l,o,u){const{width:f,height:m}=o;f===l.width&&m===l.height||(E0(l,o,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,f),height:Math.min(l.height,m)},u),l.width=f,l.height=m,l.data=o.data)}function E0(l,o,u,f,m,y){if(m.width===0||m.height===0)return o;if(m.width>l.width||m.height>l.height||u.x>l.width-m.width||u.y>l.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>o.width||m.height>o.height||f.x>o.width-m.width||f.y>o.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const b=l.data,T=o.data;for(let A=0;A<m.height;A++){const L=((u.y+A)*l.width+u.x)*y,F=((f.y+A)*o.width+f.x)*y;for(let U=0;U<m.width*y;U++)T[F+U]=b[L+U]}return o}Cn(Vx,"HeatmapBucket",{omit:["layers"]});class bc{constructor(o,u){Gx(this,o,1,u)}resize(o){b0(this,new bc(o),1)}clone(){return new bc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,u,f,m,y){E0(o,u,f,m,y,1)}}class uu{constructor(o,u){Gx(this,o,4,u)}resize(o){b0(this,new uu(o),4)}replace(o,u){u?this.data.set(o):this.data=o instanceof Uint8ClampedArray?new Uint8Array(o.buffer):o}clone(){return new uu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,u,f,m,y){E0(o,u,f,m,y,4)}}Cn(bc,"AlphaImage"),Cn(uu,"RGBAImage");var bw={paint:new Ht({"heatmap-radius":new yt(wt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new yt(wt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new at(wt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Gt(wt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new at(wt.paint_heatmap["heatmap-opacity"])})};function w0(l){const o={},u=l.resolution||256,f=l.clips?l.clips.length:1,m=l.image||new uu({width:u,height:f}),y=(b,T,A)=>{o[l.evaluationKey]=A;const L=l.expression.evaluate(o);m.data[b+T+0]=Math.floor(255*L.r/L.a),m.data[b+T+1]=Math.floor(255*L.g/L.a),m.data[b+T+2]=Math.floor(255*L.b/L.a),m.data[b+T+3]=Math.floor(255*L.a)};if(l.clips)for(let b=0,T=0;b<f;++b,T+=4*u)for(let A=0,L=0;A<u;A++,L+=4){const F=A/(u-1),{start:U,end:j}=l.clips[b];y(T,L,U*(1-F)+j*F)}else for(let b=0,T=0;b<u;b++,T+=4)y(0,T,b/(u-1));return m}var Ew={paint:new Ht({"hillshade-illumination-direction":new at(wt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new at(wt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new at(wt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new at(wt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new at(wt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new at(wt.paint_hillshade["hillshade-accent-color"])})};const ww=ni([{name:"a_pos",components:2,type:"Int16"}],4),{members:Iw}=ww;var Tm={};function fy(l,o,u){u=u||2;var f,m,y,b,T,A,L,F=o&&o.length,U=F?o[0]*u:l.length,j=jx(l,0,U,u,!0),Y=[];if(!j||j.next===j.prev)return Y;if(F&&(j=function(ee,ce,we,Pe){var be,Me,Ve,ke=[];for(be=0,Me=ce.length;be<Me;be++)(Ve=jx(ee,ce[be]*Pe,be<Me-1?ce[be+1]*Pe:ee.length,Pe,!1))===Ve.next&&(Ve.steiner=!0),ke.push(Lw(Ve));for(ke.sort(Mw),be=0;be<ke.length;be++)we=qx(ke[be],we);return we}(l,o,j,u)),l.length>80*u){f=y=l[0],m=b=l[1];for(var J=u;J<U;J+=u)(T=l[J])<f&&(f=T),(A=l[J+1])<m&&(m=A),T>y&&(y=T),A>b&&(b=A);L=(L=Math.max(y-f,b-m))!==0?32767/L:0}return Bg(j,Y,u,f,m,L,0),Y}function jx(l,o,u,f,m){var y,b;if(m===S0(l,o,u,f)>0)for(y=o;y<u;y+=f)b=Zx(y,l[y],l[y+1],b);else for(y=u-f;y>=o;y-=f)b=Zx(y,l[y],l[y+1],b);return b&&dy(b,b.next)&&(Ug(b),b=b.next),b}function Bp(l,o){if(!l)return l;o||(o=l);var u,f=l;do if(u=!1,f.steiner||!dy(f,f.next)&&js(f.prev,f,f.next)!==0)f=f.next;else{if(Ug(f),(f=o=f.prev)===f.next)break;u=!0}while(u||f!==o);return o}function Bg(l,o,u,f,m,y,b){if(l){!b&&y&&function(F,U,j,Y){var J=F;do J.z===0&&(J.z=I0(J.x,J.y,U,j,Y)),J.prevZ=J.prev,J.nextZ=J.next,J=J.next;while(J!==F);J.prevZ.nextZ=null,J.prevZ=null,function(ee){var ce,we,Pe,be,Me,Ve,ke,_t,mt=1;do{for(we=ee,ee=null,Me=null,Ve=0;we;){for(Ve++,Pe=we,ke=0,ce=0;ce<mt&&(ke++,Pe=Pe.nextZ);ce++);for(_t=mt;ke>0||_t>0&&Pe;)ke!==0&&(_t===0||!Pe||we.z<=Pe.z)?(be=we,we=we.nextZ,ke--):(be=Pe,Pe=Pe.nextZ,_t--),Me?Me.nextZ=be:ee=be,be.prevZ=Me,Me=be;we=Pe}Me.nextZ=null,mt*=2}while(Ve>1)}(J)}(l,f,m,y);for(var T,A,L=l;l.prev!==l.next;)if(T=l.prev,A=l.next,y?Sw(l,f,m,y):Tw(l))o.push(T.i/u|0),o.push(l.i/u|0),o.push(A.i/u|0),Ug(l),l=A.next,L=A.next;else if((l=A)===L){b?b===1?Bg(l=Cw(Bp(l),o,u),o,u,f,m,y,2):b===2&&Aw(l,o,u,f,m,y):Bg(Bp(l),o,u,f,m,y,1);break}}}function Tw(l){var o=l.prev,u=l,f=l.next;if(js(o,u,f)>=0)return!1;for(var m=o.x,y=u.x,b=f.x,T=o.y,A=u.y,L=f.y,F=m<y?m<b?m:b:y<b?y:b,U=T<A?T<L?T:L:A<L?A:L,j=m>y?m>b?m:b:y>b?y:b,Y=T>A?T>L?T:L:A>L?A:L,J=f.next;J!==o;){if(J.x>=F&&J.x<=j&&J.y>=U&&J.y<=Y&&Sm(m,T,y,A,b,L,J.x,J.y)&&js(J.prev,J,J.next)>=0)return!1;J=J.next}return!0}function Sw(l,o,u,f){var m=l.prev,y=l,b=l.next;if(js(m,y,b)>=0)return!1;for(var T=m.x,A=y.x,L=b.x,F=m.y,U=y.y,j=b.y,Y=T<A?T<L?T:L:A<L?A:L,J=F<U?F<j?F:j:U<j?U:j,ee=T>A?T>L?T:L:A>L?A:L,ce=F>U?F>j?F:j:U>j?U:j,we=I0(Y,J,o,u,f),Pe=I0(ee,ce,o,u,f),be=l.prevZ,Me=l.nextZ;be&&be.z>=we&&Me&&Me.z<=Pe;){if(be.x>=Y&&be.x<=ee&&be.y>=J&&be.y<=ce&&be!==m&&be!==b&&Sm(T,F,A,U,L,j,be.x,be.y)&&js(be.prev,be,be.next)>=0||(be=be.prevZ,Me.x>=Y&&Me.x<=ee&&Me.y>=J&&Me.y<=ce&&Me!==m&&Me!==b&&Sm(T,F,A,U,L,j,Me.x,Me.y)&&js(Me.prev,Me,Me.next)>=0))return!1;Me=Me.nextZ}for(;be&&be.z>=we;){if(be.x>=Y&&be.x<=ee&&be.y>=J&&be.y<=ce&&be!==m&&be!==b&&Sm(T,F,A,U,L,j,be.x,be.y)&&js(be.prev,be,be.next)>=0)return!1;be=be.prevZ}for(;Me&&Me.z<=Pe;){if(Me.x>=Y&&Me.x<=ee&&Me.y>=J&&Me.y<=ce&&Me!==m&&Me!==b&&Sm(T,F,A,U,L,j,Me.x,Me.y)&&js(Me.prev,Me,Me.next)>=0)return!1;Me=Me.nextZ}return!0}function Cw(l,o,u){var f=l;do{var m=f.prev,y=f.next.next;!dy(m,y)&&Wx(m,f,f.next,y)&&zg(m,y)&&zg(y,m)&&(o.push(m.i/u|0),o.push(f.i/u|0),o.push(y.i/u|0),Ug(f),Ug(f.next),f=l=y),f=f.next}while(f!==l);return Bp(f)}function Aw(l,o,u,f,m,y){var b=l;do{for(var T=b.next.next;T!==b.prev;){if(b.i!==T.i&&Pw(b,T)){var A=Xx(b,T);return b=Bp(b,b.next),A=Bp(A,A.next),Bg(b,o,u,f,m,y,0),void Bg(A,o,u,f,m,y,0)}T=T.next}b=b.next}while(b!==l)}function Mw(l,o){return l.x-o.x}function qx(l,o){var u=function(m,y){var b,T=y,A=m.x,L=m.y,F=-1/0;do{if(L<=T.y&&L>=T.next.y&&T.next.y!==T.y){var U=T.x+(L-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(U<=A&&U>F&&(F=U,b=T.x<T.next.x?T:T.next,U===A))return b}T=T.next}while(T!==y);if(!b)return null;var j,Y=b,J=b.x,ee=b.y,ce=1/0;T=b;do A>=T.x&&T.x>=J&&A!==T.x&&Sm(L<ee?A:F,L,J,ee,L<ee?F:A,L,T.x,T.y)&&(j=Math.abs(L-T.y)/(A-T.x),zg(T,m)&&(j<ce||j===ce&&(T.x>b.x||T.x===b.x&&Hx(b,T)))&&(b=T,ce=j)),T=T.next;while(T!==Y);return b}(l,o);if(!u)return o;var f=Xx(u,l);return Bp(f,f.next),Bp(u,u.next)}function Hx(l,o){return js(l.prev,l,o.prev)<0&&js(o.next,l,l.next)<0}function I0(l,o,u,f,m){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-u)*m|0)|l<<8))|l<<4))|l<<2))|l<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-f)*m|0)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function Lw(l){var o=l,u=l;do(o.x<u.x||o.x===u.x&&o.y<u.y)&&(u=o),o=o.next;while(o!==l);return u}function Sm(l,o,u,f,m,y,b,T){return(m-b)*(o-T)>=(l-b)*(y-T)&&(l-b)*(f-T)>=(u-b)*(o-T)&&(u-b)*(y-T)>=(m-b)*(f-T)}function Pw(l,o){return l.next.i!==o.i&&l.prev.i!==o.i&&!function(u,f){var m=u;do{if(m.i!==u.i&&m.next.i!==u.i&&m.i!==f.i&&m.next.i!==f.i&&Wx(m,m.next,u,f))return!0;m=m.next}while(m!==u);return!1}(l,o)&&(zg(l,o)&&zg(o,l)&&function(u,f){var m=u,y=!1,b=(u.x+f.x)/2,T=(u.y+f.y)/2;do m.y>T!=m.next.y>T&&m.next.y!==m.y&&b<(m.next.x-m.x)*(T-m.y)/(m.next.y-m.y)+m.x&&(y=!y),m=m.next;while(m!==u);return y}(l,o)&&(js(l.prev,l,o.prev)||js(l,o.prev,o))||dy(l,o)&&js(l.prev,l,l.next)>0&&js(o.prev,o,o.next)>0)}function js(l,o,u){return(o.y-l.y)*(u.x-o.x)-(o.x-l.x)*(u.y-o.y)}function dy(l,o){return l.x===o.x&&l.y===o.y}function Wx(l,o,u,f){var m=my(js(l,o,u)),y=my(js(l,o,f)),b=my(js(u,f,l)),T=my(js(u,f,o));return m!==y&&b!==T||!(m!==0||!py(l,u,o))||!(y!==0||!py(l,f,o))||!(b!==0||!py(u,l,f))||!(T!==0||!py(u,o,f))}function py(l,o,u){return o.x<=Math.max(l.x,u.x)&&o.x>=Math.min(l.x,u.x)&&o.y<=Math.max(l.y,u.y)&&o.y>=Math.min(l.y,u.y)}function my(l){return l>0?1:l<0?-1:0}function zg(l,o){return js(l.prev,l,l.next)<0?js(l,o,l.next)>=0&&js(l,l.prev,o)>=0:js(l,o,l.prev)<0||js(l,l.next,o)<0}function Xx(l,o){var u=new T0(l.i,l.x,l.y),f=new T0(o.i,o.x,o.y),m=l.next,y=o.prev;return l.next=o,o.prev=l,u.next=m,m.prev=u,f.next=u,u.prev=f,y.next=f,f.prev=y,f}function Zx(l,o,u,f){var m=new T0(l,o,u);return f?(m.next=f.next,m.prev=f,f.next.prev=m,f.next=m):(m.prev=m,m.next=m),m}function Ug(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function T0(l,o,u){this.i=l,this.x=o,this.y=u,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function S0(l,o,u,f){for(var m=0,y=o,b=u-f;y<u;y+=f)m+=(l[b]-l[y])*(l[y+1]+l[b+1]),b=y;return m}function Rw(l,o,u,f,m){Vg(l,o,u||0,f||l.length-1,m||Yx)}function Vg(l,o,u,f,m){for(;f>u;){if(f-u>600){var y=f-u+1,b=o-u+1,T=Math.log(y),A=.5*Math.exp(2*T/3),L=.5*Math.sqrt(T*A*(y-A)/y)*(b-y/2<0?-1:1);Vg(l,o,Math.max(u,Math.floor(o-b*A/y+L)),Math.min(f,Math.floor(o+(y-b)*A/y+L)),m)}var F=l[o],U=u,j=f;for(Gg(l,u,o),m(l[f],F)>0&&Gg(l,u,f);U<j;){for(Gg(l,U,j),U++,j--;m(l[U],F)<0;)U++;for(;m(l[j],F)>0;)j--}m(l[u],F)===0?Gg(l,u,j):Gg(l,++j,f),j<=o&&(u=j+1),o<=j&&(f=j-1)}}function Gg(l,o,u){var f=l[o];l[o]=l[u],l[u]=f}function Yx(l,o){return l<o?-1:l>o?1:0}function gy(l,o){const u=l.length;if(u<=1)return[l];const f=[];let m,y;for(let b=0;b<u;b++){const T=ln(l[b]);T!==0&&(l[b].area=Math.abs(T),y===void 0&&(y=T<0),y===T<0?(m&&f.push(m),m=[l[b]]):m.push(l[b]))}if(m&&f.push(m),o>1)for(let b=0;b<f.length;b++)f[b].length<=o||(Rw(f[b],o,1,f[b].length-1,C0),f[b]=f[b].slice(0,o));return f}function C0(l,o){return o.area-l.area}function _y(l,o,u){const f=u.patternDependencies;let m=!1;for(const y of o){const b=y.paint.get(`${l}-pattern`);b.isConstant()||(m=!0);const T=b.constantOr(null);T&&(m=!0,f[T]=!0)}return m}function yy(l,o,u,f,m){const y=m.patternDependencies;for(const b of o){const T=b.paint.get(`${l}-pattern`).value;if(T.kind!=="constant"){let A=T.evaluate({zoom:f},u,{},m.availableImages);A=A&&A.name?A.name:A,y[A]=!0,u.patterns[b.id]=A}}return u}({get exports(){return Tm},set exports(l){Tm=l}}).exports=fy,Tm.default=fy,fy.deviation=function(l,o,u,f){var m=o&&o.length,y=Math.abs(S0(l,0,m?o[0]*u:l.length,u));if(m)for(var b=0,T=o.length;b<T;b++)y-=Math.abs(S0(l,o[b]*u,b<T-1?o[b+1]*u:l.length,u));var A=0;for(b=0;b<f.length;b+=3){var L=f[b]*u,F=f[b+1]*u,U=f[b+2]*u;A+=Math.abs((l[L]-l[U])*(l[F+1]-l[L+1])-(l[L]-l[F])*(l[U+1]-l[L+1]))}return y===0&&A===0?0:Math.abs((A-y)/y)},fy.flatten=function(l){for(var o=l[0][0].length,u={vertices:[],holes:[],dimensions:o},f=0,m=0;m<l.length;m++){for(var y=0;y<l[m].length;y++)for(var b=0;b<o;b++)u.vertices.push(l[m][y][b]);m>0&&u.holes.push(f+=l[m-1].length)}return u};class jg{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(u=>u.id),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new oi,this.indexArray=new da,this.indexArray2=new Wh,this.programConfigurations=new yc(o.layers,o.zoom),this.segments=new Gs,this.segments2=new Gs,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.projection=o.projection}populate(o,u,f,m){this.hasPattern=_y("fill",this.layers,u);const y=this.layers[0].layout.get("fill-sort-key"),b=[];for(const{feature:T,id:A,index:L,sourceLayerIndex:F}of o){const U=this.layers[0]._featureFilter.needGeometry,j=kp(T,U);if(!this.layers[0]._featureFilter.filter(new lt(this.zoom),j,f))continue;const Y=y?y.evaluate(j,{},f,u.availableImages):void 0,J={id:A,properties:T.properties,type:T.type,sourceLayerIndex:F,index:L,geometry:U?j.geometry:jf(T,f,m),patterns:{},sortKey:Y};b.push(J)}y&&b.sort((T,A)=>T.sortKey-A.sortKey);for(const T of b){const{geometry:A,index:L,sourceLayerIndex:F}=T;if(this.hasPattern){const U=yy("fill",this.layers,T,this.zoom,u);this.patternFeatures.push(U)}else this.addFeature(T,A,L,f,{},u.availableImages);u.featureIndex.insert(o[L].feature,A,L,F,this.index)}}update(o,u,f,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,u,this.stateDependentLayers,f,m)}addFeatures(o,u,f,m,y){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,u,f,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Iw),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.indexBuffer2=o.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(o,u,f,m,y,b=[]){for(const T of gy(u,500)){let A=0;for(const J of T)A+=J.length;const L=this.segments.prepareSegment(A,this.layoutVertexArray,this.indexArray),F=L.vertexLength,U=[],j=[];for(const J of T){if(J.length===0)continue;J!==T[0]&&j.push(U.length/2);const ee=this.segments2.prepareSegment(J.length,this.layoutVertexArray,this.indexArray2),ce=ee.vertexLength;this.layoutVertexArray.emplaceBack(J[0].x,J[0].y),this.indexArray2.emplaceBack(ce+J.length-1,ce),U.push(J[0].x),U.push(J[0].y);for(let we=1;we<J.length;we++)this.layoutVertexArray.emplaceBack(J[we].x,J[we].y),this.indexArray2.emplaceBack(ce+we-1,ce+we),U.push(J[we].x),U.push(J[we].y);ee.vertexLength+=J.length,ee.primitiveLength+=J.length}const Y=Tm(U,j);for(let J=0;J<Y.length;J+=3)this.indexArray.emplaceBack(F+Y[J],F+Y[J+1],F+Y[J+2]);L.vertexLength+=A,L.primitiveLength+=Y.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,y,b,m)}}Cn(jg,"FillBucket",{omit:["layers","patternFeatures"]});const Kx=new Ht({"fill-sort-key":new yt(wt.layout_fill["fill-sort-key"])});var Dw={paint:new Ht({"fill-antialias":new at(wt.paint_fill["fill-antialias"]),"fill-opacity":new yt(wt.paint_fill["fill-opacity"]),"fill-color":new yt(wt.paint_fill["fill-color"]),"fill-outline-color":new yt(wt.paint_fill["fill-outline-color"]),"fill-translate":new at(wt.paint_fill["fill-translate"]),"fill-translate-anchor":new at(wt.paint_fill["fill-translate-anchor"]),"fill-pattern":new yt(wt.paint_fill["fill-pattern"])}),layout:Kx};const Ow=ni([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Nw=ni([{name:"a_centroid_pos",components:2,type:"Uint16"}]),vy=ni([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:xy}=Ow;var by={},kw=ie,Ey=zp;function zp(l,o,u,f,m){this.properties={},this.extent=u,this.type=0,this._pbf=l,this._geometry=-1,this._keys=f,this._values=m,l.readFields(Fw,this,o)}function Fw(l,o,u){l==1?o.id=u.readVarint():l==2?function(f,m){for(var y=f.readVarint()+f.pos;f.pos<y;){var b=m._keys[f.readVarint()],T=m._values[f.readVarint()];m.properties[b]=T}}(u,o):l==3?o.type=u.readVarint():l==4&&(o._geometry=u.pos)}function Bw(l){for(var o,u,f=0,m=0,y=l.length,b=y-1;m<y;b=m++)f+=((u=l[b]).x-(o=l[m]).x)*(o.y+u.y);return f}zp.types=["Unknown","Point","LineString","Polygon"],zp.prototype.loadGeometry=function(){var l=this._pbf;l.pos=this._geometry;for(var o,u=l.readVarint()+l.pos,f=1,m=0,y=0,b=0,T=[];l.pos<u;){if(m<=0){var A=l.readVarint();f=7&A,m=A>>3}if(m--,f===1||f===2)y+=l.readSVarint(),b+=l.readSVarint(),f===1&&(o&&T.push(o),o=[]),o.push(new kw(y,b));else{if(f!==7)throw new Error("unknown command "+f);o&&o.push(o[0].clone())}}return o&&T.push(o),T},zp.prototype.bbox=function(){var l=this._pbf;l.pos=this._geometry;for(var o=l.readVarint()+l.pos,u=1,f=0,m=0,y=0,b=1/0,T=-1/0,A=1/0,L=-1/0;l.pos<o;){if(f<=0){var F=l.readVarint();u=7&F,f=F>>3}if(f--,u===1||u===2)(m+=l.readSVarint())<b&&(b=m),m>T&&(T=m),(y+=l.readSVarint())<A&&(A=y),y>L&&(L=y);else if(u!==7)throw new Error("unknown command "+u)}return[b,A,T,L]},zp.prototype.toGeoJSON=function(l,o,u){var f,m,y=this.extent*Math.pow(2,u),b=this.extent*l,T=this.extent*o,A=this.loadGeometry(),L=zp.types[this.type];function F(Y){for(var J=0;J<Y.length;J++){var ee=Y[J];Y[J]=[360*(ee.x+b)/y-180,360/Math.PI*Math.atan(Math.exp((180-360*(ee.y+T)/y)*Math.PI/180))-90]}}switch(this.type){case 1:var U=[];for(f=0;f<A.length;f++)U[f]=A[f][0];F(A=U);break;case 2:for(f=0;f<A.length;f++)F(A[f]);break;case 3:for(A=function(Y){var J=Y.length;if(J<=1)return[Y];for(var ee,ce,we=[],Pe=0;Pe<J;Pe++){var be=Bw(Y[Pe]);be!==0&&(ce===void 0&&(ce=be<0),ce===be<0?(ee&&we.push(ee),ee=[Y[Pe]]):ee.push(Y[Pe]))}return ee&&we.push(ee),we}(A),f=0;f<A.length;f++)for(m=0;m<A[f].length;m++)F(A[f][m])}A.length===1?A=A[0]:L="Multi"+L;var j={type:"Feature",geometry:{type:L,coordinates:A},properties:this.properties};return"id"in this&&(j.id=this.id),j};var zw=Ey,Jx=Qx;function Qx(l,o){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(Uw,this,o),this.length=this._features.length}function Uw(l,o,u){l===15?o.version=u.readVarint():l===1?o.name=u.readString():l===5?o.extent=u.readVarint():l===2?o._features.push(u.pos):l===3?o._keys.push(u.readString()):l===4&&o._values.push(function(f){for(var m=null,y=f.readVarint()+f.pos;f.pos<y;){var b=f.readVarint()>>3;m=b===1?f.readString():b===2?f.readFloat():b===3?f.readDouble():b===4?f.readVarint64():b===5?f.readVarint():b===6?f.readSVarint():b===7?f.readBoolean():null}return m}(u))}Qx.prototype.feature=function(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];var o=this._pbf.readVarint()+this._pbf.pos;return new zw(this._pbf,o,this.extent,this._keys,this._values)};var Vw=Jx;function Gw(l,o,u){if(l===3){var f=new Vw(u,u.readVarint()+u.pos);f.length&&(o[f.name]=f)}}var A0=by.VectorTile=function(l,o){this.layers=l.readFields(Gw,{},o)},wy=by.VectorTileFeature=Ey;function Iy(l,o,u,f){const m=[],y=f===0?(b,T,A,L,F,U)=>{b.push(new ie(U,A+(U-T)/(L-T)*(F-A)))}:(b,T,A,L,F,U)=>{b.push(new ie(T+(U-A)/(F-A)*(L-T),U))};for(const b of l){const T=[];for(const A of b){if(A.length<=2)continue;const L=[];for(let j=0;j<A.length-1;j++){const Y=A[j].x,J=A[j].y,ee=A[j+1].x,ce=A[j+1].y,we=f===0?Y:J,Pe=f===0?ee:ce;we<o?Pe>o&&y(L,Y,J,ee,ce,o):we>u?Pe<u&&y(L,Y,J,ee,ce,u):L.push(A[j]),Pe<o&&we>=o&&y(L,Y,J,ee,ce,o),Pe>u&&we<=u&&y(L,Y,J,ee,ce,u)}let F=A[A.length-1];const U=f===0?F.x:F.y;U>=o&&U<=u&&L.push(F),L.length&&(F=L[L.length-1],L[0].x===F.x&&L[0].y===F.y||L.push(L[0]),T.push(L))}T.length&&m.push(T)}return m}by.VectorTileLayer=Jx;const jw=wy.types,ch=Math.pow(2,13);function qg(l,o,u,f,m,y,b,T){l.emplaceBack((o<<1)+b,(u<<1)+y,(Math.floor(f*ch)<<1)+m,Math.round(T))}function Hg(l,o,u){l.emplaceBack(o.x,o.y,o.z,u[0]*16384,u[1]*16384,u[2]*16384)}class kd{constructor(){this.acc=new ie(0,0),this.polyCount=[]}startRing(o){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new ie(o.x,o.y),this.max=new ie(o.x,o.y))}append(o,u){this.currentPolyCount.edges++,this.acc._add(o);const f=this.min,m=this.max;o.x<f.x?f.x=o.x:o.x>m.x&&(m.x=o.x),o.y<f.y?f.y=o.y:o.y>m.y&&(m.y=o.y),((o.x===0||o.x===gi)&&o.x===u.x)!=((o.y===0||o.y===gi)&&o.y===u.y)&&this.processBorderOverlap(o,u),u.x<0!=o.x<0&&this.addBorderIntersection(0,Mi(u.y,o.y,(0-u.x)/(o.x-u.x))),u.x>gi!=o.x>gi&&this.addBorderIntersection(1,Mi(u.y,o.y,(gi-u.x)/(o.x-u.x))),u.y<0!=o.y<0&&this.addBorderIntersection(2,Mi(u.x,o.x,(0-u.y)/(o.y-u.y))),u.y>gi!=o.y>gi&&this.addBorderIntersection(3,Mi(u.x,o.x,(gi-u.y)/(o.y-u.y)))}addBorderIntersection(o,u){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const f=this.borders[o];u<f[0]&&(f[0]=u),u>f[1]&&(f[1]=u)}processBorderOverlap(o,u){if(o.x===u.x){if(o.y===u.y)return;const f=o.x===0?0:1;this.addBorderIntersection(f,u.y),this.addBorderIntersection(f,o.y)}else{const f=o.y===0?2:3;this.addBorderIntersection(f,u.x),this.addBorderIntersection(f,o.x)}}centroid(){const o=this.polyCount.reduce((u,f)=>u+f.edges,0);return o!==0?this.acc.div(o)._round():new ie(0,0)}span(){return new ie(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((o,u)=>o+ +(u[0]!==Number.MAX_VALUE),0)}}class Xi{constructor(o){this.zoom=o.zoom,this.canonical=o.canonical,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(u=>u.id),this.index=o.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=o.projection,this.layoutVertexArray=new qr,this.centroidVertexArray=new H_,this.indexArray=new da,this.programConfigurations=new yc(o.layers,o.zoom),this.segments=new Gs,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.enableTerrain=o.enableTerrain}populate(o,u,f,m){this.features=[],this.hasPattern=_y("fill-extrusion",this.layers,u),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(y){const b=Math.exp(Math.PI*(1-y.y/(1<<y.z)*2));return 80150034*b/(b*b+1)/gi/(1<<y.z)}(f),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:y,id:b,index:T,sourceLayerIndex:A}of o){const L=this.layers[0]._featureFilter.needGeometry,F=kp(y,L);if(!this.layers[0]._featureFilter.filter(new lt(this.zoom),F,f))continue;const U={id:b,sourceLayerIndex:A,index:T,geometry:L?F.geometry:jf(y,f,m),properties:y.properties,type:y.type,patterns:{}},j=this.layoutVertexArray.length;this.hasPattern?this.features.push(yy("fill-extrusion",this.layers,U,this.zoom,u)):this.addFeature(U,U.geometry,T,f,{},u.availableImages,m),u.featureIndex.insert(y,U.geometry,T,A,this.index,j)}this.sortBorders()}addFeatures(o,u,f,m,y){for(const b of this.features){const{geometry:T}=b;this.addFeature(b,T,b.index,u,f,m,y)}this.sortBorders()}update(o,u,f,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,u,this.stateDependentLayers,f,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,xy),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=o.createVertexBuffer(this.layoutVertexExtArray,vy.members,!0))),this.programConfigurations.upload(o),this.uploaded=!0}uploadCentroid(o){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=o.createVertexBuffer(this.centroidVertexArray,Nw.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(o,u,f,m,y,b,T){const A=[new ie(0,0),new ie(gi,gi)],L=T.projection,F=L.name==="globe",U=this.enableTerrain&&!F?new kd:null,j=jw[o.type]==="Polygon";F&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new ru);const Y=gy(u,500);for(let we=Y.length-1;we>=0;we--){const Pe=Y[we];(Pe.length===0||(J=Pe[0]).every(be=>be.x<=0)||J.every(be=>be.x>=gi)||J.every(be=>be.y<=0)||J.every(be=>be.y>=gi))&&Y.splice(we,1)}var J;let ee;if(F)ee=ib(Y,A,m);else{ee=[];for(const we of Y)ee.push({polygon:we,bounds:A})}const ce=j?this.edgeRadius:0;for(const{polygon:we,bounds:Pe}of ee){let be=0,Me=0;for(const ke of we)j&&!ke[0].equals(ke[ke.length-1])&&ke.push(ke[0]),Me+=j?ke.length-1:ke.length;const Ve=this.segments.prepareSegment((j?5:4)*Me,this.layoutVertexArray,this.indexArray);if(j){const ke=[],_t=[];be=Ve.vertexLength;for(const Pt of we){let Jt,bt;Pt.length&&Pt!==we[0]&&_t.push(ke.length/2),Jt=Pt[1].sub(Pt[0])._perp()._unit();for(let Bt=1;Bt<Pt.length;Bt++){const Vt=Pt[Bt],Zt=Pt[Bt===Pt.length-1?1:Bt+1];let{x:$t,y:Et}=Vt;if(ce){bt=Zt.sub(Vt)._perp()._unit();const yn=Jt.add(bt)._unit(),mi=ce*Math.min(4,1/(Jt.x*yn.x+Jt.y*yn.y));$t+=mi*yn.x,Et+=mi*yn.y,Jt=bt}qg(this.layoutVertexArray,$t,Et,0,0,1,1,0),Ve.vertexLength++,ke.push(Vt.x,Vt.y),F&&Hg(this.layoutVertexExtArray,L.projectTilePoint($t,Et,m),L.upVector(m,$t,Et))}}const mt=Tm(ke,_t);for(let Pt=0;Pt<mt.length;Pt+=3)this.indexArray.emplaceBack(be+mt[Pt],be+mt[Pt+2],be+mt[Pt+1]),Ve.primitiveLength++}for(const ke of we){U&&ke.length&&U.startRing(ke[0]);let _t,mt,Pt,Jt=ke.length>4&&qf(ke[ke.length-2],ke[0],ke[1]),bt=ce?cu(ke[ke.length-2],ke[0],ke[1],ce):0;mt=ke[1].sub(ke[0])._perp()._unit();let Bt=!0;for(let Vt=1,Zt=0;Vt<ke.length;Vt++){let $t=ke[Vt-1],Et=ke[Vt];const yn=ke[Vt===ke.length-1?1:Vt+1];if(U&&j&&U.currentPolyCount.top++,eb(Et,$t,Pe)){ce&&(mt=yn.sub(Et)._perp()._unit(),Bt=!Bt);continue}U&&U.append(Et,$t);const mi=Et.sub($t)._perp(),Mn=mi.x/(Math.abs(mi.x)+Math.abs(mi.y)),Jn=mi.y>0?1:0,xn=$t.dist(Et);if(Zt+xn>32768&&(Zt=0),ce){Pt=yn.sub(Et)._perp()._unit();let rr=Do($t,Et,yn,$x(mt,Pt),ce);isNaN(rr)&&(rr=0);const yi=Et.sub($t)._unit();$t=$t.add(yi.mult(bt))._round(),Et=Et.add(yi.mult(-rr))._round(),bt=rr,mt=Pt}const _i=Ve.vertexLength,dr=ke.length>4&&qf($t,Et,yn);let cr=tb(Zt,Jt,Bt);if(qg(this.layoutVertexArray,$t.x,$t.y,Mn,Jn,0,0,cr),qg(this.layoutVertexArray,$t.x,$t.y,Mn,Jn,0,1,cr),Zt+=xn,cr=tb(Zt,dr,!Bt),Jt=dr,qg(this.layoutVertexArray,Et.x,Et.y,Mn,Jn,0,0,cr),qg(this.layoutVertexArray,Et.x,Et.y,Mn,Jn,0,1,cr),Ve.vertexLength+=4,this.indexArray.emplaceBack(_i+0,_i+1,_i+2),this.indexArray.emplaceBack(_i+1,_i+3,_i+2),Ve.primitiveLength+=2,ce){const rr=be+(Vt===1?ke.length-2:Vt-2),yi=Vt===1?be:rr+1;if(this.indexArray.emplaceBack(_i+1,rr,_i+3),this.indexArray.emplaceBack(rr,yi,_i+3),Ve.primitiveLength+=2,_t===void 0&&(_t=_i),!eb(yn,ke[Vt],Pe)){const ss=Vt===ke.length-1?_t:Ve.vertexLength;this.indexArray.emplaceBack(_i+2,_i+3,ss),this.indexArray.emplaceBack(_i+3,ss+1,ss),this.indexArray.emplaceBack(_i+3,yi,ss+1),Ve.primitiveLength+=3}Bt=!Bt}if(F){const rr=this.layoutVertexExtArray,yi=L.projectTilePoint($t.x,$t.y,m),ss=L.projectTilePoint(Et.x,Et.y,m),Ri=L.upVector(m,$t.x,$t.y),pr=L.upVector(m,Et.x,Et.y);Hg(rr,yi,Ri),Hg(rr,yi,Ri),Hg(rr,ss,pr),Hg(rr,ss,pr)}}j&&(be+=ke.length-1)}}if(U&&U.polyCount.length>0){if(U.borders){U.vertexArrayOffset=this.centroidVertexArray.length;const we=U.borders,Pe=this.featuresOnBorder.push(U)-1;for(let be=0;be<4;be++)we[be][0]!==Number.MAX_VALUE&&this.borders[be].push(Pe)}this.encodeCentroid(U.borders?void 0:U.centroid(),U)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,y,b,m)}sortBorders(){for(let o=0;o<4;o++)this.borders[o].sort((u,f)=>this.featuresOnBorder[u].borders[o][0]-this.featuresOnBorder[f].borders[o][0])}encodeCentroid(o,u,f=!0){let m,y;if(o)if(o.y!==0){const T=u.span()._mult(this.tileToMeter);m=(Math.max(o.x,1)<<3)+Math.min(7,Math.round(T.x/10)),y=(Math.max(o.y,1)<<3)+Math.min(7,Math.round(T.y/10))}else m=Math.ceil(7*(o.x+450)),y=0;else m=0,y=+f;let b=f?this.centroidVertexArray.length:u.vertexArrayOffset;for(const T of u.polyCount){f&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*T.edges+T.top);for(let A=0;A<T.top;A++)this.centroidVertexArray.emplace(b++,m,y);for(let A=0;A<2*T.edges;A++)this.centroidVertexArray.emplace(b++,0,y),this.centroidVertexArray.emplace(b++,m,y)}}}function $x(l,o){const u=l.add(o)._unit();return l.x*u.x+l.y*u.y}function cu(l,o,u,f){const m=o.sub(l)._perp()._unit(),y=u.sub(o)._perp()._unit();return Do(l,o,u,$x(m,y),f)}function Do(l,o,u,f,m){const y=Math.sqrt(1-f*f);return Math.min(l.dist(o)/3,o.dist(u)/3,m*y/f)}function eb(l,o,u){return l.x<u[0].x&&o.x<u[0].x||l.x>u[1].x&&o.x>u[1].x||l.y<u[0].y&&o.y<u[0].y||l.y>u[1].y&&o.y>u[1].y}function qf(l,o,u){if(l.x<0||l.x>=gi||o.x<0||o.x>=gi||u.x<0||u.x>=gi)return!1;const f=u.sub(o),m=f.perp(),y=l.sub(o);return(f.x*y.x+f.y*y.y)/Math.sqrt((f.x*f.x+f.y*f.y)*(y.x*y.x+y.y*y.y))>-.866&&m.x*y.x+m.y*y.y<0}function tb(l,o,u){const f=o?2|l:-3&l;return u?1|f:-2&f}function nb(){const l=Math.PI/32,o=Math.tan(l),u=Fg;return u*Math.sqrt(1+2*o*o)-u}function ib(l,o,u){const f=1<<u.z,m=Bu(u.x/f),y=Bu((u.x+1)/f),b=Ra(u.y/f),T=Ra((u.y+1)/f);return function(A,L,F,U,j=0,Y){const J=[];if(!A.length||!F||!U)return J;const ee=(ke,_t)=>{for(const mt of ke)J.push({polygon:mt,bounds:_t})},ce=Math.ceil(Math.log2(F)),we=Math.ceil(Math.log2(U)),Pe=ce-we,be=[];for(let ke=0;ke<Math.abs(Pe);ke++)be.push(Pe>0?0:1);for(let ke=0;ke<Math.min(ce,we);ke++)be.push(0),be.push(1);let Me=A;if(Me=Iy(Me,L[0].y-j,L[1].y+j,1),Me=Iy(Me,L[0].x-j,L[1].x+j,0),!Me.length)return J;const Ve=[];for(be.length?Ve.push({polygons:Me,bounds:L,depth:0}):ee(Me,L);Ve.length;){const ke=Ve.pop(),_t=ke.depth,mt=be[_t],Pt=ke.bounds[0],Jt=ke.bounds[1],bt=mt===0?Pt.x:Pt.y,Bt=mt===0?Jt.x:Jt.y,Vt=Y?Y(mt,bt,Bt):.5*(bt+Bt),Zt=Iy(ke.polygons,bt-j,Vt+j,mt),$t=Iy(ke.polygons,Vt-j,Bt+j,mt);if(Zt.length){const Et=[Pt,new ie(mt===0?Vt:Jt.x,mt===1?Vt:Jt.y)];be.length>_t+1?Ve.push({polygons:Zt,bounds:Et,depth:_t+1}):ee(Zt,Et)}if($t.length){const Et=[new ie(mt===0?Vt:Pt.x,mt===1?Vt:Pt.y),Jt];be.length>_t+1?Ve.push({polygons:$t,bounds:Et,depth:_t+1}):ee($t,Et)}}return J}(l,o,Math.ceil((y-m)/11.25),Math.ceil((b-T)/11.25),1,(A,L,F)=>{if(A===0)return .5*(L+F);{const U=Ra((u.y+L/gi)/f);return(Qh(.5*(Ra((u.y+F/gi)/f)+U))*f-u.y)*gi}})}Cn(Xi,"FillExtrusionBucket",{omit:["layers","features"]}),Cn(kd,"PartMetadata");const qw=new Ht({"fill-extrusion-edge-radius":new at(wt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var Hw={paint:new Ht({"fill-extrusion-opacity":new at(wt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new yt(wt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new at(wt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new at(wt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new yt(wt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new yt(wt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new yt(wt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new at(wt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new at(wt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new at(wt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:qw};function Ty(l,o,u){var f=2*Math.PI*6378137/256/Math.pow(2,u);return[l*f-2*Math.PI*6378137/2,o*f-2*Math.PI*6378137/2]}class Sy{constructor(o,u,f){this.z=o,this.x=u,this.y=f,this.key=Fd(0,o,o,u,f)}equals(o){return this.z===o.z&&this.x===o.x&&this.y===o.y}url(o,u){const f=function(y,b,T){var A=Ty(256*y,256*(b=Math.pow(2,T)-b-1),T),L=Ty(256*(y+1),256*(b+1),T);return A[0]+","+A[1]+","+L[0]+","+L[1]}(this.x,this.y,this.z),m=function(y,b,T){let A,L="";for(let F=y;F>0;F--)A=1<<F-1,L+=(b&A?1:0)+(T&A?2:0);return L}(this.z,this.x,this.y);return o[(this.x+this.y)%o.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",m).replace("{bbox-epsg-3857}",f)}toString(){return`${this.z}/${this.x}/${this.y}`}}class $h{constructor(o,u){this.wrap=o,this.canonical=u,this.key=Fd(o,u.z,u.z,u.x,u.y)}}class nl{constructor(o,u,f,m,y){this.overscaledZ=o,this.wrap=u,this.canonical=new Sy(f,+m,+y),this.key=u===0&&o===f?this.canonical.key:Fd(u,o,f,m,y)}equals(o){return this.overscaledZ===o.overscaledZ&&this.wrap===o.wrap&&this.canonical.equals(o.canonical)}scaledTo(o){const u=this.canonical.z-o;return o>this.canonical.z?new nl(o,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new nl(o,this.wrap,o,this.canonical.x>>u,this.canonical.y>>u)}calculateScaledKey(o,u=!0){if(this.overscaledZ===o&&u)return this.key;if(o>this.canonical.z)return Fd(this.wrap*+u,o,this.canonical.z,this.canonical.x,this.canonical.y);{const f=this.canonical.z-o;return Fd(this.wrap*+u,o,o,this.canonical.x>>f,this.canonical.y>>f)}}isChildOf(o){if(o.wrap!==this.wrap)return!1;const u=this.canonical.z-o.canonical.z;return o.overscaledZ===0||o.overscaledZ<this.overscaledZ&&o.canonical.x===this.canonical.x>>u&&o.canonical.y===this.canonical.y>>u}children(o){if(this.overscaledZ>=o)return[new nl(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const u=this.canonical.z+1,f=2*this.canonical.x,m=2*this.canonical.y;return[new nl(u,this.wrap,u,f,m),new nl(u,this.wrap,u,f+1,m),new nl(u,this.wrap,u,f,m+1),new nl(u,this.wrap,u,f+1,m+1)]}isLessThan(o){return this.wrap<o.wrap||!(this.wrap>o.wrap)&&(this.overscaledZ<o.overscaledZ||!(this.overscaledZ>o.overscaledZ)&&(this.canonical.x<o.canonical.x||!(this.canonical.x>o.canonical.x)&&this.canonical.y<o.canonical.y))}wrapped(){return new nl(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(o){return new nl(this.overscaledZ,o,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new $h(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Fd(l,o,u,f,m){const y=1<<Math.min(u,22);let b=y*(m%y)+f%y;return l&&u<22&&(b+=y*y*((l<0?-2*l-1:2*l)%(1<<2*(22-u)))),16*(32*b+u)+(o-u)}Cn(Sy,"CanonicalTileID"),Cn(nl,"OverscaledTileID",{omit:["projMatrix"]});class Cs extends ie{constructor(o,u,f){super(o,u),this.z=f}}function qs(l,o){return l.x*o.x+l.y*o.y}function M0(l,o){if(l.length===1){let u=0;const f=o[u++];let m;for(;!m||f.equals(m);)if(m=o[u++],!m)return 1/0;for(;u<o.length;u++){const y=o[u],b=l[0],T=m.sub(f),A=y.sub(f),L=b.sub(f),F=qs(T,T),U=qs(T,A),j=qs(A,A),Y=qs(L,T),J=qs(L,A),ee=F*j-U*U,ce=(j*Y-U*J)/ee,we=(F*J-U*Y)/ee,Pe=f.z*(1-ce-we)+m.z*ce+y.z*we;if(isFinite(Pe))return Pe}return 1/0}{let u=1/0;for(const f of o)u=Math.min(u,f.z);return u}}function rb(l,o,u,f,m,y,b,T){const A=b*m.getElevationAt(l,o,!0,!0),L=y[0]!==0,F=L?y[1]===0?b*(y[0]/7-450):b*function(U,j,Y){const J=Math.floor(j[0]/8),ee=Math.floor(j[1]/8),ce=10*(j[0]-8*J),we=10*(j[1]-8*ee),Pe=U.getElevationAt(J,ee,!0,!0),be=U.getMeterToDEM(Y),Me=Math.floor(.5*(ce*be-1)),Ve=Math.floor(.5*(we*be-1)),ke=U.tileCoordToPixel(J,ee),_t=2*Me+1,mt=2*Ve+1,Pt=function($t,Et,yn,mi,Mn){return[$t.getElevationAtPixel(Et,yn,!0),$t.getElevationAtPixel(Et+Mn,yn,!0),$t.getElevationAtPixel(Et,yn+Mn,!0),$t.getElevationAtPixel(Et+mi,yn+Mn,!0)]}(U,ke.x-Me,ke.y-Ve,_t,mt),Jt=Math.abs(Pt[0]-Pt[1]),bt=Math.abs(Pt[2]-Pt[3]),Bt=Math.abs(Pt[0]-Pt[2])+Math.abs(Pt[1]-Pt[3]),Vt=Math.min(.25,.5*be*(Jt+bt)/_t),Zt=Math.min(.25,.5*be*Bt/mt);return Pe+Math.max(Vt*ce,Zt*we)}(m,y,T):A;return{base:A+(u===0)?-1:u,top:L?Math.max(F+f,A+u+2):A+f}}const Ww=ni([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Xw}=Ww,Zw=ni([{name:"a_packed",components:4,type:"Float32"}]),{members:Yw}=Zw,Kw=wy.types,sb=Math.cos(Math.PI/180*37.5);class Bd{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(u=>u.id),this.index=o.index,this.projection=o.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(u=>{this.gradients[u.id]={}}),this.layoutVertexArray=new cs,this.layoutVertexArray2=new Jr,this.indexArray=new da,this.programConfigurations=new yc(o.layers,o.zoom),this.segments=new Gs,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(o,u,f,m){this.hasPattern=_y("line",this.layers,u);const y=this.layers[0].layout.get("line-sort-key"),b=[];for(const{feature:F,id:U,index:j,sourceLayerIndex:Y}of o){const J=this.layers[0]._featureFilter.needGeometry,ee=kp(F,J);if(!this.layers[0]._featureFilter.filter(new lt(this.zoom),ee,f))continue;const ce=y?y.evaluate(ee,{},f):void 0,we={id:U,properties:F.properties,type:F.type,sourceLayerIndex:Y,index:j,geometry:J?ee.geometry:jf(F,f,m),patterns:{},sortKey:ce};b.push(we)}y&&b.sort((F,U)=>F.sortKey-U.sortKey);const{lineAtlas:T,featureIndex:A}=u,L=this.addConstantDashes(T);for(const F of b){const{geometry:U,index:j,sourceLayerIndex:Y}=F;if(L&&this.addFeatureDashes(F,T),this.hasPattern){const J=yy("line",this.layers,F,this.zoom,u);this.patternFeatures.push(J)}else this.addFeature(F,U,j,f,T.positions,u.availableImages);A.insert(o[j].feature,U,j,Y,this.index)}}addConstantDashes(o){let u=!1;for(const f of this.layers){const m=f.paint.get("line-dasharray").value,y=f.layout.get("line-cap").value;if(m.kind!=="constant"||y.kind!=="constant")u=!0;else{const b=y.value,T=m.value;if(!T)continue;o.addDash(T,b)}}return u}addFeatureDashes(o,u){const f=this.zoom;for(const m of this.layers){const y=m.paint.get("line-dasharray").value,b=m.layout.get("line-cap").value;if(y.kind==="constant"&&b.kind==="constant")continue;let T,A;if(y.kind==="constant"){if(T=y.value,!T)continue}else T=y.evaluate({zoom:f},o);A=b.kind==="constant"?b.value:b.evaluate({zoom:f},o),u.addDash(T,A),o.patterns[m.id]=u.getKey(T,A)}}update(o,u,f,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,u,this.stateDependentLayers,f,m)}addFeatures(o,u,f,m,y){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,u,f,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=o.createVertexBuffer(this.layoutVertexArray2,Yw)),this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Xw),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(o){if(o.properties&&o.properties.hasOwnProperty("mapbox_clip_start")&&o.properties.hasOwnProperty("mapbox_clip_end"))return{start:+o.properties.mapbox_clip_start,end:+o.properties.mapbox_clip_end}}addFeature(o,u,f,m,y,b){const T=this.layers[0].layout,A=T.get("line-join").evaluate(o,{}),L=T.get("line-cap").evaluate(o,{}),F=T.get("line-miter-limit"),U=T.get("line-round-limit");this.lineClips=this.lineFeatureClips(o);for(const j of u)this.addLine(j,o,A,L,F,U);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,y,b,m)}addLine(o,u,f,m,y,b){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let we=0;we<o.length-1;we++)this.totalDistance+=o[we].dist(o[we+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const T=Kw[u.type]==="Polygon";let A=o.length;for(;A>=2&&o[A-1].equals(o[A-2]);)A--;let L=0;for(;L<A-1&&o[L].equals(o[L+1]);)L++;if(A<(T?3:2))return;f==="bevel"&&(y=1.05);const F=this.overscaling<=16?122880/(512*this.overscaling):0,U=this.segments.prepareSegment(10*A,this.layoutVertexArray,this.indexArray);let j,Y,J,ee,ce;this.e1=this.e2=-1,T&&(j=o[A-2],ce=o[L].sub(j)._unit()._perp());for(let we=L;we<A;we++){if(J=we===A-1?T?o[L+1]:void 0:o[we+1],J&&o[we].equals(J))continue;ce&&(ee=ce),j&&(Y=j),j=o[we],ce=J?J.sub(j)._unit()._perp():ee,ee=ee||ce;let Pe=ee.add(ce);Pe.x===0&&Pe.y===0||Pe._unit();const be=ee.x*ce.x+ee.y*ce.y,Me=Pe.x*ce.x+Pe.y*ce.y,Ve=Me!==0?1/Me:1/0,ke=2*Math.sqrt(2-2*Me),_t=Me<sb&&Y&&J,mt=ee.x*ce.y-ee.y*ce.x>0;if(_t&&we>L){const bt=j.dist(Y);if(bt>2*F){const Bt=j.sub(j.sub(Y)._mult(F/bt)._round());this.updateDistance(Y,Bt),this.addCurrentVertex(Bt,ee,0,0,U),Y=Bt}}const Pt=Y&&J;let Jt=Pt?f:T?"butt":m;if(Pt&&Jt==="round"&&(Ve<b?Jt="miter":Ve<=2&&(Jt="fakeround")),Jt==="miter"&&Ve>y&&(Jt="bevel"),Jt==="bevel"&&(Ve>2&&(Jt="flipbevel"),Ve<y&&(Jt="miter")),Y&&this.updateDistance(Y,j),Jt==="miter")Pe._mult(Ve),this.addCurrentVertex(j,Pe,0,0,U);else if(Jt==="flipbevel"){if(Ve>100)Pe=ce.mult(-1);else{const bt=Ve*ee.add(ce).mag()/ee.sub(ce).mag();Pe._perp()._mult(bt*(mt?-1:1))}this.addCurrentVertex(j,Pe,0,0,U),this.addCurrentVertex(j,Pe.mult(-1),0,0,U)}else if(Jt==="bevel"||Jt==="fakeround"){const bt=-Math.sqrt(Ve*Ve-1),Bt=mt?bt:0,Vt=mt?0:bt;if(Y&&this.addCurrentVertex(j,ee,Bt,Vt,U),Jt==="fakeround"){const Zt=Math.round(180*ke/Math.PI/20);for(let $t=1;$t<Zt;$t++){let Et=$t/Zt;if(Et!==.5){const mi=Et-.5;Et+=Et*mi*(Et-1)*((1.0904+be*(be*(3.55645-1.43519*be)-3.2452))*mi*mi+(.848013+be*(.215638*be-1.06021)))}const yn=ce.sub(ee)._mult(Et)._add(ee)._unit()._mult(mt?-1:1);this.addHalfVertex(j,yn.x,yn.y,!1,mt,0,U)}}J&&this.addCurrentVertex(j,ce,-Bt,-Vt,U)}else if(Jt==="butt")this.addCurrentVertex(j,Pe,0,0,U);else if(Jt==="square"){const bt=Y?1:-1;Y||this.addCurrentVertex(j,Pe,bt,bt,U),this.addCurrentVertex(j,Pe,0,0,U),Y&&this.addCurrentVertex(j,Pe,bt,bt,U)}else Jt==="round"&&(Y&&(this.addCurrentVertex(j,ee,0,0,U),this.addCurrentVertex(j,ee,1,1,U,!0)),J&&(this.addCurrentVertex(j,ce,-1,-1,U,!0),this.addCurrentVertex(j,ce,0,0,U)));if(_t&&we<A-1){const bt=j.dist(J);if(bt>2*F){const Bt=j.add(J.sub(j)._mult(F/bt)._round());this.updateDistance(j,Bt),this.addCurrentVertex(Bt,ce,0,0,U),j=Bt}}}}addCurrentVertex(o,u,f,m,y,b=!1){const T=u.y*m-u.x,A=-u.y-u.x*m;this.addHalfVertex(o,u.x+u.y*f,u.y-u.x*f,b,!1,f,y),this.addHalfVertex(o,T,A,b,!0,-m,y)}addHalfVertex({x:o,y:u},f,m,y,b,T,A){this.layoutVertexArray.emplaceBack((o<<1)+(y?1:0),(u<<1)+(b?1:0),Math.round(63*f)+128,Math.round(63*m)+128,1+(T===0?0:T<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const L=A.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,L),A.primitiveLength++),b?this.e2=L:this.e1=L}updateScaledDistance(){if(this.lineClips){const o=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=o*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(o,u){this.distance+=o.dist(u),this.updateScaledDistance()}}Cn(Bd,"LineBucket",{omit:["layers","patternFeatures"]});const L0=new Ht({"line-cap":new yt(wt.layout_line["line-cap"]),"line-join":new yt(wt.layout_line["line-join"]),"line-miter-limit":new at(wt.layout_line["line-miter-limit"]),"line-round-limit":new at(wt.layout_line["line-round-limit"]),"line-sort-key":new yt(wt.layout_line["line-sort-key"])});var ob={paint:new Ht({"line-opacity":new yt(wt.paint_line["line-opacity"]),"line-color":new yt(wt.paint_line["line-color"]),"line-translate":new at(wt.paint_line["line-translate"]),"line-translate-anchor":new at(wt.paint_line["line-translate-anchor"]),"line-width":new yt(wt.paint_line["line-width"]),"line-gap-width":new yt(wt.paint_line["line-gap-width"]),"line-offset":new yt(wt.paint_line["line-offset"]),"line-blur":new yt(wt.paint_line["line-blur"]),"line-dasharray":new yt(wt.paint_line["line-dasharray"]),"line-pattern":new yt(wt.paint_line["line-pattern"]),"line-gradient":new Gt(wt.paint_line["line-gradient"]),"line-trim-offset":new at(wt.paint_line["line-trim-offset"])}),layout:L0};const P0=new class extends yt{possiblyEvaluate(l,o){return o=new lt(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,transition:o.transition}),super.possiblyEvaluate(l,o)}evaluate(l,o,u,f){return o=At({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(l,o,u,f)}}(ob.paint.properties["line-width"].specification);function Wg(l,o){return o>0?o+2*l:l}P0.useIntegerZoom=!0;const zu=ni([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Cm=ni([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Jw=ni([{name:"a_projected_pos",components:4,type:"Float32"}],4);ni([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Qw=ni([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),$w=ni([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);ni([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const ab=ni([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),eI=ni([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ni([{name:"triangle",components:3,type:"Uint16"}]),ni([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ni([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ni([{type:"Float32",name:"offsetX"}]),ni([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var ma=24;const Da=128;function ur(l,o){const{expression:u}=o;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new lt(l+1))};if(u.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:m}=u;let y=0;for(;y<f.length&&f[y]<=l;)y++;y=Math.max(0,y-1);let b=y;for(;b<f.length&&f[b]<l+1;)b++;b=Math.min(f.length-1,b);const T=f[y],A=f[b];return u.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:A,interpolationType:m}:{kind:"camera",minZoom:T,maxZoom:A,minSize:u.evaluate(new lt(T)),maxSize:u.evaluate(new lt(A)),interpolationType:m}}}function Xg(l,{uSize:o,uSizeT:u},{lowerSize:f,upperSize:m}){return l.kind==="source"?f/Da:l.kind==="composite"?Mi(f/Da,m/Da,u):o}function il(l,o){let u=0,f=0;if(l.kind==="constant")f=l.layoutSize;else if(l.kind!=="source"){const{interpolationType:m,minZoom:y,maxZoom:b}=l,T=m?nt(dl.interpolationFactor(m,o,y,b),0,1):0;l.kind==="camera"?f=Mi(l.minSize,l.maxSize,T):u=T}return{uSizeT:u,uSize:f}}var lb=Object.freeze({__proto__:null,getSizeData:ur,evaluateSizeForFeature:Xg,evaluateSizeForZoom:il,SIZE_PACK_FACTOR:Da});function tI(l,o,u){return l.sections.forEach(f=>{f.text=function(m,y,b){const T=y.layout.get("text-transform").evaluate(b,{});return T==="uppercase"?m=m.toLocaleUpperCase():T==="lowercase"&&(m=m.toLocaleLowerCase()),qe.applyArabicShaping&&(m=qe.applyArabicShaping(m)),m}(f.text,o,u)}),l}const Qr={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function nI(l){return l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""}function ub(l){return l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""}var zd=hs,cb=function(l,o,u,f,m){var y,b,T=8*m-f-1,A=(1<<T)-1,L=A>>1,F=-7,U=u?m-1:0,j=u?-1:1,Y=l[o+U];for(U+=j,y=Y&(1<<-F)-1,Y>>=-F,F+=T;F>0;y=256*y+l[o+U],U+=j,F-=8);for(b=y&(1<<-F)-1,y>>=-F,F+=f;F>0;b=256*b+l[o+U],U+=j,F-=8);if(y===0)y=1-L;else{if(y===A)return b?NaN:1/0*(Y?-1:1);b+=Math.pow(2,f),y-=L}return(Y?-1:1)*b*Math.pow(2,y-f)},hb=function(l,o,u,f,m,y){var b,T,A,L=8*y-m-1,F=(1<<L)-1,U=F>>1,j=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,Y=f?0:y-1,J=f?1:-1,ee=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(T=isNaN(o)?1:0,b=F):(b=Math.floor(Math.log(o)/Math.LN2),o*(A=Math.pow(2,-b))<1&&(b--,A*=2),(o+=b+U>=1?j/A:j*Math.pow(2,1-U))*A>=2&&(b++,A/=2),b+U>=F?(T=0,b=F):b+U>=1?(T=(o*A-1)*Math.pow(2,m),b+=U):(T=o*Math.pow(2,U-1)*Math.pow(2,m),b=0));m>=8;l[u+Y]=255&T,Y+=J,T/=256,m-=8);for(b=b<<m|T,L+=m;L>0;l[u+Y]=255&b,Y+=J,b/=256,L-=8);l[u+Y-J]|=128*ee};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function hs(l){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(l)?l:new Uint8Array(l||0),this.pos=0,this.type=0,this.length=this.buf.length}hs.Varint=0,hs.Fixed64=1,hs.Bytes=2,hs.Fixed32=5;var R0=4294967296,fb=1/R0,db=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Hf(l){return l.type===hs.Bytes?l.readVarint()+l.pos:l.pos+1}function Am(l,o,u){return u?4294967296*o+(l>>>0):4294967296*(o>>>0)+(l>>>0)}function pb(l,o,u){var f=o<=16383?1:o<=2097151?2:o<=268435455?3:Math.floor(Math.log(o)/(7*Math.LN2));u.realloc(f);for(var m=u.pos-1;m>=l;m--)u.buf[m+f]=u.buf[m]}function iI(l,o){for(var u=0;u<l.length;u++)o.writeVarint(l[u])}function rI(l,o){for(var u=0;u<l.length;u++)o.writeSVarint(l[u])}function sI(l,o){for(var u=0;u<l.length;u++)o.writeFloat(l[u])}function oI(l,o){for(var u=0;u<l.length;u++)o.writeDouble(l[u])}function D0(l,o){for(var u=0;u<l.length;u++)o.writeBoolean(l[u])}function aI(l,o){for(var u=0;u<l.length;u++)o.writeFixed32(l[u])}function O0(l,o){for(var u=0;u<l.length;u++)o.writeSFixed32(l[u])}function lI(l,o){for(var u=0;u<l.length;u++)o.writeFixed64(l[u])}function uI(l,o){for(var u=0;u<l.length;u++)o.writeSFixed64(l[u])}function Cy(l,o){return(l[o]|l[o+1]<<8|l[o+2]<<16)+16777216*l[o+3]}function yo(l,o,u){l[u]=o,l[u+1]=o>>>8,l[u+2]=o>>>16,l[u+3]=o>>>24}function jl(l,o){return(l[o]|l[o+1]<<8|l[o+2]<<16)+(l[o+3]<<24)}function cI(l,o,u){o.glyphs=[],l===1&&u.readMessage(hI,o)}function hI(l,o,u){if(l===3){const{id:f,bitmap:m,width:y,height:b,left:T,top:A,advance:L}=u.readMessage(fI,{});o.glyphs.push({id:f,bitmap:new bc({width:y+6,height:b+6},m),metrics:{width:y,height:b,left:T,top:A,advance:L}})}else l===4?o.ascender=u.readSVarint():l===5&&(o.descender=u.readSVarint())}function fI(l,o,u){l===1?o.id=u.readVarint():l===2?o.bitmap=u.readBytes():l===3?o.width=u.readVarint():l===4?o.height=u.readVarint():l===5?o.left=u.readSVarint():l===6?o.top=u.readSVarint():l===7&&(o.advance=u.readVarint())}function Ay(l){let o=0,u=0;for(const b of l)o+=b.w*b.h,u=Math.max(u,b.w);l.sort((b,T)=>T.h-b.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),u),h:1/0}];let m=0,y=0;for(const b of l)for(let T=f.length-1;T>=0;T--){const A=f[T];if(!(b.w>A.w||b.h>A.h)){if(b.x=A.x,b.y=A.y,y=Math.max(y,b.y+b.h),m=Math.max(m,b.x+b.w),b.w===A.w&&b.h===A.h){const L=f.pop();T<f.length&&(f[T]=L)}else b.h===A.h?(A.x+=b.w,A.w-=b.w):b.w===A.w?(A.y+=b.h,A.h-=b.h):(f.push({x:A.x+b.w,y:A.y,w:A.w-b.w,h:b.h}),A.y+=b.h,A.h-=b.h);break}}return{w:m,h:y,fill:o/(m*y)||0}}hs.prototype={destroy:function(){this.buf=null},readFields:function(l,o,u){for(u=u||this.length;this.pos<u;){var f=this.readVarint(),m=f>>3,y=this.pos;this.type=7&f,l(m,o,this),this.pos===y&&this.skip(f)}return o},readMessage:function(l,o){return this.readFields(l,o,this.readVarint()+this.pos)},readFixed32:function(){var l=Cy(this.buf,this.pos);return this.pos+=4,l},readSFixed32:function(){var l=jl(this.buf,this.pos);return this.pos+=4,l},readFixed64:function(){var l=Cy(this.buf,this.pos)+Cy(this.buf,this.pos+4)*R0;return this.pos+=8,l},readSFixed64:function(){var l=Cy(this.buf,this.pos)+jl(this.buf,this.pos+4)*R0;return this.pos+=8,l},readFloat:function(){var l=cb(this.buf,this.pos,!0,23,4);return this.pos+=4,l},readDouble:function(){var l=cb(this.buf,this.pos,!0,52,8);return this.pos+=8,l},readVarint:function(l){var o,u,f=this.buf;return o=127&(u=f[this.pos++]),u<128?o:(o|=(127&(u=f[this.pos++]))<<7,u<128?o:(o|=(127&(u=f[this.pos++]))<<14,u<128?o:(o|=(127&(u=f[this.pos++]))<<21,u<128?o:function(m,y,b){var T,A,L=b.buf;if(T=(112&(A=L[b.pos++]))>>4,A<128||(T|=(127&(A=L[b.pos++]))<<3,A<128)||(T|=(127&(A=L[b.pos++]))<<10,A<128)||(T|=(127&(A=L[b.pos++]))<<17,A<128)||(T|=(127&(A=L[b.pos++]))<<24,A<128)||(T|=(1&(A=L[b.pos++]))<<31,A<128))return Am(m,T,y);throw new Error("Expected varint not more than 10 bytes")}(o|=(15&(u=f[this.pos]))<<28,l,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var l=this.readVarint();return l%2==1?(l+1)/-2:l/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var l=this.readVarint()+this.pos,o=this.pos;return this.pos=l,l-o>=12&&db?function(u,f,m){return db.decode(u.subarray(f,m))}(this.buf,o,l):function(u,f,m){for(var y="",b=f;b<m;){var T,A,L,F=u[b],U=null,j=F>239?4:F>223?3:F>191?2:1;if(b+j>m)break;j===1?F<128&&(U=F):j===2?(192&(T=u[b+1]))==128&&(U=(31&F)<<6|63&T)<=127&&(U=null):j===3?(A=u[b+2],(192&(T=u[b+1]))==128&&(192&A)==128&&((U=(15&F)<<12|(63&T)<<6|63&A)<=2047||U>=55296&&U<=57343)&&(U=null)):j===4&&(A=u[b+2],L=u[b+3],(192&(T=u[b+1]))==128&&(192&A)==128&&(192&L)==128&&((U=(15&F)<<18|(63&T)<<12|(63&A)<<6|63&L)<=65535||U>=1114112)&&(U=null)),U===null?(U=65533,j=1):U>65535&&(U-=65536,y+=String.fromCharCode(U>>>10&1023|55296),U=56320|1023&U),y+=String.fromCharCode(U),b+=j}return y}(this.buf,o,l)},readBytes:function(){var l=this.readVarint()+this.pos,o=this.buf.subarray(this.pos,l);return this.pos=l,o},readPackedVarint:function(l,o){if(this.type!==hs.Bytes)return l.push(this.readVarint(o));var u=Hf(this);for(l=l||[];this.pos<u;)l.push(this.readVarint(o));return l},readPackedSVarint:function(l){if(this.type!==hs.Bytes)return l.push(this.readSVarint());var o=Hf(this);for(l=l||[];this.pos<o;)l.push(this.readSVarint());return l},readPackedBoolean:function(l){if(this.type!==hs.Bytes)return l.push(this.readBoolean());var o=Hf(this);for(l=l||[];this.pos<o;)l.push(this.readBoolean());return l},readPackedFloat:function(l){if(this.type!==hs.Bytes)return l.push(this.readFloat());var o=Hf(this);for(l=l||[];this.pos<o;)l.push(this.readFloat());return l},readPackedDouble:function(l){if(this.type!==hs.Bytes)return l.push(this.readDouble());var o=Hf(this);for(l=l||[];this.pos<o;)l.push(this.readDouble());return l},readPackedFixed32:function(l){if(this.type!==hs.Bytes)return l.push(this.readFixed32());var o=Hf(this);for(l=l||[];this.pos<o;)l.push(this.readFixed32());return l},readPackedSFixed32:function(l){if(this.type!==hs.Bytes)return l.push(this.readSFixed32());var o=Hf(this);for(l=l||[];this.pos<o;)l.push(this.readSFixed32());return l},readPackedFixed64:function(l){if(this.type!==hs.Bytes)return l.push(this.readFixed64());var o=Hf(this);for(l=l||[];this.pos<o;)l.push(this.readFixed64());return l},readPackedSFixed64:function(l){if(this.type!==hs.Bytes)return l.push(this.readSFixed64());var o=Hf(this);for(l=l||[];this.pos<o;)l.push(this.readSFixed64());return l},skip:function(l){var o=7&l;if(o===hs.Varint)for(;this.buf[this.pos++]>127;);else if(o===hs.Bytes)this.pos=this.readVarint()+this.pos;else if(o===hs.Fixed32)this.pos+=4;else{if(o!==hs.Fixed64)throw new Error("Unimplemented type: "+o);this.pos+=8}},writeTag:function(l,o){this.writeVarint(l<<3|o)},realloc:function(l){for(var o=this.length||16;o<this.pos+l;)o*=2;if(o!==this.length){var u=new Uint8Array(o);u.set(this.buf),this.buf=u,this.length=o}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(l){this.realloc(4),yo(this.buf,l,this.pos),this.pos+=4},writeSFixed32:function(l){this.realloc(4),yo(this.buf,l,this.pos),this.pos+=4},writeFixed64:function(l){this.realloc(8),yo(this.buf,-1&l,this.pos),yo(this.buf,Math.floor(l*fb),this.pos+4),this.pos+=8},writeSFixed64:function(l){this.realloc(8),yo(this.buf,-1&l,this.pos),yo(this.buf,Math.floor(l*fb),this.pos+4),this.pos+=8},writeVarint:function(l){(l=+l||0)>268435455||l<0?function(o,u){var f,m;if(o>=0?(f=o%4294967296|0,m=o/4294967296|0):(m=~(-o/4294967296),4294967295^(f=~(-o%4294967296))?f=f+1|0:(f=0,m=m+1|0)),o>=18446744073709552e3||o<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(y,b,T){T.buf[T.pos++]=127&y|128,y>>>=7,T.buf[T.pos++]=127&y|128,y>>>=7,T.buf[T.pos++]=127&y|128,y>>>=7,T.buf[T.pos++]=127&y|128,T.buf[T.pos]=127&(y>>>=7)}(f,0,u),function(y,b){var T=(7&y)<<4;b.buf[b.pos++]|=T|((y>>>=3)?128:0),y&&(b.buf[b.pos++]=127&y|((y>>>=7)?128:0),y&&(b.buf[b.pos++]=127&y|((y>>>=7)?128:0),y&&(b.buf[b.pos++]=127&y|((y>>>=7)?128:0),y&&(b.buf[b.pos++]=127&y|((y>>>=7)?128:0),y&&(b.buf[b.pos++]=127&y)))))}(m,u)}(l,this):(this.realloc(4),this.buf[this.pos++]=127&l|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=l>>>7&127))))},writeSVarint:function(l){this.writeVarint(l<0?2*-l-1:2*l)},writeBoolean:function(l){this.writeVarint(!!l)},writeString:function(l){l=String(l),this.realloc(4*l.length),this.pos++;var o=this.pos;this.pos=function(f,m,y){for(var b,T,A=0;A<m.length;A++){if((b=m.charCodeAt(A))>55295&&b<57344){if(!T){b>56319||A+1===m.length?(f[y++]=239,f[y++]=191,f[y++]=189):T=b;continue}if(b<56320){f[y++]=239,f[y++]=191,f[y++]=189,T=b;continue}b=T-55296<<10|b-56320|65536,T=null}else T&&(f[y++]=239,f[y++]=191,f[y++]=189,T=null);b<128?f[y++]=b:(b<2048?f[y++]=b>>6|192:(b<65536?f[y++]=b>>12|224:(f[y++]=b>>18|240,f[y++]=b>>12&63|128),f[y++]=b>>6&63|128),f[y++]=63&b|128)}return y}(this.buf,l,this.pos);var u=this.pos-o;u>=128&&pb(o,u,this),this.pos=o-1,this.writeVarint(u),this.pos+=u},writeFloat:function(l){this.realloc(4),hb(this.buf,l,this.pos,!0,23,4),this.pos+=4},writeDouble:function(l){this.realloc(8),hb(this.buf,l,this.pos,!0,52,8),this.pos+=8},writeBytes:function(l){var o=l.length;this.writeVarint(o),this.realloc(o);for(var u=0;u<o;u++)this.buf[this.pos++]=l[u]},writeRawMessage:function(l,o){this.pos++;var u=this.pos;l(o,this);var f=this.pos-u;f>=128&&pb(u,f,this),this.pos=u-1,this.writeVarint(f),this.pos+=f},writeMessage:function(l,o,u){this.writeTag(l,hs.Bytes),this.writeRawMessage(o,u)},writePackedVarint:function(l,o){o.length&&this.writeMessage(l,iI,o)},writePackedSVarint:function(l,o){o.length&&this.writeMessage(l,rI,o)},writePackedBoolean:function(l,o){o.length&&this.writeMessage(l,D0,o)},writePackedFloat:function(l,o){o.length&&this.writeMessage(l,sI,o)},writePackedDouble:function(l,o){o.length&&this.writeMessage(l,oI,o)},writePackedFixed32:function(l,o){o.length&&this.writeMessage(l,aI,o)},writePackedSFixed32:function(l,o){o.length&&this.writeMessage(l,O0,o)},writePackedFixed64:function(l,o){o.length&&this.writeMessage(l,lI,o)},writePackedSFixed64:function(l,o){o.length&&this.writeMessage(l,uI,o)},writeBytesField:function(l,o){this.writeTag(l,hs.Bytes),this.writeBytes(o)},writeFixed32Field:function(l,o){this.writeTag(l,hs.Fixed32),this.writeFixed32(o)},writeSFixed32Field:function(l,o){this.writeTag(l,hs.Fixed32),this.writeSFixed32(o)},writeFixed64Field:function(l,o){this.writeTag(l,hs.Fixed64),this.writeFixed64(o)},writeSFixed64Field:function(l,o){this.writeTag(l,hs.Fixed64),this.writeSFixed64(o)},writeVarintField:function(l,o){this.writeTag(l,hs.Varint),this.writeVarint(o)},writeSVarintField:function(l,o){this.writeTag(l,hs.Varint),this.writeSVarint(o)},writeStringField:function(l,o){this.writeTag(l,hs.Bytes),this.writeString(o)},writeFloatField:function(l,o){this.writeTag(l,hs.Fixed32),this.writeFloat(o)},writeDoubleField:function(l,o){this.writeTag(l,hs.Fixed64),this.writeDouble(o)},writeBooleanField:function(l,o){this.writeVarintField(l,!!o)}};class N0{constructor(o,{pixelRatio:u,version:f,stretchX:m,stretchY:y,content:b}){this.paddedRect=o,this.pixelRatio=u,this.stretchX=m,this.stretchY=y,this.content=b,this.version=f}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class mb{constructor(o,u){const f={},m={};this.haveRenderCallbacks=[];const y=[];this.addImages(o,f,y),this.addImages(u,m,y);const{w:b,h:T}=Ay(y),A=new uu({width:b||1,height:T||1});for(const L in o){const F=o[L],U=f[L].paddedRect;uu.copy(F.data,A,{x:0,y:0},{x:U.x+1,y:U.y+1},F.data)}for(const L in u){const F=u[L],U=m[L].paddedRect,j=U.x+1,Y=U.y+1,J=F.data.width,ee=F.data.height;uu.copy(F.data,A,{x:0,y:0},{x:j,y:Y},F.data),uu.copy(F.data,A,{x:0,y:ee-1},{x:j,y:Y-1},{width:J,height:1}),uu.copy(F.data,A,{x:0,y:0},{x:j,y:Y+ee},{width:J,height:1}),uu.copy(F.data,A,{x:J-1,y:0},{x:j-1,y:Y},{width:1,height:ee}),uu.copy(F.data,A,{x:0,y:0},{x:j+J,y:Y},{width:1,height:ee})}this.image=A,this.iconPositions=f,this.patternPositions=m}addImages(o,u,f){for(const m in o){const y=o[m],b={x:0,y:0,w:y.data.width+2,h:y.data.height+2};f.push(b),u[m]=new N0(b,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(o,u){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(f=>o.hasImage(f)),o.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in o.updatedImages)this.patchUpdatedImage(this.iconPositions[f],o.getImage(f),u),this.patchUpdatedImage(this.patternPositions[f],o.getImage(f),u)}patchUpdatedImage(o,u,f){if(!o||!u||o.version===u.version)return;o.version=u.version;const[m,y]=o.tl;f.update(u.data,void 0,{x:m,y})}}Cn(N0,"ImagePosition"),Cn(mb,"ImageAtlas");const Uu={horizontal:1,vertical:2,horizontalOnly:3};class Mm{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(o,u){const f=new Mm;return f.scale=o||1,f.fontStack=u,f}static forImage(o){const u=new Mm;return u.imageName=o,u}}class Lm{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(o,u){const f=new Lm;for(let m=0;m<o.sections.length;m++){const y=o.sections[m];y.image?f.addImageSection(y):f.addTextSection(y,u)}return f}length(){return this.text.length}getSection(o){return this.sections[this.sectionIndex[o]]}getSections(){return this.sections}getSectionIndex(o){return this.sectionIndex[o]}getCharCode(o){return this.text.charCodeAt(o)}verticalizePunctuation(o){this.text=function(u,f){let m="";for(let y=0;y<u.length;y++){const b=u.charCodeAt(y+1)||null,T=u.charCodeAt(y-1)||null;m+=!f&&(b&&B(b)&&!Qr[u[y+1]]||T&&B(T)&&!Qr[u[y-1]])||!Qr[u[y]]?u[y]:Qr[u[y]]}return m}(this.text,o)}trim(){let o=0;for(let f=0;f<this.text.length&&My[this.text.charCodeAt(f)];f++)o++;let u=this.text.length;for(let f=this.text.length-1;f>=0&&f>=o&&My[this.text.charCodeAt(f)];f--)u--;this.text=this.text.substring(o,u),this.sectionIndex=this.sectionIndex.slice(o,u)}substring(o,u){const f=new Lm;return f.text=this.text.substring(o,u),f.sectionIndex=this.sectionIndex.slice(o,u),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((o,u)=>Math.max(o,this.sections[u].scale),0)}addTextSection(o,u){this.text+=o.text,this.sections.push(Mm.forText(o.scale,o.fontStack||u));const f=this.sections.length-1;for(let m=0;m<o.text.length;++m)this.sectionIndex.push(f)}addImageSection(o){const u=o.image?o.image.name:"";if(u.length===0)return void Gn("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(Mm.forImage(u)),this.sectionIndex.push(this.sections.length-1)):Gn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function k0(l,o,u,f,m,y,b,T,A,L,F,U,j,Y,J){const ee=Lm.fromFeature(l,m);U===Uu.vertical&&ee.verticalizePunctuation(j);let ce=[];const we=function(ke,_t,mt,Pt,Jt,bt){if(!ke)return[];const Bt=[],Vt=function(yn,mi,Mn,Jn,xn,_i){let dr=0;for(let cr=0;cr<yn.length();cr++){const rr=yn.getSection(cr);dr+=F0(yn.getCharCode(cr),rr,Jn,xn,mi,_i)}return dr/Math.max(1,Math.ceil(dr/Mn))}(ke,_t,mt,Pt,Jt,bt),Zt=ke.text.indexOf("")>=0;let $t=0;for(let yn=0;yn<ke.length();yn++){const mi=ke.getSection(yn),Mn=ke.getCharCode(yn);if(My[Mn]||($t+=F0(Mn,mi,Pt,Jt,_t,bt)),yn<ke.length()-1){const Jn=!((Et=Mn)<11904||!(iu(Et)||dm(Et)||_(Et)||mm(Et)||U_(Et)||F_(Et)||B_(Et)||Lp(Et)||V_(Et)||pm(Et)||z_(Et)||v(Et)||gc(Et)||Eg(Et)||bg(Et)||wg(Et)||Ad(Et)||Hh(Et)||G_(Et)||Ig(Et)));(gb[Mn]||Jn||mi.imageName)&&Bt.push(yb(yn+1,$t,Vt,Bt,dI(Mn,ke.getCharCode(yn+1),Jn&&Zt),!1))}}var Et;return vb(yb(ke.length(),$t,Vt,Bt,0,!0))}(ee,L,y,o,f,Y),{processBidirectionalText:Pe,processStyledBidirectionalText:be}=qe;if(Pe&&ee.sections.length===1){const ke=Pe(ee.toString(),we);for(const _t of ke){const mt=new Lm;mt.text=_t,mt.sections=ee.sections;for(let Pt=0;Pt<_t.length;Pt++)mt.sectionIndex.push(0);ce.push(mt)}}else if(be){const ke=be(ee.text,ee.sectionIndex,we);for(const _t of ke){const mt=new Lm;mt.text=_t[0],mt.sectionIndex=_t[1],mt.sections=ee.sections,ce.push(mt)}}else ce=function(ke,_t){const mt=[],Pt=ke.text;let Jt=0;for(const bt of _t)mt.push(ke.substring(Jt,bt)),Jt=bt;return Jt<Pt.length&&mt.push(ke.substring(Jt,Pt.length)),mt}(ee,we);const Me=[],Ve={positionedLines:Me,text:ee.toString(),top:F[1],bottom:F[1],left:F[0],right:F[0],writingMode:U,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ke,_t,mt,Pt,Jt,bt,Bt,Vt,Zt,$t,Et,yn){let mi=0,Mn=0,Jn=0;const xn=Vt==="right"?1:Vt==="left"?0:.5;let _i=!1;for(const Ri of Jt){const pr=Ri.getSections();for(const fs of pr){if(fs.imageName)continue;const As=_t[fs.fontStack];if(As&&(_i=As.ascender!==void 0&&As.descender!==void 0,!_i))break}if(!_i)break}let dr=0;for(const Ri of Jt){Ri.trim();const pr=Ri.getMaxScale(),fs=(pr-1)*ma,As={positionedGlyphs:[],lineOffset:0};ke.positionedLines[dr]=As;const ws=As.positionedGlyphs;let Ms=0;if(!Ri.length()){Mn+=bt,++dr;continue}let Ns=0,vo=0;for(let os=0;os<Ri.length();os++){const ia=Ri.getSection(os),Wo=Ri.getSectionIndex(os),Gr=Ri.getCharCode(os);let $s=ia.scale,ga=null,ds=null,No=null,ql=ma,sl=0;const ol=!(Zt===Uu.horizontal||!Et&&!N(Gr)||Et&&(My[Gr]||(cr=Gr,Mp(cr)||mc(cr)||xg(cr)||qh(cr)||d(cr))));if(ia.imageName){const pu=Pt[ia.imageName];if(!pu)continue;No=ia.imageName,ke.iconsInText=ke.iconsInText||!0,ds=pu.paddedRect;const al=pu.displaySize;$s=$s*ma/yn,ga={width:al[0],height:al[1],left:1,top:-3,advance:ol?al[1]:al[0],localGlyph:!1},sl=_i?-ga.height*$s:pr*ma-17-al[1]*$s,ql=ga.advance;const Gp=(ol?al[0]:al[1])*$s-ma*pr;Gp>0&&Gp>Ms&&(Ms=Gp)}else{const pu=mt[ia.fontStack];if(!pu)continue;pu[Gr]&&(ds=pu[Gr]);const al=_t[ia.fontStack];if(!al)continue;const Gp=al.glyphs[Gr];if(!Gp)continue;if(ga=Gp.metrics,ql=Gr!==8203?ma:0,_i){const Gy=al.ascender!==void 0?Math.abs(al.ascender):0,J0=al.descender!==void 0?Math.abs(al.descender):0,Q0=(Gy+J0)*$s;Ns<Q0&&(Ns=Q0,vo=(Gy-J0)/2*$s),sl=-Gy*$s}else sl=(pr-$s)*ma-17}ol?(ke.verticalizable=!0,ws.push({glyph:Gr,imageName:No,x:mi,y:Mn+sl,vertical:ol,scale:$s,localGlyph:ga.localGlyph,fontStack:ia.fontStack,sectionIndex:Wo,metrics:ga,rect:ds}),mi+=ql*$s+$t):(ws.push({glyph:Gr,imageName:No,x:mi,y:Mn+sl,vertical:ol,scale:$s,localGlyph:ga.localGlyph,fontStack:ia.fontStack,sectionIndex:Wo,metrics:ga,rect:ds}),mi+=ga.advance*$s+$t)}ws.length!==0&&(Jn=Math.max(mi-$t,Jn),_i?xb(ws,xn,Ms,vo,bt*pr/2):xb(ws,xn,Ms,0,bt/2)),mi=0;const rl=bt*pr+Ms;As.lineOffset=Math.max(Ms,fs),Mn+=rl,++dr}var cr;const rr=Mn,{horizontalAlign:yi,verticalAlign:ss}=Ud(Bt);(function(Ri,pr,fs,As,ws,Ms){const Ns=(pr-fs)*ws,vo=-Ms*As;for(const rl of Ri)for(const os of rl.positionedGlyphs)os.x+=Ns,os.y+=vo})(ke.positionedLines,xn,yi,ss,Jn,rr),ke.top+=-ss*rr,ke.bottom=ke.top+rr,ke.left+=-yi*Jn,ke.right=ke.left+Jn,ke.hasBaseline=_i}(Ve,o,u,f,ce,b,T,A,U,L,j,J),!function(ke){for(const _t of ke)if(_t.positionedGlyphs.length!==0)return!1;return!0}(Me)&&Ve}const My={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},gb={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function F0(l,o,u,f,m,y){if(o.imageName){const b=f[o.imageName];return b?b.displaySize[0]*o.scale*ma/y+m:0}{const b=u[o.fontStack],T=b&&b.glyphs[l];return T?T.metrics.advance*o.scale+m:0}}function _b(l,o,u,f){const m=Math.pow(l-o,2);return f?l<o?m/2:2*m:m+Math.abs(u)*u}function dI(l,o,u){let f=0;return l===10&&(f-=1e4),u&&(f+=150),l!==40&&l!==65288||(f+=50),o!==41&&o!==65289||(f+=50),f}function yb(l,o,u,f,m,y){let b=null,T=_b(o,u,m,y);for(const A of f){const L=_b(o-A.x,u,m,y)+A.badness;L<=T&&(b=A,T=L)}return{index:l,x:o,priorBreak:b,badness:T}}function vb(l){return l?vb(l.priorBreak).concat(l.index):[]}function Ud(l){let o=.5,u=.5;switch(l){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:o,verticalAlign:u}}function xb(l,o,u,f,m){if(!(o||u||f||m))return;const y=l.length-1,b=l[y],T=(b.x+b.metrics.advance*b.scale)*o;for(let A=0;A<=y;A++)l[A].x-=T,l[A].y+=u+f+m}function pI(l,o,u){const{horizontalAlign:f,verticalAlign:m}=Ud(u),y=o[0]-l.displaySize[0]*f,b=o[1]-l.displaySize[1]*m;return{image:l,top:b,bottom:b+l.displaySize[1],left:y,right:y+l.displaySize[0]}}function bb(l,o,u,f,m,y){const b=l.image;let T;if(b.content){const ce=b.content,we=b.pixelRatio||1;T=[ce[0]/we,ce[1]/we,b.displaySize[0]-ce[2]/we,b.displaySize[1]-ce[3]/we]}const A=o.left*y,L=o.right*y;let F,U,j,Y;u==="width"||u==="both"?(Y=m[0]+A-f[3],U=m[0]+L+f[1]):(Y=m[0]+(A+L-b.displaySize[0])/2,U=Y+b.displaySize[0]);const J=o.top*y,ee=o.bottom*y;return u==="height"||u==="both"?(F=m[1]+J-f[0],j=m[1]+ee+f[2]):(F=m[1]+(J+ee-b.displaySize[1])/2,j=F+b.displaySize[1]),{image:b,top:F,right:U,bottom:j,left:Y,collisionPadding:T}}class Wf extends ie{constructor(o,u,f,m,y){super(o,u),this.angle=m,this.z=f,y!==void 0&&(this.segment=y)}clone(){return new Wf(this.x,this.y,this.z,this.angle,this.segment)}}function Eb(l,o,u,f,m){if(o.segment===void 0)return!0;let y=o,b=o.segment+1,T=0;for(;T>-u/2;){if(b--,b<0)return!1;T-=l[b].dist(y),y=l[b]}T+=l[b].dist(l[b+1]),b++;const A=[];let L=0;for(;T<u/2;){const F=l[b],U=l[b+1];if(!U)return!1;let j=l[b-1].angleTo(F)-F.angleTo(U);for(j=Math.abs((j+3*Math.PI)%(2*Math.PI)-Math.PI),A.push({distance:T,angleDelta:j}),L+=j;T-A[0].distance>f;)L-=A.shift().angleDelta;if(L>m)return!1;b++,T+=F.dist(U)}return!0}function B0(l){let o=0;for(let u=0;u<l.length-1;u++)o+=l[u].dist(l[u+1]);return o}function z0(l,o,u){return l?.6*o*u:0}function wb(l,o){return Math.max(l?l.right-l.left:0,o?o.right-o.left:0)}function mI(l,o,u,f,m,y){const b=z0(u,m,y),T=wb(u,f)*y;let A=0;const L=B0(l)/2;for(let F=0;F<l.length-1;F++){const U=l[F],j=l[F+1],Y=U.dist(j);if(A+Y>L){const J=(L-A)/Y,ee=Mi(U.x,j.x,J),ce=Mi(U.y,j.y,J),we=new Wf(ee,ce,0,j.angleTo(U),F);return!b||Eb(l,we,T,b,o)?we:void 0}A+=Y}}function gI(l,o,u,f,m,y,b,T,A){const L=z0(f,y,b),F=wb(f,m),U=F*b,j=l[0].x===0||l[0].x===A||l[0].y===0||l[0].y===A;return o-U<o/4&&(o=U+o/4),Ib(l,j?o/2*T%o:(F/2+2*y)*b*T%o,o,L,u,U,j,!1,A)}function Ib(l,o,u,f,m,y,b,T,A){const L=y/2,F=B0(l);let U=0,j=o-u,Y=[];for(let J=0;J<l.length-1;J++){const ee=l[J],ce=l[J+1],we=ee.dist(ce),Pe=ce.angleTo(ee);for(;j+u<U+we;){j+=u;const be=(j-U)/we,Me=Mi(ee.x,ce.x,be),Ve=Mi(ee.y,ce.y,be);if(Me>=0&&Me<A&&Ve>=0&&Ve<A&&j-L>=0&&j+L<=F){const ke=new Wf(Me,Ve,0,Pe,J);ke._round(),f&&!Eb(l,ke,y,f,m)||Y.push(ke)}}U+=we}return T||Y.length||b||(Y=Ib(l,U/2,u,f,m,y,b,!0,A)),Y}function Tb(l,o,u,f,m){const y=[];for(let b=0;b<l.length;b++){const T=l[b];let A;for(let L=0;L<T.length-1;L++){let F=T[L],U=T[L+1];F.x<o&&U.x<o||(F.x<o?F=new ie(o,F.y+(o-F.x)/(U.x-F.x)*(U.y-F.y))._round():U.x<o&&(U=new ie(o,F.y+(o-F.x)/(U.x-F.x)*(U.y-F.y))._round()),F.y<u&&U.y<u||(F.y<u?F=new ie(F.x+(u-F.y)/(U.y-F.y)*(U.x-F.x),u)._round():U.y<u&&(U=new ie(F.x+(u-F.y)/(U.y-F.y)*(U.x-F.x),u)._round()),F.x>=f&&U.x>=f||(F.x>=f?F=new ie(f,F.y+(f-F.x)/(U.x-F.x)*(U.y-F.y))._round():U.x>=f&&(U=new ie(f,F.y+(f-F.x)/(U.x-F.x)*(U.y-F.y))._round()),F.y>=m&&U.y>=m||(F.y>=m?F=new ie(F.x+(m-F.y)/(U.y-F.y)*(U.x-F.x),m)._round():U.y>=m&&(U=new ie(F.x+(m-F.y)/(U.y-F.y)*(U.x-F.x),m)._round()),A&&F.equals(A[A.length-1])||(A=[F],y.push(A)),A.push(U)))))}}return y}Cn(Wf,"Anchor");const Zg=1e20;function Sb(l,o,u,f,m,y,b,T,A){for(let L=o;L<o+f;L++)Cb(l,u*y+L,y,m,b,T,A);for(let L=u;L<u+m;L++)Cb(l,L*y+o,1,f,b,T,A)}function Cb(l,o,u,f,m,y,b){y[0]=0,b[0]=-Zg,b[1]=Zg,m[0]=l[o];for(let T=1,A=0,L=0;T<f;T++){m[T]=l[o+T*u];const F=T*T;do{const U=y[A];L=(m[T]-m[U]+F-U*U)/(T-U)/2}while(L<=b[A]&&--A>-1);A++,y[A]=T,b[A]=L,b[A+1]=Zg}for(let T=0,A=0;T<f;T++){for(;b[A+1]<T;)A++;const L=y[A],F=T-L;l[o+T*u]=m[L]+F*F}}const U0={none:0,ideographs:1,all:2};class Pm{constructor(o,u,f){this.requestManager=o,this.localGlyphMode=u,this.localFontFamily=f,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(o){this.url=o}getGlyphs(o,u){const f=[];for(const m in o)for(const y of o[m])f.push({stack:m,id:y});et(f,({stack:m,id:y},b)=>{let T=this.entries[m];T||(T=this.entries[m]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let A=T.glyphs[y];if(A!==void 0)return void b(null,{stack:m,id:y,glyph:A});if(A=this._tinySDF(T,m,y),A)return T.glyphs[y]=A,void b(null,{stack:m,id:y,glyph:A});const L=Math.floor(y/256);if(256*L>65535)return void b(new Error("glyphs > 65535 not supported"));if(T.ranges[L])return void b(null,{stack:m,id:y,glyph:A});let F=T.requests[L];F||(F=T.requests[L]=[],Pm.loadGlyphRange(m,L,this.url,this.requestManager,(U,j)=>{if(j){T.ascender=j.ascender,T.descender=j.descender;for(const Y in j.glyphs)this._doesCharSupportLocalGlyph(+Y)||(T.glyphs[+Y]=j.glyphs[+Y]);T.ranges[L]=!0}for(const Y of F)Y(U,j);delete T.requests[L]})),F.push((U,j)=>{U?b(U):j&&b(null,{stack:m,id:y,glyph:j.glyphs[y]||null})})},(m,y)=>{if(m)u(m);else if(y){const b={};for(const{stack:T,id:A,glyph:L}of y)b[T]===void 0&&(b[T]={}),b[T].glyphs===void 0&&(b[T].glyphs={}),b[T].glyphs[A]=L&&{id:L.id,bitmap:L.bitmap.clone(),metrics:L.metrics},b[T].ascender=this.entries[T].ascender,b[T].descender=this.entries[T].descender;u(null,b)}})}_doesCharSupportLocalGlyph(o){return this.localGlyphMode!==U0.none&&(this.localGlyphMode===U0.all?!!this.localFontFamily:!!this.localFontFamily&&(pm(o)||j_(o)||gc(o)||Ad(o)||Lp(o)))}_tinySDF(o,u,f){const m=this.localFontFamily;if(!m||!this._doesCharSupportLocalGlyph(f))return;let y=o.tinySDF;if(!y){let ee="400";/bold/i.test(u)?ee="900":/medium/i.test(u)?ee="500":/light/i.test(u)&&(ee="200"),y=o.tinySDF=new Pm.TinySDF({fontFamily:m,fontWeight:ee,fontSize:48,buffer:6,radius:16}),y.fontWeight=ee}if(this.localGlyphs[y.fontWeight][f])return this.localGlyphs[y.fontWeight][f];const b=String.fromCharCode(f),{data:T,width:A,height:L,glyphWidth:F,glyphHeight:U,glyphLeft:j,glyphTop:Y,glyphAdvance:J}=y.draw(b);return this.localGlyphs[y.fontWeight][f]={id:f,bitmap:new bc({width:A,height:L},T),metrics:{width:F/2,height:U/2,left:j/2,top:Y/2-27,advance:J/2,localGlyph:!0}}}}function Ab(l,o,u,f){const m=[],y=l.image,b=y.pixelRatio,T=y.paddedRect.w-2,A=y.paddedRect.h-2,L=l.right-l.left,F=l.bottom-l.top,U=y.stretchX||[[0,T]],j=y.stretchY||[[0,A]],Y=(bt,Bt)=>bt+Bt[1]-Bt[0],J=U.reduce(Y,0),ee=j.reduce(Y,0),ce=T-J,we=A-ee;let Pe=0,be=J,Me=0,Ve=ee,ke=0,_t=ce,mt=0,Pt=we;if(y.content&&f){const bt=y.content;Pe=Ly(U,0,bt[0]),Me=Ly(j,0,bt[1]),be=Ly(U,bt[0],bt[2]),Ve=Ly(j,bt[1],bt[3]),ke=bt[0]-Pe,mt=bt[1]-Me,_t=bt[2]-bt[0]-be,Pt=bt[3]-bt[1]-Ve}const Jt=(bt,Bt,Vt,Zt)=>{const $t=Py(bt.stretch-Pe,be,L,l.left),Et=Ry(bt.fixed-ke,_t,bt.stretch,J),yn=Py(Bt.stretch-Me,Ve,F,l.top),mi=Ry(Bt.fixed-mt,Pt,Bt.stretch,ee),Mn=Py(Vt.stretch-Pe,be,L,l.left),Jn=Ry(Vt.fixed-ke,_t,Vt.stretch,J),xn=Py(Zt.stretch-Me,Ve,F,l.top),_i=Ry(Zt.fixed-mt,Pt,Zt.stretch,ee),dr=new ie($t,yn),cr=new ie(Mn,yn),rr=new ie(Mn,xn),yi=new ie($t,xn),ss=new ie(Et/b,mi/b),Ri=new ie(Jn/b,_i/b),pr=o*Math.PI/180;if(pr){const ws=Math.sin(pr),Ms=Math.cos(pr),Ns=[Ms,-ws,ws,Ms];dr._matMult(Ns),cr._matMult(Ns),yi._matMult(Ns),rr._matMult(Ns)}const fs=bt.stretch+bt.fixed,As=Bt.stretch+Bt.fixed;return{tl:dr,tr:cr,bl:yi,br:rr,tex:{x:y.paddedRect.x+1+fs,y:y.paddedRect.y+1+As,w:Vt.stretch+Vt.fixed-fs,h:Zt.stretch+Zt.fixed-As},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ss,pixelOffsetBR:Ri,minFontScaleX:_t/b/L,minFontScaleY:Pt/b/F,isSDF:u}};if(f&&(y.stretchX||y.stretchY)){const bt=Mb(U,ce,J),Bt=Mb(j,we,ee);for(let Vt=0;Vt<bt.length-1;Vt++){const Zt=bt[Vt],$t=bt[Vt+1];for(let Et=0;Et<Bt.length-1;Et++)m.push(Jt(Zt,Bt[Et],$t,Bt[Et+1]))}}else m.push(Jt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:A+1}));return m}function Ly(l,o,u){let f=0;for(const m of l)f+=Math.max(o,Math.min(u,m[1]))-Math.max(o,Math.min(u,m[0]));return f}function Mb(l,o,u){const f=[{fixed:-1,stretch:0}];for(const[m,y]of l){const b=f[f.length-1];f.push({fixed:m-b.stretch,stretch:b.stretch}),f.push({fixed:m-b.stretch,stretch:b.stretch+(y-m)})}return f.push({fixed:o+1,stretch:u}),f}function Py(l,o,u,f){return l/o*u+f}function Ry(l,o,u,f){return l-o*u/f}function _I(l,o,u,f){const m=o+l.positionedLines[f].lineOffset;return f===0?u+m/2:u+(m+(o+l.positionedLines[f-1].lineOffset))/2}Pm.loadGlyphRange=function(l,o,u,f,m){const y=256*o,b=y+255,T=f.transformRequest(f.normalizeGlyphsURL(u).replace("{fontstack}",l).replace("{range}",`${y}-${b}`),kt.Glyphs);Ds(T,(A,L)=>{if(A)m(A);else if(L){const F={},U=function(j){return new zd(j).readFields(cI,{})}(L);for(const j of U.glyphs)F[j.id]=j;m(null,{glyphs:F,ascender:U.ascender,descender:U.descender})}})},Pm.TinySDF=class{constructor({fontSize:l=24,buffer:o=3,radius:u=8,cutoff:f=.25,fontFamily:m="sans-serif",fontWeight:y="normal",fontStyle:b="normal"}={}){this.buffer=o,this.cutoff=f,this.radius=u;const T=this.size=l+4*o,A=this._createCanvas(T),L=this.ctx=A.getContext("2d",{willReadFrequently:!0});L.font=`${b} ${y} ${l}px ${m}`,L.textBaseline="alphabetic",L.textAlign="left",L.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(l){const o=document.createElement("canvas");return o.width=o.height=l,o}draw(l){const{width:o,actualBoundingBoxAscent:u,actualBoundingBoxDescent:f,actualBoundingBoxLeft:m,actualBoundingBoxRight:y}=this.ctx.measureText(l),b=Math.ceil(u),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-m))),A=Math.min(this.size-this.buffer,b+Math.ceil(f)),L=T+2*this.buffer,F=A+2*this.buffer,U=Math.max(L*F,0),j=new Uint8ClampedArray(U),Y={data:j,width:L,height:F,glyphWidth:T,glyphHeight:A,glyphTop:b,glyphLeft:0,glyphAdvance:o};if(T===0||A===0)return Y;const{ctx:J,buffer:ee,gridInner:ce,gridOuter:we}=this;J.clearRect(ee,ee,T,A),J.fillText(l,ee,ee+b);const Pe=J.getImageData(ee,ee,T,A);we.fill(Zg,0,U),ce.fill(0,0,U);for(let be=0;be<A;be++)for(let Me=0;Me<T;Me++){const Ve=Pe.data[4*(be*T+Me)+3]/255;if(Ve===0)continue;const ke=(be+ee)*L+Me+ee;if(Ve===1)we[ke]=0,ce[ke]=Zg;else{const _t=.5-Ve;we[ke]=_t>0?_t*_t:0,ce[ke]=_t<0?_t*_t:0}}Sb(we,0,0,L,F,L,this.f,this.v,this.z),Sb(ce,ee,ee,T,A,L,this.f,this.v,this.z);for(let be=0;be<U;be++){const Me=Math.sqrt(we[be])-Math.sqrt(ce[be]);j[be]=Math.round(255-255*(Me/this.radius+this.cutoff))}return Y}};class yI{constructor(o=[],u=vI){if(this.data=o,this.length=this.data.length,this.compare=u,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(o){this.data.push(o),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const o=this.data[0],u=this.data.pop();return this.length--,this.length>0&&(this.data[0]=u,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:u,compare:f}=this,m=u[o];for(;o>0;){const y=o-1>>1,b=u[y];if(f(m,b)>=0)break;u[o]=b,o=y}u[o]=m}_down(o){const{data:u,compare:f}=this,m=this.length>>1,y=u[o];for(;o<m;){let b=1+(o<<1),T=u[b];const A=b+1;if(A<this.length&&f(u[A],T)<0&&(b=A,T=u[A]),f(T,y)>=0)break;u[o]=T,o=b}u[o]=y}}function vI(l,o){return l<o?-1:l>o?1:0}function xI(l,o=1,u=!1){let f=1/0,m=1/0,y=-1/0,b=-1/0;const T=l[0];for(let Y=0;Y<T.length;Y++){const J=T[Y];(!Y||J.x<f)&&(f=J.x),(!Y||J.y<m)&&(m=J.y),(!Y||J.x>y)&&(y=J.x),(!Y||J.y>b)&&(b=J.y)}const A=Math.min(y-f,b-m);let L=A/2;const F=new yI([],bI);if(A===0)return new ie(f,m);for(let Y=f;Y<y;Y+=A)for(let J=m;J<b;J+=A)F.push(new Rm(Y+L,J+L,L,l));let U=function(Y){let J=0,ee=0,ce=0;const we=Y[0];for(let Pe=0,be=we.length,Me=be-1;Pe<be;Me=Pe++){const Ve=we[Pe],ke=we[Me],_t=Ve.x*ke.y-ke.x*Ve.y;ee+=(Ve.x+ke.x)*_t,ce+=(Ve.y+ke.y)*_t,J+=3*_t}return new Rm(ee/J,ce/J,0,Y)}(l),j=F.length;for(;F.length;){const Y=F.pop();(Y.d>U.d||!U.d)&&(U=Y,u&&console.log("found best %d after %d probes",Math.round(1e4*Y.d)/1e4,j)),Y.max-U.d<=o||(L=Y.h/2,F.push(new Rm(Y.p.x-L,Y.p.y-L,L,l)),F.push(new Rm(Y.p.x+L,Y.p.y-L,L,l)),F.push(new Rm(Y.p.x-L,Y.p.y+L,L,l)),F.push(new Rm(Y.p.x+L,Y.p.y+L,L,l)),j+=4)}return u&&(console.log(`num probes: ${j}`),console.log(`best distance: ${U.d}`)),U.p}function bI(l,o){return o.max-l.max}function Rm(l,o,u,f){this.p=new ie(l,o),this.h=u,this.d=function(m,y){let b=!1,T=1/0;for(let A=0;A<y.length;A++){const L=y[A];for(let F=0,U=L.length,j=U-1;F<U;j=F++){const Y=L[F],J=L[j];Y.y>m.y!=J.y>m.y&&m.x<(J.x-Y.x)*(m.y-Y.y)/(J.y-Y.y)+Y.x&&(b=!b),T=Math.min(T,Ox(m,Y,J))}}return(b?1:-1)*Math.sqrt(T)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}const V0=Number.POSITIVE_INFINITY,EI=Math.sqrt(2);function Lb(l,[o,u]){let f=0,m=0;if(u===V0){o<0&&(o=0);const y=o/EI;switch(l){case"top-right":case"top-left":m=y-7;break;case"bottom-right":case"bottom-left":m=7-y;break;case"bottom":m=7-o;break;case"top":m=o-7}switch(l){case"top-right":case"bottom-right":f=-y;break;case"top-left":case"bottom-left":f=y;break;case"left":f=o;break;case"right":f=-o}}else{switch(o=Math.abs(o),u=Math.abs(u),l){case"top-right":case"top-left":case"top":m=u-7;break;case"bottom-right":case"bottom-left":case"bottom":m=7-u}switch(l){case"top-right":case"bottom-right":case"right":f=-o;break;case"top-left":case"bottom-left":case"left":f=o}}return[f,m]}function wI(l,o,u,f,m,y,b,T,A,L){l.createArrays(),l.tilePixelRatio=gi/(512*l.overscaling),l.compareText={},l.iconsNeedLinear=!1;const F=l.layers[0].layout,U=l.layers[0]._unevaluatedLayout._values,j={};if(l.textSizeData.kind==="composite"){const{minZoom:ee,maxZoom:ce}=l.textSizeData;j.compositeTextSizes=[U["text-size"].possiblyEvaluate(new lt(ee),T),U["text-size"].possiblyEvaluate(new lt(ce),T)]}if(l.iconSizeData.kind==="composite"){const{minZoom:ee,maxZoom:ce}=l.iconSizeData;j.compositeIconSizes=[U["icon-size"].possiblyEvaluate(new lt(ee),T),U["icon-size"].possiblyEvaluate(new lt(ce),T)]}j.layoutTextSize=U["text-size"].possiblyEvaluate(new lt(A+1),T),j.layoutIconSize=U["icon-size"].possiblyEvaluate(new lt(A+1),T),j.textMaxSize=U["text-size"].possiblyEvaluate(new lt(18),T);const Y=F.get("text-rotation-alignment")==="map"&&F.get("symbol-placement")!=="point",J=F.get("text-size");for(const ee of l.features){const ce=F.get("text-font").evaluate(ee,{},T).join(","),we=J.evaluate(ee,{},T),Pe=j.layoutTextSize.evaluate(ee,{},T),be=(j.layoutIconSize.evaluate(ee,{},T),{horizontal:{},vertical:void 0}),Me=ee.text;let Ve,ke=[0,0];if(Me){const Pt=Me.toString(),Jt=F.get("text-letter-spacing").evaluate(ee,{},T)*ma,bt=F.get("text-line-height").evaluate(ee,{},T)*ma,Bt=S(Pt)?Jt:0,Vt=F.get("text-anchor").evaluate(ee,{},T),Zt=F.get("text-variable-anchor");if(!Zt){const Mn=F.get("text-radial-offset").evaluate(ee,{},T);ke=Mn?Lb(Vt,[Mn*ma,V0]):F.get("text-offset").evaluate(ee,{},T).map(Jn=>Jn*ma)}let $t=Y?"center":F.get("text-justify").evaluate(ee,{},T);const Et=F.get("symbol-placement")==="point",yn=Et?F.get("text-max-width").evaluate(ee,{},T)*ma:1/0,mi=Mn=>{l.allowVerticalPlacement&&w(Pt)&&(be.vertical=k0(Me,o,u,m,ce,yn,bt,Vt,Mn,Bt,ke,Uu.vertical,!0,Pe,we))};if(!Y&&Zt){const Mn=$t==="auto"?Zt.map(xn=>Yg(xn)):[$t];let Jn=!1;for(let xn=0;xn<Mn.length;xn++){const _i=Mn[xn];if(!be.horizontal[_i])if(Jn)be.horizontal[_i]=be.horizontal[0];else{const dr=k0(Me,o,u,m,ce,yn,bt,"center",_i,Bt,ke,Uu.horizontal,!1,Pe,we);dr&&(be.horizontal[_i]=dr,Jn=dr.positionedLines.length===1)}}mi("left")}else{if($t==="auto"&&($t=Yg(Vt)),Et||F.get("text-writing-mode").indexOf("horizontal")>=0||!w(Pt)){const Mn=k0(Me,o,u,m,ce,yn,bt,Vt,$t,Bt,ke,Uu.horizontal,!1,Pe,we);Mn&&(be.horizontal[$t]=Mn)}mi(Et?"left":$t)}}let _t=!1;if(ee.icon&&ee.icon.name){const Pt=f[ee.icon.name];Pt&&(Ve=pI(m[ee.icon.name],F.get("icon-offset").evaluate(ee,{},T),F.get("icon-anchor").evaluate(ee,{},T)),_t=Pt.sdf,l.sdfIcons===void 0?l.sdfIcons=Pt.sdf:l.sdfIcons!==Pt.sdf&&Gn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Pt.pixelRatio!==l.pixelRatio||F.get("icon-rotate").constantOr(1)!==0)&&(l.iconsNeedLinear=!0))}const mt=Db(be.horizontal)||be.vertical;l.iconsInText||(l.iconsInText=!!mt&&mt.iconsInText),(mt||Ve)&&Pb(l,ee,be,Ve,f,j,Pe,0,ke,_t,b,T,L)}y&&l.generateCollisionDebugBuffers(A,l.collisionBoxArray)}function Yg(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Pb(l,o,u,f,m,y,b,T,A,L,F,U,j){let Y=y.textMaxSize.evaluate(o,{},U);Y===void 0&&(Y=b);const J=l.layers[0].layout,ee=J.get("icon-offset").evaluate(o,{},U),ce=Db(u.horizontal)||u.vertical,we=j.name==="globe",Pe=b/24,be=l.tilePixelRatio*Y/24,Me=(Bt=l.overscaling,l.zoom>18&&Bt>2&&(Bt>>=1),Math.max(gi/(512*Bt),1)*J.get("symbol-spacing")),Ve=J.get("text-padding")*l.tilePixelRatio,ke=J.get("icon-padding")*l.tilePixelRatio,_t=Fe(J.get("text-max-angle")),mt=J.get("text-rotation-alignment")==="map"&&J.get("symbol-placement")!=="point",Pt=J.get("icon-rotation-alignment")==="map"&&J.get("symbol-placement")!=="point",Jt=J.get("symbol-placement"),bt=Me/2;var Bt;const Vt=J.get("icon-text-fit");let Zt;f&&Vt!=="none"&&(l.allowVerticalPlacement&&u.vertical&&(Zt=bb(f,u.vertical,Vt,J.get("icon-text-fit-padding"),ee,Pe)),ce&&(f=bb(f,ce,Vt,J.get("icon-text-fit-padding"),ee,Pe)));const $t=(Et,yn,mi)=>{if(yn.x<0||yn.x>=gi||yn.y<0||yn.y>=gi)return;let Mn=null;if(we){const{x:Jn,y:xn,z:_i}=j.projectTilePoint(yn.x,yn.y,mi);Mn={anchor:new Wf(Jn,xn,_i,0,void 0),up:j.upVector(mi,yn.x,yn.y)}}(function(Jn,xn,_i,dr,cr,rr,yi,ss,Ri,pr,fs,As,ws,Ms,Ns,vo,rl,os,ia,Wo,Gr,$s,ga,ds,No){const ql=Jn.addToLineVertexArray(xn,dr);let sl,ol,pu,al,Gp,Gy,J0,Q0=0,ZS=0,YS=0,KS=0,qI=-1,HI=-1;const jd={};let JS=Ld("");const t_=_i?_i.anchor:xn;let WI=0,XI=0;if(Ri._unevaluatedLayout.getValue("text-radial-offset")===void 0?[WI,XI]=Ri.layout.get("text-offset").evaluate(Gr,{},No).map(wc=>wc*ma):(WI=Ri.layout.get("text-radial-offset").evaluate(Gr,{},No)*ma,XI=V0),Jn.allowVerticalPlacement&&cr.vertical){const wc=cr.vertical;if(Ns)Gy=Kg(wc),ss&&(J0=Kg(ss));else{const Ic=Ri.layout.get("text-rotate").evaluate(Gr,{},No)+90;pu=Dy(pr,t_,xn,fs,As,ws,wc,Ms,Ic,vo),ss&&(al=Dy(pr,t_,xn,fs,As,ws,ss,os,Ic))}}if(rr){const wc=Ri.layout.get("icon-rotate").evaluate(Gr,{},No),Ic=Ri.layout.get("icon-text-fit")!=="none",$0=Ab(rr,wc,ga,Ic),YI=ss?Ab(ss,wc,ga,Ic):void 0;ol=Dy(pr,t_,xn,fs,As,ws,rr,os,wc),Q0=4*$0.length;const QS=Jn.iconSizeData;let n_=null;QS.kind==="source"?(n_=[Da*Ri.layout.get("icon-size").evaluate(Gr,{},No)],n_[0]>Xf&&Gn(`${Jn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):QS.kind==="composite"&&(n_=[Da*$s.compositeIconSizes[0].evaluate(Gr,{},No),Da*$s.compositeIconSizes[1].evaluate(Gr,{},No)],(n_[0]>Xf||n_[1]>Xf)&&Gn(`${Jn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Jn.addSymbols(Jn.icon,$0,n_,Wo,ia,Gr,!1,_i,xn,ql.lineStartIndex,ql.lineLength,-1,ds,No),qI=Jn.icon.placedSymbolArray.length-1,YI&&(ZS=4*YI.length,Jn.addSymbols(Jn.icon,YI,n_,Wo,ia,Gr,Uu.vertical,_i,xn,ql.lineStartIndex,ql.lineLength,-1,ds,No),HI=Jn.icon.placedSymbolArray.length-1)}for(const wc in cr.horizontal){const Ic=cr.horizontal[wc];sl||(JS=Ld(Ic.text),Ns?Gp=Kg(Ic):sl=Dy(pr,t_,xn,fs,As,ws,Ic,Ms,Ri.layout.get("text-rotate").evaluate(Gr,{},No),vo));const $0=Ic.positionedLines.length===1;if(YS+=Rb(Jn,_i,xn,Ic,yi,Ri,Ns,Gr,vo,ql,cr.vertical?Uu.horizontal:Uu.horizontalOnly,$0?Object.keys(cr.horizontal):[wc],jd,qI,$s,ds,No),$0)break}cr.vertical&&(KS+=Rb(Jn,_i,xn,cr.vertical,yi,Ri,Ns,Gr,vo,ql,Uu.vertical,["vertical"],jd,HI,$s,ds,No));let Om=-1;const ZI=(wc,Ic)=>wc?Math.max(wc,Ic):Ic;Om=ZI(Gp,Om),Om=ZI(Gy,Om),Om=ZI(J0,Om);const mP=Om>-1?1:0;Jn.glyphOffsetArray.length>=Vd.MAX_GLYPHS&&Gn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Gr.sortKey!==void 0&&Jn.addToSortKeyRanges(Jn.symbolInstances.length,Gr.sortKey),Jn.symbolInstances.emplaceBack(t_.x,t_.y,t_.z,xn.x,xn.y,jd.right>=0?jd.right:-1,jd.center>=0?jd.center:-1,jd.left>=0?jd.left:-1,jd.vertical>=0?jd.vertical:-1,qI,HI,JS,sl!==void 0?sl:Jn.collisionBoxArray.length,sl!==void 0?sl+1:Jn.collisionBoxArray.length,pu!==void 0?pu:Jn.collisionBoxArray.length,pu!==void 0?pu+1:Jn.collisionBoxArray.length,ol!==void 0?ol:Jn.collisionBoxArray.length,ol!==void 0?ol+1:Jn.collisionBoxArray.length,al||Jn.collisionBoxArray.length,al?al+1:Jn.collisionBoxArray.length,fs,YS,KS,Q0,ZS,mP,0,WI,XI,Om)})(l,yn,Mn,Et,u,f,m,Zt,l.layers[0],l.collisionBoxArray,o.index,o.sourceLayerIndex,l.index,Ve,mt,A,0,ke,Pt,ee,o,y,L,F,U)};if(Jt==="line")for(const Et of Tb(o.geometry,0,0,gi,gi)){const yn=gI(Et,Me,_t,u.vertical||ce,f,24,be,l.overscaling,gi);for(const mi of yn){const Mn=ce;Mn&&II(l,Mn.text,bt,mi)||$t(Et,mi,U)}}else if(Jt==="line-center"){for(const Et of o.geometry)if(Et.length>1){const yn=mI(Et,_t,u.vertical||ce,f,24,be);yn&&$t(Et,yn,U)}}else if(o.type==="Polygon")for(const Et of gy(o.geometry,0)){const yn=xI(Et,16);$t(Et[0],new Wf(yn.x,yn.y,0,0,void 0),U)}else if(o.type==="LineString")for(const Et of o.geometry)$t(Et,new Wf(Et[0].x,Et[0].y,0,0,void 0),U);else if(o.type==="Point")for(const Et of o.geometry)for(const yn of Et)$t([yn],new Wf(yn.x,yn.y,0,0,void 0),U)}const Xf=32640;function Rb(l,o,u,f,m,y,b,T,A,L,F,U,j,Y,J,ee,ce){const we=function(Me,Ve,ke,_t,mt,Pt,Jt,bt){const Bt=[];if(Ve.positionedLines.length===0)return Bt;const Vt=_t.layout.get("text-rotate").evaluate(Pt,{})*Math.PI/180,Zt=function(Mn){const Jn=Mn[0],xn=Mn[1],_i=Jn*xn;return _i>0?[Jn,-xn]:_i<0?[-Jn,xn]:Jn===0?[xn,Jn]:[xn,-Jn]}(ke);let $t=Math.abs(Ve.top-Ve.bottom);for(const Mn of Ve.positionedLines)$t-=Mn.lineOffset;const Et=Ve.positionedLines.length,yn=$t/Et;let mi=Ve.top-ke[1];for(let Mn=0;Mn<Et;++Mn){const Jn=Ve.positionedLines[Mn];mi=_I(Ve,yn,mi,Mn);for(const xn of Jn.positionedGlyphs){if(!xn.rect)continue;const _i=xn.rect||{};let dr=4,cr=!0,rr=1,yi=0;if(xn.imageName){const ds=Jt[xn.imageName];if(!ds)continue;if(ds.sdf){Gn("SDF images are not supported in formatted text and will be ignored.");continue}cr=!1,rr=ds.pixelRatio,dr=1/rr}const ss=(mt||bt)&&xn.vertical,Ri=xn.metrics.advance*xn.scale/2,pr=xn.metrics,fs=xn.rect;if(fs===null)continue;bt&&Ve.verticalizable&&(yi=xn.imageName?Ri-xn.metrics.width*xn.scale/2:0);const As=mt?[xn.x+Ri,xn.y]:[0,0];let ws=[0,0],Ms=[0,0],Ns=!1;mt||(ss?(Ms=[xn.x+Ri+Zt[0],xn.y+Zt[1]-yi],Ns=!0):ws=[xn.x+Ri+ke[0],xn.y+ke[1]-yi]);const vo=fs.w*xn.scale/(rr*(xn.localGlyph?2:1)),rl=fs.h*xn.scale/(rr*(xn.localGlyph?2:1));let os,ia,Wo,Gr;if(ss){const ds=xn.y-mi,No=new ie(-Ri,Ri-ds),ql=-Math.PI/2,sl=new ie(...Ms);os=new ie(-Ri+ws[0],ws[1]),os._rotateAround(ql,No)._add(sl),os.x+=-ds+Ri,os.y-=(pr.left-dr)*xn.scale;const ol=xn.imageName?pr.advance*xn.scale:ma*xn.scale,pu=String.fromCharCode(xn.glyph);nI(pu)?os.x+=(1-dr)*xn.scale:ub(pu)?os.x+=ol-pr.height*xn.scale+(-dr-1)*xn.scale:os.x+=xn.imageName||pr.width+2*dr===fs.w&&pr.height+2*dr===fs.h?(ol-rl)/2:(ol-(pr.height+2*dr)*xn.scale)/2,ia=new ie(os.x,os.y-vo),Wo=new ie(os.x+rl,os.y),Gr=new ie(os.x+rl,os.y-vo)}else{const ds=(pr.left-dr)*xn.scale-Ri+ws[0],No=(-pr.top-dr)*xn.scale+ws[1],ql=ds+vo,sl=No+rl;os=new ie(ds,No),ia=new ie(ql,No),Wo=new ie(ds,sl),Gr=new ie(ql,sl)}if(Vt){let ds;ds=mt?new ie(0,0):Ns?new ie(Zt[0],Zt[1]):new ie(ke[0],ke[1]),os._rotateAround(Vt,ds),ia._rotateAround(Vt,ds),Wo._rotateAround(Vt,ds),Gr._rotateAround(Vt,ds)}const $s=new ie(0,0),ga=new ie(0,0);Bt.push({tl:os,tr:ia,bl:Wo,br:Gr,tex:_i,writingMode:Ve.writingMode,glyphOffset:As,sectionIndex:xn.sectionIndex,isSDF:cr,pixelOffsetTL:$s,pixelOffsetBR:ga,minFontScaleX:0,minFontScaleY:0})}}return Bt}(0,f,A,y,b,T,m,l.allowVerticalPlacement),Pe=l.textSizeData;let be=null;Pe.kind==="source"?(be=[Da*y.layout.get("text-size").evaluate(T,{},ce)],be[0]>Xf&&Gn(`${l.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Pe.kind==="composite"&&(be=[Da*J.compositeTextSizes[0].evaluate(T,{},ce),Da*J.compositeTextSizes[1].evaluate(T,{},ce)],(be[0]>Xf||be[1]>Xf)&&Gn(`${l.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),l.addSymbols(l.text,we,be,A,b,T,F,o,u,L.lineStartIndex,L.lineLength,Y,ee,ce);for(const Me of U)j[Me]=l.text.placedSymbolArray.length-1;return 4*we.length}function Db(l){for(const o in l)return l[o];return null}function Dy(l,o,u,f,m,y,b,T,A,L){let F=b.top,U=b.bottom,j=b.left,Y=b.right;const J=b.collisionPadding;if(J&&(j-=J[0],F-=J[1],Y+=J[2],U+=J[3]),A){const ee=new ie(j,F),ce=new ie(Y,F),we=new ie(j,U),Pe=new ie(Y,U),be=Fe(A);let Me=new ie(0,0);L&&(Me=new ie(L[0],L[1])),ee._rotateAround(be,Me),ce._rotateAround(be,Me),we._rotateAround(be,Me),Pe._rotateAround(be,Me),j=Math.min(ee.x,ce.x,we.x,Pe.x),Y=Math.max(ee.x,ce.x,we.x,Pe.x),F=Math.min(ee.y,ce.y,we.y,Pe.y),U=Math.max(ee.y,ce.y,we.y,Pe.y)}return l.emplaceBack(o.x,o.y,o.z,u.x,u.y,j,F,Y,U,T,f,m,y),l.length-1}function Kg(l){l.collisionPadding&&(l.top-=l.collisionPadding[1],l.bottom+=l.collisionPadding[3]);const o=l.bottom-l.top;return o>0?Math.max(10,o):null}function II(l,o,u,f){const m=l.compareText;if(o in m){const y=m[o];for(let b=y.length-1;b>=0;b--)if(f.dist(y[b])<u)return!0}else m[o]=[];return m[o].push(f),!1}function Ob(l,o){const u=l.fovAboveCenter,f=l.elevation?l.elevation.getMinElevationBelowMSL()*o:0,m=(l._camera.position[2]*l.worldSize-f)/Math.cos(l._pitch),y=Math.sin(u)*m/Math.sin(Math.max(Math.PI/2-l._pitch-u,.01)),b=Math.sin(l._pitch)*y+m;return Math.min(1.01*b,m*(1/l._horizonShift))}function Up(l,o){if(!o.isReprojectedInTileSpace)return{scale:1<<l.z,x:l.x,y:l.y,x2:l.x+1,y2:l.y+1,projection:o};const u=Math.pow(2,-l.z),f=l.x*u,m=(l.x+1)*u,y=l.y*u,b=(l.y+1)*u,T=Bu(f),A=Bu(m),L=Ra(y),F=Ra(b),U=o.project(T,L),j=o.project(A,L),Y=o.project(A,F),J=o.project(T,F);let ee=Math.min(U.x,j.x,Y.x,J.x),ce=Math.min(U.y,j.y,Y.y,J.y),we=Math.max(U.x,j.x,Y.x,J.x),Pe=Math.max(U.y,j.y,Y.y,J.y);const be=u/16;function Me(ke,_t,mt,Pt,Jt,bt){const Bt=(mt+Jt)/2,Vt=(Pt+bt)/2,Zt=o.project(Bu(Bt),Ra(Vt)),$t=Math.max(0,ee-Zt.x,ce-Zt.y,Zt.x-we,Zt.y-Pe);ee=Math.min(ee,Zt.x),we=Math.max(we,Zt.x),ce=Math.min(ce,Zt.y),Pe=Math.max(Pe,Zt.y),$t>be&&(Me(ke,Zt,mt,Pt,Bt,Vt),Me(Zt,_t,Bt,Vt,Jt,bt))}Me(U,j,f,y,m,y),Me(j,Y,m,y,m,b),Me(Y,J,m,b,f,b),Me(J,U,f,b,f,y),ee-=be,ce-=be,we+=be,Pe+=be;const Ve=1/Math.max(we-ee,Pe-ce);return{scale:Ve,x:ee*Ve,y:ce*Ve,x2:we*Ve,y2:Pe*Ve,projection:o}}const hu=lu(new Float32Array(16));class ef{constructor(o){this.spec=o,this.name=o.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(o,u){return{x:0,y:0,z:0}}unproject(o,u){return new Ir(0,0)}projectTilePoint(o,u,f){return{x:o,y:u,z:0}}locationPoint(o,u,f=!0){return o._coordinatePoint(o.locationCoordinate(u),f)}pixelsPerMeter(o,u){return uh(1,o)*u}pixelSpaceConversion(o,u,f){return 1}farthestPixelDistance(o){return Ob(o,o.pixelsPerMeter)}pointCoordinate(o,u,f,m){const y=o.horizonLineFromTop(!1),b=new ie(u,Math.max(y,f));return o.rayIntersectionCoordinate(o.pointRayIntersection(b,m))}pointCoordinate3D(o,u,f){const m=new ie(u,f);if(o.elevation)return o.elevation.pointCoordinate(m);{const y=this.pointCoordinate(o,m.x,m.y,0);return[y.x,y.y,y.z]}}isPointAboveHorizon(o,u){if(o.elevation)return!this.pointCoordinate3D(o,u.x,u.y);const f=o.horizonLineFromTop();return u.y<f}createInversionMatrix(o,u){return hu}createTileMatrix(o,u,f){let m,y,b;const T=f.canonical,A=lu(new Float64Array(16));if(this.isReprojectedInTileSpace){const L=Up(T,this);m=1,y=L.x+f.wrap*L.scale,b=L.y,Od(A,A,[m/L.scale,m/L.scale,o.pixelsPerMeter/u])}else m=u/o.zoomScale(T.z),y=(T.x+Math.pow(2,T.z)*f.wrap)*m,b=T.y*m;return Ag(A,A,[y,b,0]),Od(A,A,[m/gi,m/gi,1]),A}upVector(o,u,f){return[0,0,1]}upVectorScale(o,u,f){return{metersToTile:1}}}class TI extends ef{constructor(o){super(o),this.range=[4,7],this.center=o.center||[-96,37.5];const[u,f]=this.parallels=o.parallels||[29.5,45.5],m=Math.sin(Fe(u));this.n=(m+Math.sin(Fe(f)))/2,this.c=1+m*(2*this.n-m),this.r0=Math.sqrt(this.c)/this.n}project(o,u){const{n:f,c:m,r0:y}=this,b=Fe(o-this.center[0]),T=Fe(u),A=Math.sqrt(m-2*f*Math.sin(T))/f;return{x:A*Math.sin(b*f),y:A*Math.cos(b*f)-y,z:0}}unproject(o,u){const{n:f,c:m,r0:y}=this,b=y+u;let T=Math.atan2(o,Math.abs(b))*Math.sign(b);b*f<0&&(T-=Math.PI*Math.sign(o)*Math.sign(b));const A=Fe(this.center[0])*f;T=Ot(T,-Math.PI-A,Math.PI-A);const L=nt(Ne(T/f)+this.center[0],-180,180),F=Math.asin(nt((m-(o*o+b*b)*f*f)/(2*f),-1,1)),U=nt(Ne(F),-Es,Es);return new Ir(L,U)}}const Jg=1.340264,Qg=-.081106,$g=893e-6,Vp=.003796,Oy=Math.sqrt(3)/2;class G0 extends ef{project(o,u){u=u/180*Math.PI,o=o/180*Math.PI;const f=Math.asin(Oy*Math.sin(u)),m=f*f,y=m*m*m;return{x:.5*(o*Math.cos(f)/(Oy*(Jg+3*Qg*m+y*(7*$g+9*Vp*m)))/Math.PI+.5),y:1-.5*(f*(Jg+Qg*m+y*($g+Vp*m))/Math.PI+1),z:0}}unproject(o,u){o=(2*o-.5)*Math.PI;let f=u=(2*(1-u)-1)*Math.PI,m=f*f,y=m*m*m;for(let F,U,j,Y=0;Y<12&&(U=f*(Jg+Qg*m+y*($g+Vp*m))-u,j=Jg+3*Qg*m+y*(7*$g+9*Vp*m),F=U/j,f=nt(f-F,-Math.PI/3,Math.PI/3),m=f*f,y=m*m*m,!(Math.abs(F)<1e-12));++Y);const b=Oy*o*(Jg+3*Qg*m+y*(7*$g+9*Vp*m))/Math.cos(f),T=Math.asin(Math.sin(f)/Oy),A=nt(180*b/Math.PI,-180,180),L=nt(180*T/Math.PI,-Es,Es);return new Ir(A,L)}}class SI extends ef{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0}project(o,u){return{x:.5+o/360,y:.5-u/360,z:0}}unproject(o,u){const f=360*(o-.5),m=nt(360*(.5-u),-Es,Es);return new Ir(f,m)}}const Dm=Math.PI/2;function Ny(l){return Math.tan((Dm+l)/2)}class CI extends ef{constructor(o){super(o),this.center=o.center||[0,30];const[u,f]=this.parallels=o.parallels||[30,30];let m=Fe(u),y=Fe(f);this.southernCenter=m+y<0,this.southernCenter&&(m=-m,y=-y);const b=Math.cos(m),T=Ny(m);this.n=m===y?Math.sin(m):Math.log(b/Math.cos(y))/Math.log(Ny(y)/T),this.f=b*Math.pow(Ny(m),this.n)/this.n}project(o,u){u=Fe(u),this.southernCenter&&(u=-u),o=Fe(o-this.center[0]);const f=1e-6,{n:m,f:y}=this;y>0?u<-Dm+f&&(u=-Dm+f):u>Dm-f&&(u=Dm-f);const b=y/Math.pow(Ny(u),m);let T=b*Math.sin(m*o),A=y-b*Math.cos(m*o);return T=.5*(T/Math.PI+.5),A=.5*(A/Math.PI+.5),{x:T,y:this.southernCenter?A:1-A,z:0}}unproject(o,u){o=(2*o-.5)*Math.PI,this.southernCenter&&(u=1-u),u=(2*(1-u)-.5)*Math.PI;const{n:f,f:m}=this,y=m-u,b=Math.sign(y),T=Math.sign(f)*Math.sqrt(o*o+y*y);let A=Math.atan2(o,Math.abs(y))*b;y*f<0&&(A-=Math.PI*Math.sign(o)*b);const L=nt(Ne(A/f)+this.center[0],-180,180),F=nt(Ne(2*Math.atan(Math.pow(m/T,1/f))-Dm),-Es,Es);return new Ir(L,this.southernCenter?-F:F)}}class j0 extends ef{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(o,u){return{x:Jh(o),y:Qh(u),z:0}}unproject(o,u){const f=Bu(o),m=Ra(u);return new Ir(f,m)}}const Nb=Fe(Es);class AI extends ef{project(o,u){const f=(u=Fe(u))*u,m=f*f;return{x:.5*((o=Fe(o))*(.8707-.131979*f+m*(m*(.003971*f-.001529*m)-.013791))/Math.PI+.5),y:1-.5*(u*(1.007226+f*(.015085+m*(.028874*f-.044475-.005916*m)))/Math.PI+1),z:0}}unproject(o,u){o=(2*o-.5)*Math.PI;let f=u=(2*(1-u)-1)*Math.PI,m=25,y=0,b=f*f;do{b=f*f;const L=b*b;y=(f*(1.007226+b*(.015085+L*(.028874*b-.044475-.005916*L)))-u)/(1.007226+b*(.045255+L*(.259866*b-.311325-.005916*11*L))),f=nt(f-y,-Nb,Nb)}while(Math.abs(y)>1e-6&&--m>0);b=f*f;const T=nt(Ne(o/(.8707+b*(b*(b*b*b*(.003971-.001529*b)-.013791)-.131979))),-180,180),A=Ne(f);return new Ir(T,A)}}const kb=Fe(Es);class q0 extends ef{project(o,u){u=Fe(u),o=Fe(o);const f=Math.cos(u),m=2/Math.PI,y=Math.acos(f*Math.cos(o/2)),b=Math.sin(y)/y,T=.5*(o*m+2*f*Math.sin(o/2)/b)||0,A=.5*(u+Math.sin(u)/b)||0;return{x:.5*(T/Math.PI+.5),y:1-.5*(A/Math.PI+1),z:0}}unproject(o,u){let f=o=(2*o-.5)*Math.PI,m=u=(2*(1-u)-1)*Math.PI,y=25;const b=1e-6;let T=0,A=0;do{const L=Math.cos(m),F=Math.sin(m),U=2*F*L,j=F*F,Y=L*L,J=Math.cos(f/2),ee=Math.sin(f/2),ce=2*J*ee,we=ee*ee,Pe=1-Y*J*J,be=Pe?1/Pe:0,Me=Pe?Math.acos(L*J)*Math.sqrt(1/Pe):0,Ve=.5*(2*Me*L*ee+2*f/Math.PI)-o,ke=.5*(Me*F+m)-u,_t=.5*be*(Y*we+Me*L*J*j)+1/Math.PI,mt=be*(ce*U/4-Me*F*ee),Pt=.125*be*(U*ee-Me*F*Y*ce),Jt=.5*be*(j*J+Me*we*L)+.5,bt=mt*Pt-Jt*_t;T=(ke*mt-Ve*Jt)/bt,A=(Ve*Pt-ke*_t)/bt,f=nt(f-T,-Math.PI,Math.PI),m=nt(m-A,-kb,kb)}while((Math.abs(T)>b||Math.abs(A)>b)&&--y>0);return new Ir(Ne(f),Ne(m))}}class ky extends ef{constructor(o){super(o),this.center=o.center||[0,0],this.parallels=o.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Fe(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(o,u){const{scale:f,cosPhi:m}=this;return{x:Fe(o)*m*f+.5,y:-Math.sin(Fe(u))/m*f+.5,z:0}}unproject(o,u){const{scale:f,cosPhi:m}=this,y=-(u-.5)/f,b=nt(Ne((o-.5)/f)/m,-180,180),T=Math.asin(nt(y*m,-1,1)),A=nt(Ne(T),-Es,Es);return new Ir(b,A)}}class MI extends j0{constructor(o){super(o),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(o,u,f){const m=Ng(o,u,f);return Qs(m,m,kg(ah(f))),{x:m[0],y:m[1],z:m[2]}}locationPoint(o,u){const f=bm(u.lat,u.lng),m=Ro([],f),y=o.elevation?o.elevation.getAtPointOrZero(o.locationCoordinate(u),o._centerAltitude):o._centerAltitude;Rp(f,f,m,uh(1,0)*gi*y);const b=lu(new Float64Array(16));return Vf(b,o.pixelMatrix,o.globeMatrix),Qs(f,f,b),new ie(f[0],f[1])}pixelsPerMeter(o,u){return uh(1,0)*u}pixelSpaceConversion(o,u,f){const m=uh(1,o)*u,y=Mi(uh(1,45)*u,m,f);return this.pixelsPerMeter(o,u)/y}createTileMatrix(o,u,f){const m=c0(ah(f.canonical));return Vf(new Float64Array(16),o.globeMatrix,m)}createInversionMatrix(o,u){const{center:f}=o,m=kg(ah(u));return Mg(m,m,Fe(f.lng)),rh(m,m,Fe(f.lat)),Od(m,m,[o._pixelsPerMercatorPixel,o._pixelsPerMercatorPixel,1]),Float32Array.from(m)}pointCoordinate(o,u,f,m){return vm(o,u,f,!0)||new wm(0,0)}pointCoordinate3D(o,u,f){const m=this.pointCoordinate(o,u,f,0);return[m.x,m.y,m.z]}isPointAboveHorizon(o,u){return!vm(o,u.x,u.y,!1)}farthestPixelDistance(o){const u=function(m,y){const b=m.cameraToCenterDistance,T=m._centerAltitude*y,A=m._camera,L=m._camera.forward(),F=sh([],pl([],L,-b),[0,0,T]),U=m.worldSize/(2*Math.PI),j=[0,0,-U],Y=m.width/m.height,J=Math.tan(m.fovAboveCenter),ee=pl([],A.up(),J),ce=pl([],A.right(),J*Y),we=Ro([],sh([],sh([],L,ee),ce)),Pe=[];let be;if(new ty(F,we).closestPointOnSphere(j,U,Pe)){const Me=sh([],Pe,j),Ve=oh([],Me,F);be=Math.cos(m.fovAboveCenter)*ku(Ve)}else{const Me=oh([],F,j),Ve=oh([],j,F);Ro(Ve,Ve);const ke=ku(Me)-U;be=Math.sqrt(ke*(ke+2*U));const _t=Math.acos(be/(U+ke))-Math.acos(vc(L,Ve));be*=Math.cos(_t)}return 1.01*be}(o,this.pixelsPerMeter(o.center.lat,o.worldSize)),f=Em(o.zoom);if(f>0){const m=Ob(o,uh(1,o.center.lat)*o.worldSize),y=o.worldSize/(2*Math.PI),b=Math.max(o.width,o.height)/o.worldSize*Math.PI;return Mi(u,m+y*(1-Math.cos(b)),Math.pow(f,10))}return u}upVector(o,u,f){return Ng(u,f,o,1)}upVectorScale(o){return{metersToTile:Og(oy(ah(o)))}}}function Fb(l){const o=l.parallels,u=!!o&&Math.abs(o[0]+o[1])<.01;switch(l.name){case"mercator":return new j0(l);case"equirectangular":return new SI(l);case"naturalEarth":return new AI(l);case"equalEarth":return new G0(l);case"winkelTripel":return new q0(l);case"albers":return u?new ky(l):new TI(l);case"lambertConformalConic":return u?new ky(l):new CI(l);case"globe":return new MI(l)}throw new Error(`Invalid projection name: ${l.name}`)}const LI=wy.types,PI=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Fy(l,o,u,f,m,y,b,T,A,L,F,U,j){const Y=T?Math.min(Xf,Math.round(T[0])):0,J=T?Math.min(Xf,Math.round(T[1])):0;l.emplaceBack(o,u,Math.round(32*f),Math.round(32*m),y,b,(Y<<1)+(A?1:0),J,16*L,16*F,256*U,256*j)}function By(l,o,u,f,m,y,b){l.emplaceBack(o,u,f,m,y,b)}function zy(l,o,u,f,m){l.emplaceBack(o,u,f,m),l.emplaceBack(o,u,f,m),l.emplaceBack(o,u,f,m),l.emplaceBack(o,u,f,m)}function RI(l){for(const o of l.sections)if($(o.text))return!0;return!1}class H0{constructor(o){this.layoutVertexArray=new su,this.indexArray=new da,this.programConfigurations=o,this.segments=new Gs,this.dynamicLayoutVertexArray=new Jr,this.opacityVertexArray=new ts,this.placedSymbolArray=new ix,this.globeExtVertexArray=new bs}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(o,u,f,m){this.isEmpty()||(f&&(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,zu.members),this.indexBuffer=o.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=o.createVertexBuffer(this.dynamicLayoutVertexArray,Jw.members,!0),this.opacityVertexBuffer=o.createVertexBuffer(this.opacityVertexArray,PI,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,Cm.members,!0)),this.opacityVertexBuffer.itemSize=1),(f||m)&&this.programConfigurations.upload(o))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Cn(H0,"SymbolBuffers");class W0{constructor(o,u,f){this.layoutVertexArray=new o,this.layoutAttributes=u,this.indexArray=new f,this.segments=new Gs,this.collisionVertexArray=new _s,this.collisionVertexArrayExt=new na}upload(o){this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=o.createVertexBuffer(this.collisionVertexArray,Qw.members,!0),this.collisionVertexBufferExt=o.createVertexBuffer(this.collisionVertexArrayExt,$w.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Cn(W0,"CollisionBuffers");class Vd{constructor(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(b=>b.id),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=lu([]),this.placementViewportMatrix=lu([]);const u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ur(this.zoom,u["text-size"]),this.iconSizeData=ur(this.zoom,u["icon-size"]);const f=this.layers[0].layout,m=f.get("symbol-sort-key"),y=f.get("symbol-z-order");this.canOverlap=f.get("text-allow-overlap")||f.get("icon-allow-overlap")||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&m.constantOr(1)!==void 0,this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=f.get("text-writing-mode").map(b=>Uu[b]),this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id),this.sourceID=o.sourceID,this.projection=o.projection}createArrays(){this.text=new H0(new yc(this.layers,this.zoom,o=>/^text/.test(o))),this.icon=new H0(new yc(this.layers,this.zoom,o=>/^icon/.test(o))),this.glyphOffsetArray=new Qv,this.lineVertexArray=new $v,this.symbolInstances=new q_}calculateGlyphDependencies(o,u,f,m,y){for(let b=0;b<o.length;b++)if(u[o.charCodeAt(b)]=!0,m&&y){const T=Qr[o.charAt(b)];T&&(u[T.charCodeAt(0)]=!0)}}populate(o,u,f,m){const y=this.layers[0],b=y.layout,T=this.projection.name==="globe",A=b.get("text-font"),L=b.get("text-field"),F=b.get("icon-image"),U=(L.value.kind!=="constant"||L.value.value instanceof Go&&!L.value.value.isEmpty()||L.value.value.toString().length>0)&&(A.value.kind!=="constant"||A.value.value.length>0),j=F.value.kind!=="constant"||!!F.value.value||Object.keys(F.parameters).length>0,Y=b.get("symbol-sort-key");if(this.features=[],!U&&!j)return;const J=u.iconDependencies,ee=u.glyphDependencies,ce=u.availableImages,we=new lt(this.zoom);for(const{feature:Pe,id:be,index:Me,sourceLayerIndex:Ve}of o){const ke=y._featureFilter.needGeometry,_t=kp(Pe,ke);if(!y._featureFilter.filter(we,_t,f))continue;if(ke||(_t.geometry=jf(Pe,f,m)),T&&Pe.type!==1&&f.z<=5){const bt=_t.geometry,Bt=.98078528056,Vt=(Zt,$t)=>vc(Ng(Zt.x,Zt.y,f,1),Ng($t.x,$t.y,f,1))<Bt;for(let Zt=0;Zt<bt.length;Zt++)bt[Zt]=fw(bt[Zt],Vt)}let mt,Pt;if(U){const bt=y.getValueAndResolveTokens("text-field",_t,f,ce),Bt=Go.factory(bt);RI(Bt)&&(this.hasRTLText=!0),(!this.hasRTLText||ze()==="unavailable"||this.hasRTLText&&qe.isParsed())&&(mt=tI(Bt,y,_t))}if(j){const bt=y.getValueAndResolveTokens("icon-image",_t,f,ce);Pt=bt instanceof ua?bt:ua.fromString(bt)}if(!mt&&!Pt)continue;const Jt=this.sortFeaturesByKey?Y.evaluate(_t,{},f):void 0;if(this.features.push({id:be,text:mt,icon:Pt,index:Me,sourceLayerIndex:Ve,geometry:_t.geometry,properties:Pe.properties,type:LI[Pe.type],sortKey:Jt}),Pt&&(J[Pt.name]=!0),mt){const bt=A.evaluate(_t,{},f).join(","),Bt=b.get("text-rotation-alignment")==="map"&&b.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Uu.vertical)>=0;for(const Vt of mt.sections)if(Vt.image)J[Vt.image.name]=!0;else{const Zt=w(mt.toString()),$t=Vt.fontStack||bt,Et=ee[$t]=ee[$t]||{};this.calculateGlyphDependencies(Vt.text,Et,Bt,this.allowVerticalPlacement,Zt)}}}b.get("symbol-placement")==="line"&&(this.features=function(Pe){const be={},Me={},Ve=[];let ke=0;function _t(bt){Ve.push(Pe[bt]),ke++}function mt(bt,Bt,Vt){const Zt=Me[bt];return delete Me[bt],Me[Bt]=Zt,Ve[Zt].geometry[0].pop(),Ve[Zt].geometry[0]=Ve[Zt].geometry[0].concat(Vt[0]),Zt}function Pt(bt,Bt,Vt){const Zt=be[Bt];return delete be[Bt],be[bt]=Zt,Ve[Zt].geometry[0].shift(),Ve[Zt].geometry[0]=Vt[0].concat(Ve[Zt].geometry[0]),Zt}function Jt(bt,Bt,Vt){const Zt=Vt?Bt[0][Bt[0].length-1]:Bt[0][0];return`${bt}:${Zt.x}:${Zt.y}`}for(let bt=0;bt<Pe.length;bt++){const Bt=Pe[bt],Vt=Bt.geometry,Zt=Bt.text?Bt.text.toString():null;if(!Zt){_t(bt);continue}const $t=Jt(Zt,Vt),Et=Jt(Zt,Vt,!0);if($t in Me&&Et in be&&Me[$t]!==be[Et]){const yn=Pt($t,Et,Vt),mi=mt($t,Et,Ve[yn].geometry);delete be[$t],delete Me[Et],Me[Jt(Zt,Ve[mi].geometry,!0)]=mi,Ve[yn].geometry=null}else $t in Me?mt($t,Et,Vt):Et in be?Pt($t,Et,Vt):(_t(bt),be[$t]=ke-1,Me[Et]=ke-1)}return Ve.filter(bt=>bt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Pe,be)=>Pe.sortKey-be.sortKey)}update(o,u,f,m){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(o,u,this.layers,f,m),this.icon.programConfigurations.updatePaintArrays(o,u,this.layers,f,m))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(o){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(o),this.iconCollisionBox.upload(o)),this.text.upload(o,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(o,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Fb(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(o,u){const f=this.lineVertexArray.length;if(o.segment!==void 0)for(const{x:m,y}of u)this.lineVertexArray.emplaceBack(m,y);return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(o,u,f,m,y,b,T,A,L,F,U,j,Y,J){const ee=o.indexArray,ce=o.layoutVertexArray,we=o.globeExtVertexArray,Pe=o.segments.prepareSegment(4*u.length,ce,ee,this.canOverlap?b.sortKey:void 0),be=this.glyphOffsetArray.length,Me=Pe.vertexLength,Ve=this.allowVerticalPlacement&&T===Uu.vertical?Math.PI/2:0,ke=b.text&&b.text.sections;for(let mt=0;mt<u.length;mt++){const{tl:Pt,tr:Jt,bl:bt,br:Bt,tex:Vt,pixelOffsetTL:Zt,pixelOffsetBR:$t,minFontScaleX:Et,minFontScaleY:yn,glyphOffset:mi,isSDF:Mn,sectionIndex:Jn}=u[mt],xn=Pe.vertexLength,_i=mi[1];if(Fy(ce,L.x,L.y,Pt.x,_i+Pt.y,Vt.x,Vt.y,f,Mn,Zt.x,Zt.y,Et,yn),Fy(ce,L.x,L.y,Jt.x,_i+Jt.y,Vt.x+Vt.w,Vt.y,f,Mn,$t.x,Zt.y,Et,yn),Fy(ce,L.x,L.y,bt.x,_i+bt.y,Vt.x,Vt.y+Vt.h,f,Mn,Zt.x,$t.y,Et,yn),Fy(ce,L.x,L.y,Bt.x,_i+Bt.y,Vt.x+Vt.w,Vt.y+Vt.h,f,Mn,$t.x,$t.y,Et,yn),A){const{x:dr,y:cr,z:rr}=A.anchor,[yi,ss,Ri]=A.up;By(we,dr,cr,rr,yi,ss,Ri),By(we,dr,cr,rr,yi,ss,Ri),By(we,dr,cr,rr,yi,ss,Ri),By(we,dr,cr,rr,yi,ss,Ri),zy(o.dynamicLayoutVertexArray,dr,cr,rr,Ve)}else zy(o.dynamicLayoutVertexArray,L.x,L.y,L.z,Ve);ee.emplaceBack(xn,xn+1,xn+2),ee.emplaceBack(xn+1,xn+2,xn+3),Pe.vertexLength+=4,Pe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(mi[0]),mt!==u.length-1&&Jn===u[mt+1].sectionIndex||o.programConfigurations.populatePaintArrays(ce.length,b,b.index,{},Y,J,ke&&ke[Jn])}const _t=A?A.anchor:L;o.placedSymbolArray.emplaceBack(_t.x,_t.y,_t.z,L.x,L.y,be,this.glyphOffsetArray.length-be,Me,F,U,L.segment,f?f[0]:0,f?f[1]:0,m[0],m[1],T,0,!1,0,j,0)}_commitLayoutVertex(o,u,f,m,y,b,T){o.emplaceBack(u,f,m,y,b,Math.round(T.x),Math.round(T.y))}_addCollisionDebugVertices(o,u,f,m,y,b,T){const A=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),L=A.vertexLength,F=T.tileAnchorX,U=T.tileAnchorY;for(let Y=0;Y<4;Y++)f.collisionVertexArray.emplaceBack(0,0,0,0);f.collisionVertexArrayExt.emplaceBack(u,-o.padding,-o.padding),f.collisionVertexArrayExt.emplaceBack(u,o.padding,-o.padding),f.collisionVertexArrayExt.emplaceBack(u,o.padding,o.padding),f.collisionVertexArrayExt.emplaceBack(u,-o.padding,o.padding),this._commitLayoutVertex(f.layoutVertexArray,m,y,b,F,U,new ie(o.x1,o.y1)),this._commitLayoutVertex(f.layoutVertexArray,m,y,b,F,U,new ie(o.x2,o.y1)),this._commitLayoutVertex(f.layoutVertexArray,m,y,b,F,U,new ie(o.x2,o.y2)),this._commitLayoutVertex(f.layoutVertexArray,m,y,b,F,U,new ie(o.x1,o.y2)),A.vertexLength+=4;const j=f.indexArray;j.emplaceBack(L,L+1),j.emplaceBack(L+1,L+2),j.emplaceBack(L+2,L+3),j.emplaceBack(L+3,L),A.primitiveLength+=4}_addTextDebugCollisionBoxes(o,u,f,m,y,b){for(let T=m;T<y;T++){const A=f.get(T),L=this.getSymbolInstanceTextSize(o,b,u,T);this._addCollisionDebugVertices(A,L,this.textCollisionBox,A.projectedAnchorX,A.projectedAnchorY,A.projectedAnchorZ,b)}}_addIconDebugCollisionBoxes(o,u,f,m,y,b){for(let T=m;T<y;T++){const A=f.get(T),L=this.getSymbolInstanceIconSize(o,u,b.placedIconSymbolIndex);this._addCollisionDebugVertices(A,L,this.iconCollisionBox,A.projectedAnchorX,A.projectedAnchorY,A.projectedAnchorZ,b)}}generateCollisionDebugBuffers(o,u){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new W0(Js,ab.members,Wh),this.iconCollisionBox=new W0(Js,ab.members,Wh);const f=il(this.iconSizeData,o),m=il(this.textSizeData,o);for(let y=0;y<this.symbolInstances.length;y++){const b=this.symbolInstances.get(y);this._addTextDebugCollisionBoxes(m,o,u,b.textBoxStartIndex,b.textBoxEndIndex,b),this._addTextDebugCollisionBoxes(m,o,u,b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b),this._addIconDebugCollisionBoxes(f,o,u,b.iconBoxStartIndex,b.iconBoxEndIndex,b),this._addIconDebugCollisionBoxes(f,o,u,b.verticalIconBoxStartIndex,b.verticalIconBoxEndIndex,b)}}getSymbolInstanceTextSize(o,u,f,m){const y=this.text.placedSymbolArray.get(u.rightJustifiedTextSymbolIndex>=0?u.rightJustifiedTextSymbolIndex:u.centerJustifiedTextSymbolIndex>=0?u.centerJustifiedTextSymbolIndex:u.leftJustifiedTextSymbolIndex>=0?u.leftJustifiedTextSymbolIndex:u.verticalPlacedTextSymbolIndex>=0?u.verticalPlacedTextSymbolIndex:m),b=Xg(this.textSizeData,o,y)/ma;return this.tilePixelRatio*b}getSymbolInstanceIconSize(o,u,f){const m=this.icon.placedSymbolArray.get(f),y=Xg(this.iconSizeData,o,m);return this.tilePixelRatio*y}_commitDebugCollisionVertexUpdate(o,u,f){o.emplaceBack(u,-f,-f),o.emplaceBack(u,f,-f),o.emplaceBack(u,f,f),o.emplaceBack(u,-f,f)}_updateTextDebugCollisionBoxes(o,u,f,m,y,b){for(let T=m;T<y;T++){const A=f.get(T),L=this.getSymbolInstanceTextSize(o,b,u,T);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,L,A.padding)}}_updateIconDebugCollisionBoxes(o,u,f,m,y,b){for(let T=m;T<y;T++){const A=f.get(T),L=this.getSymbolInstanceIconSize(o,u,b);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,L,A.padding)}}updateCollisionDebugBuffers(o,u){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const f=il(this.iconSizeData,o),m=il(this.textSizeData,o);for(let y=0;y<this.symbolInstances.length;y++){const b=this.symbolInstances.get(y);this._updateTextDebugCollisionBoxes(m,o,u,b.textBoxStartIndex,b.textBoxEndIndex,b),this._updateTextDebugCollisionBoxes(m,o,u,b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b),this._updateIconDebugCollisionBoxes(f,o,u,b.iconBoxStartIndex,b.iconBoxEndIndex,b.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(f,o,u,b.verticalIconBoxStartIndex,b.verticalIconBoxEndIndex,b.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(o,u,f,m,y,b,T,A,L){const F={};if(u<f){const{x1:U,y1:j,x2:Y,y2:J,padding:ee,projectedAnchorX:ce,projectedAnchorY:we,projectedAnchorZ:Pe,tileAnchorX:be,tileAnchorY:Me,featureIndex:Ve}=o.get(u);F.textBox={x1:U,y1:j,x2:Y,y2:J,padding:ee,projectedAnchorX:ce,projectedAnchorY:we,projectedAnchorZ:Pe,tileAnchorX:be,tileAnchorY:Me},F.textFeatureIndex=Ve}if(m<y){const{x1:U,y1:j,x2:Y,y2:J,padding:ee,projectedAnchorX:ce,projectedAnchorY:we,projectedAnchorZ:Pe,tileAnchorX:be,tileAnchorY:Me,featureIndex:Ve}=o.get(m);F.verticalTextBox={x1:U,y1:j,x2:Y,y2:J,padding:ee,projectedAnchorX:ce,projectedAnchorY:we,projectedAnchorZ:Pe,tileAnchorX:be,tileAnchorY:Me},F.verticalTextFeatureIndex=Ve}if(b<T){const{x1:U,y1:j,x2:Y,y2:J,padding:ee,projectedAnchorX:ce,projectedAnchorY:we,projectedAnchorZ:Pe,tileAnchorX:be,tileAnchorY:Me,featureIndex:Ve}=o.get(b);F.iconBox={x1:U,y1:j,x2:Y,y2:J,padding:ee,projectedAnchorX:ce,projectedAnchorY:we,projectedAnchorZ:Pe,tileAnchorX:be,tileAnchorY:Me},F.iconFeatureIndex=Ve}if(A<L){const{x1:U,y1:j,x2:Y,y2:J,padding:ee,projectedAnchorX:ce,projectedAnchorY:we,projectedAnchorZ:Pe,tileAnchorX:be,tileAnchorY:Me,featureIndex:Ve}=o.get(A);F.verticalIconBox={x1:U,y1:j,x2:Y,y2:J,padding:ee,projectedAnchorX:ce,projectedAnchorY:we,projectedAnchorZ:Pe,tileAnchorX:be,tileAnchorY:Me},F.verticalIconFeatureIndex=Ve}return F}deserializeCollisionBoxes(o){this.collisionArrays=[];for(let u=0;u<this.symbolInstances.length;u++){const f=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(o,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(o,u){const f=o.placedSymbolArray.get(u),m=f.vertexStartIndex+4*f.numGlyphs;for(let y=f.vertexStartIndex;y<m;y+=4)o.indexArray.emplaceBack(y,y+1,y+2),o.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(o){if(this.sortedAngle===o&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const u=Math.sin(o),f=Math.cos(o),m=[],y=[],b=[];for(let T=0;T<this.symbolInstances.length;++T){b.push(T);const A=this.symbolInstances.get(T);m.push(0|Math.round(u*A.tileAnchorX+f*A.tileAnchorY)),y.push(A.featureIndex)}return b.sort((T,A)=>m[T]-m[A]||y[A]-y[T]),b}addToSortKeyRanges(o,u){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===u?f.symbolInstanceEnd=o+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:o,symbolInstanceEnd:o+1})}sortFeatures(o){if(this.sortFeaturesByY&&this.sortedAngle!==o&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(o),this.sortedAngle=o,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const u of this.symbolInstanceIndexes){const f=this.symbolInstances.get(u);this.featureSortOrder.push(f.featureIndex);const{rightJustifiedTextSymbolIndex:m,centerJustifiedTextSymbolIndex:y,leftJustifiedTextSymbolIndex:b,verticalPlacedTextSymbolIndex:T,placedIconSymbolIndex:A,verticalPlacedIconSymbolIndex:L}=f;m>=0&&this.addIndicesForPlacedSymbol(this.text,m),y>=0&&y!==m&&this.addIndicesForPlacedSymbol(this.text,y),b>=0&&b!==y&&b!==m&&this.addIndicesForPlacedSymbol(this.text,b),T>=0&&this.addIndicesForPlacedSymbol(this.text,T),A>=0&&this.addIndicesForPlacedSymbol(this.icon,A),L>=0&&this.addIndicesForPlacedSymbol(this.icon,L)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Cn(Vd,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Vd.MAX_GLYPHS=65535,Vd.addDynamicAttributes=zy;const DI=new Ht({"symbol-placement":new at(wt.layout_symbol["symbol-placement"]),"symbol-spacing":new at(wt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new at(wt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new yt(wt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new at(wt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new at(wt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new at(wt.layout_symbol["icon-ignore-placement"]),"icon-optional":new at(wt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new at(wt.layout_symbol["icon-rotation-alignment"]),"icon-size":new yt(wt.layout_symbol["icon-size"]),"icon-text-fit":new at(wt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new at(wt.layout_symbol["icon-text-fit-padding"]),"icon-image":new yt(wt.layout_symbol["icon-image"]),"icon-rotate":new yt(wt.layout_symbol["icon-rotate"]),"icon-padding":new at(wt.layout_symbol["icon-padding"]),"icon-keep-upright":new at(wt.layout_symbol["icon-keep-upright"]),"icon-offset":new yt(wt.layout_symbol["icon-offset"]),"icon-anchor":new yt(wt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new at(wt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new at(wt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new at(wt.layout_symbol["text-rotation-alignment"]),"text-field":new yt(wt.layout_symbol["text-field"]),"text-font":new yt(wt.layout_symbol["text-font"]),"text-size":new yt(wt.layout_symbol["text-size"]),"text-max-width":new yt(wt.layout_symbol["text-max-width"]),"text-line-height":new yt(wt.layout_symbol["text-line-height"]),"text-letter-spacing":new yt(wt.layout_symbol["text-letter-spacing"]),"text-justify":new yt(wt.layout_symbol["text-justify"]),"text-radial-offset":new yt(wt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new at(wt.layout_symbol["text-variable-anchor"]),"text-anchor":new yt(wt.layout_symbol["text-anchor"]),"text-max-angle":new at(wt.layout_symbol["text-max-angle"]),"text-writing-mode":new at(wt.layout_symbol["text-writing-mode"]),"text-rotate":new yt(wt.layout_symbol["text-rotate"]),"text-padding":new at(wt.layout_symbol["text-padding"]),"text-keep-upright":new at(wt.layout_symbol["text-keep-upright"]),"text-transform":new yt(wt.layout_symbol["text-transform"]),"text-offset":new yt(wt.layout_symbol["text-offset"]),"text-allow-overlap":new at(wt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new at(wt.layout_symbol["text-ignore-placement"]),"text-optional":new at(wt.layout_symbol["text-optional"])});var X0={paint:new Ht({"icon-opacity":new yt(wt.paint_symbol["icon-opacity"]),"icon-color":new yt(wt.paint_symbol["icon-color"]),"icon-halo-color":new yt(wt.paint_symbol["icon-halo-color"]),"icon-halo-width":new yt(wt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new yt(wt.paint_symbol["icon-halo-blur"]),"icon-translate":new at(wt.paint_symbol["icon-translate"]),"icon-translate-anchor":new at(wt.paint_symbol["icon-translate-anchor"]),"text-opacity":new yt(wt.paint_symbol["text-opacity"]),"text-color":new yt(wt.paint_symbol["text-color"],{runtimeType:Ca,getOverride:l=>l.textColor,hasOverride:l=>!!l.textColor}),"text-halo-color":new yt(wt.paint_symbol["text-halo-color"]),"text-halo-width":new yt(wt.paint_symbol["text-halo-width"]),"text-halo-blur":new yt(wt.paint_symbol["text-halo-blur"]),"text-translate":new at(wt.paint_symbol["text-translate"]),"text-translate-anchor":new at(wt.paint_symbol["text-translate-anchor"])}),layout:DI};class Bb{constructor(o){this.type=o.property.overrides?o.property.overrides.runtimeType:rc,this.defaultValue=o}evaluate(o){if(o.formattedSection){const u=this.defaultValue.property.overrides;if(u&&u.hasOverride(o.formattedSection))return u.getOverride(o.formattedSection)}return o.feature&&o.featureState?this.defaultValue.evaluate(o.feature,o.featureState):this.defaultValue.property.specification.default}eachChild(o){this.defaultValue.isConstant()||o(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Cn(Bb,"FormatSectionOverride",{omit:["defaultValue"]});class Uy extends nh{constructor(o){super(o,X0)}recalculate(o,u){super.recalculate(o,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const f=this.layout.get("text-writing-mode");if(f){const m=[];for(const y of f)m.indexOf(y)<0&&m.push(y);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(o,u,f,m){const y=this.layout.get(o).evaluate(u,{},f,m),b=this._unevaluatedLayout._values[o];return b.isDataDriven()||Of(b.value)||!y?y:function(T,A){return A.replace(/{([^{}]+)}/g,(L,F)=>F in T?String(T[F]):"")}(u.properties,y)}createBucket(o){return new Vd(o)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const o of X0.paint.overridableProperties){if(!Uy.hasPaintOverride(this.layout,o))continue;const u=this.paint.get(o),f=new Bb(u),m=new fc(f,u.property.specification);let y=null;y=u.value.kind==="constant"||u.value.kind==="source"?new vp("source",m):new Ou("composite",m,u.value.zoomStops,u.value._interpolationType),this.paint._values[o]=new Wt(u.property,y,u.parameters)}}_handleOverridablePaintPropertyUpdate(o,u,f){return!(!this.layout||u.isDataDriven()||f.isDataDriven())&&Uy.hasPaintOverride(this.layout,o)}static hasPaintOverride(o,u){const f=o.get("text-field"),m=X0.paint.properties[u];let y=!1;const b=T=>{for(const A of T)if(m.overrides&&m.overrides.hasOverride(A))return void(y=!0)};if(f.value.kind==="constant"&&f.value.value instanceof Go)b(f.value.value.sections);else if(f.value.kind==="source"){const T=L=>{y||(L instanceof Sh&&so(L.value)===Ae?b(L.value.sections):L instanceof Kr?b(L.sections):L.eachChild(T))},A=f.value;A._styleExpression&&T(A._styleExpression.expression)}return y}getProgramConfiguration(o){return new th(this,o)}}var OI={paint:new Ht({"background-color":new at(wt.paint_background["background-color"]),"background-pattern":new at(wt.paint_background["background-pattern"]),"background-opacity":new at(wt.paint_background["background-opacity"])})},NI={paint:new Ht({"raster-opacity":new at(wt.paint_raster["raster-opacity"]),"raster-hue-rotate":new at(wt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new at(wt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new at(wt.paint_raster["raster-brightness-max"]),"raster-saturation":new at(wt.paint_raster["raster-saturation"]),"raster-contrast":new at(wt.paint_raster["raster-contrast"]),"raster-resampling":new at(wt.paint_raster["raster-resampling"]),"raster-fade-duration":new at(wt.paint_raster["raster-fade-duration"])})};class kI extends nh{constructor(o){super(o,{}),this.implementation=o}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(o){this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)}onRemove(o){this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)}}var FI={paint:new Ht({"sky-type":new at(wt.paint_sky["sky-type"]),"sky-atmosphere-sun":new at(wt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new at(wt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new at(wt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new at(wt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Gt(wt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new at(wt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new at(wt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new at(wt.paint_sky["sky-opacity"])})};function Z0(l,o,u){const f=[0,0,1],m=Zh([]);return ey(m,m,u?-Fe(l)+Math.PI:Fe(l)),ml(m,m,-Fe(o)),tl(f,f,m),Ro(f,f)}const BI={circle:class extends nh{constructor(l){super(l,_w)}createBucket(l){return new y0(l)}queryRadius(l){const o=l;return Im("circle-radius",this,o)+Im("circle-stroke-width",this,o)+cy(this.paint.get("circle-translate"))}queryIntersectsFeature(l,o,u,f,m,y,b,T){const A=hy(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),y.angle,l.pixelToTileUnitsFactor),L=this.paint.get("circle-radius").evaluate(o,u)+this.paint.get("circle-stroke-width").evaluate(o,u);return zx(l,f,y,b,T,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",A,L)}getProgramIds(){return["circle"]}getProgramConfiguration(l){return new th(this,l)}},heatmap:class extends nh{createBucket(l){return new Vx(l)}constructor(l){super(l,bw),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=w0({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(l){return Im("heatmap-radius",this,l)}queryIntersectsFeature(l,o,u,f,m,y,b,T){const A=this.paint.get("heatmap-radius").evaluate(o,u);return zx(l,f,y,b,T,!0,!0,new ie(0,0),A)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(l){return new th(this,l)}},hillshade:class extends nh{constructor(l){super(l,Ew)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends nh{constructor(l){super(l,Dw)}getProgramIds(){const l=this.paint.get("fill-pattern"),o=l&&l.constantOr(1),u=[o?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&u.push(o&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),u}getProgramConfiguration(l){return new th(this,l)}recalculate(l,o){super.recalculate(l,o);const u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new jg(l)}queryRadius(){return cy(this.paint.get("fill-translate"))}queryIntersectsFeature(l,o,u,f,m,y){return!l.queryGeometry.isAboveHorizon&&Dx(Fx(l.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),y.angle,l.pixelToTileUnitsFactor),f)}isTileClipped(){return!0}},"fill-extrusion":class extends nh{constructor(l){super(l,Hw)}createBucket(l){return new Xi(l)}queryRadius(){return cy(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(l){return new th(this,l)}queryIntersectsFeature(l,o,u,f,m,y,b,T,A){const L=hy(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),y.angle,l.pixelToTileUnitsFactor),F=this.paint.get("fill-extrusion-height").evaluate(o,u),U=this.paint.get("fill-extrusion-base").evaluate(o,u),j=[0,0],Y=T&&y.elevation,J=y.elevation?y.elevation.exaggeration():1,ee=l.tile.getBucket(this);if(Y&&ee instanceof Xi){const Me=ee.centroidVertexArray,Ve=A+1;Ve<Me.length&&(j[0]=Me.geta_centroid_pos0(Ve),j[1]=Me.geta_centroid_pos1(Ve))}if(j[0]===0&&j[1]===1)return!1;y.projection.name==="globe"&&(f=ib([f],[new ie(0,0),new ie(gi,gi)],l.tileID.canonical).map(Me=>Me.polygon).flat());const ce=Y?T:null,[we,Pe]=function(Me,Ve,ke,_t,mt,Pt,Jt,bt,Bt,Vt,Zt){return Me.projection.name==="globe"?function($t,Et,yn,mi,Mn,Jn,xn,_i,dr,cr,rr){const yi=[],ss=[],Ri=$t.projection.upVectorScale(rr,$t.center.lat,$t.worldSize).metersToTile,pr=[0,0,0,1],fs=[0,0,0,1],As=(Ms,Ns,vo,rl)=>{Ms[0]=Ns,Ms[1]=vo,Ms[2]=rl,Ms[3]=1},ws=nb();yn>0&&(yn+=ws),mi+=ws;for(const Ms of Et){const Ns=[],vo=[];for(const rl of Ms){const os=rl.x+Mn.x,ia=rl.y+Mn.y,Wo=$t.projection.projectTilePoint(os,ia,rr),Gr=$t.projection.upVector(rr,rl.x,rl.y);let $s=yn,ga=mi;if(xn){const ds=rb(os,ia,yn,mi,xn,_i,dr,cr);$s+=ds.base,ga+=ds.top}yn!==0?As(pr,Wo.x+Gr[0]*Ri*$s,Wo.y+Gr[1]*Ri*$s,Wo.z+Gr[2]*Ri*$s):As(pr,Wo.x,Wo.y,Wo.z),As(fs,Wo.x+Gr[0]*Ri*ga,Wo.y+Gr[1]*Ri*ga,Wo.z+Gr[2]*Ri*ga),Qs(pr,pr,Jn),Qs(fs,fs,Jn),Ns.push(new Cs(pr[0],pr[1],pr[2])),vo.push(new Cs(fs[0],fs[1],fs[2]))}yi.push(Ns),ss.push(vo)}return[yi,ss]}(Me,Ve,ke,_t,mt,Pt,Jt,bt,Bt,Vt,Zt):Jt?function($t,Et,yn,mi,Mn,Jn,xn,_i,dr){const cr=[],rr=[],yi=[0,0,0,1];for(const ss of $t){const Ri=[],pr=[];for(const fs of ss){const As=fs.x+mi.x,ws=fs.y+mi.y,Ms=rb(As,ws,Et,yn,Jn,xn,_i,dr);yi[0]=As,yi[1]=ws,yi[2]=Ms.base,yi[3]=1,Dp(yi,yi,Mn),yi[3]=Math.max(yi[3],1e-5);const Ns=new Cs(yi[0]/yi[3],yi[1]/yi[3],yi[2]/yi[3]);yi[0]=As,yi[1]=ws,yi[2]=Ms.top,yi[3]=1,Dp(yi,yi,Mn),yi[3]=Math.max(yi[3],1e-5);const vo=new Cs(yi[0]/yi[3],yi[1]/yi[3],yi[2]/yi[3]);Ri.push(Ns),pr.push(vo)}cr.push(Ri),rr.push(pr)}return[cr,rr]}(Ve,ke,_t,mt,Pt,Jt,bt,Bt,Vt):function($t,Et,yn,mi,Mn){const Jn=[],xn=[],_i=Mn[8]*Et,dr=Mn[9]*Et,cr=Mn[10]*Et,rr=Mn[11]*Et,yi=Mn[8]*yn,ss=Mn[9]*yn,Ri=Mn[10]*yn,pr=Mn[11]*yn;for(const fs of $t){const As=[],ws=[];for(const Ms of fs){const Ns=Ms.x+mi.x,vo=Ms.y+mi.y,rl=Mn[0]*Ns+Mn[4]*vo+Mn[12],os=Mn[1]*Ns+Mn[5]*vo+Mn[13],ia=Mn[2]*Ns+Mn[6]*vo+Mn[14],Wo=Mn[3]*Ns+Mn[7]*vo+Mn[15],Gr=rl+_i,$s=os+dr,ga=ia+cr,ds=Math.max(Wo+rr,1e-5),No=rl+yi,ql=os+ss,sl=ia+Ri,ol=Math.max(Wo+pr,1e-5);As.push(new Cs(Gr/ds,$s/ds,ga/ds)),ws.push(new Cs(No/ol,ql/ol,sl/ol))}Jn.push(As),xn.push(ws)}return[Jn,xn]}(Ve,ke,_t,mt,Pt)}(y,f,U,F,L,b,ce,j,J,y.center.lat,l.tileID.canonical),be=l.queryGeometry;return function(Me,Ve,ke){let _t=1/0;Dx(ke,Ve)&&(_t=M0(ke,Ve[0]));for(let mt=0;mt<Ve.length;mt++){const Pt=Ve[mt],Jt=Me[mt];for(let bt=0;bt<Pt.length-1;bt++){const Bt=Pt[bt],Vt=[Bt,Pt[bt+1],Jt[bt+1],Jt[bt],Bt];Rx(ke,Vt)&&(_t=Math.min(_t,M0(ke,Vt)))}}return _t!==1/0&&_t}(we,Pe,be.isPointQuery()?be.screenBounds:be.screenGeometry)}},line:class extends nh{constructor(l){super(l,ob),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(l){if(l==="line-gradient"){const o=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=o._styleExpression&&o._styleExpression.expression instanceof La,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(l,o){super.recalculate(l,o),this.paint._values["line-floorwidth"]=P0.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new Bd(l)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(l){return new th(this,l)}queryRadius(l){const o=l,u=Wg(Im("line-width",this,o),Im("line-gap-width",this,o)),f=Im("line-offset",this,o);return u/2+Math.abs(f)+cy(this.paint.get("line-translate"))}queryIntersectsFeature(l,o,u,f,m,y){if(l.queryGeometry.isAboveHorizon)return!1;const b=Fx(l.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),y.angle,l.pixelToTileUnitsFactor),T=l.pixelToTileUnitsFactor/2*Wg(this.paint.get("line-width").evaluate(o,u),this.paint.get("line-gap-width").evaluate(o,u)),A=this.paint.get("line-offset").evaluate(o,u);return A&&(f=function(L,F){const U=[],j=new ie(0,0);for(let Y=0;Y<L.length;Y++){const J=L[Y],ee=[];for(let ce=0;ce<J.length;ce++){const we=J[ce-1],Pe=J[ce],be=J[ce+1],Me=ce===0?j:Pe.sub(we)._unit()._perp(),Ve=ce===J.length-1?j:be.sub(Pe)._unit()._perp(),ke=Me._add(Ve)._unit();ke._mult(1/(ke.x*Ve.x+ke.y*Ve.y)),ee.push(ke._mult(F)._add(Pe))}U.push(ee)}return U}(f,A*l.pixelToTileUnitsFactor)),function(L,F,U){for(let j=0;j<F.length;j++){const Y=F[j];if(L.length>=3){for(let J=0;J<Y.length;J++)if(Fp(L,Y[J]))return!0}if(pw(L,Y,U))return!0}return!1}(b,f,T)}isTileClipped(){return!0}},symbol:Uy,background:class extends nh{constructor(l){super(l,OI)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends nh{constructor(l){super(l,NI)}getProgramIds(){return["raster"]}},sky:class extends nh{constructor(l){super(l,FI),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="sky-gradient"?this._updateColorRamp():l!=="sky-atmosphere-sun"&&l!=="sky-atmosphere-halo-color"&&l!=="sky-atmosphere-color"&&l!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=w0({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(l){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const o=l.style.light.properties.get("position");return this._lightPosition.azimuthal!==o.azimuthal||this._lightPosition.polar!==o.polar}return!1}getCenter(l,o){if(this.paint.get("sky-type")==="atmosphere"){const f=this.paint.get("sky-atmosphere-sun"),m=!f,y=l.style.light,b=y.properties.get("position");return m&&y.properties.get("anchor")==="viewport"&&Gn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),m?Z0(b.azimuthal,90-b.polar,o):Z0(f[0],90-f[1],o)}const u=this.paint.get("sky-gradient-center");return Z0(u[0],90-u[1],o)}is3D(){return!1}isSky(){return!0}markSkyboxValid(l){this._skyboxInvalidated=!1,this._lightPosition=l.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const l=this.paint.get("sky-type");return l==="atmosphere"?["skyboxCapture","skybox"]:l==="gradient"?["skyboxGradient"]:null}}};class g{constructor(o,u,f,m){this.context=o,this.format=f,this.texture=o.gl.createTexture(),this.update(u,m)}update(o,u,f){const{width:m,height:y}=o,{context:b}=this,{gl:T}=b,{HTMLImageElement:A,HTMLCanvasElement:L,HTMLVideoElement:F,ImageData:U,ImageBitmap:j}=p;if(T.bindTexture(T.TEXTURE_2D,this.texture),b.pixelStoreUnpackFlipY.set(!1),b.pixelStoreUnpack.set(1),b.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!u||u.premultiply!==!1)),f||this.size&&this.size[0]===m&&this.size[1]===y){const{x:Y,y:J}=f||{x:0,y:0};o instanceof A||o instanceof L||o instanceof F||o instanceof U||j&&o instanceof j?T.texSubImage2D(T.TEXTURE_2D,0,Y,J,T.RGBA,T.UNSIGNED_BYTE,o):T.texSubImage2D(T.TEXTURE_2D,0,Y,J,m,y,T.RGBA,T.UNSIGNED_BYTE,o.data)}else this.size=[m,y],o instanceof A||o instanceof L||o instanceof F||o instanceof U||j&&o instanceof j?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,o):T.texImage2D(T.TEXTURE_2D,0,this.format,m,y,0,this.format,T.UNSIGNED_BYTE,o.data);this.useMipmap=!!(u&&u.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&T.generateMipmap(T.TEXTURE_2D)}bind(o,u){const{context:f}=this,{gl:m}=f;m.bindTexture(m.TEXTURE_2D,this.texture),o!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,o),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap?o===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_NEAREST:o),this.filter=o),u!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,u),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,u),this.wrap=u)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}class E{constructor(o){this._callback=o,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class R{constructor(){this.tasks={},this.taskQueue=[],ii(["process"],this),this.invoker=new E(this.process),this.nextId=0}add(o,u){const f=this.nextId++,m=function({type:y,isSymbolTile:b,zoom:T}){return T=T||0,y==="message"?0:y!=="maybePrepare"||b?y!=="parseTile"||b?y==="parseTile"&&b?300-T:y==="maybePrepare"&&b?400-T:500:200-T:100-T}(u);if(m===0){Mt();try{o()}finally{}return{cancel:()=>{}}}return this.tasks[f]={fn:o,metadata:u,priority:m,id:f},this.taskQueue.push(f),this.invoker.trigger(),{cancel:()=>{delete this.tasks[f]}}}process(){Mt();try{if(this.taskQueue=this.taskQueue.filter(f=>!!this.tasks[f]),!this.taskQueue.length)return;const o=this.pick();if(o===null)return;const u=this.tasks[o];if(delete this.tasks[o],this.taskQueue.length&&this.invoker.trigger(),!u)return;u.fn()}finally{}}pick(){let o=null,u=1/0;for(let m=0;m<this.taskQueue.length;m++){const y=this.tasks[this.taskQueue[m]];y.priority<u&&(u=y.priority,o=m)}if(o===null)return null;const f=this.taskQueue[o];return this.taskQueue.splice(o,1),f}remove(){this.invoker.remove()}}class X{constructor(o){this._stringToNumber={},this._numberToString=[];for(let u=0;u<o.length;u++){const f=o[u];this._stringToNumber[f]=u,this._numberToString[u]=f}}encode(o){return this._stringToNumber[o]}decode(o){return this._numberToString[o]}}const se=["tile","layer","source","sourceLayer","state"];class ye{constructor(o,u,f,m,y){this.type="Feature",this._vectorTileFeature=o,this._z=u,this._x=f,this._y=m,this.properties=o.properties,this.id=y}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(o){this._geometry=o}toJSON(){const o={type:"Feature",geometry:this.geometry,properties:this.properties};this.id!==void 0&&(o.id=this.id);for(const u of se)this[u]!==void 0&&(o[u]=this[u]);return o}}const Re=32,Je=33,ct=new Uint16Array(8184);for(let l=0;l<2046;l++){let o=l+2,u=0,f=0,m=0,y=0,b=0,T=0;for(1&o?m=y=b=Re:u=f=T=Re;(o>>=1)>1;){const L=u+m>>1,F=f+y>>1;1&o?(m=u,y=f,u=b,f=T):(u=m,f=y,m=b,y=T),b=L,T=F}const A=4*l;ct[A+0]=u,ct[A+1]=f,ct[A+2]=m,ct[A+3]=y}const qt=new Uint16Array(2178),Xt=new Uint8Array(1089),rn=new Uint16Array(1089);function Xn(l){return l===0?-.03125:l===32?.03125:0}var pi=ni([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Ni={type:2,extent:gi,loadGeometry:()=>[[new ie(0,0),new ie(8193,0),new ie(8193,8193),new ie(0,8193),new ie(0,0)]]};class fr{constructor(o,u,f,m,y){this.tileID=o,this.uid=sn(),this.uses=0,this.tileSize=u,this.tileZoom=f,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=y,this.expiredRequestCount=0,this.state="loading",m&&m.transform&&(this.projection=m.transform.projection)}registerFadeDuration(o){const u=o+this.timeAdded;u<ar.now()||this.fadeEndTime&&u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Up(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(o,u,f){if(this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(m,y){const b={};if(!y)return b;for(const T of m){const A=T.layerIds.map(L=>y.getLayer(L)).filter(Boolean);if(A.length!==0){T.layers=A,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map(L=>A.filter(F=>F.id===L)[0]));for(const L of A)b[L.id]=T}}return b}(o.buckets,u.style),this.hasSymbolBuckets=!1;for(const m in this.buckets){const y=this.buckets[m];if(y instanceof Vd){if(this.hasSymbolBuckets=!0,!f)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const m in this.buckets){const y=this.buckets[m];if(y instanceof Vd&&y.hasRTLText){this.hasRTLText=!0,qe.isLoading()||qe.isLoaded()||ze()!=="deferred"||De();break}}this.queryPadding=0;for(const m in this.buckets){const y=this.buckets[m];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(m).queryRadius(y))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage),o.lineAtlas&&(this.lineAtlas=o.lineAtlas)}else this.collisionBoxArray=new Jv}unloadVectorData(){if(this.hasData()){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(o){return this.buckets[o.id]}upload(o){for(const f in this.buckets){const m=this.buckets[f];m.uploadPending()&&m.upload(o)}const u=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new g(o,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new g(o,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new g(o,this.lineAtlas.image,u.ALPHA),this.lineAtlas.uploaded=!0)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,u,f,m,y,b,T,A){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:m,pixelPosMatrix:T,transform:b,params:y,tileTransform:this.tileTransform},o,u,f):{}}querySourceFeatures(o,u){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const m=f.loadVTLayers(),y=u?u.sourceLayer:"",b=m._geojsonTileLayer||m[y];if(!b)return;const T=lo(u&&u.filter),{z:A,x:L,y:F}=this.tileID.canonical,U={z:A,x:L,y:F};for(let j=0;j<b.length;j++){const Y=b.feature(j);if(T.needGeometry){const ce=kp(Y,!0);if(!T.filter(new lt(this.tileID.overscaledZ),ce,this.tileID.canonical))continue}else if(!T.filter(new lt(this.tileID.overscaledZ),Y))continue;const J=f.getId(Y,y),ee=new ye(Y,A,L,F,J);ee.tile=U,o.push(ee)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const u=this.expirationTime;if(o.cacheControl){const f=Un(o.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const f=Date.now();let m=!1;if(this.expirationTime>f)m=!1;else if(u)if(this.expirationTime<u)m=!0;else{const y=this.expirationTime-u;y?this.expirationTime=f+Math.max(y,3e4):m=!0}else m=!0;m?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(o,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(o).length===0||!u)return;const f=this.latestFeatureIndex.loadVTLayers(),m=u.style.listImages();for(const y in this.buckets){if(!u.style.hasLayer(y))continue;const b=this.buckets[y],T=b.layers[0].sourceLayer||"_geojsonTileLayer",A=f[T],L=o[T];if(!A||!L||Object.keys(L).length===0)continue;if(b.update(L,A,m,this.imageAtlas&&this.imageAtlas.patternPositions||{}),b instanceof Bd||b instanceof jg){const U=u.style._getSourceCache(b.layers[0].source);u._terrain&&u._terrain.enabled&&U&&b.programConfigurations.needsUpload&&u._terrain._clearRenderCacheForTile(U.id,this.tileID)}const F=u&&u.style&&u.style.getLayer(y);F&&(this.queryPadding=Math.max(this.queryPadding,F.queryRadius(b)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ar.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=ar.now()+o}setTexture(o,u){const f=u.context,m=f.gl;this.texture=this.texture||u.getTileTexture(o.width),this.texture?this.texture.update(o,{useMipmap:!0}):(this.texture=new g(f,o,m.RGBA,{useMipmap:!0}),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE),f.extTextureFilterAnisotropic&&m.texParameterf(m.TEXTURE_2D,f.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,f.extTextureFilterAnisotropicMax))}setDependencies(o,u){const f={};for(const m of u)f[m]=!0;this.dependencies[o]=f}hasDependency(o,u){for(const f of o){const m=this.dependencies[f];if(m){for(const y of u)if(m[y])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(o,u){if(!u||u.name==="mercator"||this._tileDebugBuffer)return;const f=jf(Ni,this.tileID.canonical,this.tileTransform)[0],m=new oi,y=new ou;for(let b=0;b<f.length;b++){const{x:T,y:A}=f[b];m.emplaceBack(T,A),y.emplaceBack(b)}y.emplaceBack(0),this._tileDebugIndexBuffer=o.createIndexBuffer(y),this._tileDebugBuffer=o.createVertexBuffer(m,Gf.members),this._tileDebugSegments=Gs.simpleSegment(0,0,m.length,y.length)}_makeTileBoundsBuffers(o,u){if(this._tileBoundsBuffer||!u||u.name==="mercator")return;const f=jf(Ni,this.tileID.canonical,this.tileTransform)[0];let m,y;if(this.isRaster){const b=function(T,A){const L=Up(T,A),F=Math.pow(2,T.z);for(let ce=0;ce<Je;ce++)for(let we=0;we<Je;we++){const Pe=Bu((T.x+(we+Xn(we))/Re)/F),be=Ra((T.y+(ce+Xn(ce))/Re)/F),Me=A.project(Pe,be),Ve=ce*Je+we;qt[2*Ve+0]=Math.round((Me.x*L.scale-L.x)*gi),qt[2*Ve+1]=Math.round((Me.y*L.scale-L.y)*gi)}Xt.fill(0),rn.fill(0);for(let ce=2045;ce>=0;ce--){const we=4*ce,Pe=ct[we+0],be=ct[we+1],Me=ct[we+2],Ve=ct[we+3],ke=Pe+Me>>1,_t=be+Ve>>1,mt=ke+_t-be,Pt=_t+Pe-ke,Jt=be*Je+Pe,bt=Ve*Je+Me,Bt=_t*Je+ke,Vt=Math.hypot((qt[2*Jt+0]+qt[2*bt+0])/2-qt[2*Bt+0],(qt[2*Jt+1]+qt[2*bt+1])/2-qt[2*Bt+1])>=16;if(Xt[Bt]=Xt[Bt]||(Vt?1:0),ce<1022){const Zt=(be+Pt>>1)*Je+(Pe+mt>>1),$t=(Ve+Pt>>1)*Je+(Me+mt>>1);Xt[Bt]=Xt[Bt]||Xt[Zt]||Xt[$t]}}const U=new qr,j=new da;let Y=0;function J(ce,we){const Pe=we*Je+ce;return rn[Pe]===0&&(U.emplaceBack(qt[2*Pe+0],qt[2*Pe+1],ce*gi/Re,we*gi/Re),rn[Pe]=++Y),rn[Pe]-1}function ee(ce,we,Pe,be,Me,Ve){const ke=ce+Pe>>1,_t=we+be>>1;if(Math.abs(ce-Me)+Math.abs(we-Ve)>1&&Xt[_t*Je+ke])ee(Me,Ve,ce,we,ke,_t),ee(Pe,be,Me,Ve,ke,_t);else{const mt=J(ce,we),Pt=J(Pe,be),Jt=J(Me,Ve);j.emplaceBack(mt,Pt,Jt)}}return ee(0,0,Re,Re,Re,0),ee(Re,Re,0,0,0,Re),{vertices:U,indices:j}}(this.tileID.canonical,u);m=b.vertices,y=b.indices}else{m=new qr,y=new da;for(const{x:T,y:A}of f)m.emplaceBack(T,A,0,0);const b=Tm(m.int16,void 0,4);for(let T=0;T<b.length;T+=3)y.emplaceBack(b[T],b[T+1],b[T+2])}this._tileBoundsBuffer=o.createVertexBuffer(m,pi.members),this._tileBoundsIndexBuffer=o.createIndexBuffer(y),this._tileBoundsSegments=Gs.simpleSegment(0,0,m.length,y.length)}_makeGlobeTileDebugBuffers(o,u){const f=u.projection;if(!f||f.name!=="globe"||u.freezeTileCoverage)return;const m=this.tileID.canonical,y=kg(u0(m,u)),b=Em(u.zoom);let T;b>0&&(T=$_(new Float64Array(16),u.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(o,m,u,y,T,b),this._makeGlobeTileDebugTextBuffer(o,m,u,y,T,b)}_globePoint(o,u,f,m,y,b,T){let A=Ng(o,u,f);if(b){const L=1<<f.z,F=Jh(m.center.lng),U=Qh(m.center.lat),j=(f.x+.5)/L-F;let Y=0;j>.5?Y=-1:j<-.5&&(Y=1);let J=(o/gi+f.x)/L+Y,ee=(u/gi+f.y)/L;J=(J-F)*m._pixelsPerMercatorPixel+F,ee=(ee-U)*m._pixelsPerMercatorPixel+U;const ce=[J*m.worldSize,ee*m.worldSize,0];Qs(ce,ce,b),A=Kh(A,ce,T)}return Qs(A,A,y)}_makeGlobeTileDebugBorderBuffer(o,u,f,m,y,b){const T=new oi,A=new ou,L=new Nr,F=(j,Y,J,ee,ce)=>{const we=(J-j)/(ce-1),Pe=(ee-Y)/(ce-1),be=T.length;for(let Me=0;Me<ce;Me++){const Ve=j+Me*we,ke=Y+Me*Pe;T.emplaceBack(Ve,ke);const _t=this._globePoint(Ve,ke,u,f,m,y,b);L.emplaceBack(_t[0],_t[1],_t[2]),A.emplaceBack(be+Me)}},U=gi;F(0,0,U,0,16),F(U,0,U,U,16),F(U,U,0,U,16),F(0,U,0,0,16),this._tileDebugIndexBuffer=o.createIndexBuffer(A),this._tileDebugBuffer=o.createVertexBuffer(T,Gf.members),this._globeTileDebugBorderBuffer=o.createVertexBuffer(L,Ex.members),this._tileDebugSegments=Gs.simpleSegment(0,0,T.length,A.length)}_makeGlobeTileDebugTextBuffer(o,u,f,m,y,b){const T=new oi,A=new da,L=new Nr,F=25;A.reserve(32),T.reserve(F),L.reserve(F);const U=(j,Y)=>F*j+Y;for(let j=0;j<F;j++){const Y=2048*j;for(let J=0;J<F;J++){const ee=2048*J;T.emplaceBack(ee,Y);const ce=this._globePoint(ee,Y,u,f,m,y,b);L.emplaceBack(ce[0],ce[1],ce[2])}}for(let j=0;j<4;j++)for(let Y=0;Y<4;Y++){const J=U(j,Y),ee=U(j,Y+1),ce=U(j+1,Y),we=U(j+1,Y+1);A.emplaceBack(J,ee,ce),A.emplaceBack(ce,ee,we)}this._tileDebugTextIndexBuffer=o.createIndexBuffer(A),this._tileDebugTextBuffer=o.createVertexBuffer(T,Gf.members),this._globeTileDebugTextBuffer=o.createVertexBuffer(L,Ex.members),this._tileDebugTextSegments=Gs.simpleSegment(0,0,F,32)}}class Bi{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,u,f){const m=String(u);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][m]=this.stateChanges[o][m]||{},At(this.stateChanges[o][m],f),this.deletedStates[o]===null){this.deletedStates[o]={};for(const y in this.state[o])y!==m&&(this.deletedStates[o][y]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][m]===null){this.deletedStates[o][m]={};for(const y in this.state[o][m])f[y]||(this.deletedStates[o][m][y]=null)}else for(const y in f)this.deletedStates[o]&&this.deletedStates[o][m]&&this.deletedStates[o][m][y]===null&&delete this.deletedStates[o][m][y]}removeFeatureState(o,u,f){if(this.deletedStates[o]===null)return;const m=String(u);if(this.deletedStates[o]=this.deletedStates[o]||{},f&&u!==void 0)this.deletedStates[o][m]!==null&&(this.deletedStates[o][m]=this.deletedStates[o][m]||{},this.deletedStates[o][m][f]=null);else if(u!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][m])for(f in this.deletedStates[o][m]={},this.stateChanges[o][m])this.deletedStates[o][m][f]=null;else this.deletedStates[o][m]=null;else this.deletedStates[o]=null}getState(o,u){const f=String(u),m=At({},(this.state[o]||{})[f],(this.stateChanges[o]||{})[f]);if(this.deletedStates[o]===null)return{};if(this.deletedStates[o]){const y=this.deletedStates[o][u];if(y===null)return{};for(const b in y)delete m[b]}return m}initializeTileState(o,u){o.setFeatureState(this.state,u)}coalesceChanges(o,u){const f={};for(const m in this.stateChanges){this.state[m]=this.state[m]||{};const y={};for(const b in this.stateChanges[m])this.state[m][b]||(this.state[m][b]={}),At(this.state[m][b],this.stateChanges[m][b]),y[b]=this.state[m][b];f[m]=y}for(const m in this.deletedStates){this.state[m]=this.state[m]||{};const y={};if(this.deletedStates[m]===null)for(const b in this.state[m])y[b]={},this.state[m][b]={};else for(const b in this.deletedStates[m]){if(this.deletedStates[m][b]===null)this.state[m][b]={};else if(this.state[m][b])for(const T of Object.keys(this.deletedStates[m][b]))delete this.state[m][b][T];y[b]=this.state[m][b]}f[m]=f[m]||{},At(f[m],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const m in o)o[m].setFeatureState(f,u)}}class Rr{constructor(o){this.size=o,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(o,u){const f=this.toIdx(o,u);return{min:this.minimums[f],max:this.maximums[f]}}isLeaf(o,u){return this.leaves[this.toIdx(o,u)]}toIdx(o,u){return u*this.size+o}}function Vr(l,o,u,f){let m=0,y=Number.MAX_VALUE;for(let b=0;b<3;b++)if(Math.abs(f[b])<1e-15){if(u[b]<l[b]||u[b]>o[b])return null}else{const T=1/f[b];let A=(l[b]-u[b])*T,L=(o[b]-u[b])*T;if(A>L){const F=A;A=L,L=F}if(A>m&&(m=A),L<y&&(y=L),m>y)return null}return m}function fu(l,o,u,f,m,y,b,T,A,L,F){const U=f-l,j=m-o,Y=y-u,J=b-l,ee=T-o,ce=A-u,we=F[1]*ce-F[2]*ee,Pe=F[2]*J-F[0]*ce,be=F[0]*ee-F[1]*J,Me=U*we+j*Pe+Y*be;if(Math.abs(Me)<1e-15)return null;const Ve=1/Me,ke=L[0]-l,_t=L[1]-o,mt=L[2]-u,Pt=(ke*we+_t*Pe+mt*be)*Ve;if(Pt<0||Pt>1)return null;const Jt=_t*Y-mt*j,bt=mt*U-ke*Y,Bt=ke*j-_t*U,Vt=(F[0]*Jt+F[1]*bt+F[2]*Bt)*Ve;return Vt<0||Pt+Vt>1?null:(J*Jt+ee*bt+ce*Bt)*Ve}function _l(l,o,u){return(l-o)/(u-o)}function du(l,o,u,f,m,y,b,T,A){const L=1<<u,F=y-f,U=b-m,j=(l+1)/L*F+f,Y=(o+0)/L*U+m,J=(o+1)/L*U+m;T[0]=(l+0)/L*F+f,T[1]=Y,A[0]=j,A[1]=J}class Oo{constructor(o){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=o,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const u=function(y){const b=Math.ceil(Math.log2(y.dim/8)),T=[];let A=Math.ceil(Math.pow(2,b));const L=1/A,F=(Y,J,ee,ce,we)=>{const Pe=ce?1:0,be=(Y+1)*ee-Pe,Me=J*ee,Ve=(J+1)*ee-Pe;we[0]=Y*ee,we[1]=Me,we[2]=be,we[3]=Ve};let U=new Rr(A);const j=[];for(let Y=0;Y<A*A;Y++){F(Y%A,Math.floor(Y/A),L,!1,j);const J=yl(j[0],j[1],y),ee=yl(j[2],j[1],y),ce=yl(j[2],j[3],y),we=yl(j[0],j[3],y);U.minimums.push(Math.min(J,ee,ce,we)),U.maximums.push(Math.max(J,ee,ce,we)),U.leaves.push(1)}for(T.push(U),A/=2;A>=1;A/=2){const Y=T[T.length-1];U=new Rr(A);for(let J=0;J<A*A;J++){F(J%A,Math.floor(J/A),2,!0,j);const ee=Y.getElevation(j[0],j[1]),ce=Y.getElevation(j[2],j[1]),we=Y.getElevation(j[2],j[3]),Pe=Y.getElevation(j[0],j[3]),be=Y.isLeaf(j[0],j[1]),Me=Y.isLeaf(j[2],j[1]),Ve=Y.isLeaf(j[2],j[3]),ke=Y.isLeaf(j[0],j[3]),_t=Math.min(ee.min,ce.min,we.min,Pe.min),mt=Math.max(ee.max,ce.max,we.max,Pe.max),Pt=be&&Me&&Ve&&ke;U.maximums.push(mt),U.minimums.push(_t),U.leaves.push(mt-_t<=5&&Pt?1:0)}T.push(U)}return T}(this.dem),f=u.length-1,m=u[f];this._addNode(m.minimums[0],m.maximums[0],m.leaves[0]),this._construct(u,0,0,f,0)}raycastRoot(o,u,f,m,y,b,T=1){return Vr([o,u,-100],[f,m,this.maximums[0]*T],y,b)}raycast(o,u,f,m,y,b,T=1){if(!this.nodeCount)return null;const A=this.raycastRoot(o,u,f,m,y,b,T);if(A==null)return null;const L=[],F=[],U=[],j=[],Y=[{idx:0,t:A,nodex:0,nodey:0,depth:0}];for(;Y.length>0;){const{idx:J,t:ee,nodex:ce,nodey:we,depth:Pe}=Y.pop();if(this.leaves[J]){du(ce,we,Pe,o,u,f,m,U,j);const Me=1<<Pe,Ve=(ce+0)/Me,ke=(ce+1)/Me,_t=(we+0)/Me,mt=(we+1)/Me,Pt=yl(Ve,_t,this.dem)*T,Jt=yl(ke,_t,this.dem)*T,bt=yl(ke,mt,this.dem)*T,Bt=yl(Ve,mt,this.dem)*T,Vt=fu(U[0],U[1],Pt,j[0],U[1],Jt,j[0],j[1],bt,y,b),Zt=fu(j[0],j[1],bt,U[0],j[1],Bt,U[0],U[1],Pt,y,b),$t=Math.min(Vt!==null?Vt:Number.MAX_VALUE,Zt!==null?Zt:Number.MAX_VALUE);if($t!==Number.MAX_VALUE)return $t;{const Et=Rp([],y,b,ee);if(Ec(Pt,Jt,Bt,bt,_l(Et[0],U[0],j[0]),_l(Et[1],U[1],j[1]))>=Et[2])return ee}continue}let be=0;for(let Me=0;Me<this._siblingOffset.length;Me++){du((ce<<1)+this._siblingOffset[Me][0],(we<<1)+this._siblingOffset[Me][1],Pe+1,o,u,f,m,U,j),U[2]=-100,j[2]=this.maximums[this.childOffsets[J]+Me]*T;const Ve=Vr(U,j,y,b);if(Ve!=null){const ke=Ve;L[Me]=ke;let _t=!1;for(let mt=0;mt<be&&!_t;mt++)ke>=L[F[mt]]&&(F.splice(mt,0,Me),_t=!0);_t||(F[be]=Me),be++}}for(let Me=0;Me<be;Me++){const Ve=F[Me];Y.push({idx:this.childOffsets[J]+Ve,t:L[Ve],nodex:(ce<<1)+this._siblingOffset[Ve][0],nodey:(we<<1)+this._siblingOffset[Ve][1],depth:Pe+1})}}return null}_addNode(o,u,f){return this.minimums.push(o),this.maximums.push(u),this.leaves.push(f),this.childOffsets.push(0),this.nodeCount++}_construct(o,u,f,m,y){if(o[m].isLeaf(u,f)===1)return;this.childOffsets[y]||(this.childOffsets[y]=this.nodeCount);const b=m-1,T=o[b];let A=0,L=0;for(let F=0;F<this._siblingOffset.length;F++){const U=2*u+this._siblingOffset[F][0],j=2*f+this._siblingOffset[F][1],Y=T.getElevation(U,j),J=T.isLeaf(U,j),ee=this._addNode(Y.min,Y.max,J);J&&(A|=1<<F),L||(L=ee)}for(let F=0;F<this._siblingOffset.length;F++)A&1<<F||this._construct(o,2*u+this._siblingOffset[F][0],2*f+this._siblingOffset[F][1],b,L+F)}}function Ec(l,o,u,f,m,y){return Mi(Mi(l,u,y),Mi(o,f,y),m)}function yl(l,o,u){const f=u.dim,m=nt(l*f-.5,0,f-1),y=nt(o*f-.5,0,f-1),b=Math.floor(m),T=Math.floor(y),A=Math.min(b+1,f-1),L=Math.min(T+1,f-1);return Ec(u.get(b,T),u.get(A,T),u.get(b,L),u.get(A,L),m-b,y-T)}const Y0={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class zb{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(o,u,f,m=!1,y=!1){if(this.uid=o,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(f&&f!=="mapbox"&&f!=="terrarium")return Gn(`"${f}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=u.height;const b=this.dim=u.height-2,T=new Uint32Array(u.data.buffer);if(this.pixels=new Uint8Array(u.data.buffer),this.encoding=f||"mapbox",this.borderReady=m,!m){for(let A=0;A<b;A++)T[this._idx(-1,A)]=T[this._idx(0,A)],T[this._idx(b,A)]=T[this._idx(b-1,A)],T[this._idx(A,-1)]=T[this._idx(A,0)],T[this._idx(A,b)]=T[this._idx(A,b-1)];T[this._idx(-1,-1)]=T[this._idx(0,0)],T[this._idx(b,-1)]=T[this._idx(b-1,0)],T[this._idx(-1,b)]=T[this._idx(0,b-1)],T[this._idx(b,b)]=T[this._idx(b-1,b-1)],y&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Oo(this)}get(o,u,f=!1){f&&(o=nt(o,-1,this.dim),u=nt(u,-1,this.dim));const m=4*this._idx(o,u);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(this.pixels[m],this.pixels[m+1],this.pixels[m+2])}static getUnpackVector(o){return Y0[o]}get unpackVector(){return Y0[this.encoding]}_idx(o,u){if(o<-1||o>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(u+1)*this.stride+(o+1)}_unpackMapbox(o,u,f){return(256*o*256+256*u+f)/10-1e4}_unpackTerrarium(o,u,f){return 256*o+u+f/256-32768}static pack(o,u){const f=[0,0,0,0],m=zb.getUnpackVector(u);let y=Math.floor((o+m[3])/m[2]);return f[2]=y%256,y=Math.floor(y/256),f[1]=y%256,y=Math.floor(y/256),f[0]=y,f}getPixels(){return new uu({width:this.stride,height:this.stride},this.pixels)}backfillBorder(o,u,f){if(this.dim!==o.dim)throw new Error("dem dimension mismatch");let m=u*this.dim,y=u*this.dim+this.dim,b=f*this.dim,T=f*this.dim+this.dim;switch(u){case-1:m=y-1;break;case 1:y=m+1}switch(f){case-1:b=T-1;break;case 1:T=b+1}const A=-u*this.dim,L=-f*this.dim;for(let F=b;F<T;F++)for(let U=m;U<y;U++){const j=4*this._idx(U,F),Y=4*this._idx(U+A,F+L);this.pixels[j+0]=o.pixels[Y+0],this.pixels[j+1]=o.pixels[Y+1],this.pixels[j+2]=o.pixels[Y+2],this.pixels[j+3]=o.pixels[Y+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Cn(zb,"DEMData"),Cn(Oo,"DemMinMaxQuadTree",{omit:["dem"]});class fP{constructor(o,u){this.max=o,this.onRemove=u,this.reset()}reset(){for(const o in this.data)for(const u of this.data[o])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(o,u,f){const m=o.wrapped().key;this.data[m]===void 0&&(this.data[m]=[]);const y={value:u,timeout:void 0};if(f!==void 0&&(y.timeout=setTimeout(()=>{this.remove(o,y)},f)),this.data[m].push(y),this.order.push(m),this.order.length>this.max){const b=this._getAndRemoveByKey(this.order[0]);b&&this.onRemove(b)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const u=this.data[o].shift();return u.timeout&&clearTimeout(u.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),u.value}getByKey(o){const u=this.data[o];return u?u[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,u){if(!this.has(o))return this;const f=o.wrapped().key,m=u===void 0?0:this.data[f].indexOf(u),y=this.data[f][m];return this.data[f].splice(m,1),y.timeout&&clearTimeout(y.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(y.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(o){const u=[];for(const f in this.data)for(const m of this.data[f])o(m.value)||u.push(m);for(const f of u)this.remove(f.value.tileID,f)}}class Vy{constructor(o,u,f){this.func=o,this.mask=u,this.range=f}}Vy.ReadOnly=!1,Vy.ReadWrite=!0,Vy.disabled=new Vy(519,Vy.ReadOnly,[0,1]);const zI=7680;class UI{constructor(o,u,f,m,y,b){this.test=o,this.ref=u,this.mask=f,this.fail=m,this.depthFail=y,this.pass=b}}UI.disabled=new UI({func:519,mask:0},0,0,zI,zI,zI);class Gd{constructor(o,u,f){this.blendFunction=o,this.blendColor=u,this.mask=f}}Gd.Replace=[1,0],Gd.disabled=new Gd(Gd.Replace,Ai.transparent,[!1,!1,!1,!1]),Gd.unblended=new Gd(Gd.Replace,Ai.transparent,[!0,!0,!0,!0]),Gd.alphaBlended=new Gd([1,771],Ai.transparent,[!0,!0,!0,!0]);const VI=1029,GI=2305;class Zf{constructor(o,u,f){this.enable=o,this.mode=u,this.frontFace=f}}Zf.disabled=new Zf(!1,VI,GI),Zf.backCCW=new Zf(!0,VI,GI),Zf.backCW=new Zf(!0,VI,2304),Zf.frontCW=new Zf(!0,1028,2304),Zf.frontCCW=new Zf(!0,1028,GI);class e_ extends la{constructor(o,u,f){super(),this.id=o,this._onlySymbols=f,u.on("data",m=>{m.dataType==="source"&&m.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&m.dataType==="source"&&m.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),u.on("error",()=>{this._sourceErrored=!0}),this._source=u,this._tiles={},this._cache=new fP(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=u.minTileCacheSize,this._maxTileCacheSize=u.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Bi,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(o){this.map=o,this._minTileCacheSize=this._minTileCacheSize===void 0&&o?o._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&o?o._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const o in this._tiles){const u=this._tiles[o];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(o,u){return o.isSymbolTile=this._onlySymbols,this._source.loadTile(o,u)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o,()=>{})}_abortTile(o){if(this._source.abortTile)return this._source.abortTile(o,()=>{})}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const f=this._tiles[u];f.upload(o),f.prepare(this.map.style.imageManager)}}getIds(){return Ze(this._tiles).map(o=>o.tileID).sort(US).map(o=>o.key)}getRenderableIds(o){const u=[];for(const f in this._tiles)this._isIdRenderable(+f,o)&&u.push(this._tiles[f]);return o?u.sort((f,m)=>{const y=f.tileID,b=m.tileID,T=new ie(y.canonical.x,y.canonical.y)._rotate(this.transform.angle),A=new ie(b.canonical.x,b.canonical.y)._rotate(this.transform.angle);return y.overscaledZ-b.overscaledZ||A.y-T.y||A.x-T.x}).map(f=>f.tileID.key):u.map(f=>f.tileID).sort(US).map(f=>f.key)}hasRenderableParent(o){const u=this.findLoadedParent(o,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(o,u){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(u||!this._tiles[o].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(+o,"reloading")}}_reloadTile(o,u){const f=this._tiles[o];f&&(f.state!=="loading"&&(f.state=u),this._loadTile(f,this._tileLoaded.bind(this,f,o,u)))}_tileLoaded(o,u,f,m){if(m)if(o.state="errored",m.status!==404)this._source.fire(new Dl(m,{tile:o}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const y=this.map.painter.terrain;this.update(this.transform,y.getScaledDemTileSize(),!0),y.resetTileLookupCache(this.id)}else this.update(this.transform);else o.timeAdded=ar.now(),f==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(u,o),this._source.type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new nr("data",{dataType:"source",tile:o,coord:o.tileID,sourceCacheId:this.id}))}_backfillDEM(o){const u=this.getRenderableIds();for(let m=0;m<u.length;m++){const y=u[m];if(o.neighboringTiles&&o.neighboringTiles[y]){const b=this.getTileByID(y);f(o,b),f(b,o)}}function f(m,y){if(!m.dem||m.dem.borderReady)return;m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0;let b=y.tileID.canonical.x-m.tileID.canonical.x;const T=y.tileID.canonical.y-m.tileID.canonical.y,A=Math.pow(2,m.tileID.canonical.z),L=y.tileID.key;b===0&&T===0||Math.abs(T)>1||(Math.abs(b)>1&&(Math.abs(b+A)===1?b+=A:Math.abs(b-A)===1&&(b-=A)),y.dem&&m.dem&&(m.dem.backfillBorder(y.dem,b,T),m.neighboringTiles&&m.neighboringTiles[L]&&(m.neighboringTiles[L].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,u,f,m){for(const y in this._tiles){let b=this._tiles[y];if(m[y]||!b.hasData()||b.tileID.overscaledZ<=u||b.tileID.overscaledZ>f)continue;let T=b.tileID;for(;b&&b.tileID.overscaledZ>u+1;){const L=b.tileID.scaledTo(b.tileID.overscaledZ-1);b=this._tiles[L.key],b&&b.hasData()&&(T=L)}let A=T;for(;A.overscaledZ>u;)if(A=A.scaledTo(A.overscaledZ-1),o[A.key]){m[T.key]=T;break}}}findLoadedParent(o,u){if(o.key in this._loadedParentTiles){const f=this._loadedParentTiles[o.key];return f&&f.tileID.overscaledZ>=u?f:null}for(let f=o.overscaledZ-1;f>=u;f--){const m=o.scaledTo(f),y=this._getLoadedTile(m);if(y)return y}}_getLoadedTile(o){const u=this._tiles[o.key];return u&&u.hasData()?u:this._cache.getByKey(this._source.reparseOverscaled?o.wrapped().key:o.canonical.key)}updateCacheSize(o,u){u=u||this._source.tileSize;const f=Math.ceil(o.width/u)+1,m=Math.ceil(o.height/u)+1,y=Math.floor(f*m*5),b=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,y):y,T=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,b):b;this._cache.setMaxSize(T)}handleWrapJump(o){const u=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,u){const f={};for(const m in this._tiles){const y=this._tiles[m];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+u),f[y.tileID.key]=y}this._tiles=f;for(const m in this._timers)clearTimeout(this._timers[m]),delete this._timers[m];for(const m in this._tiles)this._setTileReloadTimer(+m,this._tiles[m])}}update(o,u,f){if(this.transform=o,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!f)return;let m;this.updateCacheSize(o,u),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?m=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(T=>new nl(T.canonical.z,T.wrap,T.canonical.z,T.canonical.x,T.canonical.y)):(m=o.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!f,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(m=m.filter(T=>this._source.hasTile(T)))):m=[];const y=this._updateRetainedTiles(m);if(VS(this._source.type)&&m.length!==0){const T={},A={},L=Object.keys(y);for(const U of L){const j=y[U],Y=this._tiles[U];if(!Y||Y.fadeEndTime&&Y.fadeEndTime<=ar.now())continue;const J=this.findLoadedParent(j,Math.max(j.overscaledZ-e_.maxOverzooming,this._source.minzoom));J&&(this._addTile(J.tileID),T[J.tileID.key]=J.tileID),A[U]=j}const F=m[m.length-1].overscaledZ;for(const U in this._tiles){const j=this._tiles[U];if(y[U]||!j.hasData())continue;let Y=j.tileID;for(;Y.overscaledZ>F;){Y=Y.scaledTo(Y.overscaledZ-1);const J=this._tiles[Y.key];if(J&&J.hasData()&&A[Y.key]){y[U]=j.tileID;break}}}for(const U in T)y[U]||(this._coveredTiles[U]=!0,y[U]=T[U])}for(const T in y)this._tiles[T].clearFadeHold();const b=function(T,A){const L=[];for(const F in T)F in A||L.push(F);return L}(this._tiles,y);for(const T of b){const A=this._tiles[T];A.hasSymbolBuckets&&!A.holdingForFade()?A.setHoldDuration(this.map._fadeDuration):A.hasSymbolBuckets&&!A.symbolFadeFinished()||this._removeTile(+T)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(+o)}_updateRetainedTiles(o){const u={};if(o.length===0)return u;const f={},m=o.reduce((L,F)=>Math.min(L,F.overscaledZ),1/0),y=o[0].overscaledZ,b=Math.max(y-e_.maxOverzooming,this._source.minzoom),T=Math.max(y+e_.maxUnderzooming,this._source.minzoom),A={};for(const L of o){const F=this._addTile(L);u[L.key]=L,F.hasData()||m<this._source.maxzoom&&(A[L.key]=L)}this._retainLoadedChildren(A,m,T,u);for(const L of o){let F=this._tiles[L.key];if(F.hasData())continue;if(L.canonical.z>=this._source.maxzoom){const j=L.children(this._source.maxzoom)[0],Y=this.getTile(j);if(Y&&Y.hasData()){u[j.key]=j;continue}}else{const j=L.children(this._source.maxzoom);if(u[j[0].key]&&u[j[1].key]&&u[j[2].key]&&u[j[3].key])continue}let U=F.wasRequested();for(let j=L.overscaledZ-1;j>=b;--j){const Y=L.scaledTo(j);if(f[Y.key]||(f[Y.key]=!0,F=this.getTile(Y),!F&&U&&(F=this._addTile(Y)),F&&(u[Y.key]=Y,U=F.wasRequested(),F.hasData())))break}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const u=[];let f,m=this._tiles[o].tileID;for(;m.overscaledZ>0;){if(m.key in this._loadedParentTiles){f=this._loadedParentTiles[m.key];break}u.push(m.key);const y=m.scaledTo(m.overscaledZ-1);if(f=this._getLoadedTile(y),f)break;m=y}for(const y of u)this._loadedParentTiles[y]=f}}_addTile(o){let u=this._tiles[o.key];if(u)return u;u=this._cache.getAndRemove(o),u&&(this._setTileReloadTimer(o.key,u),u.tileID=o,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,u)));const f=!!u;if(!f){const m=this.map?this.map.painter:null;u=new fr(o,this._source.tileSize*o.overscaleFactor(),this.transform.tileZoom,m,this._isRaster),this._loadTile(u,this._tileLoaded.bind(this,u,o.key,u.state))}return u?(u.uses++,this._tiles[o.key]=u,f||this._source.fire(new nr("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u):null}_setTileReloadTimer(o,u){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const f=u.getExpiryTimeout();f&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},f))}_removeTile(o){const u=this._tiles[o];u&&(u.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(+o);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(o,u,f){const m=[],y=this.transform;if(!y)return m;const b=y.projection.name==="globe",T=Jh(y.center.lng);for(const A in this._tiles){const L=this._tiles[A];if(f&&L.clearQueryDebugViz(),L.holdingForFade())continue;let F;if(b){const U=L.tileID.canonical;if(U.z===0){const j=[Math.abs(nt(T,...K0(U,-1))-T),Math.abs(nt(T,...K0(U,1))-T)];F=[0,2*j.indexOf(Math.min(...j))-1]}else{const j=[Math.abs(nt(T,...K0(U,-1))-T),Math.abs(nt(T,...K0(U,0))-T),Math.abs(nt(T,...K0(U,1))-T)];F=[j.indexOf(Math.min(...j))-1]}}else F=[0];for(const U of F){const j=o.containsTile(L,y,u,U);j&&m.push(j)}}return m}getVisibleCoordinates(o){const u=this.getRenderableIds(o).map(f=>this._tiles[f].tileID);for(const f of u)f.projMatrix=this.transform.calculateProjMatrix(f.toUnwrapped());return u}hasTransition(){if(this._source.hasTransition())return!0;if(VS(this._source.type))for(const o in this._tiles){const u=this._tiles[o];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=ar.now())return!0}return!1}setFeatureState(o,u,f){this._state.updateState(o=o||"_geojsonTileLayer",u,f)}removeFeatureState(o,u,f){this._state.removeFeatureState(o=o||"_geojsonTileLayer",u,f)}getFeatureState(o,u){return this._state.getState(o=o||"_geojsonTileLayer",u)}setDependencies(o,u,f){const m=this._tiles[o];m&&m.setDependencies(u,f)}reloadTilesForDependencies(o,u){for(const f in this._tiles)this._tiles[f].hasDependency(o,u)&&this._reloadTile(+f,"reloading");this._cache.filter(f=>!f.hasDependency(o,u))}_preloadTiles(o,u){const f=new Map,m=Array.isArray(o)?o:[o],y=this.map.painter.terrain,b=this.usedForTerrain&&y?y.getScaledDemTileSize():this._source.tileSize;for(const T of m){const A=T.coveringTiles({tileSize:b,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const L of A)f.set(L.key,L);this.usedForTerrain&&T.updateElevation(!1)}et(Array.from(f.values()),(T,A)=>{const L=new fr(T,this._source.tileSize*T.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(L,F=>{this._source.type==="raster-dem"&&L.dem&&this._backfillDEM(L),A(F,L)})},u)}}function US(l,o){const u=Math.abs(2*l.wrap)-+(l.wrap<0),f=Math.abs(2*o.wrap)-+(o.wrap<0);return l.overscaledZ-o.overscaledZ||f-u||o.canonical.y-l.canonical.y||o.canonical.x-l.canonical.x}function VS(l){return l==="raster"||l==="image"||l==="video"||l==="custom"}function K0(l,o){const u=1<<l.z;return[l.x/u+o,(l.x+1)/u+o]}e_.maxOverzooming=10,e_.maxUnderzooming=3;class Ub{constructor(o,u,f){this._demTile=o,this._dem=this._demTile.dem,this._scale=u,this._offset=f}static create(o,u,f){const m=f||o.findDEMTileFor(u);if(!m||!m.dem)return;const y=m.dem,b=m.tileID,T=1<<u.canonical.z-b.canonical.z;return new Ub(m,m.tileSize/gi/T,[(u.canonical.x/T-b.canonical.x)*y.dim,(u.canonical.y/T-b.canonical.y)*y.dim])}tileCoordToPixel(o,u){const f=u*this._scale+this._offset[1],m=Math.floor(o*this._scale+this._offset[0]),y=Math.floor(f);return new ie(m,y)}getElevationAt(o,u,f,m){const y=o*this._scale+this._offset[0],b=u*this._scale+this._offset[1],T=Math.floor(y),A=Math.floor(b),L=this._dem;return m=!!m,f?Mi(Mi(L.get(T,A,m),L.get(T,A+1,m),b-A),Mi(L.get(T+1,A,m),L.get(T+1,A+1,m),b-A),y-T):L.get(T,A,m)}getElevationAtPixel(o,u,f){return this._dem.get(o,u,!!f)}getMeterToDEM(o){return(1<<this._demTile.tileID.canonical.z)*uh(1,o)*this._dem.stride}}class GS{constructor(o,u){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new Cd(gi,16,0),this.featureIndexArray=new zf,this.promoteId=u}insert(o,u,f,m,y,b=0){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,m,y,b);const A=this.grid;for(let L=0;L<u.length;L++){const F=u[L],U=[1/0,1/0,-1/0,-1/0];for(let j=0;j<F.length;j++){const Y=F[j];U[0]=Math.min(U[0],Y.x),U[1]=Math.min(U[1],Y.y),U[2]=Math.max(U[2],Y.x),U[3]=Math.max(U[3],Y.y)}U[0]<gi&&U[1]<gi&&U[2]>=0&&U[3]>=0&&A.insert(T,U[0],U[1],U[2],U[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new A0(new zd(this.rawTileData)).layers,this.sourceLayerCoder=new X(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const o in this.vtLayers)this.vtFeatures[o]=[]}return this.vtLayers}query(o,u,f,m){this.loadVTLayers();const y=o.params||{},b=lo(y.filter),T=o.tileResult,A=o.transform,L=T.bufferedTilespaceBounds,F=this.grid.query(L.min.x,L.min.y,L.max.x,L.max.y,(J,ee,ce,we)=>kx(T.bufferedTilespaceGeometry,J,ee,ce,we));F.sort(dP);let U=null;A.elevation&&F.length>0&&(U=Ub.create(A.elevation,this.tileID));const j={};let Y;for(let J=0;J<F.length;J++){const ee=F[J];if(ee===Y)continue;Y=ee;const ce=this.featureIndexArray.get(ee);let we=null;this.loadMatchingFeature(j,ce,b,y.layers,y.availableImages,u,f,m,(Pe,be,Me,Ve=0)=>(we||(we=jf(Pe,this.tileID.canonical,o.tileTransform)),be.queryIntersectsFeature(T,Pe,Me,we,this.z,o.transform,o.pixelPosMatrix,U,Ve)))}return j}loadMatchingFeature(o,u,f,m,y,b,T,A,L){const{featureIndex:F,bucketIndex:U,sourceLayerIndex:j,layoutVertexArrayOffset:Y}=u,J=this.bucketLayerIDs[U];if(m&&!function(Pe,be){for(let Me=0;Me<Pe.length;Me++)if(be.indexOf(Pe[Me])>=0)return!0;return!1}(m,J))return;const ee=this.sourceLayerCoder.decode(j),ce=this.vtLayers[ee].feature(F);if(f.needGeometry){const Pe=kp(ce,!0);if(!f.filter(new lt(this.tileID.overscaledZ),Pe,this.tileID.canonical))return}else if(!f.filter(new lt(this.tileID.overscaledZ),ce))return;const we=this.getId(ce,ee);for(let Pe=0;Pe<J.length;Pe++){const be=J[Pe];if(m&&m.indexOf(be)<0)continue;const Me=b[be];if(!Me)continue;let Ve={};we!==void 0&&A&&(Ve=A.getState(Me.sourceLayer||"_geojsonTileLayer",we));const ke=At({},T[be]);ke.paint=jS(ke.paint,Me.paint,ce,Ve,y),ke.layout=jS(ke.layout,Me.layout,ce,Ve,y);const _t=!L||L(ce,Me,Ve,Y);if(!_t)continue;const mt=new ye(ce,this.z,this.x,this.y,we);mt.layer=ke;let Pt=o[be];Pt===void 0&&(Pt=o[be]=[]),Pt.push({featureIndex:F,feature:mt,intersectionZ:_t})}}lookupSymbolFeatures(o,u,f,m,y,b,T,A){const L={};this.loadVTLayers();const F=lo(y);for(const U of o)this.loadMatchingFeature(L,{bucketIndex:f,sourceLayerIndex:m,featureIndex:U,layoutVertexArrayOffset:0},F,b,T,A,u);return L}loadFeature(o){const{featureIndex:u,sourceLayerIndex:f}=o;this.loadVTLayers();const m=this.sourceLayerCoder.decode(f),y=this.vtFeatures[m];if(y[u])return y[u];const b=this.vtLayers[m].feature(u);return y[u]=b,b}hasLayer(o){for(const u of this.bucketLayerIDs)for(const f of u)if(o===f)return!0;return!1}getId(o,u){let f=o.id;if(this.promoteId){const m=typeof this.promoteId=="string"?this.promoteId:this.promoteId[u];m!=null&&(f=o.properties[m]),typeof f=="boolean"&&(f=Number(f))}return f}}function jS(l,o,u,f,m){return on(l,(y,b)=>{const T=o instanceof pt?o.get(b):null;return T&&T.evaluate?T.evaluate(u,f,m):T})}function dP(l,o){return o-l}Cn(GS,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class qS{constructor(o,u){this.width=o,this.height=u,this.nextRow=0,this.image=new bc({width:o,height:u}),this.positions={},this.uploaded=!1}getDash(o,u){const f=this.getKey(o,u);return this.positions[f]}trim(){const o=this.width,u=this.height=ri(this.nextRow);this.image.resize({width:o,height:u})}getKey(o,u){return o.join(",")+u}getDashRanges(o,u,f){const m=[];let y=o.length%2==1?-o[o.length-1]*f:0,b=o[0]*f,T=!0;m.push({left:y,right:b,isDash:T,zeroLength:o[0]===0});let A=o[0];for(let L=1;L<o.length;L++){T=!T;const F=o[L];y=A*f,A+=F,b=A*f,m.push({left:y,right:b,isDash:T,zeroLength:F===0})}return m}addRoundDash(o,u,f){const m=u/2;for(let y=-f;y<=f;y++){const b=this.width*(this.nextRow+f+y);let T=0,A=o[T];for(let L=0;L<this.width;L++){L/A.right>1&&(A=o[++T]);const F=Math.abs(L-A.left),U=Math.abs(L-A.right),j=Math.min(F,U);let Y;const J=y/f*(m+1);if(A.isDash){const ee=m-Math.abs(J);Y=Math.sqrt(j*j+ee*ee)}else Y=m-Math.sqrt(j*j+J*J);this.image.data[b+L]=Math.max(0,Math.min(255,Y+128))}}}addRegularDash(o,u){for(let A=o.length-1;A>=0;--A){const L=o[A],F=o[A+1];L.zeroLength?o.splice(A,1):F&&F.isDash===L.isDash&&(F.left=L.left,o.splice(A,1))}const f=o[0],m=o[o.length-1];f.isDash===m.isDash&&(f.left=m.left-this.width,m.right=f.right+this.width);const y=this.width*this.nextRow;let b=0,T=o[b];for(let A=0;A<this.width;A++){A/T.right>1&&(T=o[++b]);const L=Math.abs(A-T.left),F=Math.abs(A-T.right),U=Math.min(L,F);this.image.data[y+A]=Math.max(0,Math.min(255,(T.isDash?U:-U)+u+128))}}addDash(o,u){const f=this.getKey(o,u);if(this.positions[f])return this.positions[f];const m=u==="round",y=m?7:0,b=2*y+1;if(this.nextRow+b>this.height)return Gn("LineAtlas out of space"),null;o.length===0&&o.push(1);let T=0;for(let F=0;F<o.length;F++)o[F]<0&&(Gn("Negative value is found in line dasharray, replacing values with 0"),o[F]=0),T+=o[F];if(T!==0){const F=this.width/T,U=this.getDashRanges(o,this.width,F);m?this.addRoundDash(U,F,y):this.addRegularDash(U,u==="square"?.5*F:0)}const A=this.nextRow+y;this.nextRow+=b;const L={tl:[A,y],br:[T,0]};return this.positions[f]=L,L}}Cn(qS,"LineAtlas");class HS{constructor(o){const u={},f=[];for(const T in o){const A=o[T],L=u[T]={};for(const F in A.glyphs){const U=A.glyphs[+F];if(!U||U.bitmap.width===0||U.bitmap.height===0)continue;const j=U.metrics.localGlyph?2:1,Y={x:0,y:0,w:U.bitmap.width+2*j,h:U.bitmap.height+2*j};f.push(Y),L[F]=Y}}const{w:m,h:y}=Ay(f),b=new bc({width:m||1,height:y||1});for(const T in o){const A=o[T];for(const L in A.glyphs){const F=A.glyphs[+L];if(!F||F.bitmap.width===0||F.bitmap.height===0)continue;const U=u[T][L],j=F.metrics.localGlyph?2:1;bc.copy(F.bitmap,b,{x:0,y:0},{x:U.x+j,y:U.y+j},F.bitmap)}}this.image=b,this.positions=u}}Cn(HS,"GlyphAtlas");class pP{constructor(o){this.tileID=new nl(o.tileID.overscaledZ,o.tileID.wrap,o.tileID.canonical.z,o.tileID.canonical.x,o.tileID.canonical.y),this.tileZoom=o.tileZoom,this.uid=o.uid,this.zoom=o.zoom,this.canonical=o.tileID.canonical,this.pixelRatio=o.pixelRatio,this.tileSize=o.tileSize,this.source=o.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=o.showCollisionBoxes,this.collectResourceTiming=!!o.collectResourceTiming,this.returnDependencies=!!o.returnDependencies,this.promoteId=o.promoteId,this.enableTerrain=!!o.enableTerrain,this.isSymbolTile=o.isSymbolTile,this.tileTransform=Up(o.tileID.canonical,o.projection),this.projection=o.projection}parse(o,u,f,m,y){this.status="parsing",this.data=o,this.collisionBoxArray=new Jv;const b=new X(Object.keys(o.layers).sort()),T=new GS(this.tileID,this.promoteId);T.bucketLayerIDs=[];const A={},L=new qS(256,256),F={featureIndex:T,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:L,availableImages:f},U=u.familiesBySource[this.source];for(const Ve in U){const ke=o.layers[Ve];if(!ke)continue;let _t=!1,mt=!1;for(const bt of U[Ve])bt[0].type==="symbol"?_t=!0:mt=!0;if(this.isSymbolTile===!0&&!_t||this.isSymbolTile===!1&&!mt)continue;ke.version===1&&Gn(`Vector tile source "${this.source}" layer "${Ve}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Pt=b.encode(Ve),Jt=[];for(let bt=0;bt<ke.length;bt++){const Bt=ke.feature(bt),Vt=T.getId(Bt,Ve);Jt.push({feature:Bt,id:Vt,index:bt,sourceLayerIndex:Pt})}for(const bt of U[Ve]){const Bt=bt[0];this.isSymbolTile!==void 0&&Bt.type==="symbol"!==this.isSymbolTile||Bt.minzoom&&this.zoom<Math.floor(Bt.minzoom)||Bt.maxzoom&&this.zoom>=Bt.maxzoom||Bt.visibility!=="none"&&(jI(bt,this.zoom,f),(A[Bt.id]=Bt.createBucket({index:T.bucketLayerIDs.length,layers:bt,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Pt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:f})).populate(Jt,F,this.tileID.canonical,this.tileTransform),T.bucketLayerIDs.push(bt.map(Vt=>Vt.id)))}}let j,Y,J,ee;L.trim();const ce={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},we=on(F.glyphDependencies,Ve=>Object.keys(Ve).map(Number));Object.keys(we).length?m.send("getGlyphs",{uid:this.uid,stacks:we},(Ve,ke)=>{j||(j=Ve,Y=ke,Me.call(this))},void 0,!1,ce):Y={};const Pe=Object.keys(F.iconDependencies);Pe.length?m.send("getImages",{icons:Pe,source:this.source,tileID:this.tileID,type:"icons"},(Ve,ke)=>{j||(j=Ve,J=ke,Me.call(this))},void 0,!1,ce):J={};const be=Object.keys(F.patternDependencies);function Me(){if(j)return y(j);if(Y&&J&&ee){const Ve=new HS(Y),ke=new mb(J,ee);for(const _t in A){const mt=A[_t];mt instanceof Vd?(jI(mt.layers,this.zoom,f),wI(mt,Y,Ve.positions,J,ke.iconPositions,this.showCollisionBoxes,f,this.tileID.canonical,this.tileZoom,this.projection)):mt.hasPattern&&(mt instanceof Bd||mt instanceof jg||mt instanceof Xi)&&(jI(mt.layers,this.zoom,f),mt.addFeatures(F,this.tileID.canonical,ke.patternPositions,f,this.tileTransform))}this.status="done",y(null,{buckets:Ze(A).filter(_t=>!_t.isEmpty()),featureIndex:T,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ve.image,lineAtlas:L,imageAtlas:ke,glyphMap:this.returnDependencies?Y:null,iconMap:this.returnDependencies?J:null,glyphPositions:this.returnDependencies?Ve.positions:null})}}be.length?m.send("getImages",{icons:be,source:this.source,tileID:this.tileID,type:"patterns"},(Ve,ke)=>{j||(j=Ve,ee=ke,Me.call(this))},void 0,!1,ce):ee={},Me.call(this)}}function jI(l,o,u){const f=new lt(o);for(const m of l)m.recalculate(f,u)}class WS{constructor(o){this.entries={},this.scheduler=o}request(o,u,f,m){const y=this.entries[o]=this.entries[o]||{callbacks:[]};if(y.result){const[b,T]=y.result;return this.scheduler?this.scheduler.add(()=>{m(b,T)},u):m(b,T),()=>{}}return y.callbacks.push(m),y.cancel||(y.cancel=f((b,T)=>{y.result=[b,T];for(const A of y.callbacks)this.scheduler?this.scheduler.add(()=>{A(b,T)},u):A(b,T);setTimeout(()=>delete this.entries[o],3e3)})),()=>{y.result||(y.callbacks=y.callbacks.filter(b=>b!==m),y.callbacks.length||(y.cancel(),delete this.entries[o]))}}}function XS(l,o,u){const f=JSON.stringify(l.request);return l.data&&(this.deduped.entries[f]={result:[null,l.data]}),this.deduped.request(f,{type:"parseTile",isSymbolTile:l.isSymbolTile,zoom:l.tileZoom},m=>{const y=Ds(l.request,(b,T,A,L)=>{b?m(b):T&&m(null,{vectorTile:u?void 0:new A0(new zd(T)),rawData:T,cacheControl:A,expires:L})});return()=>{y.cancel(),m()}},o)}s.ARRAY_TYPE=el,s.AUTH_ERR_MSG=qa,s.Aabb=gl,s.Actor=class{constructor(l,o,u){this.target=l,this.parent=o,this.mapId=u,this.callbacks={},this.cancelCallbacks={},ii(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Mt()?l:p,this.scheduler=new R}send(l,o,u,f,m=!1,y){const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=y,this.callbacks[b]=u);const T=jr(this.globalScope)?void 0:[];return this.target.postMessage({id:b,type:l,hasCallback:!!u,targetMapId:f,mustQueue:m,sourceMapId:this.mapId,data:Cp(o,T)},T),{cancel:()=>{u&&delete this.callbacks[b],this.target.postMessage({id:b,type:"<cancel>",targetMapId:f,sourceMapId:this.mapId})}}}receive(l){const o=l.data,u=o.id;if(u&&(!o.targetMapId||this.mapId===o.targetMapId))if(o.type==="<cancel>"){const f=this.cancelCallbacks[u];delete this.cancelCallbacks[u],f&&f.cancel()}else if(o.mustQueue||Mt()){const f=this.callbacks[u];this.cancelCallbacks[u]=this.scheduler.add(()=>this.processTask(u,o),f&&f.metadata||{type:"message"})}else this.processTask(u,o)}processTask(l,o){if(o.type==="<response>"){const u=this.callbacks[l];delete this.callbacks[l],u&&(o.error?u(Ap(o.error)):u(null,Ap(o.data)))}else{const u=jr(this.globalScope)?void 0:[],f=o.hasCallback?(y,b)=>{delete this.cancelCallbacks[l],this.target.postMessage({id:l,type:"<response>",sourceMapId:this.mapId,error:y?Cp(y):null,data:Cp(b,u)},u)}:y=>{},m=Ap(o.data);if(this.parent[o.type])this.parent[o.type](o.sourceMapId,m,f);else if(this.parent.getWorkerSource){const y=o.type.split(".");this.parent.getWorkerSource(o.sourceMapId,y[0],m.source)[y[1]](m,f)}else f(new Error(`Could not find function ${o.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},s.CanonicalTileID=Sy,s.Color=Ai,s.ColorMode=Gd,s.CullFaceMode=Zf,s.DEMData=zb,s.DataConstantProperty=at,s.DedupedRequest=WS,s.DepthMode=Vy,s.EXTENT=gi,s.Elevation=class{isDataAvailableAtPoint(l){const o=this._source();if(this.isUsingMockSource()||!o||l.y<0||l.y>1)return!1;const u=o.getSource().maxzoom,f=1<<u,m=Math.floor(l.x),y=Math.floor((l.x-m)*f),b=Math.floor(l.y*f),T=this.findDEMTileFor(new nl(u,m,u,y,b));return!(!T||!T.dem)}getAtPointOrZero(l,o=0){return this.getAtPoint(l,o)||0}getAtPoint(l,o,u=!0){if(this.isUsingMockSource())return null;o==null&&(o=null);const f=this._source();if(!f||l.y<0||l.y>1)return o;const m=f.getSource().maxzoom,y=1<<m,b=Math.floor(l.x),T=l.x-b,A=new nl(m,b,m,Math.floor(T*y),Math.floor(l.y*y)),L=this.findDEMTileFor(A);if(!L||!L.dem)return o;const F=L.dem,U=1<<L.tileID.canonical.z,j=(T*U-L.tileID.canonical.x)*F.dim,Y=(l.y*U-L.tileID.canonical.y)*F.dim,J=Math.floor(j),ee=Math.floor(Y);return(u?this.exaggeration():1)*Mi(Mi(F.get(J,ee),F.get(J,ee+1),Y-ee),Mi(F.get(J+1,ee),F.get(J+1,ee+1),Y-ee),j-J)}getAtTileOffset(l,o,u){const f=1<<l.canonical.z;return this.getAtPointOrZero(new wm(l.wrap+(l.canonical.x+o/gi)/f,(l.canonical.y+u/gi)/f))}getAtTileOffsetFunc(l,o,u,f){return m=>{const y=this.getAtTileOffset(l,m.x,m.y),b=f.upVector(l.canonical,m.x,m.y);return pl(b,b,y*f.upVectorScale(l.canonical,o,u).metersToTile),b}}getForTilePoints(l,o,u,f){if(this.isUsingMockSource())return!1;const m=Ub.create(this,l,f);return!!m&&(o.forEach(y=>{y[2]=this.exaggeration()*m.getElevationAt(y[0],y[1],u)}),!0)}getMinMaxForTile(l){if(this.isUsingMockSource())return null;const o=this.findDEMTileFor(l);if(!o||!o.dem)return null;const u=o.dem.tree,f=o.tileID,m=1<<l.canonical.z-f.canonical.z;let y=l.canonical.x/m-f.canonical.x,b=l.canonical.y/m-f.canonical.y,T=0;for(let A=0;A<l.canonical.z-f.canonical.z&&!u.leaves[T];A++){y*=2,b*=2;const L=2*Math.floor(b)+Math.floor(y);T=u.childOffsets[T]+L,y%=1,b%=1}return{min:this.exaggeration()*u.minimums[T],max:this.exaggeration()*u.maximums[T]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(l,o,u){throw new Error("Pure virtual method called.")}pointCoordinate(l){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(l){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},s.ErrorEvent=Dl,s.EvaluationParameters=lt,s.Event=nr,s.Evented=la,s.FillExtrusionBucket=Xi,s.Frustum=o0,s.FrustumCorners=ny,s.GLOBE_RADIUS=Yh,s.GLOBE_SCALE_MATCH_LATITUDE=45,s.GLOBE_ZOOM_THRESHOLD_MAX=6,s.GLOBE_ZOOM_THRESHOLD_MIN=5,s.GlobeSharedBuffers=class{constructor(l){this._createGrid(l),this._createPoles(l)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const l of this._poleSegments)l.destroy();for(const l of this._gridSegments)l.withSkirts.destroy(),l.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const l of this._wireframeSegments)l.destroy()}}_fillGridMeshWithLods(l,o){const u=new oi,f=new da,m=[],y=l+1+2,b=o[0]+1,T=o[0]+1+(1+o.length),A=(L,F,U)=>{let j=L===y-1?L-2:L===0?L:L-1;return j+=U?24575:0,[j,F]};for(let L=0;L<y;++L)u.emplaceBack(...A(L,0,!0));for(let L=0;L<b;++L)for(let F=0;F<y;++F)u.emplaceBack(...A(F,L,(F===0||F===y-1)&&!0));for(let L=0;L<o.length;++L){const F=o[L];for(let U=0;U<y;++U)u.emplaceBack(...A(U,F,!0))}for(let L=0;L<o.length;++L){const F=f.length,U=o[L]+1+2,j=new da;for(let ee=0;ee<U-1;ee++){const ce=ee===U-2,we=ce?y*(T-o.length+L-ee):y;for(let Pe=0;Pe<y-1;Pe++){const be=ee*y+Pe;ee===0||ce||Pe===0||Pe===y-2?(j.emplaceBack(be+1,be,be+we),j.emplaceBack(be+we,be+we+1,be+1)):(f.emplaceBack(be+1,be,be+we),f.emplaceBack(be+we,be+we+1,be+1))}}const Y=Gs.simpleSegment(0,F,u.length,f.length-F);for(let ee=0;ee<j.uint16.length;ee+=3)f.emplaceBack(j.uint16[ee],j.uint16[ee+1],j.uint16[ee+2]);const J=Gs.simpleSegment(0,F,u.length,f.length-F);m.push({withoutSkirts:Y,withSkirts:J})}return{vertices:u,indices:f,segments:m}}_createGrid(l){const o=this._fillGridMeshWithLods(Op,ym);this._gridSegments=o.segments,this._gridBuffer=l.createVertexBuffer(o.vertices,Gf.members),this._gridIndexBuffer=l.createIndexBuffer(o.indices,!0)}_createPoles(l){const o=new da;for(let m=0;m<=Op;m++)o.emplaceBack(0,m+1,m+2);this._poleIndexBuffer=l.createIndexBuffer(o,!0);const u=new Pi,f=new Pi;this._poleSegments=[];for(let m=0,y=0;m<5;m++){const b=360/(1<<m);u.emplaceBack(0,-Yh,0,.5,0),f.emplaceBack(0,-Yh,0,.5,1);for(let T=0;T<=Op;T++){const A=T/Op,L=Mi(0,b,A),[F,U,j]=xm(Sx,Cx,L,Yh);u.emplaceBack(F,U,j,A,0),f.emplaceBack(F,U,j,A,1)}this._poleSegments.push(Gs.simpleSegment(y,0,66,64)),y+=66}this._poleNorthVertexBuffer=l.createVertexBuffer(u,bx,!1),this._poleSouthVertexBuffer=l.createVertexBuffer(f,bx,!1)}getGridBuffers(l,o){return[this._gridBuffer,this._gridIndexBuffer,o?this._gridSegments[l].withSkirts:this._gridSegments[l].withoutSkirts]}getPoleBuffers(l){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[l]]}getWirefameBuffers(l,o){if(!this._wireframeSegments){const u=new Wh,f=Op,m=f+1+2,y=1;this._wireframeSegments=[];for(let b=0,T=0;b<ym.length;b++){const A=ym[b];for(let F=y;F<A+y;F++)for(let U=y;U<f+y;U++){const j=F*m+U;u.emplaceBack(j,j+1),u.emplaceBack(j,j+m),u.emplaceBack(j,j+m+1)}const L=A*f*3;this._wireframeSegments.push(Gs.simpleSegment(0,T,(A+1)*m,L)),T+=L}this._wireframeIndexBuffer=l.createIndexBuffer(u)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[o]]}},s.GlyphManager=Pm,s.ImagePosition=N0,s.LivePerformanceUtils=Ye,s.LngLat=Ir,s.LngLatBounds=ih,s.LocalGlyphMode=U0,s.MAX_MERCATOR_LATITUDE=Es,s.MercatorCoordinate=wm,s.ONE_EM=ma,s.OverscaledTileID=nl,s.PerformanceMarkers=ue,s.Properties=Ht,s.RGBAImage=uu,s.Ray=ty,s.RequestManager=class{constructor(l,o,u){this._transformRequestFn=l,this._customAccessToken=o,this._silenceAuthErrors=!!u,this._createSkuToken()}_createSkuToken(){const l=function(){let o="";for(let u=0;u<10;u++)o+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Z,o].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=l.token,this._skuTokenExpiresAt=l.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(l,o){return this._transformRequestFn&&this._transformRequestFn(l,o)||{url:l}}normalizeStyleURL(l,o){if(!ro(l))return l;const u=Bs(l);return u.path=`/styles/v1${u.path}`,this._makeAPIURL(u,this._customAccessToken||o)}normalizeGlyphsURL(l,o){if(!ro(l))return l;const u=Bs(l);return u.path=`/fonts/v1${u.path}`,this._makeAPIURL(u,this._customAccessToken||o)}normalizeSourceURL(l,o,u,f){if(!ro(l))return l;const m=Bs(l);return m.path=`/v4/${m.authority}.json`,m.params.push("secure"),u&&m.params.push(`language=${u}`),f&&m.params.push(`worldview=${f}`),this._makeAPIURL(m,this._customAccessToken||o)}normalizeSpriteURL(l,o,u,f){const m=Bs(l);return ro(l)?(m.path=`/styles/v1${m.path}/sprite${o}${u}`,this._makeAPIURL(m,this._customAccessToken||f)):(m.path+=`${o}${u}`,Ta(m))}normalizeTileURL(l,o,u){if(this._isSkuTokenExpired()&&this._createSkuToken(),l&&!ro(l))return l;const f=Bs(l);f.path=f.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${o||u&&f.authority!=="raster"&&u===512?"@2x":""}${M.supported?".webp":"$1"}`),f.authority==="raster"?f.path=`/${C.RASTER_URL_PREFIX}${f.path}`:(f.path=f.path.replace(/^.+\/v4\//,"/"),f.path=`/${C.TILE_URL_VERSION}${f.path}`);const m=this._customAccessToken||function(y){for(const b of y){const T=b.match(/^access_token=(.*)$/);if(T)return T[1]}return null}(f.params)||C.ACCESS_TOKEN;return C.REQUIRE_ACCESS_TOKEN&&m&&this._skuToken&&f.params.push(`sku=${this._skuToken}`),this._makeAPIURL(f,m)}canonicalizeTileURL(l,o){const u=Bs(l);if(!u.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!u.path.match(/\.[\w]+$/))return l;let f="mapbox://";u.path.match(/^\/raster\/v1\//)?f+=`raster/${u.path.replace(`/${C.RASTER_URL_PREFIX}/`,"")}`:f+=`tiles/${u.path.replace(`/${C.TILE_URL_VERSION}/`,"")}`;let m=u.params;return o&&(m=m.filter(y=>!y.match(/^access_token=/))),m.length&&(f+=`?${m.join("&")}`),f}canonicalizeTileset(l,o){const u=!!o&&ro(o),f=[];for(const m of l.tiles||[])Ia(m)?f.push(this.canonicalizeTileURL(m,u)):f.push(m);return f}_makeAPIURL(l,o){const u="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",f=Bs(C.API_URL);if(l.protocol=f.protocol,l.authority=f.authority,l.protocol==="http"){const m=l.params.indexOf("secure");m>=0&&l.params.splice(m,1)}if(f.path!=="/"&&(l.path=`${f.path}${l.path}`),!C.REQUIRE_ACCESS_TOKEN)return Ta(l);if(o=o||C.ACCESS_TOKEN,!this._silenceAuthErrors){if(!o)throw new Error(`An API access token is required to use Mapbox GL. ${u}`);if(o[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${u}`)}return l.params=l.params.filter(m=>m.indexOf("access_token")===-1),l.params.push(`access_token=${o||""}`),Ta(l)}},s.ResourceType=kt,s.SegmentVector=Gs,s.SourceCache=e_,s.StencilMode=UI,s.StructArrayLayout1ui2=ou,s.StructArrayLayout2f1f2i16=fa,s.StructArrayLayout2i4=oi,s.StructArrayLayout2ui4=Wh,s.StructArrayLayout3f12=na,s.StructArrayLayout3ui6=da,s.StructArrayLayout4i8=qr,s.StructArrayLayout5f20=Pi,s.Texture=g,s.Tile=fr,s.Transitionable=nn,s.Uniform1f=J_,s.Uniform1i=class extends $c{constructor(l){super(l),this.current=0}set(l,o,u){this.fetchUniformLocation(l,o)&&this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}},s.Uniform2f=class extends $c{constructor(l){super(l),this.current=[0,0]}set(l,o,u){this.fetchUniformLocation(l,o)&&(u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1])))}},s.Uniform3f=class extends $c{constructor(l){super(l),this.current=[0,0,0]}set(l,o,u){this.fetchUniformLocation(l,o)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2])))}},s.Uniform4f=sx,s.UniformColor=ox,s.UniformMatrix2f=class extends $c{constructor(l){super(l),this.current=lw}set(l,o,u){if(this.fetchUniformLocation(l,o)){for(let f=0;f<4;f++)if(u[f]!==this.current[f]){this.current=u,this.gl.uniformMatrix2fv(this.location,!1,u);break}}}},s.UniformMatrix3f=class extends $c{constructor(l){super(l),this.current=lx}set(l,o,u){if(this.fetchUniformLocation(l,o)){for(let f=0;f<9;f++)if(u[f]!==this.current[f]){this.current=u,this.gl.uniformMatrix3fv(this.location,!1,u);break}}}},s.UniformMatrix4f=class extends $c{constructor(l){super(l),this.current=ax}set(l,o,u){if(this.fetchUniformLocation(l,o)){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let f=1;f<16;f++)if(u[f]!==this.current[f]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}}},s.UnwrappedTileID=$h,s.ValidationError=Sn,s.VectorTileFeature=wy,s.VectorTileWorkerSource=class extends la{constructor(l,o,u,f,m){super(),this.actor=l,this.layerIndex=o,this.availableImages=u,this.loadVectorData=m||XS,this.loading={},this.loaded={},this.deduped=new WS(l.scheduler),this.isSpriteLoaded=f,this.scheduler=l.scheduler}loadTile(l,o){const u=l.uid,f=l&&l.request,m=f&&f.collectResourceTiming,y=this.loading[u]=new pP(l);y.abort=this.loadVectorData(l,(b,T)=>{const A=!this.loading[u];if(delete this.loading[u],A||b||!T)return y.status="done",A||(this.loaded[u]=y),o(b);const L=T.rawData,F={};T.expires&&(F.expires=T.expires),T.cacheControl&&(F.cacheControl=T.cacheControl),y.vectorTile=T.vectorTile||new A0(new zd(L));const U=()=>{y.parse(y.vectorTile,this.layerIndex,this.availableImages,this.actor,(j,Y)=>{if(j||!Y)return o(j);const J={};if(m){const ee=vn(f);ee.length>0&&(J.resourceTiming=JSON.parse(JSON.stringify(ee)))}o(null,At({rawTileData:L.slice(0)},Y,F,J))})};this.isSpriteLoaded?U():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(U,{type:"parseTile",isSymbolTile:l.isSymbolTile,zoom:l.tileZoom}):U()}),this.loaded=this.loaded||{},this.loaded[u]=y})}reloadTile(l,o){const u=this.loaded,f=l.uid,m=this;if(u&&u[f]){const y=u[f];y.showCollisionBoxes=l.showCollisionBoxes,y.enableTerrain=!!l.enableTerrain,y.projection=l.projection,y.tileTransform=Up(l.tileID.canonical,l.projection);const b=(T,A)=>{const L=y.reloadCallback;L&&(delete y.reloadCallback,y.parse(y.vectorTile,m.layerIndex,this.availableImages,m.actor,L)),o(T,A)};y.status==="parsing"?y.reloadCallback=b:y.status==="done"&&(y.vectorTile?y.parse(y.vectorTile,this.layerIndex,this.availableImages,this.actor,b):b())}}abortTile(l,o){const u=l.uid,f=this.loading[u];f&&(f.abort&&f.abort(),delete this.loading[u]),o()}removeTile(l,o){const u=this.loaded,f=l.uid;u&&u[f]&&delete u[f],o()}},s.WritingMode=Uu,s.ZoomDependentExpression=Ou,s.add=sh,s.addDynamicAttributes=zy,s.adjoint=function(l,o){var u=o[0],f=o[1],m=o[2],y=o[3],b=o[4],T=o[5],A=o[6],L=o[7],F=o[8];return l[0]=b*F-T*L,l[1]=m*L-f*F,l[2]=f*T-m*b,l[3]=T*A-y*F,l[4]=u*F-m*A,l[5]=m*y-u*T,l[6]=y*L-b*A,l[7]=f*A-u*L,l[8]=u*b-f*y,l},s.asyncAll=et,s.bezier=Ge,s.bindAll=ii,s.boundsAttributes=pi,s.bufferConvexPolygon=function(l,o){const u=[];for(let f=0;f<l.length;f++){const m=Ot(f-1,-1,l.length-1),y=Ot(f+1,-1,l.length-1),b=l[f],T=l[y],A=l[m].sub(b).unit(),L=T.sub(b).unit(),F=L.angleWithSep(A.x,A.y),U=A.add(L).unit().mult(-1*o/Math.sin(F/2));u.push(b.add(U))}return u},s.cacheEntryPossiblyAdded=function(l){Rs++,Rs>fi&&(l.getActor().send("enforceCacheSizeLimit",Tn),Rs=0)},s.calculateGlobeLabelMatrix=function(l,o){const{x:u,y:f}=l.point,m=Ix(u,f,l.worldSize/l._pixelsPerMercatorPixel,0,0);return Vf(m,m,c0(ah(o)))},s.calculateGlobeMatrix=function(l){const{x:o,y:u}=l.point,{lng:f,lat:m}=l._center;return Ix(o,u,l.worldSize,f,m)},s.calculateGlobeMercatorMatrix=function(l){const o=l.pixelsPerMeter,u=o/uh(1,l.center.lat),f=lu(new Float64Array(16));return Ag(f,f,[l.point.x,l.point.y,0]),Od(f,f,[u,u,o]),Float32Array.from(f)},s.circumferenceAtLatitude=ay,s.clamp=nt,s.clearTileCache=function(l){if(!Kn())return;const o=p.caches.delete(Hi);l&&o.catch(l).then(()=>l())},s.clipLine=Tb,s.clone=function(l){var o=new el(16);return o[0]=l[0],o[1]=l[1],o[2]=l[2],o[3]=l[3],o[4]=l[4],o[5]=l[5],o[6]=l[6],o[7]=l[7],o[8]=l[8],o[9]=l[9],o[10]=l[10],o[11]=l[11],o[12]=l[12],o[13]=l[13],o[14]=l[14],o[15]=l[15],o},s.clone$1=Ut,s.collisionCircleLayout=eI,s.config=C,s.conjugate=function(l,o){return l[0]=-o[0],l[1]=-o[1],l[2]=-o[2],l[3]=o[3],l},s.create=function(){var l=new el(16);return el!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0),l[0]=1,l[5]=1,l[10]=1,l[15]=1,l},s.create$1=px,s.createExpression=Zc,s.createLayout=ni,s.createStyleLayer=function(l){return l.type==="custom"?new kI(l):new BI[l.type](l)},s.cross=Rg,s.degToRad=Fe,s.distance=function(l,o){return Math.hypot(o[0]-l[0],o[1]-l[1],o[2]-l[2])},s.div=function(l,o,u){return l[0]=o[0]/u[0],l[1]=o[1]/u[1],l[2]=o[2]/u[2],l},s.dot=vc,s.earthRadius=Fg,s.ease=Le,s.easeCubicInOut=dt,s.ecefToLatLng=function([l,o,u]){const f=Math.hypot(l,o,u),m=Math.atan2(l,u),y=.5*Math.PI-Math.acos(-o/f);return new Ir(Ne(m),Ne(y))},s.emitValidationErrors=N_,s.endsWith=kn,s.enforceCacheSizeLimit=function(l){pn(),or&&or.then(o=>{o.keys().then(u=>{for(let f=0;f<u.length-l;f++)o.delete(u[f])})})},s.evaluateSizeForFeature=Xg,s.evaluateSizeForZoom=il,s.evaluateVariableOffset=Lb,s.evented=Se,s.exactEquals=function(l,o){return l[0]===o[0]&&l[1]===o[1]&&l[2]===o[2]&&l[3]===o[3]},s.exactEquals$1=function(l,o){return l[0]===o[0]&&l[1]===o[1]&&l[2]===o[2]},s.exported=ar,s.exported$1=M,s.extend=At,s.extend$1=Ol,s.fillExtrusionHeightLift=nb,s.filterObject=Di,s.fromMat4=function(l,o){return l[0]=o[0],l[1]=o[1],l[2]=o[2],l[3]=o[4],l[4]=o[5],l[5]=o[6],l[6]=o[8],l[7]=o[9],l[8]=o[10],l},s.fromQuat=function(l,o){var u=o[0],f=o[1],m=o[2],y=o[3],b=u+u,T=f+f,A=m+m,L=u*b,F=f*b,U=f*T,j=m*b,Y=m*T,J=m*A,ee=y*b,ce=y*T,we=y*A;return l[0]=1-U-J,l[1]=F+we,l[2]=j-ce,l[3]=0,l[4]=F-we,l[5]=1-L-J,l[6]=Y+ee,l[7]=0,l[8]=j+ce,l[9]=Y-ee,l[10]=1-L-U,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l},s.fromRotation=function(l,o){var u=Math.sin(o),f=Math.cos(o);return l[0]=f,l[1]=u,l[2]=0,l[3]=-u,l[4]=f,l[5]=0,l[6]=0,l[7]=0,l[8]=1,l},s.fromScaling=n0,s.furthestTileCorner=function(l){const o=Math.round((l+45+360)%360/90)%4;return Ue[o]},s.getAABBPointSquareDist=function(l,o,u){let f=0;for(let m=0;m<2;++m){const y=u?u[m]:0;l[m]>y&&(f+=(l[m]-y)*(l[m]-y)),o[m]<y&&(f+=(y-o[m])*(y-o[m]))}return f},s.getAnchorAlignment=Ud,s.getAnchorJustification=Yg,s.getBounds=function(l){let o=1/0,u=1/0,f=-1/0,m=-1/0;for(const y of l)o=Math.min(o,y.x),u=Math.min(u,y.y),f=Math.max(f,y.x),m=Math.max(m,y.y);return{min:new ie(o,u),max:new ie(f,m)}},s.getColumn=hi,s.getGridMatrix=function(l,o,u,f){const m=o.getNorth(),y=o.getSouth(),b=o.getWest(),T=o.getEast(),A=1<<l.z,L=T-b,F=m-y,U=L/Op,j=-F/ym[u],Y=[0,U,0,j,0,0,m,b,0];if(l.z>0){const J=180/f;t0(Y,Y,[J/L+1,0,0,0,J/F+1,0,-.5*J/U,.5*J/j,1])}return Y[2]=A,Y[5]=l.x,Y[8]=l.y,Y},s.getImage=Mo,s.getJSON=function(l,o){return ki(At(l,{type:"json"}),o)},s.getLatitudinalLod=function(l){const o=Es-5;l=nt(l,-o,o)/o*90;const u=Math.pow(Math.abs(Math.sin(Fe(l))),3);return Math.round(u*(ym.length-1))},s.getMapSessionAPI=tt,s.getPerformanceMeasurement=vn,s.getProjection=Fb,s.getRTLTextPluginStatus=ze,s.getReferrer=jn,s.getTilePoint=function(l,{x:o,y:u},f=0){return new ie(((o-f)*l.scale-l.x)*gi,(u*l.scale-l.y)*gi)},s.getTileVec3=function(l,o,u=0){return Nd(((o.x-u)*l.scale-l.x)*gi,(o.y*l.scale-l.y)*gi,Mx(o.z,o.y))},s.getVideo=function(l,o){const u=p.document.createElement("video");u.muted=!0,u.onloadstart=function(){o(null,u)};for(let f=0;f<l.length;f++){const m=p.document.createElement("source");io(l[f])||(u.crossOrigin="Anonymous"),m.src=l[f],u.appendChild(m)}return{cancel:()=>{}}},s.globeCenterToScreenPoint=function(l){const o=[0,0,0],u=lu(new Float64Array(16));return Vf(u,l.pixelMatrix,l.globeMatrix),Qs(o,o,u),new ie(o[0],o[1])},s.globeDenormalizeECEF=c0,s.globeECEFOrigin=function(l,o){const u=[0,0,0];return Qs(u,u,kg(ah(o.canonical))),Qs(u,u,l),u},s.globeMetersToEcef=Og,s.globeNormalizeECEF=kg,s.globePixelsToTileUnits=function(l,o){return gi/(512*Math.pow(2,l))*oy(ah(o))},s.globePoleMatrixForTile=function(l,o,u){const f=lu(new Float64Array(16)),m=(o/(1<<l)-.5)*Math.PI*2;return Mg(f,u.globeMatrix,m),Float32Array.from(f)},s.globeTileBounds=ah,s.globeTiltAtLngLat=Tx,s.globeToMercatorTransition=Em,s.globeUseCustomAntiAliasing=function(l,o,u){const f=Em(u.zoom),m=l.style.map._antialias,y=!!o.extStandardDerivatives,b=o.extStandardDerivativesForceOff||l.terrain&&l.terrain.exaggeration()>0;return f===0&&!m&&!b&&y},s.identity=lu,s.identity$1=Zh,s.invert=$_,s.isFullscreen=function(){return!!p.document.fullscreenElement||!!p.document.webkitFullscreenElement},s.isLngLatBehindGlobe=h0,s.isMapAuthenticated=function(l){return He.has(l)},s.isMapboxURL=ro,s.isSafariWithAntialiasingBug=function(l){const o=l.navigator?l.navigator.userAgent:null;return!!jr(l)&&o&&(o.match("Version/15.4")||o.match("Version/15.5")||o.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},s.latFromMercatorY=Ra,s.latLngToECEF=bm,s.len=cw,s.length=ku,s.length$1=function(l){return Math.hypot(l[0],l[1],l[2],l[3])},s.lngFromMercatorX=Bu,s.loadVectorTile=XS,s.makeRequest=ki,s.mapValue=function(l,o,u,f,m){return nt((l-o)/(u-o)*(m-f)+f,f,m)},s.mercatorScale=Lx,s.mercatorXfromLng=Jh,s.mercatorYfromLat=Qh,s.mercatorZfromAltitude=uh,s.mul=gx,s.mul$1=yx,s.multiply=Vf,s.multiply$1=t0,s.multiply$2=Pg,s.nextPowerOfTwo=ri,s.normalize=Ro,s.normalize$1=hw,s.normalize$2=vx,s.number=Mi,s.ortho=function(l,o,u,f,m,y,b){var T=1/(o-u),A=1/(f-m),L=1/(y-b);return l[0]=-2*T,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=-2*A,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=2*L,l[11]=0,l[12]=(o+u)*T,l[13]=(m+f)*A,l[14]=(b+y)*L,l[15]=1,l},s.pbf=zd,s.perspective=function(l,o,u,f,m){var y,b=1/Math.tan(o/2);return l[0]=b/u,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=b,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,m!=null&&m!==1/0?(l[10]=(m+f)*(y=1/(f-m)),l[14]=2*m*f*y):(l[10]=-1,l[14]=-2*f),l},s.pick=function(l,o){const u={};for(let f=0;f<o.length;f++){const m=o[f];m in l&&(u[m]=l[m])}return u},s.plugin=qe,s.pointGeometry=ie,s.polesInViewport=function(l){const o=lu(new Float64Array(16));Vf(o,l.pixelMatrix,l.globeMatrix);const u=[0,Fu,0],f=[0,xc,0];return Qs(u,u,o),Qs(f,f,o),[u[0]>0&&u[0]<=l.width&&u[1]>0&&u[1]<=l.height&&!h0(l,new Ir(l.center.lat,90)),f[0]>0&&f[0]<=l.width&&f[1]>0&&f[1]<=l.height&&!h0(l,new Ir(l.center.lat,-90))]},s.polygonContainsPoint=Fp,s.polygonIntersectsBox=kx,s.polygonIntersectsPolygon=Rx,s.polygonizeBounds=function(l,o,u=0,f=!0){const m=new ie(u,u),y=l.sub(m),b=o.add(m),T=[y,new ie(b.x,y.y),b,new ie(y.x,b.y)];return f&&T.push(y.clone()),T},s.posAttributes=Gf,s.postMapLoadEvent=ve,s.postPerformanceEvent=Be,s.postTurnstileEvent=Q,s.potpack=Ay,s.prevPowerOfTwo=function(l){return l<=1?1:Math.pow(2,Math.floor(Math.log(l)/Math.LN2))},s.radToDeg=Ne,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.registerForPluginStateChange=function(l){return l({pluginStatus:_e,pluginURL:re}),Se.on("pluginStateChange",l),l},s.removeAuthState=function(l){He.delete(l)},s.renderColorRamp=w0,s.resample=p0,s.rotateX=rh,s.rotateX$1=ml,s.rotateY=Mg,s.rotateY$1=ey,s.rotateZ=function(l,o,u){var f=Math.sin(u),m=Math.cos(u),y=o[0],b=o[1],T=o[2],A=o[3],L=o[4],F=o[5],U=o[6],j=o[7];return o!==l&&(l[8]=o[8],l[9]=o[9],l[10]=o[10],l[11]=o[11],l[12]=o[12],l[13]=o[13],l[14]=o[14],l[15]=o[15]),l[0]=y*m+L*f,l[1]=b*m+F*f,l[2]=T*m+U*f,l[3]=A*m+j*f,l[4]=L*m-y*f,l[5]=F*m-b*f,l[6]=U*m-T*f,l[7]=j*m-A*f,l},s.rotateZ$1=function(l,o,u){u*=.5;var f=o[0],m=o[1],y=o[2],b=o[3],T=Math.sin(u),A=Math.cos(u);return l[0]=f*A+m*T,l[1]=m*A-f*T,l[2]=y*A+b*T,l[3]=b*A-y*T,l},s.scale=Od,s.scale$1=r0,s.scale$2=pl,s.scaleAndAdd=Rp,s.set=function(l,o,u,f){return l[0]=o,l[1]=u,l[2]=f,l},s.setCacheLimits=function(l,o){Tn=l,fi=o},s.setColumn=function(l,o,u){l[4*o+0]=u[0],l[4*o+1]=u[1],l[4*o+2]=u[2],l[4*o+3]=u[3]},s.setRTLTextPlugin=function(l,o,u=!1){if(_e===ae||_e===pe||_e===de)throw new Error("setRTLTextPlugin cannot be called multiple times.");re=ar.resolveURL(l),_e=ae,me=o,Ee(),u||De()},s.smoothstep=zt,s.spec=wt,s.squaredLength=function(l){var o=l[0],u=l[1],f=l[2];return o*o+u*u+f*f},s.storeAuthState=function(l,o){o?He.add(l):He.delete(l)},s.sub=oh,s.subtract=Lg,s.symbolSize=lb,s.tileAABB=function(l,o,u,f,m,y,b,T,A){if(A.name==="globe")return Np(l,o,new Sy(u,f,m));const L=Up({z:u,x:f,y:m},A);return new gl([(y+L.x/L.scale)*o,o*(L.y/L.scale),b],[(y+L.x2/L.scale)*o,o*(L.y2/L.scale),T])},s.tileCornersToBounds=ry,s.tileTransform=Up,s.transformMat3=function(l,o,u){var f=o[0],m=o[1],y=o[2];return l[0]=f*u[0]+m*u[3]+y*u[6],l[1]=f*u[1]+m*u[4]+y*u[7],l[2]=f*u[2]+m*u[5]+y*u[8],l},s.transformMat4=Qs,s.transformMat4$1=Dp,s.transformQuat=tl,s.transitionTileAABBinECEF=u0,s.translate=Ag,s.transpose=function(l,o){if(l===o){var u=o[1],f=o[2],m=o[5];l[1]=o[3],l[2]=o[6],l[3]=u,l[5]=o[7],l[6]=f,l[7]=m}else l[0]=o[0],l[1]=o[3],l[2]=o[6],l[3]=o[1],l[4]=o[4],l[5]=o[7],l[6]=o[2],l[7]=o[5],l[8]=o[8];return l},s.triggerPluginCompletionEvent=Ie,s.uniqueId=sn,s.updateGlobeVertexNormal=function(l,o,u,f,m){const y=5*o+2;l.float32[y+0]=u,l.float32[y+1]=f,l.float32[y+2]=m},s.validateCustomStyleLayer=function(l){const o=[],u=l.id;return u===void 0&&o.push({message:`layers.${u}: missing required property "id"`}),l.render===void 0&&o.push({message:`layers.${u}: missing required method "render"`}),l.renderingMode&&l.renderingMode!=="2d"&&l.renderingMode!=="3d"&&o.push({message:`layers.${u}: property "renderingMode" must be either "2d" or "3d"`}),o},s.validateFilter=l=>Jc(Td(l)),s.validateFog=l=>Jc(Tp(l)),s.validateLayer=l=>Jc(yg(l)),s.validateLight=l=>Jc(he(l)),s.validateSource=l=>Jc(Kc(l)),s.validateStyle=O_,s.validateTerrain=l=>Jc(Gh(l)),s.values=Ze,s.vectorTile=by,s.version=x,s.warnOnce=Gn,s.window=p,s.wrap=Ot}),a(["./shared"],function(s){function p(xe){if(typeof xe=="number"||typeof xe=="boolean"||typeof xe=="string"||xe==null)return JSON.stringify(xe);if(Array.isArray(xe)){let ne="[";for(const ve of xe)ne+=`${p(ve)},`;return`${ne}]`}let Q="{";for(const ne of Object.keys(xe).sort())Q+=`${ne}:${p(xe[ne])},`;return`${Q}}`}function x(xe){let Q="";for(const ne of s.refProperties)Q+=`/${p(xe[ne])}`;return Q}class I{constructor(Q){this.keyCache={},Q&&this.replace(Q)}replace(Q){this._layerConfigs={},this._layers={},this.update(Q,[])}update(Q,ne){for(const Ce of Q)this._layerConfigs[Ce.id]=Ce,(this._layers[Ce.id]=s.createStyleLayer(Ce)).compileFilter(),this.keyCache[Ce.id]&&delete this.keyCache[Ce.id];for(const Ce of ne)delete this.keyCache[Ce],delete this._layerConfigs[Ce],delete this._layers[Ce];this.familiesBySource={};const ve=function(Ce,Be){const st={};for(let He=0;He<Ce.length;He++){const ue=Be&&Be[Ce[He].id]||x(Ce[He]);Be&&(Be[Ce[He].id]=ue);let Ye=st[ue];Ye||(Ye=st[ue]=[]),Ye.push(Ce[He])}const tt=[];for(const He in st)tt.push(st[He]);return tt}(s.values(this._layerConfigs),this.keyCache);for(const Ce of ve){const Be=Ce.map(ge=>this._layers[ge.id]),st=Be[0];if(st.visibility==="none")continue;const tt=st.source||"";let He=this.familiesBySource[tt];He||(He=this.familiesBySource[tt]={});const ue=st.sourceLayer||"_geojsonTileLayer";let Ye=He[ue];Ye||(Ye=He[ue]=[]),Ye.push(Be)}}}class C{loadTile(Q,ne){const{uid:ve,encoding:Ce,rawImageData:Be,padding:st,buildQuadTree:tt}=Q,He=s.window.ImageBitmap&&Be instanceof s.window.ImageBitmap?this.getImageData(Be,st):Be;ne(null,new s.DEMData(ve,He,Ce,st<1,tt))}getImageData(Q,ne){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Q.width,Q.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Q.width,this.offscreenCanvas.height=Q.height,this.offscreenCanvasContext.drawImage(Q,0,0,Q.width,Q.height);const ve=this.offscreenCanvasContext.getImageData(-ne,-ne,Q.width+2*ne,Q.height+2*ne);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ve}}var M=function xe(Q,ne){var ve,Ce=Q&&Q.type;if(Ce==="FeatureCollection")for(ve=0;ve<Q.features.length;ve++)xe(Q.features[ve],ne);else if(Ce==="GeometryCollection")for(ve=0;ve<Q.geometries.length;ve++)xe(Q.geometries[ve],ne);else if(Ce==="Feature")xe(Q.geometry,ne);else if(Ce==="Polygon")O(Q.coordinates,ne);else if(Ce==="MultiPolygon")for(ve=0;ve<Q.coordinates.length;ve++)O(Q.coordinates[ve],ne);return Q};function O(xe,Q){if(xe.length!==0){k(xe[0],Q);for(var ne=1;ne<xe.length;ne++)k(xe[ne],!Q)}}function k(xe,Q){for(var ne=0,ve=0,Ce=0,Be=xe.length,st=Be-1;Ce<Be;st=Ce++){var tt=(xe[Ce][0]-xe[st][0])*(xe[st][1]+xe[Ce][1]),He=ne+tt;ve+=Math.abs(ne)>=Math.abs(tt)?ne-He+tt:tt-He+ne,ne=He}ne+ve>=0!=!!Q&&xe.reverse()}const z=s.VectorTileFeature.prototype.toGeoJSON;class G{constructor(Q){this._feature=Q,this.extent=s.EXTENT,this.type=Q.type,this.properties=Q.tags,"id"in Q&&!isNaN(Q.id)&&(this.id=parseInt(Q.id,10))}loadGeometry(){if(this._feature.type===1){const Q=[];for(const ne of this._feature.geometry)Q.push([new s.pointGeometry(ne[0],ne[1])]);return Q}{const Q=[];for(const ne of this._feature.geometry){const ve=[];for(const Ce of ne)ve.push(new s.pointGeometry(Ce[0],Ce[1]));Q.push(ve)}return Q}}toGeoJSON(Q,ne,ve){return z.call(this,Q,ne,ve)}}class q{constructor(Q){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=Q.length,this._features=Q}feature(Q){return new G(this._features[Q])}}var Z={},K={get exports(){return Z},set exports(xe){Z=xe}},te=s.pointGeometry,ie=s.vectorTile.VectorTileFeature,Te=le;function le(xe,Q){this.options=Q||{},this.features=xe,this.length=xe.length}function fe(xe,Q){this.id=typeof xe.id=="number"?xe.id:void 0,this.type=xe.type,this.rawGeometry=xe.type===1?[xe.geometry]:xe.geometry,this.properties=xe.tags,this.extent=Q||4096}le.prototype.feature=function(xe){return new fe(this.features[xe],this.options.extent)},fe.prototype.loadGeometry=function(){var xe=this.rawGeometry;this.geometry=[];for(var Q=0;Q<xe.length;Q++){for(var ne=xe[Q],ve=[],Ce=0;Ce<ne.length;Ce++)ve.push(new te(ne[Ce][0],ne[Ce][1]));this.geometry.push(ve)}return this.geometry},fe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var xe=this.geometry,Q=1/0,ne=-1/0,ve=1/0,Ce=-1/0,Be=0;Be<xe.length;Be++)for(var st=xe[Be],tt=0;tt<st.length;tt++){var He=st[tt];Q=Math.min(Q,He.x),ne=Math.max(ne,He.x),ve=Math.min(ve,He.y),Ce=Math.max(Ce,He.y)}return[Q,ve,ne,Ce]},fe.prototype.toGeoJSON=ie.prototype.toGeoJSON;var Fe=s.pbf,Ne=Te;function Ue(xe){var Q=new Fe;return function(ne,ve){for(var Ce in ne.layers)ve.writeMessage(3,dt,ne.layers[Ce])}(xe,Q),Q.finish()}function dt(xe,Q){var ne;Q.writeVarintField(15,xe.version||1),Q.writeStringField(1,xe.name||""),Q.writeVarintField(5,xe.extent||4096);var ve={keys:[],values:[],keycache:{},valuecache:{}};for(ne=0;ne<xe.length;ne++)ve.feature=xe.feature(ne),Q.writeMessage(2,Ge,ve);var Ce=ve.keys;for(ne=0;ne<Ce.length;ne++)Q.writeStringField(3,Ce[ne]);var Be=ve.values;for(ne=0;ne<Be.length;ne++)Q.writeMessage(4,et,Be[ne])}function Ge(xe,Q){var ne=xe.feature;ne.id!==void 0&&Q.writeVarintField(1,ne.id),Q.writeMessage(2,Le,xe),Q.writeVarintField(3,ne.type),Q.writeMessage(4,Ot,ne)}function Le(xe,Q){var ne=xe.feature,ve=xe.keys,Ce=xe.values,Be=xe.keycache,st=xe.valuecache;for(var tt in ne.properties){var He=ne.properties[tt],ue=Be[tt];if(He!==null){ue===void 0&&(ve.push(tt),Be[tt]=ue=ve.length-1),Q.writeVarint(ue);var Ye=typeof He;Ye!=="string"&&Ye!=="boolean"&&Ye!=="number"&&(He=JSON.stringify(He));var ge=Ye+":"+He,It=st[ge];It===void 0&&(Ce.push(He),st[ge]=It=Ce.length-1),Q.writeVarint(It)}}}function nt(xe,Q){return(Q<<3)+(7&xe)}function zt(xe){return xe<<1^xe>>31}function Ot(xe,Q){for(var ne=xe.loadGeometry(),ve=xe.type,Ce=0,Be=0,st=ne.length,tt=0;tt<st;tt++){var He=ne[tt],ue=1;ve===1&&(ue=He.length),Q.writeVarint(nt(1,ue));for(var Ye=ve===3?He.length-1:He.length,ge=0;ge<Ye;ge++){ge===1&&ve!==1&&Q.writeVarint(nt(2,Ye-1));var It=He[ge].x-Ce,vn=He[ge].y-Be;Q.writeVarint(zt(It)),Q.writeVarint(zt(vn)),Ce+=It,Be+=vn}ve===3&&Q.writeVarint(nt(7,1))}}function et(xe,Q){var ne=typeof xe;ne==="string"?Q.writeStringField(1,xe):ne==="boolean"?Q.writeBooleanField(7,xe):ne==="number"&&(xe%1!=0?Q.writeDoubleField(3,xe):xe<0?Q.writeSVarintField(6,xe):Q.writeVarintField(5,xe))}function Ze(xe,Q,ne,ve,Ce,Be){if(Ce-ve<=ne)return;const st=ve+Ce>>1;At(xe,Q,st,ve,Ce,Be%2),Ze(xe,Q,ne,ve,st-1,Be+1),Ze(xe,Q,ne,st+1,Ce,Be+1)}function At(xe,Q,ne,ve,Ce,Be){for(;Ce>ve;){if(Ce-ve>600){const ue=Ce-ve+1,Ye=ne-ve+1,ge=Math.log(ue),It=.5*Math.exp(2*ge/3),vn=.5*Math.sqrt(ge*It*(ue-It)/ue)*(Ye-ue/2<0?-1:1);At(xe,Q,ne,Math.max(ve,Math.floor(ne-Ye*It/ue+vn)),Math.min(Ce,Math.floor(ne+(ue-Ye)*It/ue+vn)),Be)}const st=Q[2*ne+Be];let tt=ve,He=Ce;for(Kt(xe,Q,ve,ne),Q[2*Ce+Be]>st&&Kt(xe,Q,ve,Ce);tt<He;){for(Kt(xe,Q,tt,He),tt++,He--;Q[2*tt+Be]<st;)tt++;for(;Q[2*He+Be]>st;)He--}Q[2*ve+Be]===st?Kt(xe,Q,ve,He):(He++,Kt(xe,Q,He,Ce)),He<=ne&&(ve=He+1),ne<=He&&(Ce=He-1)}}function Kt(xe,Q,ne,ve){sn(xe,ne,ve),sn(Q,2*ne,2*ve),sn(Q,2*ne+1,2*ve+1)}function sn(xe,Q,ne){const ve=xe[Q];xe[Q]=xe[ne],xe[ne]=ve}function zn(xe,Q,ne,ve){const Ce=xe-ne,Be=Q-ve;return Ce*Ce+Be*Be}K.exports=Ue,Z.fromVectorTileJs=Ue,Z.fromGeojsonVt=function(xe,Q){Q=Q||{};var ne={};for(var ve in xe)ne[ve]=new Ne(xe[ve].features,Q),ne[ve].name=ve,ne[ve].version=Q.version,ne[ve].extent=Q.extent;return Ue({layers:ne})},Z.GeoJSONWrapper=Ne;const ri=xe=>xe[0],Yt=xe=>xe[1];class ii{constructor(Q,ne=ri,ve=Yt,Ce=64,Be=Float64Array){this.nodeSize=Ce,this.points=Q;const st=Q.length<65536?Uint16Array:Uint32Array,tt=this.ids=new st(Q.length),He=this.coords=new Be(2*Q.length);for(let ue=0;ue<Q.length;ue++)tt[ue]=ue,He[2*ue]=ne(Q[ue]),He[2*ue+1]=ve(Q[ue]);Ze(tt,He,Ce,0,tt.length-1,0)}range(Q,ne,ve,Ce){return function(Be,st,tt,He,ue,Ye,ge){const It=[0,Be.length-1,0],vn=[];let Wn,Vn;for(;It.length;){const je=It.pop(),Fn=It.pop(),ar=It.pop();if(Fn-ar<=ge){for(let nr=ar;nr<=Fn;nr++)Wn=st[2*nr],Vn=st[2*nr+1],Wn>=tt&&Wn<=ue&&Vn>=He&&Vn<=Ye&&vn.push(Be[nr]);continue}const ui=Math.floor((ar+Fn)/2);Wn=st[2*ui],Vn=st[2*ui+1],Wn>=tt&&Wn<=ue&&Vn>=He&&Vn<=Ye&&vn.push(Be[ui]);const Qi=(je+1)%2;(je===0?tt<=Wn:He<=Vn)&&(It.push(ar),It.push(ui-1),It.push(Qi)),(je===0?ue>=Wn:Ye>=Vn)&&(It.push(ui+1),It.push(Fn),It.push(Qi))}return vn}(this.ids,this.coords,Q,ne,ve,Ce,this.nodeSize)}within(Q,ne,ve){return function(Ce,Be,st,tt,He,ue){const Ye=[0,Ce.length-1,0],ge=[],It=He*He;for(;Ye.length;){const vn=Ye.pop(),Wn=Ye.pop(),Vn=Ye.pop();if(Wn-Vn<=ue){for(let Qi=Vn;Qi<=Wn;Qi++)zn(Be[2*Qi],Be[2*Qi+1],st,tt)<=It&&ge.push(Ce[Qi]);continue}const je=Math.floor((Vn+Wn)/2),Fn=Be[2*je],ar=Be[2*je+1];zn(Fn,ar,st,tt)<=It&&ge.push(Ce[je]);const ui=(vn+1)%2;(vn===0?st-He<=Fn:tt-He<=ar)&&(Ye.push(Vn),Ye.push(je-1),Ye.push(ui)),(vn===0?st+He>=Fn:tt+He>=ar)&&(Ye.push(je+1),Ye.push(Wn),Ye.push(ui))}return ge}(this.ids,this.coords,Q,ne,ve,this.nodeSize)}}const kn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:xe=>xe},on=Math.fround||(Di=new Float32Array(1),xe=>(Di[0]=+xe,Di[0]));var Di;class Ut{constructor(Q){this.options=jr(Object.create(kn),Q),this.trees=new Array(this.options.maxZoom+1)}load(Q){const{log:ne,minZoom:ve,maxZoom:Ce,nodeSize:Be}=this.options;ne&&console.time("total time");const st=`prepare ${Q.length} points`;ne&&console.time(st),this.points=Q;let tt=[];for(let He=0;He<Q.length;He++)Q[He].geometry&&tt.push(Gn(Q[He],He));this.trees[Ce+1]=new ii(tt,Yr,hi,Be,Float32Array),ne&&console.timeEnd(st);for(let He=Ce;He>=ve;He--){const ue=+Date.now();tt=this._cluster(tt,He),this.trees[He]=new ii(tt,Yr,hi,Be,Float32Array),ne&&console.log("z%d: %d clusters in %dms",He,tt.length,+Date.now()-ue)}return ne&&console.timeEnd("total time"),this}getClusters(Q,ne){let ve=((Q[0]+180)%360+360)%360-180;const Ce=Math.max(-90,Math.min(90,Q[1]));let Be=Q[2]===180?180:((Q[2]+180)%360+360)%360-180;const st=Math.max(-90,Math.min(90,Q[3]));if(Q[2]-Q[0]>=360)ve=-180,Be=180;else if(ve>Be){const Ye=this.getClusters([ve,Ce,180,st],ne),ge=this.getClusters([-180,Ce,Be,st],ne);return Ye.concat(ge)}const tt=this.trees[this._limitZoom(ne)],He=tt.range(Mt(ve),Un(st),Mt(Be),Un(Ce)),ue=[];for(const Ye of He){const ge=tt.points[Ye];ue.push(ge.numPoints?Ci(ge):this.points[ge.index])}return ue}getChildren(Q){const ne=this._getOriginId(Q),ve=this._getOriginZoom(Q),Ce="No cluster with the specified id.",Be=this.trees[ve];if(!Be)throw new Error(Ce);const st=Be.points[ne];if(!st)throw new Error(Ce);const tt=this.options.radius/(this.options.extent*Math.pow(2,ve-1)),He=Be.within(st.x,st.y,tt),ue=[];for(const Ye of He){const ge=Be.points[Ye];ge.parentId===Q&&ue.push(ge.numPoints?Ci(ge):this.points[ge.index])}if(ue.length===0)throw new Error(Ce);return ue}getLeaves(Q,ne,ve){const Ce=[];return this._appendLeaves(Ce,Q,ne=ne||10,ve=ve||0,0),Ce}getTile(Q,ne,ve){const Ce=this.trees[this._limitZoom(Q)],Be=Math.pow(2,Q),{extent:st,radius:tt}=this.options,He=tt/st,ue=(ve-He)/Be,Ye=(ve+1+He)/Be,ge={features:[]};return this._addTileFeatures(Ce.range((ne-He)/Be,ue,(ne+1+He)/Be,Ye),Ce.points,ne,ve,Be,ge),ne===0&&this._addTileFeatures(Ce.range(1-He/Be,ue,1,Ye),Ce.points,Be,ve,Be,ge),ne===Be-1&&this._addTileFeatures(Ce.range(0,ue,He/Be,Ye),Ce.points,-1,ve,Be,ge),ge.features.length?ge:null}getClusterExpansionZoom(Q){let ne=this._getOriginZoom(Q)-1;for(;ne<=this.options.maxZoom;){const ve=this.getChildren(Q);if(ne++,ve.length!==1)break;Q=ve[0].properties.cluster_id}return ne}_appendLeaves(Q,ne,ve,Ce,Be){const st=this.getChildren(ne);for(const tt of st){const He=tt.properties;if(He&&He.cluster?Be+He.point_count<=Ce?Be+=He.point_count:Be=this._appendLeaves(Q,He.cluster_id,ve,Ce,Be):Be<Ce?Be++:Q.push(tt),Q.length===ve)break}return Be}_addTileFeatures(Q,ne,ve,Ce,Be,st){for(const tt of Q){const He=ne[tt],ue=He.numPoints;let Ye,ge,It;if(ue)Ye=ln(He),ge=He.x,It=He.y;else{const Vn=this.points[He.index];Ye=Vn.properties,ge=Mt(Vn.geometry.coordinates[0]),It=Un(Vn.geometry.coordinates[1])}const vn={type:1,geometry:[[Math.round(this.options.extent*(ge*Be-ve)),Math.round(this.options.extent*(It*Be-Ce))]],tags:Ye};let Wn;ue?Wn=He.id:this.options.generateId?Wn=He.index:this.points[He.index].id&&(Wn=this.points[He.index].id),Wn!==void 0&&(vn.id=Wn),st.features.push(vn)}}_limitZoom(Q){return Math.max(this.options.minZoom,Math.min(Math.floor(+Q),this.options.maxZoom+1))}_cluster(Q,ne){const ve=[],{radius:Ce,extent:Be,reduce:st,minPoints:tt}=this.options,He=Ce/(Be*Math.pow(2,ne));for(let ue=0;ue<Q.length;ue++){const Ye=Q[ue];if(Ye.zoom<=ne)continue;Ye.zoom=ne;const ge=this.trees[ne+1],It=ge.within(Ye.x,Ye.y,He),vn=Ye.numPoints||1;let Wn=vn;for(const Vn of It){const je=ge.points[Vn];je.zoom>ne&&(Wn+=je.numPoints||1)}if(Wn>vn&&Wn>=tt){let Vn=Ye.x*vn,je=Ye.y*vn,Fn=st&&vn>1?this._map(Ye,!0):null;const ar=(ue<<5)+(ne+1)+this.points.length;for(const ui of It){const Qi=ge.points[ui];if(Qi.zoom<=ne)continue;Qi.zoom=ne;const nr=Qi.numPoints||1;Vn+=Qi.x*nr,je+=Qi.y*nr,Qi.parentId=ar,st&&(Fn||(Fn=this._map(Ye,!0)),st(Fn,this._map(Qi)))}Ye.parentId=ar,ve.push(Nt(Vn/Wn,je/Wn,ar,Wn,Fn))}else if(ve.push(Ye),Wn>1)for(const Vn of It){const je=ge.points[Vn];je.zoom<=ne||(je.zoom=ne,ve.push(je))}}return ve}_getOriginId(Q){return Q-this.points.length>>5}_getOriginZoom(Q){return(Q-this.points.length)%32}_map(Q,ne){if(Q.numPoints)return ne?jr({},Q.properties):Q.properties;const ve=this.points[Q.index].properties,Ce=this.options.map(ve);return ne&&Ce===ve?jr({},Ce):Ce}}function Nt(xe,Q,ne,ve,Ce){return{x:on(xe),y:on(Q),zoom:1/0,id:ne,parentId:-1,numPoints:ve,properties:Ce}}function Gn(xe,Q){const[ne,ve]=xe.geometry.coordinates;return{x:on(Mt(ne)),y:on(Un(ve)),zoom:1/0,index:Q,parentId:-1}}function Ci(xe){return{type:"Feature",id:xe.id,properties:ln(xe),geometry:{type:"Point",coordinates:[(Q=xe.x,360*(Q-.5)),ti(xe.y)]}};var Q}function ln(xe){const Q=xe.numPoints,ne=Q>=1e4?`${Math.round(Q/1e3)}k`:Q>=1e3?Math.round(Q/100)/10+"k":Q;return jr(jr({},xe.properties),{cluster:!0,cluster_id:xe.id,point_count:Q,point_count_abbreviated:ne})}function Mt(xe){return xe/360+.5}function Un(xe){const Q=Math.sin(xe*Math.PI/180),ne=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return ne<0?0:ne>1?1:ne}function ti(xe){const Q=(180-360*xe)*Math.PI/180;return 360*Math.atan(Math.exp(Q))/Math.PI-90}function jr(xe,Q){for(const ne in Q)xe[ne]=Q[ne];return xe}function Yr(xe){return xe.x}function hi(xe){return xe.y}function Hi(xe,Q,ne,ve){for(var Ce,Be=ve,st=ne-Q>>1,tt=ne-Q,He=xe[Q],ue=xe[Q+1],Ye=xe[ne],ge=xe[ne+1],It=Q+3;It<ne;It+=3){var vn=or(xe[It],xe[It+1],He,ue,Ye,ge);if(vn>Be)Ce=It,Be=vn;else if(vn===Be){var Wn=Math.abs(It-st);Wn<tt&&(Ce=It,tt=Wn)}}Be>ve&&(Ce-Q>3&&Hi(xe,Q,Ce,ve),xe[Ce+2]=Be,ne-Ce>3&&Hi(xe,Ce,ne,ve))}function or(xe,Q,ne,ve,Ce,Be){var st=Ce-ne,tt=Be-ve;if(st!==0||tt!==0){var He=((xe-ne)*st+(Q-ve)*tt)/(st*st+tt*tt);He>1?(ne=Ce,ve=Be):He>0&&(ne+=st*He,ve+=tt*He)}return(st=xe-ne)*st+(tt=Q-ve)*tt}function $e(xe,Q,ne,ve){var Ce={id:xe===void 0?null:xe,type:Q,geometry:ne,tags:ve,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Be){var st=Be.geometry,tt=Be.type;if(tt==="Point"||tt==="MultiPoint"||tt==="LineString")Tn(Be,st);else if(tt==="Polygon"||tt==="MultiLineString")for(var He=0;He<st.length;He++)Tn(Be,st[He]);else if(tt==="MultiPolygon")for(He=0;He<st.length;He++)for(var ue=0;ue<st[He].length;ue++)Tn(Be,st[He][ue])}(Ce),Ce}function Tn(xe,Q){for(var ne=0;ne<Q.length;ne+=3)xe.minX=Math.min(xe.minX,Q[ne]),xe.minY=Math.min(xe.minY,Q[ne+1]),xe.maxX=Math.max(xe.maxX,Q[ne]),xe.maxY=Math.max(xe.maxY,Q[ne+1])}function fi(xe,Q,ne,ve){if(Q.geometry){var Ce=Q.geometry.coordinates,Be=Q.geometry.type,st=Math.pow(ne.tolerance/((1<<ne.maxZoom)*ne.extent),2),tt=[],He=Q.id;if(ne.promoteId?He=Q.properties[ne.promoteId]:ne.generateId&&(He=ve||0),Be==="Point")Kn(Ce,tt);else if(Be==="MultiPoint")for(var ue=0;ue<Ce.length;ue++)Kn(Ce[ue],tt);else if(Be==="LineString")pn(Ce,tt,st,!1);else if(Be==="MultiLineString"){if(ne.lineMetrics){for(ue=0;ue<Ce.length;ue++)pn(Ce[ue],tt=[],st,!1),xe.push($e(He,"LineString",tt,Q.properties));return}vi(Ce,tt,st,!1)}else if(Be==="Polygon")vi(Ce,tt,st,!0);else{if(Be!=="MultiPolygon"){if(Be==="GeometryCollection"){for(ue=0;ue<Q.geometry.geometries.length;ue++)fi(xe,{id:He,geometry:Q.geometry.geometries[ue],properties:Q.properties},ne,ve);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ue=0;ue<Ce.length;ue++){var Ye=[];vi(Ce[ue],Ye,st,!0),tt.push(Ye)}}xe.push($e(He,Be,tt,Q.properties))}}function Kn(xe,Q){Q.push(Rs(xe[0])),Q.push(kt(xe[1])),Q.push(0)}function pn(xe,Q,ne,ve){for(var Ce,Be,st=0,tt=0;tt<xe.length;tt++){var He=Rs(xe[tt][0]),ue=kt(xe[tt][1]);Q.push(He),Q.push(ue),Q.push(0),tt>0&&(st+=ve?(Ce*ue-He*Be)/2:Math.sqrt(Math.pow(He-Ce,2)+Math.pow(ue-Be,2))),Ce=He,Be=ue}var Ye=Q.length-3;Q[2]=1,Hi(Q,0,Ye,ne),Q[Ye+2]=1,Q.size=Math.abs(st),Q.start=0,Q.end=Q.size}function vi(xe,Q,ne,ve){for(var Ce=0;Ce<xe.length;Ce++){var Be=[];pn(xe[Ce],Be,ne,ve),Q.push(Be)}}function Rs(xe){return xe/360+.5}function kt(xe){var Q=Math.sin(xe*Math.PI/180),ne=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return ne<0?0:ne>1?1:ne}function mn(xe,Q,ne,ve,Ce,Be,st,tt){if(ve/=Q,Be>=(ne/=Q)&&st<ve)return xe;if(st<ne||Be>=ve)return null;for(var He=[],ue=0;ue<xe.length;ue++){var Ye=xe[ue],ge=Ye.geometry,It=Ye.type,vn=Ce===0?Ye.minX:Ye.minY,Wn=Ce===0?Ye.maxX:Ye.maxY;if(vn>=ne&&Wn<ve)He.push(Ye);else if(!(Wn<ne||vn>=ve)){var Vn=[];if(It==="Point"||It==="MultiPoint")jn(ge,Vn,ne,ve,Ce);else if(It==="LineString")ki(ge,Vn,ne,ve,Ce,!1,tt.lineMetrics);else if(It==="MultiLineString")io(ge,Vn,ne,ve,Ce,!1);else if(It==="Polygon")io(ge,Vn,ne,ve,Ce,!0);else if(It==="MultiPolygon")for(var je=0;je<ge.length;je++){var Fn=[];io(ge[je],Fn,ne,ve,Ce,!0),Fn.length&&Vn.push(Fn)}if(Vn.length){if(tt.lineMetrics&&It==="LineString"){for(je=0;je<Vn.length;je++)He.push($e(Ye.id,It,Vn[je],Ye.tags));continue}It!=="LineString"&&It!=="MultiLineString"||(Vn.length===1?(It="LineString",Vn=Vn[0]):It="MultiLineString"),It!=="Point"&&It!=="MultiPoint"||(It=Vn.length===3?"Point":"MultiPoint"),He.push($e(Ye.id,It,Vn,Ye.tags))}}}return He.length?He:null}function jn(xe,Q,ne,ve,Ce){for(var Be=0;Be<xe.length;Be+=3){var st=xe[Be+Ce];st>=ne&&st<=ve&&(Q.push(xe[Be]),Q.push(xe[Be+1]),Q.push(xe[Be+2]))}}function ki(xe,Q,ne,ve,Ce,Be,st){for(var tt,He,ue=Ds(xe),Ye=Ce===0?Vo:Os,ge=xe.start,It=0;It<xe.length-3;It+=3){var vn=xe[It],Wn=xe[It+1],Vn=xe[It+2],je=xe[It+3],Fn=xe[It+4],ar=Ce===0?vn:Wn,ui=Ce===0?je:Fn,Qi=!1;st&&(tt=Math.sqrt(Math.pow(vn-je,2)+Math.pow(Wn-Fn,2))),ar<ne?ui>ne&&(He=Ye(ue,vn,Wn,je,Fn,ne),st&&(ue.start=ge+tt*He)):ar>ve?ui<ve&&(He=Ye(ue,vn,Wn,je,Fn,ve),st&&(ue.start=ge+tt*He)):oa(ue,vn,Wn,Vn),ui<ne&&ar>=ne&&(He=Ye(ue,vn,Wn,je,Fn,ne),Qi=!0),ui>ve&&ar<=ve&&(He=Ye(ue,vn,Wn,je,Fn,ve),Qi=!0),!Be&&Qi&&(st&&(ue.end=ge+tt*He),Q.push(ue),ue=Ds(xe)),st&&(ge+=tt)}var nr=xe.length-3;vn=xe[nr],Wn=xe[nr+1],Vn=xe[nr+2],(ar=Ce===0?vn:Wn)>=ne&&ar<=ve&&oa(ue,vn,Wn,Vn),nr=ue.length-3,Be&&nr>=3&&(ue[nr]!==ue[0]||ue[nr+1]!==ue[1])&&oa(ue,ue[0],ue[1],ue[2]),ue.length&&Q.push(ue)}function Ds(xe){var Q=[];return Q.size=xe.size,Q.start=xe.start,Q.end=xe.end,Q}function io(xe,Q,ne,ve,Ce,Be){for(var st=0;st<xe.length;st++)ki(xe[st],Q,ne,ve,Ce,Be,!1)}function oa(xe,Q,ne,ve){xe.push(Q),xe.push(ne),xe.push(ve)}function Vo(xe,Q,ne,ve,Ce,Be){var st=(Be-Q)/(ve-Q);return xe.push(Be),xe.push(ne+(Ce-ne)*st),xe.push(1),st}function Os(xe,Q,ne,ve,Ce,Be){var st=(Be-ne)/(Ce-ne);return xe.push(Q+(ve-Q)*st),xe.push(Be),xe.push(1),st}function Mo(xe,Q){for(var ne=[],ve=0;ve<xe.length;ve++){var Ce,Be=xe[ve],st=Be.type;if(st==="Point"||st==="MultiPoint"||st==="LineString")Ce=qa(Be.geometry,Q);else if(st==="MultiLineString"||st==="Polygon"){Ce=[];for(var tt=0;tt<Be.geometry.length;tt++)Ce.push(qa(Be.geometry[tt],Q))}else if(st==="MultiPolygon")for(Ce=[],tt=0;tt<Be.geometry.length;tt++){for(var He=[],ue=0;ue<Be.geometry[tt].length;ue++)He.push(qa(Be.geometry[tt][ue],Q));Ce.push(He)}ne.push($e(Be.id,st,Ce,Be.tags))}return ne}function qa(xe,Q){var ne=[];ne.size=xe.size,xe.start!==void 0&&(ne.start=xe.start,ne.end=xe.end);for(var ve=0;ve<xe.length;ve+=3)ne.push(xe[ve]+Q,xe[ve+1],xe[ve+2]);return ne}function ro(xe,Q){if(xe.transformed)return xe;var ne,ve,Ce,Be=1<<xe.z,st=xe.x,tt=xe.y;for(ne=0;ne<xe.features.length;ne++){var He=xe.features[ne],ue=He.geometry,Ye=He.type;if(He.geometry=[],Ye===1)for(ve=0;ve<ue.length;ve+=2)He.geometry.push(Ia(ue[ve],ue[ve+1],Q,Be,st,tt));else for(ve=0;ve<ue.length;ve++){var ge=[];for(Ce=0;Ce<ue[ve].length;Ce+=2)ge.push(Ia(ue[ve][Ce],ue[ve][Ce+1],Q,Be,st,tt));He.geometry.push(ge)}}return xe.transformed=!0,xe}function Ia(xe,Q,ne,ve,Ce,Be){return[Math.round(ne*(xe*ve-Ce)),Math.round(ne*(Q*ve-Be))]}function Rl(xe,Q,ne,ve,Ce){for(var Be=Q===Ce.maxZoom?0:Ce.tolerance/((1<<Q)*Ce.extent),st={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ne,y:ve,z:Q,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},tt=0;tt<xe.length;tt++){st.numFeatures++,Ha(st,xe[tt],Be,Ce);var He=xe[tt].minX,ue=xe[tt].minY,Ye=xe[tt].maxX,ge=xe[tt].maxY;He<st.minX&&(st.minX=He),ue<st.minY&&(st.minY=ue),Ye>st.maxX&&(st.maxX=Ye),ge>st.maxY&&(st.maxY=ge)}return st}function Ha(xe,Q,ne,ve){var Ce=Q.geometry,Be=Q.type,st=[];if(Be==="Point"||Be==="MultiPoint")for(var tt=0;tt<Ce.length;tt+=3)st.push(Ce[tt]),st.push(Ce[tt+1]),xe.numPoints++,xe.numSimplified++;else if(Be==="LineString")aa(st,Ce,xe,ne,!1,!1);else if(Be==="MultiLineString"||Be==="Polygon")for(tt=0;tt<Ce.length;tt++)aa(st,Ce[tt],xe,ne,Be==="Polygon",tt===0);else if(Be==="MultiPolygon")for(var He=0;He<Ce.length;He++){var ue=Ce[He];for(tt=0;tt<ue.length;tt++)aa(st,ue[tt],xe,ne,!0,tt===0)}if(st.length){var Ye=Q.tags||null;if(Be==="LineString"&&ve.lineMetrics){for(var ge in Ye={},Q.tags)Ye[ge]=Q.tags[ge];Ye.mapbox_clip_start=Ce.start/Ce.size,Ye.mapbox_clip_end=Ce.end/Ce.size}var It={geometry:st,type:Be==="Polygon"||Be==="MultiPolygon"?3:Be==="LineString"||Be==="MultiLineString"?2:1,tags:Ye};Q.id!==null&&(It.id=Q.id),xe.features.push(It)}}function aa(xe,Q,ne,ve,Ce,Be){var st=ve*ve;if(ve>0&&Q.size<(Ce?st:ve))ne.numPoints+=Q.length/3;else{for(var tt=[],He=0;He<Q.length;He+=3)(ve===0||Q[He+2]>st)&&(ne.numSimplified++,tt.push(Q[He]),tt.push(Q[He+1])),ne.numPoints++;Ce&&function(ue,Ye){for(var ge=0,It=0,vn=ue.length,Wn=vn-2;It<vn;Wn=It,It+=2)ge+=(ue[It]-ue[Wn])*(ue[It+1]+ue[Wn+1]);if(ge>0===Ye)for(It=0,vn=ue.length;It<vn/2;It+=2){var Vn=ue[It],je=ue[It+1];ue[It]=ue[vn-2-It],ue[It+1]=ue[vn-1-It],ue[vn-2-It]=Vn,ue[vn-1-It]=je}}(tt,Be),xe.push(tt)}}function Wa(xe,Q){var ne=(Q=this.options=function(Ce,Be){for(var st in Be)Ce[st]=Be[st];return Ce}(Object.create(this.options),Q)).debug;if(ne&&console.time("preprocess data"),Q.maxZoom<0||Q.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Q.promoteId&&Q.generateId)throw new Error("promoteId and generateId cannot be used together.");var ve=function(Ce,Be){var st=[];if(Ce.type==="FeatureCollection")for(var tt=0;tt<Ce.features.length;tt++)fi(st,Ce.features[tt],Be,tt);else fi(st,Ce.type==="Feature"?Ce:{geometry:Ce},Be);return st}(xe,Q);this.tiles={},this.tileCoords=[],ne&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Q.indexMaxZoom,Q.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ve=function(Ce,Be){var st=Be.buffer/Be.extent,tt=Ce,He=mn(Ce,1,-1-st,st,0,-1,2,Be),ue=mn(Ce,1,1-st,2+st,0,-1,2,Be);return(He||ue)&&(tt=mn(Ce,1,-st,1+st,0,-1,2,Be)||[],He&&(tt=Mo(He,1).concat(tt)),ue&&(tt=tt.concat(Mo(ue,-1)))),tt}(ve,Q),ve.length&&this.splitTile(ve,0,0,0),ne&&(ve.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Bs(xe,Q,ne){return 32*((1<<xe)*ne+Q)+xe}function Ta(xe,Q){const ne=xe.tileID.canonical;if(!this._geoJSONIndex)return Q(null,null);const ve=this._geoJSONIndex.getTile(ne.z,ne.x,ne.y);if(!ve)return Q(null,null);const Ce=new q(ve.features);let Be=Z(Ce);Be.byteOffset===0&&Be.byteLength===Be.buffer.byteLength||(Be=new Uint8Array(Be)),Q(null,{vectorTile:Ce,rawData:Be.buffer})}Wa.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Wa.prototype.splitTile=function(xe,Q,ne,ve,Ce,Be,st){for(var tt=[xe,Q,ne,ve],He=this.options,ue=He.debug;tt.length;){ve=tt.pop(),ne=tt.pop(),Q=tt.pop(),xe=tt.pop();var Ye=1<<Q,ge=Bs(Q,ne,ve),It=this.tiles[ge];if(!It&&(ue>1&&console.time("creation"),It=this.tiles[ge]=Rl(xe,Q,ne,ve,He),this.tileCoords.push({z:Q,x:ne,y:ve}),ue)){ue>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Q,ne,ve,It.numFeatures,It.numPoints,It.numSimplified),console.timeEnd("creation"));var vn="z"+Q;this.stats[vn]=(this.stats[vn]||0)+1,this.total++}if(It.source=xe,Ce){if(Q===He.maxZoom||Q===Ce)continue;var Wn=1<<Ce-Q;if(ne!==Math.floor(Be/Wn)||ve!==Math.floor(st/Wn))continue}else if(Q===He.indexMaxZoom||It.numPoints<=He.indexMaxPoints)continue;if(It.source=null,xe.length!==0){ue>1&&console.time("clipping");var Vn,je,Fn,ar,ui,Qi,nr=.5*He.buffer/He.extent,Dl=.5-nr,la=.5+nr,wt=1+nr;Vn=je=Fn=ar=null,ui=mn(xe,Ye,ne-nr,ne+la,0,It.minX,It.maxX,He),Qi=mn(xe,Ye,ne+Dl,ne+wt,0,It.minX,It.maxX,He),xe=null,ui&&(Vn=mn(ui,Ye,ve-nr,ve+la,1,It.minY,It.maxY,He),je=mn(ui,Ye,ve+Dl,ve+wt,1,It.minY,It.maxY,He),ui=null),Qi&&(Fn=mn(Qi,Ye,ve-nr,ve+la,1,It.minY,It.maxY,He),ar=mn(Qi,Ye,ve+Dl,ve+wt,1,It.minY,It.maxY,He),Qi=null),ue>1&&console.timeEnd("clipping"),tt.push(Vn||[],Q+1,2*ne,2*ve),tt.push(je||[],Q+1,2*ne,2*ve+1),tt.push(Fn||[],Q+1,2*ne+1,2*ve),tt.push(ar||[],Q+1,2*ne+1,2*ve+1)}}},Wa.prototype.getTile=function(xe,Q,ne){var ve=this.options,Ce=ve.extent,Be=ve.debug;if(xe<0||xe>24)return null;var st=1<<xe,tt=Bs(xe,Q=(Q%st+st)%st,ne);if(this.tiles[tt])return ro(this.tiles[tt],Ce);Be>1&&console.log("drilling down to z%d-%d-%d",xe,Q,ne);for(var He,ue=xe,Ye=Q,ge=ne;!He&&ue>0;)ue--,Ye=Math.floor(Ye/2),ge=Math.floor(ge/2),He=this.tiles[Bs(ue,Ye,ge)];return He&&He.source?(Be>1&&console.log("found parent tile z%d-%d-%d",ue,Ye,ge),Be>1&&console.time("drilling down"),this.splitTile(He.source,ue,Ye,ge,xe,Q,ne),Be>1&&console.timeEnd("drilling down"),this.tiles[tt]?ro(this.tiles[tt],Ce):null):null};class Zs extends s.VectorTileWorkerSource{constructor(Q,ne,ve,Ce,Be){super(Q,ne,ve,Ce,Ta),Be&&(this.loadGeoJSON=Be)}loadData(Q,ne){const ve=Q&&Q.request,Ce=ve&&ve.collectResourceTiming;this.loadGeoJSON(Q,(Be,st)=>{if(Be||!st)return ne(Be);if(typeof st!="object")return ne(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`));{M(st,!0);try{if(Q.filter){const He=s.createExpression(Q.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(He.result==="error")throw new Error(He.value.map(Ye=>`${Ye.key}: ${Ye.message}`).join(", "));st={type:"FeatureCollection",features:st.features.filter(Ye=>He.value.evaluate({zoom:0},Ye))}}this._geoJSONIndex=Q.cluster?new Ut(function({superclusterOptions:He,clusterProperties:ue}){if(!ue||!He)return He;const Ye={},ge={},It={accumulated:null,zoom:0},vn={properties:null},Wn=Object.keys(ue);for(const Vn of Wn){const[je,Fn]=ue[Vn],ar=s.createExpression(Fn),ui=s.createExpression(typeof je=="string"?[je,["accumulated"],["get",Vn]]:je);Ye[Vn]=ar.value,ge[Vn]=ui.value}return He.map=Vn=>{vn.properties=Vn;const je={};for(const Fn of Wn)je[Fn]=Ye[Fn].evaluate(It,vn);return je},He.reduce=(Vn,je)=>{vn.properties=je;for(const Fn of Wn)It.accumulated=Vn[Fn],Vn[Fn]=ge[Fn].evaluate(It,vn)},He}(Q)).load(st.features):function(He,ue){return new Wa(He,ue)}(st,Q.geojsonVtOptions)}catch(He){return ne(He)}this.loaded={};const tt={};if(Ce){const He=s.getPerformanceMeasurement(ve);He&&(tt.resourceTiming={},tt.resourceTiming[Q.source]=JSON.parse(JSON.stringify(He)))}ne(null,tt)}})}reloadTile(Q,ne){const ve=this.loaded;return ve&&ve[Q.uid]?super.reloadTile(Q,ne):this.loadTile(Q,ne)}loadGeoJSON(Q,ne){if(Q.request)s.getJSON(Q.request,ne);else{if(typeof Q.data!="string")return ne(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`));try{return ne(null,JSON.parse(Q.data))}catch{return ne(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Q,ne){try{ne(null,this._geoJSONIndex.getClusterExpansionZoom(Q.clusterId))}catch(ve){ne(ve)}}getClusterChildren(Q,ne){try{ne(null,this._geoJSONIndex.getChildren(Q.clusterId))}catch(ve){ne(ve)}}getClusterLeaves(Q,ne){try{ne(null,this._geoJSONIndex.getLeaves(Q.clusterId,Q.limit,Q.offset))}catch(ve){ne(ve)}}}class Sa{constructor(Q){this.self=Q,this.actor=new s.Actor(Q,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=s.getProjection({name:"mercator"}),this.workerSourceTypes={vector:s.VectorTileWorkerSource,geojson:Zs},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ne,ve)=>{if(this.workerSourceTypes[ne])throw new Error(`Worker source with name "${ne}" already registered.`);this.workerSourceTypes[ne]=ve},this.self.registerRTLTextPlugin=ne=>{if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=ne.applyArabicShaping,s.plugin.processBidirectionalText=ne.processBidirectionalText,s.plugin.processStyledBidirectionalText=ne.processStyledBidirectionalText}}clearCaches(Q,ne,ve){delete this.layerIndexes[Q],delete this.availableImages[Q],delete this.workerSources[Q],delete this.demWorkerSources[Q],ve()}checkIfReady(Q,ne,ve){ve()}setReferrer(Q,ne){this.referrer=ne}spriteLoaded(Q,ne){this.isSpriteLoaded[Q]=ne;for(const ve in this.workerSources[Q]){const Ce=this.workerSources[Q][ve];for(const Be in Ce)Ce[Be]instanceof s.VectorTileWorkerSource&&(Ce[Be].isSpriteLoaded=ne,Ce[Be].fire(new s.Event("isSpriteLoaded")))}}setImages(Q,ne,ve){this.availableImages[Q]=ne;for(const Ce in this.workerSources[Q]){const Be=this.workerSources[Q][Ce];for(const st in Be)Be[st].availableImages=ne}ve()}enableTerrain(Q,ne,ve){this.terrain=ne,ve()}setProjection(Q,ne){this.projections[Q]=s.getProjection(ne)}setLayers(Q,ne,ve){this.getLayerIndex(Q).replace(ne),ve()}updateLayers(Q,ne,ve){this.getLayerIndex(Q).update(ne.layers,ne.removedIds),ve()}loadTile(Q,ne,ve){const Ce=this.enableTerrain?s.extend({enableTerrain:this.terrain},ne):ne;Ce.projection=this.projections[Q]||this.defaultProjection,this.getWorkerSource(Q,ne.type,ne.source).loadTile(Ce,ve)}loadDEMTile(Q,ne,ve){const Ce=this.enableTerrain?s.extend({buildQuadTree:this.terrain},ne):ne;this.getDEMWorkerSource(Q,ne.source).loadTile(Ce,ve)}reloadTile(Q,ne,ve){const Ce=this.enableTerrain?s.extend({enableTerrain:this.terrain},ne):ne;Ce.projection=this.projections[Q]||this.defaultProjection,this.getWorkerSource(Q,ne.type,ne.source).reloadTile(Ce,ve)}abortTile(Q,ne,ve){this.getWorkerSource(Q,ne.type,ne.source).abortTile(ne,ve)}removeTile(Q,ne,ve){this.getWorkerSource(Q,ne.type,ne.source).removeTile(ne,ve)}removeSource(Q,ne,ve){if(!this.workerSources[Q]||!this.workerSources[Q][ne.type]||!this.workerSources[Q][ne.type][ne.source])return;const Ce=this.workerSources[Q][ne.type][ne.source];delete this.workerSources[Q][ne.type][ne.source],Ce.removeSource!==void 0?Ce.removeSource(ne,ve):ve()}loadWorkerSource(Q,ne,ve){try{this.self.importScripts(ne.url),ve()}catch(Ce){ve(Ce.toString())}}syncRTLPluginState(Q,ne,ve){try{s.plugin.setState(ne);const Ce=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&Ce!=null){this.self.importScripts(Ce);const Be=s.plugin.isParsed();ve(Be?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ce}`),Be)}}catch(Ce){ve(Ce.toString())}}getAvailableImages(Q){let ne=this.availableImages[Q];return ne||(ne=[]),ne}getLayerIndex(Q){let ne=this.layerIndexes[Q];return ne||(ne=this.layerIndexes[Q]=new I),ne}getWorkerSource(Q,ne,ve){if(this.workerSources[Q]||(this.workerSources[Q]={}),this.workerSources[Q][ne]||(this.workerSources[Q][ne]={}),!this.workerSources[Q][ne][ve]){const Ce={send:(Be,st,tt,He,ue,Ye)=>{this.actor.send(Be,st,tt,Q,ue,Ye)},scheduler:this.actor.scheduler};this.workerSources[Q][ne][ve]=new this.workerSourceTypes[ne](Ce,this.getLayerIndex(Q),this.getAvailableImages(Q),this.isSpriteLoaded[Q])}return this.workerSources[Q][ne][ve]}getDEMWorkerSource(Q,ne){return this.demWorkerSources[Q]||(this.demWorkerSources[Q]={}),this.demWorkerSources[Q][ne]||(this.demWorkerSources[Q][ne]=new C),this.demWorkerSources[Q][ne]}enforceCacheSizeLimit(Q,ne){s.enforceCacheSizeLimit(ne)}getWorkerPerformanceMetrics(Q,ne,ve){ve(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Sa(self)),Sa}),a(["./shared"],function(s){function p(_,c){if(Array.isArray(_)){if(!Array.isArray(c)||_.length!==c.length)return!1;for(let d=0;d<_.length;d++)if(!p(_[d],c[d]))return!1;return!0}if(typeof _=="object"&&_!==null&&c!==null){if(typeof c!="object"||Object.keys(_).length!==Object.keys(c).length)return!1;for(const d in _)if(!p(_[d],c[d]))return!1;return!0}return _===c}var x=I;function I(_){return!function(c){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var v,w,S=new Blob([""],{type:"text/javascript"}),P=URL.createObjectURL(S);try{w=new Worker(P),v=!0}catch{v=!1}return w&&w.terminate(),URL.revokeObjectURL(P),v}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var v=document.createElement("canvas");v.width=v.height=1;var w=v.getContext("2d");if(!w)return!1;var S=w.getImageData(0,0,1,1);return S&&S.width===v.width}()?(C[d=c&&c.failIfMajorPerformanceCaveat]===void 0&&(C[d]=function(v){var w,S=function(P){var N=document.createElement("canvas"),B=Object.create(I.webGLContextAttributes);return B.failIfMajorPerformanceCaveat=P,N.getContext("webgl",B)||N.getContext("experimental-webgl",B)}(v);if(!S)return!1;try{w=S.createShader(S.VERTEX_SHADER)}catch{return!1}return!(!w||S.isContextLost())&&(S.shaderSource(w,"void main() {}"),S.compileShader(w),S.getShaderParameter(w,S.COMPILE_STATUS)===!0)}(d)),C[d]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var d}(_)}var C={};function M(_,c,d){const v=s.window.document.createElement(_);return c!==void 0&&(v.className=c),d&&d.appendChild(v),v}function O(_,c,d){const v=s.window.document.createElementNS("http://www.w3.org/2000/svg",_);for(const w of Object.keys(c))v.setAttributeNS(null,w,c[w]);return d&&d.appendChild(v),v}I.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const k=s.window.document&&s.window.document.documentElement.style,z=k&&k.userSelect!==void 0?"userSelect":"WebkitUserSelect";let G;function q(){k&&z&&(G=k[z],k[z]="none")}function Z(){k&&z&&(k[z]=G)}function K(_){_.preventDefault(),_.stopPropagation(),s.window.removeEventListener("click",K,!0)}function te(){s.window.addEventListener("click",K,!0),s.window.setTimeout(()=>{s.window.removeEventListener("click",K,!0)},0)}function ie(_,c){const d=_.getBoundingClientRect();return fe(_,d,c)}function Te(_,c){const d=_.getBoundingClientRect(),v=[];for(let w=0;w<c.length;w++)v.push(fe(_,d,c[w]));return v}function le(_){return s.window.InstallTrigger!==void 0&&_.button===2&&_.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:_.button}function fe(_,c,d){const v=_.offsetWidth===c.width?1:_.offsetWidth/c.width;return new s.pointGeometry((d.clientX-c.left)*v,(d.clientY-c.top)*v)}function Fe(_,c){var d=c[0],v=c[1],w=c[2],S=c[3],P=d*S-w*v;return P?(_[0]=S*(P=1/P),_[1]=-v*P,_[2]=-w*P,_[3]=d*P,_):null}function Ne(_){const{userImage:c}=_;return!!(c&&c.render&&c.render())&&(_.data.replace(new Uint8Array(c.data.buffer)),!0)}class Ue extends s.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(c){if(this.loaded!==c&&(this.loaded=c,c)){for(const{ids:d,callback:v}of this.requestors)this._notify(d,v);this.requestors=[]}}hasImage(c){return!!this.getImage(c)}getImage(c){return this.images[c]}addImage(c,d){this._validate(c,d)&&(this.images[c]=d)}_validate(c,d){let v=!0;return this._validateStretch(d.stretchX,d.data&&d.data.width)||(this.fire(new s.ErrorEvent(new Error(`Image "${c}" has invalid "stretchX" value`))),v=!1),this._validateStretch(d.stretchY,d.data&&d.data.height)||(this.fire(new s.ErrorEvent(new Error(`Image "${c}" has invalid "stretchY" value`))),v=!1),this._validateContent(d.content,d)||(this.fire(new s.ErrorEvent(new Error(`Image "${c}" has invalid "content" value`))),v=!1),v}_validateStretch(c,d){if(!c)return!0;let v=0;for(const w of c){if(w[0]<v||w[1]<w[0]||d<w[1])return!1;v=w[1]}return!0}_validateContent(c,d){return!(c&&(c.length!==4||c[0]<0||d.data.width<c[0]||c[1]<0||d.data.height<c[1]||c[2]<0||d.data.width<c[2]||c[3]<0||d.data.height<c[3]||c[2]<c[0]||c[3]<c[1]))}updateImage(c,d){d.version=this.images[c].version+1,this.images[c]=d,this.updatedImages[c]=!0}removeImage(c){const d=this.images[c];delete this.images[c],delete this.patterns[c],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(c,d){let v=!0;if(!this.isLoaded())for(const w of c)this.images[w]||(v=!1);this.isLoaded()||v?this._notify(c,d):this.requestors.push({ids:c,callback:d})}_notify(c,d){const v={};for(const w of c){this.images[w]||this.fire(new s.Event("styleimagemissing",{id:w}));const S=this.images[w];S?v[w]={data:S.data.clone(),pixelRatio:S.pixelRatio,sdf:S.sdf,version:S.version,stretchX:S.stretchX,stretchY:S.stretchY,content:S.content,hasRenderCallback:!!(S.userImage&&S.userImage.render)}:s.warnOnce(`Image "${w}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}d(null,v)}getPixelSize(){const{width:c,height:d}=this.atlasImage;return{width:c,height:d}}getPattern(c){const d=this.patterns[c],v=this.getImage(c);if(!v)return null;if(d&&d.position.version===v.version)return d.position;if(d)d.position.version=v.version;else{const w={w:v.data.width+2,h:v.data.height+2,x:0,y:0},S=new s.ImagePosition(w,v);this.patterns[c]={bin:w,position:S}}return this._updatePatternAtlas(),this.patterns[c].position}bind(c){const d=c.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(c,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(){const c=[];for(const S in this.patterns)c.push(this.patterns[S].bin);const{w:d,h:v}=s.potpack(c),w=this.atlasImage;w.resize({width:d||1,height:v||1});for(const S in this.patterns){const{bin:P}=this.patterns[S],N=P.x+1,B=P.y+1,H=this.images[S].data,W=H.width,$=H.height;s.RGBAImage.copy(H,w,{x:0,y:0},{x:N,y:B},{width:W,height:$}),s.RGBAImage.copy(H,w,{x:0,y:$-1},{x:N,y:B-1},{width:W,height:1}),s.RGBAImage.copy(H,w,{x:0,y:0},{x:N,y:B+$},{width:W,height:1}),s.RGBAImage.copy(H,w,{x:W-1,y:0},{x:N-1,y:B},{width:1,height:$}),s.RGBAImage.copy(H,w,{x:0,y:0},{x:N+W,y:B},{width:1,height:$})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(c){for(const d of c){if(this.callbackDispatchedThisFrame[d])continue;this.callbackDispatchedThisFrame[d]=!0;const v=this.images[d];Ne(v)&&this.updateImage(d,v)}}}const dt=new s.Properties({anchor:new s.DataConstantProperty(s.spec.light.anchor),position:new class{constructor(){this.specification=s.spec.light.position}possiblyEvaluate(_,c){return function([d,v,w]){const S=s.degToRad(v+90),P=s.degToRad(w);return{x:d*Math.cos(S)*Math.sin(P),y:d*Math.sin(S)*Math.sin(P),z:d*Math.cos(P),azimuthal:v,polar:w}}(_.expression.evaluate(c))}interpolate(_,c,d){return{x:s.number(_.x,c.x,d),y:s.number(_.y,c.y,d),z:s.number(_.z,c.z,d),azimuthal:s.number(_.azimuthal,c.azimuthal,d),polar:s.number(_.polar,c.polar,d)}}},color:new s.DataConstantProperty(s.spec.light.color),intensity:new s.DataConstantProperty(s.spec.light.intensity)}),Ge="-transition";class Le extends s.Evented{constructor(c){super(),this._transitionable=new s.Transitionable(dt),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(c,d={}){if(!this._validate(s.validateLight,c,d))for(const v in c){const w=c[v];s.endsWith(v,Ge)?this._transitionable.setTransition(v.slice(0,-Ge.length),w):this._transitionable.setValue(v,w)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,d,v){return(!v||v.validate!==!1)&&s.emitValidationErrors(this,c.call(s.validateStyle,s.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}const nt=new s.Properties({source:new s.DataConstantProperty(s.spec.terrain.source),exaggeration:new s.DataConstantProperty(s.spec.terrain.exaggeration)}),zt="-transition";class Ot extends s.Evented{constructor(c,d){super(),this._transitionable=new s.Transitionable(nt),this.set(c),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=d}get(){return this._transitionable.serialize()}set(c){for(const d in c){const v=c[d];s.endsWith(d,zt)?this._transitionable.setTransition(d.slice(0,-zt.length),v):this._transitionable.setValue(d,v)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}}function et(_,c,d,v){const w=s.smoothstep(45,65,d),[S,P]=Ze(_,v),N=s.length(c);let B=1-Math.min(1,Math.exp((N-S)/(P-S)*-6));return B*=B*B,B=Math.min(1,1.00747*B),B*w*_.alpha}function Ze(_,c){const d=.5/Math.tan(.5*c);return[_.range[0]+d,_.range[1]+d]}const At=new s.Properties({range:new s.DataConstantProperty(s.spec.fog.range),color:new s.DataConstantProperty(s.spec.fog.color),"high-color":new s.DataConstantProperty(s.spec.fog["high-color"]),"space-color":new s.DataConstantProperty(s.spec.fog["space-color"]),"horizon-blend":new s.DataConstantProperty(s.spec.fog["horizon-blend"]),"star-intensity":new s.DataConstantProperty(s.spec.fog["star-intensity"])}),Kt="-transition";class sn extends s.Evented{constructor(c,d){super(),this._transitionable=new s.Transitionable(At),this.set(c),this._transitioning=this._transitionable.untransitioned(),this._transform=d}get state(){const c=this._transform,d=c.projection.name==="globe",v=s.globeToMercatorTransition(c.zoom),w=this.properties.get("range"),S=[.5,3];return{range:d?[s.number(S[0],w[0],v),s.number(S[1],w[1],v)]:w,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(c,d={}){if(!this._validate(s.validateFog,c,d)){for(const v of Object.keys(s.spec.fog))c&&c[v]===void 0&&(c[v]=s.spec.fog[v].default);for(const v in c){const w=c[v];s.endsWith(v,Kt)?this._transitionable.setTransition(v.slice(0,-Kt.length),w):this._transitionable.setValue(v,w)}}}getOpacity(c){if(!this._transform.projection.supportsFog)return 0;const d=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:s.smoothstep(45,65,c))*d.a}getOpacityAtLatLng(c,d){return this._transform.projection.supportsFog?function(v,w,S){const P=s.MercatorCoordinate.fromLngLat(w),N=S.elevation?S.elevation.getAtPointOrZero(P):0,B=[P.x,P.y,N];return s.transformMat4(B,B,S.mercatorFogMatrix),et(v,B,S.pitch,S._fov)}(this.state,c,d):0}getFovAdjustedRange(c){return this._transform.projection.supportsFog?Ze(this.state,c):[0,1]}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,d,v){return(!v||v.validate!==!1)&&s.emitValidationErrors(this,c.call(s.validateStyle,s.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}class zn{constructor(c,d){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=s.uniqueId();const v=this.workerPool.acquire(this.id);for(let w=0;w<v.length;w++){const S=new zn.Actor(v[w],d,this.id);S.name=`Worker ${w}`,this.actors.push(S)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(c,d,v){s.asyncAll(this.actors,(w,S)=>{w.send(c,d,S)},v=v||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(c=>{c.remove()}),this.actors=[],this.workerPool.release(this.id)}}function ri(_,c,d){return c*(s.EXTENT/(_.tileSize*Math.pow(2,d-_.tileID.overscaledZ)))}zn.Actor=s.Actor;class Yt{constructor(c,d,v,w){this.screenBounds=c,this.cameraPoint=d,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=v,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,w)}static createFromScreenPoints(c,d){let v,w;if(c instanceof s.pointGeometry||typeof c[0]=="number"){const S=s.pointGeometry.convert(c);v=[S],w=d.isPointAboveHorizon(S)}else{const S=s.pointGeometry.convert(c[0]),P=s.pointGeometry.convert(c[1]);v=[S,P],w=s.polygonizeBounds(S,P).every(N=>d.isPointAboveHorizon(N))}return new Yt(v,d.getCameraPoint(),w,d)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(c){return s.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],c)}bufferedCameraGeometry(c){const d=this.screenBounds[0],v=this.screenBounds.length===1?this.screenBounds[0].add(new s.pointGeometry(1,1)):this.screenBounds[1],w=s.polygonizeBounds(d,v,0,!1);return this.cameraPoint.y>v.y&&(this.cameraPoint.x>d.x&&this.cameraPoint.x<v.x?w.splice(3,0,this.cameraPoint):this.cameraPoint.x>=v.x?w[2]=this.cameraPoint:this.cameraPoint.x<=d.x&&(w[3]=this.cameraPoint)),s.bufferConvexPolygon(w,c)}bufferedCameraGeometryGlobe(c){const d=this.screenBounds[0],v=this.screenBounds.length===1?this.screenBounds[0].add(new s.pointGeometry(1,1)):this.screenBounds[1],w=s.polygonizeBounds(d,v,c),S=this.cameraPoint.clone();switch(3*((S.y>d.y)+(S.y>v.y))+((S.x>d.x)+(S.x>v.x))){case 0:w[0]=S,w[4]=S.clone();break;case 1:w.splice(1,0,S);break;case 2:w[1]=S;break;case 3:w.splice(4,0,S);break;case 5:w.splice(2,0,S);break;case 6:w[3]=S;break;case 7:w.splice(3,0,S);break;case 8:w[2]=S}return w}containsTile(c,d,v,w=0){const S=c.queryPadding/d._pixelsPerMercatorPixel+1,P=v?this._bufferedCameraMercator(S,d):this._bufferedScreenMercator(S,d);let N=c.tileID.wrap+(P.unwrapped?w:0);const B=P.polygon.map(_e=>s.getTilePoint(c.tileTransform,_e,N));if(!s.polygonIntersectsBox(B,0,0,s.EXTENT,s.EXTENT))return;N=c.tileID.wrap+(this.screenGeometryMercator.unwrapped?w:0);const H=this.screenGeometryMercator.polygon.map(_e=>s.getTileVec3(c.tileTransform,_e,N)),W=H.map(_e=>new s.pointGeometry(_e[0],_e[1])),$=d.getFreeCameraOptions().position||new s.MercatorCoordinate(0,0,0),ae=s.getTileVec3(c.tileTransform,$,N),pe=H.map(_e=>{const re=s.sub(_e,_e,ae);return s.normalize(re,re),new s.Ray(ae,re)}),de=ri(c,1,d.zoom)*d._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:W,tilespaceRays:pe,bufferedTilespaceGeometry:B,bufferedTilespaceBounds:(me=s.getBounds(B),me.min.x=s.clamp(me.min.x,0,s.EXTENT),me.min.y=s.clamp(me.min.y,0,s.EXTENT),me.max.x=s.clamp(me.max.x,0,s.EXTENT),me.max.y=s.clamp(me.max.y,0,s.EXTENT),me),tile:c,tileID:c.tileID,pixelToTileUnitsFactor:de};var me}_bufferedScreenMercator(c,d){const v=on(c);if(this._screenRaycastCache[v])return this._screenRaycastCache[v];{let w;return w=d.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(c),d):{polygon:this.bufferedScreenGeometry(c).map(S=>d.pointCoordinate3D(S)),unwrapped:!0},this._screenRaycastCache[v]=w,w}}_bufferedCameraMercator(c,d){const v=on(c);if(this._cameraRaycastCache[v])return this._cameraRaycastCache[v];{let w;return w=d.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(c),d):{polygon:this.bufferedCameraGeometry(c).map(S=>d.pointCoordinate3D(S)),unwrapped:!0},this._cameraRaycastCache[v]=w,w}}_projectAndResample(c,d){const v=function(S,P){const N=s.multiply([],P.pixelMatrix,P.globeMatrix),B=[0,-s.GLOBE_RADIUS,0,1],H=[0,s.GLOBE_RADIUS,0,1],W=[0,0,0,1];s.transformMat4$1(B,B,N),s.transformMat4$1(H,H,N),s.transformMat4$1(W,W,N);const $=new s.pointGeometry(B[0]/B[3],B[1]/B[3]),ae=new s.pointGeometry(H[0]/H[3],H[1]/H[3]),pe=s.polygonContainsPoint(S,$)&&B[3]<W[3],de=s.polygonContainsPoint(S,ae)&&H[3]<W[3];if(!pe&&!de)return null;const me=function(qe,lt,ut){for(let gt=1;gt<qe.length;gt++){const nn=kn(lt.pointCoordinate3D(qe[gt-1]).x),ft=kn(lt.pointCoordinate3D(qe[gt]).x);if(ut<0){if(nn<ft)return{idx:gt,t:-nn/(ft-1-nn)}}else if(ft<nn)return{idx:gt,t:(1-nn)/(ft+1-nn)}}return null}(S,P,pe?-1:1);if(!me)return null;const{idx:_e,t:re}=me;let Ie=_e>1?ii(S.slice(0,_e),P):[],Ee=_e<S.length?ii(S.slice(_e),P):[];Ie=Ie.map(qe=>new s.pointGeometry(kn(qe.x),qe.y)),Ee=Ee.map(qe=>new s.pointGeometry(kn(qe.x),qe.y));const Se=[...Ie];Se.length===0&&Se.push(Ee[Ee.length-1]);const ze=s.number(Se[Se.length-1].y,(Ee.length===0?Ie[0]:Ee[0]).y,re);let De;return De=pe?[new s.pointGeometry(0,ze),new s.pointGeometry(0,0),new s.pointGeometry(1,0),new s.pointGeometry(1,ze)]:[new s.pointGeometry(1,ze),new s.pointGeometry(1,1),new s.pointGeometry(0,1),new s.pointGeometry(0,ze)],Se.push(...De),Ee.length===0?Se.push(Ie[0]):Se.push(...Ee),{polygon:Se.map(qe=>new s.MercatorCoordinate(qe.x,qe.y)),unwrapped:!1}}(c,d);if(v)return v;const w=function(S,P){let N=!1,B=-1/0,H=0;for(let $=0;$<S.length-1;$++)S[$].x>B&&(B=S[$].x,H=$);for(let $=0;$<S.length-1;$++){const ae=(H+$)%(S.length-1),pe=S[ae],de=S[ae+1];Math.abs(pe.x-de.x)>.5&&(pe.x<de.x?(pe.x+=1,ae===0&&(S[S.length-1].x+=1)):(de.x+=1,ae+1===S.length-1&&(S[0].x+=1)),N=!0)}const W=s.mercatorXfromLng(P.center.lng);return N&&W<Math.abs(W-1)&&S.forEach($=>{$.x-=1}),{polygon:S,unwrapped:N}}(ii(c,d).map(S=>new s.pointGeometry(kn(S.x),S.y)),d);return{polygon:w.polygon.map(S=>new s.MercatorCoordinate(S.x,S.y)),unwrapped:w.unwrapped}}}function ii(_,c){return s.resample(_,d=>{const v=c.pointCoordinate3D(d);d.x=v.x,d.y=v.y},1/256)}function kn(_){return _<0?1+_%1:_%1}function on(_){return 100*_|0}function Di(_,c,d,v,w){const S=function(P,N){if(P)return w(P);if(N){_.url&&N.tiles&&_.tiles&&delete _.tiles;const B=s.pick(s.extend(N,_),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);N.vector_layers&&(B.vectorLayers=N.vector_layers,B.vectorLayerIds=B.vectorLayers.map(H=>H.id)),B.tiles=c.canonicalizeTileset(B,_.url),w(null,B)}};return _.url?s.getJSON(c.transformRequest(c.normalizeSourceURL(_.url,null,d,v),s.ResourceType.Source),S):s.exported.frame(()=>S(null,_))}class Ut{constructor(c,d,v){this.bounds=s.LngLatBounds.convert(this.validateBounds(c)),this.minzoom=d||0,this.maxzoom=v||24}validateBounds(c){return Array.isArray(c)&&c.length===4?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]}contains(c){const d=Math.pow(2,c.z),v=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*d),w=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*d),S=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*d),P=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*d);return c.x>=v&&c.x<S&&c.y>=w&&c.y<P}}class Nt{constructor(c,d,v){this.context=c;const w=c.gl;this.buffer=w.createBuffer(),this.dynamicDraw=!!v,this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||d.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(c){const d=this.context.gl;this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Gn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ci{constructor(c,d,v,w){this.length=d.length,this.attributes=v,this.itemSize=d.bytesPerElement,this.dynamicDraw=w,this.context=c;const S=c.gl;this.buffer=S.createBuffer(),c.bindVertexBuffer.set(this.buffer),S.bufferData(S.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||d.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(c){const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,c.arrayBuffer)}enableAttributes(c,d){for(let v=0;v<this.attributes.length;v++){const w=d.attributes[this.attributes[v].name];w!==void 0&&c.enableVertexAttribArray(w)}}setVertexAttribPointers(c,d,v){for(let w=0;w<this.attributes.length;w++){const S=this.attributes[w],P=d.attributes[S.name];P!==void 0&&c.vertexAttribPointer(P,S.components,c[Gn[S.type]],!1,this.itemSize,S.offset+this.itemSize*(v||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ln{constructor(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(c){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Mt extends ln{getDefault(){return s.Color.transparent}set(c){const d=this.current;(c.r!==d.r||c.g!==d.g||c.b!==d.b||c.a!==d.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class Un extends ln{getDefault(){return 1}set(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)}}class ti extends ln{getDefault(){return 0}set(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)}}class jr extends ln{getDefault(){return[!0,!0,!0,!0]}set(c){const d=this.current;(c[0]!==d[0]||c[1]!==d[1]||c[2]!==d[2]||c[3]!==d[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class Yr extends ln{getDefault(){return!0}set(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)}}class hi extends ln{getDefault(){return 255}set(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)}}class Hi extends ln{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(c){const d=this.current;(c.func!==d.func||c.ref!==d.ref||c.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)}}class or extends ln{getDefault(){const c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]}set(c){const d=this.current;(c[0]!==d[0]||c[1]!==d[1]||c[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)}}class $e extends ln{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const d=this.gl;c?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=c,this.dirty=!1}}class Tn extends ln{getDefault(){return[0,1]}set(c){const d=this.current;(c[0]!==d[0]||c[1]!==d[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)}}class fi extends ln{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const d=this.gl;c?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=c,this.dirty=!1}}class Kn extends ln{getDefault(){return this.gl.LESS}set(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)}}class pn extends ln{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const d=this.gl;c?d.enable(d.BLEND):d.disable(d.BLEND),this.current=c,this.dirty=!1}}class vi extends ln{getDefault(){const c=this.gl;return[c.ONE,c.ZERO]}set(c){const d=this.current;(c[0]!==d[0]||c[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(c[0],c[1]),this.current=c,this.dirty=!1)}}class Rs extends ln{getDefault(){return s.Color.transparent}set(c){const d=this.current;(c.r!==d.r||c.g!==d.g||c.b!==d.b||c.a!==d.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class kt extends ln{getDefault(){return this.gl.FUNC_ADD}set(c){(c!==this.current||this.dirty)&&(this.gl.blendEquation(c),this.current=c,this.dirty=!1)}}class mn extends ln{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const d=this.gl;c?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=c,this.dirty=!1}}class jn extends ln{getDefault(){return this.gl.BACK}set(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)}}class ki extends ln{getDefault(){return this.gl.CCW}set(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)}}class Ds extends ln{getDefault(){return null}set(c){(c!==this.current||this.dirty)&&(this.gl.useProgram(c),this.current=c,this.dirty=!1)}}class io extends ln{getDefault(){return this.gl.TEXTURE0}set(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)}}class oa extends ln{getDefault(){const c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]}set(c){const d=this.current;(c[0]!==d[0]||c[1]!==d[1]||c[2]!==d[2]||c[3]!==d[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class Vo extends ln{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,c),this.current=c,this.dirty=!1}}class Os extends ln{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class Mo extends ln{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,c),this.current=c,this.dirty=!1}}class qa extends ln{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class ro extends ln{getDefault(){return null}set(c){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class Ia extends ln{constructor(c){super(c),this.vao=c.extVertexArrayObject}getDefault(){return null}set(c){this.vao&&(c!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(c),this.current=c,this.dirty=!1)}}class Rl extends ln{getDefault(){return 4}set(c){if(c===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}}class Ha extends ln{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}}class aa extends ln{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}}class Wa extends ln{constructor(c,d){super(c),this.context=c,this.parent=d}getDefault(){return null}}class Bs extends Wa{setDirty(){this.dirty=!0}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class Ta extends Wa{attachment(){return this.gl.DEPTH_ATTACHMENT}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,this.attachment(),d.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class Zs extends Ta{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Sa{constructor(c,d,v,w){this.context=c,this.width=d,this.height=v;const S=this.framebuffer=c.gl.createFramebuffer();this.colorAttachment=new Bs(c,S),w&&(this.depthAttachment=new Ta(c,S))}destroy(){const c=this.context.gl,d=this.colorAttachment.get();if(d&&c.deleteTexture(d),this.depthAttachment){const v=this.depthAttachment.get();v&&c.deleteRenderbuffer(v)}c.deleteFramebuffer(this.framebuffer)}}class xe{constructor(c,d=!1){if(this.gl=c,this.isWebGL2=d,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),d){const v=c;this.extVertexArrayObject={createVertexArrayOES:v.createVertexArray.bind(c),deleteVertexArrayOES:v.deleteVertexArray.bind(c),bindVertexArrayOES:v.bindVertexArray.bind(c)}}this.clearColor=new Mt(this),this.clearDepth=new Un(this),this.clearStencil=new ti(this),this.colorMask=new jr(this),this.depthMask=new Yr(this),this.stencilMask=new hi(this),this.stencilFunc=new Hi(this),this.stencilOp=new or(this),this.stencilTest=new $e(this),this.depthRange=new Tn(this),this.depthTest=new fi(this),this.depthFunc=new Kn(this),this.blend=new pn(this),this.blendFunc=new vi(this),this.blendColor=new Rs(this),this.blendEquation=new kt(this),this.cullFace=new mn(this),this.cullFaceSide=new jn(this),this.frontFace=new ki(this),this.program=new Ds(this),this.activeTexture=new io(this),this.viewport=new oa(this),this.bindFramebuffer=new Vo(this),this.bindRenderbuffer=new Os(this),this.bindTexture=new Mo(this),this.bindVertexBuffer=new qa(this),this.bindElementBuffer=new ro(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Ia(this),this.pixelStoreUnpack=new Rl(this),this.pixelStoreUnpackPremultiplyAlpha=new Ha(this),this.pixelStoreUnpackFlipY=new aa(this),this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=c.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=c.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=c.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),d||(this.extTextureHalfFloat=c.getExtension("OES_texture_half_float")),(d||this.extTextureHalfFloat&&c.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=c.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=d||c.getExtension("OES_standard_derivatives"),this.extTimerQuery=c.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(c,d){return new Nt(this,c,d)}createVertexBuffer(c,d,v){return new Ci(this,c,d,v)}createRenderbuffer(c,d,v){const w=this.gl,S=w.createRenderbuffer();return this.bindRenderbuffer.set(S),w.renderbufferStorage(w.RENDERBUFFER,c,d,v),this.bindRenderbuffer.set(null),S}createFramebuffer(c,d,v){return new Sa(this,c,d,v)}clear({color:c,depth:d,stencil:v}){const w=this.gl;let S=0;c&&(S|=w.COLOR_BUFFER_BIT,this.clearColor.set(c),this.colorMask.set([!0,!0,!0,!0])),d!==void 0&&(S|=w.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),v!==void 0&&(S|=w.STENCIL_BUFFER_BIT,this.clearStencil.set(v),this.stencilMask.set(255)),w.clear(S)}setCullFace(c){c.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))}setDepthMode(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)}setStencilMode(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)}setColorMode(c){p(c.blendFunction,s.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Q extends s.Evented{constructor(c,d,v,w){if(super(),this.id=c,this.dispatcher=v,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(d,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w),this._tileWorkers={},this._deduped=new s.DedupedRequest}load(c){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"}));const d=Array.isArray(this.map._language)?this.map._language.join():this.map._language,v=this.map._worldview;this._tileJSONRequest=Di(this._options,this.map._requestManager,d,v,(w,S)=>{this._tileJSONRequest=null,this._loaded=!0,w?(d&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${d}`),v&&v.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${v}`),this.fire(new s.ErrorEvent(w))):S&&(s.extend(this,S),S.bounds&&(this.tileBounds=new Ut(S.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(S.tiles,this.map._requestManager._customAccessToken),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),c&&c(w)})}loaded(){return this._loaded}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}onAdd(c){this.map=c,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(c){return this._options.tiles=c,this.reload(),this}setUrl(c){return this.url=c,this._options.url=c,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}loadTile(c,d){const v=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(v,s.ResourceType.Tile),data:void 0,uid:c.uid,tileID:c.tileID,tileZoom:c.tileZoom,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:c.isSymbolTile};if(w.request.collectResourceTiming=this._collectResourceTiming,c.actor&&c.state!=="expired")c.state==="loading"?c.reloadCallback=d:c.request=c.actor.send("reloadTile",w,S.bind(this));else if(c.actor=this._tileWorkers[v]=this._tileWorkers[v]||this.dispatcher.getActor(),this.dispatcher.ready)c.request=c.actor.send("loadTile",w,S.bind(this),void 0,!0);else{const P=s.loadVectorTile.call({deduped:this._deduped},w,(N,B)=>{N||!B?S.call(this,N):(w.data={cacheControl:B.cacheControl,expires:B.expires,rawData:B.rawData.slice(0)},c.actor&&c.actor.send("loadTile",w,S.bind(this),void 0,!0))},!0);c.request={cancel:P}}function S(P,N){return delete c.request,c.aborted?d(null):P&&P.status!==404?d(P):(N&&N.resourceTiming&&(c.resourceTiming=N.resourceTiming),this.map._refreshExpiredTiles&&N&&c.setExpiryData(N),c.loadVectorData(N,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),d(null),void(c.reloadCallback&&(this.loadTile(c,c.reloadCallback),c.reloadCallback=null)))}}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.actor&&c.actor.send("abortTile",{uid:c.uid,type:this.type,source:this.id})}unloadTile(c){c.unloadVectorData(),c.actor&&c.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ne extends s.Evented{constructor(c,d,v,w){super(),this.id=c,this.dispatcher=v,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},d),s.extend(this,s.pick(d,["url","scheme","tileSize"]))}load(c){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Di(this._options,this.map._requestManager,null,null,(d,v)=>{this._tileJSONRequest=null,this._loaded=!0,d?this.fire(new s.ErrorEvent(d)):v&&(s.extend(this,v),v.bounds&&(this.tileBounds=new Ut(v.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(v.tiles),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),c&&c(d)})}loaded(){return this._loaded}onAdd(c){this.map=c,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(c){return this._options.tiles=c,this.reload(),this}setUrl(c){return this.url=c,this._options.url=c,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}loadTile(c,d){const v=s.exported.devicePixelRatio>=2,w=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme),v,this.tileSize);c.request=s.getImage(this.map._requestManager.transformRequest(w,s.ResourceType.Tile),(S,P,N,B)=>(delete c.request,c.aborted?(c.state="unloaded",d(null)):S?(c.state="errored",d(S)):P?(this.map._refreshExpiredTiles&&c.setExpiryData({cacheControl:N,expires:B}),c.setTexture(P,this.map.painter),c.state="loaded",s.cacheEntryPossiblyAdded(this.dispatcher),void d(null)):d(null)))}static loadTileData(c,d,v){c.setTexture(d,v)}static unloadTileData(c,d){c.texture&&d.saveTileTexture(c.texture)}abortTile(c,d){c.request&&(c.request.cancel(),delete c.request),d()}unloadTile(c,d){c.texture&&this.map.painter.saveTileTexture(c.texture),d()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let ve;function Ce(_,c,d,v,w,S,P,N){const B=[_,d,w,c,v,S,1,1,1],H=[P,N,1],W=s.adjoint([],B),[$,ae,pe]=s.transformMat3(H,H,s.transpose(W,W));return s.multiply$1(B,[$,0,0,0,ae,0,0,0,pe],B)}class Be extends s.Evented{constructor(c,d,v,w){super(),this.id=c,this.dispatcher=v,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=d,this._dirty=!1}load(c,d){this._loaded=d||!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),(v,w)=>{if(this._imageRequest=null,this._loaded=!0,v)this.fire(new s.ErrorEvent(v));else if(w){const{HTMLImageElement:S}=s.window;this.image=w instanceof S?s.exported.getImageData(w):w,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,c&&(this.coordinates=c),this._finishLoading()}})}loaded(){return this._loaded}updateImage(c){return this.image&&c.url?(this._imageRequest&&c.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=c.url,this.load(c.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(c){this.map=c,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(c){this.coordinates=c,this._boundsArray=void 0;const d=c.map(s.MercatorCoordinate.fromLngLat);return this.tileID=function(v){let w=1/0,S=1/0,P=-1/0,N=-1/0;for(const $ of v)w=Math.min(w,$.x),S=Math.min(S,$.y),P=Math.max(P,$.x),N=Math.max(N,$.y);const B=Math.max(P-w,N-S),H=Math.max(0,Math.floor(-Math.log(B)/Math.LN2)),W=Math.pow(2,H);return new s.CanonicalTileID(H,Math.floor((w+P)/2*W),Math.floor((S+N)/2*W))}(d),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(c){for(const B in this.tiles){const H=this.tiles[B];H.state!=="loaded"&&(H.state="loaded",H.texture=this.texture)}if(this._boundsArray)return;const d=s.tileTransform(this.tileID,this.map.transform.projection),[v,w,S,P]=this.coordinates.map(B=>{const H=d.projection.project(B[0],B[1]);return s.getTilePoint(d,H)._round()});this.perspectiveTransform=function(B,H,W,$,ae,pe,de,me,_e,re){const Ie=Ce(0,0,B,0,0,H,B,H),Ee=Ce(W,$,ae,pe,de,me,_e,re);return s.multiply$1(Ee,s.adjoint(Ie,Ie),Ee),[Ee[6]/Ee[8]*B/s.EXTENT,Ee[7]/Ee[8]*H/s.EXTENT]}(this.width,this.height,v.x,v.y,w.x,w.y,P.x,P.y,S.x,S.y);const N=this._boundsArray=new s.StructArrayLayout4i8;N.emplaceBack(v.x,v.y,0,0),N.emplaceBack(w.x,w.y,s.EXTENT,0),N.emplaceBack(P.x,P.y,0,s.EXTENT),N.emplaceBack(S.x,S.y,s.EXTENT,s.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=c.createVertexBuffer(N,s.boundsAttributes.members),this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const c=this.map.painter.context,d=c.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new s.Texture(c,this.image,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(c)}loadTile(c,d){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={},d(null)):(c.state="errored",d(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const st={vector:Q,raster:ne,"raster-dem":class extends ne{constructor(_,c,d,v){super(_,c,d,v),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox"}loadTile(_,c){const d=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function v(w,S){w&&(_.state="errored",c(w)),S&&(_.dem=S,_.dem.onDeserialize(),_.needsHillshadePrepare=!0,_.needsDEMTextureUpload=!0,_.state="loaded",c(null))}_.request=s.getImage(this.map._requestManager.transformRequest(d,s.ResourceType.Tile),function(w,S,P,N){if(delete _.request,_.aborted)_.state="unloaded",c(null);else if(w)_.state="errored",c(w);else if(S){this.map._refreshExpiredTiles&&_.setExpiryData({cacheControl:P,expires:N});const B=s.window.ImageBitmap&&S instanceof s.window.ImageBitmap&&(ve==null&&(ve=s.window.OffscreenCanvas&&new s.window.OffscreenCanvas(1,1).getContext("2d")&&typeof s.window.createImageBitmap=="function"),ve),H=1-(S.width-s.prevPowerOfTwo(S.width))/2;H<1||_.neighboringTiles||(_.neighboringTiles=this._getNeighboringTiles(_.tileID));const W=B?S:s.exported.getImageData(S,H),$={uid:_.uid,coord:_.tileID,source:this.id,rawImageData:W,encoding:this.encoding,padding:H};_.actor&&_.state!=="expired"||(_.actor=this.dispatcher.getActor(),_.actor.send("loadDEMTile",$,v.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(_){const c=_.canonical,d=Math.pow(2,c.z),v=(c.x-1+d)%d,w=c.x===0?_.wrap-1:_.wrap,S=(c.x+1+d)%d,P=c.x+1===d?_.wrap+1:_.wrap,N={};return N[new s.OverscaledTileID(_.overscaledZ,w,c.z,v,c.y).key]={backfilled:!1},N[new s.OverscaledTileID(_.overscaledZ,P,c.z,S,c.y).key]={backfilled:!1},c.y>0&&(N[new s.OverscaledTileID(_.overscaledZ,w,c.z,v,c.y-1).key]={backfilled:!1},N[new s.OverscaledTileID(_.overscaledZ,_.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},N[new s.OverscaledTileID(_.overscaledZ,P,c.z,S,c.y-1).key]={backfilled:!1}),c.y+1<d&&(N[new s.OverscaledTileID(_.overscaledZ,w,c.z,v,c.y+1).key]={backfilled:!1},N[new s.OverscaledTileID(_.overscaledZ,_.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},N[new s.OverscaledTileID(_.overscaledZ,P,c.z,S,c.y+1).key]={backfilled:!1}),N}unloadTile(_){_.demTexture&&this.map.painter.saveTileTexture(_.demTexture),_.fbo&&(_.fbo.destroy(),delete _.fbo),_.dem&&delete _.dem,delete _.neighboringTiles,_.state="unloaded"}},geojson:class extends s.Evented{constructor(_,c,d,v){super(),this.id=_,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=d.getActor(),this.setEventedParent(v),this._data=c.data,this._options=s.extend({},c),this._collectResourceTiming=c.collectResourceTiming,c.maxzoom!==void 0&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;const w=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(c.buffer!==void 0?c.buffer:128)*w,tolerance:(c.tolerance!==void 0?c.tolerance:.375)*w,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:c.clusterMaxZoom!==void 0?c.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:s.EXTENT,radius:(c.clusterRadius!==void 0?c.clusterRadius:50)*w,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions)}onAdd(_){this.map=_,this.setData(this._data)}setData(_){return this._data=_,this._updateWorkerData(),this}getClusterExpansionZoom(_,c){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:_,source:this.id},c),this}getClusterChildren(_,c){return this.actor.send("geojson.getClusterChildren",{clusterId:_,source:this.id},c),this}getClusterLeaves(_,c,d,v){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:_,limit:c,offset:d},v),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.Event("dataloading",{dataType:"source"})),this._loaded=!1;const _=s.extend({},this.workerOptions),c=this._data;typeof c=="string"?(_.request=this.map._requestManager.transformRequest(s.exported.resolveURL(c),s.ResourceType.Source),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(c),this._pendingLoad=this.actor.send(`${this.type}.loadData`,_,(d,v)=>{if(this._loaded=!0,this._pendingLoad=null,d)this.fire(new s.ErrorEvent(d));else{const w={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&v&&v.resourceTiming&&v.resourceTiming[this.id]&&(w.resourceTiming=v.resourceTiming[this.id]),this.fire(new s.Event("data",w)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(_,c){const d=_.actor?"reloadTile":"loadTile";_.actor=this.actor,_.request=this.actor.send(d,{type:this.type,uid:_.uid,tileID:_.tileID,tileZoom:_.tileZoom,zoom:_.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(v,w)=>(delete _.request,_.unloadVectorData(),_.aborted?c(null):v?c(v):(_.loadVectorData(w,this.map.painter,d==="reloadTile"),c(null))),void 0,d==="loadTile")}abortTile(_){_.request&&(_.request.cancel(),delete _.request),_.aborted=!0}unloadTile(_){_.unloadVectorData(),this.actor.send("removeTile",{uid:_.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Be{constructor(_,c,d,v){super(_,c,d,v),this.roundZoom=!0,this.type="video",this.options=c}load(){this._loaded=!1;const _=this.options;this.urls=[];for(const c of _.urls)this.urls.push(this.map._requestManager.transformRequest(c,s.ResourceType.Source).url);s.getVideo(this.urls,(c,d)=>{this._loaded=!0,c?this.fire(new s.ErrorEvent(c)):d&&(this.video=d,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(_){if(this.video){const c=this.video.seekable;_<c.start(0)||_>c.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${c.start(0)} and ${c.end(0)}-second mark.`))):this.video.currentTime=_}}getVideo(){return this.video}onAdd(_){this.map||(this.map=_,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const _=this.map.painter.context,c=_.gl;this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(_,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(_)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Be,canvas:class extends Be{constructor(_,c,d,v){super(_,c,d,v),c.coordinates?Array.isArray(c.coordinates)&&c.coordinates.length===4&&!c.coordinates.some(w=>!Array.isArray(w)||w.length!==2||w.some(S=>typeof S!="number"))||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${_}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${_}`,null,'missing required property "coordinates"'))),c.animate&&typeof c.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${_}`,null,'optional "animate" property must be a boolean value'))),c.canvas?typeof c.canvas=="string"||c.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${_}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${_}`,null,'missing required property "canvas"'))),this.options=c,this.animate=c.animate===void 0||c.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(_){this.map=_,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let _=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,_=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,_=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const c=this.map.painter.context;this.texture?(_||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(c,this.canvas,c.gl.RGBA,{premultiply:!0}),this._prepareData(c)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const _ of[this.canvas.width,this.canvas.height])if(isNaN(_)||_<=0)return!0;return!1}},custom:class extends s.Evented{constructor(_,c,d,v){super(),this.id=_,this.type="custom",this._dataType="raster",this._dispatcher=d,this._implementation=c,this.setEventedParent(v),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ut(this._implementation.bounds,this.minzoom,this.maxzoom)),c.update=this._update.bind(this),c.clearTiles=this._clearTiles.bind(this),c.coveringTiles=this._coveringTiles.bind(this),s.extend(this,s.pick(c,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(_){this._map=_,this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(_),this.load()}onRemove(_){this._implementation.onRemove&&this._implementation.onRemove(_)}hasTile(_){if(this._implementation.hasTile){const{x:c,y:d,z:v}=_.canonical;return this._implementation.hasTile({x:c,y:d,z:v})}return!this.tileBounds||this.tileBounds.contains(_.canonical)}loadTile(_,c){const{x:d,y:v,z:w}=_.tileID.canonical,S=new s.window.AbortController;_.request=Promise.resolve(this._implementation.loadTile({x:d,y:v,z:w},{signal:S.signal})).then(function(P){return delete _.request,_.aborted?(_.state="unloaded",c(null)):P===void 0?(_.state="errored",c(null)):P===null?(this.loadTileData(_,{width:this.tileSize,height:this.tileSize,data:null}),_.state="loaded",c(null)):function(N){return N instanceof s.window.ImageData||N instanceof s.window.HTMLCanvasElement||N instanceof s.window.ImageBitmap||N instanceof s.window.HTMLImageElement}(P)?(this.loadTileData(_,P),_.state="loaded",void c(null)):(_.state="errored",c(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch(P=>{P.code!==20&&(_.state="errored",c(P))}),_.request.cancel=()=>S.abort()}loadTileData(_,c){ne.loadTileData(_,c,this._map.painter)}unloadTileData(_){ne.unloadTileData(_,this._map.painter)}unloadTile(_,c){if(this.unloadTileData(_),this._implementation.unloadTile){const{x:d,y:v,z:w}=_.tileID.canonical;this._implementation.unloadTile({x:d,y:v,z:w})}c()}abortTile(_,c){_.request&&_.request.cancel&&(_.request.cancel(),delete _.request),c()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(_=>({x:_.canonical.x,y:_.canonical.y,z:_.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}}},tt=function(_,c,d,v){const w=new st[c.type](_,c,d,v);if(w.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${w.id}`);return s.bindAll(["load","abort","unload","serialize","prepare"],w),w};function He(_,c){const d=s.identity([]);return s.scale(d,d,[.5*_.width,.5*-_.height,1]),s.translate(d,d,[1,-1,0]),s.multiply(d,d,_.calculateProjMatrix(c.toUnwrapped())),Float32Array.from(d)}function ue(_,c,d,v,w,S,P,N=!1){const B=_.tilesIn(v,P,N);B.sort(ge);const H=[];for(const $ of B)H.push({wrappedTileID:$.tile.tileID.wrapped().key,queryResults:$.tile.queryRenderedFeatures(c,d,_._state,$,w,S,He(_.transform,$.tile.tileID),N)});const W=function($){const ae={},pe={};for(const de of $){const me=de.queryResults,_e=de.wrappedTileID,re=pe[_e]=pe[_e]||{};for(const Ie in me){const Ee=me[Ie],Se=re[Ie]=re[Ie]||{},ze=ae[Ie]=ae[Ie]||[];for(const De of Ee)Se[De.featureIndex]||(Se[De.featureIndex]=!0,ze.push(De))}}return ae}(H);for(const $ in W)W[$].forEach(ae=>{const pe=ae.feature,de=pe.layer;de&&de.type!=="background"&&de.type!=="sky"&&(pe.source=de.source,de["source-layer"]&&(pe.sourceLayer=de["source-layer"]),pe.state=pe.id!==void 0?_.getFeatureState(de["source-layer"],pe.id):{})});return W}function Ye(_,c){const d=_.getRenderableIds().map(S=>_.getTileByID(S)),v=[],w={};for(let S=0;S<d.length;S++){const P=d[S],N=P.tileID.canonical.key;w[N]||(w[N]=!0,P.querySourceFeatures(v,c))}return v}function ge(_,c){const d=_.tileID,v=c.tileID;return d.overscaledZ-v.overscaledZ||d.canonical.y-v.canonical.y||d.wrap-v.wrap||d.canonical.x-v.canonical.x}function It(){return Hh.workerClass!=null?new Hh.workerClass:new s.window.Worker(Hh.workerUrl)}const vn="mapboxgl_preloaded_worker_pool";class Wn{constructor(){this.active={}}acquire(c){if(!this.workers)for(this.workers=[];this.workers.length<Wn.workerCount;)this.workers.push(new It);return this.active[c]=!0,this.workers.slice()}release(c){delete this.active[c],this.numActive()===0&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[vn]}numActive(){return Object.keys(this.active).length}}let Vn;function je(){return Vn||(Vn=new Wn),Vn}function Fn(_,c){const d={};for(const v in _)v!=="ref"&&(d[v]=_[v]);return s.refProperties.forEach(v=>{v in c&&(d[v]=c[v])}),d}function ar(_){_=_.slice();const c=Object.create(null);for(let d=0;d<_.length;d++)c[_[d].id]=_[d];for(let d=0;d<_.length;d++)"ref"in _[d]&&(_[d]=Fn(_[d],c[_[d].ref]));return _}Wn.workerCount=2;const ui={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Qi(_,c,d){d.push({command:ui.addSource,args:[_,c[_]]})}function nr(_,c,d){c.push({command:ui.removeSource,args:[_]}),d[_]=!0}function Dl(_,c,d,v){nr(_,d,v),Qi(_,c,d)}function la(_,c,d){let v;for(v in _[d])if(_[d].hasOwnProperty(v)&&v!=="data"&&!p(_[d][v],c[d][v]))return!1;for(v in c[d])if(c[d].hasOwnProperty(v)&&v!=="data"&&!p(_[d][v],c[d][v]))return!1;return!0}function wt(_,c,d,v,w,S){let P;for(P in c=c||{},_=_||{})_.hasOwnProperty(P)&&(p(_[P],c[P])||d.push({command:S,args:[v,P,c[P],w]}));for(P in c)c.hasOwnProperty(P)&&!_.hasOwnProperty(P)&&(p(_[P],c[P])||d.push({command:S,args:[v,P,c[P],w]}))}function Ol(_){return _.id}function zs(_,c){return _[c.id]=c,_}class ic{constructor(c,d){this.reset(c,d)}reset(c,d){this.points=c||[],this._distances=[0];for(let v=1;v<this.points.length;v++)this._distances[v]=this._distances[v-1]+this.points[v].dist(this.points[v-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(c){if(this.points.length===1)return this.points[0];c=s.clamp(c,0,1);let d=1,v=this._distances[d];const w=c*this.paddedLength+this.padding;for(;v<w&&d<this._distances.length;)v=this._distances[++d];const S=d-1,P=this._distances[S],N=v-P,B=N>0?(w-P)/N:0;return this.points[S].mult(1-B).add(this.points[d].mult(B))}}class am{constructor(c,d,v){const w=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(c/v),this.yCellCount=Math.ceil(d/v);for(let P=0;P<this.xCellCount*this.yCellCount;P++)w.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=d,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(c,d,v,w,S){this._forEachCell(d,v,w,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(d),this.bboxes.push(v),this.bboxes.push(w),this.bboxes.push(S)}insertCircle(c,d,v,w){this._forEachCell(d-w,v-w,d+w,v+w,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(d),this.circles.push(v),this.circles.push(w)}_insertBoxCell(c,d,v,w,S,P){this.boxCells[S].push(P)}_insertCircleCell(c,d,v,w,S,P){this.circleCells[S].push(P)}_query(c,d,v,w,S,P){if(v<0||c>this.width||w<0||d>this.height)return!S&&[];const N=[];if(c<=0&&d<=0&&this.width<=v&&this.height<=w){if(S)return!0;for(let B=0;B<this.boxKeys.length;B++)N.push({key:this.boxKeys[B],x1:this.bboxes[4*B],y1:this.bboxes[4*B+1],x2:this.bboxes[4*B+2],y2:this.bboxes[4*B+3]});for(let B=0;B<this.circleKeys.length;B++){const H=this.circles[3*B],W=this.circles[3*B+1],$=this.circles[3*B+2];N.push({key:this.circleKeys[B],x1:H-$,y1:W-$,x2:H+$,y2:W+$})}return P?N.filter(P):N}return this._forEachCell(c,d,v,w,this._queryCell,N,{hitTest:S,seenUids:{box:{},circle:{}}},P),S?N.length>0:N}_queryCircle(c,d,v,w,S){const P=c-v,N=c+v,B=d-v,H=d+v;if(N<0||P>this.width||H<0||B>this.height)return!w&&[];const W=[];return this._forEachCell(P,B,N,H,this._queryCellCircle,W,{hitTest:w,circle:{x:c,y:d,radius:v},seenUids:{box:{},circle:{}}},S),w?W.length>0:W}query(c,d,v,w,S){return this._query(c,d,v,w,!1,S)}hitTest(c,d,v,w,S){return this._query(c,d,v,w,!0,S)}hitTestCircle(c,d,v,w){return this._queryCircle(c,d,v,!0,w)}_queryCell(c,d,v,w,S,P,N,B){const H=N.seenUids,W=this.boxCells[S];if(W!==null){const ae=this.bboxes;for(const pe of W)if(!H.box[pe]){H.box[pe]=!0;const de=4*pe;if(c<=ae[de+2]&&d<=ae[de+3]&&v>=ae[de+0]&&w>=ae[de+1]&&(!B||B(this.boxKeys[pe]))){if(N.hitTest)return P.push(!0),!0;P.push({key:this.boxKeys[pe],x1:ae[de],y1:ae[de+1],x2:ae[de+2],y2:ae[de+3]})}}}const $=this.circleCells[S];if($!==null){const ae=this.circles;for(const pe of $)if(!H.circle[pe]){H.circle[pe]=!0;const de=3*pe;if(this._circleAndRectCollide(ae[de],ae[de+1],ae[de+2],c,d,v,w)&&(!B||B(this.circleKeys[pe]))){if(N.hitTest)return P.push(!0),!0;{const me=ae[de],_e=ae[de+1],re=ae[de+2];P.push({key:this.circleKeys[pe],x1:me-re,y1:_e-re,x2:me+re,y2:_e+re})}}}}}_queryCellCircle(c,d,v,w,S,P,N,B){const H=N.circle,W=N.seenUids,$=this.boxCells[S];if($!==null){const pe=this.bboxes;for(const de of $)if(!W.box[de]){W.box[de]=!0;const me=4*de;if(this._circleAndRectCollide(H.x,H.y,H.radius,pe[me+0],pe[me+1],pe[me+2],pe[me+3])&&(!B||B(this.boxKeys[de])))return P.push(!0),!0}}const ae=this.circleCells[S];if(ae!==null){const pe=this.circles;for(const de of ae)if(!W.circle[de]){W.circle[de]=!0;const me=3*de;if(this._circlesCollide(pe[me],pe[me+1],pe[me+2],H.x,H.y,H.radius)&&(!B||B(this.circleKeys[de])))return P.push(!0),!0}}}_forEachCell(c,d,v,w,S,P,N,B){const H=this._convertToXCellCoord(c),W=this._convertToYCellCoord(d),$=this._convertToXCellCoord(v),ae=this._convertToYCellCoord(w);for(let pe=H;pe<=$;pe++)for(let de=W;de<=ae;de++)if(S.call(this,c,d,v,w,this.xCellCount*de+pe,P,N,B))return}_convertToXCellCoord(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))}_convertToYCellCoord(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))}_circlesCollide(c,d,v,w,S,P){const N=w-c,B=S-d,H=v+P;return H*H>N*N+B*B}_circleAndRectCollide(c,d,v,w,S,P,N){const B=(P-w)/2,H=Math.abs(c-(w+B));if(H>B+v)return!1;const W=(N-S)/2,$=Math.abs(d-(S+W));if($>W+v)return!1;if(H<=B||$<=W)return!0;const ae=H-B,pe=$-W;return ae*ae+pe*pe<=v*v}}const Nl=Math.tan(85*Math.PI/180);function Eu(_,c,d,v,w,S,P){const N=s.create();if(d)if(S.name==="globe"){const B=s.calculateGlobeLabelMatrix(w,c);s.multiply(N,N,B)}else{const B=Fe([],P);N[0]=B[0],N[1]=B[1],N[4]=B[2],N[5]=B[3],v||s.rotateZ(N,N,w.angle)}else s.multiply(N,w.labelPlaneMatrix,_);return N}function cp(_,c,d,v,w,S,P){const N=Eu(_,c,d,v,w,S,P);return S.name==="globe"&&d||(N[2]=N[6]=N[10]=N[14]=0),N}function rc(_,c,d,v,w,S,P){if(d){if(S.name==="globe"){const N=Eu(_,c,d,v,w,S,P);return s.invert(N,N),s.multiply(N,_,N),N}{const N=s.clone(_),B=s.identity([]);return B[0]=P[0],B[1]=P[1],B[4]=P[2],B[5]=P[3],s.multiply(N,N,B),v||s.rotateZ(N,N,-w.angle),N}}return w.glCoordMatrix}function hn(_,c,d,v){const w=[_,c,d,1];d?s.transformMat4$1(w,w,v):en(w,w,v);const S=w[3];return w[0]/=S,w[1]/=S,w[2]/=S,w}function Wi(_,c){return Math.min(.5+_/c*.5,1.5)}function Yi(_,c){const d=_[0]/_[3],v=_[1]/_[3];return d>=-c[0]&&d<=c[0]&&v>=-c[1]&&v<=c[1]}function Ca(_,c,d,v,w,S,P,N,B,H){const W=d.transform,$=v?_.textSizeData:_.iconSizeData,ae=s.evaluateSizeForZoom($,d.transform.zoom),pe=W.projection.name==="globe",de=[256/d.width*2+1,256/d.height*2+1],me=v?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;me.clear();let _e=null;pe&&(_e=v?_.text.globeExtVertexArray:_.icon.globeExtVertexArray);const re=_.lineVertexArray,Ie=v?_.text.placedSymbolArray:_.icon.placedSymbolArray,Ee=d.transform.width/d.transform.height;let Se,ze=!1;for(let De=0;De<Ie.length;De++){const qe=Ie.get(De),{numGlyphs:lt,writingMode:ut}=qe;if(ut!==s.WritingMode.vertical||ze||Se===s.WritingMode.horizontal||(ze=!0),Se=ut,(qe.hidden||ut===s.WritingMode.vertical)&&!ze){Qe(lt,me);continue}ze=!1;const gt=new s.pointGeometry(qe.tileAnchorX,qe.tileAnchorY);let{x:nn,y:ft,z:Ft}=W.projection.projectTilePoint(gt.x,gt.y,H.canonical);if(B){const[ji,Bn,An]=B(gt);nn+=ji,ft+=Bn,Ft+=An}const xt=[nn,ft,Ft,1];if(s.transformMat4$1(xt,xt,c),!Yi(xt,de)){Qe(lt,me);continue}const Wt=Wi(d.transform.cameraToCenterDistance,xt[3]),pt=s.evaluateSizeForFeature($,ae,qe),at=P?pt/Wt:pt*Wt,yt=hn(nn,ft,Ft,w);if(yt[3]<=0){Qe(lt,me);continue}let Gt={};const Ht=P?null:B,Qn=oe(qe,at,!1,N,c,w,S,_.glyphOffsetArray,re,me,_e,yt,gt,Gt,Ee,Ht,W.projection,H,P);ze=Qn.useVertical,Ht&&Qn.needsFlipping&&(Gt={}),(Qn.notEnoughRoom||ze||Qn.needsFlipping&&oe(qe,at,!0,N,c,w,S,_.glyphOffsetArray,re,me,_e,yt,gt,Gt,Ee,Ht,W.projection,H,P).notEnoughRoom)&&Qe(lt,me)}v?(_.text.dynamicLayoutVertexBuffer.updateData(me),_e&&_.text.globeExtVertexBuffer.updateData(_e)):(_.icon.dynamicLayoutVertexBuffer.updateData(me),_e&&_.icon.globeExtVertexBuffer.updateData(_e))}function D(_,c,d,v,w,S,P,N,B,H,W,$,ae,pe,de,me){const{lineStartIndex:_e,glyphStartIndex:re,segment:Ie}=N,Ee=re+N.numGlyphs,Se=_e+N.lineLength,ze=c.getoffsetX(re),De=c.getoffsetX(Ee-1),qe=We(_*ze,d,v,w,S,P,Ie,_e,Se,B,H,W,$,ae,!0,pe,de,me);if(!qe)return null;const lt=We(_*De,d,v,w,S,P,Ie,_e,Se,B,H,W,$,ae,!0,pe,de,me);return lt?{first:qe,last:lt}:null}function V(_,c,d,v){return _===s.WritingMode.horizontal&&Math.abs(v)>Math.abs(d)?{useVertical:!0}:_===s.WritingMode.vertical?v>0?{needsFlipping:!0}:null:c!==0&&function(w,S){return w===0||Math.abs(S/w)>Nl}(d,v)?c===1?{needsFlipping:!0}:null:d<0?{needsFlipping:!0}:null}function oe(_,c,d,v,w,S,P,N,B,H,W,$,ae,pe,de,me,_e,re,Ie){const Ee=c/24,Se=_.lineOffsetX*Ee,ze=_.lineOffsetY*Ee,{lineStartIndex:De,glyphStartIndex:qe,numGlyphs:lt,segment:ut,writingMode:gt,flipState:nn}=_,ft=De+_.lineLength,Ft=xt=>{if(W){const[yt,Gt,Ht]=xt.up,Qn=H.length;s.updateGlobeVertexNormal(W,Qn+0,yt,Gt,Ht),s.updateGlobeVertexNormal(W,Qn+1,yt,Gt,Ht),s.updateGlobeVertexNormal(W,Qn+2,yt,Gt,Ht),s.updateGlobeVertexNormal(W,Qn+3,yt,Gt,Ht)}const[Wt,pt,at]=xt.point;s.addDynamicAttributes(H,Wt,pt,at,xt.angle)};if(lt>1){const xt=D(Ee,N,Se,ze,d,$,ae,_,B,S,pe,me,!1,_e,re,Ie);if(!xt)return{notEnoughRoom:!0};if(v&&!d){let[Wt,pt,at]=xt.first.point,[yt,Gt,Ht]=xt.last.point;[Wt,pt]=hn(Wt,pt,at,P),[yt,Gt]=hn(yt,Gt,Ht,P);const Qn=V(gt,nn,(yt-Wt)*de,Gt-pt);if(_.flipState=Qn&&Qn.needsFlipping?1:2,Qn)return Qn}Ft(xt.first);for(let Wt=qe+1;Wt<qe+lt-1;Wt++){const pt=We(Ee*N.getoffsetX(Wt),Se,ze,d,$,ae,ut,De,ft,B,S,pe,me,!1,!1,_e,re,Ie);if(!pt)return H.length-=4*(Wt-qe),{notEnoughRoom:!0};Ft(pt)}Ft(xt.last)}else{if(v&&!d){const Wt=hn(ae.x,ae.y,0,w),pt=De+ut+1,at=new s.pointGeometry(B.getx(pt),B.gety(pt)),yt=hn(at.x,at.y,0,w),Gt=yt[3]>0?yt:Xe(ae,at,Wt,1,w,void 0,_e,re.canonical),Ht=V(gt,nn,(Gt[0]-Wt[0])*de,Gt[1]-Wt[1]);if(_.flipState=Ht&&Ht.needsFlipping?1:2,Ht)return Ht}const xt=We(Ee*N.getoffsetX(qe),Se,ze,d,$,ae,ut,De,ft,B,S,pe,me,!1,!1,_e,re,Ie);if(!xt)return{notEnoughRoom:!0};Ft(xt)}return{}}function Ae(_,c,d,v,w){const{x:S,y:P,z:N}=v.projectTilePoint(_.x,_.y,c);if(!w)return hn(S,P,N,d);const[B,H,W]=w(_);return hn(S+B,P+H,N+W,d)}function Xe(_,c,d,v,w,S,P,N){const B=Ae(_.sub(c)._unit()._add(_),N,w,P,S);return s.sub(B,d,B),s.normalize(B,B),s.scaleAndAdd(B,d,B,v)}function We(_,c,d,v,w,S,P,N,B,H,W,$,ae,pe,de,me,_e,re){const Ie=v?_-c:_+c;let Ee=Ie>0?1:-1,Se=0;v&&(Ee*=-1,Se=Math.PI),Ee<0&&(Se+=Math.PI);let ze=N+P+(Ee>0?0:1)|0,De=w,qe=w,lt=0,ut=0;const gt=Math.abs(Ie),nn=[],ft=[];let Ft=S,xt=Ft;const Wt=()=>Xe(xt,Ft,qe,gt-lt+1,W,ae,me,_e.canonical);for(;lt+ut<=gt;){if(ze+=Ee,ze<N||ze>=B)return null;if(qe=De,xt=Ft,nn.push(qe),pe&&ft.push(xt),Ft=new s.pointGeometry(H.getx(ze),H.gety(ze)),De=$[ze],!De){const An=Ae(Ft,_e.canonical,W,me,ae);De=An[3]>0?$[ze]=An:Wt()}lt+=ut,ut=s.distance(qe,De)}de&&ae&&($[ze]&&(De=Wt(),ut=s.distance(qe,De)),$[ze]=De);const pt=(gt-lt)/ut,at=Ft.sub(xt)._mult(pt)._add(xt),yt=s.sub([],De,qe),Gt=s.scaleAndAdd([],qe,yt,pt);let Ht=[0,0,1],Qn=yt[0],ji=yt[1];if(re&&(Ht=me.upVector(_e.canonical,at.x,at.y),Ht[0]!==0||Ht[1]!==0||Ht[2]!==1)){const An=[Ht[2],0,-Ht[0]],ni=s.cross([],Ht,An);s.normalize(An,An),s.normalize(ni,ni),Qn=s.dot(yt,An),ji=s.dot(yt,ni)}if(d){const An=s.cross([],Ht,yt);s.normalize(An,An),s.scaleAndAdd(Gt,Gt,An,d*Ee)}const Bn=Se+Math.atan2(ji,Qn);return nn.push(Gt),pe&&ft.push(at),{point:Gt,angle:Bn,path:nn,tilePath:ft,up:Ht}}function Qe(_,c){const d=c.length,v=d+4*_;c.resize(v),c.float32.fill(-1/0,4*d,4*v)}function en(_,c,d){const v=c[0],w=c[1];return _[0]=d[0]*v+d[4]*w+d[12],_[1]=d[1]*v+d[5]*w+d[13],_[3]=d[3]*v+d[7]*w+d[15],_}const Qt=100;class Ln{constructor(c,d,v=new am(c.width+200,c.height+200,25),w=new am(c.width+200,c.height+200,25)){this.transform=c,this.grid=v,this.ignoredGrid=w,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+Qt,this.screenBottomBoundary=c.height+Qt,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200,this.fogState=d}placeCollisionBox(c,d,v,w,S,P,N,B){let H=v.projectedAnchorX,W=v.projectedAnchorY,$=v.projectedAnchorZ;const ae=v.elevation,pe=v.tileID,de=c.getProjection();if(ae&&pe){const[De,qe,lt]=de.upVector(pe.canonical,v.tileAnchorX,v.tileAnchorY),ut=de.upVectorScale(pe.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;H+=De*ae*ut,W+=qe*ae*ut,$+=lt*ae*ut}const me=this.projectAndGetPerspectiveRatio(N,H,W,$,v.tileID,de.name==="globe"||!!ae||this.transform.pitch>0,de),_e=P*me.perspectiveRatio,re=(v.x1*d+w.x-v.padding)*_e+me.point.x,Ie=(v.y1*d+w.y-v.padding)*_e+me.point.y,Ee=(v.x2*d+w.x+v.padding)*_e+me.point.x,Se=(v.y2*d+w.y+v.padding)*_e+me.point.y,ze=me.perspectiveRatio<=.55||me.occluded;return!this.isInsideGrid(re,Ie,Ee,Se)||!S&&this.grid.hitTest(re,Ie,Ee,Se,B)||ze?{box:[],offscreen:!1,occluded:me.occluded}:{box:[re,Ie,Ee,Se],offscreen:this.isOffscreen(re,Ie,Ee,Se),occluded:!1}}placeCollisionCircles(c,d,v,w,S,P,N,B,H,W,$,ae,pe,de,me){const _e=[],re=this.transform.elevation,Ie=c.getProjection(),Ee=re?re.getAtTileOffsetFunc(me,this.transform.center.lat,this.transform.worldSize,Ie):null,Se=new s.pointGeometry(v.tileAnchorX,v.tileAnchorY);let{x:ze,y:De,z:qe}=Ie.projectTilePoint(Se.x,Se.y,me.canonical);if(Ee){const[at,yt,Gt]=Ee(Se);ze+=at,De+=yt,qe+=Gt}const lt=Ie.name==="globe",ut=this.projectAndGetPerspectiveRatio(N,ze,De,qe,me,lt||!!re||this.transform.pitch>0,Ie),{perspectiveRatio:gt}=ut,nn=($?P/gt:P*gt)/s.ONE_EM,ft=hn(ze,De,qe,B),Ft=ut.signedDistanceFromCamera>0?D(nn,S,v.lineOffsetX*nn,v.lineOffsetY*nn,!1,ft,Se,v,w,B,{},re&&!$?Ee:null,$&&!!re,Ie,me,$):null;let xt=!1,Wt=!1,pt=!0;if(Ft&&!ut.occluded){const at=.5*pe*gt+de,yt=new s.pointGeometry(-100,-100),Gt=new s.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Ht=new ic,{first:Qn,last:ji}=Ft,Bn=Qn.path.length;let An=[];for(let oi=Bn-1;oi>=1;oi--)An.push(Qn.path[oi]);for(let oi=1;oi<ji.path.length;oi++)An.push(ji.path[oi]);const ni=2.5*at;H&&(An=An.map(([oi,Nr,qr],cs)=>(Ee&&!lt&&(qr=Ee(cs<Bn-1?Qn.tilePath[Bn-1-cs]:ji.tilePath[cs-Bn+2])[2]),hn(oi,Nr,qr,H))),An.some(oi=>oi[3]<=0)&&(An=[]));let ir=[];if(An.length>0){let oi=1/0,Nr=-1/0,qr=1/0,cs=-1/0;for(const Jr of An)oi=Math.min(oi,Jr[0]),qr=Math.min(qr,Jr[1]),Nr=Math.max(Nr,Jr[0]),cs=Math.max(cs,Jr[1]);Nr>=yt.x&&oi<=Gt.x&&cs>=yt.y&&qr<=Gt.y&&(ir=[An.map(Jr=>new s.pointGeometry(Jr[0],Jr[1]))],(oi<yt.x||Nr>Gt.x||qr<yt.y||cs>Gt.y)&&(ir=s.clipLine(ir,yt.x,yt.y,Gt.x,Gt.y)))}for(const oi of ir){Ht.reset(oi,.25*at);let Nr=0;Nr=Ht.length<=.5*at?1:Math.ceil(Ht.paddedLength/ni)+1;for(let qr=0;qr<Nr;qr++){const cs=qr/Math.max(Nr-1,1),Jr=Ht.lerp(cs),uo=Jr.x+Qt,Qa=Jr.y+Qt;_e.push(uo,Qa,at,0);const ru=uo-at,su=Qa-at,bs=uo+at,ts=Qa+at;if(pt=pt&&this.isOffscreen(ru,su,bs,ts),Wt=Wt||this.isInsideGrid(ru,su,bs,ts),!d&&this.grid.hitTestCircle(uo,Qa,at,ae)&&(xt=!0,!W))return{circles:[],offscreen:!1,collisionDetected:xt,occluded:!1}}}}return{circles:!W&&xt||!Wt?[]:_e,offscreen:pt,collisionDetected:xt,occluded:ut.occluded}}queryRenderedSymbols(c){if(c.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[];let v=1/0,w=1/0,S=-1/0,P=-1/0;for(const W of c){const $=new s.pointGeometry(W.x+Qt,W.y+Qt);v=Math.min(v,$.x),w=Math.min(w,$.y),S=Math.max(S,$.x),P=Math.max(P,$.y),d.push($)}const N=this.grid.query(v,w,S,P).concat(this.ignoredGrid.query(v,w,S,P)),B={},H={};for(const W of N){const $=W.key;if(B[$.bucketInstanceId]===void 0&&(B[$.bucketInstanceId]={}),B[$.bucketInstanceId][$.featureIndex])continue;const ae=[new s.pointGeometry(W.x1,W.y1),new s.pointGeometry(W.x2,W.y1),new s.pointGeometry(W.x2,W.y2),new s.pointGeometry(W.x1,W.y2)];s.polygonIntersectsPolygon(d,ae)&&(B[$.bucketInstanceId][$.featureIndex]=!0,H[$.bucketInstanceId]===void 0&&(H[$.bucketInstanceId]=[]),H[$.bucketInstanceId].push($.featureIndex))}return H}insertCollisionBox(c,d,v,w,S){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:w,collisionGroupID:S},c[0],c[1],c[2],c[3])}insertCollisionCircles(c,d,v,w,S){const P=d?this.ignoredGrid:this.grid,N={bucketInstanceId:v,featureIndex:w,collisionGroupID:S};for(let B=0;B<c.length;B+=4)P.insertCircle(N,c[B],c[B+1],c[B+2])}projectAndGetPerspectiveRatio(c,d,v,w,S,P,N){const B=[d,v,w,1];let H=!1;if(w||this.transform.pitch>0){s.transformMat4$1(B,B,c);const $=N.name==="globe";this.fogState&&S&&!$&&(H=function(pe,de,me,_e,re,Ie){const Ee=Ie.calculateFogTileMatrix(re),Se=[de,me,_e];return s.transformMat4(Se,Se,Ee),et(pe,Se,Ie.pitch,Ie._fov)}(this.fogState,d,v,w,S.toUnwrapped(),this.transform)>.9)}else en(B,B,c);const W=B[3];return{point:new s.pointGeometry((B[0]/W+1)/2*this.transform.width+Qt,(-B[1]/W+1)/2*this.transform.height+Qt),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(N)/W*.5,1.5),signedDistanceFromCamera:W,occluded:P&&B[2]>W||H}}isOffscreen(c,d,v,w){return v<Qt||c>=this.screenRightBoundary||w<Qt||d>this.screenBottomBoundary}isInsideGrid(c,d,v,w){return v>=0&&c<this.gridRightBoundary&&w>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const c=s.identity([]);return s.translate(c,c,[-100,-100,0]),c}}function gn(_,c,d){const v=c.createTileMatrix(_,_.worldSize,d.toUnwrapped());return s.multiply(new Float32Array(16),_.projMatrix,v)}function bn(_,c,d){if(c.projection.name===d.projection.name)return _.projMatrix;const v=d.clone();return v.setProjection(c.projection),gn(v,c.getProjection(),_)}function xi(_,c,d){return c.name===d.projection.name?_.projMatrix:gn(d,c,_)}class ls{constructor(c,d,v,w){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?d:-d))):w&&v?1:0,this.placed=v}isHidden(){return this.opacity===0&&!this.placed}}class wi{constructor(c,d,v,w,S,P=!1){this.text=new ls(c?c.text:null,d,v,S),this.icon=new ls(c?c.icon:null,d,w,S),this.clipped=P}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ms{constructor(c,d,v,w=!1){this.text=c,this.icon=d,this.skipFade=v,this.clipped=w}}class jt{constructor(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]}}class On{constructor(c,d,v,w,S){this.bucketInstanceId=c,this.featureIndex=d,this.sourceLayerIndex=v,this.bucketIndex=w,this.tileID=S}}class Ai{constructor(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}}get(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){const d=++this.maxGroupID;this.collisionGroups[c]={ID:d,predicate:v=>v.collisionGroupID===d}}return this.collisionGroups[c]}}function Ys(_,c,d,v,w){const{horizontalAlign:S,verticalAlign:P}=s.getAnchorAlignment(_),N=-(S-.5)*c,B=-(P-.5)*d,H=s.evaluateVariableOffset(_,v);return new s.pointGeometry(N+H[0]*w,B+H[1]*w)}function Ss(_,c,d,v,w){const S=new s.pointGeometry(_,c);return d&&S._rotate(v?w:-w),S}class Go{constructor(c,d,v,w,S){this.transform=c.clone(),this.projection=c.projection.name,this.collisionIndex=new Ln(this.transform,S),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new Ai(v),this.collisionCircleArrays={},this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(c,d,v,w){const S=v.getBucket(d),P=v.latestFeatureIndex;if(!S||!P||d.id!==S.layerIds[0])return;const N=S.layers[0].layout,B=v.collisionBoxArray,H=Math.pow(2,this.transform.zoom-v.tileID.overscaledZ),W=v.tileSize/s.EXTENT,$=v.tileID.toUnwrapped();this.transform.setProjection(S.projection);const ae=(pe=v.tileID,de=S.getProjection(),me=this.transform,de.name===this.projection?me.calculateProjMatrix(pe.toUnwrapped()):gn(me,de,pe));var pe,de,me;const _e=N.get("text-pitch-alignment")==="map",re=N.get("text-rotation-alignment")==="map";d.compileFilter();const Ie=d.dynamicFilter(),Ee=d.dynamicFilterNeedsFeature(),Se=this.transform.calculatePixelsToTileUnitsMatrix(v),ze=cp(ae,v.tileID.canonical,_e,re,this.transform,S.getProjection(),Se);let De=null;if(_e){const ut=rc(ae,v.tileID.canonical,_e,re,this.transform,S.getProjection(),Se);De=s.multiply([],this.transform.labelPlaneMatrix,ut)}let qe=null;Ie&&v.latestFeatureIndex&&(qe={unwrappedTileID:$,dynamicFilter:Ie,dynamicFilterNeedsFeature:Ee,featureIndex:v.latestFeatureIndex}),this.retainedQueryData[S.bucketInstanceId]=new On(S.bucketInstanceId,P,S.sourceLayerIndex,S.index,v.tileID);const lt={bucket:S,layout:N,posMatrix:ae,textLabelPlaneMatrix:ze,labelToScreenMatrix:De,clippingData:qe,scale:H,textPixelRatio:W,holdingForFade:v.holdingForFade(),collisionBoxArray:B,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(S.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:s.evaluateSizeForZoom(S.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(S.sourceID)};if(w)for(const ut of S.sortKeyRanges){const{sortKey:gt,symbolInstanceStart:nn,symbolInstanceEnd:ft}=ut;c.push({sortKey:gt,symbolInstanceStart:nn,symbolInstanceEnd:ft,parameters:lt})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:lt})}attemptAnchorPlacement(c,d,v,w,S,P,N,B,H,W,$,ae,pe,de,me,_e,re,Ie){const{textOffset0:Ee,textOffset1:Se,crossTileID:ze}=ae,De=[Ee,Se],qe=Ys(c,v,w,De,S),lt=this.collisionIndex.placeCollisionBox(de,S,d,Ss(qe.x,qe.y,P,N,this.transform.angle),$,B,H,W.predicate);if(_e){const ut=de.getSymbolInstanceIconSize(Ie,this.transform.zoom,ae.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(de,ut,_e,Ss(qe.x,qe.y,P,N,this.transform.angle),$,B,H,W.predicate).box.length===0)return}if(lt.box.length>0){let ut;return this.prevPlacement&&this.prevPlacement.variableOffsets[ze]&&this.prevPlacement.placements[ze]&&this.prevPlacement.placements[ze].text&&(ut=this.prevPlacement.variableOffsets[ze].anchor),this.variableOffsets[ze]={textOffset:De,width:v,height:w,anchor:c,textScale:S,prevAnchor:ut},this.markUsedJustification(de,c,ae,me),de.allowVerticalPlacement&&(this.markUsedOrientation(de,me,ae),this.placedOrientations[ze]=me),{shift:qe,placedGlyphBoxes:lt}}}placeLayerBucketPart(c,d,v,w){const{bucket:S,layout:P,posMatrix:N,textLabelPlaneMatrix:B,labelToScreenMatrix:H,clippingData:W,textPixelRatio:$,holdingForFade:ae,collisionBoxArray:pe,partiallyEvaluatedTextSize:de,partiallyEvaluatedIconSize:me,collisionGroup:_e}=c.parameters,re=P.get("text-optional"),Ie=P.get("icon-optional"),Ee=P.get("text-allow-overlap"),Se=P.get("icon-allow-overlap"),ze=P.get("text-rotation-alignment")==="map",De=P.get("text-pitch-alignment")==="map",qe=P.get("icon-text-fit")!=="none",lt=P.get("symbol-z-order")==="viewport-y";this.transform.setProjection(S.projection);let ut=Ee&&(Se||!S.hasIconData()||Ie),gt=Se&&(Ee||!S.hasTextData()||re);!S.collisionArrays&&pe&&S.deserializeCollisionBoxes(pe),v&&w&&S.updateCollisionDebugBuffers(this.transform.zoom,pe);const nn=(ft,Ft,xt)=>{const{crossTileID:Wt,numVerticalGlyphVertices:pt}=ft;if(W){const bs={zoom:this.transform.zoom,pitch:this.transform.pitch};let ts=null;if(W.dynamicFilterNeedsFeature){const wr=this.retainedQueryData[S.bucketInstanceId];ts=W.featureIndex.loadFeature({featureIndex:ft.featureIndex,bucketIndex:wr.bucketIndex,sourceLayerIndex:wr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,W.dynamicFilter)(bs,ts,this.retainedQueryData[S.bucketInstanceId].tileID.canonical,new s.pointGeometry(ft.tileAnchorX,ft.tileAnchorY),this.transform.calculateDistanceTileData(W.unwrappedTileID)))return this.placements[Wt]=new ms(!1,!1,!1,!0),void(d[Wt]=!0)}if(d[Wt])return;if(ae)return void(this.placements[Wt]=new ms(!1,!1,!1));let at=!1,yt=!1,Gt=!0,Ht=!1,Qn=!1,ji=null,Bn={box:null,offscreen:null,occluded:null},An={box:null,offscreen:null,occluded:null},ni=null,ir=null,oi=null,Nr=0,qr=0,cs=0;xt.textFeatureIndex?Nr=xt.textFeatureIndex:ft.useRuntimeCollisionCircles&&(Nr=ft.featureIndex),xt.verticalTextFeatureIndex&&(qr=xt.verticalTextFeatureIndex);const Jr=bs=>{bs.tileID=this.retainedQueryData[S.bucketInstanceId].tileID;const ts=this.transform.elevation;(ts||bs.elevation)&&(bs.elevation=ts?ts.getAtTileOffset(bs.tileID,bs.tileAnchorX,bs.tileAnchorY):0)},uo=xt.textBox;if(uo){Jr(uo);const bs=wr=>{let Js=s.WritingMode.horizontal;if(S.allowVerticalPlacement&&!wr&&this.prevPlacement){const fa=this.prevPlacement.placedOrientations[Wt];fa&&(this.placedOrientations[Wt]=fa,Js=fa,this.markUsedOrientation(S,Js,ft))}return Js},ts=(wr,Js)=>{if(S.allowVerticalPlacement&&pt>0&&xt.verticalTextBox){for(const fa of S.writingModes)if(fa===s.WritingMode.vertical?(Bn=Js(),An=Bn):Bn=wr(),Bn&&Bn.box&&Bn.box.length)break}else Bn=wr()};if(P.get("text-variable-anchor")){let wr=P.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Wt]){const _s=this.prevPlacement.variableOffsets[Wt];wr.indexOf(_s.anchor)>0&&(wr=wr.filter(na=>na!==_s.anchor),wr.unshift(_s.anchor))}const Js=(_s,na,da)=>{const _c=S.getSymbolInstanceTextSize(de,ft,this.transform.zoom,Ft),Md=(_s.x2-_s.x1)*_c+2*_s.padding,$a=(_s.y2-_s.y1)*_c+2*_s.padding,Pi=qe&&!Se?na:null;Pi&&Jr(Pi);let Qc={box:[],offscreen:!1,occluded:!1};const Wh=Ee?2*wr.length:wr.length;for(let ou=0;ou<Wh;++ou){const Bf=this.attemptAnchorPlacement(wr[ou%wr.length],_s,Md,$a,_c,ze,De,$,N,_e,ou>=wr.length,ft,Ft,S,da,Pi,de,me);if(Bf&&(Qc=Bf.placedGlyphBoxes,Qc&&Qc.box&&Qc.box.length)){at=!0,ji=Bf.shift;break}}return Qc};ts(()=>Js(uo,xt.iconBox,s.WritingMode.horizontal),()=>{const _s=xt.verticalTextBox;return _s&&Jr(_s),S.allowVerticalPlacement&&!(Bn&&Bn.box&&Bn.box.length)&&pt>0&&_s?Js(_s,xt.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Bn&&(at=Bn.box,Gt=Bn.offscreen,Ht=Bn.occluded);const fa=bs(Bn&&Bn.box);if(!at&&this.prevPlacement){const _s=this.prevPlacement.variableOffsets[Wt];_s&&(this.variableOffsets[Wt]=_s,this.markUsedJustification(S,_s.anchor,ft,fa))}}else{const wr=(Js,fa)=>{const _s=S.getSymbolInstanceTextSize(de,ft,this.transform.zoom,Ft),na=this.collisionIndex.placeCollisionBox(S,_s,Js,new s.pointGeometry(0,0),Ee,$,N,_e.predicate);return na&&na.box&&na.box.length&&(this.markUsedOrientation(S,fa,ft),this.placedOrientations[Wt]=fa),na};ts(()=>wr(uo,s.WritingMode.horizontal),()=>{const Js=xt.verticalTextBox;return S.allowVerticalPlacement&&pt>0&&Js?(Jr(Js),wr(Js,s.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),bs(Bn&&Bn.box&&Bn.box.length)}}if(ni=Bn,at=ni&&ni.box&&ni.box.length>0,Gt=ni&&ni.offscreen,Ht=ni&&ni.occluded,ft.useRuntimeCollisionCircles){const bs=S.text.placedSymbolArray.get(ft.centerJustifiedTextSymbolIndex>=0?ft.centerJustifiedTextSymbolIndex:ft.verticalPlacedTextSymbolIndex),ts=s.evaluateSizeForFeature(S.textSizeData,de,bs),wr=P.get("text-padding");ir=this.collisionIndex.placeCollisionCircles(S,Ee,bs,S.lineVertexArray,S.glyphOffsetArray,ts,N,B,H,v,De,_e.predicate,ft.collisionCircleDiameter*ts/s.ONE_EM,wr,this.retainedQueryData[S.bucketInstanceId].tileID),at=Ee||ir.circles.length>0&&!ir.collisionDetected,Gt=Gt&&ir.offscreen,Ht=ir.occluded}if(xt.iconFeatureIndex&&(cs=xt.iconFeatureIndex),xt.iconBox){const bs=ts=>{Jr(ts);const wr=qe&&ji?Ss(ji.x,ji.y,ze,De,this.transform.angle):new s.pointGeometry(0,0),Js=S.getSymbolInstanceIconSize(me,this.transform.zoom,ft.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(S,Js,ts,wr,Se,$,N,_e.predicate)};An&&An.box&&An.box.length&&xt.verticalIconBox?(oi=bs(xt.verticalIconBox),yt=oi.box.length>0):(oi=bs(xt.iconBox),yt=oi.box.length>0),Gt=Gt&&oi.offscreen,Qn=oi.occluded}const Qa=re||ft.numHorizontalGlyphVertices===0&&pt===0,ru=Ie||ft.numIconVertices===0;if(Qa||ru?ru?Qa||(yt=yt&&at):at=yt&&at:yt=at=yt&&at,at&&ni&&ni.box&&this.collisionIndex.insertCollisionBox(ni.box,P.get("text-ignore-placement"),S.bucketInstanceId,An&&An.box&&qr?qr:Nr,_e.ID),yt&&oi&&this.collisionIndex.insertCollisionBox(oi.box,P.get("icon-ignore-placement"),S.bucketInstanceId,cs,_e.ID),ir&&(at&&this.collisionIndex.insertCollisionCircles(ir.circles,P.get("text-ignore-placement"),S.bucketInstanceId,Nr,_e.ID),v)){const bs=S.bucketInstanceId;let ts=this.collisionCircleArrays[bs];ts===void 0&&(ts=this.collisionCircleArrays[bs]=new jt);for(let wr=0;wr<ir.circles.length;wr+=4)ts.circles.push(ir.circles[wr+0]),ts.circles.push(ir.circles[wr+1]),ts.circles.push(ir.circles[wr+2]),ts.circles.push(ir.collisionDetected?1:0)}const su=S.projection.name!=="globe";ut=ut&&(su||!Ht),gt=gt&&(su||!Qn),this.placements[Wt]=new ms(at||ut,yt||gt,Gt||S.justReloaded),d[Wt]=!0};if(lt){const ft=S.getSortedSymbolIndexes(this.transform.angle);for(let Ft=ft.length-1;Ft>=0;--Ft){const xt=ft[Ft];nn(S.symbolInstances.get(xt),xt,S.collisionArrays[xt])}}else for(let ft=c.symbolInstanceStart;ft<c.symbolInstanceEnd;ft++)nn(S.symbolInstances.get(ft),ft,S.collisionArrays[ft]);if(v&&S.bucketInstanceId in this.collisionCircleArrays){const ft=this.collisionCircleArrays[S.bucketInstanceId];s.invert(ft.invProjMatrix,N),ft.viewportMatrix=this.collisionIndex.getViewportMatrix()}S.justReloaded=!1}markUsedJustification(c,d,v,w){const{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:P,rightJustifiedTextSymbolIndex:N,verticalPlacedTextSymbolIndex:B,crossTileID:H}=v,W=s.getAnchorJustification(d),$=w===s.WritingMode.vertical?B:W==="left"?S:W==="center"?P:W==="right"?N:-1;S>=0&&(c.text.placedSymbolArray.get(S).crossTileID=$>=0&&S!==$?0:H),P>=0&&(c.text.placedSymbolArray.get(P).crossTileID=$>=0&&P!==$?0:H),N>=0&&(c.text.placedSymbolArray.get(N).crossTileID=$>=0&&N!==$?0:H),B>=0&&(c.text.placedSymbolArray.get(B).crossTileID=$>=0&&B!==$?0:H)}markUsedOrientation(c,d,v){const w=d===s.WritingMode.horizontal||d===s.WritingMode.horizontalOnly?d:0,S=d===s.WritingMode.vertical?d:0,{leftJustifiedTextSymbolIndex:P,centerJustifiedTextSymbolIndex:N,rightJustifiedTextSymbolIndex:B,verticalPlacedTextSymbolIndex:H}=v,W=c.text.placedSymbolArray;P>=0&&(W.get(P).placedOrientation=w),N>=0&&(W.get(N).placedOrientation=w),B>=0&&(W.get(B).placedOrientation=w),H>=0&&(W.get(H).placedOrientation=S)}commit(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let v=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const w=d?d.symbolFadeChange(c):1,S=d?d.opacities:{},P=d?d.variableOffsets:{},N=d?d.placedOrientations:{};for(const B in this.placements){const H=this.placements[B],W=S[B];W?(this.opacities[B]=new wi(W,w,H.text,H.icon,null,H.clipped),v=v||H.text!==W.text.placed||H.icon!==W.icon.placed):(this.opacities[B]=new wi(null,w,H.text,H.icon,H.skipFade,H.clipped),v=v||H.text||H.icon)}for(const B in S){const H=S[B];if(!this.opacities[B]){const W=new wi(H,w,!1,!1);W.isHidden()||(this.opacities[B]=W,v=v||H.text.placed||H.icon.placed)}}for(const B in P)this.variableOffsets[B]||!this.opacities[B]||this.opacities[B].isHidden()||(this.variableOffsets[B]=P[B]);for(const B in N)this.placedOrientations[B]||!this.opacities[B]||this.opacities[B].isHidden()||(this.placedOrientations[B]=N[B]);v?this.lastPlacementChangeTime=c:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:c)}updateLayerOpacities(c,d){const v={};for(const w of d){const S=w.getBucket(c);S&&w.latestFeatureIndex&&c.id===S.layerIds[0]&&this.updateBucketOpacities(S,v,w.collisionBoxArray)}}updateBucketOpacities(c,d,v){c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();const w=c.layers[0].layout,S=!!c.layers[0].dynamicFilter(),P=new wi(null,0,!1,!1,!0),N=w.get("text-allow-overlap"),B=w.get("icon-allow-overlap"),H=w.get("text-variable-anchor"),W=w.get("text-rotation-alignment")==="map",$=w.get("text-pitch-alignment")==="map",ae=w.get("icon-text-fit")!=="none",pe=new wi(null,0,N&&(B||!c.hasIconData()||w.get("icon-optional")),B&&(N||!c.hasTextData()||w.get("text-optional")),!0);!c.collisionArrays&&v&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(v);const de=(_e,re,Ie)=>{for(let Ee=0;Ee<re/4;Ee++)_e.opacityVertexArray.emplaceBack(Ie)};let me=0;for(let _e=0;_e<c.symbolInstances.length;_e++){const re=c.symbolInstances.get(_e),{numHorizontalGlyphVertices:Ie,numVerticalGlyphVertices:Ee,crossTileID:Se,numIconVertices:ze}=re;let De=this.opacities[Se];d[Se]?De=P:De||(De=pe,this.opacities[Se]=De),d[Se]=!0;const qe=Ie>0||Ee>0,lt=ze>0,ut=this.placedOrientations[Se],gt=ut===s.WritingMode.vertical,nn=ut===s.WritingMode.horizontal||ut===s.WritingMode.horizontalOnly;if(!qe&&!lt||De.isHidden()||me++,qe){const ft=Ch(De.text);de(c.text,Ie,gt?jc:ft),de(c.text,Ee,nn?jc:ft);const Ft=De.text.isHidden(),{leftJustifiedTextSymbolIndex:xt,centerJustifiedTextSymbolIndex:Wt,rightJustifiedTextSymbolIndex:pt,verticalPlacedTextSymbolIndex:at}=re,yt=c.text.placedSymbolArray,Gt=Ft||gt?1:0;xt>=0&&(yt.get(xt).hidden=Gt),Wt>=0&&(yt.get(Wt).hidden=Gt),pt>=0&&(yt.get(pt).hidden=Gt),at>=0&&(yt.get(at).hidden=Ft||nn?1:0);const Ht=this.variableOffsets[Se];Ht&&this.markUsedJustification(c,Ht.anchor,re,ut);const Qn=this.placedOrientations[Se];Qn&&(this.markUsedJustification(c,"left",re,Qn),this.markUsedOrientation(c,Qn,re))}if(lt){const ft=Ch(De.icon),{placedIconSymbolIndex:Ft,verticalPlacedIconSymbolIndex:xt}=re,Wt=c.icon.placedSymbolArray,pt=De.icon.isHidden()?1:0;Ft>=0&&(de(c.icon,ze,gt?jc:ft),Wt.get(Ft).hidden=pt),xt>=0&&(de(c.icon,re.numVerticalIconVertices,nn?jc:ft),Wt.get(xt).hidden=pt)}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){const ft=c.collisionArrays[_e];if(ft){let Ft=new s.pointGeometry(0,0),xt=!0;if(ft.textBox||ft.verticalTextBox){if(H){const pt=this.variableOffsets[Se];pt?(Ft=Ys(pt.anchor,pt.width,pt.height,pt.textOffset,pt.textScale),W&&Ft._rotate($?this.transform.angle:-this.transform.angle)):xt=!1}S&&(xt=!De.clipped),ft.textBox&&ua(c.textCollisionBox.collisionVertexArray,De.text.placed,!xt||gt,Ft.x,Ft.y),ft.verticalTextBox&&ua(c.textCollisionBox.collisionVertexArray,De.text.placed,!xt||nn,Ft.x,Ft.y)}const Wt=xt&&!!(!nn&&ft.verticalIconBox);ft.iconBox&&ua(c.iconCollisionBox.collisionVertexArray,De.icon.placed,Wt,ae?Ft.x:0,ae?Ft.y:0),ft.verticalIconBox&&ua(c.iconCollisionBox.collisionVertexArray,De.icon.placed,!Wt,ae?Ft.x:0,ae?Ft.y:0)}}}if(c.fullyClipped=me===0,c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.bucketInstanceId in this.collisionCircleArrays){const _e=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=_e.invProjMatrix,c.placementViewportMatrix=_e.viewportMatrix,c.collisionCircleArray=_e.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}}symbolFadeChange(c){return this.fadeDuration===0?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(c){return Math.max(0,(this.transform.zoom-c)/1.5)}hasTransitions(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(c,d){const v=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*v>c}setStale(){this.stale=!0}}function ua(_,c,d,v,w){_.emplaceBack(c?1:0,d?1:0,v||0,w||0),_.emplaceBack(c?1:0,d?1:0,v||0,w||0),_.emplaceBack(c?1:0,d?1:0,v||0,w||0),_.emplaceBack(c?1:0,d?1:0,v||0,w||0)}const gs=Math.pow(2,25),Sf=Math.pow(2,24),so=Math.pow(2,17),ca=Math.pow(2,16),gd=Math.pow(2,9),Sh=Math.pow(2,8),Lo=Math.pow(2,1);function Ch(_){if(_.opacity===0&&!_.placed)return 0;if(_.opacity===1&&_.placed)return 4294967295;const c=_.placed?1:0,d=Math.floor(127*_.opacity);return d*gs+c*Sf+d*so+c*ca+d*gd+c*Sh+d*Lo+c}const jc=0;class Pr{constructor(c){this._sortAcrossTiles=c.layout.get("symbol-z-order")!=="viewport-y"&&c.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(c,d,v,w,S){const P=this._bucketParts;for(;this._currentTileIndex<c.length;)if(d.getBucketParts(P,w,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort((N,B)=>N.sortKey-B.sortKey));this._currentPartIndex<P.length;){const N=P[this._currentPartIndex];if(d.placeLayerBucketPart(N,this._seenCrossTileIDs,v,N.symbolInstanceStart===0),this._currentPartIndex++,S())return!0}return!1}}class Kr{constructor(c,d,v,w,S,P,N,B){this.placement=new Go(c,S,P,N,B),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(c,d,v){const w=s.exported.now(),S=()=>{const P=s.exported.now()-w;return!this._forceFullPlacement&&P>2};for(;this._currentPlacementIndex>=0;){const P=d[c[this._currentPlacementIndex]],N=this.placement.collisionIndex.transform.zoom;if(P.type==="symbol"&&(!P.minzoom||P.minzoom<=N)&&(!P.maxzoom||P.maxzoom>N)){if(this._inProgressLayer||(this._inProgressLayer=new Pr(P)),this._inProgressLayer.continuePlacement(v[P.source],this.placement,this._showCollisionBoxes,P,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(c){return this.placement.commit(c),this.placement}}const _d=512/s.EXTENT/2;class pg{constructor(c,d,v){this.tileID=c,this.indexedSymbolInstances={},this.bucketInstanceId=v;for(let w=0;w<d.length;w++){const S=d.get(w),P=S.key;this.indexedSymbolInstances[P]||(this.indexedSymbolInstances[P]=[]),this.indexedSymbolInstances[P].push({crossTileID:S.crossTileID,coord:this.getScaledCoordinates(S,c)})}}getScaledCoordinates(c,d){const v=_d/Math.pow(2,d.canonical.z-this.tileID.canonical.z);return{x:Math.floor((d.canonical.x*s.EXTENT+c.tileAnchorX)*v),y:Math.floor((d.canonical.y*s.EXTENT+c.tileAnchorY)*v)}}findMatches(c,d,v){const w=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z);for(let S=0;S<c.length;S++){const P=c.get(S);if(P.crossTileID)continue;const N=this.indexedSymbolInstances[P.key];if(!N)continue;const B=this.getScaledCoordinates(P,d);for(const H of N)if(Math.abs(H.coord.x-B.x)<=w&&Math.abs(H.coord.y-B.y)<=w&&!v[H.crossTileID]){v[H.crossTileID]=!0,P.crossTileID=H.crossTileID;break}}}}class yd{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class qc{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(c){const d=Math.round((c-this.lng)/360);if(d!==0)for(const v in this.indexes){const w=this.indexes[v],S={};for(const P in w){const N=w[P];N.tileID=N.tileID.unwrapTo(N.tileID.wrap+d),S[N.tileID.key]=N}this.indexes[v]=S}this.lng=c}addBucket(c,d,v){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(let S=0;S<d.symbolInstances.length;S++)d.symbolInstances.get(S).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]={});const w=this.usedCrossTileIDs[c.overscaledZ];for(const S in this.indexes){const P=this.indexes[S];if(Number(S)>c.overscaledZ)for(const N in P){const B=P[N];B.tileID.isChildOf(c)&&B.findMatches(d.symbolInstances,c,w)}else{const N=P[c.scaledTo(Number(S)).key];N&&N.findMatches(d.symbolInstances,c,w)}}for(let S=0;S<d.symbolInstances.length;S++){const P=d.symbolInstances.get(S);P.crossTileID||(P.crossTileID=v.generate(),w[P.crossTileID]=!0)}return this.indexes[c.overscaledZ]===void 0&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new pg(c,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(c,d){for(const v in d.indexedSymbolInstances)for(const w of d.indexedSymbolInstances[v])delete this.usedCrossTileIDs[c][w.crossTileID]}removeStaleBuckets(c){let d=!1;for(const v in this.indexes){const w=this.indexes[v];for(const S in w)c[w[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(v,w[S]),delete w[S],d=!0)}return d}}class hp{constructor(){this.layerIndexes={},this.crossTileIDs=new yd,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(c,d,v,w){let S=this.layerIndexes[c.id];S===void 0&&(S=this.layerIndexes[c.id]=new qc);let P=!1;const N={};w.name!=="globe"&&S.handleWrapJump(v);for(const B of d){const H=B.getBucket(c);H&&c.id===H.layerIds[0]&&(H.bucketInstanceId||(H.bucketInstanceId=++this.maxBucketInstanceId),S.addBucket(B.tileID,H,this.crossTileIDs)&&(P=!0),N[H.bucketInstanceId]=!0)}return S.removeStaleBuckets(N)&&(P=!0),P}pruneUnusedLayers(c){const d={};c.forEach(v=>{d[v]=!0});for(const v in this.layerIndexes)d[v]||delete this.layerIndexes[v]}}const Cf=(_,c)=>s.emitValidationErrors(_,c&&c.filter(d=>d.identifier!=="source.canvas")),Hc=s.pick(ui,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),kl=s.pick(ui,["setCenter","setZoom","setBearing","setPitch"]),Us={version:8,layers:[],sources:{}},Fl={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class us extends s.Evented{constructor(c,d={}){super(),this.map=c,this.dispatcher=new zn(je(),this),this.imageManager=new Ue,this.imageManager.setEventedParent(this),this.glyphManager=new s.GlyphManager(c._requestManager,d.localFontFamily?s.LocalGlyphMode.all:d.localIdeographFontFamily?s.LocalGlyphMode.ideographs:s.LocalGlyphMode.none,d.localFontFamily||d.localIdeographFontFamily),this.crossTileSymbolIndex=new hp,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());const v=this;this._rtlTextPluginCallback=us.registerForPluginStateChange(w=>{v.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:w.pluginStatus,pluginURL:w.pluginURL},(S,P)=>{if(s.triggerPluginCompletionEvent(S),P&&P.every(N=>N))for(const N in v._sourceCaches){const B=v._sourceCaches[N],H=B.getSource().type;H!=="vector"&&H!=="geojson"||B.reload()}})}),this.on("data",w=>{if(w.dataType!=="source"||w.sourceDataType!=="metadata")return;const S=this.getSource(w.sourceId);if(S&&S.vectorLayerIds)for(const P in this._layers){const N=this._layers[P];N.source===S.id&&this._validateLayer(N)}})}loadURL(c,d={}){this.fire(new s.Event("dataloading",{dataType:"style"}));const v=typeof d.validate=="boolean"?d.validate:!s.isMapboxURL(c);c=this.map._requestManager.normalizeStyleURL(c,d.accessToken);const w=this.map._requestManager.transformRequest(c,s.ResourceType.Style);this._request=s.getJSON(w,(S,P)=>{this._request=null,S?this.fire(new s.ErrorEvent(S)):P&&this._load(P,v)})}loadJSON(c,d={}){this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.exported.frame(()=>{this._request=null,this._load(c,d.validate!==!1)})}loadEmpty(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(Us,!1)}_updateLayerCount(c,d){const v=d?1:-1;c.is3D()&&(this._num3DLayers+=v),c.type==="circle"&&(this._numCircleLayers+=v),c.type==="symbol"&&(this._numSymbolLayers+=v)}_load(c,d){if(d&&Cf(this,s.validateStyle(c)))return;this._loaded=!0,this.stylesheet=s.clone$1(c),this._updateMapProjection();for(const w in c.sources)this.addSource(w,c.sources[w],{validate:!1});this._changed=!1,c.sprite?this._loadSprite(c.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(c.glyphs);const v=ar(this.stylesheet.layers);this._order=v.map(w=>w.id),this._layers={},this._serializedLayers={};for(let w of v)w=s.createStyleLayer(w),w.setEventedParent(this,{layer:{id:w.id}}),this._layers[w.id]=w,this._serializedLayers[w.id]=w.serialize(),this._updateLayerCount(w,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Le(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(c){c?this.stylesheet.projection=c:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(c){this._spriteRequest=function(d,v,w){let S,P,N;const B=s.exported.devicePixelRatio>1?"@2x":"";let H=s.getJSON(v.transformRequest(v.normalizeSpriteURL(d,B,".json"),s.ResourceType.SpriteJSON),(ae,pe)=>{H=null,N||(N=ae,S=pe,$())}),W=s.getImage(v.transformRequest(v.normalizeSpriteURL(d,B,".png"),s.ResourceType.SpriteImage),(ae,pe)=>{W=null,N||(N=ae,P=pe,$())});function $(){if(N)w(N);else if(S&&P){const ae=s.exported.getImageData(P),pe={};for(const de in S){const{width:me,height:_e,x:re,y:Ie,sdf:Ee,pixelRatio:Se,stretchX:ze,stretchY:De,content:qe}=S[de],lt=new s.RGBAImage({width:me,height:_e});s.RGBAImage.copy(ae,lt,{x:re,y:Ie},{x:0,y:0},{width:me,height:_e}),pe[de]={data:lt,pixelRatio:Se,sdf:Ee,stretchX:ze,stretchY:De,content:qe}}w(null,pe)}}return{cancel(){H&&(H.cancel(),H=null),W&&(W.cancel(),W=null)}}}(c,this.map._requestManager,(d,v)=>{if(this._spriteRequest=null,d)this.fire(new s.ErrorEvent(d));else if(v)for(const w in v)this.imageManager.addImage(w,v[w]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new s.Event("data",{dataType:"style"}))})}_validateLayer(c){const d=this.getSource(c.source);if(!d)return;const v=c.sourceLayer;v&&(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(v)===-1)&&this.fire(new s.ErrorEvent(new Error(`Source layer "${v}" does not exist on source "${d.id}" as specified by style layer "${c.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const c in this._sourceCaches)if(!this._sourceCaches[c].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(c){const d=[];for(const v of c){const w=this._layers[v];w.type!=="custom"&&d.push(w.serialize())}return d}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const c in this._sourceCaches)if(this._sourceCaches[c].hasTransition())return!0;for(const c in this._layers)if(this._layers[c].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(c){return!!this.terrain&&(typeof c.isLayerDraped=="function"?c.isLayerDraped():Fl[c.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(c){if(!this._loaded)return;const d=this._changed;if(this._changed){const w=Object.keys(this._updatedLayers),S=Object.keys(this._removedLayers);(w.length||S.length)&&this._updateWorkerLayers(w,S);for(const P in this._updatedSources){const N=this._updatedSources[P];N==="reload"?this._reloadSource(P):N==="clear"&&this._clearSource(P)}this._updateTilesForChangedImages();for(const P in this._updatedPaintProps)this._layers[P].updateTransitions(c);this.light.updateTransitions(c),this.fog&&this.fog.updateTransitions(c),this._resetUpdates()}const v={};for(const w in this._sourceCaches){const S=this._sourceCaches[w];v[w]=S.used,S.used=!1}for(const w of this._order){const S=this._layers[w];if(S.recalculate(c,this._availableImages),!S.isHidden(c.zoom)){const N=this._getLayerSourceCache(S);N&&(N.used=!0)}const P=this.map.painter;if(P){const N=S.getProgramIds();if(!N)continue;const B=S.getProgramConfiguration(c.zoom);for(const H of N)P.useProgram(H,B)}}for(const w in v){const S=this._sourceCaches[w];v[w]!==S.used&&S.getSource().fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:S.getSource().id}))}this.light.recalculate(c),this.terrain&&this.terrain.recalculate(c),this.fog&&this.fog.recalculate(c),this.z=c.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),d&&this.fire(new s.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const c=Object.keys(this._changedImages);if(c.length){for(const d in this._sourceCaches)this._sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],c);this._changedImages={}}}_updateWorkerLayers(c,d){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(c),removedIds:d})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(c){if(this._checkLoaded(),Cf(this,s.validateStyle(c)))return!1;(c=s.clone$1(c)).layers=ar(c.layers);const d=function(w,S){if(!w)return[{command:ui.setStyle,args:[S]}];let P=[];try{if(!p(w.version,S.version))return[{command:ui.setStyle,args:[S]}];p(w.center,S.center)||P.push({command:ui.setCenter,args:[S.center]}),p(w.zoom,S.zoom)||P.push({command:ui.setZoom,args:[S.zoom]}),p(w.bearing,S.bearing)||P.push({command:ui.setBearing,args:[S.bearing]}),p(w.pitch,S.pitch)||P.push({command:ui.setPitch,args:[S.pitch]}),p(w.sprite,S.sprite)||P.push({command:ui.setSprite,args:[S.sprite]}),p(w.glyphs,S.glyphs)||P.push({command:ui.setGlyphs,args:[S.glyphs]}),p(w.transition,S.transition)||P.push({command:ui.setTransition,args:[S.transition]}),p(w.light,S.light)||P.push({command:ui.setLight,args:[S.light]}),p(w.fog,S.fog)||P.push({command:ui.setFog,args:[S.fog]}),p(w.projection,S.projection)||P.push({command:ui.setProjection,args:[S.projection]});const N={},B=[];(function($,ae,pe,de){let me;for(me in ae=ae||{},$=$||{})$.hasOwnProperty(me)&&(ae.hasOwnProperty(me)||nr(me,pe,de));for(me in ae)ae.hasOwnProperty(me)&&($.hasOwnProperty(me)?p($[me],ae[me])||($[me].type==="geojson"&&ae[me].type==="geojson"&&la($,ae,me)?pe.push({command:ui.setGeoJSONSourceData,args:[me,ae[me].data]}):Dl(me,ae,pe,de)):Qi(me,ae,pe))})(w.sources,S.sources,B,N);const H=[];w.layers&&w.layers.forEach($=>{$.source&&N[$.source]?P.push({command:ui.removeLayer,args:[$.id]}):H.push($)});let W=w.terrain;W&&N[W.source]&&(P.push({command:ui.setTerrain,args:[void 0]}),W=void 0),P=P.concat(B),p(W,S.terrain)||P.push({command:ui.setTerrain,args:[S.terrain]}),function($,ae,pe){ae=ae||[];const de=($=$||[]).map(Ol),me=ae.map(Ol),_e=$.reduce(zs,{}),re=ae.reduce(zs,{}),Ie=de.slice(),Ee=Object.create(null);let Se,ze,De,qe,lt,ut,gt;for(Se=0,ze=0;Se<de.length;Se++)De=de[Se],re.hasOwnProperty(De)?ze++:(pe.push({command:ui.removeLayer,args:[De]}),Ie.splice(Ie.indexOf(De,ze),1));for(Se=0,ze=0;Se<me.length;Se++)De=me[me.length-1-Se],Ie[Ie.length-1-Se]!==De&&(_e.hasOwnProperty(De)?(pe.push({command:ui.removeLayer,args:[De]}),Ie.splice(Ie.lastIndexOf(De,Ie.length-ze),1)):ze++,ut=Ie[Ie.length-Se],pe.push({command:ui.addLayer,args:[re[De],ut]}),Ie.splice(Ie.length-Se,0,De),Ee[De]=!0);for(Se=0;Se<me.length;Se++)if(De=me[Se],qe=_e[De],lt=re[De],!Ee[De]&&!p(qe,lt))if(p(qe.source,lt.source)&&p(qe["source-layer"],lt["source-layer"])&&p(qe.type,lt.type)){for(gt in wt(qe.layout,lt.layout,pe,De,null,ui.setLayoutProperty),wt(qe.paint,lt.paint,pe,De,null,ui.setPaintProperty),p(qe.filter,lt.filter)||pe.push({command:ui.setFilter,args:[De,lt.filter]}),p(qe.minzoom,lt.minzoom)&&p(qe.maxzoom,lt.maxzoom)||pe.push({command:ui.setLayerZoomRange,args:[De,lt.minzoom,lt.maxzoom]}),qe)qe.hasOwnProperty(gt)&&gt!=="layout"&&gt!=="paint"&&gt!=="filter"&&gt!=="metadata"&&gt!=="minzoom"&&gt!=="maxzoom"&&(gt.indexOf("paint.")===0?wt(qe[gt],lt[gt],pe,De,gt.slice(6),ui.setPaintProperty):p(qe[gt],lt[gt])||pe.push({command:ui.setLayerProperty,args:[De,gt,lt[gt]]}));for(gt in lt)lt.hasOwnProperty(gt)&&!qe.hasOwnProperty(gt)&&gt!=="layout"&&gt!=="paint"&&gt!=="filter"&&gt!=="metadata"&&gt!=="minzoom"&&gt!=="maxzoom"&&(gt.indexOf("paint.")===0?wt(qe[gt],lt[gt],pe,De,gt.slice(6),ui.setPaintProperty):p(qe[gt],lt[gt])||pe.push({command:ui.setLayerProperty,args:[De,gt,lt[gt]]}))}else pe.push({command:ui.removeLayer,args:[De]}),ut=Ie[Ie.lastIndexOf(De)+1],pe.push({command:ui.addLayer,args:[lt,ut]})}(H,S.layers,P)}catch(N){console.warn("Unable to compute style diff:",N),P=[{command:ui.setStyle,args:[S]}]}return P}(this.serialize(),c).filter(w=>!(w.command in kl));if(d.length===0)return!1;const v=d.filter(w=>!(w.command in Hc));if(v.length>0)throw new Error(`Unimplemented: ${v.map(w=>w.command).join(", ")}.`);return d.forEach(w=>{w.command!=="setTransition"&&w.command!=="setProjection"&&this[w.command].apply(this,w.args)}),this.stylesheet=c,this._updateMapProjection(),!0}addImage(c,d){return this.getImage(c)?this.fire(new s.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(c,d),this._afterImageUpdated(c),this)}updateImage(c,d){this.imageManager.updateImage(c,d)}getImage(c){return this.imageManager.getImage(c)}removeImage(c){return this.getImage(c)?(this.imageManager.removeImage(c),this._afterImageUpdated(c),this):this.fire(new s.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(c){this._availableImages=this.imageManager.listImages(),this._changedImages[c]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(c,d,v={}){if(this._checkLoaded(),this.getSource(c)!==void 0)throw new Error("There is already a source with this ID");if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(s.validateSource,`sources.${c}`,d,null,v))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const w=tt(c,d,this.dispatcher,this);w.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(c),source:w.serialize(),sourceId:c}));const S=P=>{const N=(P?"symbol:":"other:")+c,B=this._sourceCaches[N]=new s.SourceCache(N,w,P);(P?this._symbolSourceCaches:this._otherSourceCaches)[c]=B,B.style=this,B.onAdd(this.map)};S(!1),d.type!=="vector"&&d.type!=="geojson"||S(!0),w.onAdd&&w.onAdd(this.map),this._changed=!0}removeSource(c){this._checkLoaded();const d=this.getSource(c);if(!d)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===c)return this.fire(new s.ErrorEvent(new Error(`Source "${c}" cannot be removed while layer "${w}" is using it.`)));if(this.terrain&&this.terrain.get().source===c)return this.fire(new s.ErrorEvent(new Error(`Source "${c}" cannot be removed while terrain is using it.`)));const v=this._getSourceCaches(c);for(const w of v)delete this._sourceCaches[w.id],delete this._updatedSources[w.id],w.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:w.getSource().id})),w.setEventedParent(null),w.clearTiles();return delete this._otherSourceCaches[c],delete this._symbolSourceCaches[c],d.setEventedParent(null),d.onRemove&&d.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(c,d){this._checkLoaded(),this.getSource(c).setData(d),this._changed=!0}getSource(c){const d=this._getSourceCache(c);return d&&d.getSource()}_getSources(){const c=[];for(const d in this._otherSourceCaches){const v=this._getSourceCache(d);v&&c.push(v.getSource())}return c}addLayer(c,d,v={}){this._checkLoaded();const w=c.id;if(this.getLayer(w))return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${w}" already exists on this map`)));let S;if(c.type==="custom"){if(Cf(this,s.validateCustomStyleLayer(c)))return;S=s.createStyleLayer(c)}else{if(typeof c.source=="object"&&(this.addSource(w,c.source),c=s.clone$1(c),c=s.extend(c,{source:w})),this._validate(s.validateLayer,`layers.${w}`,c,{arrayIndex:-1},v))return;S=s.createStyleLayer(c),this._validateLayer(S),S.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[S.id]=S.serialize(),this._updateLayerCount(S,!0)}const P=d?this._order.indexOf(d):this._order.length;if(d&&P===-1)return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${d}" does not exist on this map.`)));this._order.splice(P,0,w),this._layerOrderChanged=!0,this._layers[w]=S;const N=this._getLayerSourceCache(S);if(this._removedLayers[w]&&S.source&&N&&S.type!=="custom"){const B=this._removedLayers[w];delete this._removedLayers[w],B.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",N.pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(c,d){if(this._checkLoaded(),this._changed=!0,!this._layers[c])return void this.fire(new s.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be moved.`)));if(c===d)return;const v=this._order.indexOf(c);this._order.splice(v,1);const w=d?this._order.indexOf(d):this._order.length;d&&w===-1?this.fire(new s.ErrorEvent(new Error(`Layer with id "${d}" does not exist on this map.`))):(this._order.splice(w,0,c),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(c){this._checkLoaded();const d=this._layers[c];if(!d)return void this.fire(new s.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be removed.`)));d.setEventedParent(null),this._updateLayerCount(d,!1);const v=this._order.indexOf(c);this._order.splice(v,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[c]=d,delete this._layers[c],delete this._serializedLayers[c],delete this._updatedLayers[c],delete this._updatedPaintProps[c],d.onRemove&&d.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(c){return this._layers[c]}hasLayer(c){return c in this._layers}hasLayerType(c){for(const d in this._layers)if(this._layers[d].type===c)return!0;return!1}setLayerZoomRange(c,d,v){this._checkLoaded();const w=this.getLayer(c);w?w.minzoom===d&&w.maxzoom===v||(d!=null&&(w.minzoom=d),v!=null&&(w.maxzoom=v),this._updateLayer(w)):this.fire(new s.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(c,d,v={}){this._checkLoaded();const w=this.getLayer(c);if(w){if(!p(w.filter,d))return d==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(s.validateFilter,`layers.${w.id}.filter`,d,{layerType:w.type},v)||(w.filter=s.clone$1(d),this._updateLayer(w)))}else this.fire(new s.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be filtered.`)))}getFilter(c){const d=this.getLayer(c);return d&&s.clone$1(d.filter)}setLayoutProperty(c,d,v,w={}){this._checkLoaded();const S=this.getLayer(c);S?p(S.getLayoutProperty(d),v)||(S.setLayoutProperty(d,v,w),this._updateLayer(S)):this.fire(new s.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(c,d){const v=this.getLayer(c);if(v)return v.getLayoutProperty(d);this.fire(new s.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style.`)))}setPaintProperty(c,d,v,w={}){this._checkLoaded();const S=this.getLayer(c);S?p(S.getPaintProperty(d),v)||(S.setPaintProperty(d,v,w)&&this._updateLayer(S),this._changed=!0,this._updatedPaintProps[c]=!0):this.fire(new s.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(c,d){const v=this.getLayer(c);return v&&v.getPaintProperty(d)}setFeatureState(c,d){this._checkLoaded();const v=c.source,w=c.sourceLayer,S=this.getSource(v);if(!S)return void this.fire(new s.ErrorEvent(new Error(`The source '${v}' does not exist in the map's style.`)));const P=S.type;if(P==="geojson"&&w)return void this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(P==="vector"&&!w)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));c.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided.")));const N=this._getSourceCaches(v);for(const B of N)B.setFeatureState(w,c.id,d)}removeFeatureState(c,d){this._checkLoaded();const v=c.source,w=this.getSource(v);if(!w)return void this.fire(new s.ErrorEvent(new Error(`The source '${v}' does not exist in the map's style.`)));const S=w.type,P=S==="vector"?c.sourceLayer:void 0;if(S==="vector"&&!P)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(d&&typeof c.id!="string"&&typeof c.id!="number")return void this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const N=this._getSourceCaches(v);for(const B of N)B.removeFeatureState(P,c.id,d)}getFeatureState(c){this._checkLoaded();const d=c.source,v=c.sourceLayer,w=this.getSource(d);if(w){if(w.type!=="vector"||v)return c.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(d)[0].getFeatureState(v,c.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error(`The source '${d}' does not exist in the map's style.`)))}getTransition(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const c={};for(const d in this._sourceCaches){const v=this._sourceCaches[d].getSource();c[v.id]||(c[v.id]=v.serialize())}return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:c,layers:this._serializeLayers(this._order)},d=>d!==void 0)}_updateLayer(c){this._updatedLayers[c.id]=!0;const d=this._getLayerSourceCache(c);c.source&&!this._updatedSources[c.source]&&d&&d.getSource().type!=="raster"&&(this._updatedSources[c.source]="reload",d.pause()),this._changed=!0,c.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(c){const d=P=>this._layers[P].type==="fill-extrusion",v={},w=[];for(let P=this._order.length-1;P>=0;P--){const N=this._order[P];if(d(N)){v[N]=P;for(const B of c){const H=B[N];if(H)for(const W of H)w.push(W)}}}w.sort((P,N)=>N.intersectionZ-P.intersectionZ);const S=[];for(let P=this._order.length-1;P>=0;P--){const N=this._order[P];if(d(N))for(let B=w.length-1;B>=0;B--){const H=w[B].feature;if(v[H.layer.id]<P)break;S.push(H),w.pop()}else for(const B of c){const H=B[N];if(H)for(const W of H)S.push(W.feature)}}return S}queryRenderedFeatures(c,d,v){d&&d.filter&&this._validate(s.validateFilter,"queryRenderedFeatures.filter",d.filter,null,d);const w={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const B of d.layers){const H=this._layers[B];if(!H)return this.fire(new s.ErrorEvent(new Error(`The layer '${B}' does not exist in the map's style and cannot be queried for features.`))),[];w[H.source]=!0}}const S=[];d.availableImages=this._availableImages;const P=d&&d.layers?d.layers.some(B=>{const H=this.getLayer(B);return H&&H.is3D()}):this.has3DLayers(),N=Yt.createFromScreenPoints(c,v);for(const B in this._sourceCaches){const H=this._sourceCaches[B].getSource().id;d.layers&&!w[H]||S.push(ue(this._sourceCaches[B],this._layers,this._serializedLayers,N,d,v,P,!!this.map._showQueryGeometry))}return this.placement&&S.push(function(B,H,W,$,ae,pe,de){const me={},_e=pe.queryRenderedSymbols($),re=[];for(const Ie of Object.keys(_e).map(Number))re.push(de[Ie]);re.sort(ge);for(const Ie of re){const Ee=Ie.featureIndex.lookupSymbolFeatures(_e[Ie.bucketInstanceId],H,Ie.bucketIndex,Ie.sourceLayerIndex,ae.filter,ae.layers,ae.availableImages,B);for(const Se in Ee){const ze=me[Se]=me[Se]||[],De=Ee[Se];De.sort((qe,lt)=>{const ut=Ie.featureSortOrder;if(ut){const gt=ut.indexOf(qe.featureIndex);return ut.indexOf(lt.featureIndex)-gt}return lt.featureIndex-qe.featureIndex});for(const qe of De)ze.push(qe)}}for(const Ie in me)me[Ie].forEach(Ee=>{const Se=Ee.feature,ze=W(B[Ie]).getFeatureState(Se.layer["source-layer"],Se.id);Se.source=Se.layer.source,Se.layer["source-layer"]&&(Se.sourceLayer=Se.layer["source-layer"]),Se.state=ze});return me}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),N.screenGeometry,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(S)}querySourceFeatures(c,d){d&&d.filter&&this._validate(s.validateFilter,"querySourceFeatures.filter",d.filter,null,d);const v=this._getSourceCaches(c);let w=[];for(const S of v)w=w.concat(Ye(S,d));return w}addSourceType(c,d,v){return us.getSourceType(c)?v(new Error(`A source type called "${c}" already exists.`)):(us.setSourceType(c,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:c,url:d.workerSourceURL},v):v(null,null))}getLight(){return this.light.getLight()}setLight(c,d={}){this._checkLoaded();const v=this.light.getLight();let w=!1;for(const P in c)if(!p(c[P],v[P])){w=!0;break}if(!w)return;const S=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(c,d),this.light.updateTransitions(S)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(c,d=1){if(this._checkLoaded(),!c)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(d===1){if(typeof c.source=="object"){const v="terrain-dem-src";this.addSource(v,c.source),c=s.clone$1(c),c=s.extend(c,{source:v})}if(this._validate(s.validateTerrain,"terrain",c))return}if(!this.terrain||this.terrain&&d!==this.terrain.drapeRenderMode)this._createTerrain(c,d);else{const v=this.terrain,w=v.get();for(const S of Object.keys(s.spec.terrain))!c.hasOwnProperty(S)&&s.spec.terrain[S].default&&(c[S]=s.spec.terrain[S].default);for(const S in c)if(!p(c[S],w[S])){v.set(c),this.stylesheet.terrain=c;const P=this._setTransitionParameters({duration:0});v.updateTransitions(P);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(c){const d=this.fog=new sn(c,this.map.transform);this.stylesheet.fog=c;const v=this._setTransitionParameters({duration:0});d.updateTransitions(v)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const c of this.map._markers)c._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(c){if(this._checkLoaded(),!c)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const d=this.fog,v=d.get();Object.keys(c).length===0&&d.set(c);for(const w in c)if(!p(c[w],v[w])){d.set(c),this.stylesheet.fog=c;const S=this._setTransitionParameters({duration:0});d.updateTransitions(S);break}}else this._createFog(c);this._markersNeedUpdate=!0}_setTransitionParameters(c){return{now:s.exported.now(),transition:s.extend(c,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const c=this._order.filter(v=>this.isLayerDraped(this._layers[v])),d=this._order.filter(v=>!this.isLayerDraped(this._layers[v]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...c),this._drapedFirstOrder.push(...d)}_createTerrain(c,d){const v=this.terrain=new Ot(c,d);this.stylesheet.terrain=c,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const w=this._setTransitionParameters({duration:0});v.updateTransitions(w)}_force3DLayerUpdate(){for(const c in this._layers){const d=this._layers[c];d.type==="fill-extrusion"&&this._updateLayer(d)}}_forceSymbolLayerUpdate(){for(const c in this._layers){const d=this._layers[c];d.type==="symbol"&&this._updateLayer(d)}}_validate(c,d,v,w,S={}){return(!S||S.validate!==!1)&&Cf(this,c.call(s.validateStyle,s.extend({key:d,style:this.serialize(),value:v,styleSpec:s.spec},w)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const c in this._layers)this._layers[c].setEventedParent(null);for(const c in this._sourceCaches)this._sourceCaches[c].clearTiles(),this._sourceCaches[c].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(c){const d=this._getSourceCaches(c);for(const v of d)v.clearTiles()}_reloadSource(c){const d=this._getSourceCaches(c);for(const v of d)v.resume(),v.reload()}_reloadSources(){for(const c of this._getSources())c.reload&&c.reload()}_updateSources(c){for(const d in this._sourceCaches)this._sourceCaches[d].update(c)}_generateCollisionBoxes(){for(const c in this._sourceCaches){const d=this._sourceCaches[c];d.resume(),d.reload()}}_updatePlacement(c,d,v,w,S=!1){let P=!1,N=!1;const B={};for(const H of this._order){const W=this._layers[H];if(W.type!=="symbol")continue;if(!B[W.source]){const ae=this._getLayerSourceCache(W);if(!ae)continue;B[W.source]=ae.getRenderableIds(!0).map(pe=>ae.getTileByID(pe)).sort((pe,de)=>de.tileID.overscaledZ-pe.tileID.overscaledZ||(pe.tileID.isLessThan(de.tileID)?-1:1))}const $=this.crossTileSymbolIndex.addLayer(W,B[W.source],c.center.lng,c.projection);P=P||$}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),S=S||this._layerOrderChanged||v===0,this._layerOrderChanged&&this.fire(new s.Event("neworder")),(S||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.exported.now(),c.zoom))&&(this.pauseablePlacement=new Kr(c,this._order,S,d,v,w,this.placement,this.fog&&c.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,B),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.exported.now()),N=!0),P&&this.pauseablePlacement.placement.setStale()),N||P)for(const H of this._order){const W=this._layers[H];W.type==="symbol"&&this.placement.updateLayerOpacities(W,B[W.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.exported.now())}_releaseSymbolFadeTiles(){for(const c in this._sourceCaches)this._sourceCaches[c].releaseSymbolFadeTiles()}getImages(c,d,v){this.imageManager.getImages(d.icons,v),this._updateTilesForChangedImages();const w=S=>{S&&S.setDependencies(d.tileID.key,d.type,d.icons)};w(this._otherSourceCaches[d.source]),w(this._symbolSourceCaches[d.source])}getGlyphs(c,d,v){this.glyphManager.getGlyphs(d.stacks,v)}getResource(c,d,v){return s.makeRequest(d,v)}_getSourceCache(c){return this._otherSourceCaches[c]}_getLayerSourceCache(c){return c.type==="symbol"?this._symbolSourceCaches[c.source]:this._otherSourceCaches[c.source]}_getSourceCaches(c){const d=[];return this._otherSourceCaches[c]&&d.push(this._otherSourceCaches[c]),this._symbolSourceCaches[c]&&d.push(this._symbolSourceCaches[c]),d}_isSourceCacheLoaded(c){const d=this._getSourceCaches(c);return d.length===0?(this.fire(new s.ErrorEvent(new Error(`There is no source with ID '${c}'`))),!1):d.every(v=>v.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}us.getSourceType=function(_){return st[_]},us.setSourceType=function(_,c){st[_]=c},us.registerForPluginStateChange=s.registerForPluginStateChange;var Wc=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Af="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Xa=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,Ah=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Mh=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let Mf={},Lf={};const Xc=[];Iu(Wc,Xc),Iu(Xa,Xc),Iu(Ah,Xc),Iu(Mh,Xc),Mf=lr("",Xa),Lf=lr(Mh,Ah);const wu=lr(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),jo=Wc,vd=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Aa={background:lr(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:lr(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:lr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:lr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:lr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:lr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:lr("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:lr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:lr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:lr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:lr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:lr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:lr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:lr(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:lr(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:lr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:lr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:lr(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:lr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:lr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:lr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:lr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:lr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:lr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:lr(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:lr(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Af),skyboxGradient:lr(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Af),skyboxCapture:lr(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:lr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:lr(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function Iu(_,c){const d=_.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let v of d)if(v=v.trim(),v[0]==="#"&&v.includes("if")&&!v.includes("endif")){v=v.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const w=v.split(" ");for(const S of w)c.includes(S)||c.push(S)}}function lr(_,c){const d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,v=c.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),w={},S=[...Xc];return Iu(_,S),Iu(c,S),{fragmentSource:_=_.replace(d,(P,N,B,H,W)=>(w[W]=!0,N==="define"?`
#ifndef HAS_UNIFORM_u_${W}
varying ${B} ${H} ${W};
#else
uniform ${B} ${H} u_${W};
#endif
`:`
#ifdef HAS_UNIFORM_u_${W}
    ${B} ${H} ${W} = u_${W};
#endif
`)),vertexSource:c=c.replace(d,(P,N,B,H,W)=>{const $=H==="float"?"vec2":"vec4",ae=W.match(/color/)?"color":$;return w[W]?N==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
attribute ${B} ${$} a_${W};
varying ${B} ${H} ${W};
#else
uniform ${B} ${H} u_${W};
#endif
`:ae==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = a_${W};
#else
    ${B} ${H} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = unpack_mix_${ae}(a_${W}, u_${W}_t);
#else
    ${B} ${H} ${W} = u_${W};
#endif
`:N==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
attribute ${B} ${$} a_${W};
#else
uniform ${B} ${H} u_${W};
#endif
`:ae==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${B} ${H} ${W} = a_${W};
#else
    ${B} ${H} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${B} ${H} ${W} = unpack_mix_${ae}(a_${W}, u_${W}_t);
#else
    ${B} ${H} ${W} = u_${W};
#endif
`}),staticAttributes:v,usedDefines:S}}class Ma{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(c,d,v,w,S,P,N){this.context=c;let B=this.boundPaintVertexBuffers.length!==w.length;for(let W=0;!B&&W<w.length;W++)this.boundPaintVertexBuffers[W]!==w[W]&&(B=!0);let H=this.boundDynamicVertexBuffers.length!==N.length;for(let W=0;!H&&W<N.length;W++)this.boundDynamicVertexBuffers[W]!==N[W]&&(H=!0);if(!c.extVertexArrayObject||!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==v||B||H||this.boundIndexBuffer!==S||this.boundVertexOffset!==P)this.freshBind(d,v,w,S,P,N);else{c.bindVertexArrayOES.set(this.vao);for(const W of N)W&&W.bind();S&&S.dynamicDraw&&S.bind()}}freshBind(c,d,v,w,S,P){let N;const B=c.numAttributes,H=this.context,W=H.gl;if(H.extVertexArrayObject)this.vao&&this.destroy(),this.vao=H.extVertexArrayObject.createVertexArrayOES(),H.bindVertexArrayOES.set(this.vao),N=0,this.boundProgram=c,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=v,this.boundIndexBuffer=w,this.boundVertexOffset=S,this.boundDynamicVertexBuffers=P;else{N=H.currentNumAttributes||0;for(let $=B;$<N;$++)W.disableVertexAttribArray($)}d.enableAttributes(W,c),d.bind(),d.setVertexAttribPointers(W,c,S);for(const $ of v)$.enableAttributes(W,c),$.bind(),$.setVertexAttribPointers(W,c,S);for(const $ of P)$&&($.enableAttributes(W,c),$.bind(),$.setVertexAttribPointers(W,c,S));w&&w.bind(),H.currentNumAttributes=B}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function sc(_,c){const d=Math.pow(2,c.canonical.z),v=c.canonical.y;return[new s.MercatorCoordinate(0,v/d).toLngLat().lat,new s.MercatorCoordinate(0,(v+1)/d).toLngLat().lat]}function Tu(_,c,d,v,w,S,P){const N=_.context,B=N.gl,H=d.fbo;if(!H)return;_.prepareDrawTile();const W=_.useProgram("hillshade");N.activeTexture.set(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,H.colorAttachment.get());const $=((me,_e,re,Ie)=>{const Ee=re.paint.get("hillshade-shadow-color"),Se=re.paint.get("hillshade-highlight-color"),ze=re.paint.get("hillshade-accent-color");let De=re.paint.get("hillshade-illumination-direction")*(Math.PI/180);re.paint.get("hillshade-illumination-anchor")==="viewport"&&(De-=me.transform.angle);const qe=!me.options.moving;return{u_matrix:Ie||me.transform.calculateProjMatrix(_e.tileID.toUnwrapped(),qe),u_image:0,u_latrange:sc(0,_e.tileID),u_light:[re.paint.get("hillshade-exaggeration"),De],u_shadow:Ee,u_highlight:Se,u_accent:ze}})(_,d,v,_.terrain?c.projMatrix:null);_.prepareDrawProgram(N,W,c.toUnwrapped());const{tileBoundsBuffer:ae,tileBoundsIndexBuffer:pe,tileBoundsSegments:de}=_.getTileBoundsBuffers(d);W.draw(N,B.TRIANGLES,w,S,P,s.CullFaceMode.disabled,$,v.id,ae,pe,de)}function zr(_,c,d){if(!c.needsDEMTextureUpload)return;const v=_.context,w=v.gl;v.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||_.getTileTexture(d.stride);const S=d.getPixels();c.demTexture?c.demTexture.update(S,{premultiply:!1}):c.demTexture=new s.Texture(v,S,w.RGBA,{premultiply:!1}),c.needsDEMTextureUpload=!1}function Bl(_,c,d,v,w,S){const P=_.context,N=P.gl;if(!c.dem)return;const B=c.dem;if(P.activeTexture.set(N.TEXTURE1),zr(_,c,B),!c.demTexture)return;c.demTexture.bind(N.NEAREST,N.CLAMP_TO_EDGE);const H=B.dim;P.activeTexture.set(N.TEXTURE0);let W=c.fbo;if(!W){const de=new s.Texture(P,{width:H,height:H,data:null},N.RGBA);de.bind(N.LINEAR,N.CLAMP_TO_EDGE),W=c.fbo=P.createFramebuffer(H,H,!0),W.colorAttachment.set(de.texture)}P.bindFramebuffer.set(W.framebuffer),P.viewport.set([0,0,H,H]);const{tileBoundsBuffer:$,tileBoundsIndexBuffer:ae,tileBoundsSegments:pe}=_.getMercatorTileBoundsBuffers();_.useProgram("hillshadePrepare").draw(P,N.TRIANGLES,v,w,S,s.CullFaceMode.disabled,((de,me)=>{const _e=me.stride,re=s.create();return s.ortho(re,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(re,re,[0,-s.EXTENT,0]),{u_matrix:re,u_image:1,u_dimension:[_e,_e],u_zoom:de.overscaledZ,u_unpack:me.unpackVector}})(c.tileID,B),d.id,$,ae,pe),c.needsHillshadePrepare=!1}const Lh=_=>({u_matrix:new s.UniformMatrix4f(_),u_image0:new s.Uniform1i(_),u_skirt_height:new s.Uniform1f(_)}),fp=(_,c)=>({u_matrix:_,u_image0:0,u_skirt_height:c}),Ph=(_,c,d,v,w,S,P,N,B,H,W,$,ae,pe,de)=>({u_proj_matrix:Float32Array.from(_),u_globe_matrix:c,u_normalize_matrix:Float32Array.from(v),u_merc_matrix:d,u_zoom_transition:w,u_merc_center:S,u_image0:0,u_frustum_tl:P,u_frustum_tr:N,u_frustum_br:B,u_frustum_bl:H,u_globe_pos:W,u_globe_radius:$,u_viewport:ae,u_grid_matrix:de?Float32Array.from(de):new Float32Array(9),u_skirt_height:pe});function dp(_,c){return _!=null&&c!=null&&!(!_.hasData()||!c.hasData())&&_.demTexture!=null&&c.demTexture!=null&&_.tileID.key!==c.tileID.key}const Su=new class{constructor(){this.operations={}}newMorphing(_,c,d,v,w){if(_ in this.operations){const S=this.operations[_];S.to.tileID.key!==d.tileID.key&&(S.queued=d)}else this.operations[_]={startTime:v,phase:0,duration:w,from:c,to:d,queued:null}}getMorphValuesForProxy(_){if(!(_ in this.operations))return null;const c=this.operations[_];return{from:c.from,to:c.to,phase:c.phase}}update(_){for(const c in this.operations){const d=this.operations[c];for(d.phase=(_-d.startTime)/d.duration;d.phase>=1||!this._validOp(d);)if(!this._nextOp(d,_)){delete this.operations[c];break}}}_nextOp(_,c){return!!_.queued&&(_.from=_.to,_.to=_.queued,_.queued=null,_.phase=0,_.startTime=c,!0)}_validOp(_){return _.from.hasData()&&_.to.hasData()}},Cu={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function zl(_){return 6*Math.pow(1.5,22-_)}function La(_,c){const d=1<<_.z;return!c&&(_.x===0||_.x===d-1)||_.y===0||_.y===d-1}const Mi=_=>({u_matrix:_});function oc(_,c,d,v,w){if(w>0){const S=s.exported.now(),P=(S-_.timeAdded)/w,N=c?(S-c.timeAdded)/w:-1,B=d.getSource(),H=v.coveringZoomLevel({tileSize:B.tileSize,roundZoom:B.roundZoom}),W=!c||Math.abs(c.tileID.overscaledZ-H)>Math.abs(_.tileID.overscaledZ-H),$=W&&_.refreshedUponExpiration?1:s.clamp(W?P:1-N,0,1);return _.refreshedUponExpiration&&P>=1&&(_.refreshedUponExpiration=!1),c?{opacity:1,mix:1-$}:{opacity:$,mix:0}}return{opacity:1,mix:0}}class $l extends s.SourceCache{constructor(c){const d={type:"raster-dem",maxzoom:c.transform.maxZoom},v=new zn(je(),null),w=tt("mock-dem",d,v,c.style);super("mock-dem",w,!1),w.setEventedParent(this),this._sourceLoaded=!0}_loadTile(c,d){c.state="loaded",d(null)}}class pp extends s.SourceCache{constructor(c){const d=tt("proxy",{type:"geojson",maxzoom:c.transform.maxZoom},new zn(je(),null),c.style);super("proxy",d,!1),d.setEventedParent(this),this.map=this.getSource().map=c,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(c,d,v){if(c.freezeTileCoverage)return;this.transform=c;const w=c.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((S,P)=>{if(S[P.key]="",!this._tiles[P.key]){const N=new s.Tile(P,this._source.tileSize*P.overscaleFactor(),c.tileZoom);N.state="loaded",this._tiles[P.key]=N}return S},{});for(const S in this._tiles)S in w||(this.freeFBO(S),this._tiles[S].unloadVectorData(),delete this._tiles[S])}freeFBO(c){const d=this.proxyCachedFBO[c];if(d!==void 0){const v=Object.values(d);this.renderCachePool.push(...v),delete this.proxyCachedFBO[c]}}deallocRenderCache(){this.renderCache.forEach(c=>c.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class ac extends s.OverscaledTileID{constructor(c,d,v){super(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y),this.proxyTileKey=d,this.projMatrix=v}}class Au extends s.Elevation{constructor(c,d){super(),this.painter=c,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[v,w,S]=function(B){const H=new s.StructArrayLayout2i4,W=new s.StructArrayLayout3ui6,$=131;H.reserve(17161),W.reserve(33800);const ae=s.EXTENT/128,pe=s.EXTENT+ae/2,de=pe+ae;for(let _e=-ae;_e<de;_e+=ae)for(let re=-ae;re<de;re+=ae){const Ie=re<0||re>pe||_e<0||_e>pe?24575:0,Ee=s.clamp(Math.round(re),0,s.EXTENT),Se=s.clamp(Math.round(_e),0,s.EXTENT);H.emplaceBack(Ee+Ie,Se)}const me=(_e,re)=>{const Ie=re*$+_e;W.emplaceBack(Ie+1,Ie,Ie+$),W.emplaceBack(Ie+$,Ie+$+1,Ie+1)};for(let _e=1;_e<129;_e++)for(let re=1;re<129;re++)me(re,_e);return[0,129].forEach(_e=>{for(let re=0;re<130;re++)me(re,_e),me(_e,re)}),[H,W,32768]}(),P=c.context;this.gridBuffer=P.createVertexBuffer(v,s.posAttributes.members),this.gridIndexBuffer=P.createIndexBuffer(w),this.gridSegments=s.SegmentVector.simpleSegment(0,0,v.length,w.length),this.gridNoSkirtSegments=s.SegmentVector.simpleSegment(0,0,v.length,S),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new pp(d.map),this.orthoMatrix=s.create(),s.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,s.EXTENT,0,s.EXTENT,0,1);const N=P.gl;this._overlapStencilMode=new s.StencilMode({func:N.GEQUAL,mask:255},0,255,N.KEEP,N.KEEP,N.REPLACE),this._previousZoom=c.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=d,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new $l(d.map)}set style(c){c.on("data",this._onStyleDataEvent.bind(this)),c.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=c,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(c,d,v){if(c&&c.terrain){this._style!==c&&(this.style=c),this.enabled=!0;const w=c.terrain.properties;this.sourceCache=c.terrain.drapeRenderMode===0?this._mockSourceCache:c._getSourceCache(w.get("source")),this._exaggeration=w.get("exaggeration");const S=()=>{this.sourceCache.used&&s.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const P=this.getScaledDemTileSize();this.sourceCache.update(d,P,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,S(),this._initializing=!0),S(),d.updateElevation(!0,v),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(d),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(c){this._findCoveringTileCache[c]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const c=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||c.efficiency!==100&&s.warnOnce(`Terrain render cache efficiency is not optimal (${c.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${c.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(c){c.coord&&c.dataType==="source"?this._clearRenderCacheForTile(c.sourceCacheId,c.coord):c.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const c in this._style._sourceCaches)this._style._sourceCaches[c].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(c=>c.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const c=2*this.proxySourceCache.getSource().tileSize;return[c,c]}set useVertexMorphing(c){this._useVertexMorphing=c}updateTileBinding(c){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const d=this.proxySourceCache,v=this.painter.transform;this._initializing&&(this._initializing=v._centerAltitude===0&&this.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(v.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const w=this.proxyCoords=d.getIds().map(B=>{const H=d.getTileByID(B).tileID;return H.projMatrix=v.calculateProjMatrix(H.toUnwrapped()),H});(function(B,H){const W=H.transform.pointCoordinate(H.transform.getCameraPoint()),$=new s.pointGeometry(W.x,W.y);B.sort((ae,pe)=>{if(pe.overscaledZ-ae.overscaledZ)return pe.overscaledZ-ae.overscaledZ;const de=new s.pointGeometry(ae.canonical.x+(1<<ae.canonical.z)*ae.wrap,ae.canonical.y),me=new s.pointGeometry(pe.canonical.x+(1<<pe.canonical.z)*pe.wrap,pe.canonical.y),_e=$.mult(1<<ae.canonical.z);return _e.x-=.5,_e.y-=.5,_e.distSqr(de)-_e.distSqr(me)})})(w,this.painter),this._previousZoom=v.zoom;const S=this.proxyToSource||{};this.proxyToSource={},w.forEach(B=>{this.proxyToSource[B.key]={}}),this.terrainTileForTile={};const P=this._style._sourceCaches;for(const B in P){const H=P[B];if(!H.used||(H!==this.sourceCache&&this.resetTileLookupCache(H.id),this._setupProxiedCoordsForOrtho(H,c[B],S),H.usedForTerrain))continue;const W=c[B];H.getSource().reparseOverscaled&&this._assignTerrainTiles(W)}this.proxiedCoords[d.id]=w.map(B=>new ac(B,B.key,this.orthoMatrix)),this._assignTerrainTiles(w),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(S),this.renderingToTexture=!1,this._updateTimestamp=s.exported.now();const N={};this._visibleDemTiles=[];for(const B of this.proxyCoords){const H=this.terrainTileForTile[B.key];if(!H)continue;const W=H.tileID.key;W in N||(this._visibleDemTiles.push(H),N[W]=W)}}_assignTerrainTiles(c){this._initializing||c.forEach(d=>{if(this.terrainTileForTile[d.key])return;const v=this._findTileCoveringTileID(d,this.sourceCache);v&&(this.terrainTileForTile[d.key]=v)})}_prepareDEMTextures(){const c=this.painter.context,d=c.gl;for(const v in this.terrainTileForTile){const w=this.terrainTileForTile[v],S=w.dem;!S||w.demTexture&&!w.needsDEMTextureUpload||(c.activeTexture.set(d.TEXTURE1),zr(this.painter,w,S))}}_prepareDemTileUniforms(c,d,v,w){if(!d||d.demTexture==null)return!1;const S=c.tileID.canonical,P=Math.pow(2,d.tileID.canonical.z-S.z),N=w||"";return v[`u_dem_tl${N}`]=[S.x*P%1,S.y*P%1],v[`u_dem_scale${N}`]=P,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const c=this.painter.context,d=c.gl;if(!this._emptyDepthBufferTexture){const v=new s.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new s.Texture(c,v,d.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let c=0;const d=this._visibleDemTiles.reduce((v,w)=>{if(!w.dem)return v;const S=w.dem.tree.minimums[0];return S>0&&c++,v+S},0);return c?d/c:0}_updateEmptyDEMTexture(){const c=this.painter.context,d=c.gl;c.activeTexture.set(d.TEXTURE2);const v=this._getLoadedAreaMinimum(),w=new s.RGBAImage({width:1,height:1},new Uint8Array(s.DEMData.pack(v,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let S=this._emptyDEMTexture;return S?S.update(w,{premultiply:!1}):S=this._emptyDEMTexture=new s.Texture(c,w,d.RGBA,{premultiply:!1}),S}setupElevationDraw(c,d,v){const w=this.painter.context,S=w.gl,P=(N=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:s.DEMData.getUnpackVector(N),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var N;P.u_dem_size=this.sourceCache.getSource().tileSize,P.u_exaggeration=this.exaggeration();let B=null,H=null,W=1;if(v&&v.morphing&&this._useVertexMorphing){const $=v.morphing.srcDemTile,ae=v.morphing.dstDemTile;W=v.morphing.phase,$&&ae&&(this._prepareDemTileUniforms(c,$,P,"_prev")&&(H=$),this._prepareDemTileUniforms(c,ae,P)&&(B=ae))}if(H&&B?(w.activeTexture.set(S.TEXTURE2),B.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE,S.NEAREST),w.activeTexture.set(S.TEXTURE4),H.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE,S.NEAREST),P.u_dem_lerp=W):(B=this.terrainTileForTile[c.tileID.key],w.activeTexture.set(S.TEXTURE2),(this._prepareDemTileUniforms(c,B,P)?B.demTexture:this.emptyDEMTexture).bind(S.NEAREST,S.CLAMP_TO_EDGE)),w.activeTexture.set(S.TEXTURE3),v&&v.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),this._depthFBO&&(P.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),P.u_depth_size_inv=[1,1]),v&&v.useMeterToDem&&B){const $=(1<<B.tileID.canonical.z)*s.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;P.u_meter_to_dem=$}if(v&&v.labelPlaneMatrixInv&&(P.u_label_plane_matrix_inv=v.labelPlaneMatrixInv),d.setTerrainUniformValues(w,P),this.painter.transform.projection.name==="globe"){const $=this.globeUniformValues(this.painter.transform,c.tileID.canonical,v&&v.useDenormalizedUpVectorScale);d.setGlobeUniformValues(w,$)}}globeUniformValues(c,d,v){const w=c.projection;return{u_tile_tl_up:w.upVector(d,0,0),u_tile_tr_up:w.upVector(d,s.EXTENT,0),u_tile_br_up:w.upVector(d,s.EXTENT,s.EXTENT),u_tile_bl_up:w.upVector(d,0,s.EXTENT),u_tile_up_scale:v?s.globeMetersToEcef(1):w.upVectorScale(d,c.center.lat,c.worldSize).metersToTile}}renderToBackBuffer(c){const d=this.painter,v=this.painter.context;c.length!==0&&(v.bindFramebuffer.set(null),v.viewport.set([0,0,d.width,d.height]),d.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(w,S,P,N,B){if(w.transform.projection.name==="globe")(function(H,W,$,ae,pe){const de=H.context,me=de.gl;let _e,re;const Ie=H.options.showTerrainWireframe?2:0,Ee=H.transform,Se=s.globeUseCustomAntiAliasing(H,de,Ee),ze=(Wt,pt)=>{if(re===Wt)return;const at=[Cu[Wt],"PROJECTION_GLOBE_VIEW"];Se&&at.push("CUSTOM_ANTIALIASING"),pt&&at.push(Cu[Ie]),_e=H.useProgram("globeRaster",null,at),re=Wt},De=H.colorModeForRenderPass(),qe=new s.DepthMode(me.LEQUAL,s.DepthMode.ReadWrite,H.depthRangeFor3D);Su.update(pe);const lt=s.calculateGlobeMercatorMatrix(Ee),ut=[s.mercatorXfromLng(Ee.center.lng),s.mercatorYfromLat(Ee.center.lat)],gt=Ie?[!1,!0]:[!1],nn=H.globeSharedBuffers,ft=[Ee.width*s.exported.devicePixelRatio,Ee.height*s.exported.devicePixelRatio],Ft=Float32Array.from(Ee.globeMatrix),xt={useDenormalizedUpVectorScale:!0};if(gt.forEach(Wt=>{const pt=H.transform,at=zl(pt.zoom)*W.exaggeration();re=-1;const yt=Wt?me.LINES:me.TRIANGLES;for(const Gt of ae){const Ht=$.getTile(Gt),Qn=s.StencilMode.disabled,ji=W.prevTerrainTileForTile[Gt.key],Bn=W.terrainTileForTile[Gt.key];dp(ji,Bn)&&Su.newMorphing(Gt.key,ji,Bn,pe,250),de.activeTexture.set(me.TEXTURE0),Ht.texture.bind(me.LINEAR,me.CLAMP_TO_EDGE);const An=Su.getMorphValuesForProxy(Gt.key),ni=An?1:0;An&&s.extend$1(xt,{morphing:{srcDemTile:An.from,dstDemTile:An.to,phase:s.easeCubicInOut(An.phase)}});const ir=s.tileCornersToBounds(Gt.canonical),oi=s.getLatitudinalLod(ir.getCenter().lat),Nr=s.getGridMatrix(Gt.canonical,ir,oi,pt.worldSize/pt._pixelsPerMercatorPixel),qr=s.globeNormalizeECEF(s.globeTileBounds(Gt.canonical)),cs=Ph(pt.projMatrix,Ft,lt,qr,s.globeToMercatorTransition(pt.zoom),ut,pt.frustumCorners.TL,pt.frustumCorners.TR,pt.frustumCorners.BR,pt.frustumCorners.BL,pt.globeCenterInViewSpace,pt.globeRadius,ft,at,Nr);if(ze(ni,Wt),W.setupElevationDraw(Ht,_e,xt),H.prepareDrawProgram(de,_e,Gt.toUnwrapped()),nn){const[Jr,uo,Qa]=Wt?nn.getWirefameBuffers(H.context,oi):nn.getGridBuffers(oi,at!==0);_e.draw(de,yt,qe,Qn,De,s.CullFaceMode.backCCW,cs,"globe_raster",Jr,uo,Qa)}}}),nn){const Wt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Se&&Wt.push("CUSTOM_ANTIALIASING"),_e=H.useProgram("globeRaster",null,Wt);for(const pt of ae){const{x:at,y:yt,z:Gt}=pt.canonical,Ht=yt===0,Qn=yt===(1<<Gt)-1,[ji,Bn,An,ni]=nn.getPoleBuffers(Gt);if(ni&&(Ht||Qn)){const ir=$.getTile(pt);de.activeTexture.set(me.TEXTURE0),ir.texture.bind(me.LINEAR,me.CLAMP_TO_EDGE);let oi=s.globePoleMatrixForTile(Gt,at,Ee);const Nr=s.globeNormalizeECEF(s.globeTileBounds(pt.canonical)),qr=(cs,Jr)=>cs.draw(de,me.TRIANGLES,qe,s.StencilMode.disabled,De,s.CullFaceMode.disabled,Ph(Ee.projMatrix,oi,oi,Nr,0,ut,Ee.frustumCorners.TL,Ee.frustumCorners.TR,Ee.frustumCorners.BR,Ee.frustumCorners.BL,Ee.globeCenterInViewSpace,Ee.globeRadius,ft,0),"globe_pole_raster",Jr,An,ni);W.setupElevationDraw(ir,_e,xt),H.prepareDrawProgram(de,_e,pt.toUnwrapped()),Ht&&qr(_e,ji),Qn&&(oi=s.scale(s.create(),oi,[1,-1,1]),qr(_e,Bn))}}}})(w,S,P,N,B);else{const H=w.context,W=H.gl;let $,ae;const pe=w.options.showTerrainWireframe?2:0,de=(Ee,Se)=>{if(ae===Ee)return;const ze=[Cu[Ee]];Se&&ze.push(Cu[pe]),$=w.useProgram("terrainRaster",null,ze),ae=Ee},me=w.colorModeForRenderPass(),_e=new s.DepthMode(W.LEQUAL,s.DepthMode.ReadWrite,w.depthRangeFor3D);Su.update(B);const re=w.transform,Ie=zl(re.zoom)*S.exaggeration();(pe?[!1,!0]:[!1]).forEach(Ee=>{ae=-1;const Se=Ee?W.LINES:W.TRIANGLES,[ze,De]=Ee?S.getWirefameBuffer():[S.gridIndexBuffer,S.gridSegments];for(const qe of N){const lt=P.getTile(qe),ut=s.StencilMode.disabled,gt=S.prevTerrainTileForTile[qe.key],nn=S.terrainTileForTile[qe.key];dp(gt,nn)&&Su.newMorphing(qe.key,gt,nn,B,250),H.activeTexture.set(W.TEXTURE0),lt.texture.bind(W.LINEAR,W.CLAMP_TO_EDGE,W.LINEAR_MIPMAP_NEAREST);const ft=Su.getMorphValuesForProxy(qe.key),Ft=ft?1:0;let xt;ft&&(xt={morphing:{srcDemTile:ft.from,dstDemTile:ft.to,phase:s.easeCubicInOut(ft.phase)}});const Wt=fp(qe.projMatrix,La(qe.canonical,re.renderWorldCopies)?Ie/10:Ie);de(Ft,Ee),S.setupElevationDraw(lt,$,xt),w.prepareDrawProgram(H,$,qe.toUnwrapped()),$.draw(H,Se,_e,ut,me,s.CullFaceMode.backCCW,Wt,"terrain_raster",S.gridBuffer,ze,De)}})}}(d,this,this.proxySourceCache,c,this._updateTimestamp),this.renderingToTexture=!0,d.gpuTimingDeferredRenderEnd(),c.splice(0,c.length))}renderBatch(c){if(this._drapedRenderBatches.length===0)return c+1;this.renderingToTexture=!0;const d=this.painter,v=this.painter.context,w=this.proxySourceCache,S=this.proxiedCoords[w.id],P=this._drapedRenderBatches.shift(),N=[],B=d.style.order;let H=0;for(const W of S){const $=w.getTileByID(W.proxyTileKey),ae=w.proxyCachedFBO[W.key]?w.proxyCachedFBO[W.key][c]:void 0,pe=ae!==void 0?w.renderCache[ae]:this.pool[H++],de=ae!==void 0;if($.texture=pe.tex,de&&!pe.dirty){N.push($.tileID);continue}let me;v.bindFramebuffer.set(pe.fb.framebuffer),this.renderedToTile=!1,pe.dirty&&(v.clear({color:s.Color.transparent,stencil:0}),pe.dirty=!1);for(let _e=P.start;_e<=P.end;++_e){const re=d.style._layers[B[_e]];if(re.isHidden(d.transform.zoom))continue;const Ie=d.style._getLayerSourceCache(re),Ee=Ie?this.proxyToSource[W.key][Ie.id]:[W];if(!Ee)continue;const Se=Ee;v.viewport.set([0,0,pe.fb.width,pe.fb.height]),me!==(Ie?Ie.id:null)&&(this._setupStencil(pe,Ee,re,Ie),me=Ie?Ie.id:null),d.renderLayer(d,Ie,re,Se)}this.renderedToTile?(pe.dirty=!0,N.push($.tileID)):de||--H,H===5&&(H=0,this.renderToBackBuffer(N))}return this.renderToBackBuffer(N),this.renderingToTexture=!1,v.bindFramebuffer.set(null),v.viewport.set([0,0,d.width,d.height]),P.end+1}postRender(){}renderCacheEfficiency(c){const d=c.order.length;if(d===0)return{efficiency:100};let v,w=0,S=0,P=!1;for(let N=0;N<d;++N){const B=c._layers[c.order[N]];this._style.isLayerDraped(B)?(P&&++w,++S):P||(P=!0,v=B.id)}return S===0?{efficiency:100}:{efficiency:100*(1-w/S),firstUndrapedLayer:v}}getMinElevationBelowMSL(){let c=0;return this._visibleDemTiles.filter(d=>d.dem).forEach(d=>{c=Math.min(c,d.dem.tree.minimums[0])}),c===0?c:(c-30)*this._exaggeration}raycast(c,d,v){if(!this._visibleDemTiles)return null;const w=this._visibleDemTiles.filter(S=>S.dem).map(S=>{const P=S.tileID,N=1<<P.overscaledZ,{x:B,y:H}=P.canonical,W=B/N,$=(B+1)/N,ae=H/N,pe=(H+1)/N;return{minx:W,miny:ae,maxx:$,maxy:pe,t:S.dem.tree.raycastRoot(W,ae,$,pe,c,d,v),tile:S}});w.sort((S,P)=>(S.t!==null?S.t:Number.MAX_VALUE)-(P.t!==null?P.t:Number.MAX_VALUE));for(const S of w){if(S.t==null)return null;const P=S.tile.dem.tree.raycast(S.minx,S.miny,S.maxx,S.maxy,c,d,v);if(P!=null)return P}return null}_createFBO(){const c=this.painter.context,d=c.gl,v=this.drapeBufferSize;c.activeTexture.set(d.TEXTURE0);const w=new s.Texture(c,{width:v[0],height:v[1],data:null},d.RGBA);w.bind(d.LINEAR,d.CLAMP_TO_EDGE);const S=c.createFramebuffer(v[0],v[1],!1);return S.colorAttachment.set(w.texture),S.depthAttachment=new Zs(c,S.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=c.createRenderbuffer(c.gl.DEPTH_STENCIL,v[0],v[1]),this._stencilRef=0,S.depthAttachment.set(this._sharedDepthStencil),c.clear({stencil:0})):S.depthAttachment.set(this._sharedDepthStencil),c.extTextureFilterAnisotropic&&!c.extTextureFilterAnisotropicForceOff&&d.texParameterf(d.TEXTURE_2D,c.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,c.extTextureFilterAnisotropicMax),{fb:S,tex:w,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const c in this._style._sourceCaches)if(this._style._sourceCaches[c].hasTransition())return!0;return this._style.order.some(c=>{const d=this._style._layers[c],v=d.isHidden(this.painter.transform.zoom);return d.type==="custom"?!v&&d.shouldRedrape():!v&&d.hasTransition()})}_clearLineLayersFromRenderCache(){let c=!1;for(const v of this._style._getSources())if(v instanceof Q){c=!0;break}if(!c)return;const d={};for(let v=0;v<this._style.order.length;++v){const w=this._style._layers[this._style.order[v]],S=this._style._getLayerSourceCache(w);if(S&&!d[S.id]&&!w.isHidden(this.painter.transform.zoom)&&w.type==="line"&&w.widthExpression()instanceof s.ZoomDependentExpression){d[S.id]=!0;for(const P of this.proxyCoords){const N=this.proxyToSource[P.key][S.id];if(N)for(const B of N)this._clearRenderCacheForTile(S.id,B)}}}}_clearRasterLayersFromRenderCache(){let c=!1;for(const v in this._style._sourceCaches)if(this._style._sourceCaches[v]._source instanceof ne){c=!0;break}if(!c)return;const d={};for(let v=0;v<this._style.order.length;++v){const w=this._style._layers[this._style.order[v]],S=this._style._getLayerSourceCache(w);if(!S||d[S.id]||w.isHidden(this.painter.transform.zoom)||w.type!=="raster")continue;const P=w.paint.get("raster-fade-duration");for(const N of this.proxyCoords){const B=this.proxyToSource[N.key][S.id];if(B)for(const H of B){const W=oc(S.getTile(H),S.findLoadedParent(H,0),S,this.painter.transform,P);(W.opacity!==1||W.mix!==0)&&this._clearRenderCacheForTile(S.id,H)}}}}_setupDrapedRenderBatches(){const c=this._style.order,d=c.length;if(d===0)return;const v=[];let w,S=0,P=this._style._layers[c[S]];for(;!this._style.isLayerDraped(P)&&P.isHidden(this.painter.transform.zoom)&&++S<d;)P=this._style._layers[c[S]];for(;S<d;++S){const N=this._style._layers[c[S]];N.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(N)?w===void 0&&(w=S):w!==void 0&&(v.push({start:w,end:S-1}),w=void 0))}w!==void 0&&v.push({start:w,end:S-1}),this._drapedRenderBatches=v}_setupRenderCache(c){const d=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,d.renderCache.length>d.renderCachePool.length){const P=Object.values(d.proxyCachedFBO);d.proxyCachedFBO={};for(let N=0;N<P.length;++N){const B=Object.values(P[N]);d.renderCachePool.push(...B)}}return}this._clearRasterLayersFromRenderCache();const v=this.proxyCoords,w=this._tilesDirty;for(let P=v.length-1;P>=0;P--){const N=v[P];if(d.getTileByID(N.key),d.proxyCachedFBO[N.key]!==void 0){const B=c[N.key],H=this.proxyToSource[N.key];let W=0;for(const $ in H){const ae=H[$],pe=B[$];if(!pe||pe.length!==ae.length||ae.some((de,me)=>de!==pe[me]||w[$]&&w[$].hasOwnProperty(de.key))){W=-1;break}++W}for(const $ in d.proxyCachedFBO[N.key])d.renderCache[d.proxyCachedFBO[N.key][$]].dirty=W<0||W!==Object.values(B).length}}const S=[...this._drapedRenderBatches];S.sort((P,N)=>N.end-N.start-(P.end-P.start));for(const P of S)for(const N of v){if(d.proxyCachedFBO[N.key])continue;let B=d.renderCachePool.pop();B===void 0&&d.renderCache.length<50&&(B=d.renderCache.length,d.renderCache.push(this._createFBO())),B!==void 0&&(d.proxyCachedFBO[N.key]={},d.proxyCachedFBO[N.key][P.start]=B,d.renderCache[B].dirty=!0)}this._tilesDirty={}}_setupStencil(c,d,v,w){if(!w||!this._sourceTilesOverlap[w.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const S=this.painter.context,P=S.gl;if(d.length<=1)return void(this._overlapStencilType=!1);let N;if(v.isTileClipped())N=d.length,this._overlapStencilMode.test={func:P.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(d[0].overscaledZ>d[d.length-1].overscaledZ))return void(this._overlapStencilType=!1);N=1,this._overlapStencilMode.test={func:P.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+N>255&&(S.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=N,this._overlapStencilMode.ref=this._stencilRef,v.isTileClipped()&&this._renderTileClippingMasks(d,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(c){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[c.key]),this._overlapStencilMode):s.StencilMode.disabled}_renderTileClippingMasks(c,d){const v=this.painter,w=this.painter.context,S=w.gl;v._tileClippingMaskIDs={},w.setColorMode(s.ColorMode.disabled),w.setDepthMode(s.DepthMode.disabled);const P=v.useProgram("clippingMask");for(const N of c){const B=v._tileClippingMaskIDs[N.key]=--d;P.draw(w,S.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:S.ALWAYS,mask:0},B,255,S.KEEP,S.KEEP,S.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,Mi(N.projMatrix),"$clipping",v.tileExtentBuffer,v.quadTriangleIndexBuffer,v.tileExtentSegments)}}pointCoordinate(c){const d=this.painter.transform;if(c.x<0||c.x>d.width||c.y<0||c.y>d.height)return null;const v=[c.x,c.y,1,1];s.transformMat4$1(v,v,d.pixelMatrixInverse),s.scale$1(v,v,1/v[3]),v[0]/=d.worldSize,v[1]/=d.worldSize;const w=d._camera.position,S=s.mercatorZfromAltitude(1,d.center.lat),P=[w[0],w[1],w[2]/S,0],N=s.subtract([],v.slice(0,3),P);s.normalize(N,N);const B=this.raycast(P,N,this._exaggeration);return B!==null&&B?(s.scaleAndAdd(P,P,N,B),P[3]=P[2],P[2]*=S,P):null}drawDepth(){const c=this.painter,d=c.context,v=this.proxySourceCache,w=Math.ceil(c.width),S=Math.ceil(c.height);if(!this._depthFBO||this._depthFBO.width===w&&this._depthFBO.height===S||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const P=d.gl,N=d.createFramebuffer(w,S,!0);d.activeTexture.set(P.TEXTURE0);const B=new s.Texture(d,{width:w,height:S,data:null},P.RGBA);B.bind(P.NEAREST,P.CLAMP_TO_EDGE),N.colorAttachment.set(B.texture);const H=d.createRenderbuffer(d.gl.DEPTH_COMPONENT16,w,S);N.depthAttachment.set(H),this._depthFBO=N,this._depthTexture=B}d.bindFramebuffer.set(this._depthFBO.framebuffer),d.viewport.set([0,0,w,S]),function(P,N,B,H){if(P.transform.projection.name==="globe")return;const W=P.context,$=W.gl;W.clear({depth:1});const ae=P.useProgram("terrainDepth"),pe=new s.DepthMode($.LESS,s.DepthMode.ReadWrite,P.depthRangeFor3D);for(const de of H){const me=B.getTile(de),_e=fp(de.projMatrix,0);N.setupElevationDraw(me,ae),ae.draw(W,$.TRIANGLES,pe,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.backCCW,_e,"terrain_depth",N.gridBuffer,N.gridIndexBuffer,N.gridNoSkirtSegments)}}(c,this,v,this.proxyCoords)}_setupProxiedCoordsForOrtho(c,d,v){if(c.getSource()instanceof Be)return this._setupProxiedCoordsForImageSource(c,d,v);this._findCoveringTileCache[c.id]=this._findCoveringTileCache[c.id]||{};const w=this.proxiedCoords[c.id]=[],S=this.proxyCoords;for(let N=0;N<S.length;N++){const B=S[N],H=this._findTileCoveringTileID(B,c);if(H){const W=this._createProxiedId(B,H,v[B.key]&&v[B.key][c.id]);w.push(W),this.proxyToSource[B.key][c.id]=[W]}}let P=!1;for(let N=0;N<d.length;N++){const B=c.getTile(d[N]);if(!B||!B.hasData())continue;const H=this._findTileCoveringTileID(B.tileID,this.proxySourceCache);if(H&&H.tileID.canonical.z!==B.tileID.canonical.z){const W=this.proxyToSource[H.tileID.key][c.id],$=this._createProxiedId(H.tileID,B,v[H.tileID.key]&&v[H.tileID.key][c.id]);W?W.splice(W.length-1,0,$):this.proxyToSource[H.tileID.key][c.id]=[$],w.push($),P=!0}}this._sourceTilesOverlap[c.id]=P}_setupProxiedCoordsForImageSource(c,d,v){if(!c.getSource().loaded())return;const w=this.proxiedCoords[c.id]=[],S=this.proxyCoords,P=c.getSource(),N=new s.pointGeometry(P.tileID.x,P.tileID.y)._div(1<<P.tileID.z),B=P.coordinates.map(s.MercatorCoordinate.fromLngLat).reduce((W,$)=>(W.min.x=Math.min(W.min.x,$.x-N.x),W.min.y=Math.min(W.min.y,$.y-N.y),W.max.x=Math.max(W.max.x,$.x-N.x),W.max.y=Math.max(W.max.y,$.y-N.y),W),{min:new s.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),H=(W,$)=>{const ae=W.wrap+W.canonical.x/(1<<W.canonical.z),pe=W.canonical.y/(1<<W.canonical.z),de=s.EXTENT/(1<<W.canonical.z),me=$.wrap+$.canonical.x/(1<<$.canonical.z),_e=$.canonical.y/(1<<$.canonical.z);return ae+de<me+B.min.x||ae>me+B.max.x||pe+de<_e+B.min.y||pe>_e+B.max.y};for(let W=0;W<S.length;W++){const $=S[W];for(let ae=0;ae<d.length;ae++){const pe=c.getTile(d[ae]);if(!pe||!pe.hasData()||H($,pe.tileID))continue;const de=this._createProxiedId($,pe,v[$.key]&&v[$.key][c.id]),me=this.proxyToSource[$.key][c.id];me?me.push(de):this.proxyToSource[$.key][c.id]=[de],w.push(de)}}}_createProxiedId(c,d,v){let w=this.orthoMatrix;if(v){const S=v.find(P=>P.key===d.tileID.key);if(S)return S}if(d.tileID.key!==c.key){const S=c.canonical.z-d.tileID.canonical.z;let P,N,B;w=s.create();const H=d.tileID.wrap-c.wrap<<c.overscaledZ;S>0?(P=s.EXTENT>>S,N=P*((d.tileID.canonical.x<<S)-c.canonical.x+H),B=P*((d.tileID.canonical.y<<S)-c.canonical.y)):(P=s.EXTENT<<-S,N=s.EXTENT*(d.tileID.canonical.x-(c.canonical.x+H<<-S)),B=s.EXTENT*(d.tileID.canonical.y-(c.canonical.y<<-S))),s.ortho(w,0,P,0,P,0,1),s.translate(w,w,[N,B,0])}return new ac(d.tileID,c.key,w)}_findTileCoveringTileID(c,d){let v=d.getTile(c);if(v&&v.hasData())return v;const w=this._findCoveringTileCache[d.id],S=w[c.key];if(v=S?d.getTileByID(S):null,v&&v.hasData()||S===null)return v;let P=v?v.tileID:c,N=P.overscaledZ;const B=d.getSource().minzoom,H=[];if(!S){const $=d.getSource().maxzoom;if(c.canonical.z>=$){const ae=c.canonical.z-$;d.getSource().reparseOverscaled?(N=Math.max(c.canonical.z+2,d.transform.tileZoom),P=new s.OverscaledTileID(N,c.wrap,$,c.canonical.x>>ae,c.canonical.y>>ae)):ae!==0&&(N=$,P=new s.OverscaledTileID(N,c.wrap,$,c.canonical.x>>ae,c.canonical.y>>ae))}P.key!==c.key&&(H.push(P.key),v=d.getTile(P))}const W=$=>{H.forEach(ae=>{w[ae]=$}),H.length=0};for(N-=1;N>=B&&(!v||!v.hasData());N--){v&&W(v.tileID.key);const $=P.calculateScaledKey(N);if(v=d.getTileByID($),v&&v.hasData())break;const ae=w[$];if(ae===null)break;ae===void 0?H.push($):v=d.getTileByID(ae)}return W(v?v.tileID.key:null),v&&v.hasData()?v:null}findDEMTileFor(c){return this.enabled?this._findTileCoveringTileID(c,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(c,d){let v=this._tilesDirty[c];v||(v=this._tilesDirty[c]={}),v[d.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const c=function(d){let v=0;const w=new s.StructArrayLayout2ui4,S=131;for(let P=1;P<129;P++){for(let N=1;N<129;N++)v=P*S+N,w.emplaceBack(v,v+1),w.emplaceBack(v,v+S),w.emplaceBack(v+1,v+S),P===128&&w.emplaceBack(v+S,v+S+1);w.emplaceBack(v+1,v+1+S)}return w}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(c),this.wireframeSegments=s.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,c.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Pf{static cacheKey(c,d,v,w){let S=`${d}${w?w.cacheKey:""}`;for(const P of v)c.usedDefines.includes(P)&&(S+=`/${P}`);return S}constructor(c,d,v,w,S,P){const N=c.gl;this.program=N.createProgram();const B=function(re){const Ie=[];for(let Ee=0;Ee<re.length;Ee++){if(re[Ee]===null)continue;const Se=re[Ee].split(" ");Ie.push(Se.pop())}return Ie}(v.staticAttributes),H=w?w.getBinderAttributes():[],W=B.concat(H);let $=w?w.defines():[];$=$.concat(P.map(re=>`#define ${re}`));const ae=c.isWebGL2?`#version 300 es
`:"",pe=ae+$.concat(c.extStandardDerivatives&&ae.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(vd):vd,vd,jo,wu.fragmentSource,Lf.fragmentSource,v.fragmentSource).join(`
`),de=ae+$.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,jo,wu.vertexSource,Lf.vertexSource,Mf.vertexSource,v.vertexSource).join(`
`),me=N.createShader(N.FRAGMENT_SHADER);if(N.isContextLost())return void(this.failedToCreate=!0);N.shaderSource(me,pe),N.compileShader(me),N.attachShader(this.program,me);const _e=N.createShader(N.VERTEX_SHADER);if(N.isContextLost())this.failedToCreate=!0;else{N.shaderSource(_e,de),N.compileShader(_e),N.attachShader(this.program,_e),this.attributes={},this.numAttributes=W.length;for(let re=0;re<this.numAttributes;re++)W[re]&&(N.bindAttribLocation(this.program,re,W[re]),this.attributes[W[re]]=re);N.linkProgram(this.program),N.deleteShader(_e),N.deleteShader(me),this.fixedUniforms=S(c),this.binderUniforms=w?w.getUniforms(c):[],P.includes("TERRAIN")&&(this.terrainUniforms=(re=>({u_dem:new s.Uniform1i(re),u_dem_prev:new s.Uniform1i(re),u_dem_unpack:new s.Uniform4f(re),u_dem_tl:new s.Uniform2f(re),u_dem_scale:new s.Uniform1f(re),u_dem_tl_prev:new s.Uniform2f(re),u_dem_scale_prev:new s.Uniform1f(re),u_dem_size:new s.Uniform1f(re),u_dem_lerp:new s.Uniform1f(re),u_exaggeration:new s.Uniform1f(re),u_depth:new s.Uniform1i(re),u_depth_size_inv:new s.Uniform2f(re),u_meter_to_dem:new s.Uniform1f(re),u_label_plane_matrix_inv:new s.UniformMatrix4f(re)}))(c)),P.includes("GLOBE")&&(this.globeUniforms=(re=>({u_tile_tl_up:new s.Uniform3f(re),u_tile_tr_up:new s.Uniform3f(re),u_tile_br_up:new s.Uniform3f(re),u_tile_bl_up:new s.Uniform3f(re),u_tile_up_scale:new s.Uniform1f(re)}))(c)),P.includes("FOG")&&(this.fogUniforms=(re=>({u_fog_matrix:new s.UniformMatrix4f(re),u_fog_range:new s.Uniform2f(re),u_fog_color:new s.Uniform4f(re),u_fog_horizon_blend:new s.Uniform1f(re),u_fog_temporal_offset:new s.Uniform1f(re),u_frustum_tl:new s.Uniform3f(re),u_frustum_tr:new s.Uniform3f(re),u_frustum_br:new s.Uniform3f(re),u_frustum_bl:new s.Uniform3f(re),u_globe_pos:new s.Uniform3f(re),u_globe_radius:new s.Uniform1f(re),u_globe_transition:new s.Uniform1f(re),u_is_globe:new s.Uniform1i(re),u_viewport:new s.Uniform2f(re)}))(c))}}setTerrainUniformValues(c,d){if(!this.terrainUniforms)return;const v=this.terrainUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const w in d)v[w]&&v[w].set(this.program,w,d[w])}}setGlobeUniformValues(c,d){if(!this.globeUniforms)return;const v=this.globeUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const w in d)v[w]&&v[w].set(this.program,w,d[w])}}setFogUniformValues(c,d){if(!this.fogUniforms)return;const v=this.fogUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const w in d)v[w].set(this.program,w,d[w])}}draw(c,d,v,w,S,P,N,B,H,W,$,ae,pe,de,me){const _e=c.gl;if(this.failedToCreate)return;c.program.set(this.program),c.setDepthMode(v),c.setStencilMode(w),c.setColorMode(S),c.setCullFace(P);for(const Ie of Object.keys(this.fixedUniforms))this.fixedUniforms[Ie].set(this.program,Ie,N[Ie]);de&&de.setUniforms(this.program,c,this.binderUniforms,ae,{zoom:pe});const re={[_e.LINES]:2,[_e.TRIANGLES]:3,[_e.LINE_STRIP]:1}[d];for(const Ie of $.get()){const Ee=Ie.vaos||(Ie.vaos={});(Ee[B]||(Ee[B]=new Ma)).bind(c,this,H,de?de.getPaintVertexBuffers():[],W,Ie.vertexOffset,me||[]),_e.drawElements(d,Ie.primitiveLength*re,_e.UNSIGNED_SHORT,Ie.primitiveOffset*re*2)}}}function mp(_,c){const d=Math.pow(2,c.tileID.overscaledZ),v=c.tileSize*Math.pow(2,_.transform.tileZoom)/d,w=v*(c.tileID.canonical.x+c.tileID.wrap*d),S=v*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_tile_units_to_pixels:1/ri(c,1,_.transform.tileZoom),u_pixel_coord_upper:[w>>16,S>>16],u_pixel_coord_lower:[65535&w,65535&S]}}const gp=s.create(),Rh=(_,c,d,v,w,S,P,N,B,H,W)=>{const $=c.style.light,ae=$.properties.get("position"),pe=[ae.x,ae.y,ae.z],de=s.create$1();$.properties.get("anchor")==="viewport"&&(s.fromRotation(de,-c.transform.angle),s.transformMat3(pe,pe,de));const me=$.properties.get("color"),_e=c.transform,re={u_matrix:_,u_lightpos:pe,u_lightintensity:$.properties.get("intensity"),u_lightcolor:[me.r,me.g,me.b],u_vertical_gradient:+d,u_opacity:v,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:gp,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:w,u_edge_radius:S};return _e.projection.name==="globe"&&(re.u_tile_id=[P.canonical.x,P.canonical.y,1<<P.canonical.z],re.u_zoom_transition=B,re.u_inv_rot_matrix=W,re.u_merc_center=H,re.u_up_dir=_e.projection.upVector(new s.CanonicalTileID(0,0,0),H[0]*s.EXTENT,H[1]*s.EXTENT),re.u_height_lift=N),re},xd=(_,c,d,v,w,S,P,N,B,H,W,$)=>{const ae=Rh(_,c,d,v,w,S,P,B,H,W,$),pe={u_height_factor:-Math.pow(2,P.overscaledZ)/N.tileSize/8};return s.extend(ae,mp(c,N),pe)},Dh=_=>({u_matrix:_}),mo=(_,c,d)=>s.extend(Dh(_),mp(c,d)),Mu=(_,c)=>({u_matrix:_,u_world:c}),Oh=(_,c,d,v)=>s.extend(mo(_,c,d),{u_world:v}),Lu=s.create(),Nh=(_,c,d,v,w,S)=>{const P=_.transform,N=P.projection.name==="globe";let B;if(S.paint.get("circle-pitch-alignment")==="map")if(N){const W=s.globePixelsToTileUnits(P.zoom,c.canonical)*P._pixelsPerMercatorPixel;B=Float32Array.from([W,0,0,W])}else B=P.calculatePixelsToTileUnitsMatrix(d);else B=new Float32Array([P.pixelsToGLUnits[0],0,0,P.pixelsToGLUnits[1]]);const H={u_camera_to_center_distance:P.cameraToCenterDistance,u_matrix:_.translatePosMatrix(c.projMatrix,d,S.paint.get("circle-translate"),S.paint.get("circle-translate-anchor")),u_device_pixel_ratio:s.exported.devicePixelRatio,u_extrude_scale:B,u_inv_rot_matrix:Lu,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(N){H.u_inv_rot_matrix=v,H.u_merc_center=w,H.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],H.u_zoom_transition=s.globeToMercatorTransition(P.zoom);const W=w[0]*s.EXTENT,$=w[1]*s.EXTENT;H.u_up_dir=P.projection.upVector(new s.CanonicalTileID(0,0,0),W,$)}return H},Ul=_=>{const c=[];return _.paint.get("circle-pitch-alignment")==="map"&&c.push("PITCH_WITH_MAP"),_.paint.get("circle-pitch-scale")==="map"&&c.push("SCALE_WITH_MAP"),c},_p=(_,c,d,v)=>{const w=s.EXTENT/d.tileSize;return{u_matrix:_,u_camera_to_center_distance:c.getCameraToCenterDistance(v),u_extrude_scale:[c.pixelsToGLUnits[0]/w,c.pixelsToGLUnits[1]/w]}},Rf=(_,c,d=1)=>({u_matrix:_,u_color:c,u_overlay:0,u_overlay_scale:d}),kh=s.create(),dl=(_,c,d,v,w,S,P)=>{const N=_.transform,B=N.projection.name==="globe",H=B?s.globePixelsToTileUnits(N.zoom,c.canonical)*N._pixelsPerMercatorPixel:ri(d,1,S),W={u_matrix:c.projMatrix,u_extrude_scale:H,u_intensity:P,u_inv_rot_matrix:kh,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(B){W.u_inv_rot_matrix=v,W.u_merc_center=w,W.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],W.u_zoom_transition=s.globeToMercatorTransition(N.zoom);const $=w[0]*s.EXTENT,ae=w[1]*s.EXTENT;W.u_up_dir=N.projection.upVector(new s.CanonicalTileID(0,0,0),$,ae)}return W},Pu=(_,c,d,v,w,S,P)=>{const N=_.transform,B=N.calculatePixelsToTileUnitsMatrix(c);return{u_matrix:Ru(_,c,d,v),u_pixels_to_tile_units:B,u_device_pixel_ratio:S,u_units_to_pixels:[1/N.pixelsToGLUnits[0],1/N.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:w,u_texsize:Fh(d)?c.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Df(c,_.transform),u_alpha_discard_threshold:0,u_trim_offset:P}},yp=(_,c,d,v,w)=>{const S=_.transform;return{u_matrix:Ru(_,c,d,v),u_texsize:c.imageAtlasTexture.size,u_pixels_to_tile_units:S.calculatePixelsToTileUnitsMatrix(c),u_device_pixel_ratio:w,u_image:0,u_tile_units_to_pixels:Df(c,S),u_units_to_pixels:[1/S.pixelsToGLUnits[0],1/S.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Df(_,c){return 1/ri(_,1,c.tileZoom)}function Ru(_,c,d,v){return _.translatePosMatrix(v||c.tileID.projMatrix,c,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}function Fh(_){const c=_.paint.get("line-dasharray").value;return c.value||c.kind!=="constant"}const lc=(_,c,d,v,w,S)=>{return{u_matrix:_,u_tl_parent:c,u_scale_parent:d,u_fade_t:v.mix,u_opacity:v.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(N=w.paint.get("raster-saturation"),N>0?1-1/(1.001-N):-N),u_contrast_factor:(P=w.paint.get("raster-contrast"),P>0?1/(1-P):1+P),u_spin_weights:ot(w.paint.get("raster-hue-rotate")),u_perspective_transform:S};var P,N};function ot(_){_*=Math.PI/180;const c=Math.sin(_),d=Math.cos(_);return[(2*d+1)/3,(-Math.sqrt(3)*c-d+1)/3,(Math.sqrt(3)*c-d+1)/3]}const Lt=s.create(),wn=(_,c,d,v,w,S,P,N,B,H,W,$,ae,pe,de,me)=>{const _e=w.transform,re={u_is_size_zoom_constant:+(_==="constant"||_==="source"),u_is_size_feature_constant:+(_==="constant"||_==="camera"),u_size_t:c?c.uSizeT:0,u_size:c?c.uSize:0,u_camera_to_center_distance:_e.cameraToCenterDistance,u_rotate_symbol:+d,u_aspect_ratio:_e.width/_e.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:S,u_label_plane_matrix:P,u_coord_matrix:N,u_is_text:+B,u_pitch_with_map:+v,u_texsize:H,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Lt,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Lt,u_up_vector:[0,-1,0]};return me.name==="globe"&&(re.u_tile_id=[W.canonical.x,W.canonical.y,1<<W.canonical.z],re.u_zoom_transition=$,re.u_inv_rot_matrix=pe,re.u_merc_center=ae,re.u_camera_forward=_e._camera.forward(),re.u_ecef_origin=s.globeECEFOrigin(_e.globeMatrix,W.toUnwrapped()),re.u_tile_matrix=Float32Array.from(_e.globeMatrix),re.u_up_vector=de),re},di=(_,c,d,v,w,S,P,N,B,H,W,$,ae,pe,de,me,_e)=>s.extend(wn(_,c,d,v,w,S,P,N,B,H,$,ae,pe,de,me,_e),{u_gamma_scale:v?w.transform.cameraToCenterDistance*Math.cos(w.terrain?0:w.transform._pitch):1,u_device_pixel_ratio:s.exported.devicePixelRatio,u_is_halo:+W}),Ur=(_,c,d,v,w,S,P,N,B,H,W,$,ae,pe,de,me)=>s.extend(di(_,c,d,v,w,S,P,N,!0,B,!0,W,$,ae,pe,de,me),{u_texsize_icon:H,u_texture_icon:1}),Fi=(_,c,d)=>({u_matrix:_,u_opacity:c,u_color:d}),xs=(_,c,d,v,w)=>s.extend(function(S,P,N){const B=P.imageManager.getPattern(S.toString()),{width:H,height:W}=P.imageManager.getPixelSize(),$=Math.pow(2,N.tileID.overscaledZ),ae=N.tileSize*Math.pow(2,P.transform.tileZoom)/$,pe=ae*(N.tileID.canonical.x+N.tileID.wrap*$),de=ae*N.tileID.canonical.y;return{u_image:0,u_pattern_tl:B.tl,u_pattern_br:B.br,u_texsize:[H,W],u_pattern_size:B.displaySize,u_tile_units_to_pixels:1/ri(N,1,P.transform.tileZoom),u_pixel_coord_upper:[pe>>16,de>>16],u_pixel_coord_lower:[65535&pe,65535&de]}}(v,d,w),{u_matrix:_,u_opacity:c}),oo={fillExtrusion:_=>({u_matrix:new s.UniformMatrix4f(_),u_lightpos:new s.Uniform3f(_),u_lightintensity:new s.Uniform1f(_),u_lightcolor:new s.Uniform3f(_),u_vertical_gradient:new s.Uniform1f(_),u_opacity:new s.Uniform1f(_),u_edge_radius:new s.Uniform1f(_),u_ao:new s.Uniform2f(_),u_tile_id:new s.Uniform3f(_),u_zoom_transition:new s.Uniform1f(_),u_inv_rot_matrix:new s.UniformMatrix4f(_),u_merc_center:new s.Uniform2f(_),u_up_dir:new s.Uniform3f(_),u_height_lift:new s.Uniform1f(_)}),fillExtrusionPattern:_=>({u_matrix:new s.UniformMatrix4f(_),u_lightpos:new s.Uniform3f(_),u_lightintensity:new s.Uniform1f(_),u_lightcolor:new s.Uniform3f(_),u_vertical_gradient:new s.Uniform1f(_),u_height_factor:new s.Uniform1f(_),u_edge_radius:new s.Uniform1f(_),u_ao:new s.Uniform2f(_),u_tile_id:new s.Uniform3f(_),u_zoom_transition:new s.Uniform1f(_),u_inv_rot_matrix:new s.UniformMatrix4f(_),u_merc_center:new s.Uniform2f(_),u_up_dir:new s.Uniform3f(_),u_height_lift:new s.Uniform1f(_),u_image:new s.Uniform1i(_),u_texsize:new s.Uniform2f(_),u_pixel_coord_upper:new s.Uniform2f(_),u_pixel_coord_lower:new s.Uniform2f(_),u_tile_units_to_pixels:new s.Uniform1f(_),u_opacity:new s.Uniform1f(_)}),fill:_=>({u_matrix:new s.UniformMatrix4f(_)}),fillPattern:_=>({u_matrix:new s.UniformMatrix4f(_),u_image:new s.Uniform1i(_),u_texsize:new s.Uniform2f(_),u_pixel_coord_upper:new s.Uniform2f(_),u_pixel_coord_lower:new s.Uniform2f(_),u_tile_units_to_pixels:new s.Uniform1f(_)}),fillOutline:_=>({u_matrix:new s.UniformMatrix4f(_),u_world:new s.Uniform2f(_)}),fillOutlinePattern:_=>({u_matrix:new s.UniformMatrix4f(_),u_world:new s.Uniform2f(_),u_image:new s.Uniform1i(_),u_texsize:new s.Uniform2f(_),u_pixel_coord_upper:new s.Uniform2f(_),u_pixel_coord_lower:new s.Uniform2f(_),u_tile_units_to_pixels:new s.Uniform1f(_)}),circle:_=>({u_camera_to_center_distance:new s.Uniform1f(_),u_extrude_scale:new s.UniformMatrix2f(_),u_device_pixel_ratio:new s.Uniform1f(_),u_matrix:new s.UniformMatrix4f(_),u_inv_rot_matrix:new s.UniformMatrix4f(_),u_merc_center:new s.Uniform2f(_),u_tile_id:new s.Uniform3f(_),u_zoom_transition:new s.Uniform1f(_),u_up_dir:new s.Uniform3f(_)}),collisionBox:_=>({u_matrix:new s.UniformMatrix4f(_),u_camera_to_center_distance:new s.Uniform1f(_),u_extrude_scale:new s.Uniform2f(_)}),collisionCircle:_=>({u_matrix:new s.UniformMatrix4f(_),u_inv_matrix:new s.UniformMatrix4f(_),u_camera_to_center_distance:new s.Uniform1f(_),u_viewport_size:new s.Uniform2f(_)}),debug:_=>({u_color:new s.UniformColor(_),u_matrix:new s.UniformMatrix4f(_),u_overlay:new s.Uniform1i(_),u_overlay_scale:new s.Uniform1f(_)}),clippingMask:_=>({u_matrix:new s.UniformMatrix4f(_)}),heatmap:_=>({u_extrude_scale:new s.Uniform1f(_),u_intensity:new s.Uniform1f(_),u_matrix:new s.UniformMatrix4f(_),u_inv_rot_matrix:new s.UniformMatrix4f(_),u_merc_center:new s.Uniform2f(_),u_tile_id:new s.Uniform3f(_),u_zoom_transition:new s.Uniform1f(_),u_up_dir:new s.Uniform3f(_)}),heatmapTexture:_=>({u_image:new s.Uniform1i(_),u_color_ramp:new s.Uniform1i(_),u_opacity:new s.Uniform1f(_)}),hillshade:_=>({u_matrix:new s.UniformMatrix4f(_),u_image:new s.Uniform1i(_),u_latrange:new s.Uniform2f(_),u_light:new s.Uniform2f(_),u_shadow:new s.UniformColor(_),u_highlight:new s.UniformColor(_),u_accent:new s.UniformColor(_)}),hillshadePrepare:_=>({u_matrix:new s.UniformMatrix4f(_),u_image:new s.Uniform1i(_),u_dimension:new s.Uniform2f(_),u_zoom:new s.Uniform1f(_),u_unpack:new s.Uniform4f(_)}),line:_=>({u_matrix:new s.UniformMatrix4f(_),u_pixels_to_tile_units:new s.UniformMatrix2f(_),u_device_pixel_ratio:new s.Uniform1f(_),u_units_to_pixels:new s.Uniform2f(_),u_dash_image:new s.Uniform1i(_),u_gradient_image:new s.Uniform1i(_),u_image_height:new s.Uniform1f(_),u_texsize:new s.Uniform2f(_),u_tile_units_to_pixels:new s.Uniform1f(_),u_alpha_discard_threshold:new s.Uniform1f(_),u_trim_offset:new s.Uniform2f(_)}),linePattern:_=>({u_matrix:new s.UniformMatrix4f(_),u_texsize:new s.Uniform2f(_),u_pixels_to_tile_units:new s.UniformMatrix2f(_),u_device_pixel_ratio:new s.Uniform1f(_),u_image:new s.Uniform1i(_),u_units_to_pixels:new s.Uniform2f(_),u_tile_units_to_pixels:new s.Uniform1f(_),u_alpha_discard_threshold:new s.Uniform1f(_)}),raster:_=>({u_matrix:new s.UniformMatrix4f(_),u_tl_parent:new s.Uniform2f(_),u_scale_parent:new s.Uniform1f(_),u_fade_t:new s.Uniform1f(_),u_opacity:new s.Uniform1f(_),u_image0:new s.Uniform1i(_),u_image1:new s.Uniform1i(_),u_brightness_low:new s.Uniform1f(_),u_brightness_high:new s.Uniform1f(_),u_saturation_factor:new s.Uniform1f(_),u_contrast_factor:new s.Uniform1f(_),u_spin_weights:new s.Uniform3f(_),u_perspective_transform:new s.Uniform2f(_)}),symbolIcon:_=>({u_is_size_zoom_constant:new s.Uniform1i(_),u_is_size_feature_constant:new s.Uniform1i(_),u_size_t:new s.Uniform1f(_),u_size:new s.Uniform1f(_),u_camera_to_center_distance:new s.Uniform1f(_),u_rotate_symbol:new s.Uniform1i(_),u_aspect_ratio:new s.Uniform1f(_),u_fade_change:new s.Uniform1f(_),u_matrix:new s.UniformMatrix4f(_),u_label_plane_matrix:new s.UniformMatrix4f(_),u_coord_matrix:new s.UniformMatrix4f(_),u_is_text:new s.Uniform1i(_),u_pitch_with_map:new s.Uniform1i(_),u_texsize:new s.Uniform2f(_),u_tile_id:new s.Uniform3f(_),u_zoom_transition:new s.Uniform1f(_),u_inv_rot_matrix:new s.UniformMatrix4f(_),u_merc_center:new s.Uniform2f(_),u_camera_forward:new s.Uniform3f(_),u_tile_matrix:new s.UniformMatrix4f(_),u_up_vector:new s.Uniform3f(_),u_ecef_origin:new s.Uniform3f(_),u_texture:new s.Uniform1i(_)}),symbolSDF:_=>({u_is_size_zoom_constant:new s.Uniform1i(_),u_is_size_feature_constant:new s.Uniform1i(_),u_size_t:new s.Uniform1f(_),u_size:new s.Uniform1f(_),u_camera_to_center_distance:new s.Uniform1f(_),u_rotate_symbol:new s.Uniform1i(_),u_aspect_ratio:new s.Uniform1f(_),u_fade_change:new s.Uniform1f(_),u_matrix:new s.UniformMatrix4f(_),u_label_plane_matrix:new s.UniformMatrix4f(_),u_coord_matrix:new s.UniformMatrix4f(_),u_is_text:new s.Uniform1i(_),u_pitch_with_map:new s.Uniform1i(_),u_texsize:new s.Uniform2f(_),u_texture:new s.Uniform1i(_),u_gamma_scale:new s.Uniform1f(_),u_device_pixel_ratio:new s.Uniform1f(_),u_tile_id:new s.Uniform3f(_),u_zoom_transition:new s.Uniform1f(_),u_inv_rot_matrix:new s.UniformMatrix4f(_),u_merc_center:new s.Uniform2f(_),u_camera_forward:new s.Uniform3f(_),u_tile_matrix:new s.UniformMatrix4f(_),u_up_vector:new s.Uniform3f(_),u_ecef_origin:new s.Uniform3f(_),u_is_halo:new s.Uniform1i(_)}),symbolTextAndIcon:_=>({u_is_size_zoom_constant:new s.Uniform1i(_),u_is_size_feature_constant:new s.Uniform1i(_),u_size_t:new s.Uniform1f(_),u_size:new s.Uniform1f(_),u_camera_to_center_distance:new s.Uniform1f(_),u_rotate_symbol:new s.Uniform1i(_),u_aspect_ratio:new s.Uniform1f(_),u_fade_change:new s.Uniform1f(_),u_matrix:new s.UniformMatrix4f(_),u_label_plane_matrix:new s.UniformMatrix4f(_),u_coord_matrix:new s.UniformMatrix4f(_),u_is_text:new s.Uniform1i(_),u_pitch_with_map:new s.Uniform1i(_),u_texsize:new s.Uniform2f(_),u_texsize_icon:new s.Uniform2f(_),u_texture:new s.Uniform1i(_),u_texture_icon:new s.Uniform1i(_),u_gamma_scale:new s.Uniform1f(_),u_device_pixel_ratio:new s.Uniform1f(_),u_is_halo:new s.Uniform1i(_)}),background:_=>({u_matrix:new s.UniformMatrix4f(_),u_opacity:new s.Uniform1f(_),u_color:new s.UniformColor(_)}),backgroundPattern:_=>({u_matrix:new s.UniformMatrix4f(_),u_opacity:new s.Uniform1f(_),u_image:new s.Uniform1i(_),u_pattern_tl:new s.Uniform2f(_),u_pattern_br:new s.Uniform2f(_),u_texsize:new s.Uniform2f(_),u_pattern_size:new s.Uniform2f(_),u_pixel_coord_upper:new s.Uniform2f(_),u_pixel_coord_lower:new s.Uniform2f(_),u_tile_units_to_pixels:new s.Uniform1f(_)}),terrainRaster:Lh,terrainDepth:Lh,skybox:_=>({u_matrix:new s.UniformMatrix4f(_),u_sun_direction:new s.Uniform3f(_),u_cubemap:new s.Uniform1i(_),u_opacity:new s.Uniform1f(_),u_temporal_offset:new s.Uniform1f(_)}),skyboxGradient:_=>({u_matrix:new s.UniformMatrix4f(_),u_color_ramp:new s.Uniform1i(_),u_center_direction:new s.Uniform3f(_),u_radius:new s.Uniform1f(_),u_opacity:new s.Uniform1f(_),u_temporal_offset:new s.Uniform1f(_)}),skyboxCapture:_=>({u_matrix_3f:new s.UniformMatrix3f(_),u_sun_direction:new s.Uniform3f(_),u_sun_intensity:new s.Uniform1f(_),u_color_tint_r:new s.Uniform4f(_),u_color_tint_m:new s.Uniform4f(_),u_luminance:new s.Uniform1f(_)}),globeRaster:_=>({u_proj_matrix:new s.UniformMatrix4f(_),u_globe_matrix:new s.UniformMatrix4f(_),u_normalize_matrix:new s.UniformMatrix4f(_),u_merc_matrix:new s.UniformMatrix4f(_),u_zoom_transition:new s.Uniform1f(_),u_merc_center:new s.Uniform2f(_),u_image0:new s.Uniform1i(_),u_grid_matrix:new s.UniformMatrix3f(_),u_skirt_height:new s.Uniform1f(_),u_frustum_tl:new s.Uniform3f(_),u_frustum_tr:new s.Uniform3f(_),u_frustum_br:new s.Uniform3f(_),u_frustum_bl:new s.Uniform3f(_),u_globe_pos:new s.Uniform3f(_),u_globe_radius:new s.Uniform1f(_),u_viewport:new s.Uniform2f(_)}),globeAtmosphere:_=>({u_frustum_tl:new s.Uniform3f(_),u_frustum_tr:new s.Uniform3f(_),u_frustum_br:new s.Uniform3f(_),u_frustum_bl:new s.Uniform3f(_),u_horizon:new s.Uniform1f(_),u_transition:new s.Uniform1f(_),u_fadeout_range:new s.Uniform1f(_),u_color:new s.Uniform4f(_),u_high_color:new s.Uniform4f(_),u_space_color:new s.Uniform4f(_),u_star_intensity:new s.Uniform1f(_),u_star_density:new s.Uniform1f(_),u_star_size:new s.Uniform1f(_),u_temporal_offset:new s.Uniform1f(_),u_horizon_angle:new s.Uniform1f(_),u_rotation_matrix:new s.UniformMatrix4f(_)})};let qo;function ao(_,c,d,v,w,S,P){const N=_.context,B=N.gl,H=_.transform,W=_.useProgram("collisionBox"),$=[];let ae=0,pe=0;for(let Se=0;Se<v.length;Se++){const ze=v[Se],De=c.getTile(ze),qe=De.getBucket(d);if(!qe)continue;const lt=bn(ze,qe,H);let ut=lt;w[0]===0&&w[1]===0||(ut=_.translatePosMatrix(lt,De,w,S));const gt=P?qe.textCollisionBox:qe.iconCollisionBox,nn=qe.collisionCircleArray;if(nn.length>0){const ft=s.create(),Ft=ut;s.mul(ft,qe.placementInvProjMatrix,H.glCoordMatrix),s.mul(ft,ft,qe.placementViewportMatrix),$.push({circleArray:nn,circleOffset:pe,transform:Ft,invTransform:ft,projection:qe.getProjection()}),ae+=nn.length/4,pe=ae}gt&&(_.terrain&&_.terrain.setupElevationDraw(De,W),W.draw(N,B.LINES,s.DepthMode.disabled,s.StencilMode.disabled,_.colorModeForRenderPass(),s.CullFaceMode.disabled,_p(ut,H,De,qe.getProjection()),d.id,gt.layoutVertexBuffer,gt.indexBuffer,gt.segments,null,H.zoom,null,[gt.collisionVertexBuffer,gt.collisionVertexBufferExt]))}if(!P||!$.length)return;const de=_.useProgram("collisionCircle"),me=new s.StructArrayLayout2f1f2i16;me.resize(4*ae),me._trim();let _e=0;for(const Se of $)for(let ze=0;ze<Se.circleArray.length/4;ze++){const De=4*ze,qe=Se.circleArray[De+0],lt=Se.circleArray[De+1],ut=Se.circleArray[De+2],gt=Se.circleArray[De+3];me.emplace(_e++,qe,lt,ut,gt,0),me.emplace(_e++,qe,lt,ut,gt,1),me.emplace(_e++,qe,lt,ut,gt,2),me.emplace(_e++,qe,lt,ut,gt,3)}(!qo||qo.length<2*ae)&&(qo=function(Se){const ze=2*Se,De=new s.StructArrayLayout3ui6;De.resize(ze),De._trim();for(let qe=0;qe<ze;qe++){const lt=6*qe;De.uint16[lt+0]=4*qe+0,De.uint16[lt+1]=4*qe+1,De.uint16[lt+2]=4*qe+2,De.uint16[lt+3]=4*qe+2,De.uint16[lt+4]=4*qe+3,De.uint16[lt+5]=4*qe+0}return De}(ae));const re=N.createIndexBuffer(qo,!0),Ie=N.createVertexBuffer(me,s.collisionCircleLayout.members,!0);for(const Se of $){const ze={u_matrix:Se.transform,u_inv_matrix:Se.invTransform,u_camera_to_center_distance:(Ee=H).getCameraToCenterDistance(Se.projection),u_viewport_size:[Ee.width,Ee.height]};de.draw(N,B.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,_.colorModeForRenderPass(),s.CullFaceMode.disabled,ze,d.id,Ie,re,s.SegmentVector.simpleSegment(0,2*Se.circleOffset,Se.circleArray.length,Se.circleArray.length/2),null,H.zoom)}var Ee;Ie.destroy(),re.destroy()}const Ks=s.create();function Vl({width:_,height:c,anchor:d,textOffset:v,textScale:w},S){const{horizontalAlign:P,verticalAlign:N}=s.getAnchorAlignment(d),B=-(P-.5)*_,H=-(N-.5)*c,W=s.evaluateVariableOffset(d,v);return new s.pointGeometry((B/w+W[0])*S,(H/w+W[1])*S)}function go(_,c,d,v,w,S,P,N,B,H,W){const $=_.text.placedSymbolArray,ae=_.text.dynamicLayoutVertexArray,pe=_.icon.dynamicLayoutVertexArray,de={},me=_.getProjection(),_e=xi(N,me,S),re=S.elevation,Ie=me.upVectorScale(N.canonical,S.center.lat,S.worldSize).metersToTile;ae.clear();for(let Ee=0;Ee<$.length;Ee++){const Se=$.get(Ee),{tileAnchorX:ze,tileAnchorY:De,numGlyphs:qe}=Se,lt=_.allowVerticalPlacement&&!Se.placedOrientation,ut=Se.hidden||!Se.crossTileID||lt?null:v[Se.crossTileID];if(ut){let gt=0,nn=0,ft=0;if(re){const Qn=re?re.getAtTileOffset(N,ze,De):0,[ji,Bn,An]=me.upVector(N.canonical,ze,De);gt=Qn*ji*Ie,nn=Qn*Bn*Ie,ft=Qn*An*Ie}let[Ft,xt,Wt,pt]=hn(Se.projectedAnchorX+gt,Se.projectedAnchorY+nn,Se.projectedAnchorZ+ft,d?_e:P);const at=Wi(S.getCameraToCenterDistance(me),pt);let yt=w.evaluateSizeForFeature(_.textSizeData,H,Se)*at/s.ONE_EM;d&&(yt*=_.tilePixelRatio/B);const Gt=Vl(ut,yt);d?({x:Ft,y:xt,z:Wt}=me.projectTilePoint(ze+Gt.x,De+Gt.y,N.canonical),[Ft,xt,Wt]=hn(Ft+gt,xt+nn,Wt+ft,P)):(c&&Gt._rotate(-S.angle),Ft+=Gt.x,xt+=Gt.y,Wt=0);const Ht=_.allowVerticalPlacement&&Se.placedOrientation===s.WritingMode.vertical?Math.PI/2:0;for(let Qn=0;Qn<qe;Qn++)s.addDynamicAttributes(ae,Ft,xt,Wt,Ht);W&&Se.associatedIconIndex>=0&&(de[Se.associatedIconIndex]={x:Ft,y:xt,z:Wt,angle:Ht})}else Qe(qe,ae)}if(W){pe.clear();const Ee=_.icon.placedSymbolArray;for(let Se=0;Se<Ee.length;Se++){const ze=Ee.get(Se),{numGlyphs:De}=ze,qe=de[Se];if(ze.hidden||!qe)Qe(De,pe);else{const{x:lt,y:ut,z:gt,angle:nn}=qe;for(let ft=0;ft<De;ft++)s.addDynamicAttributes(pe,lt,ut,gt,nn)}}_.icon.dynamicLayoutVertexBuffer.updateData(pe)}_.text.dynamicLayoutVertexBuffer.updateData(ae)}function it(_,c,d){return d.iconsInText&&c?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function Rt(_,c,d,v,w,S,P,N,B,H,W,$){const ae=_.context,pe=ae.gl,de=_.transform,me=N==="map",_e=B==="map",re=me&&d.layout.get("symbol-placement")!=="point",Ie=me&&!_e&&!re,Ee=d.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Se=!1;const ze=_.depthModeForSublayer(0,s.DepthMode.ReadOnly),De=[s.mercatorXfromLng(de.center.lng),s.mercatorYfromLat(de.center.lat)],qe=d.layout.get("text-variable-anchor"),lt=de.projection.name==="globe",ut=[],gt=[0,-1,0];let nn=gt;!lt&&!de.mercatorFromTransition||me||(nn=function(ft){const Ft=ft._camera.getWorldToCamera(ft.worldSize,1),xt=s.multiply([],Ft,ft.globeMatrix);s.invert(xt,xt);const Wt=[0,0,0],pt=[0,1,0,0];return s.transformMat4$1(pt,pt,xt),Wt[0]=pt[0],Wt[1]=pt[1],Wt[2]=pt[2],s.normalize(Wt,Wt),Wt}(de));for(const ft of v){const Ft=c.getTile(ft),xt=Ft.getBucket(d);if(!xt||xt.projection.name==="mercator"&&lt)continue;const Wt=w?xt.text:xt.icon;if(!Wt||xt.fullyClipped||!Wt.segments.get().length)continue;const pt=Wt.programConfigurations.get(d.id),at=w||xt.sdfIcons,yt=w?xt.textSizeData:xt.iconSizeData,Gt=_e||de.pitch!==0,Ht=s.evaluateSizeForZoom(yt,de.zoom);let Qn,ji,Bn,An,ni=[0,0],ir=null;if(w){if(ji=Ft.glyphAtlasTexture,Bn=pe.LINEAR,Qn=Ft.glyphAtlasTexture.size,xt.iconsInText){ni=Ft.imageAtlasTexture.size,ir=Ft.imageAtlasTexture;const $a=yt.kind==="composite"||yt.kind==="camera";An=Gt||_.options.rotating||_.options.zooming||$a?pe.LINEAR:pe.NEAREST}}else{const $a=d.layout.get("icon-size").constantOr(0)!==1||xt.iconsNeedLinear;ji=Ft.imageAtlasTexture,Bn=at||_.options.rotating||_.options.zooming||$a||Gt?pe.LINEAR:pe.NEAREST,Qn=Ft.imageAtlasTexture.size}const oi=xt.projection.name==="globe",Nr=oi?nn:gt,qr=oi?s.globeToMercatorTransition(de.zoom):0,cs=xi(ft,xt.getProjection(),de),Jr=de.calculatePixelsToTileUnitsMatrix(Ft),uo=Eu(cs,Ft.tileID.canonical,_e,me,de,xt.getProjection(),Jr),Qa=_.terrain&&_e&&re?s.invert(s.create(),uo):Ks,ru=rc(cs,Ft.tileID.canonical,_e,me,de,xt.getProjection(),Jr),su=qe&&xt.hasTextData(),bs=d.layout.get("icon-text-fit")!=="none"&&su&&xt.hasIconData();if(re){const $a=de.elevation,Pi=$a?$a.getAtTileOffsetFunc(ft,de.center.lat,de.worldSize,xt.getProjection()):null,Qc=cp(cs,Ft.tileID.canonical,_e,me,de,xt.getProjection(),Jr);Ca(xt,cs,_,w,Qc,ru,_e,H,Pi,ft)}const ts=re||w&&qe||bs,wr=_.translatePosMatrix(cs,Ft,S,P),Js=ts?Ks:uo,fa=_.translatePosMatrix(ru,Ft,S,P,!0),_s=xt.getProjection().createInversionMatrix(de,ft.canonical),na=[];_.terrainRenderModeElevated()&&_e&&na.push("PITCH_WITH_MAP_TERRAIN"),oi&&na.push("PROJECTION_GLOBE_VIEW"),ts&&na.push("PROJECTED_POS_ON_VIEWPORT");const da=at&&d.paint.get(w?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let _c;_c=at?xt.iconsInText?Ur(yt.kind,Ht,Ie,_e,_,wr,Js,fa,Qn,ni,ft,qr,De,_s,Nr,xt.getProjection()):di(yt.kind,Ht,Ie,_e,_,wr,Js,fa,w,Qn,!0,ft,qr,De,_s,Nr,xt.getProjection()):wn(yt.kind,Ht,Ie,_e,_,wr,Js,fa,w,Qn,ft,qr,De,_s,Nr,xt.getProjection());const Md={program:_.useProgram(it(at,w,xt),pt,na),buffers:Wt,uniformValues:_c,atlasTexture:ji,atlasTextureIcon:ir,atlasInterpolation:Bn,atlasInterpolationIcon:An,isSDF:at,hasHalo:da,tile:Ft,labelPlaneMatrixInv:Qa};if(Ee&&xt.canOverlap){Se=!0;const $a=Wt.segments.get();for(const Pi of $a)ut.push({segments:new s.SegmentVector([Pi]),sortKey:Pi.sortKey,state:Md})}else ut.push({segments:Wt.segments,sortKey:0,state:Md})}Se&&ut.sort((ft,Ft)=>ft.sortKey-Ft.sortKey);for(const ft of ut){const Ft=ft.state;if(_.terrain&&_.terrain.setupElevationDraw(Ft.tile,Ft.program,{useDepthForOcclusion:!lt,labelPlaneMatrixInv:Ft.labelPlaneMatrixInv}),ae.activeTexture.set(pe.TEXTURE0),Ft.atlasTexture.bind(Ft.atlasInterpolation,pe.CLAMP_TO_EDGE),Ft.atlasTextureIcon&&(ae.activeTexture.set(pe.TEXTURE1),Ft.atlasTextureIcon&&Ft.atlasTextureIcon.bind(Ft.atlasInterpolationIcon,pe.CLAMP_TO_EDGE)),Ft.isSDF){const xt=Ft.uniformValues;Ft.hasHalo&&(xt.u_is_halo=1,St(Ft.buffers,ft.segments,d,_,Ft.program,ze,W,$,xt)),xt.u_is_halo=0}St(Ft.buffers,ft.segments,d,_,Ft.program,ze,W,$,Ft.uniformValues)}}function St(_,c,d,v,w,S,P,N,B){const H=v.context,W=[_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer,_.globeExtVertexBuffer];w.draw(H,H.gl.TRIANGLES,S,P,N,s.CullFaceMode.disabled,B,d.id,_.layoutVertexBuffer,_.indexBuffer,c,d.paint,v.transform.zoom,_.programConfigurations.get(d.id),W)}function Yn(_,c,d,v,w,S,P){const N=_.context.gl,B=d.paint.get("fill-pattern"),H=B&&B.constantOr(1);let W,$,ae,pe,de;P?($=H&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",W=N.LINES):($=H?"fillPattern":"fill",W=N.TRIANGLES);for(const me of v){const _e=c.getTile(me);if(H&&!_e.patternsLoaded())continue;const re=_e.getBucket(d);if(!re)continue;_.prepareDrawTile();const Ie=re.programConfigurations.get(d.id),Ee=_.useProgram($,Ie);H&&(_.context.activeTexture.set(N.TEXTURE0),_e.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),Ie.updatePaintBuffers());const Se=B.constantOr(null);if(Se&&_e.imageAtlas){const De=_e.imageAtlas.patternPositions[Se.toString()];De&&Ie.setConstantPatternPositions(De)}const ze=_.translatePosMatrix(me.projMatrix,_e,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));if(P){pe=re.indexBuffer2,de=re.segments2;const De=_.terrain&&_.terrain.renderingToTexture?_.terrain.drapeBufferSize:[N.drawingBufferWidth,N.drawingBufferHeight];ae=$==="fillOutlinePattern"&&H?Oh(ze,_,_e,De):Mu(ze,De)}else pe=re.indexBuffer,de=re.segments,ae=H?mo(ze,_,_e):Dh(ze);_.prepareDrawProgram(_.context,Ee,me.toUnwrapped()),Ee.draw(_.context,W,w,_.stencilModeForClipping(me),S,s.CullFaceMode.disabled,ae,d.id,re.layoutVertexBuffer,pe,de,d.paint,_.transform.zoom,Ie)}}function Ii(_,c,d,v,w,S,P){const N=_.context,B=N.gl,H=_.transform,W=d.paint.get("fill-extrusion-pattern"),$=W.constantOr(1),ae=d.paint.get("fill-extrusion-opacity"),pe=[d.paint.get("fill-extrusion-ambient-occlusion-intensity"),d.paint.get("fill-extrusion-ambient-occlusion-radius")],de=d.layout.get("fill-extrusion-edge-radius"),me=H.projection.name==="globe"?s.fillExtrusionHeightLift():0,_e=H.projection.name==="globe",re=_e?s.globeToMercatorTransition(H.zoom):0,Ie=[s.mercatorXfromLng(H.center.lng),s.mercatorYfromLat(H.center.lat)],Ee=[];_e&&Ee.push("PROJECTION_GLOBE_VIEW"),pe[0]>0&&Ee.push("FAUX_AO");for(const Se of v){const ze=c.getTile(Se),De=ze.getBucket(d);if(!De||De.projection.name!==H.projection.name)continue;const qe=De.programConfigurations.get(d.id),lt=_.useProgram($?"fillExtrusionPattern":"fillExtrusion",qe,Ee);if(_.terrain){const Wt=_.terrain;if(_.style.terrainSetForDrapingOnly())Wt.setupElevationDraw(ze,lt,{useMeterToDem:!0});else{if(!De.enableTerrain)continue;if(Wt.setupElevationDraw(ze,lt,{useMeterToDem:!0}),Er(N,c,Se,De,d,Wt),!De.centroidVertexBuffer){const pt=lt.attributes.a_centroid_pos;pt!==void 0&&B.vertexAttrib2f(pt,0,0)}}}$&&(_.context.activeTexture.set(B.TEXTURE0),ze.imageAtlasTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),qe.updatePaintBuffers());const ut=W.constantOr(null);if(ut&&ze.imageAtlas){const Wt=ze.imageAtlas.patternPositions[ut.toString()];Wt&&qe.setConstantPatternPositions(Wt)}const gt=_.translatePosMatrix(Se.projMatrix,ze,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),nn=H.projection.createInversionMatrix(H,Se.canonical),ft=d.paint.get("fill-extrusion-vertical-gradient"),Ft=$?xd(gt,_,ft,ae,pe,de,Se,ze,me,re,Ie,nn):Rh(gt,_,ft,ae,pe,de,Se,me,re,Ie,nn);_.prepareDrawProgram(N,lt,Se.toUnwrapped());const xt=[];_.terrain&&xt.push(De.centroidVertexBuffer),_e&&xt.push(De.layoutVertexExtBuffer),lt.draw(N,N.gl.TRIANGLES,w,S,P,s.CullFaceMode.backCCW,Ft,d.id,De.layoutVertexBuffer,De.indexBuffer,De.segments,d.paint,_.transform.zoom,qe,xt)}}function Er(_,c,d,v,w,S){const P=[re=>{let Ie=re.canonical.x-1,Ee=re.wrap;return Ie<0&&(Ie=(1<<re.canonical.z)-1,Ee--),new s.OverscaledTileID(re.overscaledZ,Ee,re.canonical.z,Ie,re.canonical.y)},re=>{let Ie=re.canonical.x+1,Ee=re.wrap;return Ie===1<<re.canonical.z&&(Ie=0,Ee++),new s.OverscaledTileID(re.overscaledZ,Ee,re.canonical.z,Ie,re.canonical.y)},re=>new s.OverscaledTileID(re.overscaledZ,re.wrap,re.canonical.z,re.canonical.x,(re.canonical.y===0?1<<re.canonical.z:re.canonical.y)-1),re=>new s.OverscaledTileID(re.overscaledZ,re.wrap,re.canonical.z,re.canonical.x,re.canonical.y===(1<<re.canonical.z)-1?0:re.canonical.y+1)],N=re=>{const Ie=c.getSource().minzoom,Ee=ze=>{const De=c.getTileByID(ze);if(De&&De.hasData())return De.getBucket(w)},Se=[0,-1,1];for(const ze of Se){if(re.overscaledZ+ze<Ie)continue;const De=Ee(re.calculateScaledKey(re.overscaledZ+ze));if(De)return De}},B=[0,0,0],H=(re,Ie)=>(B[0]=Math.min(re.min.y,Ie.min.y),B[1]=Math.max(re.max.y,Ie.max.y),B[2]=s.EXTENT-Ie.min.x>re.max.x?Ie.min.x-s.EXTENT:re.max.x,B),W=(re,Ie)=>(B[0]=Math.min(re.min.x,Ie.min.x),B[1]=Math.max(re.max.x,Ie.max.x),B[2]=s.EXTENT-Ie.min.y>re.max.y?Ie.min.y-s.EXTENT:re.max.y,B),$=[(re,Ie)=>H(re,Ie),(re,Ie)=>H(Ie,re),(re,Ie)=>W(re,Ie),(re,Ie)=>W(Ie,re)],ae=new s.pointGeometry(0,0);let pe,de,me;const _e=(re,Ie,Ee,Se,ze)=>{const De=[[Se?Ee:re,Se?re:Ee,0],[Se?Ee:Ie,Se?Ie:Ee,0]],qe=ze<0?s.EXTENT+ze:ze,lt=[Se?qe:(re+Ie)/2,Se?(re+Ie)/2:qe,0];return Ee===0&&ze<0||Ee!==0&&ze>0?S.getForTilePoints(me,[lt],!0,de):De.push(lt),S.getForTilePoints(d,De,!0,pe),Math.max(De[0][2],De[1][2],lt[2])/S.exaggeration()};for(let re=0;re<4;re++){const Ie=(re<2?1:5)-re,Ee=v.borders[re];if(Ee.length===0)continue;const Se=me=P[re](d),ze=N(Se);if(!(ze&&ze instanceof s.FillExtrusionBucket&&ze.enableTerrain)||v.borderDoneWithNeighborZ[re]===ze.canonical.z&&ze.borderDoneWithNeighborZ[Ie]===v.canonical.z||(de=S.findDEMTileFor(Se),!de||!de.dem))continue;if(!pe){const ut=S.findDEMTileFor(d);if(!ut||!ut.dem)return;pe=ut}const De=ze.borders[Ie];let qe=0;const lt=ze.borderDoneWithNeighborZ[Ie]!==v.canonical.z;if(v.canonical.z===ze.canonical.z){for(let ut=0;ut<Ee.length;ut++){const gt=v.featuresOnBorder[Ee[ut]],nn=gt.borders[re];let ft;for(;qe<De.length&&(ft=ze.featuresOnBorder[De[qe]],!(ft.borders[Ie][1]>nn[0]+3));)lt&&ze.encodeCentroid(void 0,ft,!1),qe++;if(ft&&qe<De.length){const Ft=qe;let xt=0;for(;!(ft.borders[Ie][0]>nn[1]-3)&&(xt++,++qe!==De.length);)ft=ze.featuresOnBorder[De[qe]];if(ft=ze.featuresOnBorder[De[Ft]],gt.intersectsCount()>1||ft.intersectsCount()>1||xt!==1){xt!==1&&(qe=Ft),v.encodeCentroid(void 0,gt,!1),lt&&ze.encodeCentroid(void 0,ft,!1);continue}const Wt=$[re](gt,ft),pt=re%2?s.EXTENT-1:0;ae.x=_e(Wt[0],Math.min(s.EXTENT-1,Wt[1]),pt,re<2,Wt[2]),ae.y=0,v.encodeCentroid(ae,gt,!1),lt&&ze.encodeCentroid(ae,ft,!1)}else v.encodeCentroid(void 0,gt,!1)}v.borderDoneWithNeighborZ[re]=ze.canonical.z,v.needsCentroidUpdate=!0,lt&&(ze.borderDoneWithNeighborZ[Ie]=v.canonical.z,ze.needsCentroidUpdate=!0)}else{for(const ut of Ee)v.encodeCentroid(void 0,v.featuresOnBorder[ut],!1);if(lt){for(const ut of De)ze.encodeCentroid(void 0,ze.featuresOnBorder[ut],!1);ze.borderDoneWithNeighborZ[Ie]=v.canonical.z,ze.needsCentroidUpdate=!0}v.borderDoneWithNeighborZ[re]=ze.canonical.z,v.needsCentroidUpdate=!0}}(v.needsCentroidUpdate||!v.centroidVertexBuffer&&v.centroidVertexArray.length!==0)&&v.uploadCentroid(_)}const Vs=new s.Color(1,0,0,1),es=new s.Color(0,1,0,1),bd=new s.Color(0,0,1,1),rs=new s.Color(1,0,1,1),$i=new s.Color(0,1,1,1);function Du(_,c,d){const v=_.context,w=_.transform,S=v.gl,P=w.projection.name==="globe",N=P?["PROJECTION_GLOBE_VIEW"]:null;let B=d.projMatrix;if(P&&s.globeToMercatorTransition(w.zoom)>0){const gt=s.transitionTileAABBinECEF(d.canonical,w),nn=s.globeDenormalizeECEF(gt);B=s.multiply(new Float32Array(16),w.globeMatrix,nn),s.multiply(B,w.projMatrix,B)}const H=_.useProgram("debug",null,N),W=c.getTileByID(d.key);_.terrain&&_.terrain.setupElevationDraw(W,H);const $=s.DepthMode.disabled,ae=s.StencilMode.disabled,pe=_.colorModeForRenderPass(),de="$debug";v.activeTexture.set(S.TEXTURE0),_.emptyTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),P?W._makeGlobeTileDebugBuffers(_.context,w):W._makeDebugTileBoundsBuffers(_.context,w.projection);const me=W._tileDebugBuffer||_.debugBuffer,_e=W._tileDebugIndexBuffer||_.debugIndexBuffer,re=W._tileDebugSegments||_.debugSegments;H.draw(v,S.LINE_STRIP,$,ae,pe,s.CullFaceMode.disabled,Rf(B,s.Color.red),de,me,_e,re,null,null,null,[W._globeTileDebugBorderBuffer]);const Ie=W.latestRawTileData,Ee=Math.floor((Ie&&Ie.byteLength||0)/1024),Se=c.getTile(d).tileSize,ze=512/Math.min(Se,512)*(d.overscaledZ/w.zoom)*.5;let De=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(De+=` => ${d.overscaledZ}`),De+=` ${Ee}kb`,function(gt,nn){gt.initDebugOverlayCanvas();const ft=gt.debugOverlayCanvas,Ft=gt.context.gl,xt=gt.debugOverlayCanvas.getContext("2d");xt.clearRect(0,0,ft.width,ft.height),xt.shadowColor="white",xt.shadowBlur=2,xt.lineWidth=1.5,xt.strokeStyle="white",xt.textBaseline="top",xt.font="bold 36px Open Sans, sans-serif",xt.fillText(nn,5,5),xt.strokeText(nn,5,5),gt.debugOverlayTexture.update(ft),gt.debugOverlayTexture.bind(Ft.LINEAR,Ft.CLAMP_TO_EDGE)}(_,De);const qe=W._tileDebugTextBuffer||_.debugBuffer,lt=W._tileDebugTextIndexBuffer||_.quadTriangleIndexBuffer,ut=W._tileDebugTextSegments||_.debugSegments;H.draw(v,S.TRIANGLES,$,ae,s.ColorMode.alphaBlended,s.CullFaceMode.disabled,Rf(B,s.Color.transparent,ze),de,qe,lt,ut,null,null,null,[W._globeTileDebugTextBuffer])}function ha(_,c,d,v){_o(_,0,c+d/2,_.transform.width,d,v)}function Za(_,c,d,v){_o(_,c-d/2,0,d,_.transform.height,v)}function _o(_,c,d,v,w,S){const P=_.context,N=P.gl;N.enable(N.SCISSOR_TEST),N.scissor(c*s.exported.devicePixelRatio,d*s.exported.devicePixelRatio,v*s.exported.devicePixelRatio,w*s.exported.devicePixelRatio),P.clear({color:S}),N.disable(N.SCISSOR_TEST)}const Ho=s.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:er}=Ho;function Ya(_,c,d,v){_.emplaceBack(c,d,v)}class uc{constructor(c){this.vertexArray=new s.StructArrayLayout3f12,this.indices=new s.StructArrayLayout3ui6,Ya(this.vertexArray,-1,-1,1),Ya(this.vertexArray,1,-1,1),Ya(this.vertexArray,-1,1,1),Ya(this.vertexArray,1,1,1),Ya(this.vertexArray,-1,-1,-1),Ya(this.vertexArray,1,-1,-1),Ya(this.vertexArray,-1,1,-1),Ya(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=c.createVertexBuffer(this.vertexArray,er),this.indexBuffer=c.createIndexBuffer(this.indices),this.segment=s.SegmentVector.simpleSegment(0,0,36,12)}}function Oi(_,c,d,v,w,S){const P=_.gl,N=c.paint.get("sky-atmosphere-color"),B=c.paint.get("sky-atmosphere-halo-color"),H=c.paint.get("sky-atmosphere-sun-intensity"),W=(($,ae,pe,de,me)=>({u_matrix_3f:$,u_sun_direction:ae,u_sun_intensity:pe,u_color_tint_r:[de.r,de.g,de.b,de.a],u_color_tint_m:[me.r,me.g,me.b,me.a],u_luminance:5e-5}))(s.fromMat4(s.create$1(),v),w,H,N,B);P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,P.TEXTURE_CUBE_MAP_POSITIVE_X+S,c.skyboxTexture,0),d.draw(_,P.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.frontCW,W,"skyboxCapture",c.skyboxGeometry.vertexBuffer,c.skyboxGeometry.indexBuffer,c.skyboxGeometry.segment)}const eu=s.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class lm{constructor(c){const d=new s.StructArrayLayout5f20;d.emplaceBack(-1,1,1,0,0),d.emplaceBack(1,1,1,1,0),d.emplaceBack(1,-1,1,1,1),d.emplaceBack(-1,-1,1,0,1);const v=new s.StructArrayLayout3ui6;v.emplaceBack(0,1,2),v.emplaceBack(2,3,0),this.vertexBuffer=c.createVertexBuffer(d,eu.members),this.indexBuffer=c.createIndexBuffer(v),this.segments=s.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Bh={symbol:function(_,c,d,v,w){if(_.renderPass!=="translucent")return;const S=s.StencilMode.disabled,P=_.colorModeForRenderPass();d.layout.get("text-variable-anchor")&&function(N,B,H,W,$,ae,pe){const de=B.transform,me=$==="map",_e=ae==="map";for(const re of N){const Ie=W.getTile(re),Ee=Ie.getBucket(H);if(!Ee||!Ee.text||!Ee.text.segments.get().length)continue;const Se=s.evaluateSizeForZoom(Ee.textSizeData,de.zoom),ze=xi(re,Ee.getProjection(),de),De=de.calculatePixelsToTileUnitsMatrix(Ie),qe=Eu(ze,Ie.tileID.canonical,_e,me,de,Ee.getProjection(),De),lt=H.layout.get("icon-text-fit")!=="none"&&Ee.hasIconData();if(Se){const ut=Math.pow(2,de.zoom-Ie.tileID.overscaledZ);go(Ee,me,_e,pe,s.symbolSize,de,qe,re,ut,Se,lt)}}}(v,_,d,c,d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),w),d.paint.get("icon-opacity").constantOr(1)!==0&&Rt(_,c,d,v,!1,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),d.layout.get("icon-rotation-alignment"),d.layout.get("icon-pitch-alignment"),d.layout.get("icon-keep-upright"),S,P),d.paint.get("text-opacity").constantOr(1)!==0&&Rt(_,c,d,v,!0,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),d.layout.get("text-keep-upright"),S,P),c.map.showCollisionBoxes&&(ao(_,c,d,v,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),!0),ao(_,c,d,v,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),!1))},circle:function(_,c,d,v){if(_.renderPass!=="translucent")return;const w=d.paint.get("circle-opacity"),S=d.paint.get("circle-stroke-width"),P=d.paint.get("circle-stroke-opacity"),N=d.layout.get("circle-sort-key").constantOr(1)!==void 0;if(w.constantOr(1)===0&&(S.constantOr(1)===0||P.constantOr(1)===0))return;const B=_.context,H=B.gl,W=_.transform,$=_.depthModeForSublayer(0,s.DepthMode.ReadOnly),ae=s.StencilMode.disabled,pe=_.colorModeForRenderPass(),de=W.projection.name==="globe",me=[s.mercatorXfromLng(W.center.lng),s.mercatorYfromLat(W.center.lat)],_e=[];for(let Ie=0;Ie<v.length;Ie++){const Ee=v[Ie],Se=c.getTile(Ee),ze=Se.getBucket(d);if(!ze||ze.projection.name!==W.projection.name)continue;const De=ze.programConfigurations.get(d.id),qe=Ul(d);de&&qe.push("PROJECTION_GLOBE_VIEW");const lt=_.useProgram("circle",De,qe),ut=ze.layoutVertexBuffer,gt=ze.globeExtVertexBuffer,nn=ze.indexBuffer,ft=W.projection.createInversionMatrix(W,Ee.canonical),Ft={programConfiguration:De,program:lt,layoutVertexBuffer:ut,globeExtVertexBuffer:gt,indexBuffer:nn,uniformValues:Nh(_,Ee,Se,ft,me,d),tile:Se};if(N){const xt=ze.segments.get();for(const Wt of xt)_e.push({segments:new s.SegmentVector([Wt]),sortKey:Wt.sortKey,state:Ft})}else _e.push({segments:ze.segments,sortKey:0,state:Ft})}N&&_e.sort((Ie,Ee)=>Ie.sortKey-Ee.sortKey);const re={useDepthForOcclusion:!de};for(const Ie of _e){const{programConfiguration:Ee,program:Se,layoutVertexBuffer:ze,globeExtVertexBuffer:De,indexBuffer:qe,uniformValues:lt,tile:ut}=Ie.state,gt=Ie.segments;_.terrain&&_.terrain.setupElevationDraw(ut,Se,re),_.prepareDrawProgram(B,Se,ut.tileID.toUnwrapped()),Se.draw(B,H.TRIANGLES,$,ae,pe,s.CullFaceMode.disabled,lt,d.id,ze,qe,gt,d.paint,W.zoom,Ee,[De])}},heatmap:function(_,c,d,v){if(d.paint.get("heatmap-opacity")!==0)if(_.renderPass==="offscreen"){const w=_.context,S=w.gl,P=s.StencilMode.disabled,N=new s.ColorMode([S.ONE,S.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(pe,de,me,_e){const re=pe.gl,Ie=de.width*_e,Ee=de.height*_e;pe.activeTexture.set(re.TEXTURE1),pe.viewport.set([0,0,Ie,Ee]);let Se=me.heatmapFbo;if(!Se||Se&&(Se.width!==Ie||Se.height!==Ee)){Se&&Se.destroy();const ze=re.createTexture();re.bindTexture(re.TEXTURE_2D,ze),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_WRAP_S,re.CLAMP_TO_EDGE),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_WRAP_T,re.CLAMP_TO_EDGE),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_MIN_FILTER,re.LINEAR),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_MAG_FILTER,re.LINEAR),Se=me.heatmapFbo=pe.createFramebuffer(Ie,Ee,!1),function(De,qe,lt,ut,gt,nn){const ft=De.gl;ft.texImage2D(ft.TEXTURE_2D,0,De.isWebGL2&&De.extRenderToTextureHalfFloat?ft.RGBA16F:ft.RGBA,gt,nn,0,ft.RGBA,De.extRenderToTextureHalfFloat?De.isWebGL2?ft.HALF_FLOAT:De.extTextureHalfFloat.HALF_FLOAT_OES:ft.UNSIGNED_BYTE,null),ut.colorAttachment.set(lt)}(pe,0,ze,Se,Ie,Ee)}else re.bindTexture(re.TEXTURE_2D,Se.colorAttachment.get()),pe.bindFramebuffer.set(Se.framebuffer)})(w,_,d,_.transform.projection.name==="globe"?.5:.25),w.clear({color:s.Color.transparent});const B=_.transform,H=B.projection.name==="globe",W=H?["PROJECTION_GLOBE_VIEW"]:null,$=H?s.CullFaceMode.frontCCW:s.CullFaceMode.disabled,ae=[s.mercatorXfromLng(B.center.lng),s.mercatorYfromLat(B.center.lat)];for(let pe=0;pe<v.length;pe++){const de=v[pe];if(c.hasRenderableParent(de))continue;const me=c.getTile(de),_e=me.getBucket(d);if(!_e||_e.projection.name!==B.projection.name)continue;const re=_e.programConfigurations.get(d.id),Ie=_.useProgram("heatmap",re,W),{zoom:Ee}=_.transform;_.terrain&&_.terrain.setupElevationDraw(me,Ie),_.prepareDrawProgram(w,Ie,de.toUnwrapped());const Se=B.projection.createInversionMatrix(B,de.canonical);Ie.draw(w,S.TRIANGLES,s.DepthMode.disabled,P,N,$,dl(_,de,me,Se,ae,Ee,d.paint.get("heatmap-intensity")),d.id,_e.layoutVertexBuffer,_e.indexBuffer,_e.segments,d.paint,_.transform.zoom,re,H?[_e.globeExtVertexBuffer]:null)}w.viewport.set([0,0,_.width,_.height])}else _.renderPass==="translucent"&&(_.context.setColorMode(_.colorModeForRenderPass()),function(w,S){const P=w.context,N=P.gl,B=S.heatmapFbo;if(!B)return;P.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,B.colorAttachment.get()),P.activeTexture.set(N.TEXTURE1);let H=S.colorRampTexture;H||(H=S.colorRampTexture=new s.Texture(P,S.colorRamp,N.RGBA)),H.bind(N.LINEAR,N.CLAMP_TO_EDGE),w.useProgram("heatmapTexture").draw(P,N.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,w.colorModeForRenderPass(),s.CullFaceMode.disabled,((W,$,ae,pe)=>({u_image:0,u_color_ramp:1,u_opacity:$.paint.get("heatmap-opacity")}))(0,S),S.id,w.viewportBuffer,w.quadTriangleIndexBuffer,w.viewportSegments,S.paint,w.transform.zoom)}(_,d))},line:function(_,c,d,v){if(_.renderPass!=="translucent")return;const w=d.paint.get("line-opacity"),S=d.paint.get("line-width");if(w.constantOr(1)===0||S.constantOr(1)===0)return;const P=_.depthModeForSublayer(0,s.DepthMode.ReadOnly),N=_.colorModeForRenderPass(),B=_.terrain&&_.terrain.renderingToTexture?1:s.exported.devicePixelRatio,H=d.paint.get("line-dasharray"),W=H.constantOr(1),$=d.layout.get("line-cap"),ae=d.paint.get("line-pattern"),pe=ae.constantOr(1),de=d.paint.get("line-gradient"),me=pe?"linePattern":"line",_e=_.context,re=_e.gl,Ie=(Se=>{const ze=[];Fh(Se)&&ze.push("RENDER_LINE_DASH"),Se.paint.get("line-gradient")&&ze.push("RENDER_LINE_GRADIENT");const De=Se.paint.get("line-trim-offset");De[0]===0&&De[1]===0||ze.push("RENDER_LINE_TRIM_OFFSET");const qe=Se.paint.get("line-pattern").constantOr(1),lt=Se.paint.get("line-opacity").constantOr(1)!==1;return!qe&&lt&&ze.push("RENDER_LINE_ALPHA_DISCARD"),ze})(d);let Ee=Ie.includes("RENDER_LINE_ALPHA_DISCARD");_.terrain&&_.terrain.clipOrMaskOverlapStencilType()&&(Ee=!1);for(const Se of v){const ze=c.getTile(Se);if(pe&&!ze.patternsLoaded())continue;const De=ze.getBucket(d);if(!De)continue;_.prepareDrawTile();const qe=De.programConfigurations.get(d.id),lt=_.useProgram(me,qe,Ie),ut=ae.constantOr(null);if(ut&&ze.imageAtlas){const at=ze.imageAtlas.patternPositions[ut.toString()];at&&qe.setConstantPatternPositions(at)}const gt=H.constantOr(null),nn=$.constantOr(null);if(!pe&&gt&&nn&&ze.lineAtlas){const at=ze.lineAtlas.getDash(gt,nn);at&&qe.setConstantPatternPositions(at)}let[ft,Ft]=d.paint.get("line-trim-offset");(nn==="round"||nn==="square")&&ft!==Ft&&(ft===0&&(ft-=1),Ft===1&&(Ft+=1));const xt=_.terrain?Se.projMatrix:null,Wt=pe?yp(_,ze,d,xt,B):Pu(_,ze,d,xt,De.lineClipsArray.length,B,[ft,Ft]);if(de){const at=De.gradients[d.id];let yt=at.texture;if(d.gradientVersion!==at.version){let Gt=256;if(d.stepInterpolant){const Ht=c.getSource().maxzoom,Qn=Se.canonical.z===Ht?Math.ceil(1<<_.transform.maxZoom-Se.canonical.z):1;Gt=s.clamp(s.nextPowerOfTwo(De.maxLineLength/s.EXTENT*1024*Qn),256,_e.maxTextureSize)}at.gradient=s.renderColorRamp({expression:d.gradientExpression(),evaluationKey:"lineProgress",resolution:Gt,image:at.gradient||void 0,clips:De.lineClipsArray}),at.texture?at.texture.update(at.gradient):at.texture=new s.Texture(_e,at.gradient,re.RGBA),at.version=d.gradientVersion,yt=at.texture}_e.activeTexture.set(re.TEXTURE1),yt.bind(d.stepInterpolant?re.NEAREST:re.LINEAR,re.CLAMP_TO_EDGE)}W&&(_e.activeTexture.set(re.TEXTURE0),ze.lineAtlasTexture.bind(re.LINEAR,re.REPEAT),qe.updatePaintBuffers()),pe&&(_e.activeTexture.set(re.TEXTURE0),ze.imageAtlasTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE),qe.updatePaintBuffers()),_.prepareDrawProgram(_e,lt,Se.toUnwrapped());const pt=at=>{lt.draw(_e,re.TRIANGLES,P,at,N,s.CullFaceMode.disabled,Wt,d.id,De.layoutVertexBuffer,De.indexBuffer,De.segments,d.paint,_.transform.zoom,qe,[De.layoutVertexBuffer2])};if(Ee){const at=_.stencilModeForClipping(Se).ref;at===0&&_.terrain&&_e.clear({stencil:0});const yt={func:re.EQUAL,mask:255};Wt.u_alpha_discard_threshold=.8,pt(new s.StencilMode(yt,at,255,re.KEEP,re.KEEP,re.INVERT)),Wt.u_alpha_discard_threshold=0,pt(new s.StencilMode(yt,at,255,re.KEEP,re.KEEP,re.KEEP))}else pt(_.stencilModeForClipping(Se))}Ee&&(_.resetStencilClippingMasks(),_.terrain&&_e.clear({stencil:0}))},fill:function(_,c,d,v){const w=d.paint.get("fill-color"),S=d.paint.get("fill-opacity");if(S.constantOr(1)===0)return;const P=_.colorModeForRenderPass(),N=d.paint.get("fill-pattern"),B=_.opaquePassEnabledForLayer()&&!N.constantOr(1)&&w.constantOr(s.Color.transparent).a===1&&S.constantOr(0)===1?"opaque":"translucent";if(_.renderPass===B){const H=_.depthModeForSublayer(1,_.renderPass==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly);Yn(_,c,d,v,H,P,!1)}if(_.renderPass==="translucent"&&d.paint.get("fill-antialias")){const H=_.depthModeForSublayer(d.getPaintProperty("fill-outline-color")?2:0,s.DepthMode.ReadOnly);Yn(_,c,d,v,H,P,!0)}},"fill-extrusion":function(_,c,d,v){const w=d.paint.get("fill-extrusion-opacity");if(w!==0&&_.renderPass==="translucent"){const S=new s.DepthMode(_.context.gl.LEQUAL,s.DepthMode.ReadWrite,_.depthRangeFor3D);if(w!==1||d.paint.get("fill-extrusion-pattern").constantOr(1))Ii(_,c,d,v,S,s.StencilMode.disabled,s.ColorMode.disabled),Ii(_,c,d,v,S,_.stencilModeFor3D(),_.colorModeForRenderPass()),_.resetStencilClippingMasks();else{const P=_.colorModeForRenderPass();Ii(_,c,d,v,S,s.StencilMode.disabled,P)}}},hillshade:function(_,c,d,v){if(_.renderPass!=="offscreen"&&_.renderPass!=="translucent")return;const w=_.context,S=_.depthModeForSublayer(0,s.DepthMode.ReadOnly),P=_.colorModeForRenderPass(),N=_.terrain&&_.terrain.renderingToTexture,[B,H]=_.renderPass!=="translucent"||N?[{},v]:_.stencilConfigForOverlap(v);for(const W of H){const $=c.getTile(W);if($.needsHillshadePrepare&&_.renderPass==="offscreen")Bl(_,$,d,S,s.StencilMode.disabled,P);else if(_.renderPass==="translucent"){const ae=N&&_.terrain?_.terrain.stencilModeForRTTOverlap(W):B[W.overscaledZ];Tu(_,W,$,d,S,ae,P)}}w.viewport.set([0,0,_.width,_.height]),_.resetStencilClippingMasks()},raster:function(_,c,d,v,w,S){if(_.renderPass!=="translucent"||d.paint.get("raster-opacity")===0||!v.length)return;const P=_.context,N=P.gl,B=c.getSource(),H=_.useProgram("raster"),W=_.colorModeForRenderPass(),$=_.terrain&&_.terrain.renderingToTexture,[ae,pe]=B instanceof Be||$?[{},v]:_.stencilConfigForOverlap(v),de=pe[pe.length-1].overscaledZ,me=!_.options.moving;for(const _e of pe){const re=$?s.DepthMode.disabled:_.depthModeForSublayer(_e.overscaledZ-de,d.paint.get("raster-opacity")===1?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly,N.LESS),Ie=_e.toUnwrapped(),Ee=c.getTile(_e);if($&&(!Ee||!Ee.hasData()))continue;const Se=$?_e.projMatrix:_.transform.calculateProjMatrix(Ie,me),ze=_.terrain&&$?_.terrain.stencilModeForRTTOverlap(_e):ae[_e.overscaledZ],De=S?0:d.paint.get("raster-fade-duration");Ee.registerFadeDuration(De);const qe=c.findLoadedParent(_e,0),lt=oc(Ee,qe,c,_.transform,De);let ut,gt;_.terrain&&_.terrain.prepareDrawTile();const nn=d.paint.get("raster-resampling")==="nearest"?N.NEAREST:N.LINEAR;P.activeTexture.set(N.TEXTURE0),Ee.texture.bind(nn,N.CLAMP_TO_EDGE),P.activeTexture.set(N.TEXTURE1),qe?(qe.texture.bind(nn,N.CLAMP_TO_EDGE),ut=Math.pow(2,qe.tileID.overscaledZ-Ee.tileID.overscaledZ),gt=[Ee.tileID.canonical.x*ut%1,Ee.tileID.canonical.y*ut%1]):Ee.texture.bind(nn,N.CLAMP_TO_EDGE);const ft=lc(Se,gt||[0,0],ut||1,lt,d,B instanceof Be?B.perspectiveTransform:[0,0]);if(_.prepareDrawProgram(P,H,Ie),B instanceof Be)B.boundsBuffer&&B.boundsSegments&&H.draw(P,N.TRIANGLES,re,s.StencilMode.disabled,W,s.CullFaceMode.disabled,ft,d.id,B.boundsBuffer,_.quadTriangleIndexBuffer,B.boundsSegments);else{const{tileBoundsBuffer:Ft,tileBoundsIndexBuffer:xt,tileBoundsSegments:Wt}=_.getTileBoundsBuffers(Ee);H.draw(P,N.TRIANGLES,re,ze,W,s.CullFaceMode.disabled,ft,d.id,Ft,xt,Wt)}}_.resetStencilClippingMasks()},background:function(_,c,d,v){const w=d.paint.get("background-color"),S=d.paint.get("background-opacity");if(S===0)return;const P=_.context,N=P.gl,B=_.transform,H=B.tileSize,W=d.paint.get("background-pattern");if(_.isPatternMissing(W))return;const $=!W&&w.a===1&&S===1&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass!==$)return;const ae=s.StencilMode.disabled,pe=_.depthModeForSublayer(0,$==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly),de=_.colorModeForRenderPass(),me=_.useProgram(W?"backgroundPattern":"background");let _e,re=v;re||(_e=_.getBackgroundTiles(),re=Object.values(_e).map(Ie=>Ie.tileID)),W&&(P.activeTexture.set(N.TEXTURE0),_.imageManager.bind(_.context));for(const Ie of re){const Ee=Ie.toUnwrapped(),Se=v?Ie.projMatrix:_.transform.calculateProjMatrix(Ee);_.prepareDrawTile();const ze=c?c.getTile(Ie):_e?_e[Ie.key]:new s.Tile(Ie,H,B.zoom,_),De=W?xs(Se,S,_,W,{tileID:Ie,tileSize:H}):Fi(Se,S,w);_.prepareDrawProgram(P,me,Ee);const{tileBoundsBuffer:qe,tileBoundsIndexBuffer:lt,tileBoundsSegments:ut}=_.getTileBoundsBuffers(ze);me.draw(P,N.TRIANGLES,pe,ae,de,s.CullFaceMode.disabled,De,d.id,qe,lt,ut)}},sky:function(_,c,d){const v=_.transform,w=v.projection.name==="mercator"||v.projection.name==="globe"?1:s.smoothstep(7,8,v.zoom),S=d.paint.get("sky-opacity")*w;if(S===0)return;const P=_.context,N=d.paint.get("sky-type"),B=new s.DepthMode(P.gl.LEQUAL,s.DepthMode.ReadOnly,[0,1]),H=_.frameCounter/1e3%1;N==="atmosphere"?_.renderPass==="offscreen"?d.needsSkyboxCapture(_)&&(function(W,$,ae,pe){const de=W.context,me=de.gl;let _e=$.skyboxFbo;if(!_e){_e=$.skyboxFbo=de.createFramebuffer(32,32,!1),$.skyboxGeometry=new uc(de),$.skyboxTexture=de.gl.createTexture(),me.bindTexture(me.TEXTURE_CUBE_MAP,$.skyboxTexture),me.texParameteri(me.TEXTURE_CUBE_MAP,me.TEXTURE_WRAP_S,me.CLAMP_TO_EDGE),me.texParameteri(me.TEXTURE_CUBE_MAP,me.TEXTURE_WRAP_T,me.CLAMP_TO_EDGE),me.texParameteri(me.TEXTURE_CUBE_MAP,me.TEXTURE_MIN_FILTER,me.LINEAR),me.texParameteri(me.TEXTURE_CUBE_MAP,me.TEXTURE_MAG_FILTER,me.LINEAR);for(let Se=0;Se<6;++Se)me.texImage2D(me.TEXTURE_CUBE_MAP_POSITIVE_X+Se,0,me.RGBA,32,32,0,me.RGBA,me.UNSIGNED_BYTE,null)}de.bindFramebuffer.set(_e.framebuffer),de.viewport.set([0,0,32,32]);const re=$.getCenter(W,!0),Ie=W.useProgram("skyboxCapture"),Ee=new Float64Array(16);s.identity(Ee),s.rotateY(Ee,Ee,.5*-Math.PI),Oi(de,$,Ie,Ee,re,0),s.identity(Ee),s.rotateY(Ee,Ee,.5*Math.PI),Oi(de,$,Ie,Ee,re,1),s.identity(Ee),s.rotateX(Ee,Ee,.5*-Math.PI),Oi(de,$,Ie,Ee,re,2),s.identity(Ee),s.rotateX(Ee,Ee,.5*Math.PI),Oi(de,$,Ie,Ee,re,3),s.identity(Ee),Oi(de,$,Ie,Ee,re,4),s.identity(Ee),s.rotateY(Ee,Ee,Math.PI),Oi(de,$,Ie,Ee,re,5),de.viewport.set([0,0,W.width,W.height])}(_,d),d.markSkyboxValid(_)):_.renderPass==="sky"&&function(W,$,ae,pe,de){const me=W.context,_e=me.gl,re=W.transform,Ie=W.useProgram("skybox");me.activeTexture.set(_e.TEXTURE0),_e.bindTexture(_e.TEXTURE_CUBE_MAP,$.skyboxTexture);const Ee=((Se,ze,De,qe,lt)=>({u_matrix:Se,u_sun_direction:ze,u_cubemap:0,u_opacity:qe,u_temporal_offset:lt}))(re.skyboxMatrix,$.getCenter(W,!1),0,pe,de);W.prepareDrawProgram(me,Ie),Ie.draw(me,_e.TRIANGLES,ae,s.StencilMode.disabled,W.colorModeForRenderPass(),s.CullFaceMode.backCW,Ee,"skybox",$.skyboxGeometry.vertexBuffer,$.skyboxGeometry.indexBuffer,$.skyboxGeometry.segment)}(_,d,B,S,H):N==="gradient"&&_.renderPass==="sky"&&function(W,$,ae,pe,de){const me=W.context,_e=me.gl,re=W.transform,Ie=W.useProgram("skyboxGradient");$.skyboxGeometry||($.skyboxGeometry=new uc(me)),me.activeTexture.set(_e.TEXTURE0);let Ee=$.colorRampTexture;Ee||(Ee=$.colorRampTexture=new s.Texture(me,$.colorRamp,_e.RGBA)),Ee.bind(_e.LINEAR,_e.CLAMP_TO_EDGE);const Se=((ze,De,qe,lt,ut)=>({u_matrix:ze,u_color_ramp:0,u_center_direction:De,u_radius:s.degToRad(qe),u_opacity:lt,u_temporal_offset:ut}))(re.skyboxMatrix,$.getCenter(W,!1),$.paint.get("sky-gradient-radius"),pe,de);W.prepareDrawProgram(me,Ie),Ie.draw(me,_e.TRIANGLES,ae,s.StencilMode.disabled,W.colorModeForRenderPass(),s.CullFaceMode.backCW,Se,"skyboxGradient",$.skyboxGeometry.vertexBuffer,$.skyboxGeometry.indexBuffer,$.skyboxGeometry.segment)}(_,d,B,S,H)},debug:function(_,c,d){for(let v=0;v<d.length;v++)Du(_,c,d[v])},custom:function(_,c,d,v){const w=_.context,S=d.implementation;if(!_.transform.projection.unsupportedLayers||!_.transform.projection.unsupportedLayers.includes("custom")||_.terrain&&(_.terrain.renderingToTexture||_.renderPass==="offscreen")&&d.isLayerDraped()){if(_.renderPass==="offscreen"){const P=S.prerender;if(P){if(_.setCustomLayerDefaults(),w.setColorMode(_.colorModeForRenderPass()),_.transform.projection.name==="globe"){const N=_.transform.pointMerc;P.call(S,w.gl,_.transform.customLayerMatrix(),_.transform.getProjection(),_.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(_.transform.zoom),[N.x,N.y],_.transform.pixelsPerMeterRatio)}else P.call(S,w.gl,_.transform.customLayerMatrix());w.setDirty(),_.setBaseState()}}else if(_.renderPass==="translucent"){if(_.terrain&&_.terrain.renderingToTexture){const N=S.renderToTile;if(N){const B=v[0].canonical,H=new s.MercatorCoordinate(B.x+v[0].wrap*(1<<B.z),B.y,B.z);w.setDepthMode(s.DepthMode.disabled),w.setStencilMode(s.StencilMode.disabled),w.setColorMode(_.colorModeForRenderPass()),_.setCustomLayerDefaults(),N.call(S,w.gl,H),w.setDirty(),_.setBaseState()}return}_.setCustomLayerDefaults(),w.setColorMode(_.colorModeForRenderPass()),w.setStencilMode(s.StencilMode.disabled);const P=S.renderingMode==="3d"?new s.DepthMode(_.context.gl.LEQUAL,s.DepthMode.ReadWrite,_.depthRangeFor3D):_.depthModeForSublayer(0,s.DepthMode.ReadOnly);if(w.setDepthMode(P),_.transform.projection.name==="globe"){const N=_.transform.pointMerc;S.render(w.gl,_.transform.customLayerMatrix(),_.transform.getProjection(),_.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(_.transform.zoom),[N.x,N.y],_.transform.pixelsPerMeterRatio)}else S.render(w.gl,_.transform.customLayerMatrix());w.setDirty(),_.setBaseState(),w.bindFramebuffer.set(null)}}else s.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class tu{constructor(c,d,v=!1){this.context=new xe(c,v),this.transform=d,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=s.SourceCache.maxUnderzooming+s.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new hp,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(c,d){const v=!!c&&!!c.terrain&&this.transform.projection.supportsTerrain;if(!(v||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Au(this,c));const w=this._terrain;this.transform.elevation=v?w:null,w.update(c,this.transform,d)}_updateFog(c){const d=c.fog;if(!d||this.transform.projection.name==="globe"||d.getOpacity(this.transform.pitch)<1||d.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[v,w]=d.getFovAdjustedRange(this.transform._fov);if(v>w)return void(this.transform.fogCullDistSq=null);const S=v+.78*(w-v);this.transform.fogCullDistSq=S*S}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(c,d){if(this.width=c*s.exported.devicePixelRatio,this.height=d*s.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const v of this.style.order)this.style._layers[v].resize()}setup(){const c=this.context,d=new s.StructArrayLayout2i4;d.emplaceBack(0,0),d.emplaceBack(s.EXTENT,0),d.emplaceBack(0,s.EXTENT),d.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=c.createVertexBuffer(d,s.posAttributes.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);const v=new s.StructArrayLayout2i4;v.emplaceBack(0,0),v.emplaceBack(s.EXTENT,0),v.emplaceBack(0,s.EXTENT),v.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=c.createVertexBuffer(v,s.posAttributes.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);const w=new s.StructArrayLayout2i4;w.emplaceBack(-1,-1),w.emplaceBack(1,-1),w.emplaceBack(-1,1),w.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(w,s.posAttributes.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);const S=new s.StructArrayLayout4i8;S.emplaceBack(0,0,0,0),S.emplaceBack(s.EXTENT,0,s.EXTENT,0),S.emplaceBack(0,s.EXTENT,0,s.EXTENT),S.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.mercatorBoundsBuffer=c.createVertexBuffer(S,s.boundsAttributes.members),this.mercatorBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);const P=new s.StructArrayLayout3ui6;P.emplaceBack(0,1,2),P.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(P);const N=new s.StructArrayLayout1ui2;for(const H of[0,1,3,2,0])N.emplaceBack(H);this.debugIndexBuffer=c.createIndexBuffer(N),this.emptyTexture=new s.Texture(c,new s.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),c.gl.RGBA),this.identityMat=s.create();const B=this.context.gl;this.stencilClearMode=new s.StencilMode({func:B.ALWAYS,mask:0},0,255,B.ZERO,B.ZERO,B.ZERO),this.loadTimeStamps.push(s.window.performance.now()),this.atmosphereBuffer=new lm(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(c){return c._makeTileBoundsBuffers(this.context,this.transform.projection),c._tileBoundsBuffer?{tileBoundsBuffer:c._tileBoundsBuffer,tileBoundsIndexBuffer:c._tileBoundsIndexBuffer,tileBoundsSegments:c._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const c=this.context,d=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(c,d.TRIANGLES,s.DepthMode.disabled,this.stencilClearMode,s.ColorMode.disabled,s.CullFaceMode.disabled,Mi(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(c,d,v){if(!d||this.currentStencilSource===d.id||!c.isTileClipped()||!v||v.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let N=!1;for(const B of v)if(this._tileClippingMaskIDs[B.key]===void 0){N=!0;break}if(!N)return}this.currentStencilSource=d.id;const w=this.context,S=w.gl;this.nextStencilID+v.length>256&&this.clearStencil(),w.setColorMode(s.ColorMode.disabled),w.setDepthMode(s.DepthMode.disabled);const P=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const N of v){const B=d.getTile(N),H=this._tileClippingMaskIDs[N.key]=this.nextStencilID++,{tileBoundsBuffer:W,tileBoundsIndexBuffer:$,tileBoundsSegments:ae}=this.getTileBoundsBuffers(B);P.draw(w,S.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:S.ALWAYS,mask:0},H,255,S.KEEP,S.KEEP,S.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,Mi(N.projMatrix),"$clipping",W,$,ae)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const c=this.nextStencilID++,d=this.context.gl;return new s.StencilMode({func:d.NOTEQUAL,mask:255},c,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(c){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(c);const d=this.context.gl;return new s.StencilMode({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(c){const d=this.context.gl,v=c.sort((P,N)=>N.overscaledZ-P.overscaledZ),w=v[v.length-1].overscaledZ,S=v[0].overscaledZ-w+1;if(S>1){this.currentStencilSource=void 0,this.nextStencilID+S>256&&this.clearStencil();const P={};for(let N=0;N<S;N++)P[N+w]=new s.StencilMode({func:d.GEQUAL,mask:255},N+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=S,[P,v]}return[{[w]:s.StencilMode.disabled},v]}colorModeForRenderPass(){const c=this.context.gl;return this._showOverdrawInspector?new s.ColorMode([c.CONSTANT_COLOR,c.ONE],new s.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?s.ColorMode.unblended:s.ColorMode.alphaBlended}depthModeForSublayer(c,d,v){if(!this.opaquePassEnabledForLayer())return s.DepthMode.disabled;const w=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new s.DepthMode(v||this.context.gl.LEQUAL,d,[w,w])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(c,d){this.style=c,this.options=d,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(s.exported.now()),this.imageManager.beginFrame();const v=this.style.order,w=this.style._sourceCaches;for(const B in w){const H=w[B];H.used&&H.prepare(this.context)}const S={},P={},N={};for(const B in w){const H=w[B];S[B]=H.getVisibleCoordinates(),P[B]=S[B].slice().reverse(),N[B]=H.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let B=0;B<v.length;B++)if(this.style._layers[v[B]].is3D()){this.opaquePassCutoff=B;break}if(this.terrain&&(this.terrain.updateTileBinding(N),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.GlobeSharedBuffers(this.context)),s.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const B of v){const H=this.style._layers[B],W=c._getLayerSourceCache(H);if(!H.hasOffscreenPass()||H.isHidden(this.transform.zoom))continue;const $=W?P[W.id]:void 0;(H.type==="custom"||H.isSky()||$&&$.length)&&this.renderLayer(this,W,H,$)}if(this.depthRangeFor3D=[0,1-(c.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:d.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=v.length-1;this.currentLayer>=0;this.currentLayer--){const B=this.style._layers[v[this.currentLayer]],H=c._getLayerSourceCache(B);if(B.isSky())continue;const W=H?P[H.id]:void 0;this._renderTileClippingMasks(B,H,W),this.renderLayer(this,H,B,W)}if(this.style.fog&&this.transform.projection.supportsFog&&function(B,H){const W=B.context,$=W.gl,ae=B.transform,pe=new s.DepthMode($.LEQUAL,s.DepthMode.ReadOnly,[0,1]),de=B.useProgram("globeAtmosphere",null,ae.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),me=s.globeToMercatorTransition(ae.zoom),_e=H.properties.get("color").toArray01(),re=H.properties.get("high-color").toArray01(),Ie=H.properties.get("space-color").toArray01PremultipliedAlpha(),Ee=s.identity$1([]);s.rotateY$1(Ee,Ee,-s.degToRad(ae._center.lng)),s.rotateX$1(Ee,Ee,s.degToRad(ae._center.lat)),s.rotateZ$1(Ee,Ee,ae.angle),s.rotateX$1(Ee,Ee,-ae._pitch);const Se=s.fromQuat(new Float32Array(16),Ee),ze=s.mapValue(H.properties.get("star-intensity"),0,1,0,.25),De=5e-4,qe=s.mapValue(H.properties.get("horizon-blend"),0,1,De,.25),lt=s.globeUseCustomAntiAliasing(B,W,ae)&&qe===De?ae.worldSize/(2*Math.PI*1.025)-1:ae.globeRadius,ut=B.frameCounter/1e3%1,gt=s.length(ae.globeCenterInViewSpace),nn=Math.sqrt(Math.pow(gt,2)-Math.pow(lt,2)),ft=Math.acos(nn/gt),Ft=((Wt,pt,at,yt,Gt,Ht,Qn,ji,Bn,An,ni,ir,oi,Nr)=>({u_frustum_tl:Wt,u_frustum_tr:pt,u_frustum_br:at,u_frustum_bl:yt,u_horizon:Gt,u_transition:Ht,u_fadeout_range:Qn,u_color:ji,u_high_color:Bn,u_space_color:An,u_star_intensity:ni,u_star_size:5*s.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:ir,u_horizon_angle:oi,u_rotation_matrix:Nr}))(ae.frustumCorners.TL,ae.frustumCorners.TR,ae.frustumCorners.BR,ae.frustumCorners.BL,ae.frustumCorners.horizon,me,qe,_e,re,Ie,ze,ut,ft,Se);B.prepareDrawProgram(W,de);const xt=B.atmosphereBuffer;xt&&de.draw(W,$.TRIANGLES,pe,s.StencilMode.disabled,s.ColorMode.alphaBlended,s.CullFaceMode.backCW,Ft,"skybox",xt.vertexBuffer,xt.indexBuffer,xt.segments)}(this,this.style.fog),this.renderPass="sky",(s.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<v.length;this.currentLayer++){const B=this.style._layers[v[this.currentLayer]],H=c._getLayerSourceCache(B);B.isSky()&&this.renderLayer(this,H,B,H?P[H.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<v.length;){const B=this.style._layers[v[this.currentLayer]],H=c._getLayerSourceCache(B);if(B.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(B)){if(B.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const W=H?(B.type==="symbol"?N:P)[H.id]:void 0;this._renderTileClippingMasks(B,H,H?S[H.id]:void 0),this.renderLayer(this,H,B,W),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let B=null;s.values(this.style._layers).forEach(H=>{const W=c._getLayerSourceCache(H);W&&!H.isHidden(this.transform.zoom)&&(!B||B.getSource().maxzoom<W.getSource().maxzoom)&&(B=W)}),B&&this.options.showTileBoundaries&&Bh.debug(this,B,B.getVisibleCoordinates())}this.options.showPadding&&function(B){const H=B.transform.padding;ha(B,B.transform.height-(H.top||0),3,Vs),ha(B,H.bottom||0,3,es),Za(B,H.left||0,3,bd),Za(B,B.transform.width-(H.right||0),3,rs);const W=B.transform.centerPoint;(function($,ae,pe,de){_o($,ae-1,pe-10,2,20,de),_o($,ae-10,pe-1,20,2,de)})(B,W.x,B.transform.height-W.y,$i)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(s.window.performance.now()),this.saveCanvasCopy())}}renderLayer(c,d,v,w){v.isHidden(this.transform.zoom)||(v.type==="background"||v.type==="sky"||v.type==="custom"||w&&w.length)&&(this.id=v.id,this.gpuTimingStart(v),(!c.transform.projection.unsupportedLayers||!c.transform.projection.unsupportedLayers.includes(v.type)||c.terrain&&v.type==="custom")&&Bh[v.type](c,d,v,w,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(c){if(!this.options.gpuTiming)return;const d=this.context.extTimerQuery;let v=this.gpuTimers[c.id];v||(v=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:d.createQueryEXT()}),v.calls++,d.beginQueryEXT(d.TIME_ELAPSED_EXT,v.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const c=this.context.extTimerQuery,d=c.createQueryEXT();this.deferredRenderGpuTimeQueries.push(d),c.beginQueryEXT(c.TIME_ELAPSED_EXT,d)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}collectGpuTimers(){const c=this.gpuTimers;return this.gpuTimers={},c}collectDeferredRenderGpuQueries(){const c=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],c}queryGpuTimers(c){const d={};for(const v in c){const w=c[v],S=this.context.extTimerQuery,P=S.getQueryObjectEXT(w.query,S.QUERY_RESULT_EXT)/1e6;S.deleteQueryEXT(w.query),d[v]=P}return d}queryGpuTimeDeferredRender(c){if(!this.options.gpuTimingDeferredRender)return 0;const d=this.context.extTimerQuery;let v=0;for(const w of c)v+=d.getQueryObjectEXT(w,d.QUERY_RESULT_EXT)/1e6,d.deleteQueryEXT(w);return v}translatePosMatrix(c,d,v,w,S){if(!v[0]&&!v[1])return c;const P=S?w==="map"?this.transform.angle:0:w==="viewport"?-this.transform.angle:0;if(P){const H=Math.sin(P),W=Math.cos(P);v=[v[0]*W-v[1]*H,v[0]*H+v[1]*W]}const N=[S?v[0]:ri(d,v[0],this.transform.zoom),S?v[1]:ri(d,v[1],this.transform.zoom),0],B=new Float32Array(16);return s.translate(B,c,N),B}saveTileTexture(c){const d=this._tileTextures[c.size[0]];d?d.push(c):this._tileTextures[c.size[0]]=[c]}getTileTexture(c){const d=this._tileTextures[c];return d&&d.length>0?d.pop():null}isPatternMissing(c){return c===null||c!==void 0&&!this.imageManager.getPattern(c.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const c=this.terrain&&this.terrain.renderingToTexture,d=this.terrain&&this.terrain.exaggeration()===0,v=this.style&&this.style.fog,w=[];return this.terrainRenderModeElevated()&&w.push("TERRAIN"),this.transform.projection.name==="globe"&&w.push("GLOBE"),d&&w.push("ZERO_EXAGGERATION"),v&&!c&&v.getOpacity(this.transform.pitch)!==0&&w.push("FOG"),c&&w.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&w.push("OVERDRAW_INSPECTOR"),w}useProgram(c,d,v){this.cache=this.cache||{};const w=v||[],S=this.currentGlobalDefines().concat(w),P=Pf.cacheKey(Aa[c],c,S,d);return this.cache[P]||(this.cache[P]=new Pf(this.context,c,Aa[c],d,oo[c],S)),this.cache[P]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(c,d,v){if(this.terrain&&this.terrain.renderingToTexture)return;const w=this.style.fog;if(w){const S=w.getOpacity(this.transform.pitch),P=((N,B,H,W,$,ae,pe,de,me,_e,re)=>{const Ie=N.transform,Ee=B.properties.get("color").toArray01();Ee[3]=W;const Se=N.frameCounter/1e3%1;return{u_fog_matrix:H?Ie.calculateFogTileMatrix(H):N.identityMat,u_fog_range:B.getFovAdjustedRange(Ie._fov),u_fog_color:Ee,u_fog_horizon_blend:B.properties.get("horizon-blend"),u_fog_temporal_offset:Se,u_frustum_tl:$,u_frustum_tr:ae,u_frustum_br:pe,u_frustum_bl:de,u_globe_pos:me,u_globe_radius:_e,u_viewport:re,u_globe_transition:s.globeToMercatorTransition(Ie.zoom),u_is_globe:+(Ie.projection.name==="globe")}})(this,w,v,S,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.exported.devicePixelRatio,this.transform.height*s.exported.devicePixelRatio]);d.setFogUniformValues(c,P)}}setTileLoadedFlag(c){this.tileLoaded=c}saveCanvasCopy(){const c=this.canvasCopy();c&&(this.frameCopies.push(c),this.tileLoaded=!1)}canvasCopy(){const c=this.context.gl,d=c.createTexture();return c.bindTexture(c.TEXTURE_2D,d),c.copyTexImage2D(c.TEXTURE_2D,0,c.RGBA,0,0,c.drawingBufferWidth,c.drawingBufferHeight,0),d}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const c=this.style&&this.style.fog;return!!c&&c.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const c=this._backgroundTiles,d=this._backgroundTiles={},v=this.transform.coveringTiles({tileSize:512});for(const w of v)d[w.key]=c[w.key]||new s.Tile(w,512,this.transform.tileZoom,this);return d}clearBackgroundTiles(){this._backgroundTiles={}}}class Ka{constructor(c=0,d=0,v=0,w=0){if(isNaN(c)||c<0||isNaN(d)||d<0||isNaN(v)||v<0||isNaN(w)||w<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=d,this.left=v,this.right=w}interpolate(c,d,v){return d.top!=null&&c.top!=null&&(this.top=s.number(c.top,d.top,v)),d.bottom!=null&&c.bottom!=null&&(this.bottom=s.number(c.bottom,d.bottom,v)),d.left!=null&&c.left!=null&&(this.left=s.number(c.left,d.left,v)),d.right!=null&&c.right!=null&&(this.right=s.number(c.right,d.right,v)),this}getCenter(c,d){const v=s.clamp((this.left+c-this.right)/2,0,c),w=s.clamp((this.top+d-this.bottom)/2,0,d);return new s.pointGeometry(v,w)}equals(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}clone(){return new Ka(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function cc(_,c){const d=s.getColumn(_,3);s.fromQuat(_,c),s.setColumn(_,3,d)}function zh(_,c){const d=s.identity$1([]);return s.rotateZ$1(d,d,-c),s.rotateX$1(d,d,-_),d}function hc(_,c){const d=[_[0],_[1],0],v=[c[0],c[1],0];if(s.length(d)>=1e-15){const P=s.normalize([],d);s.scale$2(v,P,s.dot(v,P)),c[0]=v[0],c[1]=v[1]}const w=s.cross([],c,_);if(s.len(w)<1e-15)return null;const S=Math.atan2(-w[1],w[0]);return zh(Math.atan2(Math.sqrt(_[0]*_[0]+_[1]*_[1]),-_[2]),S)}class fc{constructor(c,d){this.position=c,this.orientation=d}get position(){return this._position}set position(c){if(c){const d=c instanceof s.MercatorCoordinate?c:new s.MercatorCoordinate(c[0],c[1],c[2]);this._renderWorldCopies&&(d.x=s.wrap(d.x,0,1)),this._position=d}else this._position=null}lookAtPoint(c,d){if(this.orientation=null,!this.position)return;const v=this._elevation?this._elevation.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(c)):0,w=this.position,S=s.MercatorCoordinate.fromLngLat(c,v),P=[S.x-w.x,S.y-w.y,S.z-w.z];d||(d=[0,0,1]),d[2]=Math.abs(d[2]),this.orientation=hc(P,d)}setPitchBearing(c,d){this.orientation=zh(s.degToRad(c),s.degToRad(-d))}}class Of{constructor(c,d){this._transform=s.identity([]),this.orientation=d,this.position=c}get mercatorPosition(){const c=this.position;return new s.MercatorCoordinate(c[0],c[1],c[2])}get position(){const c=s.getColumn(this._transform,3);return[c[0],c[1],c[2]]}set position(c){var d;c&&s.setColumn(this._transform,3,[(d=c)[0],d[1],d[2],1])}get orientation(){return this._orientation}set orientation(c){this._orientation=c||s.identity$1([]),c&&cc(this._transform,this._orientation)}getPitchBearing(){const c=this.forward(),d=this.right();return{bearing:Math.atan2(-d[1],d[0]),pitch:Math.atan2(Math.sqrt(c[0]*c[0]+c[1]*c[1]),-c[2])}}setPitchBearing(c,d){this._orientation=zh(c,d),cc(this._transform,this._orientation)}forward(){const c=s.getColumn(this._transform,2);return[-c[0],-c[1],-c[2]]}up(){const c=s.getColumn(this._transform,1);return[-c[0],-c[1],-c[2]]}right(){const c=s.getColumn(this._transform,0);return[c[0],c[1],c[2]]}getCameraToWorld(c,d){const v=new Float64Array(16);return s.invert(v,this.getWorldToCamera(c,d)),v}getWorldToCameraPosition(c,d,v){const w=this.position;s.scale$2(w,w,-c);const S=new Float64Array(16);return s.fromScaling(S,[v,v,v]),s.translate(S,S,w),S[10]*=d,S}getWorldToCamera(c,d){const v=new Float64Array(16),w=new Float64Array(4),S=this.position;return s.conjugate(w,this._orientation),s.scale$2(S,S,-c),s.fromQuat(v,w),s.translate(v,v,S),v[1]*=-1,v[5]*=-1,v[9]*=-1,v[13]*=-1,v[8]*=d,v[9]*=d,v[10]*=d,v[11]*=d,v}getCameraToClipPerspective(c,d,v,w){const S=new Float64Array(16);return s.perspective(S,c,d,v,w),S}getDistanceToElevation(c,d=!1){const v=c===0?0:s.mercatorZfromAltitude(c,d?s.latFromMercatorY(this.position[1]):this.position[1]),w=this.forward();return(v-this.position[2])/w[2]}clone(){return new Of([...this.position],[...this.orientation])}}function Zc(_,c){const d=Ou(_.projection,_.zoom,_.width,_.height),v=function(S,P,N,B,H){const W=new s.LngLat(N.lng-180*Gl,N.lat),$=new s.LngLat(N.lng+180*Gl,N.lat),ae=S.project(W.lng,W.lat),pe=S.project($.lng,$.lat),de=-Math.atan2(pe.y-ae.y,pe.x-ae.x),me=s.MercatorCoordinate.fromLngLat(N);me.y=s.clamp(me.y,-.999975,.999975);const _e=me.toLngLat(),re=S.project(_e.lng,_e.lat),Ie=s.MercatorCoordinate.fromLngLat(_e);Ie.x+=Gl;const Ee=Ie.toLngLat(),Se=S.project(Ee.lng,Ee.lat),ze=xp(Se.x-re.x,Se.y-re.y,de),De=s.MercatorCoordinate.fromLngLat(_e);De.y+=Gl;const qe=De.toLngLat(),lt=S.project(qe.lng,qe.lat),ut=xp(lt.x-re.x,lt.y-re.y,de),gt=Math.abs(ze.x)/Math.abs(ut.y),nn=s.identity([]);s.rotateZ(nn,nn,-de*(1-(H?0:B)));const ft=s.identity([]);return s.scale(ft,ft,[1,1-(1-gt)*B,1]),ft[4]=-ut.x/ut.y*B,s.rotateZ(ft,ft,de),s.multiply(ft,nn,ft),ft}(_.projection,0,_.center,d,c),w=vp(_);return s.scale(v,v,[w,w,1]),v}function vp(_){const c=_.projection,d=Ou(_.projection,_.zoom,_.width,_.height),v=Uh(c,_.center),w=Uh(c,s.LngLat.convert(c.center));return Math.pow(2,v*d+(1-d)*w)}function Ou(_,c,d,v,w=1/0){const S=_.range;if(!S)return 0;const P=Math.min(w,Math.max(d,v)),N=Math.log(P/1024)/Math.LN2;return s.smoothstep(S[0]+N,S[1]+N,c)}const Gl=1/4e4;function Uh(_,c){const d=s.clamp(c.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),v=new s.LngLat(c.lng-180*Gl,d),w=new s.LngLat(c.lng+180*Gl,d),S=_.project(v.lng,d),P=_.project(w.lng,d),N=s.MercatorCoordinate.fromLngLat(v),B=s.MercatorCoordinate.fromLngLat(w),H=P.x-S.x,W=P.y-S.y,$=B.x-N.x,ae=B.y-N.y,pe=Math.sqrt(($*$+ae*ae)/(H*H+W*W));return Math.log(pe)/Math.LN2}function xp(_,c,d){const v=Math.cos(d),w=Math.sin(d);return{x:_*v-c*w,y:_*w+c*v}}class Sn{constructor(c,d,v,w,S,P,N){this.tileSize=512,this._renderWorldCopies=S===void 0||S,this._minZoom=c||0,this._maxZoom=d||22,this._minPitch=v??0,this._maxPitch=w??60,this.setProjection(P),this.setMaxBounds(N),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Ka,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Of,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const c=new Sn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return c._elevation=this._elevation,c._centerAltitude=this._centerAltitude,c._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,c.tileSize=this.tileSize,c.mercatorFromTransition=this.mercatorFromTransition,c.width=this.width,c.height=this.height,c.cameraElevationReference=this.cameraElevationReference,c._center=this._center,c._setZoom(this.zoom),c._seaLevelZoom=this._seaLevelZoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._nearZ=this._nearZ,c._farZ=this._farZ,c._averageElevation=this._averageElevation,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._camera=this._camera.clone(),c._calcMatrices(),c.freezeTileCoverage=this.freezeTileCoverage,c.frustumCorners=this.frustumCorners,c}get elevation(){return this._elevation}set elevation(c){this._elevation!==c&&(this._elevation=c,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(c,d=!1){const v=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||v)&&this._updateCameraOnTerrain(),(c||v)&&this._constrainCamera(d),this._calcMatrices()}getProjection(){return s.pick(this.projection,["name","center","parallels"])}setProjection(c){this.projectionOptions=c||{name:"mercator"};const d=this.projection?this.getProjection():void 0;this.projection=s.getProjection(this.projectionOptions);const v=!p(d,this.getProjection());return v&&this._calcMatrices(),this.mercatorFromTransition=!1,v}setMercatorFromTransition(){const c=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.getProjection({name:"mercator"});const d=c!==this.projection.name;return d&&this._calcMatrices(),d}get minZoom(){return this._minZoom}set minZoom(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))}get maxZoom(){return this._maxZoom}set maxZoom(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))}get minPitch(){return this._minPitch}set minPitch(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))}get maxPitch(){return this._maxPitch}set maxPitch(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const c=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(c))}get cameraWorldSize(){const c=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(c))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.pointGeometry(this.width,this.height)}get bearing(){return s.wrap(this.rotation,-180,180)}set bearing(c){this.rotation=c}get rotation(){return-this.angle/Math.PI*180}set rotation(c){const d=-c*Math.PI/180;var v;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=(v=new s.ARRAY_TYPE(4),s.ARRAY_TYPE!=Float32Array&&(v[1]=0,v[2]=0),v[0]=1,v[3]=1,v),function(w,S,P){var N=S[0],B=S[1],H=S[2],W=S[3],$=Math.sin(P),ae=Math.cos(P);w[0]=N*ae+H*$,w[1]=B*ae+W*$,w[2]=N*-$+H*ae,w[3]=B*-$+W*ae}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(c){const d=s.clamp(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get aspect(){return this.width/this.height}get fovX(){return this._fov}get fovY(){const c=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/c)}set fov(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=s.degToRad(c),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(c){this._averageElevation=c,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(c){const d=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._setZoom(d),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(c){this._zoom=c,this.scale=this.zoomScale(c),this.tileZoom=Math.floor(c),this.zoomFraction=c-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const c=this._elevation;this._centerAltitude=c.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=c.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const c=this._elevation,d=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],v=this.horizonLineFromTop();let w=0,S=0;for(let P=0;P<d.length;P++){const N=new s.pointGeometry(d[P][0]*this.width,v+d[P][1]*(this.height-v)),B=c.pointCoordinate(N);if(!B)continue;const H=1/Math.hypot(B[0]-this._camera.position[0],B[1]-this._camera.position[1]);w+=B[3]*H,S+=H}return S===0?NaN:w/S}get center(){return this._center}set center(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const c=this._seaLevelZoom,d=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),v=this.pixelsPerMeter/this.worldSize*d,w=this._mercatorZfromZoom(c),S=this._mercatorZfromZoom(this._maxZoom),P=Math.max(w-v,S);this._setZoom(this._zoomFromMercatorZ(P))}get padding(){return this._edgeInsets.toJSON()}set padding(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())}computeZoomRelativeTo(c){const d=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,c.toAltitude()));let v;v=c.z<this._camera.position[2]?[d.x,d.y,d.z]:[c.x,c.y,c.z];const w=s.length(s.sub([],this._camera.position,v));return s.clamp(this._zoomFromMercatorZ(w),this._minZoom,this._maxZoom)}setFreeCameraOptions(c){if(!this.height||!c.position&&!c.orientation)return;this._updateCameraState();let d=!1;if(c.orientation&&!s.exactEquals(c.orientation,this._camera.orientation)&&(d=this._setCameraOrientation(c.orientation)),c.position){const v=[c.position.x,c.position.y,c.position.z];s.exactEquals$1(v,this._camera.position)||(this._setCameraPosition(v),d=!0)}d&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const c=this._camera.position,d=new fc;return d.position=new s.MercatorCoordinate(c[0],c[1],c[2]),d.orientation=this._camera.orientation,d._elevation=this.elevation,d._renderWorldCopies=this.renderWorldCopies,d}_setCameraOrientation(c){if(!s.length$1(c))return!1;s.normalize$1(c,c);const d=s.transformQuat([],[0,0,-1],c),v=s.transformQuat([],[0,-1,0],c);if(v[2]<0)return!1;const w=hc(d,v);return!!w&&(this._camera.orientation=w,!0)}_setCameraPosition(c){const d=this.zoomScale(this.minZoom)*this.tileSize,v=this.zoomScale(this.maxZoom)*this.tileSize,w=this.cameraToCenterDistance;c[2]=s.clamp(c[2],w/v,w/d),this._camera.position=c}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(c){return this._edgeInsets.equals(c)}interpolatePadding(c,d,v){this._unmodified=!1,this._edgeInsets.interpolate(c,d,v),this._constrain(),this._calcMatrices()}coveringZoomLevel(c){const d=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(c){const d=[new s.UnwrappedTileID(0,c)];if(this.renderWorldCopies){const v=this.pointCoordinate(new s.pointGeometry(0,0)),w=this.pointCoordinate(new s.pointGeometry(this.width,0)),S=this.pointCoordinate(new s.pointGeometry(this.width,this.height)),P=this.pointCoordinate(new s.pointGeometry(0,this.height)),N=Math.floor(Math.min(v.x,w.x,S.x,P.x)),B=Math.floor(Math.max(v.x,w.x,S.x,P.x)),H=1;for(let W=N-H;W<=B+H;W++)W!==0&&d.push(new s.UnwrappedTileID(W,c))}return d}coveringTiles(c){let d=this.coveringZoomLevel(c);const v=d,w=this.elevation&&!c.isTerrainDEM,S=this.projection.name==="mercator";if(c.minzoom!==void 0&&d<c.minzoom)return[];c.maxzoom!==void 0&&d>c.maxzoom&&(d=c.maxzoom);const P=this.locationCoordinate(this.center),N=this.center.lat,B=1<<d,H=[B*P.x,B*P.y,0],W=this.projection.name==="globe",$=!W,ae=s.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d,$),pe=W?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),de=B*s.mercatorZfromAltitude(1,this.center.lat),me=this._camera.position[2]/s.mercatorZfromAltitude(1,this.center.lat),_e=[B*pe.x,B*pe.y,me*($?1:de)],re=this.cameraToCenterDistance/c.tileSize*(c.roundZoom?1:.502),Ie=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?d:0,Ee=c.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Se=c.isTerrainDEM?-Ee:this._elevation?this._elevation.getMinElevationBelowMSL():0,ze=this.projection.isReprojectedInTileSpace?vp(this):1,De=pt=>{const yt=new s.MercatorCoordinate(pt.x+25e-6,pt.y,pt.z),Gt=new s.MercatorCoordinate(pt.x,pt.y+25e-6,pt.z),Ht=pt.toLngLat(),Qn=yt.toLngLat(),ji=Gt.toLngLat(),Bn=this.locationCoordinate(Ht),An=this.locationCoordinate(Qn),ni=this.locationCoordinate(ji),ir=Math.hypot(An.x-Bn.x,An.y-Bn.y),oi=Math.hypot(ni.x-Bn.x,ni.y-Bn.y);return Math.sqrt(ir*oi)*ze/25e-6},qe=pt=>{const at=Ee,yt=Se;return{aabb:s.tileAABB(this,B,0,0,0,pt,yt,at,this.projection),zoom:0,x:0,y:0,minZ:yt,maxZ:at,wrap:pt,fullyVisible:!1}},lt=[];let ut=[];const gt=d,nn=c.reparseOverscaled?v:d,ft=pt=>pt*pt,Ft=ft((me-this._centerAltitude)*de),xt=pt=>{if(!this._elevation||!pt.tileID||!S)return;const at=this._elevation.getMinMaxForTile(pt.tileID),yt=pt.aabb;at?(yt.min[2]=at.min,yt.max[2]=at.max,yt.center[2]=(yt.min[2]+yt.max[2])/2):(pt.shouldSplit=Wt(pt),pt.shouldSplit||(yt.min[2]=yt.max[2]=yt.center[2]=this._centerAltitude))},Wt=pt=>{if(pt.zoom<Ie)return!0;if(pt.zoom===gt)return!1;if(pt.shouldSplit!=null)return pt.shouldSplit;const at=pt.aabb.distanceX(_e),yt=pt.aabb.distanceY(_e);let Gt=Ft,Ht=1;if(W){Gt=ft(pt.aabb.distanceZ(_e));const Bn=Math.pow(2,pt.zoom),An=s.latFromMercatorY((pt.y+1)/Bn),ni=s.latFromMercatorY(pt.y/Bn),ir=Math.min(Math.max(N,An),ni),oi=s.circumferenceAtLatitude(ir)/s.circumferenceAtLatitude(N);if(Ht=ir===N?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,oi/this._mercatorScaleRatio),this.zoom<=s.GLOBE_ZOOM_THRESHOLD_MIN&&pt.zoom===gt-1&&oi>=.9)return!0}else if(w&&(Gt=ft(pt.aabb.distanceZ(_e)*de)),this.projection.isReprojectedInTileSpace&&v<=5){const Bn=Math.pow(2,pt.zoom),An=De(new s.MercatorCoordinate((pt.x+.5)/Bn,(pt.y+.5)/Bn));Ht=An>.85?1:An}const Qn=at*at+yt*yt+Gt,ji=ft((1<<gt-pt.zoom)*re*Ht*((Bn,An)=>{if(An*ft(.707)<Bn)return 1;const ni=Math.sqrt(An/Bn);return ni/(1.4144271570014144+(Math.pow(1.1,ni-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Gt,Ft),Qn));return Qn<ji};if(this.renderWorldCopies)for(let pt=1;pt<=3;pt++)lt.push(qe(-pt)),lt.push(qe(pt));for(lt.push(qe(0));lt.length>0;){const pt=lt.pop(),at=pt.x,yt=pt.y;let Gt=pt.fullyVisible;if(!Gt){const Ht=pt.aabb.intersects(ae);if(Ht===0)continue;Gt=Ht===2}if(pt.zoom!==gt&&Wt(pt))for(let Ht=0;Ht<4;Ht++){const Qn=(at<<1)+Ht%2,ji=(yt<<1)+(Ht>>1),Bn={aabb:S?pt.aabb.quadrant(Ht):s.tileAABB(this,B,pt.zoom+1,Qn,ji,pt.wrap,pt.minZ,pt.maxZ,this.projection),zoom:pt.zoom+1,x:Qn,y:ji,wrap:pt.wrap,fullyVisible:Gt,tileID:void 0,shouldSplit:void 0,minZ:pt.minZ,maxZ:pt.maxZ};w&&!W&&(Bn.tileID=new s.OverscaledTileID(pt.zoom+1===gt?nn:pt.zoom+1,pt.wrap,pt.zoom+1,Qn,ji),xt(Bn)),lt.push(Bn)}else{const Ht=pt.zoom===gt?nn:pt.zoom;if(c.minzoom&&c.minzoom>Ht)continue;const Qn=H[0]-(.5+at+(pt.wrap<<pt.zoom))*(1<<d-pt.zoom),ji=H[1]-.5-yt,Bn=pt.tileID?pt.tileID:new s.OverscaledTileID(Ht,pt.wrap,pt.zoom,at,yt);ut.push({tileID:Bn,distanceSq:Qn*Qn+ji*ji})}}if(this.fogCullDistSq){const pt=this.fogCullDistSq,at=this.horizonLineFromTop();ut=ut.filter(yt=>{const Gt=[0,0,0,1],Ht=[s.EXTENT,s.EXTENT,0,1],Qn=this.calculateFogTileMatrix(yt.tileID.toUnwrapped());s.transformMat4$1(Gt,Gt,Qn),s.transformMat4$1(Ht,Ht,Qn);const ji=s.getAABBPointSquareDist(Gt,Ht);if(ji===0)return!0;let Bn=!1;const An=this._elevation;if(An&&ji>pt&&at!==0){const ni=this.calculateProjMatrix(yt.tileID.toUnwrapped());let ir;c.isTerrainDEM||(ir=An.getMinMaxForTile(yt.tileID)),ir||(ir={min:Se,max:Ee});const oi=s.furthestTileCorner(this.rotation),Nr=[oi[0]*s.EXTENT,oi[1]*s.EXTENT,ir.max];s.transformMat4(Nr,Nr,ni),Bn=(1-Nr[1])*this.height*.5<at}return ji<pt||Bn})}return ut.sort((pt,at)=>pt.distanceSq-at.distanceSq).map(pt=>pt.tileID)}resize(c,d){this.width=c,this.height=d,this.pixelsToGLUnits=[2/c,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(c){return Math.pow(2,c)}scaleZoom(c){return Math.log(c)/Math.LN2}project(c){const d=s.clamp(c.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),v=this.projection.project(c.lng,d);return new s.pointGeometry(v.x*this.worldSize,v.y*this.worldSize)}unproject(c){return this.projection.unproject(c.x/this.worldSize,c.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/s.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(c,d){let v,w;const S=this.centerPoint;if(this.projection.name==="globe"){const N=this.worldSize;v=(d.x-S.x)/N,w=(d.y-S.y)/N}else{const N=this.pointCoordinate(d),B=this.pointCoordinate(S);v=N.x-B.x,w=N.y-B.y}const P=this.locationCoordinate(c);this.setLocation(new s.MercatorCoordinate(P.x-v,P.y-w))}setLocation(c){this.center=this.coordinateLocation(c),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(c){return this.projection.locationPoint(this,c)}locationPoint3D(c){return this.projection.locationPoint(this,c,!0)}pointLocation(c){return this.coordinateLocation(this.pointCoordinate(c))}pointLocation3D(c){return this.coordinateLocation(this.pointCoordinate3D(c))}locationCoordinate(c,d){const v=d?s.mercatorZfromAltitude(d,c.lat):void 0,w=this.projection.project(c.lng,c.lat);return new s.MercatorCoordinate(w.x,w.y,v)}coordinateLocation(c){return this.projection.unproject(c.x,c.y)}pointRayIntersection(c,d){const v=d??this._centerAltitude,w=[c.x,c.y,0,1],S=[c.x,c.y,1,1];s.transformMat4$1(w,w,this.pixelMatrixInverse),s.transformMat4$1(S,S,this.pixelMatrixInverse);const P=S[3];s.scale$1(w,w,1/w[3]),s.scale$1(S,S,1/P);const N=w[2],B=S[2];return{p0:w,p1:S,t:N===B?0:(v-N)/(B-N)}}screenPointToMercatorRay(c){const d=[c.x,c.y,0,1],v=[c.x,c.y,1,1];return s.transformMat4$1(d,d,this.pixelMatrixInverse),s.transformMat4$1(v,v,this.pixelMatrixInverse),s.scale$1(d,d,1/d[3]),s.scale$1(v,v,1/v[3]),d[2]=s.mercatorZfromAltitude(d[2],this._center.lat)*this.worldSize,v[2]=s.mercatorZfromAltitude(v[2],this._center.lat)*this.worldSize,s.scale$1(d,d,1/this.worldSize),s.scale$1(v,v,1/this.worldSize),new s.Ray([d[0],d[1],d[2]],s.normalize([],s.sub([],v,d)))}rayIntersectionCoordinate(c){const{p0:d,p1:v,t:w}=c,S=s.mercatorZfromAltitude(d[2],this._center.lat),P=s.mercatorZfromAltitude(v[2],this._center.lat);return new s.MercatorCoordinate(s.number(d[0],v[0],w)/this.worldSize,s.number(d[1],v[1],w)/this.worldSize,s.number(S,P,w))}pointCoordinate(c,d=this._centerAltitude){return this.projection.pointCoordinate(this,c.x,c.y,d)}pointCoordinate3D(c){if(!this.elevation)return this.pointCoordinate(c);let d=this.projection.pointCoordinate3D(this,c.x,c.y);if(d)return new s.MercatorCoordinate(d[0],d[1],d[2]);let v=0,w=this.horizonLineFromTop();if(c.y>w)return this.pointCoordinate(c);const S=.02*w,P=c.clone();for(let N=0;N<10&&w-v>S;N++){P.y=s.number(v,w,.66);const B=this.projection.pointCoordinate3D(this,P.x,P.y);B?(w=P.y,d=B):v=P.y}return d?new s.MercatorCoordinate(d[0],d[1],d[2]):this.pointCoordinate(c)}isPointAboveHorizon(c){return this.projection.isPointAboveHorizon(this,c)}_coordinatePoint(c,d){const v=d&&this.elevation?this.elevation.getAtPointOrZero(c,this._centerAltitude):this._centerAltitude,w=[c.x*this.worldSize,c.y*this.worldSize,v+c.toAltitude(),1];return s.transformMat4$1(w,w,this.pixelMatrix),w[3]>0?new s.pointGeometry(w[0]/w[3],w[1]/w[3]):new s.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:c,left:d}=this._edgeInsets,v=this.height-this._edgeInsets.bottom,w=this.width-this._edgeInsets.right,S=this.pointLocation3D(new s.pointGeometry(d,c)),P=this.pointLocation3D(new s.pointGeometry(w,c)),N=this.pointLocation3D(new s.pointGeometry(w,v)),B=this.pointLocation3D(new s.pointGeometry(d,v));let H=Math.min(S.lng,P.lng,N.lng,B.lng),W=Math.max(S.lng,P.lng,N.lng,B.lng),$=Math.min(S.lat,P.lat,N.lat,B.lat),ae=Math.max(S.lat,P.lat,N.lat,B.lat);const pe=Math.pow(2,-this.zoom)/16*270,de=this.projection.name==="globe"?1:4,me=(_e,re,Ie,Ee,Se)=>{const ze=(_e+Ie)/2,De=(re+Ee)/2,qe=new s.pointGeometry(ze,De),{lng:lt,lat:ut}=this.pointLocation3D(qe),gt=Math.max(0,H-lt,$-ut,lt-W,ut-ae);H=Math.min(H,lt),W=Math.max(W,lt),$=Math.min($,ut),ae=Math.max(ae,ut),(Se<de||gt>pe)&&(me(_e,re,ze,De,Se+1),me(ze,De,Ie,Ee,Se+1))};if(me(d,c,w,c,1),me(w,c,w,v,1),me(w,v,d,v,1),me(d,v,d,c,1),this.projection.name==="globe"){const[_e,re]=s.polesInViewport(this);_e?(ae=90,W=180,H=-180):re&&($=-90,W=180,H=-180)}return new s.LngLatBounds(new s.LngLat(H,$),new s.LngLat(W,ae))}_getBoundsRectangular(c,d){const{top:v,left:w}=this._edgeInsets,S=this.height-this._edgeInsets.bottom,P=this.width-this._edgeInsets.right,N=new s.pointGeometry(w,v),B=new s.pointGeometry(P,v),H=new s.pointGeometry(P,S),W=new s.pointGeometry(w,S);let $=this.pointCoordinate(N,c),ae=this.pointCoordinate(B,c);const pe=this.pointCoordinate(H,d),de=this.pointCoordinate(W,d),me=(_e,re)=>(re.y-_e.y)/(re.x-_e.x);return $.y>1&&ae.y>=0?$=new s.MercatorCoordinate((1-de.y)/me(de,$)+de.x,1):$.y<0&&ae.y<=1&&($=new s.MercatorCoordinate(-de.y/me(de,$)+de.x,0)),ae.y>1&&$.y>=0?ae=new s.MercatorCoordinate((1-pe.y)/me(pe,ae)+pe.x,1):ae.y<0&&$.y<=1&&(ae=new s.MercatorCoordinate(-pe.y/me(pe,ae)+pe.x,0)),new s.LngLatBounds().extend(this.coordinateLocation($)).extend(this.coordinateLocation(ae)).extend(this.coordinateLocation(de)).extend(this.coordinateLocation(pe))}_getBoundsRectangularTerrain(){const c=this.elevation;if(!c.visibleDemTiles.length||c.isUsingMockSource())return this._getBoundsRectangular(0,0);const d=c.visibleDemTiles.reduce((v,w)=>{if(w.dem){const S=w.dem.tree;v.min=Math.min(v.min,S.minimums[0]),v.max=Math.max(v.max,S.maximums[0])}return v},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(d.min*c.exaggeration(),d.max*c.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(c=!0){const d=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,v=this.height/2-d*(1-this._horizonShift);return c?Math.max(0,v):v}getMaxBounds(){return this.maxBounds}setMaxBounds(c){this.maxBounds=c,this.minLat=-s.MAX_MERCATOR_LATITUDE,this.maxLat=s.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,c&&(this.minLat=c.getSouth(),this.maxLat=c.getNorth(),this.minLng=c.getWest(),this.maxLng=c.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=s.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=s.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=s.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(c,d){return this.projection.createTileMatrix(this,d,c)}calculateDistanceTileData(c){const d=c.key,v=this._distanceTileDataCache;if(v[d])return v[d];const w=c.canonical,S=1/this.height,P=this.cameraWorldSize,N=P/this.zoomScale(w.z),B=(w.x+Math.pow(2,w.z)*c.wrap)*N,H=w.y*N,W=this.point;W.x*=P/this.worldSize,W.y*=P/this.worldSize;const $=this.angle,ae=Math.sin(-$),pe=-Math.cos(-$);return v[d]={bearing:[ae,pe],center:[(W.x-B)*S,(W.y-H)*S],scale:N/s.EXTENT*S},v[d]}calculateFogTileMatrix(c){const d=c.key,v=this._fogTileMatrixCache;if(v[d])return v[d];const w=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,c);return s.multiply(w,this.worldToFogMatrix,w),v[d]=new Float32Array(w),v[d]}calculateProjMatrix(c,d=!1){const v=c.key,w=d?this._alignedProjMatrixCache:this._projMatrixCache;if(w[v])return w[v];const S=this.calculatePosMatrix(c,this.worldSize);return s.multiply(S,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:d?this.alignedProjMatrix:this.projMatrix,S),w[v]=new Float32Array(S),w[v]}calculatePixelsToTileUnitsMatrix(c){const d=c.tileID.key,v=this._pixelsToTileUnitsCache;if(v[d])return v[d];const w=function(S,P){const{scale:N}=S.tileTransform,B=N*s.EXTENT/(S.tileSize*Math.pow(2,P.zoom-S.tileID.overscaledZ+S.tileID.canonical.z));return H=new Float32Array(4),ae=(W=P.inverseAdjustmentMatrix)[1],pe=W[2],de=W[3],_e=($=[B,B])[1],H[0]=W[0]*(me=$[0]),H[1]=ae*me,H[2]=pe*_e,H[3]=de*_e,H;var H,W,$,ae,pe,de,me,_e}(c,this);return v[d]=w,v[d]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const c=1/this.worldSize,d=s.fromScaling([],[c,c,c]);return s.multiply(d,d,this.globeMatrix),d}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const c=this._elevation;this._updateCameraState();const d=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,v=this._computeCameraPosition(d),w=this._camera.forward(),S=s.mercatorZfromAltitude(1,this._center.lat);v[2]/=S,w[2]/=S,s.normalize(w,w);const P=c.raycast(v,w,c.exaggeration());if(P){const N=s.scaleAndAdd([],v,w,P),B=new s.MercatorCoordinate(N[0],N[1],s.mercatorZfromAltitude(N[2],s.latFromMercatorY(N[1]))),H=(B.z+s.length([B.x-v[0],B.y-v[1],B.z-v[2]*S]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(H),this._centerAltitude=B.toAltitude(),this._center=this.coordinateLocation(B),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(c=!1){if(!this._elevation)return;const d=this._elevation,v=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,w=this._computeCameraPosition(v),S=d.getAtPointOrZero(new s.MercatorCoordinate(...w)),P=this.pixelsPerMeter/this.worldSize*S,N=this._minimumHeightOverTerrain(),B=w[2]-P;if(B<=N)if(B<0||c){const H=this.locationCoordinate(this._center,this._centerAltitude),W=[w[0],w[1],H.z-w[2]],$=s.length(W);W[2]-=(N-B)/this._pixelsPerMercatorPixel;const ae=s.length(W);if(ae===0)return;s.scale$2(W,W,$/ae*this._pixelsPerMercatorPixel),this._camera.position=[w[0],w[1],H.z*this._pixelsPerMercatorPixel-W[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const c=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||c){const ae=this.center;return ae.lat=s.clamp(ae.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!c)&&(ae.lng=s.clamp(ae.lng,this.minLng,this.maxLng)),this.center=ae,void(this._constraining=!1)}const d=this._unmodified,{x:v,y:w}=this.point;let S=0,P=v,N=w;const B=this.width/2,H=this.height/2,W=this.worldMinY*this.scale,$=this.worldMaxY*this.scale;if(w-H<W&&(N=W+H),w+H>$&&(N=$-H),$-W<this.height&&(S=Math.max(S,this.height/($-W)),N=($+W)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ae=this.worldMinX*this.scale,pe=this.worldMaxX*this.scale,de=this.worldSize/2-(ae+pe)/2;P=(v+de+this.worldSize)%this.worldSize-de,P-B<ae&&(P=ae+B),P+B>pe&&(P=pe-B),pe-ae<this.width&&(S=Math.max(S,this.width/(pe-ae)),P=(pe+ae)/2)}P===v&&N===w||(this.center=this.unproject(new s.pointGeometry(P,N))),S&&(this.zoom+=this.scaleZoom(S)),this._constrainCamera(),this._unmodified=d,this._constraining=!1}_minZoomForBounds(){let c=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(c=Math.max(c,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),c}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const c=this.centerOffset,d=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=s.mercatorZfromAltitude(1,this.center.lat)/s.mercatorZfromAltitude(1,s.GLOBE_SCALE_MATCH_LATITUDE));const v=Ou(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,v),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const w=this.projection.zAxisUnit==="meters"?d:1,S=this._camera.getWorldToCamera(this.worldSize,w),P=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);P[8]=2*-c.x/this.width,P[9]=2*c.y/this.height;let N=s.mul([],P,S);if(this.projection.isReprojectedInTileSpace){const De=this.locationCoordinate(this.center),qe=s.identity([]);s.translate(qe,qe,[De.x*this.worldSize,De.y*this.worldSize,0]),s.multiply(qe,qe,Zc(this)),s.translate(qe,qe,[-De.x*this.worldSize,-De.y*this.worldSize,0]),s.multiply(N,N,qe),this.inverseAdjustmentMatrix=function(lt){const ut=Zc(lt,!0);return Fe([],[ut[0],ut[1],ut[4],ut[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=s.scale([],N,[this.worldSize,this.worldSize,this.worldSize/w,1]),this.projMatrix=N,this.invProjMatrix=s.invert(new Float64Array(16),this.projMatrix);const B=s.invert([],P);this.frustumCorners=s.FrustumCorners.fromInvProjectionMatrix(B,this.horizonLineFromTop(),this.height);const H=new Float32Array(16);s.identity(H),s.scale(H,H,[1,-1,1]),s.rotateX(H,H,this._pitch),s.rotateZ(H,H,this.angle);const W=s.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),$=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;W[8]=2*-c.x/this.width,W[9]=2*(c.y+$)/this.height,this.skyboxMatrix=s.multiply(H,W,H);const ae=this.point,pe=ae.x,de=ae.y,me=this.width%2/2,_e=this.height%2/2,re=Math.cos(this.angle),Ie=Math.sin(this.angle),Ee=pe-Math.round(pe)+re*me+Ie*_e,Se=de-Math.round(de)+re*_e+Ie*me,ze=new Float64Array(N);if(s.translate(ze,ze,[Ee>.5?Ee-1:Ee,Se>.5?Se-1:Se,0]),this.alignedProjMatrix=ze,N=s.create(),s.scale(N,N,[this.width/2,-this.height/2,1]),s.translate(N,N,[1,-1,0]),this.labelPlaneMatrix=N,N=s.create(),s.scale(N,N,[1,-1,1]),s.translate(N,N,[-1,-1,0]),s.scale(N,N,[2/this.width,2/this.height,1]),this.glCoordMatrix=N,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},N=s.invert(new Float64Array(16),this.pixelMatrix),!N)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=N,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=s.calculateGlobeMatrix(this);const De=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.transformMat4(De,De,S),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=N;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const c=this.cameraWorldSizeForFog,d=this.cameraPixelsPerMeter,v=this._camera.position,w=1/this.height/this._pixelsPerMercatorPixel,S=[c,c,d];s.scale$2(S,S,w),s.scale$2(v,v,-1),s.multiply$2(v,v,S);const P=s.create();s.translate(P,P,v),s.scale(P,P,S),this.mercatorFogMatrix=P,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(c,d,w)}_computeCameraPosition(c){const d=(c=c||this.pixelsPerMeter)/this.pixelsPerMeter,v=this._camera.forward(),w=this.point,S=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*d-c/this.worldSize*this._centerAltitude;return[w.x/this.worldSize-v[0]*S,w.y/this.worldSize-v[1]*S,c/this.worldSize*this._centerAltitude-v[2]*S]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(c){const d=this._maxCameraBoundsDistance()*Math.cos(this._pitch),v=this._camera.position[2],w=c[2];let S=1;this.projection.wrap&&(this.center=this.center.wrap()),w>0&&(S=Math.min((d-v)/w,1)),this._camera.position=s.scaleAndAdd([],this._camera.position,c,S),this._updateStateFromCamera()}_updateStateFromCamera(){const c=this._camera.position,d=this._camera.forward(),{pitch:v,bearing:w}=this._camera.getPitchBearing(),S=s.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,P=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.degToRad(this._maxPitch)),N=Math.max((c[2]-S)/Math.cos(v),P),B=this._zoomFromMercatorZ(N);s.scaleAndAdd(c,c,d,N),this._pitch=s.clamp(v,s.degToRad(this.minPitch),s.degToRad(this.maxPitch)),this.angle=s.wrap(w,-Math.PI,Math.PI),this._setZoom(s.clamp(B,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.MercatorCoordinate(c[0],c[1],c[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(c){return Math.pow(2,c)*this.tileSize}_mercatorZfromZoom(c){return this.cameraToCenterDistance/this._worldSizeFromZoom(c)}_minimumHeightOverTerrain(){const c=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(c)}_zoomFromMercatorZ(c){return this.scaleZoom(this.cameraToCenterDistance/(c*this.tileSize))}zoomFromMercatorZAdjusted(c){let d=0,v=s.GLOBE_ZOOM_THRESHOLD_MAX,w=0,S=1/0;for(;v-d>1e-6&&v>d;){const P=d+.5*(v-d),N=this.tileSize*Math.pow(2,P),B=this.getCameraToCenterDistance(this.projection,P,N),H=this.scaleZoom(B/(c*this.tileSize)),W=Math.abs(P-H);W<S&&(S=W,w=P),P<H?d=P:v=P}return w}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(c,d){const v=Math.min(c.x,d.x),w=Math.max(c.x,d.x),S=Math.min(c.y,d.y),P=Math.max(c.y,d.y);if(S<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const N=[new s.pointGeometry(v,S),new s.pointGeometry(w,P),new s.pointGeometry(v,P),new s.pointGeometry(w,S)],B=this.renderWorldCopies?-3:0,H=this.renderWorldCopies?4:1;for(const W of N){const $=this.pointRayIntersection(W);if($.t<0)return!0;const ae=this.rayIntersectionCoordinate($);if(ae.x<B||ae.y<0||ae.x>H||ae.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.pointGeometry(0,0),new s.pointGeometry(this.width,this.height))}zoomDeltaToMovement(c,d){const v=s.length(s.sub([],this._camera.position,c)),w=this._zoomFromMercatorZ(v)+d;return v-this._mercatorZfromZoom(w)}getCameraPoint(){if(this.projection.name==="globe"){const c=function([d,v,w],S){const P=[d,v,w,1];s.transformMat4$1(P,P,S);const N=P[3]=Math.max(P[3],1e-6);return P[0]/=N,P[1]/=N,P[2]/=N,P}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.pointGeometry(c[0],c[1])}{const c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.pointGeometry(0,c))}}getCameraToCenterDistance(c,d=this.zoom,v=this.worldSize){const w=Ou(c,d,this.width,this.height,1024),S=c.pixelSpaceConversion(this.center.lat,v,w);return .5/Math.tan(.5*this._fov)*this.height*S}getWorldToCameraMatrix(){const c=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&s.multiply(c,c,this.globeMatrix),c}}function nu(_,c){let d=!1,v=null;const w=()=>{v=null,d&&(_(),v=setTimeout(w,c),d=!1)};return()=>(d=!0,v||w(),v)}class bp{constructor(c){this._hashName=c&&encodeURIComponent(c),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=nu(this._updateHashUnthrottled.bind(this),300)}addTo(c){return this._map=c,s.window.addEventListener("hashchange",this._onHashChange,!1),c.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),s.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const c=this._map;if(!c)return"";const d=Ed(c);if(this._hashName){const v=this._hashName;let w=!1;const S=s.window.location.hash.slice(1).split("&").map(P=>{const N=P.split("=")[0];return N===v?(w=!0,`${N}=${d}`):P}).filter(P=>P);return w||S.push(`${v}=${d}`),`#${S.join("&")}`}return`#${d}`}_getCurrentHash(){const c=s.window.location.hash.replace("#","");if(this._hashName){let d;return c.split("&").map(v=>v.split("=")).forEach(v=>{v[0]===this._hashName&&(d=v)}),(d&&d[1]||"").split("/")}return c.split("/")}_onHashChange(){const c=this._map;if(!c)return!1;const d=this._getCurrentHash();if(d.length>=3&&!d.some(v=>isNaN(v))){const v=c.dragRotate.isEnabled()&&c.touchZoomRotate.isEnabled()?+(d[3]||0):c.getBearing();return c.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:v,pitch:+(d[4]||0)}),!0}return!1}_updateHashUnthrottled(){const c=s.window.location.href.replace(/(#.+)?$/,this.getHashString());s.window.history.replaceState(s.window.history.state,null,c)}}function Ed(_,c){const d=_.getCenter(),v=Math.round(100*_.getZoom())/100,w=Math.ceil((v*Math.LN2+Math.log(512/360/.5))/Math.LN10),S=Math.pow(10,w),P=Math.round(d.lng*S)/S,N=Math.round(d.lat*S)/S,B=_.getBearing(),H=_.getPitch();let W=c?`/${P}/${N}/${v}`:`${v}/${N}/${P}`;return(B||H)&&(W+="/"+Math.round(10*B)/10),H&&(W+=`/${Math.round(H)}`),W}const Nf={linearity:.3,easing:s.bezier(0,0,.3,1)},wd=s.extend({deceleration:2500,maxSpeed:1400},Nf),mg=s.extend({deceleration:20,maxSpeed:1400},Nf),um=s.extend({deceleration:1e3,maxSpeed:360},Nf),gg=s.extend({deceleration:1e3,maxSpeed:90},Nf);class lo{constructor(c){this._map=c,this.clear()}clear(){this._inertiaBuffer=[]}record(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.exported.now(),settings:c})}_drainInertiaBuffer(){const c=this._inertiaBuffer,d=s.exported.now();for(;c.length>0&&d-c[0].time>160;)c.shift()}_onMoveEnd(c){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const d={zoom:0,bearing:0,pitch:0,pan:new s.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:S}of this._inertiaBuffer)d.zoom+=S.zoomDelta||0,d.bearing+=S.bearingDelta||0,d.pitch+=S.pitchDelta||0,S.panDelta&&d.pan._add(S.panDelta),S.around&&(d.around=S.around),S.pinchAround&&(d.pinchAround=S.pinchAround);const v=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,w={};if(d.pan.mag()){const S=Ep(d.pan.mag(),v,s.extend({},wd,c||{}));w.offset=d.pan.mult(S.amount/d.pan.mag()),w.center=this._map.transform.center,Po(w,S)}if(d.zoom){const S=Ep(d.zoom,v,mg);w.zoom=this._map.transform.zoom+S.amount,Po(w,S)}if(d.bearing){const S=Ep(d.bearing,v,um);w.bearing=this._map.transform.bearing+s.clamp(S.amount,-179,179),Po(w,S)}if(d.pitch){const S=Ep(d.pitch,v,gg);w.pitch=this._map.transform.pitch+S.amount,Po(w,S)}if(w.zoom||w.bearing){const S=d.pinchAround===void 0?d.around:d.pinchAround;w.around=S?this._map.unproject(S):this._map.getCenter()}return this.clear(),w.noMoveStart=!0,w}}function Po(_,c){(!_.duration||_.duration<c.duration)&&(_.duration=c.duration,_.easing=c.easing)}function Ep(_,c,d){const{maxSpeed:v,linearity:w,deceleration:S}=d,P=s.clamp(_*w/(c/1e3),-v,v),N=Math.abs(P)/(S*w);return{easing:d.easing,duration:1e3*N,amount:P*(N/2)}}class ta extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,d,v,w={}){const S=ie(d.getCanvasContainer(),v),P=d.unproject(S);super(c,s.extend({point:S,lngLat:P,originalEvent:v},w)),this._defaultPrevented=!1,this.target=d}}class wp extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,d,v){const w=c==="touchend"?v.changedTouches:v.touches,S=Te(d.getCanvasContainer(),w),P=S.map(B=>d.unproject(B)),N=S.reduce((B,H,W,$)=>B.add(H.div($.length)),new s.pointGeometry(0,0));super(c,{points:S,point:N,lngLats:P,lngLat:d.unproject(N),originalEvent:v}),this._defaultPrevented=!1}}class Zv extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,d,v){super(c,{originalEvent:v}),this._defaultPrevented=!1}}class cm{constructor(c,d){this._map=c,this._clickTolerance=d.clickTolerance}reset(){this._mousedownPos=void 0}wheel(c){return this._firePreventable(new Zv(c.type,this._map,c))}mousedown(c,d){return this._mousedownPos=d,this._firePreventable(new ta(c.type,this._map,c))}mouseup(c){this._map.fire(new ta(c.type,this._map,c))}preclick(c){const d=s.extend({},c);d.type="preclick",this._map.fire(new ta(d.type,this._map,d))}click(c,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||(this.preclick(c),this._map.fire(new ta(c.type,this._map,c)))}dblclick(c){return this._firePreventable(new ta(c.type,this._map,c))}mouseover(c){this._map.fire(new ta(c.type,this._map,c))}mouseout(c){this._map.fire(new ta(c.type,this._map,c))}touchstart(c){return this._firePreventable(new wp(c.type,this._map,c))}touchmove(c){this._map.fire(new wp(c.type,this._map,c))}touchend(c){this._map.fire(new wp(c.type,this._map,c))}touchcancel(c){this._map.fire(new wp(c.type,this._map,c))}_firePreventable(c){if(this._map.fire(c),c.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Vh{constructor(c){this._map=c}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(c){this._map.fire(new ta(c.type,this._map,c))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ta("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(c){this._delayContextMenu?this._contextMenuEvent=c:this._map.fire(new ta(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ip{constructor(c,d){this._map=c,this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(c,d){this.isEnabled()&&c.shiftKey&&c.button===0&&(q(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(c,d){if(!this._active)return;const v=d,w=this._startPos,S=this._lastPos;if(!w||!S||S.equals(v)||!this._box&&v.dist(w)<this._clickTolerance)return;this._lastPos=v,this._box||(this._box=M("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));const P=Math.min(w.x,v.x),N=Math.max(w.x,v.x),B=Math.min(w.y,v.y),H=Math.max(w.y,v.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${P}px,${B}px)`,this._box.style.width=N-P+"px",this._box.style.height=H-B+"px")})}mouseupWindow(c,d){if(!this._active)return;const v=this._startPos,w=d;if(v&&c.button===0){if(this.reset(),te(),v.x!==w.x||v.y!==w.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:c})),{cameraAnimation:S=>S.fitScreenCoordinates(v,w,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",c)}}keydown(c){this._active&&c.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",c))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Z(),delete this._startPos,delete this._lastPos}_fireEvent(c,d){return this._map.fire(new s.Event(c,{originalEvent:d}))}}function Yc(_,c){const d={};for(let v=0;v<_.length;v++)d[_[v].identifier]=c[v];return d}class Id{constructor(c){this.reset(),this.numTouches=c.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(c,d,v){(this.centroid||v.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=c.timeStamp),v.length===this.numTouches&&(this.centroid=function(w){const S=new s.pointGeometry(0,0);for(const P of w)S._add(P);return S.div(w.length)}(d),this.touches=Yc(v,d)))}touchmove(c,d,v){if(this.aborted||!this.centroid)return;const w=Yc(v,d);for(const S in this.touches){const P=this.touches[S],N=w[S];(!N||N.dist(P)>30)&&(this.aborted=!0)}}touchend(c,d,v){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),v.length===0){const w=!this.aborted&&this.centroid;if(this.reset(),w)return w}}}class dc{constructor(c){this.singleTap=new Id(c),this.numTaps=c.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(c,d,v){this.singleTap.touchstart(c,d,v)}touchmove(c,d,v){this.singleTap.touchmove(c,d,v)}touchend(c,d,v){const w=this.singleTap.touchend(c,d,v);if(w){const S=c.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(w)<30;if(S&&P||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=w,this.count===this.numTaps)return this.reset(),w}}}class Td{constructor(){this._zoomIn=new dc({numTouches:1,numTaps:2}),this._zoomOut=new dc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(c,d,v){this._zoomIn.touchstart(c,d,v),this._zoomOut.touchstart(c,d,v)}touchmove(c,d,v){this._zoomIn.touchmove(c,d,v),this._zoomOut.touchmove(c,d,v)}touchend(c,d,v){const w=this._zoomIn.touchend(c,d,v),S=this._zoomOut.touchend(c,d,v);return w?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()+1,around:P.unproject(w)},{originalEvent:c})}):S?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()-1,around:P.unproject(S)},{originalEvent:c})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const kf={0:1,2:2};class hm{constructor(c){this.reset(),this._clickTolerance=c.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(c,d){return!1}_move(c,d){return{}}mousedown(c,d){if(this._lastPoint)return;const v=le(c);this._correctButton(c,v)&&(this._lastPoint=d,this._eventButton=v)}mousemoveWindow(c,d){const v=this._lastPoint;if(v){if(c.preventDefault(),this._eventButton!=null&&function(w,S){const P=kf[S];return w.buttons===void 0||(w.buttons&P)!==P}(c,this._eventButton))this.reset();else if(this._moved||!(d.dist(v)<this._clickTolerance))return this._moved=!0,this._lastPoint=d,this._move(v,d)}}mouseupWindow(c){this._lastPoint&&le(c)===this._eventButton&&(this._moved&&te(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class D_ extends hm{mousedown(c,d){super.mousedown(c,d),this._lastPoint&&(this._active=!0)}_correctButton(c,d){return d===0&&!c.ctrlKey}_move(c,d){return{around:d,panDelta:d.sub(c)}}}class _g extends hm{_correctButton(c,d){return d===0&&c.ctrlKey||d===2}_move(c,d){const v=.8*(d.x-c.x);if(v)return this._active=!0,{bearingDelta:v}}contextmenu(c){c.preventDefault()}}class yg extends hm{_correctButton(c,d){return d===0&&c.ctrlKey||d===2}_move(c,d){const v=-.5*(d.y-c.y);if(v)return this._active=!0,{pitchDelta:v}}contextmenu(c){c.preventDefault()}}class Sd{constructor(c,d){this._map=c,this._el=c.getCanvasContainer(),this._minTouches=1,this._clickTolerance=d.clickTolerance||1,this.reset(),s.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.pointGeometry(0,0)}touchstart(c,d,v){return this._calculateTransform(c,d,v)}touchmove(c,d,v){if(this._active&&!(v.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(v.length===1&&!s.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return c.cancelable&&c.preventDefault(),this._calculateTransform(c,d,v)}}touchend(c,d,v){this._calculateTransform(c,d,v),this._active&&v.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(c,d,v){v.length>0&&(this._active=!0);const w=Yc(v,d),S=new s.pointGeometry(0,0),P=new s.pointGeometry(0,0);let N=0;for(const H in w){const W=w[H],$=this._touches[H];$&&(S._add(W),P._add(W.sub($)),N++,w[H]=W)}if(this._touches=w,N<this._minTouches||!P.mag())return;const B=P.div(N);return this._sum._add(B),this._sum.mag()<this._clickTolerance?void 0:{around:S.div(N),panDelta:B}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=M("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Ff{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(c){}_move(c,d,v){return{}}touchstart(c,d,v){this._firstTwoTouches||v.length<2||(this._firstTwoTouches=[v[0].identifier,v[1].identifier],this._start([d[0],d[1]]))}touchmove(c,d,v){const w=this._firstTwoTouches;if(!w)return;c.preventDefault();const[S,P]=w,N=Kc(v,d,S),B=Kc(v,d,P);if(!N||!B)return;const H=this._aroundCenter?null:N.add(B).div(2);return this._move([N,B],H,c)}touchend(c,d,v){if(!this._firstTwoTouches)return;const[w,S]=this._firstTwoTouches,P=Kc(v,d,w),N=Kc(v,d,S);P&&N||(this._active&&te(),this.reset())}touchcancel(){this.reset()}enable(c){this._enabled=!0,this._aroundCenter=!!c&&c.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Kc(_,c,d){for(let v=0;v<_.length;v++)if(_[v].identifier===d)return c[v]}function vg(_,c){return Math.log(_/c)/Math.LN2}class he extends Ff{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(c){this._startDistance=this._distance=c[0].dist(c[1])}_move(c,d){const v=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(vg(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:vg(this._distance,v),pinchAround:d}}}function Gh(_,c){return 180*_.angleWith(c)/Math.PI}class Tp extends Ff{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])}_move(c,d){const v=this._vector;if(this._vector=c[0].sub(c[1]),v&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Gh(this._vector,v),pinchAround:d}}_isBelowThreshold(c){this._minDiameter=Math.min(this._minDiameter,c.mag());const d=25/(Math.PI*this._minDiameter)*360,v=this._startVector;if(!v)return!1;const w=Gh(c,v);return Math.abs(w)<d}}function Ja(_){return Math.abs(_.y)>Math.abs(_.x)}class Li extends Ff{constructor(c){super(),this._map=c}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(c){this._lastPoints=c,Ja(c[0].sub(c[1]))&&(this._valid=!1)}_move(c,d,v){const w=this._lastPoints;if(!w)return;const S=c[0].sub(w[0]),P=c[1].sub(w[1]);return this._map._cooperativeGestures&&!s.isFullscreen()&&v.touches.length<3||(this._valid=this.gestureBeginsVertically(S,P,v.timeStamp),!this._valid)?void 0:(this._lastPoints=c,this._active=!0,{pitchDelta:(S.y+P.y)/2*-.5})}gestureBeginsVertically(c,d,v){if(this._valid!==void 0)return this._valid;const w=c.mag()>=2,S=d.mag()>=2;if(!w&&!S)return;if(!w||!S)return this._firstMove==null&&(this._firstMove=v),v-this._firstMove<100&&void 0;const P=c.y>0==d.y>0;return Ja(c)&&Ja(d)&&P}}const Yv={panStep:100,bearingStep:15,pitchStep:10};class O_{constructor(){const c=Yv;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(c){if(c.altKey||c.ctrlKey||c.metaKey)return;let d=0,v=0,w=0,S=0,P=0;switch(c.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:c.shiftKey?v=-1:(c.preventDefault(),S=-1);break;case 39:c.shiftKey?v=1:(c.preventDefault(),S=1);break;case 38:c.shiftKey?w=1:(c.preventDefault(),P=-1);break;case 40:c.shiftKey?w=-1:(c.preventDefault(),P=1);break;default:return}return this._rotationDisabled&&(v=0,w=0),{cameraAnimation:N=>{const B=N.getZoom();N.easeTo({duration:300,easeId:"keyboardHandler",easing:Kv,zoom:d?Math.round(B)+d*(c.shiftKey?2:1):B,bearing:N.getBearing()+v*this._bearingStep,pitch:N.getPitch()+w*this._pitchStep,offset:[-S*this._panStep,-P*this._panStep],center:N.getCenter()},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Kv(_){return _*(2-_)}const jh=4.000244140625;class Jc{constructor(c,d){this._map=c,this._el=c.getCanvasContainer(),this._handler=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,s.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(c){this._defaultZoomRate=c}setWheelZoomRate(c){this._wheelZoomRate=c}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!c&&c.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(c){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(c.ctrlKey||c.metaKey||this.isZooming()||s.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let d=c.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY;const v=s.exported.now(),w=v-(this._lastWheelEventTime||0);this._lastWheelEventTime=v,d!==0&&d%jh==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":w>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(w*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),c.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=c,this._delta-=d,this._active||this._start(c)),c.preventDefault()}_onTimeout(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)}_start(c){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=ie(this._el,c);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:d,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const c=this._map.transform;this._type==="wheel"&&c.projection.wrap&&(c._center.lng>=180||c._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const d=()=>c._terrainEnabled()&&this._aroundCoord?c.computeZoomRelativeTo(this._aroundCoord):c.zoom;if(this._delta!==0){const B=this._type==="wheel"&&Math.abs(this._delta)>jh?this._wheelZoomRate:this._defaultZoomRate;let H=2/(1+Math.exp(-Math.abs(this._delta*B)));this._delta<0&&H!==0&&(H=1/H);const W=d(),$=Math.pow(2,W),ae=typeof this._targetZoom=="number"?c.zoomScale(this._targetZoom):$;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(ae*H))),this._type==="wheel"&&(this._startZoom=W,this._easing=this._smoothOutEasing(200)),this._delta=0}const v=typeof this._targetZoom=="number"?this._targetZoom:d(),w=this._startZoom,S=this._easing;let P,N=!1;if(this._type==="wheel"&&w&&S){const B=Math.min((s.exported.now()-this._lastWheelEventTime)/200,1),H=S(B);P=s.number(w,v,H),B<1?this._frameId||(this._frameId=!0):N=!0}else P=v,N=!0;return this._active=!0,N&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!N,zoomDelta:P-d(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(c){let d=s.ease;if(this._prevEase){const v=this._prevEase,w=(s.exported.now()-v.start)/v.duration,S=v.easing(w+.01)-v.easing(w),P=.27/Math.sqrt(S*S+1e-4)*.01,N=Math.sqrt(.0729-P*P);d=s.bezier(P,N,.25,1)}return this._prevEase={start:s.exported.now(),duration:c,easing:d},d}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=M("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(s.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class N_{constructor(c,d){this._clickZoom=c,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Cd{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(c,d){return c.preventDefault(),{cameraAnimation:v=>{v.easeTo({duration:300,zoom:v.getZoom()+(c.shiftKey?-1:1),around:v.unproject(d)},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pc{constructor(){this._tap=new dc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(c,d,v){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?v.length>0&&(this._swipePoint=d[0],this._swipeTouch=v[0].identifier):this._tap.touchstart(c,d,v))}touchmove(c,d,v){if(this._tapTime){if(this._swipePoint){if(v[0].identifier!==this._swipeTouch)return;const w=d[0],S=w.y-this._swipePoint.y;return this._swipePoint=w,c.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(c,d,v)}touchend(c,d,v){this._tapTime?this._swipePoint&&v.length===0&&this.reset():this._tap.touchend(c,d,v)&&(this._tapTime=c.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fm{constructor(c,d,v){this._el=c,this._mousePan=d,this._touchPan=v}enable(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Cn{constructor(c,d,v){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=d,this._mousePitch=v}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class k_{constructor(c,d,v,w){this._el=c,this._touchZoom=d,this._touchRotate=v,this._tapDragZoom=w,this._rotationDisabled=!1,this._enabled=!0}enable(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Sp=_=>_.zoom||_.drag||_.pitch||_.rotate;class Cp extends s.Event{}class Ap{constructor(){this.constants=[1,1,.01],this.radius=0}setup(c,d){const v=s.sub([],d,c);this.radius=s.length(v[2]<0?s.div([],v,this.constants):[v[0],v[1],0])}projectRay(c){s.div(c,c,this.constants),s.normalize(c,c),s.mul$1(c,c,this.constants);const d=s.scale$2([],c,this.radius);if(d[2]>0){const v=s.scale$2([],[0,0,1],s.dot(d,[0,0,1])),w=s.scale$2([],s.normalize([],[d[0],d[1],0]),this.radius),S=s.add([],d,s.scale$2([],s.sub([],s.add([],w,v),d),2));d[0]=S[0],d[1]=S[1]}return d}}function Mp(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}class mc{constructor(c,d){this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new lo(c),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Ap,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(d),s.bindAll(["handleEvent","handleWindowEvent"],this);const v=this._el;this._listeners=[[v,"touchstart",{passive:!0}],[v,"touchmove",{passive:!1}],[v,"touchend",void 0],[v,"touchcancel",void 0],[v,"mousedown",void 0],[v,"mousemove",void 0],[v,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[v,"mouseover",void 0],[v,"mouseout",void 0],[v,"dblclick",void 0],[v,"click",void 0],[v,"keydown",{capture:!1}],[v,"keyup",void 0],[v,"wheel",{passive:!1}],[v,"contextmenu",void 0],[s.window,"blur",void 0]];for(const[w,S,P]of this._listeners)w.addEventListener(S,w===s.window.document?this.handleWindowEvent:this.handleEvent,P)}destroy(){for(const[c,d,v]of this._listeners)c.removeEventListener(d,c===s.window.document?this.handleWindowEvent:this.handleEvent,v)}_addDefaultHandlers(c){const d=this._map,v=d.getCanvasContainer();this._add("mapEvent",new cm(d,c));const w=d.boxZoom=new Ip(d,c);this._add("boxZoom",w);const S=new Td,P=new Cd;d.doubleClickZoom=new N_(P,S),this._add("tapZoom",S),this._add("clickZoom",P);const N=new pc;this._add("tapDragZoom",N);const B=d.touchPitch=new Li(d);this._add("touchPitch",B);const H=new _g(c),W=new yg(c);d.dragRotate=new Cn(c,H,W),this._add("mouseRotate",H,["mousePitch"]),this._add("mousePitch",W,["mouseRotate"]);const $=new D_(c),ae=new Sd(d,c);d.dragPan=new fm(v,$,ae),this._add("mousePan",$),this._add("touchPan",ae,["touchZoom","touchRotate"]);const pe=new Tp,de=new he;d.touchZoomRotate=new k_(v,de,pe,N),this._add("touchRotate",pe,["touchPan","touchZoom"]),this._add("touchZoom",de,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Vh(d));const me=d.scrollZoom=new Jc(d,this);this._add("scrollZoom",me,["mousePan"]);const _e=d.keyboard=new O_;this._add("keyboard",_e);for(const re of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])c.interactive&&c[re]&&d[re].enable(c[re])}_add(c,d,v){this._handlers.push({handlerName:c,handler:d,allowed:v}),this._handlersById[c]=d}stop(c){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}}isActive(){for(const{handler:c}of this._handlers)if(c.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Sp(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(c,d,v){for(const w in c)if(w!==v&&(!d||d.indexOf(w)<0))return!0;return!1}handleWindowEvent(c){this.handleEvent(c,`${c.type}Window`)}_getMapTouches(c){const d=[];for(const v of c)this._el.contains(v.target)&&d.push(v);return d}handleEvent(c,d){this._updatingCamera=!0;const v=c.type==="renderFrame",w=v?void 0:c,S={needsRenderFrame:!1},P={},N={},B=c.touches?this._getMapTouches(c.touches):void 0,H=B?Te(this._el,B):v?void 0:ie(this._el,c);for(const{handlerName:ae,handler:pe,allowed:de}of this._handlers){if(!pe.isEnabled())continue;let me;this._blockedByActive(N,de,ae)?pe.reset():pe[d||c.type]&&(me=pe[d||c.type](c,H,B),this.mergeHandlerResult(S,P,me,ae,w),me&&me.needsRenderFrame&&this._triggerRenderFrame()),(me||pe.isActive())&&(N[ae]=pe)}const W={};for(const ae in this._previousActiveHandlers)N[ae]||(W[ae]=w);this._previousActiveHandlers=N,(Object.keys(W).length||Mp(S))&&(this._changes.push([S,P,W]),this._triggerRenderFrame()),(Object.keys(N).length||Mp(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:$}=S;$&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],$(this._map))}mergeHandlerResult(c,d,v,w,S){if(!v)return;s.extend(c,v);const P={handlerName:w,originalEvent:v.originalEvent||S};v.zoomDelta!==void 0&&(d.zoom=P),v.panDelta!==void 0&&(d.drag=P),v.pitchDelta!==void 0&&(d.pitch=P),v.bearingDelta!==void 0&&(d.rotate=P)}_applyChanges(){const c={},d={},v={};for(const[w,S,P]of this._changes)w.panDelta&&(c.panDelta=(c.panDelta||new s.pointGeometry(0,0))._add(w.panDelta)),w.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+w.zoomDelta),w.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+w.bearingDelta),w.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+w.pitchDelta),w.around!==void 0&&(c.around=w.around),w.aroundCoord!==void 0&&(c.aroundCoord=w.aroundCoord),w.pinchAround!==void 0&&(c.pinchAround=w.pinchAround),w.noInertia&&(c.noInertia=w.noInertia),s.extend(d,S),s.extend(v,P);this._updateMapTransform(c,d,v),this._changes=[]}_updateMapTransform(c,d,v){const w=this._map,S=w.transform,P=Ie=>[Ie.x,Ie.y,Ie.z];if((Ie=>{const Ee=this._eventsInProgress.drag;return Ee&&!this._handlersById[Ee.handlerName].isActive()})()&&!Mp(c)){const Ie=S.zoom;S.cameraElevationReference="sea",S.recenterOnTerrain(),S.cameraElevationReference="ground",Ie!==S.zoom&&this._map._update(!0)}if(S._isCameraConstrained&&w._stop(!0),!Mp(c))return void this._fireEvents(d,v,!0);let{panDelta:N,zoomDelta:B,bearingDelta:H,pitchDelta:W,around:$,aroundCoord:ae,pinchAround:pe}=c;S._isCameraConstrained&&(B>0&&(B=0),S._isCameraConstrained=!1),pe!==void 0&&($=pe),(B||(Ie=>d.drag&&!this._eventsInProgress.drag)())&&$&&(this._dragOrigin=P(S.pointCoordinate3D($)),this._trackingEllipsoid.setup(S._camera.position,this._dragOrigin)),S.cameraElevationReference="sea",w._stop(!0),$=$||w.transform.centerPoint,H&&(S.bearing+=H),W&&(S.pitch+=W),S._updateCameraState();const de=[0,0,0];if(N)if(S.projection.name==="mercator"){const Ie=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay($).dir),Ee=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay($.sub(N)).dir);de[0]=Ee[0]-Ie[0],de[1]=Ee[1]-Ie[1]}else{const Ie=S.pointCoordinate($);if(S.projection.name==="globe"){N=N.rotate(-S.angle);const Ee=S._pixelsPerMercatorPixel/S.worldSize;de[0]=-N.x*s.mercatorScale(s.latFromMercatorY(Ie.y))*Ee,de[1]=-N.y*s.mercatorScale(S.center.lat)*Ee}else{const Ee=S.pointCoordinate($.sub(N));Ie&&Ee&&(de[0]=Ee.x-Ie.x,de[1]=Ee.y-Ie.y)}}const me=S.zoom,_e=[0,0,0];if(B){const Ie=P(ae||S.pointCoordinate3D($)),Ee={dir:s.normalize([],s.sub([],Ie,S._camera.position))};if(Ee.dir[2]<0){const Se=S.zoomDeltaToMovement(Ie,B);s.scale$2(_e,Ee.dir,Se)}}const re=s.add(de,de,_e);S._translateCameraConstrained(re),B&&Math.abs(S.zoom-me)>1e-4&&S.recenterOnTerrain(),S.cameraElevationReference="ground",this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(d,v,!0)}_fireEvents(c,d,v){const w=Sp(this._eventsInProgress),S=Sp(c),P={};for(const W in c){const{originalEvent:$}=c[W];this._eventsInProgress[W]||(P[`${W}start`]=$),this._eventsInProgress[W]=c[W]}!w&&S&&this._fireEvent("movestart",S.originalEvent);for(const W in P)this._fireEvent(W,P[W]);S&&this._fireEvent("move",S.originalEvent);for(const W in c){const{originalEvent:$}=c[W];this._fireEvent(W,$)}const N={};let B;for(const W in this._eventsInProgress){const{handlerName:$,originalEvent:ae}=this._eventsInProgress[W];this._handlersById[$].isActive()||(delete this._eventsInProgress[W],B=d[$]||ae,N[`${W}end`]=B)}for(const W in N)this._fireEvent(W,N[W]);const H=Sp(this._eventsInProgress);if(v&&(w||S)&&!H){this._updatingCamera=!0;const W=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),$=ae=>ae!==0&&-this._bearingSnap<ae&&ae<this._bearingSnap;W?($(W.bearing||this._map.getBearing())&&(W.bearing=0),this._map.easeTo(W,{originalEvent:B})):(this._map.fire(new s.Event("moveend",{originalEvent:B})),$(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(c,d){this._map.fire(new s.Event(c,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(c=>{this._frameId=void 0,this.handleEvent(new Cp("renderFrame",{timeStamp:c})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const xg="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class F_ extends s.Evented{constructor(c,d){super(),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=d.bearingSnap,s.bindAll(["_renderFrameCallback"],this)}getCenter(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(c,d){return this.jumpTo({center:c},d)}panBy(c,d,v){return c=s.pointGeometry.convert(c).mult(-1),this.panTo(this.transform.center,s.extend({offset:c},d),v)}panTo(c,d,v){return this.easeTo(s.extend({center:c},d),v)}getZoom(){return this.transform.zoom}setZoom(c,d){return this.jumpTo({zoom:c},d),this}zoomTo(c,d,v){return this.easeTo(s.extend({zoom:c},d),v)}zoomIn(c,d){return this.zoomTo(this.getZoom()+1,c,d),this}zoomOut(c,d){return this.zoomTo(this.getZoom()-1,c,d),this}getBearing(){return this.transform.bearing}setBearing(c,d){return this.jumpTo({bearing:c},d),this}getPadding(){return this.transform.padding}setPadding(c,d){return this.jumpTo({padding:c},d),this}rotateTo(c,d,v){return this.easeTo(s.extend({bearing:c},d),v)}resetNorth(c,d){return this.rotateTo(0,s.extend({duration:1e3},c),d),this}resetNorthPitch(c,d){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},c),d),this}snapToNorth(c,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,d):this}getPitch(){return this.transform.pitch}setPitch(c,d){return this.jumpTo({pitch:c},d),this}cameraForBounds(c,d){c=s.LngLatBounds.convert(c);const v=d&&d.bearing||0,w=d&&d.pitch||0,S=c.getNorthWest(),P=c.getSouthEast();return this._cameraForBounds(this.transform,S,P,v,w,d)}_extendCameraOptions(c){const d={top:0,bottom:0,right:0,left:0};if(typeof(c=s.extend({padding:d,offset:[0,0],maxZoom:this.transform.maxZoom},c)).padding=="number"){const v=c.padding;c.padding={top:v,bottom:v,right:v,left:v}}return c.padding=s.extend(d,c.padding),c}_minimumAABBFrustumDistance(c,d){const v=d.max[0]-d.min[0],w=d.max[1]-d.min[1];return v/w>c.aspect?v/(2*Math.tan(.5*c.fovX)*c.aspect):w/(2*Math.tan(.5*c.fovY)*c.aspect)}_cameraForBoundsOnGlobe(c,d,v,w,S,P){const N=c.clone(),B=this._extendCameraOptions(P);N.bearing=w,N.pitch=S;const H=s.LngLat.convert(d),W=s.LngLat.convert(v),$=.5*(H.lat+W.lat),ae=.5*(H.lng+W.lng),pe=s.latLngToECEF($,ae),de=s.normalize([],pe),me=s.normalize([],s.cross([],de,[0,1,0])),_e=s.cross([],me,de),re=[me[0],me[1],me[2],0,_e[0],_e[1],_e[2],0,de[0],de[1],de[2],0,0,0,0,1],Ie=[pe,s.latLngToECEF(H.lat,H.lng),s.latLngToECEF(W.lat,H.lng),s.latLngToECEF(W.lat,W.lng),s.latLngToECEF(H.lat,W.lng),s.latLngToECEF($,H.lng),s.latLngToECEF($,W.lng),s.latLngToECEF(H.lat,ae),s.latLngToECEF(W.lat,ae)];let Ee=s.Aabb.fromPoints(Ie.map(Gt=>[s.dot(me,Gt),s.dot(_e,Gt),s.dot(de,Gt)]));const Se=s.transformMat4([],Ee.center,re);s.squaredLength(Se)===0&&s.set(Se,0,0,1),s.normalize(Se,Se),s.scale$2(Se,Se,s.GLOBE_RADIUS),N.center=s.ecefToLatLng(Se);const ze=N.getWorldToCameraMatrix(),De=s.invert(new Float64Array(16),ze);Ee=s.Aabb.applyTransform(Ee,s.multiply([],ze,re)),s.transformMat4(Se,Se,ze);const qe=.5*(Ee.max[2]-Ee.min[2]),lt=this._minimumAABBFrustumDistance(N,Ee),ut=s.scale$2([],[0,0,1],qe),gt=s.add(ut,Se,ut),nn=lt+(N.pitch===0?0:s.distance(Se,gt)),ft=N.globeCenterInViewSpace,Ft=s.sub([],Se,[ft[0],ft[1],ft[2]]);s.normalize(Ft,Ft),s.scale$2(Ft,Ft,nn);const xt=s.add([],Se,Ft);s.transformMat4(xt,xt,De);const Wt=s.earthRadius/s.GLOBE_RADIUS,pt=s.length(xt),at=s.mercatorZfromAltitude(Math.max(pt*Wt-s.earthRadius,Number.EPSILON),0),yt=Math.min(N.zoomFromMercatorZAdjusted(at),B.maxZoom);return yt>.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(N.setProjection({name:"mercator"}),N.zoom=yt,this._cameraForBounds(N,d,v,w,S,P)):{center:N.center,zoom:yt,bearing:w,pitch:S}}queryTerrainElevation(c,d){const v=this.transform.elevation;return v?(d=s.extend({},{exaggerated:!0},d),v.getAtPoint(s.MercatorCoordinate.fromLngLat(c),null,d.exaggerated)):null}_cameraForBounds(c,d,v,w,S,P){if(c.projection.name==="globe")return this._cameraForBoundsOnGlobe(c,d,v,w,S,P);const N=c.clone(),B=this._extendCameraOptions(P),H=N.padding;N.bearing=w,N.pitch=S;const W=s.LngLat.convert(d),$=s.LngLat.convert(v),ae=new s.LngLat(W.lng,$.lat),pe=new s.LngLat($.lng,W.lat),de=N.project(W),me=N.project($),_e=this.queryTerrainElevation(W),re=this.queryTerrainElevation($),Ie=this.queryTerrainElevation(ae),Ee=this.queryTerrainElevation(pe),Se=[[de.x,de.y,Math.min(_e||0,re||0,Ie||0,Ee||0)],[me.x,me.y,Math.max(_e||0,re||0,Ie||0,Ee||0)]];let ze=s.Aabb.fromPoints(Se);const De=N.getWorldToCameraMatrix(),qe=s.invert(new Float64Array(16),De);ze=s.Aabb.applyTransform(ze,De);const lt=s.sub([],ze.max,ze.min),ut=H.left||0,gt=H.right||0,nn=H.bottom||0,ft=H.top||0,{left:Ft,right:xt,top:Wt,bottom:pt}=B.padding,at=.5*(ut+gt),yt=.5*(ft+nn),Gt=Math.min(N.scaleZoom(N.scale*Math.min((N.width-(ut+gt+Ft+xt))/lt[0],(N.height-(nn+ft+pt+Wt))/lt[1])),B.maxZoom),Ht=N.scale/N.zoomScale(Gt);ze=new s.Aabb([ze.min[0]-(Ft+at)*Ht,ze.min[1]-(pt+yt)*Ht,ze.min[2]],[ze.max[0]+(xt+at)*Ht,ze.max[1]+(Wt+yt)*Ht,ze.max[2]]);const Qn=.5*lt[2],ji=this._minimumAABBFrustumDistance(N,ze),Bn=[0,0,1,0];s.transformMat4$1(Bn,Bn,De),s.normalize$2(Bn,Bn);const An=s.scale$2([],Bn,ji+Qn),ni=s.add([],ze.center,An),ir=(typeof B.offset.x=="number"&&typeof B.offset.y=="number"?new s.pointGeometry(B.offset.x,B.offset.y):s.pointGeometry.convert(B.offset)).rotate(-s.degToRad(w));ze.center[0]-=ir.x*Ht,ze.center[1]+=ir.y*Ht,s.transformMat4(ze.center,ze.center,qe),s.transformMat4(ni,ni,qe);const oi=[ze.center[0],ze.center[1],ni[2]*N.pixelsPerMeter];s.scale$2(oi,oi,1/N.worldSize);const Nr=s.lngFromMercatorX(oi[0]),qr=s.latFromMercatorY(oi[1]),cs=Math.min(N._zoomFromMercatorZ(oi[2]),B.maxZoom),Jr=new s.LngLat(Nr,qr);return N.mercatorFromTransition&&cs<.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(N.setProjection({name:"globe"}),N.zoom=cs,this._cameraForBounds(N,d,v,w,S,P)):{center:Jr,zoom:cs,bearing:w,pitch:S}}fitBounds(c,d,v){const w=this.cameraForBounds(c,d);return this._fitInternal(w,d,v)}fitScreenCoordinates(c,d,v,w,S){const P=s.pointGeometry.convert(c),N=s.pointGeometry.convert(d),B=new s.pointGeometry(Math.min(P.x,N.x),Math.min(P.y,N.y)),H=new s.pointGeometry(Math.max(P.x,N.x),Math.max(P.y,N.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(P,N))return this;const W=this.transform.pointLocation3D(B),$=this.transform.pointLocation3D(H),ae=this.transform.pointLocation3D(new s.pointGeometry(B.x,H.y)),pe=this.transform.pointLocation3D(new s.pointGeometry(H.x,B.y)),de=[Math.min(W.lng,$.lng,ae.lng,pe.lng),Math.min(W.lat,$.lat,ae.lat,pe.lat)],me=[Math.max(W.lng,$.lng,ae.lng,pe.lng),Math.max(W.lat,$.lat,ae.lat,pe.lat)],_e=w&&w.pitch?w.pitch:this.getPitch(),re=this._cameraForBounds(this.transform,de,me,v,_e,w);return this._fitInternal(re,w,S)}_fitInternal(c,d,v){return c?(delete(d=s.extend(c,d)).padding,d.linear?this.easeTo(d,v):this.flyTo(d,v)):this}jumpTo(c,d){this.stop();const v=c.preloadOnly?this.transform.clone():this.transform;let w=!1,S=!1,P=!1;return"zoom"in c&&v.zoom!==+c.zoom&&(w=!0,v.zoom=+c.zoom),c.center!==void 0&&(v.center=s.LngLat.convert(c.center)),"bearing"in c&&v.bearing!==+c.bearing&&(S=!0,v.bearing=+c.bearing),"pitch"in c&&v.pitch!==+c.pitch&&(P=!0,v.pitch=+c.pitch),c.padding==null||v.isPaddingEqual(c.padding)||(v.padding=c.padding),c.preloadOnly?(this._preloadTiles(v),this):(this.fire(new s.Event("movestart",d)).fire(new s.Event("move",d)),w&&this.fire(new s.Event("zoomstart",d)).fire(new s.Event("zoom",d)).fire(new s.Event("zoomend",d)),S&&this.fire(new s.Event("rotatestart",d)).fire(new s.Event("rotate",d)).fire(new s.Event("rotateend",d)),P&&this.fire(new s.Event("pitchstart",d)).fire(new s.Event("pitch",d)).fire(new s.Event("pitchend",d)),this.fire(new s.Event("moveend",d)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.warnOnce(xg),this.transform.getFreeCameraOptions()}setFreeCameraOptions(c,d){const v=this.transform;if(!v.projection.supportsFreeCamera)return s.warnOnce(xg),this;this.stop();const w=v.zoom,S=v.pitch,P=v.bearing;v.setFreeCameraOptions(c);const N=w!==v.zoom,B=S!==v.pitch,H=P!==v.bearing;return this.fire(new s.Event("movestart",d)).fire(new s.Event("move",d)),N&&this.fire(new s.Event("zoomstart",d)).fire(new s.Event("zoom",d)).fire(new s.Event("zoomend",d)),H&&this.fire(new s.Event("rotatestart",d)).fire(new s.Event("rotate",d)).fire(new s.Event("rotateend",d)),B&&this.fire(new s.Event("pitchstart",d)).fire(new s.Event("pitch",d)).fire(new s.Event("pitchend",d)),this.fire(new s.Event("moveend",d)),this}easeTo(c,d){this._stop(!1,c.easeId),((c=s.extend({offset:[0,0],duration:500,easing:s.ease},c)).animate===!1||!c.essential&&s.exported.prefersReducedMotion)&&(c.duration=0);const v=this.transform,w=this.getZoom(),S=this.getBearing(),P=this.getPitch(),N=this.getPadding(),B="zoom"in c?+c.zoom:w,H="bearing"in c?this._normalizeBearing(c.bearing,S):S,W="pitch"in c?+c.pitch:P,$="padding"in c?c.padding:v.padding,ae=s.pointGeometry.convert(c.offset);let pe,de,me;if(v.projection.name==="globe"){const ut=s.MercatorCoordinate.fromLngLat(v.center),gt=ae.rotate(-v.angle);ut.x+=gt.x/v.worldSize,ut.y+=gt.y/v.worldSize;const nn=ut.toLngLat(),ft=s.LngLat.convert(c.center||nn);this._normalizeCenter(ft),pe=v.centerPoint.add(gt),de=new s.pointGeometry(ut.x,ut.y).mult(v.worldSize),me=new s.pointGeometry(s.mercatorXfromLng(ft.lng),s.mercatorYfromLat(ft.lat)).mult(v.worldSize).sub(de)}else{pe=v.centerPoint.add(ae);const ut=v.pointLocation(pe),gt=s.LngLat.convert(c.center||ut);this._normalizeCenter(gt),de=v.project(ut),me=v.project(gt).sub(de)}const _e=v.zoomScale(B-w);let re,Ie;c.around&&(re=s.LngLat.convert(c.around),Ie=v.locationPoint(re));const Ee=this._zooming||B!==w,Se=this._rotating||S!==H,ze=this._pitching||W!==P,De=!v.isPaddingEqual($),qe=ut=>gt=>{if(Ee&&(ut.zoom=s.number(w,B,gt)),Se&&(ut.bearing=s.number(S,H,gt)),ze&&(ut.pitch=s.number(P,W,gt)),De&&(ut.interpolatePadding(N,$,gt),pe=ut.centerPoint.add(ae)),re)ut.setLocationAtPoint(re,Ie);else{const nn=ut.zoomScale(ut.zoom-w),ft=B>w?Math.min(2,_e):Math.max(.5,_e),Ft=Math.pow(ft,1-gt),xt=ut.unproject(de.add(me.mult(gt*Ft)).mult(nn));ut.setLocationAtPoint(ut.renderWorldCopies?xt.wrap():xt,pe)}return c.preloadOnly||this._fireMoveEvents(d),ut};if(c.preloadOnly){const ut=this._emulate(qe,c.duration,v);return this._preloadTiles(ut),this}const lt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ee,this._rotating=Se,this._pitching=ze,this._padding=De,this._easeId=c.easeId,this._prepareEase(d,c.noMoveStart,lt),this._ease(qe(v),ut=>{v.recenterOnTerrain(),this._afterEase(d,ut)},c),this}_prepareEase(c,d,v={}){this._moving=!0,this.transform.cameraElevationReference="sea",d||v.moving||this.fire(new s.Event("movestart",c)),this._zooming&&!v.zooming&&this.fire(new s.Event("zoomstart",c)),this._rotating&&!v.rotating&&this.fire(new s.Event("rotatestart",c)),this._pitching&&!v.pitching&&this.fire(new s.Event("pitchstart",c))}_fireMoveEvents(c){this.fire(new s.Event("move",c)),this._zooming&&this.fire(new s.Event("zoom",c)),this._rotating&&this.fire(new s.Event("rotate",c)),this._pitching&&this.fire(new s.Event("pitch",c))}_afterEase(c,d){if(this._easeId&&d&&this._easeId===d)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const v=this._zooming,w=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,v&&this.fire(new s.Event("zoomend",c)),w&&this.fire(new s.Event("rotateend",c)),S&&this.fire(new s.Event("pitchend",c)),this.fire(new s.Event("moveend",c))}flyTo(c,d){if(!c.essential&&s.exported.prefersReducedMotion){const Gt=s.pick(c,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Gt,d)}this.stop(),c=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},c);const v=this.transform,w=this.getZoom(),S=this.getBearing(),P=this.getPitch(),N=this.getPadding(),B="zoom"in c?s.clamp(+c.zoom,v.minZoom,v.maxZoom):w,H="bearing"in c?this._normalizeBearing(c.bearing,S):S,W="pitch"in c?+c.pitch:P,$="padding"in c?c.padding:v.padding,ae=v.zoomScale(B-w),pe=s.pointGeometry.convert(c.offset);let de=v.centerPoint.add(pe);const me=v.pointLocation(de),_e=s.LngLat.convert(c.center||me);this._normalizeCenter(_e);const re=v.project(me),Ie=v.project(_e).sub(re);let Ee=c.curve;const Se=Math.max(v.width,v.height),ze=Se/ae,De=Ie.mag();if("minZoom"in c){const Gt=s.clamp(Math.min(c.minZoom,w,B),v.minZoom,v.maxZoom),Ht=Se/v.zoomScale(Gt-w);Ee=Math.sqrt(Ht/De*2)}const qe=Ee*Ee;function lt(Gt){const Ht=(ze*ze-Se*Se+(Gt?-1:1)*qe*qe*De*De)/(2*(Gt?ze:Se)*qe*De);return Math.log(Math.sqrt(Ht*Ht+1)-Ht)}function ut(Gt){return(Math.exp(Gt)-Math.exp(-Gt))/2}function gt(Gt){return(Math.exp(Gt)+Math.exp(-Gt))/2}const nn=lt(0);let ft=function(Gt){return gt(nn)/gt(nn+Ee*Gt)},Ft=function(Gt){return Se*((gt(nn)*(ut(Ht=nn+Ee*Gt)/gt(Ht))-ut(nn))/qe)/De;var Ht},xt=(lt(1)-nn)/Ee;if(Math.abs(De)<1e-6||!isFinite(xt)){if(Math.abs(Se-ze)<1e-6)return this.easeTo(c,d);const Gt=ze<Se?-1:1;xt=Math.abs(Math.log(ze/Se))/Ee,Ft=function(){return 0},ft=function(Ht){return Math.exp(Gt*Ee*Ht)}}c.duration="duration"in c?+c.duration:1e3*xt/("screenSpeed"in c?+c.screenSpeed/Ee:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0);const Wt=S!==H,pt=W!==P,at=!v.isPaddingEqual($),yt=Gt=>Ht=>{const Qn=Ht*xt,ji=1/ft(Qn);Gt.zoom=Ht===1?B:w+Gt.scaleZoom(ji),Wt&&(Gt.bearing=s.number(S,H,Ht)),pt&&(Gt.pitch=s.number(P,W,Ht)),at&&(Gt.interpolatePadding(N,$,Ht),de=Gt.centerPoint.add(pe));const Bn=Ht===1?_e:Gt.unproject(re.add(Ie.mult(Ft(Qn))).mult(ji));return Gt.setLocationAtPoint(Gt.renderWorldCopies?Bn.wrap():Bn,de),Gt._updateCameraOnTerrain(),c.preloadOnly||this._fireMoveEvents(d),Gt};if(c.preloadOnly){const Gt=this._emulate(yt,c.duration,v);return this._preloadTiles(Gt),this}return this._zooming=!0,this._rotating=Wt,this._pitching=pt,this._padding=at,this._prepareEase(d,!1),this._ease(yt(v),()=>this._afterEase(d),c),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(c,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const v=this._onEaseEnd;this._onEaseEnd=void 0,v.call(this,d)}if(!c){const v=this.handlers;v&&v.stop(!1)}return this}_ease(c,d,v){v.animate===!1||v.duration===0?(c(1),d()):(this._easeStart=s.exported.now(),this._easeOptions=v,this._onEaseFrame=c,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const c=Math.min((s.exported.now()-this._easeStart)/this._easeOptions.duration,1),d=this._onEaseFrame;d&&d(this._easeOptions.easing(c)),c<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(c,d){c=s.wrap(c,-180,180);const v=Math.abs(c-d);return Math.abs(c-360-d)<v&&(c-=360),Math.abs(c+360-d)<v&&(c+=360),c}_normalizeCenter(c){const d=this.transform;if(!d.renderWorldCopies||d.maxBounds)return;const v=c.lng-d.center.lng;c.lng+=v>180?-360:v<-180?360:0}_emulate(c,d,v){const w=Math.ceil(15*d/1e3),S=[],P=c(v.clone());for(let N=0;N<=w;N++){const B=P(N/w);S.push(B.clone())}return S}}class bg{constructor(c={}){this.options=c,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(c){const d=this.options&&this.options.compact;return this._map=c,this._container=M("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=M("button","mapboxgl-ctrl-attrib-button",this._container),M("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=M("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),d&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),d===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(c,d){const v=this._map._getUIString(`AttributionControl.${d}`);c.setAttribute("aria-label",v),c.removeAttribute("title"),c.firstElementChild&&c.firstElementChild.setAttribute("title",v)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let c=this._editLink;c||(c=this._editLink=this._container.querySelector(".mapbox-improve-map"));const d=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(c){const v=d.reduce((w,S,P)=>(S.value&&(w+=`${S.key}=${S.value}${P<d.length-1?"&":""}`),w),"?");c.href=`${s.config.FEEDBACK_URL}/${v}#${Ed(this._map,!0)}`,c.rel="noopener nofollow",this._setElementTitle(c,"MapFeedback")}}_updateData(c){!c||c.sourceDataType!=="metadata"&&c.sourceDataType!=="visibility"&&c.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let c=[];if(this._map.style.stylesheet){const w=this._map.style.stylesheet;this.styleOwner=w.owner,this.styleId=w.id}const d=this._map.style._sourceCaches;for(const w in d){const S=d[w];if(S.used){const P=S.getSource();P.attribution&&c.indexOf(P.attribution)<0&&c.push(P.attribution)}}c.sort((w,S)=>w.length-S.length),c=c.filter((w,S)=>{for(let P=S+1;P<c.length;P++)if(c[P].indexOf(w)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=[...this.options.customAttribution,...c]:c.unshift(this.options.customAttribution));const v=c.join(" | ");v!==this._attribHTML&&(this._attribHTML=v,c.length?(this._innerContainer.innerHTML=v,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Eg{constructor(){s.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(c){this._map=c,this._container=M("div","mapboxgl-ctrl");const d=M("a","mapboxgl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://www.mapbox.com/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(c){c&&c.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const c=this._map.style._sourceCaches;if(Object.entries(c).length===0)return!0;for(const d in c){const v=c[d].getSource();if(v.hasOwnProperty("mapbox_logo")&&!v.mapbox_logo)return!1}return!0}_updateCompact(){const c=this._container.children;if(c.length){const d=c[0];this._map.getCanvasContainer().offsetWidth<250?d.classList.add("mapboxgl-compact"):d.classList.remove("mapboxgl-compact")}}}class Lp{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(c){const d=++this._id;return this._queue.push({callback:c,id:d,cancelled:!1}),d}remove(c){const d=this._currentlyRunning,v=d?this._queue.concat(d):this._queue;for(const w of v)if(w.id===c)return void(w.cancelled=!0)}run(c=0){const d=this._currentlyRunning=this._queue;this._queue=[];for(const v of d)if(!v.cancelled&&(v.callback(c),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function gc(_,c,d){if(_=new s.LngLat(_.lng,_.lat),c){const v=new s.LngLat(_.lng-360,_.lat),w=new s.LngLat(_.lng+360,_.lat),S=360*Math.ceil(Math.abs(_.lng-d.center.lng)/360),P=d.locationPoint(_).distSqr(c),N=c.x<0||c.y<0||c.x>d.width||c.y>d.height;d.locationPoint(v).distSqr(c)<P&&(N||Math.abs(v.lng-d.center.lng)<S)?_=v:d.locationPoint(w).distSqr(c)<P&&(N||Math.abs(w.lng-d.center.lng)<S)&&(_=w)}for(;Math.abs(_.lng-d.center.lng)>180;){const v=d.locationPoint(_);if(v.x>=0&&v.y>=0&&v.x<=d.width&&v.y<=d.height)break;_.lng>d.center.lng?_.lng-=360:_.lng+=360}return _}const Ad={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class dm extends s.Evented{constructor(c,d){if(super(),(c instanceof s.window.HTMLElement||d)&&(c=s.extend({element:c},d)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&c.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=c&&c.occludedOpacity||.2,c&&c.element)this._element=c.element,this._offset=s.pointGeometry.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=M("div");const w=41,S=27,P=O("svg",{display:"block",height:w*this._scale+"px",width:S*this._scale+"px",viewBox:`0 0 ${S} ${w}`},this._element),N=O("radialGradient",{id:"shadowGradient"},O("defs",{},P));O("stop",{offset:"10%","stop-opacity":.4},N),O("stop",{offset:"100%","stop-opacity":.05},N),O("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},P),O("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},P),O("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},P),O("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},P),this._offset=s.pointGeometry.convert(c&&c.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",w=>{w.preventDefault()}),this._element.addEventListener("mousedown",w=>{w.preventDefault()});const v=this._element.classList;for(const w in Ad)v.remove(`mapboxgl-marker-anchor-${w}`);v.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(c){return c===this._map||(this.remove(),this._map=c,c.getCanvasContainer().appendChild(this._element),c.on("move",this._updateMoving),c.on("moveend",this._update),c.on("remove",this._clearFadeTimer),c._addMarker(this),this.setDraggable(this._draggable),this._update(),c.on("click",this._onMapClick)),this}remove(){const c=this._map;return c&&(c.off("click",this._onMapClick),c.off("move",this._updateMoving),c.off("moveend",this._update),c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler),c.off("mouseup",this._onUp),c.off("touchend",this._onUp),c.off("mousemove",this._onMove),c.off("touchmove",this._onMove),c.off("remove",this._clearFadeTimer),c._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(c){return this._lngLat=s.LngLat.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){const w=Math.sqrt(Math.pow(13.5,2)/2);c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[w,-1*(38.1-13.5+w)],"bottom-right":[-w,-1*(38.1-13.5+w)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=c,c._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(c){const d=c.code,v=c.charCode||c.keyCode;d!=="Space"&&d!=="Enter"&&v!==32&&v!==13||this.togglePopup()}_onMapClick(c){const d=c.originalEvent.target,v=this._element;this._popup&&(d===v||v.contains(d))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const c=this._popup;return c?(c.isOpen()?(c.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(c.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const c=this._map,d=this._pos;if(!c||!d)return!1;const v=c.unproject(d),w=c.getFreeCameraOptions();if(!w.position)return!1;const S=w.position.toLngLat();return S.distanceTo(v)<.9*S.distanceTo(this._lngLat)}_evaluateOpacity(){const c=this._map;if(!c)return;const d=this._pos;if(!d||d.x<0||d.x>c.transform.width||d.y<0||d.y>c.transform.height)return void this._clearFadeTimer();const v=c.unproject(d);let w;c._showingGlobe()&&s.isLngLatBehindGlobe(c.transform,this._lngLat)?w=0:(w=1-c._queryFogOpacity(v),c.transform._terrainEnabled()&&c.getTerrain()&&this._behindTerrain()&&(w*=this._occludedOpacity)),this._element.style.opacity=`${w}`,this._element.style.pointerEvents=w>0?"auto":"none",this._popup&&this._popup._setOpacity(w),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const c=this._pos;if(!c||!this._map)return;const d=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${c.x}px,${c.y}px)
            ${Ad[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${d.x}px,${d.y}px)
        `}_calculateXYTransform(){const c=this._pos,d=this._map,v=this.getPitchAlignment();if(!d||!c||v!=="map")return"";if(!d._showingGlobe()){const B=d.getPitch();return B?`rotateX(${B}deg)`:""}const w=s.radToDeg(s.globeTiltAtLngLat(d.transform,this._lngLat)),S=c.sub(s.globeCenterToScreenPoint(d.transform)),P=Math.abs(S.x)+Math.abs(S.y);if(P===0)return"";const N=w/P;return`rotateX(${-S.y*N}deg) rotateY(${S.x*N}deg)`}_calculateZTransform(){const c=this._pos,d=this._map;if(!d||!c)return"";let v=0;const w=this.getRotationAlignment();if(w==="map")if(d._showingGlobe()){const S=d.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),P=d.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(S);v=s.radToDeg(Math.atan2(P.y,P.x))-90}else v=-d.getBearing();else if(w==="horizon"){const S=s.smoothstep(4,6,d.getZoom()),P=s.globeCenterToScreenPoint(d.transform);P.y+=S*d.transform.height;const N=c.sub(P),B=s.radToDeg(Math.atan2(N.y,N.x));v=(B>90?B-270:B+90)*(1-S)}return v+=this._rotation,v?`rotateZ(${v}deg)`:""}_update(c){s.window.cancelAnimationFrame(this._updateFrameId);const d=this._map;d&&(d.transform.renderWorldCopies&&(this._lngLat=gc(this._lngLat,this._pos,d.transform)),this._pos=d.project(this._lngLat),c===!0?this._updateFrameId=s.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),d._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(d._showingGlobe()||d.getTerrain()||d.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(c){return this._offset=s.pointGeometry.convert(c),this._update(),this}_onMove(c){const d=this._map;if(!d)return;const v=this._pointerdownPos,w=this._positionDelta;if(v&&w){if(!this._isDragging){const S=this._clickTolerance||d._clickTolerance;if(c.point.dist(v)<S)return;this._isDragging=!0}this._pos=c.point.sub(w),this._lngLat=d.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const c=this._map;c&&(c.off("mousemove",this._onMove),c.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"}_addDragHandler(c){const d=this._map,v=this._pos;d&&v&&this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(v),this._pointerdownPos=c.point,this._state="pending",d.on("mousemove",this._onMove),d.on("touchmove",this._onMove),d.once("mouseup",this._onUp),d.once("touchend",this._onUp))}setDraggable(c){this._draggable=!!c;const d=this._map;return d&&(c?(d.on("mousedown",this._addDragHandler),d.on("touchstart",this._addDragHandler)):(d.off("mousedown",this._addDragHandler),d.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(c){return this._rotation=c||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(c){return this._rotationAlignment=c||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(c){return this._pitchAlignment=c||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(c){return this._occludedOpacity=c||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const iu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},B_=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function wg(_=new s.pointGeometry(0,0),c="bottom"){if(typeof _=="number"){const d=Math.round(Math.sqrt(.5*Math.pow(_,2)));switch(c){case"top":return new s.pointGeometry(0,_);case"top-left":return new s.pointGeometry(d,d);case"top-right":return new s.pointGeometry(-d,d);case"bottom":return new s.pointGeometry(0,-_);case"bottom-left":return new s.pointGeometry(d,-d);case"bottom-right":return new s.pointGeometry(-d,-d);case"left":return new s.pointGeometry(_,0);case"right":return new s.pointGeometry(-_,0)}return new s.pointGeometry(0,0)}return _ instanceof s.pointGeometry||Array.isArray(_)?s.pointGeometry.convert(_):s.pointGeometry.convert(_[c]||[0,0])}class z_{constructor(c){this.jumpTo(c)}getValue(c){if(c<=this._startTime)return this._start;if(c>=this._endTime)return this._end;const d=s.easeCubicInOut((c-this._startTime)/(this._endTime-this._startTime));return this._start*(1-d)+this._end*d}isEasing(c){return c>=this._startTime&&c<=this._endTime}jumpTo(c){this._startTime=-1/0,this._endTime=-1/0,this._start=c,this._end=c}easeTo(c,d,v){this._start=this.getValue(d),this._end=c,this._startTime=d,this._endTime=d+v}}const U_={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},V_={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},pm={showCompass:!0,showZoom:!0,visualizePitch:!1};class Ig{constructor(c,d,v=!1){this._clickTolerance=10,this.element=d,this.mouseRotate=new _g({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,v&&(this.mousePitch=new yg({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),d.addEventListener("mousedown",this.mousedown),d.addEventListener("touchstart",this.touchstart,{passive:!1}),d.addEventListener("touchmove",this.touchmove),d.addEventListener("touchend",this.touchend),d.addEventListener("touchcancel",this.reset)}down(c,d){this.mouseRotate.mousedown(c,d),this.mousePitch&&this.mousePitch.mousedown(c,d),q()}move(c,d){const v=this.map,w=this.mouseRotate.mousemoveWindow(c,d),S=w&&w.bearingDelta;if(S&&v.setBearing(v.getBearing()+S),this.mousePitch){const P=this.mousePitch.mousemoveWindow(c,d),N=P&&P.pitchDelta;N&&v.setPitch(v.getPitch()+N)}}off(){const c=this.element;c.removeEventListener("mousedown",this.mousedown),c.removeEventListener("touchstart",this.touchstart,{passive:!1}),c.removeEventListener("touchmove",this.touchmove),c.removeEventListener("touchend",this.touchend),c.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Z(),s.window.removeEventListener("mousemove",this.mousemove),s.window.removeEventListener("mouseup",this.mouseup)}mousedown(c){this.down(s.extend({},c,{ctrlKey:!0,preventDefault:()=>c.preventDefault()}),ie(this.element,c)),s.window.addEventListener("mousemove",this.mousemove),s.window.addEventListener("mouseup",this.mouseup)}mousemove(c){this.move(c,ie(this.element,c))}mouseup(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()}touchstart(c){c.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Te(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>c.preventDefault()},this._startPos))}touchmove(c){c.targetTouches.length!==1?this.reset():(this._lastPos=Te(this.element,c.targetTouches)[0],this.move({preventDefault:()=>c.preventDefault()},this._lastPos))}touchend(c){c.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const G_={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},j_={maxWidth:100,unit:"metric"};function mm(_,c,d){const v=qh(c),w=v/c,S={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[d];this._map._requestDomTask(()=>{this._container.style.width=_*w+"px",this._container.innerHTML=`${v}&nbsp;${S}`})}function qh(_){const c=Math.pow(10,`${Math.floor(_)}`.length-1);let d=_/c;return d=d>=10?10:d>=5?5:d>=3?3:d>=2?2:d>=1?1:function(v){const w=Math.pow(10,Math.ceil(-Math.log(v)/Math.LN10));return Math.round(v*w)/w}(d),c*d}const Hh={version:s.version,supported:x,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:class extends F_{constructor(_){if(s.LivePerformanceUtils.mark(s.PerformanceMarkers.create),(_=s.extend({},V_,_)).minZoom!=null&&_.maxZoom!=null&&_.minZoom>_.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(_.minPitch!=null&&_.maxPitch!=null&&_.minPitch>_.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(_.minPitch!=null&&_.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(_.maxPitch!=null&&_.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(_.antialias&&s.isSafariWithAntialiasingBug(s.window)&&(_.antialias=!1,s.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Sn(_.minZoom,_.maxZoom,_.minPitch,_.maxPitch,_.renderWorldCopies),_),this._interactive=_.interactive,this._minTileCacheSize=_.minTileCacheSize,this._maxTileCacheSize=_.maxTileCacheSize,this._failIfMajorPerformanceCaveat=_.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=_.preserveDrawingBuffer,this._antialias=_.antialias,this._useWebGL2=_.useWebGL2,this._trackResize=_.trackResize,this._bearingSnap=_.bearingSnap,this._refreshExpiredTiles=_.refreshExpiredTiles,this._fadeDuration=_.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=_.crossSourceCollisions,this._collectResourceTiming=_.collectResourceTiming,this._optimizeForTerrain=_.optimizeForTerrain,this._language=this._parseLanguage(_.language),this._worldview=_.worldview,this._renderTaskQueue=new Lp,this._domRenderTaskQueue=new Lp,this._controls=[],this._markers=[],this._popups=[],this._mapId=s.uniqueId(),this._locale=s.extend({},U_,_.locale),this._clickTolerance=_.clickTolerance,this._cooperativeGestures=_.cooperativeGestures,this._performanceMetricsCollection=_.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new z_(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new s.RequestManager(_.transformRequest,_.accessToken,_.testMode),this._silenceAuthErrors=!!_.testMode,typeof _.container=="string"){if(this._container=s.window.document.getElementById(_.container),!this._container)throw new Error(`Container '${_.container}' not found.`)}else{if(!(_.container instanceof s.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=_.container}if(this._container.childNodes.length>0&&s.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),_.maxBounds&&this.setMaxBounds(_.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),s.window!==void 0&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1),s.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new mc(this,_),this._localFontFamily=_.localFontFamily,this._localIdeographFontFamily=_.localIdeographFontFamily,_.style&&this.setStyle(_.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),_.projection&&this.setProjection(_.projection),this._hash=_.hash&&new bp(typeof _.hash=="string"&&_.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch}),_.bounds&&(this.resize(),this.fitBounds(_.bounds,s.extend({},_.fitBoundsOptions,{duration:0})))),this.resize(),_.attributionControl&&this.addControl(new bg({customAttribution:_.customAttribution})),this._logoControl=new Eg,this.addControl(this._logoControl,_.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",c=>{this._update(c.dataType==="style"),this.fire(new s.Event(`${c.dataType}data`,c))}),this.on("dataloading",c=>{this.fire(new s.Event(`${c.dataType}dataloading`,c))})}_getMapId(){return this._mapId}addControl(_,c){if(c===void 0&&(c=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=_.onAdd(this);this._controls.push(_);const v=this._controlPositions[c];return c.indexOf("bottom")!==-1?v.insertBefore(d,v.firstChild):v.appendChild(d),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const c=this._controls.indexOf(_);return c>-1&&this._controls.splice(c,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(_){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const c=!this._moving;return c&&this.fire(new s.Event("movestart",_)).fire(new s.Event("move",_)),this.fire(new s.Event("resize",_)),c&&this.fire(new s.Event("moveend",_)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(_){return this.transform.setMaxBounds(s.LngLatBounds.convert(_)),this._update()}setMinZoom(_){if((_=_??-2)>=-2&&_<=this.transform.maxZoom)return this.transform.minZoom=_,this._update(),this.getZoom()<_?this.setZoom(_):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_??22)>=this.transform.minZoom)return this.transform.maxZoom=_,this._update(),this.getZoom()>_?this.setZoom(_):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.minPitch=_,this._update(),this.getPitch()<_?this.setPitch(_):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(_>=this.transform.minPitch)return this.transform.maxPitch=_,this._update(),this.getPitch()>_?this.setPitch(_):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.renderWorldCopies=_,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(_){return _==="auto"?s.window.navigator.language:Array.isArray(_)?_.length===0?void 0:_.map(c=>c==="auto"?s.window.navigator.language:c):_}setLanguage(_){const c=this._parseLanguage(_);if(!this.style||c===this._language)return this;this._language=c,this.style._reloadSources();for(const d of this._controls)d._setLanguage&&d._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(_){return this.style&&_!==this._worldview?(this._worldview=_,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(_){return this._lazyInitEmptyStyle(),_?typeof _=="string"&&(_={name:_}):_=null,this._useExplicitProjection=!!_,this._prioritizeAndUpdateProjection(_,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const _=this.transform,c=_.projection.name;let d;c==="globe"&&_.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?(_.setMercatorFromTransition(),d=!0):c==="mercator"&&_.zoom<s.GLOBE_ZOOM_THRESHOLD_MAX&&(_.setProjection({name:"globe"}),d=!0),d&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(_,c){return this._updateProjection(_||c||{name:"mercator"})}_updateProjection(_){let c;if(c=_.name==="globe"&&this.transform.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(_),this.style.applyProjectionUpdate(),c){this.painter.clearBackgroundTiles();for(const d in this.style._sourceCaches)this.style._sourceCaches[d].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(_){return this.transform.locationPoint3D(s.LngLat.convert(_))}unproject(_){return this.transform.pointLocation3D(s.pointGeometry.convert(_))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(_,c,d){if(_==="mouseenter"||_==="mouseover"){let v=!1;const w=P=>{const N=c.filter(H=>this.getLayer(H)),B=N.length?this.queryRenderedFeatures(P.point,{layers:N}):[];B.length?v||(v=!0,d.call(this,new ta(_,this,P.originalEvent,{features:B}))):v=!1},S=()=>{v=!1};return{layers:new Set(c),listener:d,delegates:{mousemove:w,mouseout:S}}}if(_==="mouseleave"||_==="mouseout"){let v=!1;const w=P=>{const N=c.filter(B=>this.getLayer(B));(N.length?this.queryRenderedFeatures(P.point,{layers:N}):[]).length?v=!0:v&&(v=!1,d.call(this,new ta(_,this,P.originalEvent)))},S=P=>{v&&(v=!1,d.call(this,new ta(_,this,P.originalEvent)))};return{layers:new Set(c),listener:d,delegates:{mousemove:w,mouseout:S}}}{const v=w=>{const S=c.filter(N=>this.getLayer(N)),P=S.length?this.queryRenderedFeatures(w.point,{layers:S}):[];P.length&&(w.features=P,d.call(this,w),delete w.features)};return{layers:new Set(c),listener:d,delegates:{[_]:v}}}}on(_,c,d){if(d===void 0)return super.on(_,c);Array.isArray(c)||(c=[c]);const v=this._createDelegatedListener(_,c,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(v);for(const w in v.delegates)this.on(w,v.delegates[w]);return this}once(_,c,d){if(d===void 0)return super.once(_,c);Array.isArray(c)||(c=[c]);const v=this._createDelegatedListener(_,c,d);for(const w in v.delegates)this.once(w,v.delegates[w]);return this}off(_,c,d){if(d===void 0)return super.off(_,c);c=new Set(Array.isArray(c)?c:[c]);const v=(S,P)=>{if(S.size!==P.size)return!1;for(const N of S)if(!P.has(N))return!1;return!0},w=this._delegatedListeners?this._delegatedListeners[_]:void 0;return w&&(S=>{for(let P=0;P<S.length;P++){const N=S[P];if(N.listener===d&&v(N.layers,c)){for(const B in N.delegates)this.off(B,N.delegates[B]);return S.splice(P,1),this}}})(w),this}queryRenderedFeatures(_,c){return this.style?(c!==void 0||_===void 0||_ instanceof s.pointGeometry||Array.isArray(_)||(c=_,_=void 0),this.style.queryRenderedFeatures(_=_||[[0,0],[this.transform.width,this.transform.height]],c=c||{},this.transform)):[]}querySourceFeatures(_,c){return this.style.querySourceFeatures(_,c)}setStyle(_,c){return(c=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},c)).diff!==!1&&c.localIdeographFontFamily===this._localIdeographFontFamily&&c.localFontFamily===this._localFontFamily&&this.style&&_?(this._diffStyle(_,c),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._localFontFamily=c.localFontFamily,this._updateStyle(_,c))}_getUIString(_){const c=this._locale[_];if(c==null)throw new Error(`Missing UI string '${_}'`);return c}_updateStyle(_,c){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),_&&(this.style=new us(this,c||{}),this.style.setEventedParent(this,{style:this.style}),typeof _=="string"?this.style.loadURL(_):this.style.loadJSON(_)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new us(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,c){if(typeof _=="string"){const d=this._requestManager.normalizeStyleURL(_),v=this._requestManager.transformRequest(d,s.ResourceType.Style);s.getJSON(v,(w,S)=>{w?this.fire(new s.ErrorEvent(w)):S&&this._updateDiff(S,c)})}else typeof _=="object"&&this._updateDiff(_,c)}_updateDiff(_,c){try{this.style.setState(_)&&this._update(!0)}catch(d){s.warnOnce(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(_,c)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.warnOnce("There is no style added to the map."),!1)}addSource(_,c){return this._lazyInitEmptyStyle(),this.style.addSource(_,c),this._update(!0)}isSourceLoaded(_){return!!this.style&&this.style._isSourceCacheLoaded(_)}areTilesLoaded(){const _=this.style&&this.style._sourceCaches;for(const c in _){const d=_[c]._tiles;for(const v in d){const w=d[v];if(w.state!=="loaded"&&w.state!=="errored")return!1}}return!0}addSourceType(_,c,d){this._lazyInitEmptyStyle(),this.style.addSourceType(_,c,d)}removeSource(_){return this.style.removeSource(_),this._updateTerrain(),this._update(!0)}getSource(_){return this.style.getSource(_)}addImage(_,c,{pixelRatio:d=1,sdf:v=!1,stretchX:w,stretchY:S,content:P}={}){if(this._lazyInitEmptyStyle(),c instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&c instanceof s.window.ImageBitmap){const{width:N,height:B,data:H}=s.exported.getImageData(c);this.style.addImage(_,{data:new s.RGBAImage({width:N,height:B},H),pixelRatio:d,stretchX:w,stretchY:S,content:P,sdf:v,version:0})}else if(c.width===void 0||c.height===void 0)this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:N,height:B}=c,H=c;this.style.addImage(_,{data:new s.RGBAImage({width:N,height:B},new Uint8Array(H.data)),pixelRatio:d,stretchX:w,stretchY:S,content:P,sdf:v,version:0,userImage:H}),H.onAdd&&H.onAdd(this,_)}}updateImage(_,c){const d=this.style.getImage(_);if(!d)return void this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const v=c instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&c instanceof s.window.ImageBitmap?s.exported.getImageData(c):c,{width:w,height:S}=v;w!==void 0&&S!==void 0?w===d.data.width&&S===d.data.height?(d.data.replace(v.data,!(c instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&c instanceof s.window.ImageBitmap)),this.style.updateImage(_,d)):this.fire(new s.ErrorEvent(new Error(`The width and height of the updated image (${w}, ${S})
                must be that same as the previous version of the image
                (${d.data.width}, ${d.data.height})`))):this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(_){return _?!!this.style.getImage(_):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_,c){s.getImage(this._requestManager.transformRequest(_,s.ResourceType.Image),(d,v)=>{c(d,v instanceof s.window.HTMLImageElement?s.exported.getImageData(v):v)})}listImages(){return this.style.listImages()}addLayer(_,c){return this._lazyInitEmptyStyle(),this.style.addLayer(_,c),this._update(!0)}moveLayer(_,c){return this.style.moveLayer(_,c),this._update(!0)}removeLayer(_){return this.style.removeLayer(_),this._update(!0)}getLayer(_){return this.style.getLayer(_)}setLayerZoomRange(_,c,d){return this.style.setLayerZoomRange(_,c,d),this._update(!0)}setFilter(_,c,d={}){return this.style.setFilter(_,c,d),this._update(!0)}getFilter(_){return this.style.getFilter(_)}setPaintProperty(_,c,d,v={}){return this.style.setPaintProperty(_,c,d,v),this._update(!0)}getPaintProperty(_,c){return this.style.getPaintProperty(_,c)}setLayoutProperty(_,c,d,v={}){return this.style.setLayoutProperty(_,c,d,v),this._update(!0)}getLayoutProperty(_,c){return this.style.getLayoutProperty(_,c)}setLight(_,c={}){return this._lazyInitEmptyStyle(),this.style.setLight(_,c),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(_){return this._lazyInitEmptyStyle(),!_&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(_),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(_){return this._lazyInitEmptyStyle(),this.style.setFog(_),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(_){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.LngLat.convert(_),this.transform):0}setFeatureState(_,c){return this.style.setFeatureState(_,c),this._update()}removeFeatureState(_,c){return this.style.removeFeatureState(_,c),this._update()}getFeatureState(_){return this.style.getFeatureState(_)}_updateContainerDimensions(){if(!this._container)return;const _=this._container.getBoundingClientRect().width||400,c=this._container.getBoundingClientRect().height||300;let d,v,w,S=this._container;for(;S&&(!v||!w);){const P=s.window.getComputedStyle(S).transform;P&&P!=="none"&&(d=P.match(/matrix.*\((.+)\)/)[1].split(", "),d[0]&&d[0]!=="0"&&d[0]!=="1"&&(v=d[0]),d[3]&&d[3]!=="0"&&d[3]!=="1"&&(w=d[3])),S=S.parentElement}this._containerWidth=v?Math.abs(_/v):_,this._containerHeight=w?Math.abs(c/w):c}_detectMissingCSS(){s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const _=this._container;_.classList.add("mapboxgl-map"),(this._missingCSSCanary=M("div","mapboxgl-canary",_)).style.visibility="hidden",this._detectMissingCSS();const c=this._canvasContainer=M("div","mapboxgl-canvas-container",_);this._interactive&&c.classList.add("mapboxgl-interactive"),this._canvas=M("canvas","mapboxgl-canvas",c),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const d=this._controlContainer=M("div","mapboxgl-control-container",_),v=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{v[w]=M("div",`mapboxgl-ctrl-${w}`,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(_,c){const d=s.exported.devicePixelRatio||1;this._canvas.width=d*Math.ceil(_),this._canvas.height=d*Math.ceil(c),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${c}px`}_addMarker(_){this._markers.push(_)}_removeMarker(_){const c=this._markers.indexOf(_);c!==-1&&this._markers.splice(c,1)}_addPopup(_){this._popups.push(_)}_removePopup(_){const c=this._popups.indexOf(_);c!==-1&&this._popups.splice(c,1)}_setupPainter(){const _=s.extend({},x.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),c=this._useWebGL2&&this._canvas.getContext("webgl2",_),d=c||this._canvas.getContext("webgl",_)||this._canvas.getContext("experimental-webgl",_);d?(this._useWebGL2&&!c&&s.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),s.storeAuthState(d,!0),this.painter=new tu(d,this.transform,!!c),this.on("data",v=>{v.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),s.exported$1.testSupport(d)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(_){_.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:_}))}_contextRestored(_){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:_}))}_onMapScroll(_){if(_.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_requestDomTask(_){!this.loaded()||this.loaded()&&!this.isMoving()?_():this._domRenderTaskQueue.add(_)}_render(_){let c;const d=this.painter.context.extTimerQuery,v=s.exported.now();if(this.listens("gpu-timing-frame")&&(c=d.createQueryEXT(),d.beginQueryEXT(d.TIME_ELAPSED_EXT,c)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],s.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],s.window.performance.now())),this._renderTaskQueue.run(_),this._domRenderTaskQueue.run(_),this._removed)return;this._updateProjectionTransition();const w=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const N=this.transform.zoom,B=this.transform.pitch,H=s.exported.now(),W=new s.EvaluationParameters(N,{now:H,fadeDuration:w,pitch:B,transition:this.style.getTransition()});this.style.update(W)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let S=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),S=this._updateAverageElevation(v),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):S=this._updateAverageElevation(v),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,w,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:w,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),c){const N=s.exported.now()-v;d.endQueryEXT(d.TIME_ELAPSED_EXT,c),setTimeout(()=>{const B=d.getQueryObjectEXT(c,d.QUERY_RESULT_EXT)/1e6;d.deleteQueryEXT(c),this.fire(new s.Event("gpu-timing-frame",{cpuTime:N,gpuTime:B})),s.window.performance.mark("frame-gpu",{startTime:v,detail:{gpuTime:B}})},50)}if(this.listens("gpu-timing-layer")){const N=this.painter.collectGpuTimers();setTimeout(()=>{const B=this.painter.queryGpuTimers(N);this.fire(new s.Event("gpu-timing-layer",{layerTimes:B}))},50)}if(this.listens("gpu-timing-deferred-render")){const N=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const B=this.painter.queryGpuTimeDeferredRender(N);this.fire(new s.Event("gpu-timing-deferred-render",{gpuTime:B}))},50)}const P=this._sourcesDirty||this._styleDirty||this._placementDirty||S;if(P||this._repaint)this.triggerRepaint();else{const N=!this.isMoving()&&this.loaded();if(N&&(S=this._updateAverageElevation(v,!0)),S)this.triggerRepaint();else if(this._triggerFrame(!1),N&&(this.fire(new s.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const B=this._calculateSpeedIndex();this.fire(new s.Event("speedindexcompleted",{speedIndex:B})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||P||(this._fullyLoaded=!0,s.LivePerformanceUtils.mark(s.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&s.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(_){for(const c of this._markers)_&&!this.getRenderWorldCopies()&&(c._lngLat=c._lngLat.wrap()),c._update();for(const c of this._popups)!_||this.getRenderWorldCopies()||c._trackPointer||(c._lngLat=c._lngLat.wrap()),c._update()}_updateAverageElevation(_,c=!1){const d=v=>(this.transform.averageElevation=v,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&d(0);if((c||_-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(_)){const v=this.transform.averageElevation;let w=this.transform.sampleAverageElevation(),S=!1;this.transform.elevation&&(S=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(w)?w=0:this._averageElevationLastSampledAt=_;const P=Math.abs(v-w);if(P>1){if(this._isInitialLoad||S)return this._averageElevation.jumpTo(w),d(w);this._averageElevation.easeTo(w,_,300)}else if(P>1e-4)return this._averageElevation.jumpTo(w),d(w)}return!!this._averageElevation.isEasing(_)&&d(this._averageElevation.getValue(_))}_authenticate(){s.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,_=>{if(_&&(_.message===s.AUTH_ERR_MSG||_.status===401)){const c=this.painter.context.gl;s.storeAuthState(c,!1),this._logoControl instanceof Eg&&this._logoControl._updateLogo(),c&&c.clear(c.DEPTH_BUFFER_BIT|c.COLOR_BUFFER_BIT|c.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),s.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const _=this._isDragging();this.painter.updateTerrain(this.style,_)}_calculateSpeedIndex(){const _=this.painter.canvasCopy(),c=this.painter.getCanvasCopiesAndTimestamps();c.timeStamps.push(performance.now());const d=this.painter.context.gl,v=d.createFramebuffer();function w(S){d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,S,0);const P=new Uint8Array(d.drawingBufferWidth*d.drawingBufferHeight*4);return d.readPixels(0,0,d.drawingBufferWidth,d.drawingBufferHeight,d.RGBA,d.UNSIGNED_BYTE,P),P}return d.bindFramebuffer(d.FRAMEBUFFER,v),this._canvasPixelComparison(w(_),c.canvasCopies.map(w),c.timeStamps)}_canvasPixelComparison(_,c,d){let v=d[1]-d[0];const w=_.length/4;for(let S=0;S<c.length;S++){const P=c[S];let N=0;for(let B=0;B<P.length;B+=4)P[B]===_[B]&&P[B+1]===_[B+1]&&P[B+2]===_[B+2]&&P[B+3]===_[B+3]&&(N+=1);v+=(d[S+2]-d[S+1])*(1-N/w)}return v}remove(){this._hash&&this._hash.remove();for(const c of this._controls)c.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),s.window!==void 0&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1),s.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const _=this.painter.context.gl.getExtension("WEBGL_lose_context");_&&_.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),s.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new s.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(_){this._renderNextFrame=this._renderNextFrame||_,this.style&&!this._frame&&(this._frame=s.exported.frame(c=>{const d=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,d&&this._render(c)}))}_preloadTiles(_){const c=this.style?Object.values(this.style._sourceCaches):[];return s.asyncAll(c,(d,v)=>d._preloadTiles(_,v),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(_){this._trackResize&&this.resize({originalEvent:_})._update()}_onVisibilityChange(){s.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(_){this._showTerrainWireframe!==_&&(this._showTerrainWireframe=_,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(_){this._speedIndexTiming!==_&&(this._speedIndexTiming=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(_){this._showTileAABBs!==_&&(this._showTileAABBs=_,_&&this._update())}_setCacheLimits(_,c){s.setCacheLimits(_,c)}get version(){return s.version}},NavigationControl:class{constructor(_){this.options=s.extend({},pm,_),this._container=M("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",c=>c.preventDefault()),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",c=>{this._map&&this._map.zoomIn({},{originalEvent:c})}),M("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",c=>{this._map&&this._map.zoomOut({},{originalEvent:c})}),M("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",c=>{const d=this._map;d&&(this.options.visualizePitch?d.resetNorthPitch({},{originalEvent:c}):d.resetNorth({},{originalEvent:c}))}),this._compassIcon=M("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const _=this._map;if(!_)return;const c=_.getZoom(),d=c===_.getMaxZoom(),v=c===_.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=v,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",v.toString())}_rotateCompassArrow(){const _=this._map;if(!_)return;const c=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(_.transform.pitch*(Math.PI/180)),.5)}) rotateX(${_.transform.pitch}deg) rotateZ(${_.transform.angle*(180/Math.PI)}deg)`:`rotate(${_.transform.angle*(180/Math.PI)}deg)`;_._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=c)})}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),_.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&_.on("pitch",this._rotateCompassArrow),_.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ig(_,this._compass,this.options.visualizePitch)),this._container}onRemove(){const _=this._map;_&&(this._container.remove(),this.options.showZoom&&_.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&_.off("pitch",this._rotateCompassArrow),_.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(_,c){const d=M("button",_,this._container);return d.type="button",d.addEventListener("click",c),d}_setButtonTitle(_,c){if(!this._map)return;const d=this._map._getUIString(`NavigationControl.${c}`);_.setAttribute("aria-label",d),_.firstElementChild&&_.firstElementChild.setAttribute("title",d)}},GeolocateControl:class extends s.Evented{constructor(_){super(),this.options=s.extend({geolocation:s.window.navigator.geolocation},G_,_),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=nu(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(_){return this._map=_,this._container=M("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(_){const c=(d=!!this.options.geolocation)=>{this._supportsGeolocation=d,_(d)};this._supportsGeolocation!==void 0?_(this._supportsGeolocation):s.window.navigator.permissions!==void 0?s.window.navigator.permissions.query({name:"geolocation"}).then(d=>c(d.state!=="denied")).catch(()=>c()):c()}_isOutOfMapMaxBounds(_){const c=this._map.getMaxBounds(),d=_.coords;return!!c&&(d.longitude<c.getWest()||d.longitude>c.getEast()||d.latitude<c.getSouth()||d.latitude>c.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(_){if(this._map){if(this._isOutOfMapMaxBounds(_))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",_)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=_,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(_),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(_),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",_)),this._finish()}}_updateCamera(_){const c=new s.LngLat(_.coords.longitude,_.coords.latitude),d=_.coords.accuracy,v=this._map.getBearing(),w=s.extend({bearing:v},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(d),w,{geolocateSource:!0})}_updateMarker(_){if(_){const c=new s.LngLat(_.coords.longitude,_.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=_.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const _=this._map.transform,c=s.mercatorZfromAltitude(1,_._center.lat)*_.worldSize,d=Math.ceil(2*this._accuracy*c);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(_){if(this._map){if(this.options.trackUserLocation)if(_.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(_.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",_)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(_){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",c=>c.preventDefault()),this._geolocateButton=M("button","mapboxgl-ctrl-geolocate",this._container),M("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",_===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c)}else{const c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=M("div","mapboxgl-user-location"),this._dotElement.appendChild(M("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(M("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new dm({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=M("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new dm({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{c.geolocateSource||this._watchState!=="ACTIVE_LOCK"||c.originalEvent&&c.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.Event("trackuserlocationend")))})}}_onDeviceOrientation(_){this._userLocationDotMarker&&(_.webkitCompassHeading?this._heading=_.webkitCompassHeading:_.absolute===!0&&(this._heading=-1*_.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let _;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(_={maximumAge:6e5,timeout:0},this._noTimeout=!0):(_=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,_),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const _=()=>{s.window.addEventListener("ondeviceorientationabsolute"in s.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};s.window.DeviceMotionEvent!==void 0&&typeof s.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(c=>{c==="granted"&&_()}).catch(console.error):_()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),s.window.removeEventListener("deviceorientation",this._onDeviceOrientation),s.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:bg,ScaleControl:class{constructor(_){this.options=s.extend({},j_,_),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=mm.bind(this)),s.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const _=this.options.maxWidth||100,c=this._map,d=c._containerHeight/2,v=c._containerWidth/2-_/2,w=c.unproject([v,d]),S=c.unproject([v+_,d]),P=w.distanceTo(S);if(this.options.unit==="imperial"){const N=3.2808*P;N>5280?this._setScale(_,N/5280,"mile"):this._setScale(_,N,"foot")}else this.options.unit==="nautical"?this._setScale(_,P/1852,"nautical-mile"):P>=1e3?this._setScale(_,P/1e3,"kilometer"):this._setScale(_,P,"meter")}_setScale(_,c,d){const v=qh(c),w=v/c;this._map._requestDomTask(()=>{this._container.style.width=_*w+"px",this._container.innerHTML=d!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:d}).format(v):`${v}&nbsp;nm`})}onAdd(_){return this._map=_,this._language=_.getLanguage(),this._container=M("div","mapboxgl-ctrl mapboxgl-ctrl-scale",_.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(_){this._language=_,this._update()}setUnit(_){this.options.unit=_,this._update()}},FullscreenControl:class{constructor(_){this._fullscreen=!1,_&&_.container&&(_.container instanceof s.window.HTMLElement?this._container=_.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in s.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=M("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!s.window.document.fullscreenEnabled&&!s.window.document.webkitFullscreenEnabled)}_setupUI(){const _=this._fullscreenButton=M("button","mapboxgl-ctrl-fullscreen",this._controlContainer);M("span","mapboxgl-ctrl-icon",_).setAttribute("aria-hidden","true"),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",_)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(s.window.document.fullscreenElement||s.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.Evented{constructor(_){super(),this.options=s.extend(Object.create(iu),_),s.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(_&&_.className?_.className.trim().split(/\s+/):[])}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&_.on("preclick",this._onClose),this.options.closeOnMove&&_.on("move",this._onClose),_.on("remove",this.remove),this._update(),_._addPopup(this),this._focusFirstElement(),this._trackPointer?(_.on("mousemove",this._onMouseEvent),_.on("mouseup",this._onMouseEvent),_._canvasContainer.classList.add("mapboxgl-track-pointer")):_.on("move",this._update),this.fire(new s.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const _=this._map;return _&&(_.off("move",this._update),_.off("move",this._onClose),_.off("preclick",this._onClose),_.off("click",this._onClose),_.off("remove",this.remove),_.off("mousemove",this._onMouseEvent),_.off("mouseup",this._onMouseEvent),_.off("drag",this._onMouseEvent),_._canvasContainer&&_._canvasContainer.classList.remove("mapboxgl-track-pointer"),_._removePopup(this),this._map=void 0),this.fire(new s.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(_){this._lngLat=s.LngLat.convert(_),this._pos=null,this._trackPointer=!1,this._update();const c=this._map;return c&&(c.on("move",this._update),c.off("mousemove",this._onMouseEvent),c._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const _=this._map;return _&&(_.off("move",this._update),_.on("mousemove",this._onMouseEvent),_.on("drag",this._onMouseEvent),_._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(s.window.document.createTextNode(_))}setHTML(_){const c=s.window.document.createDocumentFragment(),d=s.window.document.createElement("body");let v;for(d.innerHTML=_;v=d.firstChild,v;)c.appendChild(v);return this.setDOMContent(c)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){let c=this._content;if(c)for(;c.hasChildNodes();)c.firstChild&&c.removeChild(c.firstChild);else c=this._content=M("div","mapboxgl-popup-content",this._container||void 0);if(c.appendChild(_),this.options.closeButton){const d=this._closeButton=M("button","mapboxgl-popup-close-button",c);d.type="button",d.setAttribute("aria-label","Close popup"),d.setAttribute("aria-hidden","true"),d.innerHTML="&#215;",d.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(_){return this._classList.add(_),this._updateClassList(),this}removeClassName(_){return this._classList.delete(_),this._updateClassList(),this}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){let c;return this._classList.delete(_)?c=!1:(this._classList.add(_),c=!0),this._updateClassList(),c}_onMouseEvent(_){this._update(_.point)}_getAnchor(_){if(this.options.anchor)return this.options.anchor;const c=this._map,d=this._container,v=this._pos;if(!c||!d||!v)return"bottom";const w=d.offsetWidth,S=d.offsetHeight,P=v.x<w/2,N=v.x>c.transform.width-w/2;if(v.y+_<S)return P?"top-left":N?"top-right":"top";if(v.y>c.transform.height-S){if(P)return"bottom-left";if(N)return"bottom-right"}return P?"left":N?"right":"bottom"}_updateClassList(){const _=this._container;if(!_)return;const c=[...this._classList];c.push("mapboxgl-popup"),this._anchor&&c.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&c.push("mapboxgl-popup-track-pointer"),_.className=c.join(" ")}_update(_){const c=this._map,d=this._content;if(!c||!this._lngLat&&!this._trackPointer||!d)return;let v=this._container;if(v||(v=this._container=M("div","mapboxgl-popup",c.getContainer()),this._tip=M("div","mapboxgl-popup-tip",v),v.appendChild(d)),this.options.maxWidth&&v.style.maxWidth!==this.options.maxWidth&&(v.style.maxWidth=this.options.maxWidth),c.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=gc(this._lngLat,this._pos,c.transform)),!this._trackPointer||_){const w=this._pos=this._trackPointer&&_?_:c.project(this._lngLat),S=wg(this.options.offset),P=this._anchor=this._getAnchor(S.y),N=wg(this.options.offset,P),B=w.add(N).round();c._requestDomTask(()=>{this._container&&P&&(this._container.style.transform=`${Ad[P]} translate(${B.x}px,${B.y}px)`)})}if(!this._marker&&c._showingGlobe()){const w=s.isLngLatBehindGlobe(c.transform,this._lngLat)?0:1;this._setOpacity(w)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(B_);_&&_.focus()}_onClose(){this.remove()}_setOpacity(_){this._container&&(this._container.style.opacity=`${_}`),this._content&&(this._content.style.pointerEvents=_?"auto":"none")}},Marker:dm,Style:us,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.pointGeometry,MercatorCoordinate:s.MercatorCoordinate,FreeCameraOptions:fc,Evented:s.Evented,config:s.config,prewarm:function(){je().acquire(vn)},clearPrewarmedResources:function(){const _=Vn;_&&(_.isPreloaded()&&_.numActive()===1?(_.release(vn),Vn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(_){s.config.ACCESS_TOKEN=_},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(_){s.config.API_URL=_},get workerCount(){return Wn.workerCount},set workerCount(_){Wn.workerCount=_},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(_){s.config.MAX_PARALLEL_IMAGE_REQUESTS=_},clearStorage(_){s.clearTileCache(_)},workerUrl:"",workerClass:null,setNow:s.exported.setNow,restoreNow:s.exported.restoreNow};return Hh});var h=r;return h})})(MP);const tC=vT;var xT={},LP={get exports(){return xT},set exports(n){xT=n}};(function(n,e){(function(t,i){n.exports=i()})(Kf,function(){var t=function(D,V){var oe={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},Ae={on:function(We,Qe,en){if(oe[We]===void 0)throw new Error("Invalid event type: "+We);oe[We].push({selector:Qe,fn:en})},render:function(We){V.store.featureChanged(We)}},Xe=function(We,Qe){for(var en=oe[We],Qt=en.length;Qt--;){var Ln=en[Qt];if(Ln.selector(Qe)){Ln.fn.call(Ae,Qe)||V.store.render(),V.ui.updateMapClasses();break}}};return D.start.call(Ae),{render:D.render,stop:function(){D.stop&&D.stop()},trash:function(){D.trash&&(D.trash(),V.store.render())},combineFeatures:function(){D.combineFeatures&&D.combineFeatures()},uncombineFeatures:function(){D.uncombineFeatures&&D.uncombineFeatures()},drag:function(We){Xe("drag",We)},click:function(We){Xe("click",We)},mousemove:function(We){Xe("mousemove",We)},mousedown:function(We){Xe("mousedown",We)},mouseup:function(We){Xe("mouseup",We)},mouseout:function(We){Xe("mouseout",We)},keydown:function(We){Xe("keydown",We)},keyup:function(We){Xe("keyup",We)},touchstart:function(We){Xe("touchstart",We)},touchmove:function(We){Xe("touchmove",We)},touchend:function(We){Xe("touchend",We)},tap:function(We){Xe("tap",We)}}};function i(D){if(D.__esModule)return D;var V=D.default;if(typeof V=="function"){var oe=function Ae(){if(this instanceof Ae){var Xe=[null];Xe.push.apply(Xe,arguments);var We=Function.bind.apply(V,Xe);return new We}return V.apply(this,arguments)};oe.prototype=V.prototype}else oe={};return Object.defineProperty(oe,"__esModule",{value:!0}),Object.keys(D).forEach(function(Ae){var Xe=Object.getOwnPropertyDescriptor(D,Ae);Object.defineProperty(oe,Ae,Xe.get?Xe:{enumerable:!0,get:function(){return D[Ae]}})}),oe}var r={},a={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:63567523142e-4},h=a;function s(D){var V=0;if(D&&D.length>0){V+=Math.abs(p(D[0]));for(var oe=1;oe<D.length;oe++)V-=Math.abs(p(D[oe]))}return V}function p(D){var V,oe,Ae,Xe,We,Qe,en=0,Qt=D.length;if(Qt>2){for(Qe=0;Qe<Qt;Qe++)Qe===Qt-2?(Ae=Qt-2,Xe=Qt-1,We=0):Qe===Qt-1?(Ae=Qt-1,Xe=0,We=1):(Ae=Qe,Xe=Qe+1,We=Qe+2),V=D[Ae],oe=D[Xe],en+=(x(D[We][0])-x(V[0]))*Math.sin(x(oe[1]));en=en*h.RADIUS*h.RADIUS/2}return en}function x(D){return D*Math.PI/180}r.geometry=function D(V){var oe,Ae=0;switch(V.type){case"Polygon":return s(V.coordinates);case"MultiPolygon":for(oe=0;oe<V.coordinates.length;oe++)Ae+=s(V.coordinates[oe]);return Ae;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(oe=0;oe<V.geometries.length;oe++)Ae+=D(V.geometries[oe]);return Ae}},r.ring=p;var I={CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},C={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},M={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},O={POLYGON:"polygon",LINE:"line_string",POINT:"point"},k={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},z={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},G={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},q={MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},Z={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},K={ACTIVE:"true",INACTIVE:"false"},te=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],ie=-85,Te=Object.freeze({__proto__:null,classes:I,sources:C,cursors:M,types:O,geojsonTypes:k,modes:z,events:G,updateActions:q,meta:Z,activeStates:K,interactions:te,LAT_MIN:-90,LAT_RENDERED_MIN:ie,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270}),le={Point:0,LineString:1,MultiLineString:1,Polygon:2};function fe(D,V){var oe=le[D.geometry.type]-le[V.geometry.type];return oe===0&&D.geometry.type===k.POLYGON?D.area-V.area:oe}function Fe(D){return D.map(function(V){return V.geometry.type===k.POLYGON&&(V.area=r.geometry({type:k.FEATURE,property:{},geometry:V.geometry})),V}).sort(fe).map(function(V){return delete V.area,V})}function Ne(D,V){return V===void 0&&(V=0),[[D.point.x-V,D.point.y-V],[D.point.x+V,D.point.y+V]]}function Ue(D){if(this._items={},this._nums={},this._length=D?D.length:0,D)for(var V=0,oe=D.length;V<oe;V++)this.add(D[V]),D[V]!==void 0&&(typeof D[V]=="string"?this._items[D[V]]=V:this._nums[D[V]]=V)}Ue.prototype.add=function(D){return this.has(D)||(this._length++,typeof D=="string"?this._items[D]=this._length:this._nums[D]=this._length),this},Ue.prototype.delete=function(D){return this.has(D)===!1||(this._length--,delete this._items[D],delete this._nums[D]),this},Ue.prototype.has=function(D){return(typeof D=="string"||typeof D=="number")&&(this._items[D]!==void 0||this._nums[D]!==void 0)},Ue.prototype.values=function(){var D=this,V=[];return Object.keys(this._items).forEach(function(oe){V.push({k:oe,v:D._items[oe]})}),Object.keys(this._nums).forEach(function(oe){V.push({k:JSON.parse(oe),v:D._nums[oe]})}),V.sort(function(oe,Ae){return oe.v-Ae.v}).map(function(oe){return oe.k})},Ue.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var dt=[Z.FEATURE,Z.MIDPOINT,Z.VERTEX],Ge={click:function(D,V,oe){return Le(D,V,oe,oe.options.clickBuffer)},touch:function(D,V,oe){return Le(D,V,oe,oe.options.touchBuffer)}};function Le(D,V,oe,Ae){if(oe.map===null)return[];var Xe=D?Ne(D,Ae):V,We={};oe.options.styles&&(We.layers=oe.options.styles.map(function(Ln){return Ln.id}));var Qe=oe.map.queryRenderedFeatures(Xe,We).filter(function(Ln){return dt.indexOf(Ln.properties.meta)!==-1}),en=new Ue,Qt=[];return Qe.forEach(function(Ln){var gn=Ln.properties.id;en.has(gn)||(en.add(gn),Qt.push(Ln))}),Fe(Qt)}function nt(D,V){var oe=Ge.click(D,null,V),Ae={mouse:M.NONE};return oe[0]&&(Ae.mouse=oe[0].properties.active===K.ACTIVE?M.MOVE:M.POINTER,Ae.feature=oe[0].properties.meta),V.events.currentModeName().indexOf("draw")!==-1&&(Ae.mouse=M.ADD),V.ui.queueMapClasses(Ae),V.ui.updateMapClasses(),oe[0]}function zt(D,V){var oe=D.x-V.x,Ae=D.y-V.y;return Math.sqrt(oe*oe+Ae*Ae)}function Ot(D,V,oe){oe===void 0&&(oe={});var Ae=oe.fineTolerance!=null?oe.fineTolerance:4,Xe=oe.grossTolerance!=null?oe.grossTolerance:12,We=oe.interval!=null?oe.interval:500;D.point=D.point||V.point,D.time=D.time||V.time;var Qe=zt(D.point,V.point);return Qe<Ae||Qe<Xe&&V.time-D.time<We}function et(D,V,oe){oe===void 0&&(oe={});var Ae=oe.tolerance!=null?oe.tolerance:25,Xe=oe.interval!=null?oe.interval:250;return D.point=D.point||V.point,D.time=D.time||V.time,zt(D.point,V.point)<Ae&&V.time-D.time<Xe}var Ze={},At={get exports(){return Ze},set exports(D){Ze=D}}.exports=function(D,V){if(V||(V=16),D===void 0&&(D=128),D<=0)return"0";for(var oe=Math.log(Math.pow(2,D))/Math.log(V),Ae=2;oe===1/0;Ae*=2)oe=Math.log(Math.pow(2,D/Ae))/Math.log(V)*Ae;var Xe=oe-Math.floor(oe),We="";for(Ae=0;Ae<Math.floor(oe);Ae++)We=Math.floor(Math.random()*V).toString(V)+We;if(Xe){var Qe=Math.pow(V,Xe);We=Math.floor(Math.random()*Qe).toString(V)+We}var en=parseInt(We,V);return en!==1/0&&en>=Math.pow(2,D)?At(D,V):We};At.rack=function(D,V,oe){var Ae=function(We){var Qe=0;do{if(Qe++>10){if(!oe)throw new Error("too many ID collisions, use more bits");D+=oe}var en=At(D,V)}while(Object.hasOwnProperty.call(Xe,en));return Xe[en]=We,en},Xe=Ae.hats={};return Ae.get=function(We){return Ae.hats[We]},Ae.set=function(We,Qe){return Ae.hats[We]=Qe,Ae},Ae.bits=D||128,Ae.base=V||16,Ae};var Kt=function(D,V){this.ctx=D,this.properties=V.properties||{},this.coordinates=V.geometry.coordinates,this.id=V.id||Ze(),this.type=V.geometry.type};Kt.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},Kt.prototype.incomingCoords=function(D){this.setCoordinates(D)},Kt.prototype.setCoordinates=function(D){this.coordinates=D,this.changed()},Kt.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},Kt.prototype.setProperty=function(D,V){this.properties[D]=V},Kt.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:k.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},Kt.prototype.internal=function(D){var V={id:this.id,meta:Z.FEATURE,"meta:type":this.type,active:K.INACTIVE,mode:D};if(this.ctx.options.userProperties)for(var oe in this.properties)V["user_"+oe]=this.properties[oe];return{type:k.FEATURE,properties:V,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var sn=function(D,V){Kt.call(this,D,V)};(sn.prototype=Object.create(Kt.prototype)).isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"},sn.prototype.updateCoordinate=function(D,V,oe){this.coordinates=arguments.length===3?[V,oe]:[D,V],this.changed()},sn.prototype.getCoordinate=function(){return this.getCoordinates()};var zn=function(D,V){Kt.call(this,D,V)};(zn.prototype=Object.create(Kt.prototype)).isValid=function(){return this.coordinates.length>1},zn.prototype.addCoordinate=function(D,V,oe){this.changed();var Ae=parseInt(D,10);this.coordinates.splice(Ae,0,[V,oe])},zn.prototype.getCoordinate=function(D){var V=parseInt(D,10);return JSON.parse(JSON.stringify(this.coordinates[V]))},zn.prototype.removeCoordinate=function(D){this.changed(),this.coordinates.splice(parseInt(D,10),1)},zn.prototype.updateCoordinate=function(D,V,oe){var Ae=parseInt(D,10);this.coordinates[Ae]=[V,oe],this.changed()};var ri=function(D,V){Kt.call(this,D,V),this.coordinates=this.coordinates.map(function(oe){return oe.slice(0,-1)})};(ri.prototype=Object.create(Kt.prototype)).isValid=function(){return this.coordinates.length!==0&&this.coordinates.every(function(D){return D.length>2})},ri.prototype.incomingCoords=function(D){this.coordinates=D.map(function(V){return V.slice(0,-1)}),this.changed()},ri.prototype.setCoordinates=function(D){this.coordinates=D,this.changed()},ri.prototype.addCoordinate=function(D,V,oe){this.changed();var Ae=D.split(".").map(function(Xe){return parseInt(Xe,10)});this.coordinates[Ae[0]].splice(Ae[1],0,[V,oe])},ri.prototype.removeCoordinate=function(D){this.changed();var V=D.split(".").map(function(Ae){return parseInt(Ae,10)}),oe=this.coordinates[V[0]];oe&&(oe.splice(V[1],1),oe.length<3&&this.coordinates.splice(V[0],1))},ri.prototype.getCoordinate=function(D){var V=D.split(".").map(function(Ae){return parseInt(Ae,10)}),oe=this.coordinates[V[0]];return JSON.parse(JSON.stringify(oe[V[1]]))},ri.prototype.getCoordinates=function(){return this.coordinates.map(function(D){return D.concat([D[0]])})},ri.prototype.updateCoordinate=function(D,V,oe){this.changed();var Ae=D.split("."),Xe=parseInt(Ae[0],10),We=parseInt(Ae[1],10);this.coordinates[Xe]===void 0&&(this.coordinates[Xe]=[]),this.coordinates[Xe][We]=[V,oe]};var Yt={MultiPoint:sn,MultiLineString:zn,MultiPolygon:ri},ii=function(D,V,oe,Ae,Xe){var We=oe.split("."),Qe=parseInt(We[0],10),en=We[1]?We.slice(1).join("."):null;return D[Qe][V](en,Ae,Xe)},kn=function(D,V){if(Kt.call(this,D,V),delete this.coordinates,this.model=Yt[V.geometry.type],this.model===void 0)throw new TypeError(V.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(V.geometry.coordinates)};function on(D){this.map=D.map,this.drawConfig=JSON.parse(JSON.stringify(D.options||{})),this._ctx=D}(kn.prototype=Object.create(Kt.prototype))._coordinatesToFeatures=function(D){var V=this,oe=this.model.bind(this);return D.map(function(Ae){return new oe(V.ctx,{id:Ze(),type:k.FEATURE,properties:{},geometry:{coordinates:Ae,type:V.type.replace("Multi","")}})})},kn.prototype.isValid=function(){return this.features.every(function(D){return D.isValid()})},kn.prototype.setCoordinates=function(D){this.features=this._coordinatesToFeatures(D),this.changed()},kn.prototype.getCoordinate=function(D){return ii(this.features,"getCoordinate",D)},kn.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(function(D){return D.type===k.POLYGON?D.getCoordinates():D.coordinates})))},kn.prototype.updateCoordinate=function(D,V,oe){ii(this.features,"updateCoordinate",D,V,oe),this.changed()},kn.prototype.addCoordinate=function(D,V,oe){ii(this.features,"addCoordinate",D,V,oe),this.changed()},kn.prototype.removeCoordinate=function(D){ii(this.features,"removeCoordinate",D),this.changed()},kn.prototype.getFeatures=function(){return this.features},on.prototype.setSelected=function(D){return this._ctx.store.setSelected(D)},on.prototype.setSelectedCoordinates=function(D){var V=this;this._ctx.store.setSelectedCoordinates(D),D.reduce(function(oe,Ae){return oe[Ae.feature_id]===void 0&&(oe[Ae.feature_id]=!0,V._ctx.store.get(Ae.feature_id).changed()),oe},{})},on.prototype.getSelected=function(){return this._ctx.store.getSelected()},on.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},on.prototype.isSelected=function(D){return this._ctx.store.isSelected(D)},on.prototype.getFeature=function(D){return this._ctx.store.get(D)},on.prototype.select=function(D){return this._ctx.store.select(D)},on.prototype.deselect=function(D){return this._ctx.store.deselect(D)},on.prototype.deleteFeature=function(D,V){return V===void 0&&(V={}),this._ctx.store.delete(D,V)},on.prototype.addFeature=function(D){return this._ctx.store.add(D)},on.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},on.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},on.prototype.setActionableState=function(D){D===void 0&&(D={});var V={trash:D.trash||!1,combineFeatures:D.combineFeatures||!1,uncombineFeatures:D.uncombineFeatures||!1};return this._ctx.events.actionable(V)},on.prototype.changeMode=function(D,V,oe){return V===void 0&&(V={}),oe===void 0&&(oe={}),this._ctx.events.changeMode(D,V,oe)},on.prototype.updateUIClasses=function(D){return this._ctx.ui.queueMapClasses(D)},on.prototype.activateUIButton=function(D){return this._ctx.ui.setActiveButton(D)},on.prototype.featuresAt=function(D,V,oe){if(oe===void 0&&(oe="click"),oe!=="click"&&oe!=="touch")throw new Error("invalid buffer type");return Ge[oe](D,V,this._ctx)},on.prototype.newFeature=function(D){var V=D.geometry.type;return V===k.POINT?new sn(this._ctx,D):V===k.LINE_STRING?new zn(this._ctx,D):V===k.POLYGON?new ri(this._ctx,D):new kn(this._ctx,D)},on.prototype.isInstanceOf=function(D,V){if(D===k.POINT)return V instanceof sn;if(D===k.LINE_STRING)return V instanceof zn;if(D===k.POLYGON)return V instanceof ri;if(D==="MultiFeature")return V instanceof kn;throw new Error("Unknown feature class: "+D)},on.prototype.doRender=function(D){return this._ctx.store.featureChanged(D)},on.prototype.onSetup=function(){},on.prototype.onDrag=function(){},on.prototype.onClick=function(){},on.prototype.onMouseMove=function(){},on.prototype.onMouseDown=function(){},on.prototype.onMouseUp=function(){},on.prototype.onMouseOut=function(){},on.prototype.onKeyUp=function(){},on.prototype.onKeyDown=function(){},on.prototype.onTouchStart=function(){},on.prototype.onTouchMove=function(){},on.prototype.onTouchEnd=function(){},on.prototype.onTap=function(){},on.prototype.onStop=function(){},on.prototype.onTrash=function(){},on.prototype.onCombineFeature=function(){},on.prototype.onUncombineFeature=function(){},on.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var Di={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},Ut=Object.keys(Di);function Nt(D){var V=Object.keys(D);return function(oe,Ae){Ae===void 0&&(Ae={});var Xe={},We=V.reduce(function(Qe,en){return Qe[en]=D[en],Qe},new on(oe));return{start:function(){var Qe=this;Xe=We.onSetup(Ae),Ut.forEach(function(en){var Qt,Ln=Di[en],gn=function(){return!1};D[Ln]&&(gn=function(){return!0}),Qe.on(en,gn,(Qt=Ln,function(bn){return We[Qt](Xe,bn)}))})},stop:function(){We.onStop(Xe)},trash:function(){We.onTrash(Xe)},combineFeatures:function(){We.onCombineFeatures(Xe)},uncombineFeatures:function(){We.onUncombineFeatures(Xe)},render:function(Qe,en){We.toDisplayFeatures(Xe,Qe,en)}}}}function Gn(D){return[].concat(D).filter(function(V){return V!==void 0})}function Ci(){var D=this;if(!(D.ctx.map&&D.ctx.map.getSource(C.HOT)!==void 0))return Qt();var V=D.ctx.events.currentModeName();D.ctx.ui.queueMapClasses({mode:V});var oe=[],Ae=[];D.isDirty?Ae=D.getAllIds():(oe=D.getChangedIds().filter(function(Ln){return D.get(Ln)!==void 0}),Ae=D.sources.hot.filter(function(Ln){return Ln.properties.id&&oe.indexOf(Ln.properties.id)===-1&&D.get(Ln.properties.id)!==void 0}).map(function(Ln){return Ln.properties.id})),D.sources.hot=[];var Xe=D.sources.cold.length;D.sources.cold=D.isDirty?[]:D.sources.cold.filter(function(Ln){var gn=Ln.properties.id||Ln.properties.parent;return oe.indexOf(gn)===-1});var We=Xe!==D.sources.cold.length||Ae.length>0;function Qe(Ln,gn){var bn=D.get(Ln).internal(V);D.ctx.events.currentModeRender(bn,function(xi){D.sources[gn].push(xi)})}if(oe.forEach(function(Ln){return Qe(Ln,"hot")}),Ae.forEach(function(Ln){return Qe(Ln,"cold")}),We&&D.ctx.map.getSource(C.COLD).setData({type:k.FEATURE_COLLECTION,features:D.sources.cold}),D.ctx.map.getSource(C.HOT).setData({type:k.FEATURE_COLLECTION,features:D.sources.hot}),D._emitSelectionChange&&(D.ctx.map.fire(G.SELECTION_CHANGE,{features:D.getSelected().map(function(Ln){return Ln.toGeoJSON()}),points:D.getSelectedCoordinates().map(function(Ln){return{type:k.FEATURE,properties:{},geometry:{type:k.POINT,coordinates:Ln.coordinates}}})}),D._emitSelectionChange=!1),D._deletedFeaturesToEmit.length){var en=D._deletedFeaturesToEmit.map(function(Ln){return Ln.toGeoJSON()});D._deletedFeaturesToEmit=[],D.ctx.map.fire(G.DELETE,{features:en})}function Qt(){D.isDirty=!1,D.clearChangedIds()}Qt(),D.ctx.map.fire(G.RENDER,{})}function ln(D){var V,oe=this;this._features={},this._featureIds=new Ue,this._selectedFeatureIds=new Ue,this._selectedCoordinates=[],this._changedFeatureIds=new Ue,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=D,this.sources={hot:[],cold:[]},this.render=function(){V||(V=requestAnimationFrame(function(){V=null,Ci.call(oe)}))},this.isDirty=!1}function Mt(D,V){var oe=D._selectedCoordinates.filter(function(Ae){return D._selectedFeatureIds.has(Ae.feature_id)});D._selectedCoordinates.length===oe.length||V.silent||(D._emitSelectionChange=!0),D._selectedCoordinates=oe}ln.prototype.createRenderBatch=function(){var D=this,V=this.render,oe=0;return this.render=function(){oe++},function(){D.render=V,oe>0&&D.render()}},ln.prototype.setDirty=function(){return this.isDirty=!0,this},ln.prototype.featureChanged=function(D){return this._changedFeatureIds.add(D),this},ln.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},ln.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},ln.prototype.getAllIds=function(){return this._featureIds.values()},ln.prototype.add=function(D){return this.featureChanged(D.id),this._features[D.id]=D,this._featureIds.add(D.id),this},ln.prototype.delete=function(D,V){var oe=this;return V===void 0&&(V={}),Gn(D).forEach(function(Ae){oe._featureIds.has(Ae)&&(oe._featureIds.delete(Ae),oe._selectedFeatureIds.delete(Ae),V.silent||oe._deletedFeaturesToEmit.indexOf(oe._features[Ae])===-1&&oe._deletedFeaturesToEmit.push(oe._features[Ae]),delete oe._features[Ae],oe.isDirty=!0)}),Mt(this,V),this},ln.prototype.get=function(D){return this._features[D]},ln.prototype.getAll=function(){var D=this;return Object.keys(this._features).map(function(V){return D._features[V]})},ln.prototype.select=function(D,V){var oe=this;return V===void 0&&(V={}),Gn(D).forEach(function(Ae){oe._selectedFeatureIds.has(Ae)||(oe._selectedFeatureIds.add(Ae),oe._changedFeatureIds.add(Ae),V.silent||(oe._emitSelectionChange=!0))}),this},ln.prototype.deselect=function(D,V){var oe=this;return V===void 0&&(V={}),Gn(D).forEach(function(Ae){oe._selectedFeatureIds.has(Ae)&&(oe._selectedFeatureIds.delete(Ae),oe._changedFeatureIds.add(Ae),V.silent||(oe._emitSelectionChange=!0))}),Mt(this,V),this},ln.prototype.clearSelected=function(D){return D===void 0&&(D={}),this.deselect(this._selectedFeatureIds.values(),{silent:D.silent}),this},ln.prototype.setSelected=function(D,V){var oe=this;return V===void 0&&(V={}),D=Gn(D),this.deselect(this._selectedFeatureIds.values().filter(function(Ae){return D.indexOf(Ae)===-1}),{silent:V.silent}),this.select(D.filter(function(Ae){return!oe._selectedFeatureIds.has(Ae)}),{silent:V.silent}),this},ln.prototype.setSelectedCoordinates=function(D){return this._selectedCoordinates=D,this._emitSelectionChange=!0,this},ln.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},ln.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},ln.prototype.getSelected=function(){var D=this;return this._selectedFeatureIds.values().map(function(V){return D.get(V)})},ln.prototype.getSelectedCoordinates=function(){var D=this;return this._selectedCoordinates.map(function(V){return{coordinates:D.get(V.feature_id).getCoordinate(V.coord_path)}})},ln.prototype.isSelected=function(D){return this._selectedFeatureIds.has(D)},ln.prototype.setFeatureProperty=function(D,V,oe){this.get(D).setProperty(V,oe),this.featureChanged(D)},ln.prototype.storeMapConfig=function(){var D=this;te.forEach(function(V){D.ctx.map[V]&&(D._mapInitialConfig[V]=D.ctx.map[V].isEnabled())})},ln.prototype.restoreMapConfig=function(){var D=this;Object.keys(this._mapInitialConfig).forEach(function(V){D._mapInitialConfig[V]?D.ctx.map[V].enable():D.ctx.map[V].disable()})},ln.prototype.getInitialConfigValue=function(D){return this._mapInitialConfig[D]===void 0||this._mapInitialConfig[D]};var Un=function(){for(var D=arguments,V={},oe=0;oe<arguments.length;oe++){var Ae=D[oe];for(var Xe in Ae)ti.call(Ae,Xe)&&(V[Xe]=Ae[Xe])}return V},ti=Object.prototype.hasOwnProperty,jr=["mode","feature","mouse"];function Yr(D){var V=null,oe=null,Ae={onRemove:function(){return D.map.off("load",Ae.connect),clearInterval(oe),Ae.removeLayers(),D.store.restoreMapConfig(),D.ui.removeButtons(),D.events.removeEventListeners(),D.ui.clearMapClasses(),D.map=null,D.container=null,D.store=null,V&&V.parentNode&&V.parentNode.removeChild(V),V=null,this},connect:function(){D.map.off("load",Ae.connect),clearInterval(oe),Ae.addLayers(),D.store.storeMapConfig(),D.events.addEventListeners()},onAdd:function(Xe){var We=Xe.fire;return Xe.fire=function(Qe,en){var Qt=arguments;return We.length===1&&arguments.length!==1&&(Qt=[Un({},{type:Qe},en)]),We.apply(Xe,Qt)},D.map=Xe,D.events=function(Qe){var en=Object.keys(Qe.options.modes).reduce(function(jt,On){return jt[On]=Nt(Qe.options.modes[On]),jt},{}),Qt={},Ln={},gn={},bn=null,xi=null;gn.drag=function(jt,On){On({point:jt.point,time:new Date().getTime()})?(Qe.ui.queueMapClasses({mouse:M.DRAG}),xi.drag(jt)):jt.originalEvent.stopPropagation()},gn.mousedrag=function(jt){gn.drag(jt,function(On){return!Ot(Qt,On)})},gn.touchdrag=function(jt){gn.drag(jt,function(On){return!et(Ln,On)})},gn.mousemove=function(jt){if((jt.originalEvent.buttons!==void 0?jt.originalEvent.buttons:jt.originalEvent.which)===1)return gn.mousedrag(jt);var On=nt(jt,Qe);jt.featureTarget=On,xi.mousemove(jt)},gn.mousedown=function(jt){Qt={time:new Date().getTime(),point:jt.point};var On=nt(jt,Qe);jt.featureTarget=On,xi.mousedown(jt)},gn.mouseup=function(jt){var On=nt(jt,Qe);jt.featureTarget=On,Ot(Qt,{point:jt.point,time:new Date().getTime()})?xi.click(jt):xi.mouseup(jt)},gn.mouseout=function(jt){xi.mouseout(jt)},gn.touchstart=function(jt){if(jt.originalEvent.preventDefault(),Qe.options.touchEnabled){Ln={time:new Date().getTime(),point:jt.point};var On=Ge.touch(jt,null,Qe)[0];jt.featureTarget=On,xi.touchstart(jt)}},gn.touchmove=function(jt){if(jt.originalEvent.preventDefault(),Qe.options.touchEnabled)return xi.touchmove(jt),gn.touchdrag(jt)},gn.touchend=function(jt){if(jt.originalEvent.preventDefault(),Qe.options.touchEnabled){var On=Ge.touch(jt,null,Qe)[0];jt.featureTarget=On,et(Ln,{time:new Date().getTime(),point:jt.point})?xi.tap(jt):xi.touchend(jt)}};var ls=function(jt){return!(jt===8||jt===46||jt>=48&&jt<=57)};function wi(jt,On,Ai){Ai===void 0&&(Ai={}),xi.stop();var Ys=en[jt];if(Ys===void 0)throw new Error(jt+" is not valid");bn=jt;var Ss=Ys(Qe,On);xi=t(Ss,Qe),Ai.silent||Qe.map.fire(G.MODE_CHANGE,{mode:jt}),Qe.store.setDirty(),Qe.store.render()}gn.keydown=function(jt){(jt.srcElement||jt.target).classList[0]==="mapboxgl-canvas"&&(jt.keyCode!==8&&jt.keyCode!==46||!Qe.options.controls.trash?ls(jt.keyCode)?xi.keydown(jt):jt.keyCode===49&&Qe.options.controls.point?wi(z.DRAW_POINT):jt.keyCode===50&&Qe.options.controls.line_string?wi(z.DRAW_LINE_STRING):jt.keyCode===51&&Qe.options.controls.polygon&&wi(z.DRAW_POLYGON):(jt.preventDefault(),xi.trash()))},gn.keyup=function(jt){ls(jt.keyCode)&&xi.keyup(jt)},gn.zoomend=function(){Qe.store.changeZoom()},gn.data=function(jt){if(jt.dataType==="style"){var On=Qe.setup,Ai=Qe.map,Ys=Qe.options,Ss=Qe.store;Ys.styles.some(function(Go){return Ai.getLayer(Go.id)})||(On.addLayers(),Ss.setDirty(),Ss.render())}};var ms={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){bn=Qe.options.defaultMode,xi=t(en[bn](Qe),Qe)},changeMode:wi,actionable:function(jt){var On=!1;Object.keys(jt).forEach(function(Ai){if(ms[Ai]===void 0)throw new Error("Invalid action type");ms[Ai]!==jt[Ai]&&(On=!0),ms[Ai]=jt[Ai]}),On&&Qe.map.fire(G.ACTIONABLE,{actions:ms})},currentModeName:function(){return bn},currentModeRender:function(jt,On){return xi.render(jt,On)},fire:function(jt,On){gn[jt]&&gn[jt](On)},addEventListeners:function(){Qe.map.on("mousemove",gn.mousemove),Qe.map.on("mousedown",gn.mousedown),Qe.map.on("mouseup",gn.mouseup),Qe.map.on("data",gn.data),Qe.map.on("touchmove",gn.touchmove),Qe.map.on("touchstart",gn.touchstart),Qe.map.on("touchend",gn.touchend),Qe.container.addEventListener("mouseout",gn.mouseout),Qe.options.keybindings&&(Qe.container.addEventListener("keydown",gn.keydown),Qe.container.addEventListener("keyup",gn.keyup))},removeEventListeners:function(){Qe.map.off("mousemove",gn.mousemove),Qe.map.off("mousedown",gn.mousedown),Qe.map.off("mouseup",gn.mouseup),Qe.map.off("data",gn.data),Qe.map.off("touchmove",gn.touchmove),Qe.map.off("touchstart",gn.touchstart),Qe.map.off("touchend",gn.touchend),Qe.container.removeEventListener("mouseout",gn.mouseout),Qe.options.keybindings&&(Qe.container.removeEventListener("keydown",gn.keydown),Qe.container.removeEventListener("keyup",gn.keyup))},trash:function(jt){xi.trash(jt)},combineFeatures:function(){xi.combineFeatures()},uncombineFeatures:function(){xi.uncombineFeatures()},getMode:function(){return bn}}}(D),D.ui=function(Qe){var en={},Qt=null,Ln={mode:null,feature:null,mouse:null},gn={mode:null,feature:null,mouse:null};function bn(jt){gn=Un(gn,jt)}function xi(){var jt,On;if(Qe.container){var Ai=[],Ys=[];jr.forEach(function(Ss){gn[Ss]!==Ln[Ss]&&(Ai.push(Ss+"-"+Ln[Ss]),gn[Ss]!==null&&Ys.push(Ss+"-"+gn[Ss]))}),Ai.length>0&&(jt=Qe.container.classList).remove.apply(jt,Ai),Ys.length>0&&(On=Qe.container.classList).add.apply(On,Ys),Ln=Un(Ln,gn)}}function ls(jt,On){On===void 0&&(On={});var Ai=document.createElement("button");return Ai.className=I.CONTROL_BUTTON+" "+On.className,Ai.setAttribute("title",On.title),On.container.appendChild(Ai),Ai.addEventListener("click",function(Ys){if(Ys.preventDefault(),Ys.stopPropagation(),Ys.target===Qt)return wi(),void On.onDeactivate();ms(jt),On.onActivate()},!0),Ai}function wi(){Qt&&(Qt.classList.remove(I.ACTIVE_BUTTON),Qt=null)}function ms(jt){wi();var On=en[jt];On&&On&&jt!=="trash"&&(On.classList.add(I.ACTIVE_BUTTON),Qt=On)}return{setActiveButton:ms,queueMapClasses:bn,updateMapClasses:xi,clearMapClasses:function(){bn({mode:null,feature:null,mouse:null}),xi()},addButtons:function(){var jt=Qe.options.controls,On=document.createElement("div");return On.className=I.CONTROL_GROUP+" "+I.CONTROL_BASE,jt&&(jt[O.LINE]&&(en[O.LINE]=ls(O.LINE,{container:On,className:I.CONTROL_BUTTON_LINE,title:"LineString tool "+(Qe.options.keybindings?"(l)":""),onActivate:function(){return Qe.events.changeMode(z.DRAW_LINE_STRING)},onDeactivate:function(){return Qe.events.trash()}})),jt[O.POLYGON]&&(en[O.POLYGON]=ls(O.POLYGON,{container:On,className:I.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(Qe.options.keybindings?"(p)":""),onActivate:function(){return Qe.events.changeMode(z.DRAW_POLYGON)},onDeactivate:function(){return Qe.events.trash()}})),jt[O.POINT]&&(en[O.POINT]=ls(O.POINT,{container:On,className:I.CONTROL_BUTTON_POINT,title:"Marker tool "+(Qe.options.keybindings?"(m)":""),onActivate:function(){return Qe.events.changeMode(z.DRAW_POINT)},onDeactivate:function(){return Qe.events.trash()}})),jt.trash&&(en.trash=ls("trash",{container:On,className:I.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:function(){Qe.events.trash()}})),jt.combine_features&&(en.combine_features=ls("combineFeatures",{container:On,className:I.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:function(){Qe.events.combineFeatures()}})),jt.uncombine_features&&(en.uncombine_features=ls("uncombineFeatures",{container:On,className:I.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:function(){Qe.events.uncombineFeatures()}}))),On},removeButtons:function(){Object.keys(en).forEach(function(jt){var On=en[jt];On.parentNode&&On.parentNode.removeChild(On),delete en[jt]})}}}(D),D.container=Xe.getContainer(),D.store=new ln(D),V=D.ui.addButtons(),D.options.boxSelect&&(Xe.boxZoom.disable(),Xe.dragPan.disable(),Xe.dragPan.enable()),Xe.loaded()?Ae.connect():(Xe.on("load",Ae.connect),oe=setInterval(function(){Xe.loaded()&&Ae.connect()},16)),D.events.start(),V},addLayers:function(){D.map.addSource(C.COLD,{data:{type:k.FEATURE_COLLECTION,features:[]},type:"geojson"}),D.map.addSource(C.HOT,{data:{type:k.FEATURE_COLLECTION,features:[]},type:"geojson"}),D.options.styles.forEach(function(Xe){D.map.addLayer(Xe)}),D.store.setDirty(!0),D.store.render()},removeLayers:function(){D.options.styles.forEach(function(Xe){D.map.getLayer(Xe.id)&&D.map.removeLayer(Xe.id)}),D.map.getSource(C.COLD)&&D.map.removeSource(C.COLD),D.map.getSource(C.HOT)&&D.map.removeSource(C.HOT)}};return D.setup=Ae,Ae}var hi=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];function Hi(D){return function(V){var oe=V.featureTarget;return!!oe&&!!oe.properties&&oe.properties.meta===D}}function or(D){return!!D.originalEvent&&!!D.originalEvent.shiftKey&&D.originalEvent.button===0}function $e(D){return!!D.featureTarget&&!!D.featureTarget.properties&&D.featureTarget.properties.active===K.ACTIVE&&D.featureTarget.properties.meta===Z.FEATURE}function Tn(D){return!!D.featureTarget&&!!D.featureTarget.properties&&D.featureTarget.properties.active===K.INACTIVE&&D.featureTarget.properties.meta===Z.FEATURE}function fi(D){return D.featureTarget===void 0}function Kn(D){return!!D.featureTarget&&!!D.featureTarget.properties&&D.featureTarget.properties.meta===Z.FEATURE}function pn(D){var V=D.featureTarget;return!!V&&!!V.properties&&V.properties.meta===Z.VERTEX}function vi(D){return!!D.originalEvent&&D.originalEvent.shiftKey===!0}function Rs(D){return D.keyCode===27}function kt(D){return D.keyCode===13}var mn=Object.freeze({__proto__:null,isOfMetaType:Hi,isShiftMousedown:or,isActiveFeature:$e,isInactiveFeature:Tn,noTarget:fi,isFeature:Kn,isVertex:pn,isShiftDown:vi,isEscapeKey:Rs,isEnterKey:kt,isTrue:function(){return!0}}),jn=ki;function ki(D,V){this.x=D,this.y=V}function Ds(D,V){var oe=V.getBoundingClientRect();return new jn(D.clientX-oe.left-(V.clientLeft||0),D.clientY-oe.top-(V.clientTop||0))}function io(D,V,oe,Ae){return{type:k.FEATURE,properties:{meta:Z.VERTEX,parent:D,coord_path:oe,active:Ae?K.ACTIVE:K.INACTIVE},geometry:{type:k.POINT,coordinates:V}}}function oa(D,V,oe){var Ae=V.geometry.coordinates,Xe=oe.geometry.coordinates;if(Ae[1]>85||Ae[1]<ie||Xe[1]>85||Xe[1]<ie)return null;var We={lng:(Ae[0]+Xe[0])/2,lat:(Ae[1]+Xe[1])/2};return{type:k.FEATURE,properties:{meta:Z.MIDPOINT,parent:D,lng:We.lng,lat:We.lat,coord_path:oe.properties.coord_path},geometry:{type:k.POINT,coordinates:[We.lng,We.lat]}}}function Vo(D,V,oe){V===void 0&&(V={}),oe===void 0&&(oe=null);var Ae,Xe=D.geometry,We=Xe.type,Qe=Xe.coordinates,en=D.properties&&D.properties.id,Qt=[];function Ln(bn,xi){var ls="",wi=null;bn.forEach(function(ms,jt){var On=xi!=null?xi+"."+jt:String(jt),Ai=io(en,ms,On,gn(On));if(V.midpoints&&wi){var Ys=oa(en,wi,Ai);Ys&&Qt.push(Ys)}wi=Ai;var Ss=JSON.stringify(ms);ls!==Ss&&Qt.push(Ai),jt===0&&(ls=Ss)})}function gn(bn){return!!V.selectedPaths&&V.selectedPaths.indexOf(bn)!==-1}return We===k.POINT?Qt.push(io(en,Qe,oe,gn(oe))):We===k.POLYGON?Qe.forEach(function(bn,xi){Ln(bn,oe!==null?oe+"."+xi:String(xi))}):We===k.LINE_STRING?Ln(Qe,oe):We.indexOf(k.MULTI_PREFIX)===0&&(Ae=We.replace(k.MULTI_PREFIX,""),Qe.forEach(function(bn,xi){var ls={type:k.FEATURE,properties:D.properties,geometry:{type:Ae,coordinates:bn}};Qt=Qt.concat(Vo(ls,V,xi))})),Qt}ki.prototype={clone:function(){return new ki(this.x,this.y)},add:function(D){return this.clone()._add(D)},sub:function(D){return this.clone()._sub(D)},multByPoint:function(D){return this.clone()._multByPoint(D)},divByPoint:function(D){return this.clone()._divByPoint(D)},mult:function(D){return this.clone()._mult(D)},div:function(D){return this.clone()._div(D)},rotate:function(D){return this.clone()._rotate(D)},rotateAround:function(D,V){return this.clone()._rotateAround(D,V)},matMult:function(D){return this.clone()._matMult(D)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(D){return this.x===D.x&&this.y===D.y},dist:function(D){return Math.sqrt(this.distSqr(D))},distSqr:function(D){var V=D.x-this.x,oe=D.y-this.y;return V*V+oe*oe},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(D){return Math.atan2(this.y-D.y,this.x-D.x)},angleWith:function(D){return this.angleWithSep(D.x,D.y)},angleWithSep:function(D,V){return Math.atan2(this.x*V-this.y*D,this.x*D+this.y*V)},_matMult:function(D){var V=D[0]*this.x+D[1]*this.y,oe=D[2]*this.x+D[3]*this.y;return this.x=V,this.y=oe,this},_add:function(D){return this.x+=D.x,this.y+=D.y,this},_sub:function(D){return this.x-=D.x,this.y-=D.y,this},_mult:function(D){return this.x*=D,this.y*=D,this},_div:function(D){return this.x/=D,this.y/=D,this},_multByPoint:function(D){return this.x*=D.x,this.y*=D.y,this},_divByPoint:function(D){return this.x/=D.x,this.y/=D.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var D=this.y;return this.y=this.x,this.x=-D,this},_rotate:function(D){var V=Math.cos(D),oe=Math.sin(D),Ae=V*this.x-oe*this.y,Xe=oe*this.x+V*this.y;return this.x=Ae,this.y=Xe,this},_rotateAround:function(D,V){var oe=Math.cos(D),Ae=Math.sin(D),Xe=V.x+oe*(this.x-V.x)-Ae*(this.y-V.y),We=V.y+Ae*(this.x-V.x)+oe*(this.y-V.y);return this.x=Xe,this.y=We,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ki.convert=function(D){return D instanceof ki?D:Array.isArray(D)?new ki(D[0],D[1]):D};var Os={enable:function(D){setTimeout(function(){D.map&&D.map.doubleClickZoom&&D._ctx&&D._ctx.store&&D._ctx.store.getInitialConfigValue&&D._ctx.store.getInitialConfigValue("doubleClickZoom")&&D.map.doubleClickZoom.enable()},0)},disable:function(D){setTimeout(function(){D.map&&D.map.doubleClickZoom&&D.map.doubleClickZoom.disable()},0)}},Mo={},qa={get exports(){return Mo},set exports(D){Mo=D}},ro=function(D){if(!D||!D.type)return null;var V=Ia[D.type];if(!V)return null;if(V==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:D}]};if(V==="feature")return{type:"FeatureCollection",features:[D]};if(V==="featurecollection")return D},Ia={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"},Rl=Object.freeze({__proto__:null,default:function D(V){switch(V&&V.type||null){case"FeatureCollection":return V.features=V.features.reduce(function(oe,Ae){return oe.concat(D(Ae))},[]),V;case"Feature":return V.geometry?D(V.geometry).map(function(oe){var Ae={type:"Feature",properties:JSON.parse(JSON.stringify(V.properties)),geometry:oe};return V.id!==void 0&&(Ae.id=V.id),Ae}):[V];case"MultiPoint":return V.coordinates.map(function(oe){return{type:"Point",coordinates:oe}});case"MultiPolygon":return V.coordinates.map(function(oe){return{type:"Polygon",coordinates:oe}});case"MultiLineString":return V.coordinates.map(function(oe){return{type:"LineString",coordinates:oe}});case"GeometryCollection":return V.geometries.map(D).reduce(function(oe,Ae){return oe.concat(Ae)},[]);case"Point":case"Polygon":case"LineString":return[V]}}}),Ha=ro,aa=i(Rl),Wa=function(D){return function V(oe){return Array.isArray(oe)&&oe.length&&typeof oe[0]=="number"?[oe]:oe.reduce(function(Ae,Xe){return Array.isArray(Xe)&&Array.isArray(Xe[0])?Ae.concat(V(Xe)):(Ae.push(Xe),Ae)},[])}(D)};aa instanceof Function||(aa=aa.default);var Bs={},Ta={get exports(){return Bs},set exports(D){Bs=D}}.exports=function(D){return new Zs(D)};function Zs(D){this.value=D}function Sa(D,V,oe){var Ae=[],Xe=[],We=!0;return function Qe(en){var Qt=oe?xe(en):en,Ln={},gn=!0,bn={node:Qt,node_:en,path:[].concat(Ae),parent:Xe[Xe.length-1],parents:Xe,key:Ae.slice(-1)[0],isRoot:Ae.length===0,level:Ae.length,circular:null,update:function(wi,ms){bn.isRoot||(bn.parent.node[bn.key]=wi),bn.node=wi,ms&&(gn=!1)},delete:function(wi){delete bn.parent.node[bn.key],wi&&(gn=!1)},remove:function(wi){ve(bn.parent.node)?bn.parent.node.splice(bn.key,1):delete bn.parent.node[bn.key],wi&&(gn=!1)},keys:null,before:function(wi){Ln.before=wi},after:function(wi){Ln.after=wi},pre:function(wi){Ln.pre=wi},post:function(wi){Ln.post=wi},stop:function(){We=!1},block:function(){gn=!1}};if(!We)return bn;function xi(){if(typeof bn.node=="object"&&bn.node!==null){bn.keys&&bn.node_===bn.node||(bn.keys=Q(bn.node)),bn.isLeaf=bn.keys.length==0;for(var wi=0;wi<Xe.length;wi++)if(Xe[wi].node_===en){bn.circular=Xe[wi];break}}else bn.isLeaf=!0,bn.keys=null;bn.notLeaf=!bn.isLeaf,bn.notRoot=!bn.isRoot}xi();var ls=V.call(bn,bn.node);return ls!==void 0&&bn.update&&bn.update(ls),Ln.before&&Ln.before.call(bn,bn.node),gn&&(typeof bn.node!="object"||bn.node===null||bn.circular||(Xe.push(bn),xi(),Ce(bn.keys,function(wi,ms){Ae.push(wi),Ln.pre&&Ln.pre.call(bn,bn.node[wi],wi);var jt=Qe(bn.node[wi]);oe&&Be.call(bn.node,wi)&&(bn.node[wi]=jt.node),jt.isLast=ms==bn.keys.length-1,jt.isFirst=ms==0,Ln.post&&Ln.post.call(bn,jt),Ae.pop()}),Xe.pop()),Ln.after&&Ln.after.call(bn,bn.node)),bn}(D).node}function xe(D){if(typeof D=="object"&&D!==null){var V;if(ve(D))V=[];else if(ne(D)==="[object Date]")V=new Date(D.getTime?D.getTime():D);else if(function(Xe){return ne(Xe)==="[object RegExp]"}(D))V=new RegExp(D);else if(function(Xe){return ne(Xe)==="[object Error]"}(D))V={message:D.message};else if(function(Xe){return ne(Xe)==="[object Boolean]"}(D))V=new Boolean(D);else if(function(Xe){return ne(Xe)==="[object Number]"}(D))V=new Number(D);else if(function(Xe){return ne(Xe)==="[object String]"}(D))V=new String(D);else if(Object.create&&Object.getPrototypeOf)V=Object.create(Object.getPrototypeOf(D));else if(D.constructor===Object)V={};else{var oe=D.constructor&&D.constructor.prototype||D.__proto__||{},Ae=function(){};Ae.prototype=oe,V=new Ae}return Ce(Q(D),function(Xe){V[Xe]=D[Xe]}),V}return D}Zs.prototype.get=function(D){for(var V=this.value,oe=0;oe<D.length;oe++){var Ae=D[oe];if(!V||!Be.call(V,Ae)){V=void 0;break}V=V[Ae]}return V},Zs.prototype.has=function(D){for(var V=this.value,oe=0;oe<D.length;oe++){var Ae=D[oe];if(!V||!Be.call(V,Ae))return!1;V=V[Ae]}return!0},Zs.prototype.set=function(D,V){for(var oe=this.value,Ae=0;Ae<D.length-1;Ae++){var Xe=D[Ae];Be.call(oe,Xe)||(oe[Xe]={}),oe=oe[Xe]}return oe[D[Ae]]=V,V},Zs.prototype.map=function(D){return Sa(this.value,D,!0)},Zs.prototype.forEach=function(D){return this.value=Sa(this.value,D,!1),this.value},Zs.prototype.reduce=function(D,V){var oe=arguments.length===1,Ae=oe?this.value:V;return this.forEach(function(Xe){this.isRoot&&oe||(Ae=D.call(this,Ae,Xe))}),Ae},Zs.prototype.paths=function(){var D=[];return this.forEach(function(V){D.push(this.path)}),D},Zs.prototype.nodes=function(){var D=[];return this.forEach(function(V){D.push(this.node)}),D},Zs.prototype.clone=function(){var D=[],V=[];return function oe(Ae){for(var Xe=0;Xe<D.length;Xe++)if(D[Xe]===Ae)return V[Xe];if(typeof Ae=="object"&&Ae!==null){var We=xe(Ae);return D.push(Ae),V.push(We),Ce(Q(Ae),function(Qe){We[Qe]=oe(Ae[Qe])}),D.pop(),V.pop(),We}return Ae}(this.value)};var Q=Object.keys||function(D){var V=[];for(var oe in D)V.push(oe);return V};function ne(D){return Object.prototype.toString.call(D)}var ve=Array.isArray||function(D){return Object.prototype.toString.call(D)==="[object Array]"},Ce=function(D,V){if(D.forEach)return D.forEach(V);for(var oe=0;oe<D.length;oe++)V(D[oe],oe,D)};Ce(Q(Zs.prototype),function(D){Ta[D]=function(V){var oe=[].slice.call(arguments,1),Ae=new Zs(V);return Ae[D].apply(Ae,oe)}});var Be=Object.hasOwnProperty||function(D,V){return V in D},st=tt;function tt(D){if(!(this instanceof tt))return new tt(D);this._bbox=D||[1/0,1/0,-1/0,-1/0],this._valid=!!D}tt.prototype.include=function(D){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],D[0]),this._bbox[1]=Math.min(this._bbox[1],D[1]),this._bbox[2]=Math.max(this._bbox[2],D[0]),this._bbox[3]=Math.max(this._bbox[3],D[1]),this},tt.prototype.equals=function(D){var V;return V=D instanceof tt?D.bbox():D,this._bbox[0]==V[0]&&this._bbox[1]==V[1]&&this._bbox[2]==V[2]&&this._bbox[3]==V[3]},tt.prototype.center=function(D){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},tt.prototype.union=function(D){var V;return this._valid=!0,V=D instanceof tt?D.bbox():D,this._bbox[0]=Math.min(this._bbox[0],V[0]),this._bbox[1]=Math.min(this._bbox[1],V[1]),this._bbox[2]=Math.max(this._bbox[2],V[2]),this._bbox[3]=Math.max(this._bbox[3],V[3]),this},tt.prototype.bbox=function(){return this._valid?this._bbox:null},tt.prototype.contains=function(D){if(!D)return this._fastContains();if(!this._valid)return null;var V=D[0],oe=D[1];return this._bbox[0]<=V&&this._bbox[1]<=oe&&this._bbox[2]>=V&&this._bbox[3]>=oe},tt.prototype.intersect=function(D){return this._valid?(V=D instanceof tt?D.bbox():D,!(this._bbox[0]>V[2]||this._bbox[2]<V[0]||this._bbox[3]<V[1]||this._bbox[1]>V[3])):null;var V},tt.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var D="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",D)},tt.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var He=function(D){if(!D)return[];var V=aa(Ha(D)),oe=[];return V.features.forEach(function(Ae){Ae.geometry&&(oe=oe.concat(Wa(Ae.geometry.coordinates)))}),oe},ue=Bs,Ye=st,ge={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},It=Object.keys(ge);function vn(D){for(var V=Ye(),oe=He(D),Ae=0;Ae<oe.length;Ae++)V.include(oe[Ae]);return V}qa.exports=function(D){return vn(D).bbox()},Mo.polygon=function(D){return vn(D).polygon()},Mo.bboxify=function(D){return ue(D).map(function(V){V&&It.some(function(oe){return!!V[oe]&&ge[oe].indexOf(V.type)!==-1})&&(V.bbox=vn(V).bbox(),this.update(V))})};var Wn=-90;function Vn(D,V){var oe=Wn,Ae=90,Xe=Wn,We=90,Qe=270,en=-270;D.forEach(function(Ln){var gn=Mo(Ln),bn=gn[1],xi=gn[3],ls=gn[0],wi=gn[2];bn>oe&&(oe=bn),xi<Ae&&(Ae=xi),xi>Xe&&(Xe=xi),bn<We&&(We=bn),ls<Qe&&(Qe=ls),wi>en&&(en=wi)});var Qt=V;return oe+Qt.lat>85&&(Qt.lat=85-oe),Xe+Qt.lat>90&&(Qt.lat=90-Xe),Ae+Qt.lat<-85&&(Qt.lat=-85-Ae),We+Qt.lat<Wn&&(Qt.lat=Wn-We),Qe+Qt.lng<=-270&&(Qt.lng+=360*Math.ceil(Math.abs(Qt.lng)/360)),en+Qt.lng>=270&&(Qt.lng-=360*Math.ceil(Math.abs(Qt.lng)/360)),Qt}function je(D,V){var oe=Vn(D.map(function(Ae){return Ae.toGeoJSON()}),V);D.forEach(function(Ae){var Xe,We=Ae.getCoordinates(),Qe=function(Qt){var Ln={lng:Qt[0]+oe.lng,lat:Qt[1]+oe.lat};return[Ln.lng,Ln.lat]},en=function(Qt){return Qt.map(function(Ln){return Qe(Ln)})};Ae.type===k.POINT?Xe=Qe(We):Ae.type===k.LINE_STRING||Ae.type===k.MULTI_POINT?Xe=We.map(Qe):Ae.type===k.POLYGON||Ae.type===k.MULTI_LINE_STRING?Xe=We.map(en):Ae.type===k.MULTI_POLYGON&&(Xe=We.map(function(Qt){return Qt.map(function(Ln){return en(Ln)})})),Ae.incomingCoords(Xe)})}var Fn={onSetup:function(D){var V=this,oe={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:D.featureIds||[]};return this.setSelected(oe.initiallySelectedFeatureIds.filter(function(Ae){return V.getFeature(Ae)!==void 0})),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),oe},fireUpdate:function(){this.map.fire(G.UPDATE,{action:q.MOVE,features:this.getSelected().map(function(D){return D.toGeoJSON()})})},fireActionable:function(){var D=this,V=this.getSelected(),oe=V.filter(function(en){return D.isInstanceOf("MultiFeature",en)}),Ae=!1;if(V.length>1){Ae=!0;var Xe=V[0].type.replace("Multi","");V.forEach(function(en){en.type.replace("Multi","")!==Xe&&(Ae=!1)})}var We=oe.length>0,Qe=V.length>0;this.setActionableState({combineFeatures:Ae,uncombineFeatures:We,trash:Qe})},getUniqueIds:function(D){return D.length?D.map(function(V){return V.properties.id}).filter(function(V){return V!==void 0}).reduce(function(V,oe){return V.add(oe),V},new Ue).values():[]},stopExtendedInteractions:function(D){D.boxSelectElement&&(D.boxSelectElement.parentNode&&D.boxSelectElement.parentNode.removeChild(D.boxSelectElement),D.boxSelectElement=null),this.map.dragPan.enable(),D.boxSelecting=!1,D.canBoxSelect=!1,D.dragMoving=!1,D.canDragMove=!1},onStop:function(){Os.enable(this)},onMouseMove:function(D){return this.stopExtendedInteractions(D),!0},onMouseOut:function(D){return!D.dragMoving||this.fireUpdate()}};Fn.onTap=Fn.onClick=function(D,V){return fi(V)?this.clickAnywhere(D,V):Hi(Z.VERTEX)(V)?this.clickOnVertex(D,V):Kn(V)?this.clickOnFeature(D,V):void 0},Fn.clickAnywhere=function(D){var V=this,oe=this.getSelectedIds();oe.length&&(this.clearSelectedFeatures(),oe.forEach(function(Ae){return V.doRender(Ae)})),Os.enable(this),this.stopExtendedInteractions(D)},Fn.clickOnVertex=function(D,V){this.changeMode(z.DIRECT_SELECT,{featureId:V.featureTarget.properties.parent,coordPath:V.featureTarget.properties.coord_path,startPos:V.lngLat}),this.updateUIClasses({mouse:M.MOVE})},Fn.startOnActiveFeature=function(D,V){this.stopExtendedInteractions(D),this.map.dragPan.disable(),this.doRender(V.featureTarget.properties.id),D.canDragMove=!0,D.dragMoveLocation=V.lngLat},Fn.clickOnFeature=function(D,V){var oe=this;Os.disable(this),this.stopExtendedInteractions(D);var Ae=vi(V),Xe=this.getSelectedIds(),We=V.featureTarget.properties.id,Qe=this.isSelected(We);if(!Ae&&Qe&&this.getFeature(We).type!==k.POINT)return this.changeMode(z.DIRECT_SELECT,{featureId:We});Qe&&Ae?(this.deselect(We),this.updateUIClasses({mouse:M.POINTER}),Xe.length===1&&Os.enable(this)):!Qe&&Ae?(this.select(We),this.updateUIClasses({mouse:M.MOVE})):Qe||Ae||(Xe.forEach(function(en){return oe.doRender(en)}),this.setSelected(We),this.updateUIClasses({mouse:M.MOVE})),this.doRender(We)},Fn.onMouseDown=function(D,V){return $e(V)?this.startOnActiveFeature(D,V):this.drawConfig.boxSelect&&or(V)?this.startBoxSelect(D,V):void 0},Fn.startBoxSelect=function(D,V){this.stopExtendedInteractions(D),this.map.dragPan.disable(),D.boxSelectStartLocation=Ds(V.originalEvent,this.map.getContainer()),D.canBoxSelect=!0},Fn.onTouchStart=function(D,V){if($e(V))return this.startOnActiveFeature(D,V)},Fn.onDrag=function(D,V){return D.canDragMove?this.dragMove(D,V):this.drawConfig.boxSelect&&D.canBoxSelect?this.whileBoxSelect(D,V):void 0},Fn.whileBoxSelect=function(D,V){D.boxSelecting=!0,this.updateUIClasses({mouse:M.ADD}),D.boxSelectElement||(D.boxSelectElement=document.createElement("div"),D.boxSelectElement.classList.add(I.BOX_SELECT),this.map.getContainer().appendChild(D.boxSelectElement));var oe=Ds(V.originalEvent,this.map.getContainer()),Ae=Math.min(D.boxSelectStartLocation.x,oe.x),Xe=Math.max(D.boxSelectStartLocation.x,oe.x),We=Math.min(D.boxSelectStartLocation.y,oe.y),Qe=Math.max(D.boxSelectStartLocation.y,oe.y),en="translate("+Ae+"px, "+We+"px)";D.boxSelectElement.style.transform=en,D.boxSelectElement.style.WebkitTransform=en,D.boxSelectElement.style.width=Xe-Ae+"px",D.boxSelectElement.style.height=Qe-We+"px"},Fn.dragMove=function(D,V){D.dragMoving=!0,V.originalEvent.stopPropagation();var oe={lng:V.lngLat.lng-D.dragMoveLocation.lng,lat:V.lngLat.lat-D.dragMoveLocation.lat};je(this.getSelected(),oe),D.dragMoveLocation=V.lngLat},Fn.onTouchEnd=Fn.onMouseUp=function(D,V){var oe=this;if(D.dragMoving)this.fireUpdate();else if(D.boxSelecting){var Ae=[D.boxSelectStartLocation,Ds(V.originalEvent,this.map.getContainer())],Xe=this.featuresAt(null,Ae,"click"),We=this.getUniqueIds(Xe).filter(function(Qe){return!oe.isSelected(Qe)});We.length&&(this.select(We),We.forEach(function(Qe){return oe.doRender(Qe)}),this.updateUIClasses({mouse:M.MOVE}))}this.stopExtendedInteractions(D)},Fn.toDisplayFeatures=function(D,V,oe){V.properties.active=this.isSelected(V.properties.id)?K.ACTIVE:K.INACTIVE,oe(V),this.fireActionable(),V.properties.active===K.ACTIVE&&V.geometry.type!==k.POINT&&Vo(V).forEach(oe)},Fn.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},Fn.onCombineFeatures=function(){var D=this.getSelected();if(!(D.length===0||D.length<2)){for(var V=[],oe=[],Ae=D[0].type.replace("Multi",""),Xe=0;Xe<D.length;Xe++){var We=D[Xe];if(We.type.replace("Multi","")!==Ae)return;We.type.includes("Multi")?We.getCoordinates().forEach(function(en){V.push(en)}):V.push(We.getCoordinates()),oe.push(We.toGeoJSON())}if(oe.length>1){var Qe=this.newFeature({type:k.FEATURE,properties:oe[0].properties,geometry:{type:"Multi"+Ae,coordinates:V}});this.addFeature(Qe),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([Qe.id]),this.map.fire(G.COMBINE_FEATURES,{createdFeatures:[Qe.toGeoJSON()],deletedFeatures:oe})}this.fireActionable()}},Fn.onUncombineFeatures=function(){var D=this,V=this.getSelected();if(V.length!==0){for(var oe=[],Ae=[],Xe=function(Qe){var en=V[Qe];D.isInstanceOf("MultiFeature",en)&&(en.getFeatures().forEach(function(Qt){D.addFeature(Qt),Qt.properties=en.properties,oe.push(Qt.toGeoJSON()),D.select([Qt.id])}),D.deleteFeature(en.id,{silent:!0}),Ae.push(en.toGeoJSON()))},We=0;We<V.length;We++)Xe(We);oe.length>1&&this.map.fire(G.UNCOMBINE_FEATURES,{createdFeatures:oe,deletedFeatures:Ae}),this.fireActionable()}};var ar=Hi(Z.VERTEX),ui=Hi(Z.MIDPOINT),Qi={fireUpdate:function(){this.map.fire(G.UPDATE,{action:q.CHANGE_COORDINATES,features:this.getSelected().map(function(D){return D.toGeoJSON()})})},fireActionable:function(D){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:D.selectedCoordPaths.length>0})},startDragging:function(D,V){this.map.dragPan.disable(),D.canDragMove=!0,D.dragMoveLocation=V.lngLat},stopDragging:function(D){this.map.dragPan.enable(),D.dragMoving=!1,D.canDragMove=!1,D.dragMoveLocation=null},onVertex:function(D,V){this.startDragging(D,V);var oe=V.featureTarget.properties,Ae=D.selectedCoordPaths.indexOf(oe.coord_path);vi(V)||Ae!==-1?vi(V)&&Ae===-1&&D.selectedCoordPaths.push(oe.coord_path):D.selectedCoordPaths=[oe.coord_path];var Xe=this.pathsToCoordinates(D.featureId,D.selectedCoordPaths);this.setSelectedCoordinates(Xe)},onMidpoint:function(D,V){this.startDragging(D,V);var oe=V.featureTarget.properties;D.feature.addCoordinate(oe.coord_path,oe.lng,oe.lat),this.fireUpdate(),D.selectedCoordPaths=[oe.coord_path]},pathsToCoordinates:function(D,V){return V.map(function(oe){return{feature_id:D,coord_path:oe}})},onFeature:function(D,V){D.selectedCoordPaths.length===0?this.startDragging(D,V):this.stopDragging(D)},dragFeature:function(D,V,oe){je(this.getSelected(),oe),D.dragMoveLocation=V.lngLat},dragVertex:function(D,V,oe){for(var Ae=D.selectedCoordPaths.map(function(en){return D.feature.getCoordinate(en)}),Xe=Vn(Ae.map(function(en){return{type:k.FEATURE,properties:{},geometry:{type:k.POINT,coordinates:en}}}),oe),We=0;We<Ae.length;We++){var Qe=Ae[We];D.feature.updateCoordinate(D.selectedCoordPaths[We],Qe[0]+Xe.lng,Qe[1]+Xe.lat)}},clickNoTarget:function(){this.changeMode(z.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(z.SIMPLE_SELECT)},clickActiveFeature:function(D){D.selectedCoordPaths=[],this.clearSelectedCoordinates(),D.feature.changed()},onSetup:function(D){var V=D.featureId,oe=this.getFeature(V);if(!oe)throw new Error("You must provide a featureId to enter direct_select mode");if(oe.type===k.POINT)throw new TypeError("direct_select mode doesn't handle point features");var Ae={featureId:V,feature:oe,dragMoveLocation:D.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:D.coordPath?[D.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(V,Ae.selectedCoordPaths)),this.setSelected(V),Os.disable(this),this.setActionableState({trash:!0}),Ae},onStop:function(){Os.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(D,V,oe){D.featureId===V.properties.id?(V.properties.active=K.ACTIVE,oe(V),Vo(V,{map:this.map,midpoints:!0,selectedPaths:D.selectedCoordPaths}).forEach(oe)):(V.properties.active=K.INACTIVE,oe(V)),this.fireActionable(D)},onTrash:function(D){D.selectedCoordPaths.sort(function(V,oe){return oe.localeCompare(V,"en",{numeric:!0})}).forEach(function(V){return D.feature.removeCoordinate(V)}),this.fireUpdate(),D.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(D),D.feature.isValid()===!1&&(this.deleteFeature([D.featureId]),this.changeMode(z.SIMPLE_SELECT,{}))},onMouseMove:function(D,V){var oe=$e(V),Ae=ar(V),Xe=D.selectedCoordPaths.length===0;return oe&&Xe||Ae&&!Xe?this.updateUIClasses({mouse:M.MOVE}):this.updateUIClasses({mouse:M.NONE}),this.stopDragging(D),!0},onMouseOut:function(D){return D.dragMoving&&this.fireUpdate(),!0}};Qi.onTouchStart=Qi.onMouseDown=function(D,V){return ar(V)?this.onVertex(D,V):$e(V)?this.onFeature(D,V):ui(V)?this.onMidpoint(D,V):void 0},Qi.onDrag=function(D,V){if(D.canDragMove===!0){D.dragMoving=!0,V.originalEvent.stopPropagation();var oe={lng:V.lngLat.lng-D.dragMoveLocation.lng,lat:V.lngLat.lat-D.dragMoveLocation.lat};D.selectedCoordPaths.length>0?this.dragVertex(D,V,oe):this.dragFeature(D,V,oe),D.dragMoveLocation=V.lngLat}},Qi.onClick=function(D,V){return fi(V)?this.clickNoTarget(D,V):$e(V)?this.clickActiveFeature(D,V):Tn(V)?this.clickInactive(D,V):void this.stopDragging(D)},Qi.onTap=function(D,V){return fi(V)?this.clickNoTarget(D,V):$e(V)?this.clickActiveFeature(D,V):Tn(V)?this.clickInactive(D,V):void 0},Qi.onTouchEnd=Qi.onMouseUp=function(D){D.dragMoving&&this.fireUpdate(),this.stopDragging(D)};var nr={};function Dl(D,V){return!!D.lngLat&&D.lngLat.lng===V[0]&&D.lngLat.lat===V[1]}nr.onSetup=function(){var D=this.newFeature({type:k.FEATURE,properties:{},geometry:{type:k.POINT,coordinates:[]}});return this.addFeature(D),this.clearSelectedFeatures(),this.updateUIClasses({mouse:M.ADD}),this.activateUIButton(O.POINT),this.setActionableState({trash:!0}),{point:D}},nr.stopDrawingAndRemove=function(D){this.deleteFeature([D.point.id],{silent:!0}),this.changeMode(z.SIMPLE_SELECT)},nr.onTap=nr.onClick=function(D,V){this.updateUIClasses({mouse:M.MOVE}),D.point.updateCoordinate("",V.lngLat.lng,V.lngLat.lat),this.map.fire(G.CREATE,{features:[D.point.toGeoJSON()]}),this.changeMode(z.SIMPLE_SELECT,{featureIds:[D.point.id]})},nr.onStop=function(D){this.activateUIButton(),D.point.getCoordinate().length||this.deleteFeature([D.point.id],{silent:!0})},nr.toDisplayFeatures=function(D,V,oe){var Ae=V.properties.id===D.point.id;if(V.properties.active=Ae?K.ACTIVE:K.INACTIVE,!Ae)return oe(V)},nr.onTrash=nr.stopDrawingAndRemove,nr.onKeyUp=function(D,V){if(Rs(V)||kt(V))return this.stopDrawingAndRemove(D,V)};var la={onSetup:function(){var D=this.newFeature({type:k.FEATURE,properties:{},geometry:{type:k.POLYGON,coordinates:[[]]}});return this.addFeature(D),this.clearSelectedFeatures(),Os.disable(this),this.updateUIClasses({mouse:M.ADD}),this.activateUIButton(O.POLYGON),this.setActionableState({trash:!0}),{polygon:D,currentVertexPosition:0}},clickAnywhere:function(D,V){if(D.currentVertexPosition>0&&Dl(V,D.polygon.coordinates[0][D.currentVertexPosition-1]))return this.changeMode(z.SIMPLE_SELECT,{featureIds:[D.polygon.id]});this.updateUIClasses({mouse:M.ADD}),D.polygon.updateCoordinate("0."+D.currentVertexPosition,V.lngLat.lng,V.lngLat.lat),D.currentVertexPosition++,D.polygon.updateCoordinate("0."+D.currentVertexPosition,V.lngLat.lng,V.lngLat.lat)},clickOnVertex:function(D){return this.changeMode(z.SIMPLE_SELECT,{featureIds:[D.polygon.id]})},onMouseMove:function(D,V){D.polygon.updateCoordinate("0."+D.currentVertexPosition,V.lngLat.lng,V.lngLat.lat),pn(V)&&this.updateUIClasses({mouse:M.POINTER})}};la.onTap=la.onClick=function(D,V){return pn(V)?this.clickOnVertex(D,V):this.clickAnywhere(D,V)},la.onKeyUp=function(D,V){Rs(V)?(this.deleteFeature([D.polygon.id],{silent:!0}),this.changeMode(z.SIMPLE_SELECT)):kt(V)&&this.changeMode(z.SIMPLE_SELECT,{featureIds:[D.polygon.id]})},la.onStop=function(D){this.updateUIClasses({mouse:M.NONE}),Os.enable(this),this.activateUIButton(),this.getFeature(D.polygon.id)!==void 0&&(D.polygon.removeCoordinate("0."+D.currentVertexPosition),D.polygon.isValid()?this.map.fire(G.CREATE,{features:[D.polygon.toGeoJSON()]}):(this.deleteFeature([D.polygon.id],{silent:!0}),this.changeMode(z.SIMPLE_SELECT,{},{silent:!0})))},la.toDisplayFeatures=function(D,V,oe){var Ae=V.properties.id===D.polygon.id;if(V.properties.active=Ae?K.ACTIVE:K.INACTIVE,!Ae)return oe(V);if(V.geometry.coordinates.length!==0){var Xe=V.geometry.coordinates[0].length;if(!(Xe<3)){if(V.properties.meta=Z.FEATURE,oe(io(D.polygon.id,V.geometry.coordinates[0][0],"0.0",!1)),Xe>3){var We=V.geometry.coordinates[0].length-3;oe(io(D.polygon.id,V.geometry.coordinates[0][We],"0."+We,!1))}if(Xe<=4){var Qe=[[V.geometry.coordinates[0][0][0],V.geometry.coordinates[0][0][1]],[V.geometry.coordinates[0][1][0],V.geometry.coordinates[0][1][1]]];if(oe({type:k.FEATURE,properties:V.properties,geometry:{coordinates:Qe,type:k.LINE_STRING}}),Xe===3)return}return oe(V)}}},la.onTrash=function(D){this.deleteFeature([D.polygon.id],{silent:!0}),this.changeMode(z.SIMPLE_SELECT)};var wt={onSetup:function(D){var V,oe,Ae=(D=D||{}).featureId,Xe="forward";if(Ae){if(!(V=this.getFeature(Ae)))throw new Error("Could not find a feature with the provided featureId");var We=D.from;if(We&&We.type==="Feature"&&We.geometry&&We.geometry.type==="Point"&&(We=We.geometry),We&&We.type==="Point"&&We.coordinates&&We.coordinates.length===2&&(We=We.coordinates),!We||!Array.isArray(We))throw new Error("Please use the `from` property to indicate which point to continue the line from");var Qe=V.coordinates.length-1;if(V.coordinates[Qe][0]===We[0]&&V.coordinates[Qe][1]===We[1])oe=Qe+1,V.addCoordinate.apply(V,[oe].concat(V.coordinates[Qe]));else{if(V.coordinates[0][0]!==We[0]||V.coordinates[0][1]!==We[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");Xe="backwards",oe=0,V.addCoordinate.apply(V,[oe].concat(V.coordinates[0]))}}else V=this.newFeature({type:k.FEATURE,properties:{},geometry:{type:k.LINE_STRING,coordinates:[]}}),oe=0,this.addFeature(V);return this.clearSelectedFeatures(),Os.disable(this),this.updateUIClasses({mouse:M.ADD}),this.activateUIButton(O.LINE),this.setActionableState({trash:!0}),{line:V,currentVertexPosition:oe,direction:Xe}},clickAnywhere:function(D,V){if(D.currentVertexPosition>0&&Dl(V,D.line.coordinates[D.currentVertexPosition-1])||D.direction==="backwards"&&Dl(V,D.line.coordinates[D.currentVertexPosition+1]))return this.changeMode(z.SIMPLE_SELECT,{featureIds:[D.line.id]});this.updateUIClasses({mouse:M.ADD}),D.line.updateCoordinate(D.currentVertexPosition,V.lngLat.lng,V.lngLat.lat),D.direction==="forward"?(D.currentVertexPosition++,D.line.updateCoordinate(D.currentVertexPosition,V.lngLat.lng,V.lngLat.lat)):D.line.addCoordinate(0,V.lngLat.lng,V.lngLat.lat)},clickOnVertex:function(D){return this.changeMode(z.SIMPLE_SELECT,{featureIds:[D.line.id]})},onMouseMove:function(D,V){D.line.updateCoordinate(D.currentVertexPosition,V.lngLat.lng,V.lngLat.lat),pn(V)&&this.updateUIClasses({mouse:M.POINTER})}};wt.onTap=wt.onClick=function(D,V){if(pn(V))return this.clickOnVertex(D,V);this.clickAnywhere(D,V)},wt.onKeyUp=function(D,V){kt(V)?this.changeMode(z.SIMPLE_SELECT,{featureIds:[D.line.id]}):Rs(V)&&(this.deleteFeature([D.line.id],{silent:!0}),this.changeMode(z.SIMPLE_SELECT))},wt.onStop=function(D){Os.enable(this),this.activateUIButton(),this.getFeature(D.line.id)!==void 0&&(D.line.removeCoordinate(""+D.currentVertexPosition),D.line.isValid()?this.map.fire(G.CREATE,{features:[D.line.toGeoJSON()]}):(this.deleteFeature([D.line.id],{silent:!0}),this.changeMode(z.SIMPLE_SELECT,{},{silent:!0})))},wt.onTrash=function(D){this.deleteFeature([D.line.id],{silent:!0}),this.changeMode(z.SIMPLE_SELECT)},wt.toDisplayFeatures=function(D,V,oe){var Ae=V.properties.id===D.line.id;if(V.properties.active=Ae?K.ACTIVE:K.INACTIVE,!Ae)return oe(V);V.geometry.coordinates.length<2||(V.properties.meta=Z.FEATURE,oe(io(D.line.id,V.geometry.coordinates[D.direction==="forward"?V.geometry.coordinates.length-2:1],""+(D.direction==="forward"?V.geometry.coordinates.length-2:1),!1)),oe(V))};var Ol={simple_select:Fn,direct_select:Qi,draw_point:nr,draw_polygon:la,draw_line_string:wt},zs={defaultMode:z.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:hi,modes:Ol,controls:{},userProperties:!1},ic={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},am={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function Nl(D,V){return D.map(function(oe){return oe.source?oe:Un(oe,{id:oe.id+"."+V,source:V==="hot"?C.HOT:C.COLD})})}var Eu={};(function(D,V){var oe="__lodash_hash_undefined__",Ae=9007199254740991,Xe="[object Arguments]",We="[object Array]",Qe="[object Boolean]",en="[object Date]",Qt="[object Error]",Ln="[object Function]",gn="[object Map]",bn="[object Number]",xi="[object Object]",ls="[object Promise]",wi="[object RegExp]",ms="[object Set]",jt="[object String]",On="[object Symbol]",Ai="[object WeakMap]",Ys="[object ArrayBuffer]",Ss="[object DataView]",Go=/^\[object .+?Constructor\]$/,ua=/^(?:0|[1-9]\d*)$/,gs={};gs["[object Float32Array]"]=gs["[object Float64Array]"]=gs["[object Int8Array]"]=gs["[object Int16Array]"]=gs["[object Int32Array]"]=gs["[object Uint8Array]"]=gs["[object Uint8ClampedArray]"]=gs["[object Uint16Array]"]=gs["[object Uint32Array]"]=!0,gs[Xe]=gs[We]=gs[Ys]=gs[Qe]=gs[Ss]=gs[en]=gs[Qt]=gs[Ln]=gs[gn]=gs[bn]=gs[xi]=gs[wi]=gs[ms]=gs[jt]=gs[Ai]=!1;var Sf=typeof Kf=="object"&&Kf&&Kf.Object===Object&&Kf,so=typeof self=="object"&&self&&self.Object===Object&&self,ca=Sf||so||Function("return this")(),gd=V&&!V.nodeType&&V,Sh=gd&&D&&!D.nodeType&&D,Lo=Sh&&Sh.exports===gd,Ch=Lo&&Sf.process,jc=function(){try{return Ch&&Ch.binding&&Ch.binding("util")}catch{}}(),Pr=jc&&jc.isTypedArray;function Kr(ot,Lt){for(var wn=-1,di=ot==null?0:ot.length;++wn<di;)if(Lt(ot[wn],wn,ot))return!0;return!1}function _d(ot){var Lt=-1,wn=Array(ot.size);return ot.forEach(function(di,Ur){wn[++Lt]=[Ur,di]}),wn}function pg(ot){var Lt=-1,wn=Array(ot.size);return ot.forEach(function(di){wn[++Lt]=di}),wn}var yd,qc,hp,Cf=Array.prototype,Hc=Function.prototype,kl=Object.prototype,Us=ca["__core-js_shared__"],Fl=Hc.toString,us=kl.hasOwnProperty,Wc=(yd=/[^.]+$/.exec(Us&&Us.keys&&Us.keys.IE_PROTO||""))?"Symbol(src)_1."+yd:"",Af=kl.toString,Xa=RegExp("^"+Fl.call(us).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ah=Lo?ca.Buffer:void 0,Mh=ca.Symbol,Mf=ca.Uint8Array,Lf=kl.propertyIsEnumerable,Xc=Cf.splice,wu=Mh?Mh.toStringTag:void 0,jo=Object.getOwnPropertySymbols,vd=Ah?Ah.isBuffer:void 0,Aa=(qc=Object.keys,hp=Object,function(ot){return qc(hp(ot))}),Iu=Mu(ca,"DataView"),lr=Mu(ca,"Map"),Ma=Mu(ca,"Promise"),sc=Mu(ca,"Set"),Tu=Mu(ca,"WeakMap"),zr=Mu(Object,"create"),Bl=Ul(Iu),Lh=Ul(lr),fp=Ul(Ma),Ph=Ul(sc),dp=Ul(Tu),Su=Mh?Mh.prototype:void 0,Cu=Su?Su.valueOf:void 0;function zl(ot){var Lt=-1,wn=ot==null?0:ot.length;for(this.clear();++Lt<wn;){var di=ot[Lt];this.set(di[0],di[1])}}function La(ot){var Lt=-1,wn=ot==null?0:ot.length;for(this.clear();++Lt<wn;){var di=ot[Lt];this.set(di[0],di[1])}}function Mi(ot){var Lt=-1,wn=ot==null?0:ot.length;for(this.clear();++Lt<wn;){var di=ot[Lt];this.set(di[0],di[1])}}function oc(ot){var Lt=-1,wn=ot==null?0:ot.length;for(this.__data__=new Mi;++Lt<wn;)this.add(ot[Lt])}function $l(ot){var Lt=this.__data__=new La(ot);this.size=Lt.size}function pp(ot,Lt){var wn=kh(ot),di=!wn&&Rf(ot),Ur=!wn&&!di&&dl(ot),Fi=!wn&&!di&&!Ur&&Fh(ot),xs=wn||di||Ur||Fi,oo=xs?function(Ks,Vl){for(var go=-1,it=Array(Ks);++go<Ks;)it[go]=Vl(go);return it}(ot.length,String):[],qo=oo.length;for(var ao in ot)!Lt&&!us.call(ot,ao)||xs&&(ao=="length"||Ur&&(ao=="offset"||ao=="parent")||Fi&&(ao=="buffer"||ao=="byteLength"||ao=="byteOffset")||Nh(ao,qo))||oo.push(ao);return oo}function ac(ot,Lt){for(var wn=ot.length;wn--;)if(_p(ot[wn][0],Lt))return wn;return-1}function Au(ot){return ot==null?ot===void 0?"[object Undefined]":"[object Null]":wu&&wu in Object(ot)?function(Lt){var wn=us.call(Lt,wu),di=Lt[wu];try{Lt[wu]=void 0;var Ur=!0}catch{}var Fi=Af.call(Lt);return Ur&&(wn?Lt[wu]=di:delete Lt[wu]),Fi}(ot):function(Lt){return Af.call(Lt)}(ot)}function Pf(ot){return Ru(ot)&&Au(ot)==Xe}function mp(ot,Lt,wn,di,Ur){return ot===Lt||(ot==null||Lt==null||!Ru(ot)&&!Ru(Lt)?ot!=ot&&Lt!=Lt:function(Fi,xs,oo,qo,ao,Ks){var Vl=kh(Fi),go=kh(xs),it=Vl?We:Lu(Fi),Rt=go?We:Lu(xs),St=(it=it==Xe?xi:it)==xi,Yn=(Rt=Rt==Xe?xi:Rt)==xi,Ii=it==Rt;if(Ii&&dl(Fi)){if(!dl(xs))return!1;Vl=!0,St=!1}if(Ii&&!St)return Ks||(Ks=new $l),Vl||Fh(Fi)?xd(Fi,xs,oo,qo,ao,Ks):function(rs,$i,Du,ha,Za,_o,Ho){switch(Du){case Ss:if(rs.byteLength!=$i.byteLength||rs.byteOffset!=$i.byteOffset)return!1;rs=rs.buffer,$i=$i.buffer;case Ys:return!(rs.byteLength!=$i.byteLength||!_o(new Mf(rs),new Mf($i)));case Qe:case en:case bn:return _p(+rs,+$i);case Qt:return rs.name==$i.name&&rs.message==$i.message;case wi:case jt:return rs==$i+"";case gn:var er=_d;case ms:var Ya=1&ha;if(er||(er=pg),rs.size!=$i.size&&!Ya)return!1;var uc=Ho.get(rs);if(uc)return uc==$i;ha|=2,Ho.set(rs,$i);var Oi=xd(er(rs),er($i),ha,Za,_o,Ho);return Ho.delete(rs),Oi;case On:if(Cu)return Cu.call(rs)==Cu.call($i)}return!1}(Fi,xs,it,oo,qo,ao,Ks);if(!(1&oo)){var Er=St&&us.call(Fi,"__wrapped__"),Vs=Yn&&us.call(xs,"__wrapped__");if(Er||Vs){var es=Er?Fi.value():Fi,bd=Vs?xs.value():xs;return Ks||(Ks=new $l),ao(es,bd,oo,qo,Ks)}}return Ii?(Ks||(Ks=new $l),function(rs,$i,Du,ha,Za,_o){var Ho=1&Du,er=Dh(rs),Ya=er.length,uc=Dh($i).length;if(Ya!=uc&&!Ho)return!1;for(var Oi=Ya;Oi--;){var eu=er[Oi];if(!(Ho?eu in $i:us.call($i,eu)))return!1}var lm=_o.get(rs);if(lm&&_o.get($i))return lm==$i;var Bh=!0;_o.set(rs,$i),_o.set($i,rs);for(var tu=Ho;++Oi<Ya;){var Ka=rs[eu=er[Oi]],cc=$i[eu];if(ha)var zh=Ho?ha(cc,Ka,eu,$i,rs,_o):ha(Ka,cc,eu,rs,$i,_o);if(!(zh===void 0?Ka===cc||Za(Ka,cc,Du,ha,_o):zh)){Bh=!1;break}tu||(tu=eu=="constructor")}if(Bh&&!tu){var hc=rs.constructor,fc=$i.constructor;hc==fc||!("constructor"in rs)||!("constructor"in $i)||typeof hc=="function"&&hc instanceof hc&&typeof fc=="function"&&fc instanceof fc||(Bh=!1)}return _o.delete(rs),_o.delete($i),Bh}(Fi,xs,oo,qo,ao,Ks)):!1}(ot,Lt,wn,di,mp,Ur))}function gp(ot){return!(!Df(ot)||function(Lt){return!!Wc&&Wc in Lt}(ot))&&(Pu(ot)?Xa:Go).test(Ul(ot))}function Rh(ot){if(wn=(Lt=ot)&&Lt.constructor,di=typeof wn=="function"&&wn.prototype||kl,Lt!==di)return Aa(ot);var Lt,wn,di,Ur=[];for(var Fi in Object(ot))us.call(ot,Fi)&&Fi!="constructor"&&Ur.push(Fi);return Ur}function xd(ot,Lt,wn,di,Ur,Fi){var xs=1&wn,oo=ot.length,qo=Lt.length;if(oo!=qo&&!(xs&&qo>oo))return!1;var ao=Fi.get(ot);if(ao&&Fi.get(Lt))return ao==Lt;var Ks=-1,Vl=!0,go=2&wn?new oc:void 0;for(Fi.set(ot,Lt),Fi.set(Lt,ot);++Ks<oo;){var it=ot[Ks],Rt=Lt[Ks];if(di)var St=xs?di(Rt,it,Ks,Lt,ot,Fi):di(it,Rt,Ks,ot,Lt,Fi);if(St!==void 0){if(St)continue;Vl=!1;break}if(go){if(!Kr(Lt,function(Yn,Ii){if(Er=Ii,!go.has(Er)&&(it===Yn||Ur(it,Yn,wn,di,Fi)))return go.push(Ii);var Er})){Vl=!1;break}}else if(it!==Rt&&!Ur(it,Rt,wn,di,Fi)){Vl=!1;break}}return Fi.delete(ot),Fi.delete(Lt),Vl}function Dh(ot){return function(Lt,wn,di){var Ur=wn(Lt);return kh(Lt)?Ur:function(Fi,xs){for(var oo=-1,qo=xs.length,ao=Fi.length;++oo<qo;)Fi[ao+oo]=xs[oo];return Fi}(Ur,di(Lt))}(ot,lc,Oh)}function mo(ot,Lt){var wn,di,Ur=ot.__data__;return((di=typeof(wn=Lt))=="string"||di=="number"||di=="symbol"||di=="boolean"?wn!=="__proto__":wn===null)?Ur[typeof Lt=="string"?"string":"hash"]:Ur.map}function Mu(ot,Lt){var wn=function(di,Ur){return di==null?void 0:di[Ur]}(ot,Lt);return gp(wn)?wn:void 0}zl.prototype.clear=function(){this.__data__=zr?zr(null):{},this.size=0},zl.prototype.delete=function(ot){var Lt=this.has(ot)&&delete this.__data__[ot];return this.size-=Lt?1:0,Lt},zl.prototype.get=function(ot){var Lt=this.__data__;if(zr){var wn=Lt[ot];return wn===oe?void 0:wn}return us.call(Lt,ot)?Lt[ot]:void 0},zl.prototype.has=function(ot){var Lt=this.__data__;return zr?Lt[ot]!==void 0:us.call(Lt,ot)},zl.prototype.set=function(ot,Lt){var wn=this.__data__;return this.size+=this.has(ot)?0:1,wn[ot]=zr&&Lt===void 0?oe:Lt,this},La.prototype.clear=function(){this.__data__=[],this.size=0},La.prototype.delete=function(ot){var Lt=this.__data__,wn=ac(Lt,ot);return!(wn<0)&&(wn==Lt.length-1?Lt.pop():Xc.call(Lt,wn,1),--this.size,!0)},La.prototype.get=function(ot){var Lt=this.__data__,wn=ac(Lt,ot);return wn<0?void 0:Lt[wn][1]},La.prototype.has=function(ot){return ac(this.__data__,ot)>-1},La.prototype.set=function(ot,Lt){var wn=this.__data__,di=ac(wn,ot);return di<0?(++this.size,wn.push([ot,Lt])):wn[di][1]=Lt,this},Mi.prototype.clear=function(){this.size=0,this.__data__={hash:new zl,map:new(lr||La),string:new zl}},Mi.prototype.delete=function(ot){var Lt=mo(this,ot).delete(ot);return this.size-=Lt?1:0,Lt},Mi.prototype.get=function(ot){return mo(this,ot).get(ot)},Mi.prototype.has=function(ot){return mo(this,ot).has(ot)},Mi.prototype.set=function(ot,Lt){var wn=mo(this,ot),di=wn.size;return wn.set(ot,Lt),this.size+=wn.size==di?0:1,this},oc.prototype.add=oc.prototype.push=function(ot){return this.__data__.set(ot,oe),this},oc.prototype.has=function(ot){return this.__data__.has(ot)},$l.prototype.clear=function(){this.__data__=new La,this.size=0},$l.prototype.delete=function(ot){var Lt=this.__data__,wn=Lt.delete(ot);return this.size=Lt.size,wn},$l.prototype.get=function(ot){return this.__data__.get(ot)},$l.prototype.has=function(ot){return this.__data__.has(ot)},$l.prototype.set=function(ot,Lt){var wn=this.__data__;if(wn instanceof La){var di=wn.__data__;if(!lr||di.length<199)return di.push([ot,Lt]),this.size=++wn.size,this;wn=this.__data__=new Mi(di)}return wn.set(ot,Lt),this.size=wn.size,this};var Oh=jo?function(ot){return ot==null?[]:(ot=Object(ot),function(Lt,wn){for(var di=-1,Ur=Lt==null?0:Lt.length,Fi=0,xs=[];++di<Ur;){var oo=Lt[di];wn(oo,di,Lt)&&(xs[Fi++]=oo)}return xs}(jo(ot),function(Lt){return Lf.call(ot,Lt)}))}:function(){return[]},Lu=Au;function Nh(ot,Lt){return!!(Lt=Lt??Ae)&&(typeof ot=="number"||ua.test(ot))&&ot>-1&&ot%1==0&&ot<Lt}function Ul(ot){if(ot!=null){try{return Fl.call(ot)}catch{}try{return ot+""}catch{}}return""}function _p(ot,Lt){return ot===Lt||ot!=ot&&Lt!=Lt}(Iu&&Lu(new Iu(new ArrayBuffer(1)))!=Ss||lr&&Lu(new lr)!=gn||Ma&&Lu(Ma.resolve())!=ls||sc&&Lu(new sc)!=ms||Tu&&Lu(new Tu)!=Ai)&&(Lu=function(ot){var Lt=Au(ot),wn=Lt==xi?ot.constructor:void 0,di=wn?Ul(wn):"";if(di)switch(di){case Bl:return Ss;case Lh:return gn;case fp:return ls;case Ph:return ms;case dp:return Ai}return Lt});var Rf=Pf(function(){return arguments}())?Pf:function(ot){return Ru(ot)&&us.call(ot,"callee")&&!Lf.call(ot,"callee")},kh=Array.isArray,dl=vd||function(){return!1};function Pu(ot){if(!Df(ot))return!1;var Lt=Au(ot);return Lt==Ln||Lt=="[object GeneratorFunction]"||Lt=="[object AsyncFunction]"||Lt=="[object Proxy]"}function yp(ot){return typeof ot=="number"&&ot>-1&&ot%1==0&&ot<=Ae}function Df(ot){var Lt=typeof ot;return ot!=null&&(Lt=="object"||Lt=="function")}function Ru(ot){return ot!=null&&typeof ot=="object"}var Fh=Pr?function(ot){return function(Lt){return ot(Lt)}}(Pr):function(ot){return Ru(ot)&&yp(ot.length)&&!!gs[Au(ot)]};function lc(ot){return(Lt=ot)!=null&&yp(Lt.length)&&!Pu(Lt)?pp(ot):Rh(ot);var Lt}D.exports=function(ot,Lt){return mp(ot,Lt)}})({get exports(){return Eu},set exports(D){Eu=D}},Eu);var cp=Eu;function rc(D,V){return D.length===V.length&&JSON.stringify(D.map(function(oe){return oe}).sort())===JSON.stringify(V.map(function(oe){return oe}).sort())}var hn={Polygon:ri,LineString:zn,Point:sn,MultiPolygon:kn,MultiLineString:kn,MultiPoint:kn},Wi=Object.freeze({__proto__:null,CommonSelectors:mn,constrainFeatureMovement:Vn,createMidPoint:oa,createSupplementaryPoints:Vo,createVertex:io,doubleClickZoom:Os,euclideanDistance:zt,featuresAt:Ge,getFeatureAtAndSetCursors:nt,isClick:Ot,isEventAtCoordinates:Dl,isTap:et,mapEventToBoundingBox:Ne,ModeHandler:t,moveFeatures:je,sortFeatures:Fe,stringSetsAreEqual:rc,StringSet:Ue,theme:hi,toDenseArray:Gn}),Yi=function(D,V){var oe={options:D=function(Xe){Xe===void 0&&(Xe={});var We=Un(Xe);return Xe.controls||(We.controls={}),Xe.displayControlsDefault===!1?We.controls=Un(am,Xe.controls):We.controls=Un(ic,Xe.controls),(We=Un(zs,We)).styles=Nl(We.styles,"cold").concat(Nl(We.styles,"hot")),We}(D)};V=function(Xe,We){return We.modes=z,We.getFeatureIdsAt=function(Qe){return Ge.click({point:Qe},null,Xe).map(function(en){return en.properties.id})},We.getSelectedIds=function(){return Xe.store.getSelectedIds()},We.getSelected=function(){return{type:k.FEATURE_COLLECTION,features:Xe.store.getSelectedIds().map(function(Qe){return Xe.store.get(Qe)}).map(function(Qe){return Qe.toGeoJSON()})}},We.getSelectedPoints=function(){return{type:k.FEATURE_COLLECTION,features:Xe.store.getSelectedCoordinates().map(function(Qe){return{type:k.FEATURE,properties:{},geometry:{type:k.POINT,coordinates:Qe.coordinates}}})}},We.set=function(Qe){if(Qe.type===void 0||Qe.type!==k.FEATURE_COLLECTION||!Array.isArray(Qe.features))throw new Error("Invalid FeatureCollection");var en=Xe.store.createRenderBatch(),Qt=Xe.store.getAllIds().slice(),Ln=We.add(Qe),gn=new Ue(Ln);return(Qt=Qt.filter(function(bn){return!gn.has(bn)})).length&&We.delete(Qt),en(),Ln},We.add=function(Qe){var en=JSON.parse(JSON.stringify(ro(Qe))).features.map(function(Qt){if(Qt.id=Qt.id||Ze(),Qt.geometry===null)throw new Error("Invalid geometry: null");if(Xe.store.get(Qt.id)===void 0||Xe.store.get(Qt.id).type!==Qt.geometry.type){var Ln=hn[Qt.geometry.type];if(Ln===void 0)throw new Error("Invalid geometry type: "+Qt.geometry.type+".");var gn=new Ln(Xe,Qt);Xe.store.add(gn)}else{var bn=Xe.store.get(Qt.id);bn.properties=Qt.properties,cp(bn.getCoordinates(),Qt.geometry.coordinates)||bn.incomingCoords(Qt.geometry.coordinates)}return Qt.id});return Xe.store.render(),en},We.get=function(Qe){var en=Xe.store.get(Qe);if(en)return en.toGeoJSON()},We.getAll=function(){return{type:k.FEATURE_COLLECTION,features:Xe.store.getAll().map(function(Qe){return Qe.toGeoJSON()})}},We.delete=function(Qe){return Xe.store.delete(Qe,{silent:!0}),We.getMode()!==z.DIRECT_SELECT||Xe.store.getSelectedIds().length?Xe.store.render():Xe.events.changeMode(z.SIMPLE_SELECT,void 0,{silent:!0}),We},We.deleteAll=function(){return Xe.store.delete(Xe.store.getAllIds(),{silent:!0}),We.getMode()===z.DIRECT_SELECT?Xe.events.changeMode(z.SIMPLE_SELECT,void 0,{silent:!0}):Xe.store.render(),We},We.changeMode=function(Qe,en){return en===void 0&&(en={}),Qe===z.SIMPLE_SELECT&&We.getMode()===z.SIMPLE_SELECT?(rc(en.featureIds||[],Xe.store.getSelectedIds())||(Xe.store.setSelected(en.featureIds,{silent:!0}),Xe.store.render()),We):(Qe===z.DIRECT_SELECT&&We.getMode()===z.DIRECT_SELECT&&en.featureId===Xe.store.getSelectedIds()[0]||Xe.events.changeMode(Qe,en,{silent:!0}),We)},We.getMode=function(){return Xe.events.getMode()},We.trash=function(){return Xe.events.trash({silent:!0}),We},We.combineFeatures=function(){return Xe.events.combineFeatures({silent:!0}),We},We.uncombineFeatures=function(){return Xe.events.uncombineFeatures({silent:!0}),We},We.setFeatureProperty=function(Qe,en,Qt){return Xe.store.setFeatureProperty(Qe,en,Qt),We},We}(oe,V),oe.api=V;var Ae=Yr(oe);return V.onAdd=Ae.onAdd,V.onRemove=Ae.onRemove,V.types=O,V.options=D,V};function Ca(D){Yi(D,this)}return Ca.modes=Ol,Ca.constants=Te,Ca.lib=Wi,Ca})})(LP);const nC=AP(xT);function PP(){const{subscribe:n,set:e,update:t}=Xm([]);return{subscribe:n,set:e,add:i=>t(r=>(i.forEach(a=>{if(r.map(h=>h.id).includes(a.id)){const h=r.map(s=>s.id).filter(s=>s.startsWith(a.id)).length;a.id+=`_${h}`}}),[...r,...i])),getUniqueSourceId:i=>{const r=Xp(Uv);if(r.map(a=>a.id).includes(i)){const a=r.map(h=>h.id).filter(h=>h.startsWith(i)).length;i+=`_${a}`}return i}}}const Uv=PP();var fv={},RP={get exports(){return fv},set exports(n){fv=n}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(n,e){(function(){var t,i="4.17.21",r=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",h="Expected a function",s="Invalid `variable` option passed into `_.template`",p="__lodash_hash_undefined__",x=500,I="__lodash_placeholder__",C=1,M=2,O=4,k=1,z=2,G=1,q=2,Z=4,K=8,te=16,ie=32,Te=64,le=128,fe=256,Fe=512,Ne=30,Ue="...",dt=800,Ge=16,Le=1,nt=2,zt=3,Ot=1/0,et=9007199254740991,Ze=17976931348623157e292,At=0/0,Kt=4294967295,sn=Kt-1,zn=Kt>>>1,ri=[["ary",le],["bind",G],["bindKey",q],["curry",K],["curryRight",te],["flip",Fe],["partial",ie],["partialRight",Te],["rearg",fe]],Yt="[object Arguments]",ii="[object Array]",kn="[object AsyncFunction]",on="[object Boolean]",Di="[object Date]",Ut="[object DOMException]",Nt="[object Error]",Gn="[object Function]",Ci="[object GeneratorFunction]",ln="[object Map]",Mt="[object Number]",Un="[object Null]",ti="[object Object]",jr="[object Promise]",Yr="[object Proxy]",hi="[object RegExp]",Hi="[object Set]",or="[object String]",$e="[object Symbol]",Tn="[object Undefined]",fi="[object WeakMap]",Kn="[object WeakSet]",pn="[object ArrayBuffer]",vi="[object DataView]",Rs="[object Float32Array]",kt="[object Float64Array]",mn="[object Int8Array]",jn="[object Int16Array]",ki="[object Int32Array]",Ds="[object Uint8Array]",io="[object Uint8ClampedArray]",oa="[object Uint16Array]",Vo="[object Uint32Array]",Os=/\b__p \+= '';/g,Mo=/\b(__p \+=) '' \+/g,qa=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ro=/&(?:amp|lt|gt|quot|#39);/g,Ia=/[&<>"']/g,Rl=RegExp(ro.source),Ha=RegExp(Ia.source),aa=/<%-([\s\S]+?)%>/g,Wa=/<%([\s\S]+?)%>/g,Bs=/<%=([\s\S]+?)%>/g,Ta=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Zs=/^\w*$/,Sa=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,xe=/[\\^$.*+?()[\]{}|]/g,Q=RegExp(xe.source),ne=/^\s+/,ve=/\s/,Ce=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Be=/\{\n\/\* \[wrapped with (.+)\] \*/,st=/,? & /,tt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,He=/[()=,{}\[\]\/\s]/,ue=/\\(\\)?/g,Ye=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ge=/\w*$/,It=/^[-+]0x[0-9a-f]+$/i,vn=/^0b[01]+$/i,Wn=/^\[object .+?Constructor\]$/,Vn=/^0o[0-7]+$/i,je=/^(?:0|[1-9]\d*)$/,Fn=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ar=/($^)/,ui=/['\n\r\u2028\u2029\\]/g,Qi="\\ud800-\\udfff",nr="\\u0300-\\u036f",Dl="\\ufe20-\\ufe2f",la="\\u20d0-\\u20ff",wt=nr+Dl+la,Ol="\\u2700-\\u27bf",zs="a-z\\xdf-\\xf6\\xf8-\\xff",ic="\\xac\\xb1\\xd7\\xf7",am="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Nl="\\u2000-\\u206f",Eu=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",cp="A-Z\\xc0-\\xd6\\xd8-\\xde",rc="\\ufe0e\\ufe0f",hn=ic+am+Nl+Eu,Wi="[']",Yi="["+Qi+"]",Ca="["+hn+"]",D="["+wt+"]",V="\\d+",oe="["+Ol+"]",Ae="["+zs+"]",Xe="[^"+Qi+hn+V+Ol+zs+cp+"]",We="\\ud83c[\\udffb-\\udfff]",Qe="(?:"+D+"|"+We+")",en="[^"+Qi+"]",Qt="(?:\\ud83c[\\udde6-\\uddff]){2}",Ln="[\\ud800-\\udbff][\\udc00-\\udfff]",gn="["+cp+"]",bn="\\u200d",xi="(?:"+Ae+"|"+Xe+")",ls="(?:"+gn+"|"+Xe+")",wi="(?:"+Wi+"(?:d|ll|m|re|s|t|ve))?",ms="(?:"+Wi+"(?:D|LL|M|RE|S|T|VE))?",jt=Qe+"?",On="["+rc+"]?",Ai="(?:"+bn+"(?:"+[en,Qt,Ln].join("|")+")"+On+jt+")*",Ys="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ss="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Go=On+jt+Ai,ua="(?:"+[oe,Qt,Ln].join("|")+")"+Go,gs="(?:"+[en+D+"?",D,Qt,Ln,Yi].join("|")+")",Sf=RegExp(Wi,"g"),so=RegExp(D,"g"),ca=RegExp(We+"(?="+We+")|"+gs+Go,"g"),gd=RegExp([gn+"?"+Ae+"+"+wi+"(?="+[Ca,gn,"$"].join("|")+")",ls+"+"+ms+"(?="+[Ca,gn+xi,"$"].join("|")+")",gn+"?"+xi+"+"+wi,gn+"+"+ms,Ss,Ys,V,ua].join("|"),"g"),Sh=RegExp("["+bn+Qi+wt+rc+"]"),Lo=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ch=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],jc=-1,Pr={};Pr[Rs]=Pr[kt]=Pr[mn]=Pr[jn]=Pr[ki]=Pr[Ds]=Pr[io]=Pr[oa]=Pr[Vo]=!0,Pr[Yt]=Pr[ii]=Pr[pn]=Pr[on]=Pr[vi]=Pr[Di]=Pr[Nt]=Pr[Gn]=Pr[ln]=Pr[Mt]=Pr[ti]=Pr[hi]=Pr[Hi]=Pr[or]=Pr[fi]=!1;var Kr={};Kr[Yt]=Kr[ii]=Kr[pn]=Kr[vi]=Kr[on]=Kr[Di]=Kr[Rs]=Kr[kt]=Kr[mn]=Kr[jn]=Kr[ki]=Kr[ln]=Kr[Mt]=Kr[ti]=Kr[hi]=Kr[Hi]=Kr[or]=Kr[$e]=Kr[Ds]=Kr[io]=Kr[oa]=Kr[Vo]=!0,Kr[Nt]=Kr[Gn]=Kr[fi]=!1;var _d={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},pg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},yd={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},qc={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},hp=parseFloat,Cf=parseInt,Hc=typeof Kf=="object"&&Kf&&Kf.Object===Object&&Kf,kl=typeof self=="object"&&self&&self.Object===Object&&self,Us=Hc||kl||Function("return this")(),Fl=e&&!e.nodeType&&e,us=Fl&&!0&&n&&!n.nodeType&&n,Wc=us&&us.exports===Fl,Af=Wc&&Hc.process,Xa=function(){try{var it=us&&us.require&&us.require("util").types;return it||Af&&Af.binding&&Af.binding("util")}catch{}}(),Ah=Xa&&Xa.isArrayBuffer,Mh=Xa&&Xa.isDate,Mf=Xa&&Xa.isMap,Lf=Xa&&Xa.isRegExp,Xc=Xa&&Xa.isSet,wu=Xa&&Xa.isTypedArray;function jo(it,Rt,St){switch(St.length){case 0:return it.call(Rt);case 1:return it.call(Rt,St[0]);case 2:return it.call(Rt,St[0],St[1]);case 3:return it.call(Rt,St[0],St[1],St[2])}return it.apply(Rt,St)}function vd(it,Rt,St,Yn){for(var Ii=-1,Er=it==null?0:it.length;++Ii<Er;){var Vs=it[Ii];Rt(Yn,Vs,St(Vs),it)}return Yn}function Aa(it,Rt){for(var St=-1,Yn=it==null?0:it.length;++St<Yn&&Rt(it[St],St,it)!==!1;);return it}function Iu(it,Rt){for(var St=it==null?0:it.length;St--&&Rt(it[St],St,it)!==!1;);return it}function lr(it,Rt){for(var St=-1,Yn=it==null?0:it.length;++St<Yn;)if(!Rt(it[St],St,it))return!1;return!0}function Ma(it,Rt){for(var St=-1,Yn=it==null?0:it.length,Ii=0,Er=[];++St<Yn;){var Vs=it[St];Rt(Vs,St,it)&&(Er[Ii++]=Vs)}return Er}function sc(it,Rt){var St=it==null?0:it.length;return!!St&&Mi(it,Rt,0)>-1}function Tu(it,Rt,St){for(var Yn=-1,Ii=it==null?0:it.length;++Yn<Ii;)if(St(Rt,it[Yn]))return!0;return!1}function zr(it,Rt){for(var St=-1,Yn=it==null?0:it.length,Ii=Array(Yn);++St<Yn;)Ii[St]=Rt(it[St],St,it);return Ii}function Bl(it,Rt){for(var St=-1,Yn=Rt.length,Ii=it.length;++St<Yn;)it[Ii+St]=Rt[St];return it}function Lh(it,Rt,St,Yn){var Ii=-1,Er=it==null?0:it.length;for(Yn&&Er&&(St=it[++Ii]);++Ii<Er;)St=Rt(St,it[Ii],Ii,it);return St}function fp(it,Rt,St,Yn){var Ii=it==null?0:it.length;for(Yn&&Ii&&(St=it[--Ii]);Ii--;)St=Rt(St,it[Ii],Ii,it);return St}function Ph(it,Rt){for(var St=-1,Yn=it==null?0:it.length;++St<Yn;)if(Rt(it[St],St,it))return!0;return!1}var dp=ac("length");function Su(it){return it.split("")}function Cu(it){return it.match(tt)||[]}function zl(it,Rt,St){var Yn;return St(it,function(Ii,Er,Vs){if(Rt(Ii,Er,Vs))return Yn=Er,!1}),Yn}function La(it,Rt,St,Yn){for(var Ii=it.length,Er=St+(Yn?1:-1);Yn?Er--:++Er<Ii;)if(Rt(it[Er],Er,it))return Er;return-1}function Mi(it,Rt,St){return Rt===Rt?wn(it,Rt,St):La(it,$l,St)}function oc(it,Rt,St,Yn){for(var Ii=St-1,Er=it.length;++Ii<Er;)if(Yn(it[Ii],Rt))return Ii;return-1}function $l(it){return it!==it}function pp(it,Rt){var St=it==null?0:it.length;return St?gp(it,Rt)/St:At}function ac(it){return function(Rt){return Rt==null?t:Rt[it]}}function Au(it){return function(Rt){return it==null?t:it[Rt]}}function Pf(it,Rt,St,Yn,Ii){return Ii(it,function(Er,Vs,es){St=Yn?(Yn=!1,Er):Rt(St,Er,Vs,es)}),St}function mp(it,Rt){var St=it.length;for(it.sort(Rt);St--;)it[St]=it[St].value;return it}function gp(it,Rt){for(var St,Yn=-1,Ii=it.length;++Yn<Ii;){var Er=Rt(it[Yn]);Er!==t&&(St=St===t?Er:St+Er)}return St}function Rh(it,Rt){for(var St=-1,Yn=Array(it);++St<it;)Yn[St]=Rt(St);return Yn}function xd(it,Rt){return zr(Rt,function(St){return[St,it[St]]})}function Dh(it){return it&&it.slice(0,xs(it)+1).replace(ne,"")}function mo(it){return function(Rt){return it(Rt)}}function Mu(it,Rt){return zr(Rt,function(St){return it[St]})}function Oh(it,Rt){return it.has(Rt)}function Lu(it,Rt){for(var St=-1,Yn=it.length;++St<Yn&&Mi(Rt,it[St],0)>-1;);return St}function Nh(it,Rt){for(var St=it.length;St--&&Mi(Rt,it[St],0)>-1;);return St}function Ul(it,Rt){for(var St=it.length,Yn=0;St--;)it[St]===Rt&&++Yn;return Yn}var _p=Au(_d),Rf=Au(pg);function kh(it){return"\\"+qc[it]}function dl(it,Rt){return it==null?t:it[Rt]}function Pu(it){return Sh.test(it)}function yp(it){return Lo.test(it)}function Df(it){for(var Rt,St=[];!(Rt=it.next()).done;)St.push(Rt.value);return St}function Ru(it){var Rt=-1,St=Array(it.size);return it.forEach(function(Yn,Ii){St[++Rt]=[Ii,Yn]}),St}function Fh(it,Rt){return function(St){return it(Rt(St))}}function lc(it,Rt){for(var St=-1,Yn=it.length,Ii=0,Er=[];++St<Yn;){var Vs=it[St];(Vs===Rt||Vs===I)&&(it[St]=I,Er[Ii++]=St)}return Er}function ot(it){var Rt=-1,St=Array(it.size);return it.forEach(function(Yn){St[++Rt]=Yn}),St}function Lt(it){var Rt=-1,St=Array(it.size);return it.forEach(function(Yn){St[++Rt]=[Yn,Yn]}),St}function wn(it,Rt,St){for(var Yn=St-1,Ii=it.length;++Yn<Ii;)if(it[Yn]===Rt)return Yn;return-1}function di(it,Rt,St){for(var Yn=St+1;Yn--;)if(it[Yn]===Rt)return Yn;return Yn}function Ur(it){return Pu(it)?qo(it):dp(it)}function Fi(it){return Pu(it)?ao(it):Su(it)}function xs(it){for(var Rt=it.length;Rt--&&ve.test(it.charAt(Rt)););return Rt}var oo=Au(yd);function qo(it){for(var Rt=ca.lastIndex=0;ca.test(it);)++Rt;return Rt}function ao(it){return it.match(ca)||[]}function Ks(it){return it.match(gd)||[]}var Vl=function it(Rt){Rt=Rt==null?Us:go.defaults(Us.Object(),Rt,go.pick(Us,Ch));var St=Rt.Array,Yn=Rt.Date,Ii=Rt.Error,Er=Rt.Function,Vs=Rt.Math,es=Rt.Object,bd=Rt.RegExp,rs=Rt.String,$i=Rt.TypeError,Du=St.prototype,ha=Er.prototype,Za=es.prototype,_o=Rt["__core-js_shared__"],Ho=ha.toString,er=Za.hasOwnProperty,Ya=0,uc=function(){var g=/[^.]+$/.exec(_o&&_o.keys&&_o.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}(),Oi=Za.toString,eu=Ho.call(es),lm=Us._,Bh=bd("^"+Ho.call(er).replace(xe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tu=Wc?Rt.Buffer:t,Ka=Rt.Symbol,cc=Rt.Uint8Array,zh=tu?tu.allocUnsafe:t,hc=Fh(es.getPrototypeOf,es),fc=es.create,Of=Za.propertyIsEnumerable,Zc=Du.splice,vp=Ka?Ka.isConcatSpreadable:t,Ou=Ka?Ka.iterator:t,Gl=Ka?Ka.toStringTag:t,Uh=function(){try{var g=Ro(es,"defineProperty");return g({},"",{}),g}catch{}}(),xp=Rt.clearTimeout!==Us.clearTimeout&&Rt.clearTimeout,Sn=Yn&&Yn.now!==Us.Date.now&&Yn.now,nu=Rt.setTimeout!==Us.setTimeout&&Rt.setTimeout,bp=Vs.ceil,Ed=Vs.floor,Nf=es.getOwnPropertySymbols,wd=tu?tu.isBuffer:t,mg=Rt.isFinite,um=Du.join,gg=Fh(es.keys,es),lo=Vs.max,Po=Vs.min,Ep=Yn.now,ta=Rt.parseInt,wp=Vs.random,Zv=Du.reverse,cm=Ro(Rt,"DataView"),Vh=Ro(Rt,"Map"),Ip=Ro(Rt,"Promise"),Yc=Ro(Rt,"Set"),Id=Ro(Rt,"WeakMap"),dc=Ro(es,"create"),Td=Id&&new Id,kf={},hm=Np(cm),D_=Np(Vh),_g=Np(Ip),yg=Np(Yc),Sd=Np(Id),Ff=Ka?Ka.prototype:t,Kc=Ff?Ff.valueOf:t,vg=Ff?Ff.toString:t;function he(g){if(qs(g)&&!Xi(g)&&!(g instanceof Li)){if(g instanceof Ja)return g;if(er.call(g,"__wrapped__"))return sy(g)}return new Ja(g)}var Gh=function(){function g(){}return function(E){if(!Cs(E))return{};if(fc)return fc(E);g.prototype=E;var R=new g;return g.prototype=t,R}}();function Tp(){}function Ja(g,E){this.__wrapped__=g,this.__actions__=[],this.__chain__=!!E,this.__index__=0,this.__values__=t}he.templateSettings={escape:aa,evaluate:Wa,interpolate:Bs,variable:"",imports:{_:he}},he.prototype=Tp.prototype,he.prototype.constructor=he,Ja.prototype=Gh(Tp.prototype),Ja.prototype.constructor=Ja;function Li(g){this.__wrapped__=g,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Kt,this.__views__=[]}function Yv(){var g=new Li(this.__wrapped__);return g.__actions__=pa(this.__actions__),g.__dir__=this.__dir__,g.__filtered__=this.__filtered__,g.__iteratees__=pa(this.__iteratees__),g.__takeCount__=this.__takeCount__,g.__views__=pa(this.__views__),g}function O_(){if(this.__filtered__){var g=new Li(this);g.__dir__=-1,g.__filtered__=!0}else g=this.clone(),g.__dir__*=-1;return g}function Kv(){var g=this.__wrapped__.value(),E=this.__dir__,R=Xi(g),X=E<0,se=R?g.length:0,ye=Dg(0,se,this.__views__),Re=ye.start,Je=ye.end,ct=Je-Re,qt=X?Je:Re-1,Xt=this.__iteratees__,rn=Xt.length,Xn=0,pi=Po(ct,this.__takeCount__);if(!R||!X&&se==ct&&pi==ct)return Ld(g,this.__actions__);var Ni=[];e:for(;ct--&&Xn<pi;){qt+=E;for(var fr=-1,Bi=g[qt];++fr<rn;){var Rr=Xt[fr],Vr=Rr.iteratee,fu=Rr.type,_l=Vr(Bi);if(fu==nt)Bi=_l;else if(!_l){if(fu==Le)continue e;break e}}Ni[Xn++]=Bi}return Ni}Li.prototype=Gh(Tp.prototype),Li.prototype.constructor=Li;function jh(g){var E=-1,R=g==null?0:g.length;for(this.clear();++E<R;){var X=g[E];this.set(X[0],X[1])}}function Jc(){this.__data__=dc?dc(null):{},this.size=0}function N_(g){var E=this.has(g)&&delete this.__data__[g];return this.size-=E?1:0,E}function Cd(g){var E=this.__data__;if(dc){var R=E[g];return R===p?t:R}return er.call(E,g)?E[g]:t}function pc(g){var E=this.__data__;return dc?E[g]!==t:er.call(E,g)}function fm(g,E){var R=this.__data__;return this.size+=this.has(g)?0:1,R[g]=dc&&E===t?p:E,this}jh.prototype.clear=Jc,jh.prototype.delete=N_,jh.prototype.get=Cd,jh.prototype.has=pc,jh.prototype.set=fm;function Cn(g){var E=-1,R=g==null?0:g.length;for(this.clear();++E<R;){var X=g[E];this.set(X[0],X[1])}}function k_(){this.__data__=[],this.size=0}function Sp(g){var E=this.__data__,R=Hh(E,g);if(R<0)return!1;var X=E.length-1;return R==X?E.pop():Zc.call(E,R,1),--this.size,!0}function Cp(g){var E=this.__data__,R=Hh(E,g);return R<0?t:E[R][1]}function Ap(g){return Hh(this.__data__,g)>-1}function Mp(g,E){var R=this.__data__,X=Hh(R,g);return X<0?(++this.size,R.push([g,E])):R[X][1]=E,this}Cn.prototype.clear=k_,Cn.prototype.delete=Sp,Cn.prototype.get=Cp,Cn.prototype.has=Ap,Cn.prototype.set=Mp;function mc(g){var E=-1,R=g==null?0:g.length;for(this.clear();++E<R;){var X=g[E];this.set(X[0],X[1])}}function xg(){this.size=0,this.__data__={hash:new jh,map:new(Vh||Cn),string:new jh}}function F_(g){var E=pl(this,g).delete(g);return this.size-=E?1:0,E}function bg(g){return pl(this,g).get(g)}function Eg(g){return pl(this,g).has(g)}function Lp(g,E){var R=pl(this,g),X=R.size;return R.set(g,E),this.size+=R.size==X?0:1,this}mc.prototype.clear=xg,mc.prototype.delete=F_,mc.prototype.get=bg,mc.prototype.has=Eg,mc.prototype.set=Lp;function gc(g){var E=-1,R=g==null?0:g.length;for(this.__data__=new mc;++E<R;)this.add(g[E])}function Ad(g){return this.__data__.set(g,p),this}function dm(g){return this.__data__.has(g)}gc.prototype.add=gc.prototype.push=Ad,gc.prototype.has=dm;function iu(g){var E=this.__data__=new Cn(g);this.size=E.size}function B_(){this.__data__=new Cn,this.size=0}function wg(g){var E=this.__data__,R=E.delete(g);return this.size=E.size,R}function z_(g){return this.__data__.get(g)}function U_(g){return this.__data__.has(g)}function V_(g,E){var R=this.__data__;if(R instanceof Cn){var X=R.__data__;if(!Vh||X.length<r-1)return X.push([g,E]),this.size=++R.size,this;R=this.__data__=new mc(X)}return R.set(g,E),this.size=R.size,this}iu.prototype.clear=B_,iu.prototype.delete=wg,iu.prototype.get=z_,iu.prototype.has=U_,iu.prototype.set=V_;function pm(g,E){var R=Xi(g),X=!R&&kd(g),se=!R&&!X&&qf(g),ye=!R&&!X&&!se&&Cm(g),Re=R||X||se||ye,Je=Re?Rh(g.length,rs):[],ct=Je.length;for(var qt in g)(E||er.call(g,qt))&&!(Re&&(qt=="length"||se&&(qt=="offset"||qt=="parent")||ye&&(qt=="buffer"||qt=="byteLength"||qt=="byteOffset")||Zh(qt,ct)))&&Je.push(qt);return Je}function Ig(g){var E=g.length;return E?g[_c(0,E-1)]:t}function G_(g,E){return Kh(pa(g),S(E,0,g.length))}function j_(g){return Kh(pa(g))}function mm(g,E,R){(R!==t&&!ch(g[E],R)||R===t&&!(E in g))&&v(g,E,R)}function qh(g,E,R){var X=g[E];(!(er.call(g,E)&&ch(X,R))||R===t&&!(E in g))&&v(g,E,R)}function Hh(g,E){for(var R=g.length;R--;)if(ch(g[R][0],E))return R;return-1}function _(g,E,R,X){return $(g,function(se,ye,Re){E(X,se,R(se),Re)}),X}function c(g,E){return g&&Pa(E,yo(E),g)}function d(g,E){return g&&Pa(E,jl(E),g)}function v(g,E,R){E=="__proto__"&&Uh?Uh(g,E,{configurable:!0,enumerable:!0,value:R,writable:!0}):g[E]=R}function w(g,E){for(var R=-1,X=E.length,se=St(X),ye=g==null;++R<X;)se[R]=ye?t:D0(g,E[R]);return se}function S(g,E,R){return g===g&&(R!==t&&(g=g<=R?g:R),E!==t&&(g=g>=E?g:E)),g}function P(g,E,R,X,se,ye){var Re,Je=E&C,ct=E&M,qt=E&O;if(R&&(Re=se?R(g,X,se,ye):R(g)),Re!==t)return Re;if(!Cs(g))return g;var Xt=Xi(g);if(Xt){if(Re=cw(g),!Je)return pa(g,Re)}else{var rn=tl(g),Xn=rn==Gn||rn==Ci;if(qf(g))return Cg(g,Je);if(rn==ti||rn==Yt||Xn&&!se){if(Re=ct||Xn?{}:r0(g),!Je)return ct?Rd(g,d(Re,g)):eh(g,c(Re,g))}else{if(!Kr[rn])return se?g:{};Re=vx(g,rn,Je)}}ye||(ye=new iu);var pi=ye.get(g);if(pi)return pi;ye.set(g,Re),P0(g)?g.forEach(function(Bi){Re.add(P(Bi,E,R,Bi,g,ye))}):M0(g)&&g.forEach(function(Bi,Rr){Re.set(Rr,P(Bi,E,R,Rr,g,ye))});var Ni=qt?ct?sh:Nd:ct?jl:yo,fr=Xt?t:Ni(g);return Aa(fr||g,function(Bi,Rr){fr&&(Rr=Bi,Bi=g[Rr]),qh(Re,Rr,P(Bi,E,R,Rr,g,ye))}),Re}function N(g){var E=yo(g);return function(R){return B(R,g,E)}}function B(g,E,R){var X=R.length;if(g==null)return!X;for(g=es(g);X--;){var se=R[X],ye=E[se],Re=g[se];if(Re===t&&!(se in g)||!ye(Re))return!1}return!0}function H(g,E,R){if(typeof g!="function")throw new $i(h);return vm(function(){g.apply(t,R)},E)}function W(g,E,R,X){var se=-1,ye=sc,Re=!0,Je=g.length,ct=[],qt=E.length;if(!Je)return ct;R&&(E=zr(E,mo(R))),X?(ye=Tu,Re=!1):E.length>=r&&(ye=Oh,Re=!1,E=new gc(E));e:for(;++se<Je;){var Xt=g[se],rn=R==null?Xt:R(Xt);if(Xt=X||Xt!==0?Xt:0,Re&&rn===rn){for(var Xn=qt;Xn--;)if(E[Xn]===rn)continue e;ct.push(Xt)}else ye(E,rn,X)||ct.push(Xt)}return ct}var $=ux(Se),ae=ux(ze,!0);function pe(g,E){var R=!0;return $(g,function(X,se,ye){return R=!!E(X,se,ye),R}),R}function de(g,E,R){for(var X=-1,se=g.length;++X<se;){var ye=g[X],Re=E(ye);if(Re!=null&&(Je===t?Re===Re&&!zu(Re):R(Re,Je)))var Je=Re,ct=ye}return ct}function me(g,E,R,X){var se=g.length;for(R=ur(R),R<0&&(R=-R>se?0:se+R),X=X===t||X>se?se:ur(X),X<0&&(X+=se),X=R>X?0:Xg(X);R<X;)g[R++]=E;return g}function _e(g,E){var R=[];return $(g,function(X,se,ye){E(X,se,ye)&&R.push(X)}),R}function re(g,E,R,X,se){var ye=-1,Re=g.length;for(R||(R=xx),se||(se=[]);++ye<Re;){var Je=g[ye];E>0&&R(Je)?E>1?re(Je,E-1,R,X,se):Bl(se,Je):X||(se[se.length]=Je)}return se}var Ie=cx(),Ee=cx(!0);function Se(g,E){return g&&Ie(g,E,yo)}function ze(g,E){return g&&Ee(g,E,yo)}function De(g,E){return Ma(E,function(R){return $h(g[R])})}function qe(g,E){E=Pd(E,g);for(var R=0,X=E.length;g!=null&&R<X;)g=g[lh(E[R++])];return R&&R==X?g:t}function lt(g,E,R){var X=E(g);return Xi(g)?X:Bl(X,R(g))}function ut(g){return g==null?g===t?Tn:Un:Gl&&Gl in es(g)?vc(g):Op(g)}function gt(g,E){return g>E}function nn(g,E){return g!=null&&er.call(g,E)}function ft(g,E){return g!=null&&E in es(g)}function Ft(g,E,R){return g>=Po(E,R)&&g<lo(E,R)}function xt(g,E,R){for(var X=R?Tu:sc,se=g[0].length,ye=g.length,Re=ye,Je=St(ye),ct=1/0,qt=[];Re--;){var Xt=g[Re];Re&&E&&(Xt=zr(Xt,mo(E))),ct=Po(Xt.length,ct),Je[Re]=!R&&(E||se>=120&&Xt.length>=120)?new gc(Re&&Xt):t}Xt=g[0];var rn=-1,Xn=Je[0];e:for(;++rn<se&&qt.length<ct;){var pi=Xt[rn],Ni=E?E(pi):pi;if(pi=R||pi!==0?pi:0,!(Xn?Oh(Xn,Ni):X(qt,Ni,R))){for(Re=ye;--Re;){var fr=Je[Re];if(!(fr?Oh(fr,Ni):X(g[Re],Ni,R)))continue e}Xn&&Xn.push(Ni),qt.push(pi)}}return qt}function Wt(g,E,R,X){return Se(g,function(se,ye,Re){E(X,R(se),ye,Re)}),X}function pt(g,E,R){E=Pd(E,g),g=Fu(g,E);var X=g==null?g:g[lh(Es(E))];return X==null?t:jo(X,g,R)}function at(g){return qs(g)&&ut(g)==Yt}function yt(g){return qs(g)&&ut(g)==pn}function Gt(g){return qs(g)&&ut(g)==Di}function Ht(g,E,R,X,se){return g===E?!0:g==null||E==null||!qs(g)&&!qs(E)?g!==g&&E!==E:Qn(g,E,R,X,Ht,se)}function Qn(g,E,R,X,se,ye){var Re=Xi(g),Je=Xi(E),ct=Re?ii:tl(g),qt=Je?ii:tl(E);ct=ct==Yt?ti:ct,qt=qt==Yt?ti:qt;var Xt=ct==ti,rn=qt==ti,Xn=ct==qt;if(Xn&&qf(g)){if(!qf(E))return!1;Re=!0,Xt=!1}if(Xn&&!Xt)return ye||(ye=new iu),Re||Cm(g)?gx(g,E,R,X,se,ye):i0(g,E,ct,R,X,se,ye);if(!(R&k)){var pi=Xt&&er.call(g,"__wrapped__"),Ni=rn&&er.call(E,"__wrapped__");if(pi||Ni){var fr=pi?g.value():g,Bi=Ni?E.value():E;return ye||(ye=new iu),se(fr,Bi,R,X,ye)}}return Xn?(ye||(ye=new iu),_x(g,E,R,X,se,ye)):!1}function ji(g){return qs(g)&&tl(g)==ln}function Bn(g,E,R,X){var se=R.length,ye=se,Re=!X;if(g==null)return!ye;for(g=es(g);se--;){var Je=R[se];if(Re&&Je[2]?Je[1]!==g[Je[0]]:!(Je[0]in g))return!1}for(;++se<ye;){Je=R[se];var ct=Je[0],qt=g[ct],Xt=Je[1];if(Re&&Je[2]){if(qt===t&&!(ct in g))return!1}else{var rn=new iu;if(X)var Xn=X(qt,Xt,ct,g,E,rn);if(!(Xn===t?Ht(Xt,qt,k|z,X,rn):Xn))return!1}}return!0}function An(g){if(!Cs(g)||bx(g))return!1;var E=$h(g)?Bh:Wn;return E.test(Np(g))}function ni(g){return qs(g)&&ut(g)==hi}function ir(g){return qs(g)&&tl(g)==Hi}function oi(g){return qs(g)&&Fd(g.length)&&!!Pr[ut(g)]}function Nr(g){return typeof g=="function"?g:g==null?hu:typeof g=="object"?Xi(g)?ru(g[0],g[1]):Qa(g):j0(g)}function qr(g){if(!Gf(g))return gg(g);var E=[];for(var R in es(g))er.call(g,R)&&R!="constructor"&&E.push(R);return E}function cs(g){if(!Cs(g))return Yh(g);var E=Gf(g),R=[];for(var X in g)X=="constructor"&&(E||!er.call(g,X))||R.push(X);return R}function Jr(g,E){return g<E}function uo(g,E){var R=-1,X=cu(g)?St(g.length):[];return $(g,function(se,ye,Re){X[++R]=E(se,ye,Re)}),X}function Qa(g){var E=Rp(g);return E.length==1&&E[0][2]?ny(E[0][0],E[0][1]):function(R){return R===g||Bn(R,g,E)}}function ru(g,E){return ey(g)&&ty(E)?ny(lh(g),E):function(R){var X=D0(R,g);return X===t&&X===E?O0(R,g):Ht(E,X,k|z)}}function su(g,E,R,X,se){g!==E&&Ie(E,function(ye,Re){if(se||(se=new iu),Cs(ye))bs(g,E,Re,R,su,X,se);else{var Je=X?X(a0(g,Re),ye,Re+"",g,E,se):t;Je===t&&(Je=ye),mm(g,Re,Je)}},jl)}function bs(g,E,R,X,se,ye,Re){var Je=a0(g,R),ct=a0(E,R),qt=Re.get(ct);if(qt){mm(g,R,qt);return}var Xt=ye?ye(Je,ct,R+"",g,E,Re):t,rn=Xt===t;if(rn){var Xn=Xi(ct),pi=!Xn&&qf(ct),Ni=!Xn&&!pi&&Cm(ct);Xt=ct,Xn||pi||Ni?Xi(Je)?Xt=Je:Do(Je)?Xt=pa(Je):pi?(rn=!1,Xt=Cg(ct,!0)):Ni?(rn=!1,Xt=ax(ct,!0)):Xt=[]:Bd(ct)||kd(ct)?(Xt=Je,kd(Je)?Xt=lb(Je):(!Cs(Je)||$h(Je))&&(Xt=r0(ct))):rn=!1}rn&&(Re.set(ct,Xt),se(Xt,ct,X,ye,Re),Re.delete(ct)),mm(g,R,Xt)}function ts(g,E){var R=g.length;if(R)return E+=E<0?R:0,Zh(E,R)?g[E]:t}function wr(g,E,R){E.length?E=zr(E,function(ye){return Xi(ye)?function(Re){return qe(Re,ye.length===1?ye[0]:ye)}:ye}):E=[hu];var X=-1;E=zr(E,mo(Ti()));var se=uo(g,function(ye,Re,Je){var ct=zr(E,function(qt){return qt(ye)});return{criteria:ct,index:++X,value:ye}});return mp(se,function(ye,Re){return lw(ye,Re,R)})}function Js(g,E){return fa(g,E,function(R,X){return O0(g,X)})}function fa(g,E,R){for(var X=-1,se=E.length,ye={};++X<se;){var Re=E[X],Je=qe(g,Re);R(Je,Re)&&ou(ye,Pd(Re,g),Je)}return ye}function _s(g){return function(E){return qe(E,g)}}function na(g,E,R,X){var se=X?oc:Mi,ye=-1,Re=E.length,Je=g;for(g===E&&(E=pa(E)),R&&(Je=zr(g,mo(R)));++ye<Re;)for(var ct=0,qt=E[ye],Xt=R?R(qt):qt;(ct=se(Je,Xt,ct,X))>-1;)Je!==g&&Zc.call(Je,ct,1),Zc.call(g,ct,1);return g}function da(g,E){for(var R=g?E.length:0,X=R-1;R--;){var se=E[R];if(R==X||se!==ye){var ye=se;Zh(se)?Zc.call(g,se,1):H_(g,se)}}return g}function _c(g,E){return g+Ed(wp()*(E-g+1))}function Md(g,E,R,X){for(var se=-1,ye=lo(bp((E-g)/(R||1)),0),Re=St(ye);ye--;)Re[X?ye:++se]=g,g+=R;return Re}function $a(g,E){var R="";if(!g||E<1||E>et)return R;do E%2&&(R+=g),E=Ed(E/2),E&&(g+=g);while(E);return R}function Pi(g,E){return l0(ym(g,E,hu),g+"")}function Qc(g){return Ig(Ud(g))}function Wh(g,E){var R=Ud(g);return Kh(R,S(E,0,R.length))}function ou(g,E,R,X){if(!Cs(g))return g;E=Pd(E,g);for(var se=-1,ye=E.length,Re=ye-1,Je=g;Je!=null&&++se<ye;){var ct=lh(E[se]),qt=R;if(ct==="__proto__"||ct==="constructor"||ct==="prototype")return g;if(se!=Re){var Xt=Je[ct];qt=X?X(Xt,ct,Je):t,qt===t&&(qt=Cs(Xt)?Xt:Zh(E[se+1])?[]:{})}qh(Je,ct,qt),Je=Je[ct]}return g}var Bf=Td?function(g,E){return Td.set(g,E),g}:hu,nx=Uh?function(g,E){return Uh(g,"toString",{configurable:!0,enumerable:!1,value:Kg(E),writable:!0})}:hu;function Jv(g){return Kh(Ud(g))}function Nu(g,E,R){var X=-1,se=g.length;E<0&&(E=-E>se?0:se+E),R=R>se?se:R,R<0&&(R+=se),se=E>R?0:R-E>>>0,E>>>=0;for(var ye=St(se);++X<se;)ye[X]=g[X+E];return ye}function ix(g,E){var R;return $(g,function(X,se,ye){return R=E(X,se,ye),!R}),!!R}function Tg(g,E,R){var X=0,se=g==null?X:g.length;if(typeof E=="number"&&E===E&&se<=zn){for(;X<se;){var ye=X+se>>>1,Re=g[ye];Re!==null&&!zu(Re)&&(R?Re<=E:Re<E)?X=ye+1:se=ye}return se}return q_(g,E,hu,R)}function q_(g,E,R,X){var se=0,ye=g==null?0:g.length;if(ye===0)return 0;E=R(E);for(var Re=E!==E,Je=E===null,ct=zu(E),qt=E===t;se<ye;){var Xt=Ed((se+ye)/2),rn=R(g[Xt]),Xn=rn!==t,pi=rn===null,Ni=rn===rn,fr=zu(rn);if(Re)var Bi=X||Ni;else qt?Bi=Ni&&(X||Xn):Je?Bi=Ni&&Xn&&(X||!pi):ct?Bi=Ni&&Xn&&!pi&&(X||!fr):pi||fr?Bi=!1:Bi=X?rn<=E:rn<E;Bi?se=Xt+1:ye=Xt}return Po(ye,sn)}function Qv(g,E){for(var R=-1,X=g.length,se=0,ye=[];++R<X;){var Re=g[R],Je=E?E(Re):Re;if(!R||!ch(Je,ct)){var ct=Je;ye[se++]=Re===0?0:Re}}return ye}function $v(g){return typeof g=="number"?g:zu(g)?At:+g}function au(g){if(typeof g=="string")return g;if(Xi(g))return zr(g,au)+"";if(zu(g))return vg?vg.call(g):"";var E=g+"";return E=="0"&&1/g==-Ot?"-0":E}function zf(g,E,R){var X=-1,se=sc,ye=g.length,Re=!0,Je=[],ct=Je;if(R)Re=!1,se=Tu;else if(ye>=r){var qt=E?null:Ag(g);if(qt)return ot(qt);Re=!1,se=Oh,ct=new gc}else ct=E?[]:Je;e:for(;++X<ye;){var Xt=g[X],rn=E?E(Xt):Xt;if(Xt=R||Xt!==0?Xt:0,Re&&rn===rn){for(var Xn=ct.length;Xn--;)if(ct[Xn]===rn)continue e;E&&ct.push(rn),Je.push(Xt)}else se(ct,rn,R)||(ct!==Je&&ct.push(rn),Je.push(Xt))}return Je}function H_(g,E){return E=Pd(E,g),g=Fu(g,E),g==null||delete g[lh(Es(E))]}function rx(g,E,R,X){return ou(g,E,R(qe(g,E)),X)}function W_(g,E,R,X){for(var se=g.length,ye=X?se:-1;(X?ye--:++ye<se)&&E(g[ye],ye,g););return R?Nu(g,X?0:ye,X?ye+1:se):Nu(g,X?ye+1:0,X?se:ye)}function Ld(g,E){var R=g;return R instanceof Li&&(R=R.value()),Lh(E,function(X,se){return se.func.apply(se.thisArg,Bl([X],se.args))},R)}function e0(g,E,R){var X=g.length;if(X<2)return X?zf(g[0]):[];for(var se=-1,ye=St(X);++se<X;)for(var Re=g[se],Je=-1;++Je<X;)Je!=se&&(ye[se]=W(ye[se]||Re,g[Je],E,R));return zf(re(ye,1),E,R)}function X_(g,E,R){for(var X=-1,se=g.length,ye=E.length,Re={};++X<se;){var Je=X<ye?E[X]:t;R(Re,g[X],Je)}return Re}function Sg(g){return Do(g)?g:[]}function Z_(g){return typeof g=="function"?g:hu}function Pd(g,E){return Xi(g)?g:ey(g,E)?[g]:u0(Qr(g))}var Y_=Pi;function Uf(g,E,R){var X=g.length;return R=R===t?X:R,!E&&R>=X?g:Nu(g,E,R)}var K_=xp||function(g){return Us.clearTimeout(g)};function Cg(g,E){if(E)return g.slice();var R=g.length,X=zh?zh(R):new g.constructor(R);return g.copy(X),X}function $c(g){var E=new g.constructor(g.byteLength);return new cc(E).set(new cc(g)),E}function J_(g,E){var R=E?$c(g.buffer):g.buffer;return new g.constructor(R,g.byteOffset,g.byteLength)}function sx(g){var E=new g.constructor(g.source,ge.exec(g));return E.lastIndex=g.lastIndex,E}function ox(g){return Kc?es(Kc.call(g)):{}}function ax(g,E){var R=E?$c(g.buffer):g.buffer;return new g.constructor(R,g.byteOffset,g.length)}function lx(g,E){if(g!==E){var R=g!==t,X=g===null,se=g===g,ye=zu(g),Re=E!==t,Je=E===null,ct=E===E,qt=zu(E);if(!Je&&!qt&&!ye&&g>E||ye&&Re&&ct&&!Je&&!qt||X&&Re&&ct||!R&&ct||!se)return 1;if(!X&&!ye&&!qt&&g<E||qt&&R&&se&&!X&&!ye||Je&&R&&se||!Re&&se||!ct)return-1}return 0}function lw(g,E,R){for(var X=-1,se=g.criteria,ye=E.criteria,Re=se.length,Je=R.length;++X<Re;){var ct=lx(se[X],ye[X]);if(ct){if(X>=Je)return ct;var qt=R[X];return ct*(qt=="desc"?-1:1)}}return g.index-E.index}function Q_(g,E,R,X){for(var se=-1,ye=g.length,Re=R.length,Je=-1,ct=E.length,qt=lo(ye-Re,0),Xt=St(ct+qt),rn=!X;++Je<ct;)Xt[Je]=E[Je];for(;++se<Re;)(rn||se<ye)&&(Xt[R[se]]=g[se]);for(;qt--;)Xt[Je++]=g[se++];return Xt}function gm(g,E,R,X){for(var se=-1,ye=g.length,Re=-1,Je=R.length,ct=-1,qt=E.length,Xt=lo(ye-Je,0),rn=St(Xt+qt),Xn=!X;++se<Xt;)rn[se]=g[se];for(var pi=se;++ct<qt;)rn[pi+ct]=E[ct];for(;++Re<Je;)(Xn||se<ye)&&(rn[pi+R[Re]]=g[se++]);return rn}function pa(g,E){var R=-1,X=g.length;for(E||(E=St(X));++R<X;)E[R]=g[R];return E}function Pa(g,E,R,X){var se=!R;R||(R={});for(var ye=-1,Re=E.length;++ye<Re;){var Je=E[ye],ct=X?X(R[Je],g[Je],Je,R,g):t;ct===t&&(ct=g[Je]),se?v(R,Je,ct):qh(R,Je,ct)}return R}function eh(g,E){return Pa(g,Rg(g),E)}function Rd(g,E){return Pa(g,Qs(g),E)}function th(g,E){return function(R,X){var se=Xi(R)?vd:_,ye=E?E():{};return se(R,g,Ti(X,2),ye)}}function yc(g){return Pi(function(E,R){var X=-1,se=R.length,ye=se>1?R[se-1]:t,Re=se>2?R[2]:t;for(ye=g.length>3&&typeof ye=="function"?(se--,ye):t,Re&&ml(R[0],R[1],Re)&&(ye=se<3?t:ye,se=1),E=es(E);++X<se;){var Je=R[X];Je&&g(E,Je,X,ye)}return E})}function ux(g,E){return function(R,X){if(R==null)return R;if(!cu(R))return g(R,X);for(var se=R.length,ye=E?se:-1,Re=es(R);(E?ye--:++ye<se)&&X(Re[ye],ye,Re)!==!1;);return R}}function cx(g){return function(E,R,X){for(var se=-1,ye=es(E),Re=X(E),Je=Re.length;Je--;){var ct=Re[g?Je:++se];if(R(ye[ct],ct,ye)===!1)break}return E}}function uw(g,E,R){var X=E&G,se=Dd(g);function ye(){var Re=this&&this!==Us&&this instanceof ye?se:g;return Re.apply(X?R:this,arguments)}return ye}function hx(g){return function(E){E=Qr(E);var R=Pu(E)?Fi(E):t,X=R?R[0]:E.charAt(0),se=R?Uf(R,1).join(""):E.slice(1);return X[g]()+se}}function Pp(g){return function(E){return Lh(Pb(z0(E).replace(Sf,"")),g,"")}}function Dd(g){return function(){var E=arguments;switch(E.length){case 0:return new g;case 1:return new g(E[0]);case 2:return new g(E[0],E[1]);case 3:return new g(E[0],E[1],E[2]);case 4:return new g(E[0],E[1],E[2],E[3]);case 5:return new g(E[0],E[1],E[2],E[3],E[4]);case 6:return new g(E[0],E[1],E[2],E[3],E[4],E[5]);case 7:return new g(E[0],E[1],E[2],E[3],E[4],E[5],E[6])}var R=Gh(g.prototype),X=g.apply(R,E);return Cs(X)?X:R}}function nh(g,E,R){var X=Dd(g);function se(){for(var ye=arguments.length,Re=St(ye),Je=ye,ct=Xh(se);Je--;)Re[Je]=arguments[Je];var qt=ye<3&&Re[0]!==ct&&Re[ye-1]!==ct?[]:lc(Re,ct);if(ye-=qt.length,ye<R)return $_(g,E,Gs,se.placeholder,t,Re,qt,t,t,R-ye);var Xt=this&&this!==Us&&this instanceof se?X:g;return jo(Xt,this,Re)}return se}function fx(g){return function(E,R,X){var se=es(E);if(!cu(E)){var ye=Ti(R,3);E=yo(E),R=function(Je){return ye(se[Je],Je,se)}}var Re=g(E,R,X);return Re>-1?se[ye?E[Re]:Re]:t}}function dx(g){return ku(function(E){var R=E.length,X=R,se=Ja.prototype.thru;for(g&&E.reverse();X--;){var ye=E[X];if(typeof ye!="function")throw new $i(h);if(se&&!Re&&Pg(ye)=="wrapper")var Re=new Ja([],!0)}for(X=Re?X:R;++X<R;){ye=E[X];var Je=Pg(ye),ct=Je=="wrapper"?Lg(ye):t;ct&&s0(ct[0])&&ct[1]==(le|K|ie|fe)&&!ct[4].length&&ct[9]==1?Re=Re[Pg(ct[0])].apply(Re,ct[3]):Re=ye.length==1&&s0(ye)?Re[Je]():Re.thru(ye)}return function(){var qt=arguments,Xt=qt[0];if(Re&&qt.length==1&&Xi(Xt))return Re.plant(Xt).value();for(var rn=0,Xn=R?E[rn].apply(this,qt):Xt;++rn<R;)Xn=E[rn].call(this,Xn);return Xn}})}function Gs(g,E,R,X,se,ye,Re,Je,ct,qt){var Xt=E&le,rn=E&G,Xn=E&q,pi=E&(K|te),Ni=E&Fe,fr=Xn?t:Dd(g);function Bi(){for(var Rr=arguments.length,Vr=St(Rr),fu=Rr;fu--;)Vr[fu]=arguments[fu];if(pi)var _l=Xh(Bi),du=Ul(Vr,_l);if(X&&(Vr=Q_(Vr,X,se,pi)),ye&&(Vr=gm(Vr,ye,Re,pi)),Rr-=du,pi&&Rr<qt){var Oo=lc(Vr,_l);return $_(g,E,Gs,Bi.placeholder,R,Vr,Oo,Je,ct,qt-Rr)}var Ec=rn?R:this,yl=Xn?Ec[g]:g;return Rr=Vr.length,Je?Vr=xc(Vr,Je):Ni&&Rr>1&&Vr.reverse(),Xt&&ct<Rr&&(Vr.length=ct),this&&this!==Us&&this instanceof Bi&&(yl=fr||Dd(yl)),yl.apply(Ec,Vr)}return Bi}function gi(g,E){return function(R,X){return Wt(R,g,E(X),{})}}function ih(g,E){return function(R,X){var se;if(R===t&&X===t)return E;if(R!==t&&(se=R),X!==t){if(se===t)return X;typeof R=="string"||typeof X=="string"?(R=au(R),X=au(X)):(R=$v(R),X=$v(X)),se=g(R,X)}return se}}function _m(g){return ku(function(E){return E=zr(E,mo(Ti())),Pi(function(R){var X=this;return g(E,function(se){return jo(se,X,R)})})})}function el(g,E){E=E===t?" ":au(E);var R=E.length;if(R<2)return R?$a(E,g):E;var X=$a(E,bp(g/Ur(E)));return Pu(E)?Uf(Fi(X),0,g).join(""):X.slice(0,g)}function px(g,E,R,X){var se=E&G,ye=Dd(g);function Re(){for(var Je=-1,ct=arguments.length,qt=-1,Xt=X.length,rn=St(Xt+ct),Xn=this&&this!==Us&&this instanceof Re?ye:g;++qt<Xt;)rn[qt]=X[qt];for(;ct--;)rn[qt++]=arguments[++Je];return jo(Xn,se?R:this,rn)}return Re}function t0(g){return function(E,R,X){return X&&typeof X!="number"&&ml(E,R,X)&&(R=X=t),E=Da(E),R===t?(R=E,E=0):R=Da(R),X=X===t?E<R?1:-1:Da(X),Md(E,R,X,g)}}function lu(g){return function(E,R){return typeof E=="string"&&typeof R=="string"||(E=il(E),R=il(R)),g(E,R)}}function $_(g,E,R,X,se,ye,Re,Je,ct,qt){var Xt=E&K,rn=Xt?Re:t,Xn=Xt?t:Re,pi=Xt?ye:t,Ni=Xt?t:ye;E|=Xt?ie:Te,E&=~(Xt?Te:ie),E&Z||(E&=~(G|q));var fr=[g,E,se,pi,rn,Ni,Xn,Je,ct,qt],Bi=R.apply(t,fr);return s0(g)&&Og(Bi,fr),Bi.placeholder=X,iy(Bi,g,E)}function Vf(g){var E=Vs[g];return function(R,X){if(R=il(R),X=X==null?0:Po(ur(X),292),X&&mg(R)){var se=(Qr(R)+"e").split("e"),ye=E(se[0]+"e"+(+se[1]+X));return se=(Qr(ye)+"e").split("e"),+(se[0]+"e"+(+se[1]-X))}return E(R)}}var Ag=Yc&&1/ot(new Yc([,-0]))[1]==Ot?function(g){return new Yc(g)}:G0;function Od(g){return function(E){var R=tl(E);return R==ln?Ru(E):R==Hi?Lt(E):xd(E,g(E))}}function rh(g,E,R,X,se,ye,Re,Je){var ct=E&q;if(!ct&&typeof g!="function")throw new $i(h);var qt=X?X.length:0;if(qt||(E&=~(ie|Te),X=se=t),Re=Re===t?Re:lo(ur(Re),0),Je=Je===t?Je:ur(Je),qt-=se?se.length:0,E&Te){var Xt=X,rn=se;X=se=t}var Xn=ct?t:Lg(g),pi=[g,E,R,X,se,Xt,rn,ye,Re,Je];if(Xn&&gl(pi,Xn),g=pi[0],E=pi[1],R=pi[2],X=pi[3],se=pi[4],Je=pi[9]=pi[9]===t?ct?0:g.length:lo(pi[9]-qt,0),!Je&&E&(K|te)&&(E&=~(K|te)),!E||E==G)var Ni=uw(g,E,R);else E==K||E==te?Ni=nh(g,E,Je):(E==ie||E==(G|ie))&&!se.length?Ni=px(g,E,R,X):Ni=Gs.apply(t,pi);var fr=Xn?Bf:Og;return iy(fr(Ni,pi),g,E)}function Mg(g,E,R,X){return g===t||ch(g,Za[R])&&!er.call(X,R)?E:g}function n0(g,E,R,X,se,ye){return Cs(g)&&Cs(E)&&(ye.set(E,g),su(g,E,t,n0,ye),ye.delete(E)),g}function mx(g){return Bd(g)?t:g}function gx(g,E,R,X,se,ye){var Re=R&k,Je=g.length,ct=E.length;if(Je!=ct&&!(Re&&ct>Je))return!1;var qt=ye.get(g),Xt=ye.get(E);if(qt&&Xt)return qt==E&&Xt==g;var rn=-1,Xn=!0,pi=R&z?new gc:t;for(ye.set(g,E),ye.set(E,g);++rn<Je;){var Ni=g[rn],fr=E[rn];if(X)var Bi=Re?X(fr,Ni,rn,E,g,ye):X(Ni,fr,rn,g,E,ye);if(Bi!==t){if(Bi)continue;Xn=!1;break}if(pi){if(!Ph(E,function(Rr,Vr){if(!Oh(pi,Vr)&&(Ni===Rr||se(Ni,Rr,R,X,ye)))return pi.push(Vr)})){Xn=!1;break}}else if(!(Ni===fr||se(Ni,fr,R,X,ye))){Xn=!1;break}}return ye.delete(g),ye.delete(E),Xn}function i0(g,E,R,X,se,ye,Re){switch(R){case vi:if(g.byteLength!=E.byteLength||g.byteOffset!=E.byteOffset)return!1;g=g.buffer,E=E.buffer;case pn:return!(g.byteLength!=E.byteLength||!ye(new cc(g),new cc(E)));case on:case Di:case Mt:return ch(+g,+E);case Nt:return g.name==E.name&&g.message==E.message;case hi:case or:return g==E+"";case ln:var Je=Ru;case Hi:var ct=X&k;if(Je||(Je=ot),g.size!=E.size&&!ct)return!1;var qt=Re.get(g);if(qt)return qt==E;X|=z,Re.set(g,E);var Xt=gx(Je(g),Je(E),X,se,ye,Re);return Re.delete(g),Xt;case $e:if(Kc)return Kc.call(g)==Kc.call(E)}return!1}function _x(g,E,R,X,se,ye){var Re=R&k,Je=Nd(g),ct=Je.length,qt=Nd(E),Xt=qt.length;if(ct!=Xt&&!Re)return!1;for(var rn=ct;rn--;){var Xn=Je[rn];if(!(Re?Xn in E:er.call(E,Xn)))return!1}var pi=ye.get(g),Ni=ye.get(E);if(pi&&Ni)return pi==E&&Ni==g;var fr=!0;ye.set(g,E),ye.set(E,g);for(var Bi=Re;++rn<ct;){Xn=Je[rn];var Rr=g[Xn],Vr=E[Xn];if(X)var fu=Re?X(Vr,Rr,Xn,E,g,ye):X(Rr,Vr,Xn,g,E,ye);if(!(fu===t?Rr===Vr||se(Rr,Vr,R,X,ye):fu)){fr=!1;break}Bi||(Bi=Xn=="constructor")}if(fr&&!Bi){var _l=g.constructor,du=E.constructor;_l!=du&&"constructor"in g&&"constructor"in E&&!(typeof _l=="function"&&_l instanceof _l&&typeof du=="function"&&du instanceof du)&&(fr=!1)}return ye.delete(g),ye.delete(E),fr}function ku(g){return l0(ym(g,t,Cx),g+"")}function Nd(g){return lt(g,yo,Rg)}function sh(g){return lt(g,jl,Qs)}var Lg=Td?function(g){return Td.get(g)}:G0;function Pg(g){for(var E=g.name+"",R=kf[E],X=er.call(kf,E)?R.length:0;X--;){var se=R[X],ye=se.func;if(ye==null||ye==g)return se.name}return E}function Xh(g){var E=er.call(he,"placeholder")?he:g;return E.placeholder}function Ti(){var g=he.iteratee||ef;return g=g===ef?Nr:g,arguments.length?g(arguments[0],arguments[1]):g}function pl(g,E){var R=g.__data__;return hw(E)?R[typeof E=="string"?"string":"hash"]:R.map}function Rp(g){for(var E=yo(g),R=E.length;R--;){var X=E[R],se=g[X];E[R]=[X,se,ty(se)]}return E}function Ro(g,E){var R=dl(g,E);return An(R)?R:t}function vc(g){var E=er.call(g,Gl),R=g[Gl];try{g[Gl]=t;var X=!0}catch{}var se=Oi.call(g);return X&&(E?g[Gl]=R:delete g[Gl]),se}var Rg=Nf?function(g){return g==null?[]:(g=es(g),Ma(Nf(g),function(E){return Of.call(g,E)}))}:q0,Qs=Nf?function(g){for(var E=[];g;)Bl(E,Rg(g)),g=hc(g);return E}:q0,tl=ut;(cm&&tl(new cm(new ArrayBuffer(1)))!=vi||Vh&&tl(new Vh)!=ln||Ip&&tl(Ip.resolve())!=jr||Yc&&tl(new Yc)!=Hi||Id&&tl(new Id)!=fi)&&(tl=function(g){var E=ut(g),R=E==ti?g.constructor:t,X=R?Np(R):"";if(X)switch(X){case hm:return vi;case D_:return ln;case _g:return jr;case yg:return Hi;case Sd:return fi}return E});function Dg(g,E,R){for(var X=-1,se=R.length;++X<se;){var ye=R[X],Re=ye.size;switch(ye.type){case"drop":g+=Re;break;case"dropRight":E-=Re;break;case"take":E=Po(E,g+Re);break;case"takeRight":g=lo(g,E-Re);break}}return{start:g,end:E}}function oh(g){var E=g.match(Be);return E?E[1].split(st):[]}function yx(g,E,R){E=Pd(E,g);for(var X=-1,se=E.length,ye=!1;++X<se;){var Re=lh(E[X]);if(!(ye=g!=null&&R(g,Re)))break;g=g[Re]}return ye||++X!=se?ye:(se=g==null?0:g.length,!!se&&Fd(se)&&Zh(Re,se)&&(Xi(g)||kd(g)))}function cw(g){var E=g.length,R=new g.constructor(E);return E&&typeof g[0]=="string"&&er.call(g,"index")&&(R.index=g.index,R.input=g.input),R}function r0(g){return typeof g.constructor=="function"&&!Gf(g)?Gh(hc(g)):{}}function vx(g,E,R){var X=g.constructor;switch(E){case pn:return $c(g);case on:case Di:return new X(+g);case vi:return J_(g,R);case Rs:case kt:case mn:case jn:case ki:case Ds:case io:case oa:case Vo:return ax(g,R);case ln:return new X;case Mt:case or:return new X(g);case hi:return sx(g);case Hi:return new X;case $e:return ox(g)}}function Dp(g,E){var R=E.length;if(!R)return g;var X=R-1;return E[X]=(R>1?"& ":"")+E[X],E=E.join(R>2?", ":" "),g.replace(Ce,`{
/* [wrapped with `+E+`] */
`)}function xx(g){return Xi(g)||kd(g)||!!(vp&&g&&g[vp])}function Zh(g,E){var R=typeof g;return E=E??et,!!E&&(R=="number"||R!="symbol"&&je.test(g))&&g>-1&&g%1==0&&g<E}function ml(g,E,R){if(!Cs(R))return!1;var X=typeof E;return(X=="number"?cu(R)&&Zh(E,R.length):X=="string"&&E in R)?ch(R[E],g):!1}function ey(g,E){if(Xi(g))return!1;var R=typeof g;return R=="number"||R=="symbol"||R=="boolean"||g==null||zu(g)?!0:Zs.test(g)||!Ta.test(g)||E!=null&&g in es(E)}function hw(g){var E=typeof g;return E=="string"||E=="number"||E=="symbol"||E=="boolean"?g!=="__proto__":g===null}function s0(g){var E=Pg(g),R=he[E];if(typeof R!="function"||!(E in Li.prototype))return!1;if(g===R)return!0;var X=Lg(R);return!!X&&g===X[0]}function bx(g){return!!uc&&uc in g}var Ex=_o?$h:ky;function Gf(g){var E=g&&g.constructor,R=typeof E=="function"&&E.prototype||Za;return g===R}function ty(g){return g===g&&!Cs(g)}function ny(g,E){return function(R){return R==null?!1:R[g]===E&&(E!==t||g in es(R))}}function o0(g){var E=vy(g,function(X){return R.size===x&&R.clear(),X}),R=E.cache;return E}function gl(g,E){var R=g[1],X=E[1],se=R|X,ye=se<(G|q|le),Re=X==le&&R==K||X==le&&R==fe&&g[7].length<=E[8]||X==(le|fe)&&E[7].length<=E[8]&&R==K;if(!(ye||Re))return g;X&G&&(g[2]=E[2],se|=R&G?0:Z);var Je=E[3];if(Je){var ct=g[3];g[3]=ct?Q_(ct,Je,E[4]):Je,g[4]=ct?lc(g[3],I):E[4]}return Je=E[5],Je&&(ct=g[5],g[5]=ct?gm(ct,Je,E[6]):Je,g[6]=ct?lc(g[5],I):E[6]),Je=E[7],Je&&(g[7]=Je),X&le&&(g[8]=g[8]==null?E[8]:Po(g[8],E[8])),g[9]==null&&(g[9]=E[9]),g[0]=E[0],g[1]=se,g}function Yh(g){var E=[];if(g!=null)for(var R in es(g))E.push(R);return E}function Op(g){return Oi.call(g)}function ym(g,E,R){return E=lo(E===t?g.length-1:E,0),function(){for(var X=arguments,se=-1,ye=lo(X.length-E,0),Re=St(ye);++se<ye;)Re[se]=X[E+se];se=-1;for(var Je=St(E+1);++se<E;)Je[se]=X[se];return Je[E]=R(Re),jo(g,this,Je)}}function Fu(g,E){return E.length<2?g:qe(g,Nu(E,0,-1))}function xc(g,E){for(var R=g.length,X=Po(E.length,R),se=pa(g);X--;){var ye=E[X];g[X]=Zh(ye,R)?se[ye]:t}return g}function a0(g,E){if(!(E==="constructor"&&typeof g[E]=="function")&&E!="__proto__")return g[E]}var Og=ah(Bf),vm=nu||function(g,E){return Us.setTimeout(g,E)},l0=ah(nx);function iy(g,E,R){var X=E+"";return l0(g,Dp(X,ry(oh(X),R)))}function ah(g){var E=0,R=0;return function(){var X=Ep(),se=Ge-(X-R);if(R=X,se>0){if(++E>=dt)return arguments[0]}else E=0;return g.apply(t,arguments)}}function Kh(g,E){var R=-1,X=g.length,se=X-1;for(E=E===t?X:E;++R<E;){var ye=_c(R,se),Re=g[ye];g[ye]=g[R],g[R]=Re}return g.length=E,g}var u0=o0(function(g){var E=[];return g.charCodeAt(0)===46&&E.push(""),g.replace(Sa,function(R,X,se,ye){E.push(se?ye.replace(ue,"$1"):X||R)}),E});function lh(g){if(typeof g=="string"||zu(g))return g;var E=g+"";return E=="0"&&1/g==-Ot?"-0":E}function Np(g){if(g!=null){try{return Ho.call(g)}catch{}try{return g+""}catch{}}return""}function ry(g,E){return Aa(ri,function(R){var X="_."+R[0];E&R[1]&&!sc(g,X)&&g.push(X)}),g.sort()}function sy(g){if(g instanceof Li)return g.clone();var E=new Ja(g.__wrapped__,g.__chain__);return E.__actions__=pa(g.__actions__),E.__index__=g.__index__,E.__values__=g.__values__,E}function xm(g,E,R){(R?ml(g,E,R):E===t)?E=1:E=lo(ur(E),0);var X=g==null?0:g.length;if(!X||E<1)return[];for(var se=0,ye=0,Re=St(bp(X/E));se<X;)Re[ye++]=Nu(g,se,se+=E);return Re}function bm(g){for(var E=-1,R=g==null?0:g.length,X=0,se=[];++E<R;){var ye=g[E];ye&&(se[X++]=ye)}return se}function Ng(){var g=arguments.length;if(!g)return[];for(var E=St(g-1),R=arguments[0],X=g;X--;)E[X-1]=arguments[X];return Bl(Xi(R)?pa(R):[R],re(E,1))}var oy=Pi(function(g,E){return Do(g)?W(g,re(E,1,Do,!0)):[]}),wx=Pi(function(g,E){var R=Es(E);return Do(R)&&(R=t),Do(g)?W(g,re(E,1,Do,!0),Ti(R,2)):[]}),kg=Pi(function(g,E){var R=Es(E);return Do(R)&&(R=t),Do(g)?W(g,re(E,1,Do,!0),t,R):[]});function c0(g,E,R){var X=g==null?0:g.length;return X?(E=R||E===t?1:ur(E),Nu(g,E<0?0:E,X)):[]}function Ix(g,E,R){var X=g==null?0:g.length;return X?(E=R||E===t?1:ur(E),E=X-E,Nu(g,0,E<0?0:E)):[]}function Em(g,E){return g&&g.length?W_(g,Ti(E,3),!0,!0):[]}function Tx(g,E){return g&&g.length?W_(g,Ti(E,3),!0):[]}function h0(g,E,R,X){var se=g==null?0:g.length;return se?(R&&typeof R!="number"&&ml(g,E,R)&&(R=0,X=se),me(g,E,R,X)):[]}function f0(g,E,R){var X=g==null?0:g.length;if(!X)return-1;var se=R==null?0:ur(R);return se<0&&(se=lo(X+se,0)),La(g,Ti(E,3),se)}function Sx(g,E,R){var X=g==null?0:g.length;if(!X)return-1;var se=X-1;return R!==t&&(se=ur(R),se=R<0?lo(X+se,0):Po(se,X-1)),La(g,Ti(E,3),se,!0)}function Cx(g){var E=g==null?0:g.length;return E?re(g,1):[]}function Fg(g){var E=g==null?0:g.length;return E?re(g,Ot):[]}function Ax(g,E){var R=g==null?0:g.length;return R?(E=E===t?1:ur(E),re(g,E)):[]}function Ir(g){for(var E=-1,R=g==null?0:g.length,X={};++E<R;){var se=g[E];X[se[0]]=se[1]}return X}function ay(g){return g&&g.length?g[0]:t}function Jh(g,E,R){var X=g==null?0:g.length;if(!X)return-1;var se=R==null?0:ur(R);return se<0&&(se=lo(X+se,0)),Mi(g,E,se)}function Qh(g){var E=g==null?0:g.length;return E?Nu(g,0,-1):[]}var uh=Pi(function(g){var E=zr(g,Sg);return E.length&&E[0]===g[0]?xt(E):[]}),Bu=Pi(function(g){var E=Es(g),R=zr(g,Sg);return E===Es(R)?E=t:R.pop(),R.length&&R[0]===g[0]?xt(R,Ti(E,2)):[]}),Ra=Pi(function(g){var E=Es(g),R=zr(g,Sg);return E=typeof E=="function"?E:t,E&&R.pop(),R.length&&R[0]===g[0]?xt(R,t,E):[]});function Mx(g,E){return g==null?"":um.call(g,E)}function Es(g){var E=g==null?0:g.length;return E?g[E-1]:t}function Lx(g,E,R){var X=g==null?0:g.length;if(!X)return-1;var se=X;return R!==t&&(se=ur(R),se=se<0?lo(X+se,0):Po(se,X-1)),E===E?di(g,E,se):La(g,$l,se,!0)}function wm(g,E){return g&&g.length?ts(g,ur(E)):t}var d0=Pi(p0);function p0(g,E){return g&&g.length&&E&&E.length?na(g,E):g}function m0(g,E,R){return g&&g.length&&E&&E.length?na(g,E,Ti(R,2)):g}function fw(g,E,R){return g&&g.length&&E&&E.length?na(g,E,t,R):g}var g0=ku(function(g,E){var R=g==null?0:g.length,X=w(g,E);return da(g,zr(E,function(se){return Zh(se,R)?+se:se}).sort(lx)),X});function Px(g,E){var R=[];if(!(g&&g.length))return R;var X=-1,se=[],ye=g.length;for(E=Ti(E,3);++X<ye;){var Re=g[X];E(Re,X,g)&&(R.push(Re),se.push(X))}return da(g,se),R}function _0(g){return g==null?g:Zv.call(g)}function jf(g,E,R){var X=g==null?0:g.length;return X?(R&&typeof R!="number"&&ml(g,E,R)?(E=0,R=X):(E=E==null?0:ur(E),R=R===t?X:ur(R)),Nu(g,E,R)):[]}function kp(g,E){return Tg(g,E)}function ly(g,E,R){return q_(g,E,Ti(R,2))}function uy(g,E){var R=g==null?0:g.length;if(R){var X=Tg(g,E);if(X<R&&ch(g[X],E))return X}return-1}function y0(g,E){return Tg(g,E,!0)}function Rx(g,E,R){return q_(g,E,Ti(R,2),!0)}function dw(g,E){var R=g==null?0:g.length;if(R){var X=Tg(g,E,!0)-1;if(ch(g[X],E))return X}return-1}function Dx(g){return g&&g.length?Qv(g):[]}function pw(g,E){return g&&g.length?Qv(g,Ti(E,2)):[]}function v0(g){var E=g==null?0:g.length;return E?Nu(g,1,E):[]}function mw(g,E,R){return g&&g.length?(E=R||E===t?1:ur(E),Nu(g,0,E<0?0:E)):[]}function x0(g,E,R){var X=g==null?0:g.length;return X?(E=R||E===t?1:ur(E),E=X-E,Nu(g,E<0?0:E,X)):[]}function Ox(g,E){return g&&g.length?W_(g,Ti(E,3),!1,!0):[]}function Nx(g,E){return g&&g.length?W_(g,Ti(E,3)):[]}var Fp=Pi(function(g){return zf(re(g,1,Do,!0))}),kx=Pi(function(g){var E=Es(g);return Do(E)&&(E=t),zf(re(g,1,Do,!0),Ti(E,2))}),gw=Pi(function(g){var E=Es(g);return E=typeof E=="function"?E:t,zf(re(g,1,Do,!0),t,E)});function Im(g){return g&&g.length?zf(g):[]}function cy(g,E){return g&&g.length?zf(g,Ti(E,2)):[]}function Fx(g,E){return E=typeof E=="function"?E:t,g&&g.length?zf(g,t,E):[]}function hy(g){if(!(g&&g.length))return[];var E=0;return g=Ma(g,function(R){if(Do(R))return E=lo(R.length,E),!0}),Rh(E,function(R){return zr(g,ac(R))})}function Bx(g,E){if(!(g&&g.length))return[];var R=hy(g);return E==null?R:zr(R,function(X){return jo(E,t,X)})}var _w=Pi(function(g,E){return Do(g)?W(g,E):[]}),zx=Pi(function(g){return e0(Ma(g,Do))}),yw=Pi(function(g){var E=Es(g);return Do(E)&&(E=t),e0(Ma(g,Do),Ti(E,2))}),Ux=Pi(function(g){var E=Es(g);return E=typeof E=="function"?E:t,e0(Ma(g,Do),t,E)}),vw=Pi(hy);function xw(g,E){return X_(g||[],E||[],qh)}function Vx(g,E){return X_(g||[],E||[],ou)}var Gx=Pi(function(g){var E=g.length,R=E>1?g[E-1]:t;return R=typeof R=="function"?(g.pop(),R):t,Bx(g,R)});function b0(g){var E=he(g);return E.__chain__=!0,E}function E0(g,E){return E(g),g}function bc(g,E){return E(g)}var uu=ku(function(g){var E=g.length,R=E?g[0]:0,X=this.__wrapped__,se=function(ye){return w(ye,g)};return E>1||this.__actions__.length||!(X instanceof Li)||!Zh(R)?this.thru(se):(X=X.slice(R,+R+(E?1:0)),X.__actions__.push({func:bc,args:[se],thisArg:t}),new Ja(X,this.__chain__).thru(function(ye){return E&&!ye.length&&ye.push(t),ye}))});function bw(){return b0(this)}function w0(){return new Ja(this.value(),this.__chain__)}function Ew(){this.__values__===t&&(this.__values__=ma(this.value()));var g=this.__index__>=this.__values__.length,E=g?t:this.__values__[this.__index__++];return{done:g,value:E}}function ww(){return this}function Iw(g){for(var E,R=this;R instanceof Tp;){var X=sy(R);X.__index__=0,X.__values__=t,E?se.__wrapped__=X:E=X;var se=X;R=R.__wrapped__}return se.__wrapped__=g,E}function Tm(){var g=this.__wrapped__;if(g instanceof Li){var E=g;return this.__actions__.length&&(E=new Li(this)),E=E.reverse(),E.__actions__.push({func:bc,args:[_0],thisArg:t}),new Ja(E,this.__chain__)}return this.thru(_0)}function fy(){return Ld(this.__wrapped__,this.__actions__)}var jx=th(function(g,E,R){er.call(g,R)?++g[R]:v(g,R,1)});function Bp(g,E,R){var X=Xi(g)?lr:pe;return R&&ml(g,E,R)&&(E=t),X(g,Ti(E,3))}function Bg(g,E){var R=Xi(g)?Ma:_e;return R(g,Ti(E,3))}var Tw=fx(f0),Sw=fx(Sx);function Cw(g,E){return re(js(g,E),1)}function Aw(g,E){return re(js(g,E),Ot)}function Mw(g,E,R){return R=R===t?1:ur(R),re(js(g,E),R)}function qx(g,E){var R=Xi(g)?Aa:$;return R(g,Ti(E,3))}function Hx(g,E){var R=Xi(g)?Iu:ae;return R(g,Ti(E,3))}var I0=th(function(g,E,R){er.call(g,R)?g[R].push(E):v(g,R,[E])});function Lw(g,E,R,X){g=cu(g)?g:Ud(g),R=R&&!X?ur(R):0;var se=g.length;return R<0&&(R=lo(se+R,0)),Wg(g)?R<=se&&g.indexOf(E,R)>-1:!!se&&Mi(g,E,R)>-1}var Sm=Pi(function(g,E,R){var X=-1,se=typeof E=="function",ye=cu(g)?St(g.length):[];return $(g,function(Re){ye[++X]=se?jo(E,Re,R):pt(Re,E,R)}),ye}),Pw=th(function(g,E,R){v(g,R,E)});function js(g,E){var R=Xi(g)?zr:uo;return R(g,Ti(E,3))}function dy(g,E,R,X){return g==null?[]:(Xi(E)||(E=E==null?[]:[E]),R=X?t:R,Xi(R)||(R=R==null?[]:[R]),wr(g,E,R))}var Wx=th(function(g,E,R){g[R?0:1].push(E)},function(){return[[],[]]});function py(g,E,R){var X=Xi(g)?Lh:Pf,se=arguments.length<3;return X(g,Ti(E,4),R,se,$)}function my(g,E,R){var X=Xi(g)?fp:Pf,se=arguments.length<3;return X(g,Ti(E,4),R,se,ae)}function zg(g,E){var R=Xi(g)?Ma:_e;return R(g,xy(Ti(E,3)))}function Xx(g){var E=Xi(g)?Ig:Qc;return E(g)}function Zx(g,E,R){(R?ml(g,E,R):E===t)?E=1:E=ur(E);var X=Xi(g)?G_:Wh;return X(g,E)}function Ug(g){var E=Xi(g)?j_:Jv;return E(g)}function T0(g){if(g==null)return 0;if(cu(g))return Wg(g)?Ur(g):g.length;var E=tl(g);return E==ln||E==Hi?g.size:qr(g).length}function S0(g,E,R){var X=Xi(g)?Ph:ix;return R&&ml(g,E,R)&&(E=t),X(g,Ti(E,3))}var Rw=Pi(function(g,E){if(g==null)return[];var R=E.length;return R>1&&ml(g,E[0],E[1])?E=[]:R>2&&ml(E[0],E[1],E[2])&&(E=[E[0]]),wr(g,re(E,1),[])}),Vg=Sn||function(){return Us.Date.now()};function Gg(g,E){if(typeof E!="function")throw new $i(h);return g=ur(g),function(){if(--g<1)return E.apply(this,arguments)}}function Yx(g,E,R){return E=R?t:E,E=g&&E==null?g.length:E,rh(g,le,t,t,t,t,E)}function gy(g,E){var R;if(typeof E!="function")throw new $i(h);return g=ur(g),function(){return--g>0&&(R=E.apply(this,arguments)),g<=1&&(E=t),R}}var C0=Pi(function(g,E,R){var X=G;if(R.length){var se=lc(R,Xh(C0));X|=ie}return rh(g,X,E,R,se)}),_y=Pi(function(g,E,R){var X=G|q;if(R.length){var se=lc(R,Xh(_y));X|=ie}return rh(E,X,g,R,se)});function yy(g,E,R){E=R?t:E;var X=rh(g,K,t,t,t,t,t,E);return X.placeholder=yy.placeholder,X}function jg(g,E,R){E=R?t:E;var X=rh(g,te,t,t,t,t,t,E);return X.placeholder=jg.placeholder,X}function Kx(g,E,R){var X,se,ye,Re,Je,ct,qt=0,Xt=!1,rn=!1,Xn=!0;if(typeof g!="function")throw new $i(h);E=il(E)||0,Cs(R)&&(Xt=!!R.leading,rn="maxWait"in R,ye=rn?lo(il(R.maxWait)||0,E):ye,Xn="trailing"in R?!!R.trailing:Xn);function pi(Oo){var Ec=X,yl=se;return X=se=t,qt=Oo,Re=g.apply(yl,Ec),Re}function Ni(Oo){return qt=Oo,Je=vm(Rr,E),Xt?pi(Oo):Re}function fr(Oo){var Ec=Oo-ct,yl=Oo-qt,Y0=E-Ec;return rn?Po(Y0,ye-yl):Y0}function Bi(Oo){var Ec=Oo-ct,yl=Oo-qt;return ct===t||Ec>=E||Ec<0||rn&&yl>=ye}function Rr(){var Oo=Vg();if(Bi(Oo))return Vr(Oo);Je=vm(Rr,fr(Oo))}function Vr(Oo){return Je=t,Xn&&X?pi(Oo):(X=se=t,Re)}function fu(){Je!==t&&K_(Je),qt=0,X=ct=se=Je=t}function _l(){return Je===t?Re:Vr(Vg())}function du(){var Oo=Vg(),Ec=Bi(Oo);if(X=arguments,se=this,ct=Oo,Ec){if(Je===t)return Ni(ct);if(rn)return K_(Je),Je=vm(Rr,E),pi(ct)}return Je===t&&(Je=vm(Rr,E)),Re}return du.cancel=fu,du.flush=_l,du}var Dw=Pi(function(g,E){return H(g,1,E)}),Ow=Pi(function(g,E,R){return H(g,il(E)||0,R)});function Nw(g){return rh(g,Fe)}function vy(g,E){if(typeof g!="function"||E!=null&&typeof E!="function")throw new $i(h);var R=function(){var X=arguments,se=E?E.apply(this,X):X[0],ye=R.cache;if(ye.has(se))return ye.get(se);var Re=g.apply(this,X);return R.cache=ye.set(se,Re)||ye,Re};return R.cache=new(vy.Cache||mc),R}vy.Cache=mc;function xy(g){if(typeof g!="function")throw new $i(h);return function(){var E=arguments;switch(E.length){case 0:return!g.call(this);case 1:return!g.call(this,E[0]);case 2:return!g.call(this,E[0],E[1]);case 3:return!g.call(this,E[0],E[1],E[2])}return!g.apply(this,E)}}function by(g){return gy(2,g)}var kw=Y_(function(g,E){E=E.length==1&&Xi(E[0])?zr(E[0],mo(Ti())):zr(re(E,1),mo(Ti()));var R=E.length;return Pi(function(X){for(var se=-1,ye=Po(X.length,R);++se<ye;)X[se]=E[se].call(this,X[se]);return jo(g,this,X)})}),Ey=Pi(function(g,E){var R=lc(E,Xh(Ey));return rh(g,ie,t,E,R)}),zp=Pi(function(g,E){var R=lc(E,Xh(zp));return rh(g,Te,t,E,R)}),Fw=ku(function(g,E){return rh(g,fe,t,t,t,E)});function Bw(g,E){if(typeof g!="function")throw new $i(h);return E=E===t?E:ur(E),Pi(g,E)}function zw(g,E){if(typeof g!="function")throw new $i(h);return E=E==null?0:lo(ur(E),0),Pi(function(R){var X=R[E],se=Uf(R,0,E);return X&&Bl(se,X),jo(g,this,se)})}function Jx(g,E,R){var X=!0,se=!0;if(typeof g!="function")throw new $i(h);return Cs(R)&&(X="leading"in R?!!R.leading:X,se="trailing"in R?!!R.trailing:se),Kx(g,E,{leading:X,maxWait:E,trailing:se})}function Qx(g){return Yx(g,1)}function Uw(g,E){return Ey(Z_(E),g)}function Vw(){if(!arguments.length)return[];var g=arguments[0];return Xi(g)?g:[g]}function Gw(g){return P(g,O)}function A0(g,E){return E=typeof E=="function"?E:t,P(g,O,E)}function wy(g){return P(g,C|O)}function Iy(g,E){return E=typeof E=="function"?E:t,P(g,C|O,E)}function jw(g,E){return E==null||B(g,E,yo(E))}function ch(g,E){return g===E||g!==g&&E!==E}var qg=lu(gt),Hg=lu(function(g,E){return g>=E}),kd=at(function(){return arguments}())?at:function(g){return qs(g)&&er.call(g,"callee")&&!Of.call(g,"callee")},Xi=St.isArray,$x=Ah?mo(Ah):yt;function cu(g){return g!=null&&Fd(g.length)&&!$h(g)}function Do(g){return qs(g)&&cu(g)}function eb(g){return g===!0||g===!1||qs(g)&&ut(g)==on}var qf=wd||ky,tb=Mh?mo(Mh):Gt;function nb(g){return qs(g)&&g.nodeType===1&&!Bd(g)}function ib(g){if(g==null)return!0;if(cu(g)&&(Xi(g)||typeof g=="string"||typeof g.splice=="function"||qf(g)||Cm(g)||kd(g)))return!g.length;var E=tl(g);if(E==ln||E==Hi)return!g.size;if(Gf(g))return!qr(g).length;for(var R in g)if(er.call(g,R))return!1;return!0}function qw(g,E){return Ht(g,E)}function Hw(g,E,R){R=typeof R=="function"?R:t;var X=R?R(g,E):t;return X===t?Ht(g,E,t,R):!!X}function Ty(g){if(!qs(g))return!1;var E=ut(g);return E==Nt||E==Ut||typeof g.message=="string"&&typeof g.name=="string"&&!Bd(g)}function Sy(g){return typeof g=="number"&&mg(g)}function $h(g){if(!Cs(g))return!1;var E=ut(g);return E==Gn||E==Ci||E==kn||E==Yr}function nl(g){return typeof g=="number"&&g==ur(g)}function Fd(g){return typeof g=="number"&&g>-1&&g%1==0&&g<=et}function Cs(g){var E=typeof g;return g!=null&&(E=="object"||E=="function")}function qs(g){return g!=null&&typeof g=="object"}var M0=Mf?mo(Mf):ji;function rb(g,E){return g===E||Bn(g,E,Rp(E))}function Ww(g,E,R){return R=typeof R=="function"?R:t,Bn(g,E,Rp(E),R)}function Xw(g){return sb(g)&&g!=+g}function Zw(g){if(Ex(g))throw new Ii(a);return An(g)}function Yw(g){return g===null}function Kw(g){return g==null}function sb(g){return typeof g=="number"||qs(g)&&ut(g)==Mt}function Bd(g){if(!qs(g)||ut(g)!=ti)return!1;var E=hc(g);if(E===null)return!0;var R=er.call(E,"constructor")&&E.constructor;return typeof R=="function"&&R instanceof R&&Ho.call(R)==eu}var L0=Lf?mo(Lf):ni;function ob(g){return nl(g)&&g>=-et&&g<=et}var P0=Xc?mo(Xc):ir;function Wg(g){return typeof g=="string"||!Xi(g)&&qs(g)&&ut(g)==or}function zu(g){return typeof g=="symbol"||qs(g)&&ut(g)==$e}var Cm=wu?mo(wu):oi;function Jw(g){return g===t}function Qw(g){return qs(g)&&tl(g)==fi}function $w(g){return qs(g)&&ut(g)==Kn}var ab=lu(Jr),eI=lu(function(g,E){return g<=E});function ma(g){if(!g)return[];if(cu(g))return Wg(g)?Fi(g):pa(g);if(Ou&&g[Ou])return Df(g[Ou]());var E=tl(g),R=E==ln?Ru:E==Hi?ot:Ud;return R(g)}function Da(g){if(!g)return g===0?g:0;if(g=il(g),g===Ot||g===-Ot){var E=g<0?-1:1;return E*Ze}return g===g?g:0}function ur(g){var E=Da(g),R=E%1;return E===E?R?E-R:E:0}function Xg(g){return g?S(ur(g),0,Kt):0}function il(g){if(typeof g=="number")return g;if(zu(g))return At;if(Cs(g)){var E=typeof g.valueOf=="function"?g.valueOf():g;g=Cs(E)?E+"":E}if(typeof g!="string")return g===0?g:+g;g=Dh(g);var R=vn.test(g);return R||Vn.test(g)?Cf(g.slice(2),R?2:8):It.test(g)?At:+g}function lb(g){return Pa(g,jl(g))}function tI(g){return g?S(ur(g),-et,et):g===0?g:0}function Qr(g){return g==null?"":au(g)}var nI=yc(function(g,E){if(Gf(E)||cu(E)){Pa(E,yo(E),g);return}for(var R in E)er.call(E,R)&&qh(g,R,E[R])}),ub=yc(function(g,E){Pa(E,jl(E),g)}),zd=yc(function(g,E,R,X){Pa(E,jl(E),g,X)}),cb=yc(function(g,E,R,X){Pa(E,yo(E),g,X)}),hb=ku(w);function hs(g,E){var R=Gh(g);return E==null?R:c(R,E)}var R0=Pi(function(g,E){g=es(g);var R=-1,X=E.length,se=X>2?E[2]:t;for(se&&ml(E[0],E[1],se)&&(X=1);++R<X;)for(var ye=E[R],Re=jl(ye),Je=-1,ct=Re.length;++Je<ct;){var qt=Re[Je],Xt=g[qt];(Xt===t||ch(Xt,Za[qt])&&!er.call(g,qt))&&(g[qt]=ye[qt])}return g}),fb=Pi(function(g){return g.push(t,n0),jo(Ay,t,g)});function db(g,E){return zl(g,Ti(E,3),Se)}function Hf(g,E){return zl(g,Ti(E,3),ze)}function Am(g,E){return g==null?g:Ie(g,Ti(E,3),jl)}function pb(g,E){return g==null?g:Ee(g,Ti(E,3),jl)}function iI(g,E){return g&&Se(g,Ti(E,3))}function rI(g,E){return g&&ze(g,Ti(E,3))}function sI(g){return g==null?[]:De(g,yo(g))}function oI(g){return g==null?[]:De(g,jl(g))}function D0(g,E,R){var X=g==null?t:qe(g,E);return X===t?R:X}function aI(g,E){return g!=null&&yx(g,E,nn)}function O0(g,E){return g!=null&&yx(g,E,ft)}var lI=gi(function(g,E,R){E!=null&&typeof E.toString!="function"&&(E=Oi.call(E)),g[E]=R},Kg(hu)),uI=gi(function(g,E,R){E!=null&&typeof E.toString!="function"&&(E=Oi.call(E)),er.call(g,E)?g[E].push(R):g[E]=[R]},Ti),Cy=Pi(pt);function yo(g){return cu(g)?pm(g):qr(g)}function jl(g){return cu(g)?pm(g,!0):cs(g)}function cI(g,E){var R={};return E=Ti(E,3),Se(g,function(X,se,ye){v(R,E(X,se,ye),X)}),R}function hI(g,E){var R={};return E=Ti(E,3),Se(g,function(X,se,ye){v(R,se,E(X,se,ye))}),R}var fI=yc(function(g,E,R){su(g,E,R)}),Ay=yc(function(g,E,R,X){su(g,E,R,X)}),N0=ku(function(g,E){var R={};if(g==null)return R;var X=!1;E=zr(E,function(ye){return ye=Pd(ye,g),X||(X=ye.length>1),ye}),Pa(g,sh(g),R),X&&(R=P(R,C|M|O,mx));for(var se=E.length;se--;)H_(R,E[se]);return R});function mb(g,E){return Mm(g,xy(Ti(E)))}var Uu=ku(function(g,E){return g==null?{}:Js(g,E)});function Mm(g,E){if(g==null)return{};var R=zr(sh(g),function(X){return[X]});return E=Ti(E),fa(g,R,function(X,se){return E(X,se[0])})}function Lm(g,E,R){E=Pd(E,g);var X=-1,se=E.length;for(se||(se=1,g=t);++X<se;){var ye=g==null?t:g[lh(E[X])];ye===t&&(X=se,ye=R),g=$h(ye)?ye.call(g):ye}return g}function k0(g,E,R){return g==null?g:ou(g,E,R)}function My(g,E,R,X){return X=typeof X=="function"?X:t,g==null?g:ou(g,E,R,X)}var gb=Od(yo),F0=Od(jl);function _b(g,E,R){var X=Xi(g),se=X||qf(g)||Cm(g);if(E=Ti(E,4),R==null){var ye=g&&g.constructor;se?R=X?new ye:[]:Cs(g)?R=$h(ye)?Gh(hc(g)):{}:R={}}return(se?Aa:Se)(g,function(Re,Je,ct){return E(R,Re,Je,ct)}),R}function dI(g,E){return g==null?!0:H_(g,E)}function yb(g,E,R){return g==null?g:rx(g,E,Z_(R))}function vb(g,E,R,X){return X=typeof X=="function"?X:t,g==null?g:rx(g,E,Z_(R),X)}function Ud(g){return g==null?[]:Mu(g,yo(g))}function xb(g){return g==null?[]:Mu(g,jl(g))}function pI(g,E,R){return R===t&&(R=E,E=t),R!==t&&(R=il(R),R=R===R?R:0),E!==t&&(E=il(E),E=E===E?E:0),S(il(g),E,R)}function bb(g,E,R){return E=Da(E),R===t?(R=E,E=0):R=Da(R),g=il(g),Ft(g,E,R)}function Wf(g,E,R){if(R&&typeof R!="boolean"&&ml(g,E,R)&&(E=R=t),R===t&&(typeof E=="boolean"?(R=E,E=t):typeof g=="boolean"&&(R=g,g=t)),g===t&&E===t?(g=0,E=1):(g=Da(g),E===t?(E=g,g=0):E=Da(E)),g>E){var X=g;g=E,E=X}if(R||g%1||E%1){var se=wp();return Po(g+se*(E-g+hp("1e-"+((se+"").length-1))),E)}return _c(g,E)}var Eb=Pp(function(g,E,R){return E=E.toLowerCase(),g+(R?B0(E):E)});function B0(g){return Yg(Qr(g).toLowerCase())}function z0(g){return g=Qr(g),g&&g.replace(Fn,_p).replace(so,"")}function wb(g,E,R){g=Qr(g),E=au(E);var X=g.length;R=R===t?X:S(ur(R),0,X);var se=R;return R-=E.length,R>=0&&g.slice(R,se)==E}function mI(g){return g=Qr(g),g&&Ha.test(g)?g.replace(Ia,Rf):g}function gI(g){return g=Qr(g),g&&Q.test(g)?g.replace(xe,"\\$&"):g}var Ib=Pp(function(g,E,R){return g+(R?"-":"")+E.toLowerCase()}),Tb=Pp(function(g,E,R){return g+(R?" ":"")+E.toLowerCase()}),Zg=hx("toLowerCase");function Sb(g,E,R){g=Qr(g),E=ur(E);var X=E?Ur(g):0;if(!E||X>=E)return g;var se=(E-X)/2;return el(Ed(se),R)+g+el(bp(se),R)}function Cb(g,E,R){g=Qr(g),E=ur(E);var X=E?Ur(g):0;return E&&X<E?g+el(E-X,R):g}function U0(g,E,R){g=Qr(g),E=ur(E);var X=E?Ur(g):0;return E&&X<E?el(E-X,R)+g:g}function Pm(g,E,R){return R||E==null?E=0:E&&(E=+E),ta(Qr(g).replace(ne,""),E||0)}function Ab(g,E,R){return(R?ml(g,E,R):E===t)?E=1:E=ur(E),$a(Qr(g),E)}function Ly(){var g=arguments,E=Qr(g[0]);return g.length<3?E:E.replace(g[1],g[2])}var Mb=Pp(function(g,E,R){return g+(R?"_":"")+E.toLowerCase()});function Py(g,E,R){return R&&typeof R!="number"&&ml(g,E,R)&&(E=R=t),R=R===t?Kt:R>>>0,R?(g=Qr(g),g&&(typeof E=="string"||E!=null&&!L0(E))&&(E=au(E),!E&&Pu(g))?Uf(Fi(g),0,R):g.split(E,R)):[]}var Ry=Pp(function(g,E,R){return g+(R?" ":"")+Yg(E)});function _I(g,E,R){return g=Qr(g),R=R==null?0:S(ur(R),0,g.length),E=au(E),g.slice(R,R+E.length)==E}function yI(g,E,R){var X=he.templateSettings;R&&ml(g,E,R)&&(E=t),g=Qr(g),E=zd({},E,X,Mg);var se=zd({},E.imports,X.imports,Mg),ye=yo(se),Re=Mu(se,ye),Je,ct,qt=0,Xt=E.interpolate||ar,rn="__p += '",Xn=bd((E.escape||ar).source+"|"+Xt.source+"|"+(Xt===Bs?Ye:ar).source+"|"+(E.evaluate||ar).source+"|$","g"),pi="//# sourceURL="+(er.call(E,"sourceURL")?(E.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++jc+"]")+`
`;g.replace(Xn,function(Bi,Rr,Vr,fu,_l,du){return Vr||(Vr=fu),rn+=g.slice(qt,du).replace(ui,kh),Rr&&(Je=!0,rn+=`' +
__e(`+Rr+`) +
'`),_l&&(ct=!0,rn+=`';
`+_l+`;
__p += '`),Vr&&(rn+=`' +
((__t = (`+Vr+`)) == null ? '' : __t) +
'`),qt=du+Bi.length,Bi}),rn+=`';
`;var Ni=er.call(E,"variable")&&E.variable;if(!Ni)rn=`with (obj) {
`+rn+`
}
`;else if(He.test(Ni))throw new Ii(s);rn=(ct?rn.replace(Os,""):rn).replace(Mo,"$1").replace(qa,"$1;"),rn="function("+(Ni||"obj")+`) {
`+(Ni?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(Je?", __e = _.escape":"")+(ct?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+rn+`return __p
}`;var fr=Xf(function(){return Er(ye,pi+"return "+rn).apply(t,Re)});if(fr.source=rn,Ty(fr))throw fr;return fr}function vI(g){return Qr(g).toLowerCase()}function xI(g){return Qr(g).toUpperCase()}function bI(g,E,R){if(g=Qr(g),g&&(R||E===t))return Dh(g);if(!g||!(E=au(E)))return g;var X=Fi(g),se=Fi(E),ye=Lu(X,se),Re=Nh(X,se)+1;return Uf(X,ye,Re).join("")}function Rm(g,E,R){if(g=Qr(g),g&&(R||E===t))return g.slice(0,xs(g)+1);if(!g||!(E=au(E)))return g;var X=Fi(g),se=Nh(X,Fi(E))+1;return Uf(X,0,se).join("")}function V0(g,E,R){if(g=Qr(g),g&&(R||E===t))return g.replace(ne,"");if(!g||!(E=au(E)))return g;var X=Fi(g),se=Lu(X,Fi(E));return Uf(X,se).join("")}function EI(g,E){var R=Ne,X=Ue;if(Cs(E)){var se="separator"in E?E.separator:se;R="length"in E?ur(E.length):R,X="omission"in E?au(E.omission):X}g=Qr(g);var ye=g.length;if(Pu(g)){var Re=Fi(g);ye=Re.length}if(R>=ye)return g;var Je=R-Ur(X);if(Je<1)return X;var ct=Re?Uf(Re,0,Je).join(""):g.slice(0,Je);if(se===t)return ct+X;if(Re&&(Je+=ct.length-Je),L0(se)){if(g.slice(Je).search(se)){var qt,Xt=ct;for(se.global||(se=bd(se.source,Qr(ge.exec(se))+"g")),se.lastIndex=0;qt=se.exec(Xt);)var rn=qt.index;ct=ct.slice(0,rn===t?Je:rn)}}else if(g.indexOf(au(se),Je)!=Je){var Xn=ct.lastIndexOf(se);Xn>-1&&(ct=ct.slice(0,Xn))}return ct+X}function Lb(g){return g=Qr(g),g&&Rl.test(g)?g.replace(ro,oo):g}var wI=Pp(function(g,E,R){return g+(R?" ":"")+E.toUpperCase()}),Yg=hx("toUpperCase");function Pb(g,E,R){return g=Qr(g),E=R?t:E,E===t?yp(g)?Ks(g):Cu(g):g.match(E)||[]}var Xf=Pi(function(g,E){try{return jo(g,t,E)}catch(R){return Ty(R)?R:new Ii(R)}}),Rb=ku(function(g,E){return Aa(E,function(R){R=lh(R),v(g,R,C0(g[R],g))}),g});function Db(g){var E=g==null?0:g.length,R=Ti();return g=E?zr(g,function(X){if(typeof X[1]!="function")throw new $i(h);return[R(X[0]),X[1]]}):[],Pi(function(X){for(var se=-1;++se<E;){var ye=g[se];if(jo(ye[0],this,X))return jo(ye[1],this,X)}})}function Dy(g){return N(P(g,C))}function Kg(g){return function(){return g}}function II(g,E){return g==null||g!==g?E:g}var Ob=dx(),Up=dx(!0);function hu(g){return g}function ef(g){return Nr(typeof g=="function"?g:P(g,C))}function TI(g){return Qa(P(g,C))}function Jg(g,E){return ru(g,P(E,C))}var Qg=Pi(function(g,E){return function(R){return pt(R,g,E)}}),$g=Pi(function(g,E){return function(R){return pt(g,R,E)}});function Vp(g,E,R){var X=yo(E),se=De(E,X);R==null&&!(Cs(E)&&(se.length||!X.length))&&(R=E,E=g,g=this,se=De(E,yo(E)));var ye=!(Cs(R)&&"chain"in R)||!!R.chain,Re=$h(g);return Aa(se,function(Je){var ct=E[Je];g[Je]=ct,Re&&(g.prototype[Je]=function(){var qt=this.__chain__;if(ye||qt){var Xt=g(this.__wrapped__),rn=Xt.__actions__=pa(this.__actions__);return rn.push({func:ct,args:arguments,thisArg:g}),Xt.__chain__=qt,Xt}return ct.apply(g,Bl([this.value()],arguments))})}),g}function Oy(){return Us._===this&&(Us._=lm),this}function G0(){}function SI(g){return g=ur(g),Pi(function(E){return ts(E,g)})}var Dm=_m(zr),Ny=_m(lr),CI=_m(Ph);function j0(g){return ey(g)?ac(lh(g)):_s(g)}function Nb(g){return function(E){return g==null?t:qe(g,E)}}var AI=t0(),kb=t0(!0);function q0(){return[]}function ky(){return!1}function MI(){return{}}function Fb(){return""}function LI(){return!0}function PI(g,E){if(g=ur(g),g<1||g>et)return[];var R=Kt,X=Po(g,Kt);E=Ti(E),g-=Kt;for(var se=Rh(X,E);++R<g;)E(R);return se}function Fy(g){return Xi(g)?zr(g,lh):zu(g)?[g]:pa(u0(Qr(g)))}function By(g){var E=++Ya;return Qr(g)+E}var zy=ih(function(g,E){return g+E},0),RI=Vf("ceil"),H0=ih(function(g,E){return g/E},1),W0=Vf("floor");function Vd(g){return g&&g.length?de(g,hu,gt):t}function DI(g,E){return g&&g.length?de(g,Ti(E,2),gt):t}function X0(g){return pp(g,hu)}function Bb(g,E){return pp(g,Ti(E,2))}function Uy(g){return g&&g.length?de(g,hu,Jr):t}function OI(g,E){return g&&g.length?de(g,Ti(E,2),Jr):t}var NI=ih(function(g,E){return g*E},1),kI=Vf("round"),FI=ih(function(g,E){return g-E},0);function Z0(g){return g&&g.length?gp(g,hu):0}function BI(g,E){return g&&g.length?gp(g,Ti(E,2)):0}return he.after=Gg,he.ary=Yx,he.assign=nI,he.assignIn=ub,he.assignInWith=zd,he.assignWith=cb,he.at=hb,he.before=gy,he.bind=C0,he.bindAll=Rb,he.bindKey=_y,he.castArray=Vw,he.chain=b0,he.chunk=xm,he.compact=bm,he.concat=Ng,he.cond=Db,he.conforms=Dy,he.constant=Kg,he.countBy=jx,he.create=hs,he.curry=yy,he.curryRight=jg,he.debounce=Kx,he.defaults=R0,he.defaultsDeep=fb,he.defer=Dw,he.delay=Ow,he.difference=oy,he.differenceBy=wx,he.differenceWith=kg,he.drop=c0,he.dropRight=Ix,he.dropRightWhile=Em,he.dropWhile=Tx,he.fill=h0,he.filter=Bg,he.flatMap=Cw,he.flatMapDeep=Aw,he.flatMapDepth=Mw,he.flatten=Cx,he.flattenDeep=Fg,he.flattenDepth=Ax,he.flip=Nw,he.flow=Ob,he.flowRight=Up,he.fromPairs=Ir,he.functions=sI,he.functionsIn=oI,he.groupBy=I0,he.initial=Qh,he.intersection=uh,he.intersectionBy=Bu,he.intersectionWith=Ra,he.invert=lI,he.invertBy=uI,he.invokeMap=Sm,he.iteratee=ef,he.keyBy=Pw,he.keys=yo,he.keysIn=jl,he.map=js,he.mapKeys=cI,he.mapValues=hI,he.matches=TI,he.matchesProperty=Jg,he.memoize=vy,he.merge=fI,he.mergeWith=Ay,he.method=Qg,he.methodOf=$g,he.mixin=Vp,he.negate=xy,he.nthArg=SI,he.omit=N0,he.omitBy=mb,he.once=by,he.orderBy=dy,he.over=Dm,he.overArgs=kw,he.overEvery=Ny,he.overSome=CI,he.partial=Ey,he.partialRight=zp,he.partition=Wx,he.pick=Uu,he.pickBy=Mm,he.property=j0,he.propertyOf=Nb,he.pull=d0,he.pullAll=p0,he.pullAllBy=m0,he.pullAllWith=fw,he.pullAt=g0,he.range=AI,he.rangeRight=kb,he.rearg=Fw,he.reject=zg,he.remove=Px,he.rest=Bw,he.reverse=_0,he.sampleSize=Zx,he.set=k0,he.setWith=My,he.shuffle=Ug,he.slice=jf,he.sortBy=Rw,he.sortedUniq=Dx,he.sortedUniqBy=pw,he.split=Py,he.spread=zw,he.tail=v0,he.take=mw,he.takeRight=x0,he.takeRightWhile=Ox,he.takeWhile=Nx,he.tap=E0,he.throttle=Jx,he.thru=bc,he.toArray=ma,he.toPairs=gb,he.toPairsIn=F0,he.toPath=Fy,he.toPlainObject=lb,he.transform=_b,he.unary=Qx,he.union=Fp,he.unionBy=kx,he.unionWith=gw,he.uniq=Im,he.uniqBy=cy,he.uniqWith=Fx,he.unset=dI,he.unzip=hy,he.unzipWith=Bx,he.update=yb,he.updateWith=vb,he.values=Ud,he.valuesIn=xb,he.without=_w,he.words=Pb,he.wrap=Uw,he.xor=zx,he.xorBy=yw,he.xorWith=Ux,he.zip=vw,he.zipObject=xw,he.zipObjectDeep=Vx,he.zipWith=Gx,he.entries=gb,he.entriesIn=F0,he.extend=ub,he.extendWith=zd,Vp(he,he),he.add=zy,he.attempt=Xf,he.camelCase=Eb,he.capitalize=B0,he.ceil=RI,he.clamp=pI,he.clone=Gw,he.cloneDeep=wy,he.cloneDeepWith=Iy,he.cloneWith=A0,he.conformsTo=jw,he.deburr=z0,he.defaultTo=II,he.divide=H0,he.endsWith=wb,he.eq=ch,he.escape=mI,he.escapeRegExp=gI,he.every=Bp,he.find=Tw,he.findIndex=f0,he.findKey=db,he.findLast=Sw,he.findLastIndex=Sx,he.findLastKey=Hf,he.floor=W0,he.forEach=qx,he.forEachRight=Hx,he.forIn=Am,he.forInRight=pb,he.forOwn=iI,he.forOwnRight=rI,he.get=D0,he.gt=qg,he.gte=Hg,he.has=aI,he.hasIn=O0,he.head=ay,he.identity=hu,he.includes=Lw,he.indexOf=Jh,he.inRange=bb,he.invoke=Cy,he.isArguments=kd,he.isArray=Xi,he.isArrayBuffer=$x,he.isArrayLike=cu,he.isArrayLikeObject=Do,he.isBoolean=eb,he.isBuffer=qf,he.isDate=tb,he.isElement=nb,he.isEmpty=ib,he.isEqual=qw,he.isEqualWith=Hw,he.isError=Ty,he.isFinite=Sy,he.isFunction=$h,he.isInteger=nl,he.isLength=Fd,he.isMap=M0,he.isMatch=rb,he.isMatchWith=Ww,he.isNaN=Xw,he.isNative=Zw,he.isNil=Kw,he.isNull=Yw,he.isNumber=sb,he.isObject=Cs,he.isObjectLike=qs,he.isPlainObject=Bd,he.isRegExp=L0,he.isSafeInteger=ob,he.isSet=P0,he.isString=Wg,he.isSymbol=zu,he.isTypedArray=Cm,he.isUndefined=Jw,he.isWeakMap=Qw,he.isWeakSet=$w,he.join=Mx,he.kebabCase=Ib,he.last=Es,he.lastIndexOf=Lx,he.lowerCase=Tb,he.lowerFirst=Zg,he.lt=ab,he.lte=eI,he.max=Vd,he.maxBy=DI,he.mean=X0,he.meanBy=Bb,he.min=Uy,he.minBy=OI,he.stubArray=q0,he.stubFalse=ky,he.stubObject=MI,he.stubString=Fb,he.stubTrue=LI,he.multiply=NI,he.nth=wm,he.noConflict=Oy,he.noop=G0,he.now=Vg,he.pad=Sb,he.padEnd=Cb,he.padStart=U0,he.parseInt=Pm,he.random=Wf,he.reduce=py,he.reduceRight=my,he.repeat=Ab,he.replace=Ly,he.result=Lm,he.round=kI,he.runInContext=it,he.sample=Xx,he.size=T0,he.snakeCase=Mb,he.some=S0,he.sortedIndex=kp,he.sortedIndexBy=ly,he.sortedIndexOf=uy,he.sortedLastIndex=y0,he.sortedLastIndexBy=Rx,he.sortedLastIndexOf=dw,he.startCase=Ry,he.startsWith=_I,he.subtract=FI,he.sum=Z0,he.sumBy=BI,he.template=yI,he.times=PI,he.toFinite=Da,he.toInteger=ur,he.toLength=Xg,he.toLower=vI,he.toNumber=il,he.toSafeInteger=tI,he.toString=Qr,he.toUpper=xI,he.trim=bI,he.trimEnd=Rm,he.trimStart=V0,he.truncate=EI,he.unescape=Lb,he.uniqueId=By,he.upperCase=wI,he.upperFirst=Yg,he.each=qx,he.eachRight=Hx,he.first=ay,Vp(he,function(){var g={};return Se(he,function(E,R){er.call(he.prototype,R)||(g[R]=E)}),g}(),{chain:!1}),he.VERSION=i,Aa(["bind","bindKey","curry","curryRight","partial","partialRight"],function(g){he[g].placeholder=he}),Aa(["drop","take"],function(g,E){Li.prototype[g]=function(R){R=R===t?1:lo(ur(R),0);var X=this.__filtered__&&!E?new Li(this):this.clone();return X.__filtered__?X.__takeCount__=Po(R,X.__takeCount__):X.__views__.push({size:Po(R,Kt),type:g+(X.__dir__<0?"Right":"")}),X},Li.prototype[g+"Right"]=function(R){return this.reverse()[g](R).reverse()}}),Aa(["filter","map","takeWhile"],function(g,E){var R=E+1,X=R==Le||R==zt;Li.prototype[g]=function(se){var ye=this.clone();return ye.__iteratees__.push({iteratee:Ti(se,3),type:R}),ye.__filtered__=ye.__filtered__||X,ye}}),Aa(["head","last"],function(g,E){var R="take"+(E?"Right":"");Li.prototype[g]=function(){return this[R](1).value()[0]}}),Aa(["initial","tail"],function(g,E){var R="drop"+(E?"":"Right");Li.prototype[g]=function(){return this.__filtered__?new Li(this):this[R](1)}}),Li.prototype.compact=function(){return this.filter(hu)},Li.prototype.find=function(g){return this.filter(g).head()},Li.prototype.findLast=function(g){return this.reverse().find(g)},Li.prototype.invokeMap=Pi(function(g,E){return typeof g=="function"?new Li(this):this.map(function(R){return pt(R,g,E)})}),Li.prototype.reject=function(g){return this.filter(xy(Ti(g)))},Li.prototype.slice=function(g,E){g=ur(g);var R=this;return R.__filtered__&&(g>0||E<0)?new Li(R):(g<0?R=R.takeRight(-g):g&&(R=R.drop(g)),E!==t&&(E=ur(E),R=E<0?R.dropRight(-E):R.take(E-g)),R)},Li.prototype.takeRightWhile=function(g){return this.reverse().takeWhile(g).reverse()},Li.prototype.toArray=function(){return this.take(Kt)},Se(Li.prototype,function(g,E){var R=/^(?:filter|find|map|reject)|While$/.test(E),X=/^(?:head|last)$/.test(E),se=he[X?"take"+(E=="last"?"Right":""):E],ye=X||/^find/.test(E);se&&(he.prototype[E]=function(){var Re=this.__wrapped__,Je=X?[1]:arguments,ct=Re instanceof Li,qt=Je[0],Xt=ct||Xi(Re),rn=function(Rr){var Vr=se.apply(he,Bl([Rr],Je));return X&&Xn?Vr[0]:Vr};Xt&&R&&typeof qt=="function"&&qt.length!=1&&(ct=Xt=!1);var Xn=this.__chain__,pi=!!this.__actions__.length,Ni=ye&&!Xn,fr=ct&&!pi;if(!ye&&Xt){Re=fr?Re:new Li(this);var Bi=g.apply(Re,Je);return Bi.__actions__.push({func:bc,args:[rn],thisArg:t}),new Ja(Bi,Xn)}return Ni&&fr?g.apply(this,Je):(Bi=this.thru(rn),Ni?X?Bi.value()[0]:Bi.value():Bi)})}),Aa(["pop","push","shift","sort","splice","unshift"],function(g){var E=Du[g],R=/^(?:push|sort|unshift)$/.test(g)?"tap":"thru",X=/^(?:pop|shift)$/.test(g);he.prototype[g]=function(){var se=arguments;if(X&&!this.__chain__){var ye=this.value();return E.apply(Xi(ye)?ye:[],se)}return this[R](function(Re){return E.apply(Xi(Re)?Re:[],se)})}}),Se(Li.prototype,function(g,E){var R=he[E];if(R){var X=R.name+"";er.call(kf,X)||(kf[X]=[]),kf[X].push({name:E,func:R})}}),kf[Gs(t,q).name]=[{name:"wrapper",func:t}],Li.prototype.clone=Yv,Li.prototype.reverse=O_,Li.prototype.value=Kv,he.prototype.at=uu,he.prototype.chain=bw,he.prototype.commit=w0,he.prototype.next=Ew,he.prototype.plant=Iw,he.prototype.reverse=Tm,he.prototype.toJSON=he.prototype.valueOf=he.prototype.value=fy,he.prototype.first=he.prototype.head,Ou&&(he.prototype[Ou]=ww),he},go=Vl();us?((us.exports=go)._=go,Fl._=go):Us._=go}).call(Kf)})(RP,fv);const rd=fv;function oM(n){return JT(n)||QT(n)||aM(n)||lM(n)||Mc(n)||Jf(n)||V1(n)}function JT(n){return n.type==="Point"}function QT(n){return n.type==="MultiPoint"}function aM(n){return n.type==="LineString"}function lM(n){return n.type==="MultiLineString"}function Mc(n){return n.type==="Polygon"}function Jf(n){return n.type==="MultiPolygon"}function Vv(n){return n.type==="Feature"}function ug(n){return n.type==="FeatureCollection"}function V1(n){return n.type==="GeometryCollection"}function uM(n){if(n&&typeof n=="object"){if(n.type==="FeatureCollection"&&Array.isArray(n.features))return n.features.every(e=>e&&typeof e=="object"&&e.type==="Feature"&&e.geometry&&typeof e.geometry=="object");if(n.type==="Feature"&&n.geometry&&typeof n.geometry=="object")return!0;if(n.type&&typeof n.type=="string"&&n.geometry&&typeof n.geometry=="object")return!0;if(n.type&&typeof n.type=="string"&&n.geometries&&Array.isArray(n.geometries))return!0;if(OP(n.type)&&n.coordinates)return!0}return!1}function cM(n,e){return n.type==="Point"?{...n,coordinates:e.forward(n.coordinates)}:n.type==="LineString"||n.type==="MultiPoint"?{...n,coordinates:n.coordinates.map(e.forward)}:n.type==="Polygon"||n.type==="MultiLineString"?{...n,coordinates:n.coordinates.map(t=>t.map(e.forward))}:n.type==="MultiPolygon"?{...n,coordinates:n.coordinates.map(t=>t.map(i=>i.map(e.forward)))}:n.type==="GeometryCollection"?{...n,geometries:n.geometries.map(t=>cM(t,e))}:n}const DP=()=>(...n)=>n;function OP(n){return DP()("Feature","FeatureCollection","GeometryCollection","LineString","MultiLineString","MultiPoint","MultiPolygon","Point","Polygon").some(t=>n===t)}function UE(n){if(n===void 0||fv.isString(n))throw new Error("Invalid data");return n.map(e=>ug(e)?e.features.every(t=>Mc(t.geometry)||Jf(t.geometry))?{type:"MultiPolygon",coordinates:e.features.flatMap(t=>Jf(t.geometry)?t.geometry.coordinates:Mc(t.geometry)?[t.geometry.coordinates]:[])}:null:Vv(e)?e.geometry:V1(e)?e.geometries.every(t=>Mc(t)||Jf(t))?{type:"MultiPolygon",coordinates:e.geometries.flatMap(t=>Jf(t)?t.coordinates:Mc(t)?[t.coordinates]:[])}:null:Mc(e)||Jf(e)?e:null)}function NP(){const{subscribe:n,set:e,update:t}=Xm([]),{subscribe:i,set:r}=Xm();return{subscribe:n,set:e,update:t,add:a=>t(h=>[a,...h]),getUniqueLayerId:a=>{const h=Xp(bo);if(h.map(s=>s.id).includes(a.id)){const s=h.map(p=>p.id).filter(p=>p.startsWith(a.id)).length;a.id+=`_${s}`,a.displayName+=`_${s}`}return a},setNewLayerIndex:r,subscribeNewLayerIndex:i,toggleVisibility:a=>t(h=>{const s=h.find(p=>p.id===a);if(!s)throw new Error("Invalid layer id");return s.isVisible=!s.isVisible,h}),deleteLayer:a=>t(h=>h.filter(s=>s.id!==a))}}const bo=NP(),iC=["#FF5733","#F2BE22","#17BEBB","#7B68EE","#FF8C00","#00BFFF","#9932CC","#2E8B57","#FF1493","#8B4513"];let kP=0;const $T=()=>iC[kP++%iC.length];function FP(n){return typeof n=="string"}function C_(n){return n!==void 0&&!FP(n)}function eS(n,e,t){const i=e.geojson.data;if(!C_(i))throw new Error("Invalid data source");switch(i.type){case"Point":case"MultiPoint":tS(n,i,e.id,t);break;case"LineString":case"MultiLineString":nS(n,i,e.id,t);break;case"Polygon":case"MultiPolygon":iS(n,i,e.id,t);break;case"Feature":BP(n,e,t);break;case"GeometryCollection":zP(n,e,t);break;case"FeatureCollection":UP(n,e,t);break}}function tS(n,e,t,i){let r={id:Uv.getUniqueSourceId(t+"-point"),type:"circle",source:{type:"geojson",data:e,generateId:!0},paint:{"circle-color":$T()},isVisible:!0,displayName:t,...i};r=bo.getUniqueLayerId(r),bo.add(r),n.addLayer(r)}function nS(n,e,t,i){let r={id:Uv.getUniqueSourceId(t+"-line"),type:"line",source:{type:"geojson",data:e,generateId:!0},paint:{"line-color":$T()},isVisible:!0,displayName:t,...i};r=bo.getUniqueLayerId(r),bo.add(r),n.addLayer(r)}function iS(n,e,t,i){let r={id:Uv.getUniqueSourceId(t+"-polygon"),type:"fill",source:{type:"geojson",data:e,generateId:!0},paint:{"fill-color":$T(),"fill-opacity":.5,"fill-outline-color":"#000"},isVisible:!0,displayName:t,...i};r=bo.getUniqueLayerId(r),bo.add(r),n.addLayer(r)}function BP(n,e,t){const i=e.geojson.data;if(!C_(i)||!Vv(i))throw new Error("Not a Feature");eS(n,{...e,geojson:{type:"geojson",data:i.geometry}},t)}function zP(n,e,t){const i=e.geojson.data;if(!C_(i)||!V1(i))throw new Error("Not a GeometryCollection");const r=rd.groupBy(i.geometries,a=>{switch(a.type){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"GeometryCollection":throw new Error("Invalid structure")}});rd.forEach(r,(a,h)=>{const s={type:"GeometryCollection",geometries:a};switch(h){case"Point":tS(n,s,e.id,t);break;case"LineString":nS(n,s,e.id,t);break;case"Polygon":iS(n,s,e.id,t);break}})}function UP(n,e,t){const i=e.geojson.data;if(!C_(i)||!ug(i))throw new Error("Not a FeaureCollection");const r=rd.groupBy(i.features,a=>{switch(a.geometry.type){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"GeometryCollection":throw new Error("Invalid structure")}});rd.forEach(r,(a,h)=>{const s={type:"FeatureCollection",features:a};switch(h){case"Point":tS(n,s,e.id,t);break;case"LineString":nS(n,s,e.id,t);break;case"Polygon":iS(n,s,e.id,t);break}})}var bT=function(n,e){return bT=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},bT(n,e)};function Eh(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");bT(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ks=function(){return ks=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},ks.apply(this,arguments)};function Xl(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function rC(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var i=t.call(n),r,a=[],h;try{for(;(e===void 0||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(s){h={error:s}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(h)throw h.error}}return a}function VP(n,e,t){if(t||arguments.length===2)for(var i=0,r=e.length,a;i<r;i++)(a||!(i in e))&&(a||(a=Array.prototype.slice.call(e,0,i)),a[i]=e[i]);return n.concat(a||Array.prototype.slice.call(e))}/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var wh=function(){function n(e){e===void 0&&(e={}),this.adapter=e}return Object.defineProperty(n,"cssClasses",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(n,"strings",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(n,"numbers",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(n,"defaultAdapter",{get:function(){return{}},enumerable:!1,configurable:!0}),n.prototype.init=function(){},n.prototype.destroy=function(){},n}();/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Lc;(function(n){n.RICH="mdc-tooltip--rich",n.SHOWN="mdc-tooltip--shown",n.SHOWING="mdc-tooltip--showing",n.SHOWING_TRANSITION="mdc-tooltip--showing-transition",n.HIDE="mdc-tooltip--hide",n.HIDE_TRANSITION="mdc-tooltip--hide-transition",n.MULTILINE_TOOLTIP="mdc-tooltip--multiline",n.SURFACE="mdc-tooltip__surface",n.SURFACE_ANIMATION="mdc-tooltip__surface-animation",n.TOOLTIP_CARET_TOP="mdc-tooltip__caret-surface-top",n.TOOLTIP_CARET_BOTTOM="mdc-tooltip__caret-surface-bottom"})(Lc||(Lc={}));var Vu={BOUNDED_ANCHOR_GAP:4,UNBOUNDED_ANCHOR_GAP:8,MIN_VIEWPORT_TOOLTIP_THRESHOLD:8,HIDE_DELAY_MS:600,SHOW_DELAY_MS:500,MIN_HEIGHT:24,MAX_WIDTH:200,CARET_INDENTATION:24,ANIMATION_SCALE:.8},Vb={ARIA_EXPANDED:"aria-expanded",ARIA_HASPOPUP:"aria-haspopup",PERSISTENT:"data-mdc-tooltip-persistent",SCROLLABLE_ANCESTOR:"tooltip-scrollable-ancestor",HAS_CARET:"data-mdc-tooltip-has-caret"},a_;(function(n){n[n.DETECTED=0]="DETECTED",n[n.START=1]="START",n[n.CENTER=2]="CENTER",n[n.END=3]="END"})(a_||(a_={}));var nv;(function(n){n[n.DETECTED=0]="DETECTED",n[n.ABOVE=1]="ABOVE",n[n.BELOW=2]="BELOW"})(nv||(nv={}));var pE;(function(n){n[n.BOUNDED=0]="BOUNDED",n[n.UNBOUNDED=1]="UNBOUNDED"})(pE||(pE={}));var Ui={LEFT:"left",RIGHT:"right",CENTER:"center",TOP:"top",BOTTOM:"bottom"},Dr;(function(n){n[n.DETECTED=0]="DETECTED",n[n.ABOVE_START=1]="ABOVE_START",n[n.ABOVE_CENTER=2]="ABOVE_CENTER",n[n.ABOVE_END=3]="ABOVE_END",n[n.TOP_SIDE_START=4]="TOP_SIDE_START",n[n.CENTER_SIDE_START=5]="CENTER_SIDE_START",n[n.BOTTOM_SIDE_START=6]="BOTTOM_SIDE_START",n[n.TOP_SIDE_END=7]="TOP_SIDE_END",n[n.CENTER_SIDE_END=8]="CENTER_SIDE_END",n[n.BOTTOM_SIDE_END=9]="BOTTOM_SIDE_END",n[n.BELOW_START=10]="BELOW_START",n[n.BELOW_CENTER=11]="BELOW_CENTER",n[n.BELOW_END=12]="BELOW_END"})(Dr||(Dr={}));var ll;(function(n){n[n.ABOVE=1]="ABOVE",n[n.BELOW=2]="BELOW",n[n.SIDE_TOP=3]="SIDE_TOP",n[n.SIDE_CENTER=4]="SIDE_CENTER",n[n.SIDE_BOTTOM=5]="SIDE_BOTTOM"})(ll||(ll={}));var ns;(function(n){n[n.START=1]="START",n[n.CENTER=2]="CENTER",n[n.END=3]="END",n[n.SIDE_START=4]="SIDE_START",n[n.SIDE_END=5]="SIDE_END"})(ns||(ns={}));/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var hM=function(){function n(){this.rafIDs=new Map}return n.prototype.request=function(e,t){var i=this;this.cancel(e);var r=requestAnimationFrame(function(a){i.rafIDs.delete(e),t(a)});this.rafIDs.set(e,r)},n.prototype.cancel=function(e){var t=this.rafIDs.get(e);t&&(cancelAnimationFrame(t),this.rafIDs.delete(e))},n.prototype.cancelAll=function(){var e=this;this.rafIDs.forEach(function(t,i){e.cancel(i)})},n.prototype.getQueue=function(){var e=[];return this.rafIDs.forEach(function(t,i){e.push(i)}),e},n}();/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var sC={animation:{prefixed:"-webkit-animation",standard:"animation"},transform:{prefixed:"-webkit-transform",standard:"transform"},transition:{prefixed:"-webkit-transition",standard:"transition"}};function GP(n){return!!n.document&&typeof n.document.createElement=="function"}function mE(n,e){if(GP(n)&&e in sC){var t=n.document.createElement("div"),i=sC[e],r=i.standard,a=i.prefixed,h=r in t.style;return h?r:a}return e}/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var br={UNKNOWN:"Unknown",BACKSPACE:"Backspace",ENTER:"Enter",SPACEBAR:"Spacebar",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",END:"End",HOME:"Home",ARROW_LEFT:"ArrowLeft",ARROW_UP:"ArrowUp",ARROW_RIGHT:"ArrowRight",ARROW_DOWN:"ArrowDown",DELETE:"Delete",ESCAPE:"Escape",TAB:"Tab"},tc=new Set;tc.add(br.BACKSPACE);tc.add(br.ENTER);tc.add(br.SPACEBAR);tc.add(br.PAGE_UP);tc.add(br.PAGE_DOWN);tc.add(br.END);tc.add(br.HOME);tc.add(br.ARROW_LEFT);tc.add(br.ARROW_UP);tc.add(br.ARROW_RIGHT);tc.add(br.ARROW_DOWN);tc.add(br.DELETE);tc.add(br.ESCAPE);tc.add(br.TAB);var Bc={BACKSPACE:8,ENTER:13,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46,ESCAPE:27,TAB:9},nc=new Map;nc.set(Bc.BACKSPACE,br.BACKSPACE);nc.set(Bc.ENTER,br.ENTER);nc.set(Bc.SPACEBAR,br.SPACEBAR);nc.set(Bc.PAGE_UP,br.PAGE_UP);nc.set(Bc.PAGE_DOWN,br.PAGE_DOWN);nc.set(Bc.END,br.END);nc.set(Bc.HOME,br.HOME);nc.set(Bc.ARROW_LEFT,br.ARROW_LEFT);nc.set(Bc.ARROW_UP,br.ARROW_UP);nc.set(Bc.ARROW_RIGHT,br.ARROW_RIGHT);nc.set(Bc.ARROW_DOWN,br.ARROW_DOWN);nc.set(Bc.DELETE,br.DELETE);nc.set(Bc.ESCAPE,br.ESCAPE);nc.set(Bc.TAB,br.TAB);var cg=new Set;cg.add(br.PAGE_UP);cg.add(br.PAGE_DOWN);cg.add(br.END);cg.add(br.HOME);cg.add(br.ARROW_LEFT);cg.add(br.ARROW_UP);cg.add(br.ARROW_RIGHT);cg.add(br.ARROW_DOWN);function va(n){var e=n.key;if(tc.has(e))return e;var t=nc.get(n.keyCode);return t||br.UNKNOWN}/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var jP=Lc.RICH,JI=Lc.SHOWN,QI=Lc.SHOWING,Gb=Lc.SHOWING_TRANSITION,e1=Lc.HIDE,jb=Lc.HIDE_TRANSITION,qP=Lc.MULTILINE_TOOLTIP,ET;(function(n){n.POLL_ANCHOR="poll_anchor"})(ET||(ET={}));var oC=typeof window<"u",HP=function(n){Eh(e,n);function e(t){var i=n.call(this,ks(ks({},e.defaultAdapter),t))||this;return i.tooltipShown=!1,i.anchorGap=Vu.BOUNDED_ANCHOR_GAP,i.xTooltipPos=a_.DETECTED,i.yTooltipPos=nv.DETECTED,i.tooltipPositionWithCaret=Dr.DETECTED,i.minViewportTooltipThreshold=Vu.MIN_VIEWPORT_TOOLTIP_THRESHOLD,i.hideDelayMs=Vu.HIDE_DELAY_MS,i.showDelayMs=Vu.SHOW_DELAY_MS,i.anchorRect=null,i.parentRect=null,i.frameId=null,i.hideTimeout=null,i.showTimeout=null,i.addAncestorScrollEventListeners=new Array,i.removeAncestorScrollEventListeners=new Array,i.animFrame=new hM,i.anchorBlurHandler=function(r){i.handleAnchorBlur(r)},i.documentClickHandler=function(r){i.handleDocumentClick(r)},i.documentKeydownHandler=function(r){i.handleKeydown(r)},i.tooltipMouseEnterHandler=function(){i.handleTooltipMouseEnter()},i.tooltipMouseLeaveHandler=function(){i.handleTooltipMouseLeave()},i.richTooltipFocusOutHandler=function(r){i.handleRichTooltipFocusOut(r)},i.windowScrollHandler=function(){i.handleWindowScrollEvent()},i.windowResizeHandler=function(){i.handleWindowChangeEvent()},i}return Object.defineProperty(e,"defaultAdapter",{get:function(){return{getAttribute:function(){return null},setAttribute:function(){},removeAttribute:function(){},addClass:function(){},hasClass:function(){return!1},removeClass:function(){},getComputedStyleProperty:function(){return""},setStyleProperty:function(){},setSurfaceAnimationStyleProperty:function(){},getViewportWidth:function(){return 0},getViewportHeight:function(){return 0},getTooltipSize:function(){return{width:0,height:0}},getAnchorBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},getParentBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},getAnchorAttribute:function(){return null},setAnchorAttribute:function(){return null},isRTL:function(){return!1},anchorContainsElement:function(){return!1},tooltipContainsElement:function(){return!1},focusAnchorElement:function(){},registerEventHandler:function(){},deregisterEventHandler:function(){},registerAnchorEventHandler:function(){},deregisterAnchorEventHandler:function(){},registerDocumentEventHandler:function(){},deregisterDocumentEventHandler:function(){},registerWindowEventHandler:function(){},deregisterWindowEventHandler:function(){},notifyHidden:function(){},getTooltipCaretBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},setTooltipCaretStyle:function(){},clearTooltipCaretStyles:function(){},getActiveElement:function(){return null}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){this.richTooltip=this.adapter.hasClass(jP),this.persistentTooltip=this.adapter.getAttribute(Vb.PERSISTENT)==="true",this.interactiveTooltip=!!this.adapter.getAnchorAttribute(Vb.ARIA_EXPANDED)&&this.adapter.getAnchorAttribute(Vb.ARIA_HASPOPUP)==="dialog",this.hasCaret=this.richTooltip&&this.adapter.getAttribute(Vb.HAS_CARET)==="true"},e.prototype.isShown=function(){return this.tooltipShown},e.prototype.isRich=function(){return this.richTooltip},e.prototype.isPersistent=function(){return this.persistentTooltip},e.prototype.handleAnchorMouseEnter=function(){var t=this;this.tooltipShown?this.show():(this.clearHideTimeout(),this.showTimeout=setTimeout(function(){t.show()},this.showDelayMs))},e.prototype.handleAnchorTouchstart=function(){var t=this;this.showTimeout=setTimeout(function(){t.show()},this.showDelayMs),this.adapter.registerWindowEventHandler("contextmenu",this.preventContextMenuOnLongTouch)},e.prototype.preventContextMenuOnLongTouch=function(t){t.preventDefault()},e.prototype.handleAnchorTouchend=function(){this.clearShowTimeout(),this.isShown()||this.adapter.deregisterWindowEventHandler("contextmenu",this.preventContextMenuOnLongTouch)},e.prototype.handleAnchorFocus=function(t){var i=this,r=t.relatedTarget,a=r instanceof HTMLElement&&this.adapter.tooltipContainsElement(r);a||(this.showTimeout=setTimeout(function(){i.show()},this.showDelayMs))},e.prototype.handleAnchorMouseLeave=function(){var t=this;this.clearShowTimeout(),this.hideTimeout=setTimeout(function(){t.hide()},this.hideDelayMs)},e.prototype.handleAnchorClick=function(){this.tooltipShown?this.hide():this.show()},e.prototype.handleDocumentClick=function(t){var i=t.target instanceof HTMLElement&&(this.adapter.anchorContainsElement(t.target)||this.adapter.tooltipContainsElement(t.target));this.richTooltip&&this.persistentTooltip&&i||this.hide()},e.prototype.handleKeydown=function(t){var i=va(t);if(i===br.ESCAPE){var r=this.adapter.getActiveElement(),a=r instanceof HTMLElement&&this.adapter.tooltipContainsElement(r);a&&this.adapter.focusAnchorElement(),this.hide()}},e.prototype.handleAnchorBlur=function(t){if(this.richTooltip){var i=t.relatedTarget instanceof HTMLElement&&this.adapter.tooltipContainsElement(t.relatedTarget);if(i||t.relatedTarget===null&&this.interactiveTooltip)return}this.hide()},e.prototype.handleTooltipMouseEnter=function(){this.show()},e.prototype.handleTooltipMouseLeave=function(){var t=this;this.clearShowTimeout(),this.hideTimeout=setTimeout(function(){t.hide()},this.hideDelayMs)},e.prototype.handleRichTooltipFocusOut=function(t){var i=t.relatedTarget instanceof HTMLElement&&(this.adapter.anchorContainsElement(t.relatedTarget)||this.adapter.tooltipContainsElement(t.relatedTarget));i||t.relatedTarget===null&&this.interactiveTooltip||this.hide()},e.prototype.handleWindowScrollEvent=function(){if(this.persistentTooltip){this.handleWindowChangeEvent();return}this.hide()},e.prototype.handleWindowChangeEvent=function(){var t=this;this.animFrame.request(ET.POLL_ANCHOR,function(){t.repositionTooltipOnAnchorMove()})},e.prototype.show=function(){var t,i,r=this;if(this.clearHideTimeout(),this.clearShowTimeout(),!this.tooltipShown){this.tooltipShown=!0,this.adapter.removeAttribute("aria-hidden"),this.richTooltip&&(this.interactiveTooltip&&this.adapter.setAnchorAttribute("aria-expanded","true"),this.adapter.registerEventHandler("focusout",this.richTooltipFocusOutHandler)),this.persistentTooltip||(this.adapter.registerEventHandler("mouseenter",this.tooltipMouseEnterHandler),this.adapter.registerEventHandler("mouseleave",this.tooltipMouseLeaveHandler)),this.adapter.removeClass(e1),this.adapter.addClass(QI),this.isTooltipMultiline()&&!this.richTooltip&&this.adapter.addClass(qP),this.anchorRect=this.adapter.getAnchorBoundingRect(),this.parentRect=this.adapter.getParentBoundingRect(),this.richTooltip?this.positionRichTooltip():this.positionPlainTooltip(),this.adapter.registerAnchorEventHandler("blur",this.anchorBlurHandler),this.adapter.registerDocumentEventHandler("click",this.documentClickHandler),this.adapter.registerDocumentEventHandler("keydown",this.documentKeydownHandler),this.adapter.registerWindowEventHandler("scroll",this.windowScrollHandler),this.adapter.registerWindowEventHandler("resize",this.windowResizeHandler);try{for(var a=Xl(this.addAncestorScrollEventListeners),h=a.next();!h.done;h=a.next()){var s=h.value;s()}}catch(p){t={error:p}}finally{try{h&&!h.done&&(i=a.return)&&i.call(a)}finally{if(t)throw t.error}}this.frameId=requestAnimationFrame(function(){r.clearAllAnimationClasses(),r.adapter.addClass(JI),r.adapter.addClass(Gb)})}},e.prototype.hide=function(){var t,i;if(this.clearHideTimeout(),this.clearShowTimeout(),!!this.tooltipShown){this.frameId&&cancelAnimationFrame(this.frameId),this.tooltipShown=!1,this.adapter.setAttribute("aria-hidden","true"),this.adapter.deregisterEventHandler("focusout",this.richTooltipFocusOutHandler),this.richTooltip&&this.interactiveTooltip&&this.adapter.setAnchorAttribute("aria-expanded","false"),this.persistentTooltip||(this.adapter.deregisterEventHandler("mouseenter",this.tooltipMouseEnterHandler),this.adapter.deregisterEventHandler("mouseleave",this.tooltipMouseLeaveHandler)),this.clearAllAnimationClasses(),this.adapter.addClass(e1),this.adapter.addClass(jb),this.adapter.removeClass(JI),this.adapter.deregisterAnchorEventHandler("blur",this.anchorBlurHandler),this.adapter.deregisterDocumentEventHandler("click",this.documentClickHandler),this.adapter.deregisterDocumentEventHandler("keydown",this.documentKeydownHandler),this.adapter.deregisterWindowEventHandler("scroll",this.windowScrollHandler),this.adapter.deregisterWindowEventHandler("resize",this.windowResizeHandler),this.adapter.deregisterWindowEventHandler("contextmenu",this.preventContextMenuOnLongTouch);try{for(var r=Xl(this.removeAncestorScrollEventListeners),a=r.next();!a.done;a=r.next()){var h=a.value;h()}}catch(s){t={error:s}}finally{try{a&&!a.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}}},e.prototype.handleTransitionEnd=function(){var t=this.adapter.hasClass(e1);this.adapter.removeClass(QI),this.adapter.removeClass(Gb),this.adapter.removeClass(e1),this.adapter.removeClass(jb),t&&this.showTimeout===null&&this.adapter.notifyHidden()},e.prototype.clearAllAnimationClasses=function(){this.adapter.removeClass(Gb),this.adapter.removeClass(jb)},e.prototype.setTooltipPosition=function(t){var i=t.xPos,r=t.yPos,a=t.withCaretPos;if(this.hasCaret&&a){this.tooltipPositionWithCaret=a;return}i&&(this.xTooltipPos=i),r&&(this.yTooltipPos=r)},e.prototype.setAnchorBoundaryType=function(t){t===pE.UNBOUNDED?this.anchorGap=Vu.UNBOUNDED_ANCHOR_GAP:this.anchorGap=Vu.BOUNDED_ANCHOR_GAP},e.prototype.setShowDelay=function(t){this.showDelayMs=t},e.prototype.setHideDelay=function(t){this.hideDelayMs=t},e.prototype.isTooltipMultiline=function(){var t=this.adapter.getTooltipSize();return t.height>Vu.MIN_HEIGHT&&t.width>=Vu.MAX_WIDTH},e.prototype.positionPlainTooltip=function(){var t=this.calculateTooltipStyles(this.anchorRect),i=t.top,r=t.yTransformOrigin,a=t.left,h=t.xTransformOrigin,s=oC?mE(window,"transform"):"transform";this.adapter.setSurfaceAnimationStyleProperty(s+"-origin",h+" "+r),this.adapter.setStyleProperty("top",i+"px"),this.adapter.setStyleProperty("left",a+"px")},e.prototype.positionRichTooltip=function(){var t,i,r,a,h=this.adapter.getComputedStyleProperty("width");this.adapter.setStyleProperty("width",h);var s=this.hasCaret?this.calculateTooltipWithCaretStyles(this.anchorRect):this.calculateTooltipStyles(this.anchorRect),p=s.top,x=s.yTransformOrigin,I=s.left,C=s.xTransformOrigin,M=oC?mE(window,"transform"):"transform";this.adapter.setSurfaceAnimationStyleProperty(M+"-origin",C+" "+x);var O=I-((i=(t=this.parentRect)===null||t===void 0?void 0:t.left)!==null&&i!==void 0?i:0),k=p-((a=(r=this.parentRect)===null||r===void 0?void 0:r.top)!==null&&a!==void 0?a:0);this.adapter.setStyleProperty("top",k+"px"),this.adapter.setStyleProperty("left",O+"px")},e.prototype.calculateTooltipStyles=function(t){if(!t)return{top:0,left:0};var i=this.adapter.getTooltipSize(),r=this.calculateYTooltipDistance(t,i.height),a=this.calculateXTooltipDistance(t,i.width);return{top:r.distance,yTransformOrigin:r.yTransformOrigin,left:a.distance,xTransformOrigin:a.xTransformOrigin}},e.prototype.calculateXTooltipDistance=function(t,i){var r=!this.adapter.isRTL(),a,h,s,p,x;this.richTooltip?(a=r?t.left-i:t.right,h=r?t.right:t.left-i,p=r?Ui.RIGHT:Ui.LEFT,x=r?Ui.LEFT:Ui.RIGHT):(a=r?t.left:t.right-i,h=r?t.right-i:t.left,s=t.left+(t.width-i)/2,p=r?Ui.LEFT:Ui.RIGHT,x=r?Ui.RIGHT:Ui.LEFT);var I=this.richTooltip?this.determineValidPositionOptions(a,h):this.determineValidPositionOptions(s,a,h);if(this.xTooltipPos===a_.START&&I.has(a))return{distance:a,xTransformOrigin:p};if(this.xTooltipPos===a_.END&&I.has(h))return{distance:h,xTransformOrigin:x};if(this.xTooltipPos===a_.CENTER&&I.has(s))return{distance:s,xTransformOrigin:Ui.CENTER};var C=this.richTooltip?[{distance:h,xTransformOrigin:x},{distance:a,xTransformOrigin:p}]:[{distance:s,xTransformOrigin:Ui.CENTER},{distance:a,xTransformOrigin:p},{distance:h,xTransformOrigin:x}],M=C.find(function(z){var G=z.distance;return I.has(G)});if(M)return M;if(t.left<0)return{distance:this.minViewportTooltipThreshold,xTransformOrigin:Ui.LEFT};var O=this.adapter.getViewportWidth(),k=O-(i+this.minViewportTooltipThreshold);return{distance:k,xTransformOrigin:Ui.RIGHT}},e.prototype.determineValidPositionOptions=function(){for(var t,i,r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];var h=new Set,s=new Set;try{for(var p=Xl(r),x=p.next();!x.done;x=p.next()){var I=x.value;this.positionHonorsViewportThreshold(I)?h.add(I):this.positionDoesntCollideWithViewport(I)&&s.add(I)}}catch(C){t={error:C}}finally{try{x&&!x.done&&(i=p.return)&&i.call(p)}finally{if(t)throw t.error}}return h.size?h:s},e.prototype.positionHonorsViewportThreshold=function(t){var i=this.adapter.getViewportWidth(),r=this.adapter.getTooltipSize().width;return t+r<=i-this.minViewportTooltipThreshold&&t>=this.minViewportTooltipThreshold},e.prototype.positionDoesntCollideWithViewport=function(t){var i=this.adapter.getViewportWidth(),r=this.adapter.getTooltipSize().width;return t+r<=i&&t>=0},e.prototype.calculateYTooltipDistance=function(t,i){var r=t.bottom+this.anchorGap,a=t.top-(this.anchorGap+i),h=this.determineValidYPositionOptions(a,r);return this.yTooltipPos===nv.ABOVE&&h.has(a)?{distance:a,yTransformOrigin:Ui.BOTTOM}:this.yTooltipPos===nv.BELOW&&h.has(r)?{distance:r,yTransformOrigin:Ui.TOP}:h.has(r)?{distance:r,yTransformOrigin:Ui.TOP}:h.has(a)?{distance:a,yTransformOrigin:Ui.BOTTOM}:{distance:r,yTransformOrigin:Ui.TOP}},e.prototype.determineValidYPositionOptions=function(t,i){var r=new Set,a=new Set;return this.yPositionHonorsViewportThreshold(t)?r.add(t):this.yPositionDoesntCollideWithViewport(t)&&a.add(t),this.yPositionHonorsViewportThreshold(i)?r.add(i):this.yPositionDoesntCollideWithViewport(i)&&a.add(i),r.size?r:a},e.prototype.yPositionHonorsViewportThreshold=function(t){var i=this.adapter.getViewportHeight(),r=this.adapter.getTooltipSize().height;return t+r+this.minViewportTooltipThreshold<=i&&t>=this.minViewportTooltipThreshold},e.prototype.yPositionDoesntCollideWithViewport=function(t){var i=this.adapter.getViewportHeight(),r=this.adapter.getTooltipSize().height;return t+r<=i&&t>=0},e.prototype.calculateTooltipWithCaretStyles=function(t){this.adapter.clearTooltipCaretStyles();var i=this.adapter.getTooltipCaretBoundingRect();if(!t||!i)return{position:Dr.DETECTED,top:0,left:0};var r=i.width/Vu.ANIMATION_SCALE,a=i.height/Vu.ANIMATION_SCALE/2,h=this.adapter.getTooltipSize(),s=this.calculateYWithCaretDistanceOptions(t,h.height,{caretWidth:r,caretHeight:a}),p=this.calculateXWithCaretDistanceOptions(t,h.width,{caretWidth:r,caretHeight:a}),x=this.validateTooltipWithCaretDistances(s,p);x.size<1&&(x=this.generateBackupPositionOption(t,h,{caretWidth:r,caretHeight:a}));var I=this.determineTooltipWithCaretDistance(x),C=I.position,M=I.xDistance,O=I.yDistance,k=this.setCaretPositionStyles(C,{caretWidth:r,caretHeight:a}),z=k.yTransformOrigin,G=k.xTransformOrigin;return{yTransformOrigin:z,xTransformOrigin:G,top:O,left:M}},e.prototype.calculateXWithCaretDistanceOptions=function(t,i,r){var a=r.caretWidth,h=r.caretHeight,s=!this.adapter.isRTL(),p=t.left+t.width/2,x=t.left-(i+this.anchorGap+h),I=t.right+this.anchorGap+h,C=s?x:I,M=s?I:x,O=p-(Vu.CARET_INDENTATION+a/2),k=p-(i-Vu.CARET_INDENTATION-a/2),z=s?O:k,G=s?k:O,q=p-i/2,Z=new Map([[ns.START,z],[ns.CENTER,q],[ns.END,G],[ns.SIDE_END,M],[ns.SIDE_START,C]]);return Z},e.prototype.calculateYWithCaretDistanceOptions=function(t,i,r){var a=r.caretWidth,h=r.caretHeight,s=t.top+t.height/2,p=t.bottom+this.anchorGap+h,x=t.top-(this.anchorGap+i+h),I=s-(Vu.CARET_INDENTATION+a/2),C=s-i/2,M=s-(i-Vu.CARET_INDENTATION-a/2),O=new Map([[ll.ABOVE,x],[ll.BELOW,p],[ll.SIDE_TOP,I],[ll.SIDE_CENTER,C],[ll.SIDE_BOTTOM,M]]);return O},e.prototype.repositionTooltipOnAnchorMove=function(){var t=this.adapter.getAnchorBoundingRect();!t||!this.anchorRect||(t.top!==this.anchorRect.top||t.left!==this.anchorRect.left||t.height!==this.anchorRect.height||t.width!==this.anchorRect.width)&&(this.anchorRect=t,this.parentRect=this.adapter.getParentBoundingRect(),this.richTooltip?this.positionRichTooltip():this.positionPlainTooltip())},e.prototype.validateTooltipWithCaretDistances=function(t,i){var r,a,h,s,p,x,I=new Map,C=new Map,M=new Map([[ll.ABOVE,[ns.START,ns.CENTER,ns.END]],[ll.BELOW,[ns.START,ns.CENTER,ns.END]],[ll.SIDE_TOP,[ns.SIDE_START,ns.SIDE_END]],[ll.SIDE_CENTER,[ns.SIDE_START,ns.SIDE_END]],[ll.SIDE_BOTTOM,[ns.SIDE_START,ns.SIDE_END]]]);try{for(var O=Xl(M.keys()),k=O.next();!k.done;k=O.next()){var z=k.value,G=t.get(z);if(this.yPositionHonorsViewportThreshold(G))try{for(var q=(h=void 0,Xl(M.get(z))),Z=q.next();!Z.done;Z=q.next()){var K=Z.value,te=i.get(K);if(this.positionHonorsViewportThreshold(te)){var ie=this.caretPositionOptionsMapping(K,z);I.set(ie,{xDistance:te,yDistance:G})}}}catch(fe){h={error:fe}}finally{try{Z&&!Z.done&&(s=q.return)&&s.call(q)}finally{if(h)throw h.error}}if(this.yPositionDoesntCollideWithViewport(G))try{for(var Te=(p=void 0,Xl(M.get(z))),le=Te.next();!le.done;le=Te.next()){var K=le.value,te=i.get(K);if(this.positionDoesntCollideWithViewport(te)){var ie=this.caretPositionOptionsMapping(K,z);C.set(ie,{xDistance:te,yDistance:G})}}}catch(fe){p={error:fe}}finally{try{le&&!le.done&&(x=Te.return)&&x.call(Te)}finally{if(p)throw p.error}}}}catch(fe){r={error:fe}}finally{try{k&&!k.done&&(a=O.return)&&a.call(O)}finally{if(r)throw r.error}}return I.size?I:C},e.prototype.generateBackupPositionOption=function(t,i,r){var a=!this.adapter.isRTL(),h,s;if(t.left<0)h=this.minViewportTooltipThreshold+r.caretHeight,s=a?ns.END:ns.START;else{var p=this.adapter.getViewportWidth();h=p-(i.width+this.minViewportTooltipThreshold+r.caretHeight),s=a?ns.START:ns.END}var x,I;if(t.top<0)x=this.minViewportTooltipThreshold+r.caretHeight,I=ll.BELOW;else{var C=this.adapter.getViewportHeight();x=C-(i.height+this.minViewportTooltipThreshold+r.caretHeight),I=ll.ABOVE}var M=this.caretPositionOptionsMapping(s,I);return new Map([[M,{xDistance:h,yDistance:x}]])},e.prototype.determineTooltipWithCaretDistance=function(t){if(t.has(this.tooltipPositionWithCaret)){var i=t.get(this.tooltipPositionWithCaret);return{position:this.tooltipPositionWithCaret,xDistance:i.xDistance,yDistance:i.yDistance}}var r=[Dr.ABOVE_START,Dr.ABOVE_CENTER,Dr.ABOVE_END,Dr.TOP_SIDE_START,Dr.CENTER_SIDE_START,Dr.BOTTOM_SIDE_START,Dr.TOP_SIDE_END,Dr.CENTER_SIDE_END,Dr.BOTTOM_SIDE_END,Dr.BELOW_START,Dr.BELOW_CENTER,Dr.BELOW_END],a=r.find(function(s){return t.has(s)}),h=t.get(a);return{position:a,xDistance:h.xDistance,yDistance:h.yDistance}},e.prototype.caretPositionOptionsMapping=function(t,i){switch(i){case ll.ABOVE:if(t===ns.START)return Dr.ABOVE_START;if(t===ns.CENTER)return Dr.ABOVE_CENTER;if(t===ns.END)return Dr.ABOVE_END;break;case ll.BELOW:if(t===ns.START)return Dr.BELOW_START;if(t===ns.CENTER)return Dr.BELOW_CENTER;if(t===ns.END)return Dr.BELOW_END;break;case ll.SIDE_TOP:if(t===ns.SIDE_START)return Dr.TOP_SIDE_START;if(t===ns.SIDE_END)return Dr.TOP_SIDE_END;break;case ll.SIDE_CENTER:if(t===ns.SIDE_START)return Dr.CENTER_SIDE_START;if(t===ns.SIDE_END)return Dr.CENTER_SIDE_END;break;case ll.SIDE_BOTTOM:if(t===ns.SIDE_START)return Dr.BOTTOM_SIDE_START;if(t===ns.SIDE_END)return Dr.BOTTOM_SIDE_END;break}throw new Error("MDCTooltipFoundation: Invalid caret position of "+t+", "+i)},e.prototype.setCaretPositionStyles=function(t,i){var r,a,h=this.calculateCaretPositionOnTooltip(t,i);if(!h)return{yTransformOrigin:0,xTransformOrigin:0};this.adapter.clearTooltipCaretStyles(),this.adapter.setTooltipCaretStyle(h.yAlignment,h.yAxisPx),this.adapter.setTooltipCaretStyle(h.xAlignment,h.xAxisPx);var s=h.skew*(Math.PI/180),p=Math.cos(s);this.adapter.setTooltipCaretStyle("transform","rotate("+h.rotation+"deg) skewY("+h.skew+"deg) scaleX("+p+")"),this.adapter.setTooltipCaretStyle("transform-origin",h.xAlignment+" "+h.yAlignment);try{for(var x=Xl(h.caretCorners),I=x.next();!I.done;I=x.next()){var C=I.value;this.adapter.setTooltipCaretStyle(C,"0")}}catch(M){r={error:M}}finally{try{I&&!I.done&&(a=x.return)&&a.call(x)}finally{if(r)throw r.error}}return{yTransformOrigin:h.yTransformOrigin,xTransformOrigin:h.xTransformOrigin}},e.prototype.calculateCaretPositionOnTooltip=function(t,i){var r=!this.adapter.isRTL(),a=this.adapter.getComputedStyleProperty("width"),h=this.adapter.getComputedStyleProperty("height");if(!(!a||!h||!i)){var s="calc(("+a+" - "+i.caretWidth+"px) / 2)",p="calc(("+h+" - "+i.caretWidth+"px) / 2)",x="0",I=Vu.CARET_INDENTATION+"px",C="calc("+a+" - "+I+")",M="calc("+h+" - "+I+")",O=35,k=Math.abs(90-O),z=["border-bottom-right-radius","border-top-left-radius"],G=["border-bottom-left-radius","border-top-right-radius"],q=20;switch(t){case Dr.BELOW_CENTER:return{yAlignment:Ui.TOP,xAlignment:Ui.LEFT,yAxisPx:x,xAxisPx:s,rotation:-1*O,skew:-1*q,xTransformOrigin:s,yTransformOrigin:x,caretCorners:z};case Dr.BELOW_END:return{yAlignment:Ui.TOP,xAlignment:r?Ui.RIGHT:Ui.LEFT,yAxisPx:x,xAxisPx:I,rotation:r?O:-1*O,skew:r?q:-1*q,xTransformOrigin:r?C:I,yTransformOrigin:x,caretCorners:r?G:z};case Dr.BELOW_START:return{yAlignment:Ui.TOP,xAlignment:r?Ui.LEFT:Ui.RIGHT,yAxisPx:x,xAxisPx:I,rotation:r?-1*O:O,skew:r?-1*q:q,xTransformOrigin:r?I:C,yTransformOrigin:x,caretCorners:r?z:G};case Dr.TOP_SIDE_END:return{yAlignment:Ui.TOP,xAlignment:r?Ui.LEFT:Ui.RIGHT,yAxisPx:I,xAxisPx:x,rotation:r?k:-1*k,skew:r?-1*q:q,xTransformOrigin:r?x:a,yTransformOrigin:I,caretCorners:r?z:G};case Dr.CENTER_SIDE_END:return{yAlignment:Ui.TOP,xAlignment:r?Ui.LEFT:Ui.RIGHT,yAxisPx:p,xAxisPx:x,rotation:r?k:-1*k,skew:r?-1*q:q,xTransformOrigin:r?x:a,yTransformOrigin:p,caretCorners:r?z:G};case Dr.BOTTOM_SIDE_END:return{yAlignment:Ui.BOTTOM,xAlignment:r?Ui.LEFT:Ui.RIGHT,yAxisPx:I,xAxisPx:x,rotation:r?-1*k:k,skew:r?q:-1*q,xTransformOrigin:r?x:a,yTransformOrigin:M,caretCorners:r?G:z};case Dr.TOP_SIDE_START:return{yAlignment:Ui.TOP,xAlignment:r?Ui.RIGHT:Ui.LEFT,yAxisPx:I,xAxisPx:x,rotation:r?-1*k:k,skew:r?q:-1*q,xTransformOrigin:r?a:x,yTransformOrigin:I,caretCorners:r?G:z};case Dr.CENTER_SIDE_START:return{yAlignment:Ui.TOP,xAlignment:r?Ui.RIGHT:Ui.LEFT,yAxisPx:p,xAxisPx:x,rotation:r?-1*k:k,skew:r?q:-1*q,xTransformOrigin:r?a:x,yTransformOrigin:p,caretCorners:r?G:z};case Dr.BOTTOM_SIDE_START:return{yAlignment:Ui.BOTTOM,xAlignment:r?Ui.RIGHT:Ui.LEFT,yAxisPx:I,xAxisPx:x,rotation:r?k:-1*k,skew:r?-1*q:q,xTransformOrigin:r?a:x,yTransformOrigin:M,caretCorners:r?z:G};case Dr.ABOVE_CENTER:return{yAlignment:Ui.BOTTOM,xAlignment:Ui.LEFT,yAxisPx:x,xAxisPx:s,rotation:O,skew:q,xTransformOrigin:s,yTransformOrigin:h,caretCorners:G};case Dr.ABOVE_END:return{yAlignment:Ui.BOTTOM,xAlignment:r?Ui.RIGHT:Ui.LEFT,yAxisPx:x,xAxisPx:I,rotation:r?-1*O:O,skew:r?-1*q:q,xTransformOrigin:r?C:I,yTransformOrigin:h,caretCorners:r?z:G};default:case Dr.ABOVE_START:return{yAlignment:Ui.BOTTOM,xAlignment:r?Ui.LEFT:Ui.RIGHT,yAxisPx:x,xAxisPx:I,rotation:r?O:-1*O,skew:r?q:-1*q,xTransformOrigin:r?I:C,yTransformOrigin:h,caretCorners:r?G:z}}}},e.prototype.clearShowTimeout=function(){this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=null)},e.prototype.clearHideTimeout=function(){this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null)},e.prototype.attachScrollHandler=function(t){var i=this;this.addAncestorScrollEventListeners.push(function(){t("scroll",i.windowScrollHandler)})},e.prototype.removeScrollHandler=function(t){var i=this;this.removeAncestorScrollEventListeners.push(function(){t("scroll",i.windowScrollHandler)})},e.prototype.destroy=function(){var t,i;this.frameId&&(cancelAnimationFrame(this.frameId),this.frameId=null),this.clearHideTimeout(),this.clearShowTimeout(),this.adapter.removeClass(JI),this.adapter.removeClass(Gb),this.adapter.removeClass(QI),this.adapter.removeClass(e1),this.adapter.removeClass(jb),this.richTooltip&&this.adapter.deregisterEventHandler("focusout",this.richTooltipFocusOutHandler),this.persistentTooltip||(this.adapter.deregisterEventHandler("mouseenter",this.tooltipMouseEnterHandler),this.adapter.deregisterEventHandler("mouseleave",this.tooltipMouseLeaveHandler)),this.adapter.deregisterAnchorEventHandler("blur",this.anchorBlurHandler),this.adapter.deregisterDocumentEventHandler("click",this.documentClickHandler),this.adapter.deregisterDocumentEventHandler("keydown",this.documentKeydownHandler),this.adapter.deregisterWindowEventHandler("scroll",this.windowScrollHandler),this.adapter.deregisterWindowEventHandler("resize",this.windowResizeHandler);try{for(var r=Xl(this.removeAncestorScrollEventListeners),a=r.next();!a.done;a=r.next()){var h=a.value;h()}}catch(s){t={error:s}}finally{try{a&&!a.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}this.animFrame.cancelAll()},e}(wh);function si(n){return Object.entries(n).filter(([e,t])=>e!==""&&t).map(([e])=>e).join(" ")}function vs(n,e,t,i={bubbles:!0},r=!1){if(typeof Event>"u")throw new Error("Event not defined.");if(!n)throw new Error("Tried to dipatch event without element.");const a=new CustomEvent(e,Object.assign(Object.assign({},i),{detail:t}));if(n==null||n.dispatchEvent(a),r&&e.startsWith("SMUI")){const h=new CustomEvent(e.replace(/^SMUI/g,()=>"MDC"),Object.assign(Object.assign({},i),{detail:t}));n==null||n.dispatchEvent(h),h.defaultPrevented&&a.preventDefault()}return a}function ep(n,e){let t=Object.getOwnPropertyNames(n);const i={};for(let r=0;r<t.length;r++){const a=t[r],h=a.indexOf("$");h!==-1&&e.indexOf(a.substring(0,h+1))!==-1||e.indexOf(a)===-1&&(i[a]=n[a])}return i}const aC=/^[a-z]+(?::(?:preventDefault|stopPropagation|passive|nonpassive|capture|once|self))+$/,WP=/^[^$]+(?:\$(?:preventDefault|stopPropagation|passive|nonpassive|capture|once|self))+$/;function Uo(n){let e,t=[];n.$on=(r,a)=>{let h=r,s=()=>{};return e?s=e(h,a):t.push([h,a]),h.match(aC)&&console&&console.warn('Event modifiers in SMUI now use "$" instead of ":", so that all events can be bound with modifiers. Please update your event binding: ',h),()=>{s()}};function i(r){Zl(n,r)}return r=>{const a=[],h={};e=(s,p)=>{let x=s,I=p,C=!1;const M=x.match(aC),O=x.match(WP),k=M||O;if(x.match(/^SMUI:\w+:/)){const q=x.split(":");let Z="";for(let K=0;K<q.length;K++)Z+=K===q.length-1?":"+q[K]:q[K].split("-").map(te=>te.slice(0,1).toUpperCase()+te.slice(1)).join("");console.warn(`The event ${x.split("$")[0]} has been renamed to ${Z.split("$")[0]}.`),x=Z}if(k){const q=x.split(M?":":"$");x=q[0];const Z=q.slice(1).reduce((K,te)=>(K[te]=!0,K),{});Z.passive&&(C=C||{},C.passive=!0),Z.nonpassive&&(C=C||{},C.passive=!1),Z.capture&&(C=C||{},C.capture=!0),Z.once&&(C=C||{},C.once=!0),Z.preventDefault&&(I=gP(I)),Z.stopPropagation&&(I=_P(I))}const z=Vi(r,x,I,C),G=()=>{z();const q=a.indexOf(G);q>-1&&a.splice(q,1)};return a.push(G),x in h||(h[x]=Vi(r,x,i)),G};for(let s=0;s<t.length;s++)e(t[s][0],t[s][1]);return{destroy:()=>{for(let s=0;s<a.length;s++)a[s]();for(let s of Object.entries(h))s[1]()}}}}function sr(n,e){let t=Object.getOwnPropertyNames(n);const i={};for(let r=0;r<t.length;r++){const a=t[r];a.substring(0,e.length)===e&&(i[a.substring(e.length)]=n[a])}return i}function ra(n,e){let t=[];if(e)for(let i=0;i<e.length;i++){const r=e[i],a=Array.isArray(r)?r[0]:r;Array.isArray(r)&&r.length>1?t.push(a(n,r[1])):t.push(a(n))}return{update(i){if((i&&i.length||0)!=t.length)throw new Error("You must not change the length of an actions array.");if(i)for(let r=0;r<i.length;r++){const a=t[r];if(a&&a.update){const h=i[r];Array.isArray(h)&&h.length>1?a.update(h[1]):a.update()}}},destroy(){for(let i=0;i<t.length;i++){const r=t[i];r&&r.destroy&&r.destroy()}}}}function XP(n){let e,t,i,r,a,h,s,p,x,I,C,M,O;const k=n[32].default,z=Sr(k,n,n[31],null);let G=[{class:i=si({[n[6]]:!0,"mdc-tooltip__surface":!0,"mdc-tooltip__surface-animation":!0})},{style:r=Object.entries(n[13]).map(lC).concat([n[7]]).join(" ")},sr(n[19],"surface$")],q={};for(let te=0;te<G.length;te+=1)q=dn(q,G[te]);let Z=[{class:a=si({[n[1]]:!0,"mdc-tooltip":!0,"mdc-tooltip--rich":n[18],...n[10]})},{style:h=Object.entries(n[11]).map(uC).concat([n[2]]).join(" ")},{"aria-hidden":"true"},{id:n[3]},{"data-mdc-tooltip-persist":s=n[18]&&n[4]?"true":void 0},{"data-mdc-tooltip-persistent":p=n[18]&&n[4]?"true":void 0},{"data-mdc-tooltip-has-caret":void 0},{"data-hide-tooltip-from-screenreader":x=n[5]?"true":void 0},n[14],n[12],ep(n[19],["surface$"])],K={};for(let te=0;te<Z.length;te+=1)K=dn(K,Z[te]);return{c(){e=un("div"),t=un("div"),z&&z.c(),this.h()},l(te){e=cn(te,"DIV",{class:!0,style:!0,"aria-hidden":!0,id:!0,"data-mdc-tooltip-persist":!0,"data-mdc-tooltip-persistent":!0,"data-mdc-tooltip-has-caret":!0,"data-hide-tooltip-from-screenreader":!0});var ie=_n(e);t=cn(ie,"DIV",{class:!0,style:!0});var Te=_n(t);z&&z.l(Te),Te.forEach(Oe),ie.forEach(Oe),this.h()},h(){Ki(t,q),Ki(e,K)},m(te,ie){Tt(te,e,ie),an(e,t),z&&z.m(t,null),n[33](e),C=!0,M||(O=[tr(I=ra.call(null,e,n[0])),tr(n[15].call(null,e)),Vi(e,"transitionend",n[34])],M=!0)},p(te,ie){z&&z.p&&(!C||ie[1]&1)&&Cr(z,k,te,te[31],C?Mr(k,te[31],ie,null):Ar(te[31]),null),Ki(t,q=Gi(G,[(!C||ie[0]&64&&i!==(i=si({[te[6]]:!0,"mdc-tooltip__surface":!0,"mdc-tooltip__surface-animation":!0})))&&{class:i},(!C||ie[0]&8320&&r!==(r=Object.entries(te[13]).map(lC).concat([te[7]]).join(" ")))&&{style:r},ie[0]&524288&&sr(te[19],"surface$")])),Ki(e,K=Gi(Z,[(!C||ie[0]&1026&&a!==(a=si({[te[1]]:!0,"mdc-tooltip":!0,"mdc-tooltip--rich":te[18],...te[10]})))&&{class:a},(!C||ie[0]&2052&&h!==(h=Object.entries(te[11]).map(uC).concat([te[2]]).join(" ")))&&{style:h},{"aria-hidden":"true"},(!C||ie[0]&8)&&{id:te[3]},(!C||ie[0]&16&&s!==(s=te[18]&&te[4]?"true":void 0))&&{"data-mdc-tooltip-persist":s},(!C||ie[0]&16&&p!==(p=te[18]&&te[4]?"true":void 0))&&{"data-mdc-tooltip-persistent":p},{"data-mdc-tooltip-has-caret":void 0},(!C||ie[0]&32&&x!==(x=te[5]?"true":void 0))&&{"data-hide-tooltip-from-screenreader":x},ie[0]&16384&&te[14],ie[0]&4096&&te[12],ie[0]&524288&&ep(te[19],["surface$"])])),I&&as(I.update)&&ie[0]&1&&I.update.call(null,te[0])},i(te){C||(Ke(z,te),C=!0)},o(te){rt(z,te),C=!1},d(te){te&&Oe(e),z&&z.d(te),n[33](null),M=!1,sa(O)}}}let ZP=0;const lC=([n,e])=>`${n}: ${e};`,uC=([n,e])=>`${n}: ${e};`;function YP(n,e,t){let i;const r=["use","class","style","id","unbounded","xPos","yPos","persistent","interactive","hideFromScreenreader","showDelay","hideDelay","surface$class","surface$style","attachScrollHandler","removeScrollHandler","getElement"];let a=Ji(e,r),h,s,{$$slots:p={},$$scope:x}=e;const I=Uo(zo());let{use:C=[]}=e,{class:M=""}=e,{style:O=""}=e,{id:k="SMUI-tooltip-"+ZP++}=e,{unbounded:z=!1}=e,{xPos:G="detected"}=e,{yPos:q="detected"}=e,{persistent:Z=!1}=e,{interactive:K=Z}=e,{hideFromScreenreader:te=!1}=e,{showDelay:ie=void 0}=e,{hideDelay:Te=void 0}=e,{surface$class:le=""}=e,{surface$style:fe=""}=e,Fe,Ne,Ue={setParent($e){Object.defineProperty(this,"parent",{value:$e})},setNextSibling($e){Object.defineProperty(this,"nextSibling",{value:$e})}},dt={},Ge={},Le={},nt={},zt=Ws("SMUI:tooltip:wrapper:anchor");id(n,zt,$e=>t(30,h=$e));let Ot=Ws("SMUI:tooltip:wrapper:tooltip");id(n,Ot,$e=>t(35,s=$e));const et=Ws("SMUI:tooltip:rich");let Ze;Ll(()=>(t(8,Ne=new HP({getAttribute:kn,setAttribute:on,removeAttribute:Di,addClass:zn,hasClass:sn,removeClass:ri,getComputedStyleProperty:$e=>{const Tn=hi();let fi=getComputedStyle(Tn).getPropertyValue($e);return fi==="auto"&&(Tn.classList.add("smui-banner--force-show"),fi=getComputedStyle(Tn).getPropertyValue($e),Tn.classList.remove("smui-banner--force-show")),fi},setStyleProperty:Yt,setSurfaceAnimationStyleProperty:ii,getViewportWidth:()=>window.innerWidth,getViewportHeight:()=>window.innerHeight,getTooltipSize:()=>{const $e=hi();let Tn={width:$e.offsetWidth,height:$e.offsetHeight};return(Tn.width===0||Tn.height===0)&&($e.classList.add("smui-banner--force-show"),Tn={width:$e.offsetWidth,height:$e.offsetHeight},$e.classList.remove("smui-banner--force-show")),Tn},getAnchorBoundingRect:()=>h?h.getBoundingClientRect():null,getParentBoundingRect:()=>{let $e=hi().parentElement;return et||($e=document.body),($e==null?void 0:$e.getBoundingClientRect())||null},getAnchorAttribute:$e=>h?h.getAttribute($e):null,setAnchorAttribute:($e,Tn)=>{h&&h.setAttribute($e,Tn)},isRTL:()=>getComputedStyle(hi()).direction==="rtl",anchorContainsElement:$e=>!!(h&&h.contains($e)),tooltipContainsElement:$e=>hi().contains($e),focusAnchorElement:()=>{h&&h.focus()},registerEventHandler:($e,Tn)=>{hi().addEventListener($e,Tn)},deregisterEventHandler:($e,Tn)=>{hi().removeEventListener($e,Tn)},registerAnchorEventHandler:($e,Tn)=>{h&&h.addEventListener($e,Tn)},deregisterAnchorEventHandler:($e,Tn)=>{h&&h.removeEventListener($e,Tn)},registerDocumentEventHandler:($e,Tn)=>{document.body.addEventListener($e,Tn)},deregisterDocumentEventHandler:($e,Tn)=>{document.body.removeEventListener($e,Tn)},registerWindowEventHandler:($e,Tn)=>{window.addEventListener($e,Tn,$e==="scroll"&&{capture:!0,passive:!0})},deregisterWindowEventHandler:($e,Tn)=>{window.removeEventListener($e,Tn,$e==="scroll"&&{capture:!0,passive:!0})},notifyHidden:()=>{vs(hi(),"SMUITooltip:hidden",void 0,void 0,!0)},getTooltipCaretBoundingRect:()=>{const $e=hi().querySelector(`.${Lc.TOOLTIP_CARET_TOP}`);return $e?$e.getBoundingClientRect():null},setTooltipCaretStyle:($e,Tn)=>{const fi=hi().querySelector(`.${Lc.TOOLTIP_CARET_TOP}`),Kn=hi().querySelector(`.${Lc.TOOLTIP_CARET_BOTTOM}`);!fi||!Kn||(fi.style.setProperty($e,Tn),Kn.style.setProperty($e,Tn))},clearTooltipCaretStyles:()=>{const $e=hi().querySelector(`.${Lc.TOOLTIP_CARET_TOP}`),Tn=hi().querySelector(`.${Lc.TOOLTIP_CARET_BOTTOM}`);!$e||!Tn||($e.removeAttribute("style"),Tn.removeAttribute("style"))},getActiveElement:()=>document.activeElement})),cv(Ot,s=Fe,s),()=>{h&&At(h)})),pd(()=>{var $e;!et&&typeof document<"u"&&document.body===hi().parentElement&&Ue.parent!==hi().parentElement&&(!(($e=Ue.parent)===null||$e===void 0)&&$e.insertBefore)&&Ue.nextSibling&&Ue.parent.insertBefore(hi(),Ue.nextSibling)});function At($e){$e.removeEventListener("focusout",Ut),et&&Z?($e.removeEventListener("click",Nt),$e.removeEventListener("keydown",Nt)):($e.removeEventListener("mouseenter",Gn),$e.removeEventListener("focusin",Ci),$e.removeEventListener("mouseleave",ln),$e.removeEventListener("touchstart",Mt),$e.removeEventListener("touchend",Un)),et&&K?($e.removeAttribute("aria-haspopup"),$e.removeAttribute("aria-expanded"),$e.removeAttribute("data-tooltip-id")):$e.removeAttribute("aria-describedby"),Ne.destroy()}function Kt($e){$e.addEventListener("focusout",Ut),et&&Z?($e.addEventListener("click",Nt),$e.addEventListener("keydown",Nt)):($e.addEventListener("mouseenter",Gn),$e.addEventListener("focusin",Ci),$e.addEventListener("mouseleave",ln),$e.addEventListener("touchstart",Mt),$e.addEventListener("touchend",Un)),et&&K?($e.setAttribute("aria-haspopup","dialog"),$e.setAttribute("aria-expanded","false"),$e.setAttribute("data-tooltip-id",k)):$e.setAttribute("aria-describedby",k),et||ti(),Ne.init()}function sn($e){return $e in dt?dt[$e]:hi().classList.contains($e)}function zn($e){dt[$e]||t(10,dt[$e]=!0,dt)}function ri($e){(!($e in dt)||dt[$e])&&t(10,dt[$e]=!1,dt)}function Yt($e,Tn){Ge[$e]!=Tn&&(Tn===""||Tn==null?(delete Ge[$e],t(11,Ge)):t(11,Ge[$e]=Tn,Ge))}function ii($e,Tn){nt[$e]!=Tn&&(Tn===""||Tn==null?(delete nt[$e],t(13,nt)):t(13,nt[$e]=Tn,nt))}function kn($e){var Tn;return $e in Le?(Tn=Le[$e])!==null&&Tn!==void 0?Tn:null:hi().getAttribute($e)}function on($e,Tn){Le[$e]!==Tn&&t(12,Le[$e]=Tn,Le)}function Di($e){(!($e in Le)||Le[$e]!=null)&&t(12,Le[$e]=void 0,Le)}function Ut($e){Fe.contains($e.relatedTarget)||Ne&&Ne.hide()}function Nt($e){$e.type==="keydown"&&$e.key!=="Enter"&&$e.key!==" "||Ne&&Ne.handleAnchorClick()}function Gn(){Ne&&Ne.handleAnchorMouseEnter()}function Ci($e){Ne&&Ne.handleAnchorFocus($e)}function ln(){Ne&&Ne.handleAnchorMouseLeave()}function Mt(){Ne&&Ne.handleAnchorTouchstart()}function Un(){Ne&&Ne.handleAnchorTouchend()}function ti(){var $e,Tn;h&&document.body!==hi().parentNode&&(Ue.setParent(($e=hi().parentElement)!==null&&$e!==void 0?$e:void 0),Ue.setNextSibling((Tn=hi().nextElementSibling)!==null&&Tn!==void 0?Tn:void 0),document.body.appendChild(hi()))}function jr($e){Ne&&Ne.attachScrollHandler($e)}function Yr($e){Ne&&Ne.removeScrollHandler($e)}function hi(){return Fe}function Hi($e){$n[$e?"unshift":"push"](()=>{Fe=$e,t(9,Fe)})}const or=()=>Ne&&Ne.handleTransitionEnd();return n.$$set=$e=>{e=dn(dn({},e),So($e)),t(19,a=Ji(e,r)),"use"in $e&&t(0,C=$e.use),"class"in $e&&t(1,M=$e.class),"style"in $e&&t(2,O=$e.style),"id"in $e&&t(3,k=$e.id),"unbounded"in $e&&t(20,z=$e.unbounded),"xPos"in $e&&t(21,G=$e.xPos),"yPos"in $e&&t(22,q=$e.yPos),"persistent"in $e&&t(4,Z=$e.persistent),"interactive"in $e&&t(23,K=$e.interactive),"hideFromScreenreader"in $e&&t(5,te=$e.hideFromScreenreader),"showDelay"in $e&&t(24,ie=$e.showDelay),"hideDelay"in $e&&t(25,Te=$e.hideDelay),"surface$class"in $e&&t(6,le=$e.surface$class),"surface$style"in $e&&t(7,fe=$e.surface$style),"$$scope"in $e&&t(31,x=$e.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&8388624&&t(14,i={role:et&&K?"dialog":"tooltip",tabindex:et&&Z?-1:void 0}),n.$$.dirty[0]&1610612992&&Ne&&Ze!==h&&(Ze&&At(Ze),h&&Kt(h),t(29,Ze=h)),n.$$.dirty[0]&1048832&&Ne&&Ne.setAnchorBoundaryType(pE[z?"UNBOUNDED":"BOUNDED"]),n.$$.dirty[0]&6291712&&Ne&&Ne.setTooltipPosition({xPos:a_[G.toUpperCase()],yPos:nv[q.toUpperCase()]}),n.$$.dirty[0]&16777472&&Ne&&ie!=null&&Ne.setShowDelay(ie),n.$$.dirty[0]&33554688&&Ne&&Te!=null&&Ne.setHideDelay(Te)},[C,M,O,k,Z,te,le,fe,Ne,Fe,dt,Ge,Le,nt,i,I,zt,Ot,et,a,z,G,q,K,ie,Te,jr,Yr,hi,Ze,h,x,p,Hi,or]}class G1 extends Fr{constructor(e){super(),Br(this,e,YP,XP,Lr,{use:0,class:1,style:2,id:3,unbounded:20,xPos:21,yPos:22,persistent:4,interactive:23,hideFromScreenreader:5,showDelay:24,hideDelay:25,surface$class:6,surface$style:7,attachScrollHandler:26,removeScrollHandler:27,getElement:28},null,[-1,-1])}get attachScrollHandler(){return this.$$.ctx[26]}get removeScrollHandler(){return this.$$.ctx[27]}get getElement(){return this.$$.ctx[28]}}function KP(n){let e;const t=n[12].default,i=Sr(t,n,n[11],null);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a&2048)&&Cr(i,t,r,r[11],e?Mr(t,r[11],a,null):Ar(r[11]),null)},i(r){e||(Ke(i,r),e=!0)},o(r){rt(i,r),e=!1},d(r){i&&i.d(r)}}}function JP(n){let e,t,i,r,a,h;const s=n[12].default,p=Sr(s,n,n[11],null);let x=[{class:t=si({[n[1]]:!0,"mdc-tooltip-wrapper--rich":!0})},n[7]],I={};for(let C=0;C<x.length;C+=1)I=dn(I,x[C]);return{c(){e=un("div"),p&&p.c(),this.h()},l(C){e=cn(C,"DIV",{class:!0});var M=_n(e);p&&p.l(M),M.forEach(Oe),this.h()},h(){Ki(e,I)},m(C,M){Tt(C,e,M),p&&p.m(e,null),n[13](e),r=!0,a||(h=[tr(i=ra.call(null,e,n[0])),tr(n[4].call(null,e))],a=!0)},p(C,M){p&&p.p&&(!r||M&2048)&&Cr(p,s,C,C[11],r?Mr(s,C[11],M,null):Ar(C[11]),null),Ki(e,I=Gi(x,[(!r||M&2&&t!==(t=si({[C[1]]:!0,"mdc-tooltip-wrapper--rich":!0})))&&{class:t},M&128&&C[7]])),i&&as(i.update)&&M&1&&i.update.call(null,C[0])},i(C){r||(Ke(p,C),r=!0)},o(C){rt(p,C),r=!1},d(C){C&&Oe(e),p&&p.d(C),n[13](null),a=!1,sa(h)}}}function QP(n){let e,t,i,r;const a=[JP,KP],h=[];function s(p,x){return p[2]?0:1}return e=s(n),t=h[e]=a[e](n),{c(){t.c(),i=Ei()},l(p){t.l(p),i=Ei()},m(p,x){h[e].m(p,x),Tt(p,i,x),r=!0},p(p,[x]){let I=e;e=s(p),e===I?h[e].p(p,x):(vr(),rt(h[I],1,1,()=>{h[I]=null}),xr(),t=h[e],t?t.p(p,x):(t=h[e]=a[e](p),t.c()),Ke(t,1),t.m(i.parentNode,i))},i(p){r||(Ke(t),r=!0)},o(p){rt(t),r=!1},d(p){h[e].d(p),p&&Oe(i)}}}function $P(n,e,t){const i=["use","class","rich","getElement"];let r=Ji(e,i),a,h,{$$slots:s={},$$scope:p}=e;const x=Uo(zo());let{use:I=[]}=e,{class:C=""}=e,{rich:M=!1}=e,O;const k=Xm(void 0);id(n,k,Z=>t(10,h=Z));const z=Xm(void 0);id(n,z,Z=>t(9,a=Z)),xo("SMUI:tooltip:wrapper:anchor",k),xo("SMUI:tooltip:wrapper:tooltip",z),xo("SMUI:tooltip:rich",M);function G(){return O}function q(Z){$n[Z?"unshift":"push"](()=>{O=Z,t(3,O)})}return n.$$set=Z=>{e=dn(dn({},e),So(Z)),t(7,r=Ji(e,i)),"use"in Z&&t(0,I=Z.use),"class"in Z&&t(1,C=Z.class),"rich"in Z&&t(2,M=Z.rich),"$$scope"in Z&&t(11,p=Z.$$scope)},n.$$.update=()=>{n.$$.dirty&1536&&a&&!h&&cv(k,h=a.previousElementSibling,h)},[I,C,M,O,x,k,z,r,G,a,h,p,s,q]}class dv extends Fr{constructor(e){super(),Br(this,e,$P,QP,Lr,{use:0,class:1,rich:2,getElement:8})}get getElement(){return this.$$.ctx[8]}}function eR(n){let e;const t=n[10].default,i=Sr(t,n,n[12],null);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a&4096)&&Cr(i,t,r,r[12],e?Mr(t,r[12],a,null):Ar(r[12]),null)},i(r){e||(Ke(i,r),e=!0)},o(r){rt(i,r),e=!1},d(r){i&&i.d(r)}}}function tR(n){let e,t,i;const r=[{tag:n[3]},{use:[n[5],...n[0]]},{class:si({[n[1]]:!0,"mdc-button__label":n[6]==="button","mdc-fab__label":n[6]==="fab","mdc-tab__text-label":n[6]==="tab","mdc-image-list__label":n[6]==="image-list","mdc-snackbar__label":n[6]==="snackbar","mdc-banner__text":n[6]==="banner","mdc-segmented-button__label":n[6]==="segmented-button","mdc-data-table__pagination-rows-per-page-label":n[6]==="data-table:pagination","mdc-data-table__header-cell-label":n[6]==="data-table:sortable-header-cell"})},n[6]==="snackbar"?{"aria-atomic":"false"}:{},{tabindex:n[7]},n[8]];var a=n[2];function h(s){let p={$$slots:{default:[eR]},$$scope:{ctx:s}};for(let x=0;x<r.length;x+=1)p=dn(p,r[x]);return{props:p}}return a&&(e=Tl(a,h(n)),n[11](e)),{c(){e&&Pn(e.$$.fragment),t=Ei()},l(s){e&&Zn(e.$$.fragment,s),t=Ei()},m(s,p){e&&Rn(e,s,p),Tt(s,t,p),i=!0},p(s,[p]){const x=p&491?Gi(r,[p&8&&{tag:s[3]},p&33&&{use:[s[5],...s[0]]},p&66&&{class:si({[s[1]]:!0,"mdc-button__label":s[6]==="button","mdc-fab__label":s[6]==="fab","mdc-tab__text-label":s[6]==="tab","mdc-image-list__label":s[6]==="image-list","mdc-snackbar__label":s[6]==="snackbar","mdc-banner__text":s[6]==="banner","mdc-segmented-button__label":s[6]==="segmented-button","mdc-data-table__pagination-rows-per-page-label":s[6]==="data-table:pagination","mdc-data-table__header-cell-label":s[6]==="data-table:sortable-header-cell"})},p&64&&kr(s[6]==="snackbar"?{"aria-atomic":"false"}:{}),p&128&&{tabindex:s[7]},p&256&&kr(s[8])]):{};if(p&4096&&(x.$$scope={dirty:p,ctx:s}),p&4&&a!==(a=s[2])){if(e){vr();const I=e;rt(I.$$.fragment,1,0,()=>{Dn(I,1)}),xr()}a?(e=Tl(a,h(s)),s[11](e),Pn(e.$$.fragment),Ke(e.$$.fragment,1),Rn(e,t.parentNode,t)):e=null}else a&&e.$set(x)},i(s){i||(e&&Ke(e.$$.fragment,s),i=!0)},o(s){e&&rt(e.$$.fragment,s),i=!1},d(s){n[11](null),s&&Oe(t),e&&Dn(e,s)}}}function nR(n,e,t){const i=["use","class","component","tag","getElement"];let r=Ji(e,i),{$$slots:a={},$$scope:h}=e;const s=Uo(zo());let{use:p=[]}=e,{class:x=""}=e,I,{component:C=Oc}=e,{tag:M=C===Oc?"span":void 0}=e;const O=Ws("SMUI:label:context"),k=Ws("SMUI:label:tabindex");function z(){return I.getElement()}function G(q){$n[q?"unshift":"push"](()=>{I=q,t(4,I)})}return n.$$set=q=>{e=dn(dn({},e),So(q)),t(8,r=Ji(e,i)),"use"in q&&t(0,p=q.use),"class"in q&&t(1,x=q.class),"component"in q&&t(2,C=q.component),"tag"in q&&t(3,M=q.tag),"$$scope"in q&&t(12,h=q.$$scope)},[p,x,C,M,I,s,O,k,r,z,a,G,h]}class rS extends Fr{constructor(e){super(),Br(this,e,nR,tR,Lr,{use:0,class:1,component:2,tag:3,getElement:9})}get getElement(){return this.$$.ctx[9]}}function iR(n){let e;const t=n[11].default,i=Sr(t,n,n[13],null);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a&8192)&&Cr(i,t,r,r[13],e?Mr(t,r[13],a,null):Ar(r[13]),null)},i(r){e||(Ke(i,r),e=!0)},o(r){rt(i,r),e=!1},d(r){i&&i.d(r)}}}function rR(n){let e,t,i;const r=[{tag:n[4]},{use:[n[6],...n[0]]},{class:si({[n[1]]:!0,"mdc-button__icon":n[8]==="button","mdc-fab__icon":n[8]==="fab","mdc-icon-button__icon":n[8]==="icon-button","mdc-icon-button__icon--on":n[8]==="icon-button"&&n[2],"mdc-tab__icon":n[8]==="tab","mdc-banner__icon":n[8]==="banner","mdc-segmented-button__icon":n[8]==="segmented-button"})},{"aria-hidden":"true"},n[7]?{focusable:"false",tabindex:"-1"}:{},n[9]];var a=n[3];function h(s){let p={$$slots:{default:[iR]},$$scope:{ctx:s}};for(let x=0;x<r.length;x+=1)p=dn(p,r[x]);return{props:p}}return a&&(e=Tl(a,h(n)),n[12](e)),{c(){e&&Pn(e.$$.fragment),t=Ei()},l(s){e&&Zn(e.$$.fragment,s),t=Ei()},m(s,p){e&&Rn(e,s,p),Tt(s,t,p),i=!0},p(s,[p]){const x=p&983?Gi(r,[p&16&&{tag:s[4]},p&65&&{use:[s[6],...s[0]]},p&262&&{class:si({[s[1]]:!0,"mdc-button__icon":s[8]==="button","mdc-fab__icon":s[8]==="fab","mdc-icon-button__icon":s[8]==="icon-button","mdc-icon-button__icon--on":s[8]==="icon-button"&&s[2],"mdc-tab__icon":s[8]==="tab","mdc-banner__icon":s[8]==="banner","mdc-segmented-button__icon":s[8]==="segmented-button"})},r[3],p&128&&kr(s[7]?{focusable:"false",tabindex:"-1"}:{}),p&512&&kr(s[9])]):{};if(p&8192&&(x.$$scope={dirty:p,ctx:s}),p&8&&a!==(a=s[3])){if(e){vr();const I=e;rt(I.$$.fragment,1,0,()=>{Dn(I,1)}),xr()}a?(e=Tl(a,h(s)),s[12](e),Pn(e.$$.fragment),Ke(e.$$.fragment,1),Rn(e,t.parentNode,t)):e=null}else a&&e.$set(x)},i(s){i||(e&&Ke(e.$$.fragment,s),i=!0)},o(s){e&&rt(e.$$.fragment,s),i=!1},d(s){n[12](null),s&&Oe(t),e&&Dn(e,s)}}}function sR(n,e,t){const i=["use","class","on","component","tag","getElement"];let r=Ji(e,i),{$$slots:a={},$$scope:h}=e;const s=Uo(zo());let{use:p=[]}=e,{class:x=""}=e,{on:I=!1}=e,C,{component:M=Oc}=e,{tag:O=M===Oc?"i":void 0}=e;const k=M===fR,z=Ws("SMUI:icon:context");function G(){return C.getElement()}function q(Z){$n[Z?"unshift":"push"](()=>{C=Z,t(5,C)})}return n.$$set=Z=>{e=dn(dn({},e),So(Z)),t(9,r=Ji(e,i)),"use"in Z&&t(0,p=Z.use),"class"in Z&&t(1,x=Z.class),"on"in Z&&t(2,I=Z.on),"component"in Z&&t(3,M=Z.component),"tag"in Z&&t(4,O=Z.tag),"$$scope"in Z&&t(13,h=Z.$$scope)},[p,x,I,M,O,C,s,k,z,r,G,a,q,h]}class sS extends Fr{constructor(e){super(),Br(this,e,sR,rR,Lr,{use:0,class:1,on:2,component:3,tag:4,getElement:10})}get getElement(){return this.$$.ctx[10]}}function oR(n){let e=n[1],t,i,r=n[1]&&$I(n);return{c(){r&&r.c(),t=Ei()},l(a){r&&r.l(a),t=Ei()},m(a,h){r&&r.m(a,h),Tt(a,t,h),i=!0},p(a,h){a[1]?e?Lr(e,a[1])?(r.d(1),r=$I(a),e=a[1],r.c(),r.m(t.parentNode,t)):r.p(a,h):(r=$I(a),e=a[1],r.c(),r.m(t.parentNode,t)):e&&(r.d(1),r=null,e=a[1])},i(a){i||(Ke(r),i=!0)},o(a){rt(r),i=!1},d(a){a&&Oe(t),r&&r.d(a)}}}function aR(n){let e=n[1],t,i=n[1]&&eT(n);return{c(){i&&i.c(),t=Ei()},l(r){i&&i.l(r),t=Ei()},m(r,a){i&&i.m(r,a),Tt(r,t,a)},p(r,a){r[1]?e?Lr(e,r[1])?(i.d(1),i=eT(r),e=r[1],i.c(),i.m(t.parentNode,t)):i.p(r,a):(i=eT(r),e=r[1],i.c(),i.m(t.parentNode,t)):e&&(i.d(1),i=null,e=r[1])},i:za,o:za,d(r){r&&Oe(t),i&&i.d(r)}}}function $I(n){let e,t,i,r,a;const h=n[8].default,s=Sr(h,n,n[7],null);let p=[n[5]],x={};for(let I=0;I<p.length;I+=1)x=dn(x,p[I]);return{c(){e=un(n[1]),s&&s.c(),this.h()},l(I){e=cn(I,(n[1]||"null").toUpperCase(),{});var C=_n(e);s&&s.l(C),C.forEach(Oe),this.h()},h(){fE(n[1])(e,x)},m(I,C){Tt(I,e,C),s&&s.m(e,null),n[10](e),i=!0,r||(a=[tr(t=ra.call(null,e,n[0])),tr(n[4].call(null,e))],r=!0)},p(I,C){s&&s.p&&(!i||C&128)&&Cr(s,h,I,I[7],i?Mr(h,I[7],C,null):Ar(I[7]),null),fE(I[1])(e,x=Gi(p,[C&32&&I[5]])),t&&as(t.update)&&C&1&&t.update.call(null,I[0])},i(I){i||(Ke(s,I),i=!0)},o(I){rt(s,I),i=!1},d(I){I&&Oe(e),s&&s.d(I),n[10](null),r=!1,sa(a)}}}function eT(n){let e,t,i,r,a=[n[5]],h={};for(let s=0;s<a.length;s+=1)h=dn(h,a[s]);return{c(){e=un(n[1]),this.h()},l(s){e=cn(s,(n[1]||"null").toUpperCase(),{}),_n(e).forEach(Oe),this.h()},h(){fE(n[1])(e,h)},m(s,p){Tt(s,e,p),n[9](e),i||(r=[tr(t=ra.call(null,e,n[0])),tr(n[4].call(null,e))],i=!0)},p(s,p){fE(s[1])(e,h=Gi(a,[p&32&&s[5]])),t&&as(t.update)&&p&1&&t.update.call(null,s[0])},d(s){s&&Oe(e),n[9](null),i=!1,sa(r)}}}function lR(n){let e,t,i,r;const a=[aR,oR],h=[];function s(p,x){return p[3]?0:1}return e=s(n),t=h[e]=a[e](n),{c(){t.c(),i=Ei()},l(p){t.l(p),i=Ei()},m(p,x){h[e].m(p,x),Tt(p,i,x),r=!0},p(p,[x]){let I=e;e=s(p),e===I?h[e].p(p,x):(vr(),rt(h[I],1,1,()=>{h[I]=null}),xr(),t=h[e],t?t.p(p,x):(t=h[e]=a[e](p),t.c()),Ke(t,1),t.m(i.parentNode,i))},i(p){r||(Ke(t),r=!0)},o(p){rt(t),r=!1},d(p){h[e].d(p),p&&Oe(i)}}}function uR(n,e,t){let i;const r=["use","tag","getElement"];let a=Ji(e,r),{$$slots:h={},$$scope:s}=e,{use:p=[]}=e,{tag:x}=e;const I=Uo(zo());let C;function M(){return C}function O(z){$n[z?"unshift":"push"](()=>{C=z,t(2,C)})}function k(z){$n[z?"unshift":"push"](()=>{C=z,t(2,C)})}return n.$$set=z=>{e=dn(dn({},e),So(z)),t(5,a=Ji(e,r)),"use"in z&&t(0,p=z.use),"tag"in z&&t(1,x=z.tag),"$$scope"in z&&t(7,s=z.$$scope)},n.$$.update=()=>{n.$$.dirty&2&&t(3,i=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"].indexOf(x)>-1)},[p,x,C,i,I,a,M,s,h,O,k]}class Oc extends Fr{constructor(e){super(),Br(this,e,uR,lR,Lr,{use:0,tag:1,getElement:6})}get getElement(){return this.$$.ctx[6]}}function cR(n){let e,t,i,r,a;const h=n[6].default,s=Sr(h,n,n[5],null);let p=[n[3]],x={};for(let I=0;I<p.length;I+=1)x=dn(x,p[I]);return{c(){e=rE("svg"),s&&s.c(),this.h()},l(I){e=sE(I,"svg",{});var C=_n(e);s&&s.l(C),C.forEach(Oe),this.h()},h(){$S(e,x)},m(I,C){Tt(I,e,C),s&&s.m(e,null),n[7](e),i=!0,r||(a=[tr(t=ra.call(null,e,n[0])),tr(n[2].call(null,e))],r=!0)},p(I,[C]){s&&s.p&&(!i||C&32)&&Cr(s,h,I,I[5],i?Mr(h,I[5],C,null):Ar(I[5]),null),$S(e,x=Gi(p,[C&8&&I[3]])),t&&as(t.update)&&C&1&&t.update.call(null,I[0])},i(I){i||(Ke(s,I),i=!0)},o(I){rt(s,I),i=!1},d(I){I&&Oe(e),s&&s.d(I),n[7](null),r=!1,sa(a)}}}function hR(n,e,t){const i=["use","getElement"];let r=Ji(e,i),{$$slots:a={},$$scope:h}=e,{use:s=[]}=e;const p=Uo(zo());let x;function I(){return x}function C(M){$n[M?"unshift":"push"](()=>{x=M,t(1,x)})}return n.$$set=M=>{e=dn(dn({},e),So(M)),t(3,r=Ji(e,i)),"use"in M&&t(0,s=M.use),"$$scope"in M&&t(5,h=M.$$scope)},[s,x,p,r,I,h,a,C]}class fR extends Fr{constructor(e){super(),Br(this,e,hR,cR,Lr,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function dR(n){let e;const t=n[4].default,i=Sr(t,n,n[3],null);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,[a]){i&&i.p&&(!e||a&8)&&Cr(i,t,r,r[3],e?Mr(t,r[3],a,null):Ar(r[3]),null)},i(r){e||(Ke(i,r),e=!0)},o(r){rt(i,r),e=!1},d(r){i&&i.d(r)}}}function pR(n,e,t){let i,{$$slots:r={},$$scope:a}=e,{key:h}=e,{value:s}=e;const p=Xm(s);return id(n,p,x=>t(5,i=x)),xo(h,p),pd(()=>{p.set(void 0)}),n.$$set=x=>{"key"in x&&t(1,h=x.key),"value"in x&&t(2,s=x.value),"$$scope"in x&&t(3,a=x.$$scope)},n.$$.update=()=>{n.$$.dirty&4&&cv(p,i=s,i)},[p,h,s,a,r]}class gE extends Fr{constructor(e){super(),Br(this,e,pR,dR,Lr,{key:1,value:2})}}function mR(n){let e;const t=n[11].default,i=Sr(t,n,n[13],null);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a&8192)&&Cr(i,t,r,r[13],e?Mr(t,r[13],a,null):Ar(r[13]),null)},i(r){e||(Ke(i,r),e=!0)},o(r){rt(i,r),e=!1},d(r){i&&i.d(r)}}}function gR(n){let e,t,i;const r=[{tag:n[3]},{use:[n[8],...n[0]]},{class:si({[n[1]]:!0,[n[6]]:!0,...n[5]})},n[7],n[9]];var a=n[2];function h(s){let p={$$slots:{default:[mR]},$$scope:{ctx:s}};for(let x=0;x<r.length;x+=1)p=dn(p,r[x]);return{props:p}}return a&&(e=Tl(a,h(n)),n[12](e)),{c(){e&&Pn(e.$$.fragment),t=Ei()},l(s){e&&Zn(e.$$.fragment,s),t=Ei()},m(s,p){e&&Rn(e,s,p),Tt(s,t,p),i=!0},p(s,[p]){const x=p&1003?Gi(r,[p&8&&{tag:s[3]},p&257&&{use:[s[8],...s[0]]},p&98&&{class:si({[s[1]]:!0,[s[6]]:!0,...s[5]})},p&128&&kr(s[7]),p&512&&kr(s[9])]):{};if(p&8192&&(x.$$scope={dirty:p,ctx:s}),p&4&&a!==(a=s[2])){if(e){vr();const I=e;rt(I.$$.fragment,1,0,()=>{Dn(I,1)}),xr()}a?(e=Tl(a,h(s)),s[12](e),Pn(e.$$.fragment),Ke(e.$$.fragment,1),Rn(e,t.parentNode,t)):e=null}else a&&e.$set(x)},i(s){i||(e&&Ke(e.$$.fragment,s),i=!0)},o(s){e&&rt(e.$$.fragment,s),i=!1},d(s){n[12](null),s&&Oe(t),e&&Dn(e,s)}}}const Wp={component:Oc,tag:"div",class:"",classMap:{},contexts:{},props:{}};function _R(n,e,t){const i=["use","class","component","tag","getElement"];let r=Ji(e,i),{$$slots:a={},$$scope:h}=e,{use:s=[]}=e,{class:p=""}=e,x;const I=Wp.class,C={},M=[],O=Wp.contexts,k=Wp.props;let{component:z=Wp.component}=e,{tag:G=z===Oc?Wp.tag:void 0}=e;Object.entries(Wp.classMap).forEach(([te,ie])=>{const Te=Ws(ie);Te&&"subscribe"in Te&&M.push(Te.subscribe(le=>{t(5,C[te]=le,C)}))});const q=Uo(zo());for(let te in O)O.hasOwnProperty(te)&&xo(te,O[te]);pd(()=>{for(const te of M)te()});function Z(){return x.getElement()}function K(te){$n[te?"unshift":"push"](()=>{x=te,t(4,x)})}return n.$$set=te=>{e=dn(dn({},e),So(te)),t(9,r=Ji(e,i)),"use"in te&&t(0,s=te.use),"class"in te&&t(1,p=te.class),"component"in te&&t(2,z=te.component),"tag"in te&&t(3,G=te.tag),"$$scope"in te&&t(13,h=te.$$scope)},[s,p,z,G,x,C,I,k,q,r,Z,a,K,h]}class yR extends Fr{constructor(e){super(),Br(this,e,_R,gR,Lr,{use:0,class:1,component:2,tag:3,getElement:10})}get getElement(){return this.$$.ctx[10]}}const cC=Object.assign({},Wp);function zc(n){return new Proxy(yR,{construct:function(e,t){return Object.assign(Wp,cC,n),new e(...t)},get:function(e,t){return Object.assign(Wp,cC,n),e[t]}})}zc({class:"mdc-tooltip__title",tag:"h2"});const vR=zc({class:"mdc-tooltip__content",tag:"div"});zc({class:"mdc-tooltip__content-link",tag:"a"});zc({class:"mdc-tooltip--rich-actions",tag:"div",contexts:{"SMUI:button:context":"tooltip:rich-actions"}});var qb;function xR(n,e){e===void 0&&(e=!1);var t=n.CSS,i=qb;if(typeof qb=="boolean"&&!e)return qb;var r=t&&typeof t.supports=="function";if(!r)return!1;var a=t.supports("--css-vars","yes"),h=t.supports("(--css-vars: yes)")&&t.supports("color","#00000000");return i=a||h,e||(qb=i),i}function bR(n,e,t){if(!n)return{x:0,y:0};var i=e.x,r=e.y,a=i+t.left,h=r+t.top,s,p;if(n.type==="touchstart"){var x=n;s=x.changedTouches[0].pageX-a,p=x.changedTouches[0].pageY-h}else{var I=n;s=I.pageX-a,p=I.pageY-h}return{x:s,y:p}}/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function ER(n){return n===void 0&&(n=window),wR(n)?{passive:!0}:!1}function wR(n){n===void 0&&(n=window);var e=!1;try{var t={get passive(){return e=!0,!1}},i=function(){};n.document.addEventListener("test",i,t),n.document.removeEventListener("test",i,t)}catch{e=!1}return e}const fM=Object.freeze(Object.defineProperty({__proto__:null,applyPassive:ER},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function IR(n,e){if(n.closest)return n.closest(e);for(var t=n;t;){if(dM(t,e))return t;t=t.parentElement}return null}function dM(n,e){var t=n.matches||n.webkitMatchesSelector||n.msMatchesSelector;return t.call(n,e)}function TR(n){var e=n;if(e.offsetParent!==null)return e.scrollWidth;var t=e.cloneNode(!0);t.style.setProperty("position","absolute"),t.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(t);var i=t.scrollWidth;return document.documentElement.removeChild(t),i}const oS=Object.freeze(Object.defineProperty({__proto__:null,closest:IR,estimateScrollWidth:TR,matches:dM},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var SR={BG_FOCUSED:"mdc-ripple-upgraded--background-focused",FG_ACTIVATION:"mdc-ripple-upgraded--foreground-activation",FG_DEACTIVATION:"mdc-ripple-upgraded--foreground-deactivation",ROOT:"mdc-ripple-upgraded",UNBOUNDED:"mdc-ripple-upgraded--unbounded"},CR={VAR_FG_SCALE:"--mdc-ripple-fg-scale",VAR_FG_SIZE:"--mdc-ripple-fg-size",VAR_FG_TRANSLATE_END:"--mdc-ripple-fg-translate-end",VAR_FG_TRANSLATE_START:"--mdc-ripple-fg-translate-start",VAR_LEFT:"--mdc-ripple-left",VAR_TOP:"--mdc-ripple-top"},hC={DEACTIVATION_TIMEOUT_MS:225,FG_DEACTIVATION_MS:150,INITIAL_ORIGIN_SCALE:.6,PADDING:10,TAP_DELAY_MS:300};/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var fC=["touchstart","pointerdown","mousedown","keydown"],dC=["touchend","pointerup","mouseup","contextmenu"],Hb=[],AR=function(n){Eh(e,n);function e(t){var i=n.call(this,ks(ks({},e.defaultAdapter),t))||this;return i.activationAnimationHasEnded=!1,i.activationTimer=0,i.fgDeactivationRemovalTimer=0,i.fgScale="0",i.frame={width:0,height:0},i.initialSize=0,i.layoutFrame=0,i.maxRadius=0,i.unboundedCoords={left:0,top:0},i.activationState=i.defaultActivationState(),i.activationTimerCallback=function(){i.activationAnimationHasEnded=!0,i.runDeactivationUXLogicIfReady()},i.activateHandler=function(r){i.activateImpl(r)},i.deactivateHandler=function(){i.deactivateImpl()},i.focusHandler=function(){i.handleFocus()},i.blurHandler=function(){i.handleBlur()},i.resizeHandler=function(){i.layout()},i}return Object.defineProperty(e,"cssClasses",{get:function(){return SR},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return CR},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return hC},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},browserSupportsCssVars:function(){return!0},computeBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},containsEventTarget:function(){return!0},deregisterDocumentInteractionHandler:function(){},deregisterInteractionHandler:function(){},deregisterResizeHandler:function(){},getWindowPageOffset:function(){return{x:0,y:0}},isSurfaceActive:function(){return!0},isSurfaceDisabled:function(){return!0},isUnbounded:function(){return!0},registerDocumentInteractionHandler:function(){},registerInteractionHandler:function(){},registerResizeHandler:function(){},removeClass:function(){},updateCssVariable:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){var t=this,i=this.supportsPressRipple();if(this.registerRootHandlers(i),i){var r=e.cssClasses,a=r.ROOT,h=r.UNBOUNDED;requestAnimationFrame(function(){t.adapter.addClass(a),t.adapter.isUnbounded()&&(t.adapter.addClass(h),t.layoutInternal())})}},e.prototype.destroy=function(){var t=this;if(this.supportsPressRipple()){this.activationTimer&&(clearTimeout(this.activationTimer),this.activationTimer=0,this.adapter.removeClass(e.cssClasses.FG_ACTIVATION)),this.fgDeactivationRemovalTimer&&(clearTimeout(this.fgDeactivationRemovalTimer),this.fgDeactivationRemovalTimer=0,this.adapter.removeClass(e.cssClasses.FG_DEACTIVATION));var i=e.cssClasses,r=i.ROOT,a=i.UNBOUNDED;requestAnimationFrame(function(){t.adapter.removeClass(r),t.adapter.removeClass(a),t.removeCssVars()})}this.deregisterRootHandlers(),this.deregisterDeactivationHandlers()},e.prototype.activate=function(t){this.activateImpl(t)},e.prototype.deactivate=function(){this.deactivateImpl()},e.prototype.layout=function(){var t=this;this.layoutFrame&&cancelAnimationFrame(this.layoutFrame),this.layoutFrame=requestAnimationFrame(function(){t.layoutInternal(),t.layoutFrame=0})},e.prototype.setUnbounded=function(t){var i=e.cssClasses.UNBOUNDED;t?this.adapter.addClass(i):this.adapter.removeClass(i)},e.prototype.handleFocus=function(){var t=this;requestAnimationFrame(function(){return t.adapter.addClass(e.cssClasses.BG_FOCUSED)})},e.prototype.handleBlur=function(){var t=this;requestAnimationFrame(function(){return t.adapter.removeClass(e.cssClasses.BG_FOCUSED)})},e.prototype.supportsPressRipple=function(){return this.adapter.browserSupportsCssVars()},e.prototype.defaultActivationState=function(){return{activationEvent:void 0,hasDeactivationUXRun:!1,isActivated:!1,isProgrammatic:!1,wasActivatedByPointer:!1,wasElementMadeActive:!1}},e.prototype.registerRootHandlers=function(t){var i,r;if(t){try{for(var a=Xl(fC),h=a.next();!h.done;h=a.next()){var s=h.value;this.adapter.registerInteractionHandler(s,this.activateHandler)}}catch(p){i={error:p}}finally{try{h&&!h.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}this.adapter.isUnbounded()&&this.adapter.registerResizeHandler(this.resizeHandler)}this.adapter.registerInteractionHandler("focus",this.focusHandler),this.adapter.registerInteractionHandler("blur",this.blurHandler)},e.prototype.registerDeactivationHandlers=function(t){var i,r;if(t.type==="keydown")this.adapter.registerInteractionHandler("keyup",this.deactivateHandler);else try{for(var a=Xl(dC),h=a.next();!h.done;h=a.next()){var s=h.value;this.adapter.registerDocumentInteractionHandler(s,this.deactivateHandler)}}catch(p){i={error:p}}finally{try{h&&!h.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}},e.prototype.deregisterRootHandlers=function(){var t,i;try{for(var r=Xl(fC),a=r.next();!a.done;a=r.next()){var h=a.value;this.adapter.deregisterInteractionHandler(h,this.activateHandler)}}catch(s){t={error:s}}finally{try{a&&!a.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}this.adapter.deregisterInteractionHandler("focus",this.focusHandler),this.adapter.deregisterInteractionHandler("blur",this.blurHandler),this.adapter.isUnbounded()&&this.adapter.deregisterResizeHandler(this.resizeHandler)},e.prototype.deregisterDeactivationHandlers=function(){var t,i;this.adapter.deregisterInteractionHandler("keyup",this.deactivateHandler);try{for(var r=Xl(dC),a=r.next();!a.done;a=r.next()){var h=a.value;this.adapter.deregisterDocumentInteractionHandler(h,this.deactivateHandler)}}catch(s){t={error:s}}finally{try{a&&!a.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}},e.prototype.removeCssVars=function(){var t=this,i=e.strings,r=Object.keys(i);r.forEach(function(a){a.indexOf("VAR_")===0&&t.adapter.updateCssVariable(i[a],null)})},e.prototype.activateImpl=function(t){var i=this;if(!this.adapter.isSurfaceDisabled()){var r=this.activationState;if(!r.isActivated){var a=this.previousActivationEvent,h=a&&t!==void 0&&a.type!==t.type;if(!h){r.isActivated=!0,r.isProgrammatic=t===void 0,r.activationEvent=t,r.wasActivatedByPointer=r.isProgrammatic?!1:t!==void 0&&(t.type==="mousedown"||t.type==="touchstart"||t.type==="pointerdown");var s=t!==void 0&&Hb.length>0&&Hb.some(function(p){return i.adapter.containsEventTarget(p)});if(s){this.resetActivationState();return}t!==void 0&&(Hb.push(t.target),this.registerDeactivationHandlers(t)),r.wasElementMadeActive=this.checkElementMadeActive(t),r.wasElementMadeActive&&this.animateActivation(),requestAnimationFrame(function(){Hb=[],!r.wasElementMadeActive&&t!==void 0&&(t.key===" "||t.keyCode===32)&&(r.wasElementMadeActive=i.checkElementMadeActive(t),r.wasElementMadeActive&&i.animateActivation()),r.wasElementMadeActive||(i.activationState=i.defaultActivationState())})}}}},e.prototype.checkElementMadeActive=function(t){return t!==void 0&&t.type==="keydown"?this.adapter.isSurfaceActive():!0},e.prototype.animateActivation=function(){var t=this,i=e.strings,r=i.VAR_FG_TRANSLATE_START,a=i.VAR_FG_TRANSLATE_END,h=e.cssClasses,s=h.FG_DEACTIVATION,p=h.FG_ACTIVATION,x=e.numbers.DEACTIVATION_TIMEOUT_MS;this.layoutInternal();var I="",C="";if(!this.adapter.isUnbounded()){var M=this.getFgTranslationCoordinates(),O=M.startPoint,k=M.endPoint;I=O.x+"px, "+O.y+"px",C=k.x+"px, "+k.y+"px"}this.adapter.updateCssVariable(r,I),this.adapter.updateCssVariable(a,C),clearTimeout(this.activationTimer),clearTimeout(this.fgDeactivationRemovalTimer),this.rmBoundedActivationClasses(),this.adapter.removeClass(s),this.adapter.computeBoundingRect(),this.adapter.addClass(p),this.activationTimer=setTimeout(function(){t.activationTimerCallback()},x)},e.prototype.getFgTranslationCoordinates=function(){var t=this.activationState,i=t.activationEvent,r=t.wasActivatedByPointer,a;r?a=bR(i,this.adapter.getWindowPageOffset(),this.adapter.computeBoundingRect()):a={x:this.frame.width/2,y:this.frame.height/2},a={x:a.x-this.initialSize/2,y:a.y-this.initialSize/2};var h={x:this.frame.width/2-this.initialSize/2,y:this.frame.height/2-this.initialSize/2};return{startPoint:a,endPoint:h}},e.prototype.runDeactivationUXLogicIfReady=function(){var t=this,i=e.cssClasses.FG_DEACTIVATION,r=this.activationState,a=r.hasDeactivationUXRun,h=r.isActivated,s=a||!h;s&&this.activationAnimationHasEnded&&(this.rmBoundedActivationClasses(),this.adapter.addClass(i),this.fgDeactivationRemovalTimer=setTimeout(function(){t.adapter.removeClass(i)},hC.FG_DEACTIVATION_MS))},e.prototype.rmBoundedActivationClasses=function(){var t=e.cssClasses.FG_ACTIVATION;this.adapter.removeClass(t),this.activationAnimationHasEnded=!1,this.adapter.computeBoundingRect()},e.prototype.resetActivationState=function(){var t=this;this.previousActivationEvent=this.activationState.activationEvent,this.activationState=this.defaultActivationState(),setTimeout(function(){return t.previousActivationEvent=void 0},e.numbers.TAP_DELAY_MS)},e.prototype.deactivateImpl=function(){var t=this,i=this.activationState;if(i.isActivated){var r=ks({},i);i.isProgrammatic?(requestAnimationFrame(function(){t.animateDeactivation(r)}),this.resetActivationState()):(this.deregisterDeactivationHandlers(),requestAnimationFrame(function(){t.activationState.hasDeactivationUXRun=!0,t.animateDeactivation(r),t.resetActivationState()}))}},e.prototype.animateDeactivation=function(t){var i=t.wasActivatedByPointer,r=t.wasElementMadeActive;(i||r)&&this.runDeactivationUXLogicIfReady()},e.prototype.layoutInternal=function(){var t=this;this.frame=this.adapter.computeBoundingRect();var i=Math.max(this.frame.height,this.frame.width),r=function(){var h=Math.sqrt(Math.pow(t.frame.width,2)+Math.pow(t.frame.height,2));return h+e.numbers.PADDING};this.maxRadius=this.adapter.isUnbounded()?i:r();var a=Math.floor(i*e.numbers.INITIAL_ORIGIN_SCALE);this.adapter.isUnbounded()&&a%2!==0?this.initialSize=a-1:this.initialSize=a,this.fgScale=""+this.maxRadius/this.initialSize,this.updateLayoutCssVars()},e.prototype.updateLayoutCssVars=function(){var t=e.strings,i=t.VAR_FG_SIZE,r=t.VAR_LEFT,a=t.VAR_TOP,h=t.VAR_FG_SCALE;this.adapter.updateCssVariable(i,this.initialSize+"px"),this.adapter.updateCssVariable(h,this.fgScale),this.adapter.isUnbounded()&&(this.unboundedCoords={left:Math.round(this.frame.width/2-this.initialSize/2),top:Math.round(this.frame.height/2-this.initialSize/2)},this.adapter.updateCssVariable(r,this.unboundedCoords.left+"px"),this.adapter.updateCssVariable(a,this.unboundedCoords.top+"px"))},e}(wh);const{applyPassive:Wb}=fM,{matches:MR}=oS;function ff(n,{ripple:e=!0,surface:t=!1,unbounded:i=!1,disabled:r=!1,color:a,active:h,rippleElement:s,eventTarget:p,activeTarget:x,addClass:I=k=>n.classList.add(k),removeClass:C=k=>n.classList.remove(k),addStyle:M=(k,z)=>n.style.setProperty(k,z),initPromise:O=Promise.resolve()}={}){let k,z=Ws("SMUI:addLayoutListener"),G,q=h,Z=p,K=x;function te(){t?(I("mdc-ripple-surface"),a==="primary"?(I("smui-ripple-surface--primary"),C("smui-ripple-surface--secondary")):a==="secondary"?(C("smui-ripple-surface--primary"),I("smui-ripple-surface--secondary")):(C("smui-ripple-surface--primary"),C("smui-ripple-surface--secondary"))):(C("mdc-ripple-surface"),C("smui-ripple-surface--primary"),C("smui-ripple-surface--secondary")),k&&q!==h&&(q=h,h?k.activate():h===!1&&k.deactivate()),e&&!k?(k=new AR({addClass:I,browserSupportsCssVars:()=>xR(window),computeBoundingRect:()=>(s||n).getBoundingClientRect(),containsEventTarget:Te=>n.contains(Te),deregisterDocumentInteractionHandler:(Te,le)=>document.documentElement.removeEventListener(Te,le,Wb()),deregisterInteractionHandler:(Te,le)=>(p||n).removeEventListener(Te,le,Wb()),deregisterResizeHandler:Te=>window.removeEventListener("resize",Te),getWindowPageOffset:()=>({x:window.pageXOffset,y:window.pageYOffset}),isSurfaceActive:()=>h??MR(x||n,":active"),isSurfaceDisabled:()=>!!r,isUnbounded:()=>!!i,registerDocumentInteractionHandler:(Te,le)=>document.documentElement.addEventListener(Te,le,Wb()),registerInteractionHandler:(Te,le)=>(p||n).addEventListener(Te,le,Wb()),registerResizeHandler:Te=>window.addEventListener("resize",Te),removeClass:C,updateCssVariable:M}),O.then(()=>{k&&(k.init(),k.setUnbounded(i))})):k&&!e&&O.then(()=>{k&&(k.destroy(),k=void 0)}),k&&(Z!==p||K!==x)&&(Z=p,K=x,k.destroy(),requestAnimationFrame(()=>{k&&(k.init(),k.setUnbounded(i))})),!e&&i&&I("mdc-ripple-upgraded--unbounded")}te(),z&&(G=z(ie));function ie(){k&&k.layout()}return{update(Te){({ripple:e,surface:t,unbounded:i,disabled:r,color:a,active:h,rippleElement:s,eventTarget:p,activeTarget:x,addClass:I,removeClass:C,addStyle:M,initPromise:O}=Object.assign({ripple:!0,surface:!1,unbounded:!1,disabled:!1,color:void 0,active:void 0,rippleElement:void 0,eventTarget:void 0,activeTarget:void 0,addClass:le=>n.classList.add(le),removeClass:le=>n.classList.remove(le),addStyle:(le,fe)=>n.style.setProperty(le,fe),initPromise:Promise.resolve()},Te)),te()},destroy(){k&&(k.destroy(),k=void 0,C("mdc-ripple-surface"),C("smui-ripple-surface--primary"),C("smui-ripple-surface--secondary")),G&&G()}}}function pC(n){let e;return{c(){e=un("div"),this.h()},l(t){e=cn(t,"DIV",{class:!0}),_n(e).forEach(Oe),this.h()},h(){tn(e,"class","mdc-button__touch")},m(t,i){Tt(t,e,i)},d(t){t&&Oe(e)}}}function LR(n){let e,t,i,r;const a=n[28].default,h=Sr(a,n,n[30],null);let s=n[6]&&pC();return{c(){e=un("div"),t=qn(),h&&h.c(),s&&s.c(),i=Ei(),this.h()},l(p){e=cn(p,"DIV",{class:!0}),_n(e).forEach(Oe),t=Hn(p),h&&h.l(p),s&&s.l(p),i=Ei(),this.h()},h(){tn(e,"class","mdc-button__ripple")},m(p,x){Tt(p,e,x),Tt(p,t,x),h&&h.m(p,x),s&&s.m(p,x),Tt(p,i,x),r=!0},p(p,x){h&&h.p&&(!r||x[0]&1073741824)&&Cr(h,a,p,p[30],r?Mr(a,p[30],x,null):Ar(p[30]),null),p[6]?s||(s=pC(),s.c(),s.m(i.parentNode,i)):s&&(s.d(1),s=null)},i(p){r||(Ke(h,p),r=!0)},o(p){rt(h,p),r=!1},d(p){p&&Oe(e),p&&Oe(t),h&&h.d(p),s&&s.d(p),p&&Oe(i)}}}function PR(n){let e,t,i;const r=[{tag:n[10]},{use:[[ff,{ripple:n[3],unbounded:!1,color:n[4],disabled:!!n[23].disabled,addClass:n[19],removeClass:n[20],addStyle:n[21]}],n[17],...n[0]]},{class:si({[n[1]]:!0,"mdc-button":!0,"mdc-button--raised":n[5]==="raised","mdc-button--unelevated":n[5]==="unelevated","mdc-button--outlined":n[5]==="outlined","smui-button--color-secondary":n[4]==="secondary","mdc-button--touch":n[6],"mdc-card__action":n[18]==="card:action","mdc-card__action--button":n[18]==="card:action","mdc-dialog__button":n[18]==="dialog:action","mdc-top-app-bar__navigation-icon":n[18]==="top-app-bar:navigation","mdc-top-app-bar__action-item":n[18]==="top-app-bar:action","mdc-snackbar__action":n[18]==="snackbar:actions","mdc-banner__secondary-action":n[18]==="banner"&&n[8],"mdc-banner__primary-action":n[18]==="banner"&&!n[8],"mdc-tooltip__action":n[18]==="tooltip:rich-actions",...n[12]})},{style:Object.entries(n[13]).map(mC).concat([n[2]]).join(" ")},n[16],n[15],n[14],{href:n[7]},n[23]];var a=n[9];function h(s){let p={$$slots:{default:[LR]},$$scope:{ctx:s}};for(let x=0;x<r.length;x+=1)p=dn(p,r[x]);return{props:p}}return a&&(e=Tl(a,h(n)),n[29](e),e.$on("click",n[22])),{c(){e&&Pn(e.$$.fragment),t=Ei()},l(s){e&&Zn(e.$$.fragment,s),t=Ei()},m(s,p){e&&Rn(e,s,p),Tt(s,t,p),i=!0},p(s,p){const x=p[0]&12580351?Gi(r,[p[0]&1024&&{tag:s[10]},p[0]&12189721&&{use:[[ff,{ripple:s[3],unbounded:!1,color:s[4],disabled:!!s[23].disabled,addClass:s[19],removeClass:s[20],addStyle:s[21]}],s[17],...s[0]]},p[0]&266610&&{class:si({[s[1]]:!0,"mdc-button":!0,"mdc-button--raised":s[5]==="raised","mdc-button--unelevated":s[5]==="unelevated","mdc-button--outlined":s[5]==="outlined","smui-button--color-secondary":s[4]==="secondary","mdc-button--touch":s[6],"mdc-card__action":s[18]==="card:action","mdc-card__action--button":s[18]==="card:action","mdc-dialog__button":s[18]==="dialog:action","mdc-top-app-bar__navigation-icon":s[18]==="top-app-bar:navigation","mdc-top-app-bar__action-item":s[18]==="top-app-bar:action","mdc-snackbar__action":s[18]==="snackbar:actions","mdc-banner__secondary-action":s[18]==="banner"&&s[8],"mdc-banner__primary-action":s[18]==="banner"&&!s[8],"mdc-tooltip__action":s[18]==="tooltip:rich-actions",...s[12]})},p[0]&8196&&{style:Object.entries(s[13]).map(mC).concat([s[2]]).join(" ")},p[0]&65536&&kr(s[16]),p[0]&32768&&kr(s[15]),p[0]&16384&&kr(s[14]),p[0]&128&&{href:s[7]},p[0]&8388608&&kr(s[23])]):{};if(p[0]&1073741888&&(x.$$scope={dirty:p,ctx:s}),p[0]&512&&a!==(a=s[9])){if(e){vr();const I=e;rt(I.$$.fragment,1,0,()=>{Dn(I,1)}),xr()}a?(e=Tl(a,h(s)),s[29](e),e.$on("click",s[22]),Pn(e.$$.fragment),Ke(e.$$.fragment,1),Rn(e,t.parentNode,t)):e=null}else a&&e.$set(x)},i(s){i||(e&&Ke(e.$$.fragment,s),i=!0)},o(s){e&&rt(e.$$.fragment,s),i=!1},d(s){n[29](null),s&&Oe(t),e&&Dn(e,s)}}}const mC=([n,e])=>`${n}: ${e};`;function RR(n,e,t){let i,r,a;const h=["use","class","style","ripple","color","variant","touch","href","action","defaultAction","secondary","component","tag","getElement"];let s=Ji(e,h),{$$slots:p={},$$scope:x}=e;const I=Uo(zo());let{use:C=[]}=e,{class:M=""}=e,{style:O=""}=e,{ripple:k=!0}=e,{color:z="primary"}=e,{variant:G="text"}=e,{touch:q=!1}=e,{href:Z=void 0}=e,{action:K="close"}=e,{defaultAction:te=!1}=e,{secondary:ie=!1}=e,Te,le={},fe={},Fe=Ws("SMUI:button:context"),{component:Ne=Oc}=e,{tag:Ue=Ne===Oc?Z==null?"button":"a":void 0}=e,dt=s.disabled;xo("SMUI:label:context","button"),xo("SMUI:icon:context","button");function Ge(Ze){le[Ze]||t(12,le[Ze]=!0,le)}function Le(Ze){(!(Ze in le)||le[Ze])&&t(12,le[Ze]=!1,le)}function nt(Ze,At){fe[Ze]!=At&&(At===""||At==null?(delete fe[Ze],t(13,fe)):t(13,fe[Ze]=At,fe))}function zt(){Fe==="banner"&&vs(Ot(),ie?"SMUIBannerButton:secondaryActionClick":"SMUIBannerButton:primaryActionClick")}function Ot(){return Te.getElement()}function et(Ze){$n[Ze?"unshift":"push"](()=>{Te=Ze,t(11,Te)})}return n.$$set=Ze=>{t(31,e=dn(dn({},e),So(Ze))),t(23,s=Ji(e,h)),"use"in Ze&&t(0,C=Ze.use),"class"in Ze&&t(1,M=Ze.class),"style"in Ze&&t(2,O=Ze.style),"ripple"in Ze&&t(3,k=Ze.ripple),"color"in Ze&&t(4,z=Ze.color),"variant"in Ze&&t(5,G=Ze.variant),"touch"in Ze&&t(6,q=Ze.touch),"href"in Ze&&t(7,Z=Ze.href),"action"in Ze&&t(24,K=Ze.action),"defaultAction"in Ze&&t(25,te=Ze.defaultAction),"secondary"in Ze&&t(8,ie=Ze.secondary),"component"in Ze&&t(9,Ne=Ze.component),"tag"in Ze&&t(10,Ue=Ze.tag),"$$scope"in Ze&&t(30,x=Ze.$$scope)},n.$$.update=()=>{if(t(16,i=Fe==="dialog:action"&&K!=null?{"data-mdc-dialog-action":K}:{action:e.action}),t(15,r=Fe==="dialog:action"&&te?{"data-mdc-dialog-button-default":""}:{default:e.default}),t(14,a=Fe==="banner"?{}:{secondary:e.secondary}),dt!==s.disabled){const Ze=Ot();"blur"in Ze&&Ze.blur(),t(27,dt=s.disabled)}},e=So(e),[C,M,O,k,z,G,q,Z,ie,Ne,Ue,Te,le,fe,a,r,i,I,Fe,Ge,Le,nt,zt,s,K,te,Ot,dt,p,et,x]}class _1 extends Fr{constructor(e){super(),Br(this,e,RR,PR,Lr,{use:0,class:1,style:2,ripple:3,color:4,variant:5,touch:6,href:7,action:24,defaultAction:25,secondary:8,component:9,tag:10,getElement:26},null,[-1,-1])}get getElement(){return this.$$.ctx[26]}}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Xb={ICON_BUTTON_ON:"mdc-icon-button--on",ROOT:"mdc-icon-button"},jp={ARIA_LABEL:"aria-label",ARIA_PRESSED:"aria-pressed",DATA_ARIA_LABEL_OFF:"data-aria-label-off",DATA_ARIA_LABEL_ON:"data-aria-label-on",CHANGE_EVENT:"MDCIconButtonToggle:change"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var DR=function(n){Eh(e,n);function e(t){var i=n.call(this,ks(ks({},e.defaultAdapter),t))||this;return i.hasToggledAriaLabel=!1,i}return Object.defineProperty(e,"cssClasses",{get:function(){return Xb},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return jp},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},hasClass:function(){return!1},notifyChange:function(){},removeClass:function(){},getAttr:function(){return null},setAttr:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){var t=this.adapter.getAttr(jp.DATA_ARIA_LABEL_ON),i=this.adapter.getAttr(jp.DATA_ARIA_LABEL_OFF);if(t&&i){if(this.adapter.getAttr(jp.ARIA_PRESSED)!==null)throw new Error("MDCIconButtonToggleFoundation: Button should not set `aria-pressed` if it has a toggled aria label.");this.hasToggledAriaLabel=!0}else this.adapter.setAttr(jp.ARIA_PRESSED,String(this.isOn()))},e.prototype.handleClick=function(){this.toggle(),this.adapter.notifyChange({isOn:this.isOn()})},e.prototype.isOn=function(){return this.adapter.hasClass(Xb.ICON_BUTTON_ON)},e.prototype.toggle=function(t){if(t===void 0&&(t=!this.isOn()),t?this.adapter.addClass(Xb.ICON_BUTTON_ON):this.adapter.removeClass(Xb.ICON_BUTTON_ON),this.hasToggledAriaLabel){var i=t?this.adapter.getAttr(jp.DATA_ARIA_LABEL_ON):this.adapter.getAttr(jp.DATA_ARIA_LABEL_OFF);this.adapter.setAttr(jp.ARIA_LABEL,i||"")}else this.adapter.setAttr(jp.ARIA_PRESSED,""+t)},e}(wh);function gC(n){let e;return{c(){e=un("div"),this.h()},l(t){e=cn(t,"DIV",{class:!0}),_n(e).forEach(Oe),this.h()},h(){tn(e,"class","mdc-icon-button__touch")},m(t,i){Tt(t,e,i)},d(t){t&&Oe(e)}}}function OR(n){let e,t,i,r;const a=n[33].default,h=Sr(a,n,n[37],null);let s=n[8]&&gC();return{c(){e=un("div"),t=qn(),h&&h.c(),s&&s.c(),i=Ei(),this.h()},l(p){e=cn(p,"DIV",{class:!0}),_n(e).forEach(Oe),t=Hn(p),h&&h.l(p),s&&s.l(p),i=Ei(),this.h()},h(){tn(e,"class","mdc-icon-button__ripple")},m(p,x){Tt(p,e,x),Tt(p,t,x),h&&h.m(p,x),s&&s.m(p,x),Tt(p,i,x),r=!0},p(p,x){h&&h.p&&(!r||x[1]&64)&&Cr(h,a,p,p[37],r?Mr(a,p[37],x,null):Ar(p[37]),null),p[8]?s||(s=gC(),s.c(),s.m(i.parentNode,i)):s&&(s.d(1),s=null)},i(p){r||(Ke(h,p),r=!0)},o(p){rt(h,p),r=!1},d(p){p&&Oe(e),p&&Oe(t),h&&h.d(p),s&&s.d(p),p&&Oe(i)}}}function NR(n){let e,t,i;const r=[{tag:n[14]},{use:[[ff,{ripple:n[4],unbounded:!0,color:n[5],disabled:!!n[29].disabled,addClass:n[26],removeClass:n[27],addStyle:n[28]}],n[22],...n[1]]},{class:si({[n[2]]:!0,"mdc-icon-button":!0,"mdc-icon-button--on":!n[23](n[0])&&n[0],"mdc-icon-button--touch":n[8],"mdc-icon-button--display-flex":n[9],"smui-icon-button--size-button":n[10]==="button","smui-icon-button--size-mini":n[10]==="mini","mdc-icon-button--reduced-size":n[10]==="mini"||n[10]==="button","mdc-card__action":n[24]==="card:action","mdc-card__action--icon":n[24]==="card:action","mdc-top-app-bar__navigation-icon":n[24]==="top-app-bar:navigation","mdc-top-app-bar__action-item":n[24]==="top-app-bar:action","mdc-snackbar__dismiss":n[24]==="snackbar:actions","mdc-data-table__pagination-button":n[24]==="data-table:pagination","mdc-data-table__sort-icon-button":n[24]==="data-table:sortable-header-cell","mdc-dialog__close":(n[24]==="dialog:header"||n[24]==="dialog:sheet")&&n[12]==="close",...n[18]})},{style:Object.entries(n[19]).map(_C).concat([n[3]]).join(" ")},{"aria-pressed":n[23](n[0])?null:n[0]?"true":"false"},{"aria-label":n[0]?n[6]:n[7]},{"data-aria-label-on":n[6]},{"data-aria-label-off":n[7]},{"aria-describedby":n[25]},{href:n[11]},n[21],n[20],n[29]];var a=n[13];function h(s){let p={$$slots:{default:[OR]},$$scope:{ctx:s}};for(let x=0;x<r.length;x+=1)p=dn(p,r[x]);return{props:p}}return a&&(e=Tl(a,h(n)),n[34](e),e.$on("click",n[35]),e.$on("click",n[36])),{c(){e&&Pn(e.$$.fragment),t=Ei()},l(s){e&&Zn(e.$$.fragment,s),t=Ei()},m(s,p){e&&Rn(e,s,p),Tt(s,t,p),i=!0},p(s,p){const x=p[0]&1073504255?Gi(r,[p[0]&16384&&{tag:s[14]},p[0]&1010827314&&{use:[[ff,{ripple:s[4],unbounded:!0,color:s[5],disabled:!!s[29].disabled,addClass:s[26],removeClass:s[27],addStyle:s[28]}],s[22],...s[1]]},p[0]&25433861&&{class:si({[s[2]]:!0,"mdc-icon-button":!0,"mdc-icon-button--on":!s[23](s[0])&&s[0],"mdc-icon-button--touch":s[8],"mdc-icon-button--display-flex":s[9],"smui-icon-button--size-button":s[10]==="button","smui-icon-button--size-mini":s[10]==="mini","mdc-icon-button--reduced-size":s[10]==="mini"||s[10]==="button","mdc-card__action":s[24]==="card:action","mdc-card__action--icon":s[24]==="card:action","mdc-top-app-bar__navigation-icon":s[24]==="top-app-bar:navigation","mdc-top-app-bar__action-item":s[24]==="top-app-bar:action","mdc-snackbar__dismiss":s[24]==="snackbar:actions","mdc-data-table__pagination-button":s[24]==="data-table:pagination","mdc-data-table__sort-icon-button":s[24]==="data-table:sortable-header-cell","mdc-dialog__close":(s[24]==="dialog:header"||s[24]==="dialog:sheet")&&s[12]==="close",...s[18]})},p[0]&524296&&{style:Object.entries(s[19]).map(_C).concat([s[3]]).join(" ")},p[0]&8388609&&{"aria-pressed":s[23](s[0])?null:s[0]?"true":"false"},p[0]&193&&{"aria-label":s[0]?s[6]:s[7]},p[0]&64&&{"data-aria-label-on":s[6]},p[0]&128&&{"data-aria-label-off":s[7]},p[0]&33554432&&{"aria-describedby":s[25]},p[0]&2048&&{href:s[11]},p[0]&2097152&&kr(s[21]),p[0]&1048576&&kr(s[20]),p[0]&536870912&&kr(s[29])]):{};if(p[0]&256|p[1]&64&&(x.$$scope={dirty:p,ctx:s}),p[0]&8192&&a!==(a=s[13])){if(e){vr();const I=e;rt(I.$$.fragment,1,0,()=>{Dn(I,1)}),xr()}a?(e=Tl(a,h(s)),s[34](e),e.$on("click",s[35]),e.$on("click",s[36]),Pn(e.$$.fragment),Ke(e.$$.fragment,1),Rn(e,t.parentNode,t)):e=null}else a&&e.$set(x)},i(s){i||(e&&Ke(e.$$.fragment,s),i=!0)},o(s){e&&rt(e.$$.fragment,s),i=!1},d(s){n[34](null),s&&Oe(t),e&&Dn(e,s)}}}const _C=([n,e])=>`${n}: ${e};`;function kR(n,e,t){let i;const r=["use","class","style","ripple","color","toggle","pressed","ariaLabelOn","ariaLabelOff","touch","displayFlex","size","href","action","component","tag","getElement"];let a=Ji(e,r),{$$slots:h={},$$scope:s}=e;const p=Uo(zo());let x=()=>{};function I(Nt){return Nt===x}let{use:C=[]}=e,{class:M=""}=e,{style:O=""}=e,{ripple:k=!0}=e,{color:z=void 0}=e,{toggle:G=!1}=e,{pressed:q=x}=e,{ariaLabelOn:Z=void 0}=e,{ariaLabelOff:K=void 0}=e,{touch:te=!1}=e,{displayFlex:ie=!0}=e,{size:Te="normal"}=e,{href:le=void 0}=e,{action:fe=void 0}=e,Fe,Ne,Ue={},dt={},Ge={},Le=Ws("SMUI:icon-button:context"),nt=Ws("SMUI:icon-button:aria-describedby"),{component:zt=Oc}=e,{tag:Ot=zt===Oc?le==null?"button":"a":void 0}=e,et=a.disabled;xo("SMUI:icon:context","icon-button");let Ze=null;pd(()=>{Ne&&Ne.destroy()});function At(Nt){return Nt in Ue?Ue[Nt]:kn().classList.contains(Nt)}function Kt(Nt){Ue[Nt]||t(18,Ue[Nt]=!0,Ue)}function sn(Nt){(!(Nt in Ue)||Ue[Nt])&&t(18,Ue[Nt]=!1,Ue)}function zn(Nt,Gn){dt[Nt]!=Gn&&(Gn===""||Gn==null?(delete dt[Nt],t(19,dt)):t(19,dt[Nt]=Gn,dt))}function ri(Nt){var Gn;return Nt in Ge?(Gn=Ge[Nt])!==null&&Gn!==void 0?Gn:null:kn().getAttribute(Nt)}function Yt(Nt,Gn){Ge[Nt]!==Gn&&t(20,Ge[Nt]=Gn,Ge)}function ii(Nt){t(0,q=Nt.isOn)}function kn(){return Fe.getElement()}function on(Nt){$n[Nt?"unshift":"push"](()=>{Fe=Nt,t(16,Fe)})}const Di=()=>Ne&&Ne.handleClick(),Ut=()=>Le==="top-app-bar:navigation"&&vs(kn(),"SMUITopAppBarIconButton:nav");return n.$$set=Nt=>{e=dn(dn({},e),So(Nt)),t(29,a=Ji(e,r)),"use"in Nt&&t(1,C=Nt.use),"class"in Nt&&t(2,M=Nt.class),"style"in Nt&&t(3,O=Nt.style),"ripple"in Nt&&t(4,k=Nt.ripple),"color"in Nt&&t(5,z=Nt.color),"toggle"in Nt&&t(30,G=Nt.toggle),"pressed"in Nt&&t(0,q=Nt.pressed),"ariaLabelOn"in Nt&&t(6,Z=Nt.ariaLabelOn),"ariaLabelOff"in Nt&&t(7,K=Nt.ariaLabelOff),"touch"in Nt&&t(8,te=Nt.touch),"displayFlex"in Nt&&t(9,ie=Nt.displayFlex),"size"in Nt&&t(10,Te=Nt.size),"href"in Nt&&t(11,le=Nt.href),"action"in Nt&&t(12,fe=Nt.action),"component"in Nt&&t(13,zt=Nt.component),"tag"in Nt&&t(14,Ot=Nt.tag),"$$scope"in Nt&&t(37,s=Nt.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&4096&&t(21,i=(()=>{if(Le==="data-table:pagination")switch(fe){case"first-page":return{"data-first-page":"true"};case"prev-page":return{"data-prev-page":"true"};case"next-page":return{"data-next-page":"true"};case"last-page":return{"data-last-page":"true"};default:return{"data-action":"true"}}else return Le==="dialog:header"||Le==="dialog:sheet"?{"data-mdc-dialog-action":fe}:{action:fe}})()),et!==a.disabled){const Nt=kn();"blur"in Nt&&Nt.blur(),t(31,et=a.disabled)}n.$$.dirty[0]&1073938432|n.$$.dirty[1]&2&&Fe&&kn()&&G!==Ze&&(G&&!Ne?(t(17,Ne=new DR({addClass:Kt,hasClass:At,notifyChange:Nt=>{ii(Nt),vs(kn(),"SMUIIconButtonToggle:change",Nt,void 0,!0)},removeClass:sn,getAttr:ri,setAttr:Yt})),Ne.init()):!G&&Ne&&(Ne.destroy(),t(17,Ne=void 0),t(18,Ue={}),t(20,Ge={})),t(32,Ze=G)),n.$$.dirty[0]&131073&&Ne&&!I(q)&&Ne.isOn()!==q&&Ne.toggle(q)},[q,C,M,O,k,z,Z,K,te,ie,Te,le,fe,zt,Ot,kn,Fe,Ne,Ue,dt,Ge,i,p,I,Le,nt,Kt,sn,zn,a,G,et,Ze,h,on,Di,Ut,s]}class hg extends Fr{constructor(e){super(),Br(this,e,kR,NR,Lr,{use:1,class:2,style:3,ripple:4,color:5,toggle:30,pressed:0,ariaLabelOn:6,ariaLabelOff:7,touch:8,displayFlex:9,size:10,href:11,action:12,component:13,tag:14,getElement:15},null,[-1,-1])}get getElement(){return this.$$.ctx[15]}}function pM(n){const e=n-1;return e*e*e+1}function FR(n){return--n*n*n*n*n+1}function BR(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}function zR(n){var{fallback:e}=n,t=BR(n,["fallback"]);const i=new Map,r=new Map;function a(s,p,x){const{delay:I=0,duration:C=le=>Math.sqrt(le)*30,easing:M=pM}=dn(dn({},t),x),O=s.getBoundingClientRect(),k=p.getBoundingClientRect(),z=O.left-k.left,G=O.top-k.top,q=O.width/k.width,Z=O.height/k.height,K=Math.sqrt(z*z+G*G),te=getComputedStyle(p),ie=te.transform==="none"?"":te.transform,Te=+te.opacity;return{delay:I,duration:as(C)?C(K):C,easing:M,css:(le,fe)=>`
				opacity: ${le*Te};
				transform-origin: top left;
				transform: ${ie} translate(${fe*z}px,${fe*G}px) scale(${le+(1-le)*q}, ${le+(1-le)*Z});
			`}}function h(s,p,x){return(I,C)=>(s.set(C.key,I),()=>{if(p.has(C.key)){const M=p.get(C.key);return p.delete(C.key),a(M,I,C)}return s.delete(C.key),e&&e(I,C,x)})}return[h(r,i,!1),h(i,r,!0)]}function UR(n,{from:e,to:t},i={}){const r=getComputedStyle(n),a=r.transform==="none"?"":r.transform,[h,s]=r.transformOrigin.split(" ").map(parseFloat),p=e.left+e.width*h/t.width-(t.left+h),x=e.top+e.height*s/t.height-(t.top+s),{delay:I=0,duration:C=O=>Math.sqrt(O)*120,easing:M=pM}=i;return{delay:I,duration:as(C)?C(Math.sqrt(p*p+x*x)):C,easing:M,css:(O,k)=>{const z=k*p,G=k*x,q=O+k*e.width/t.width,Z=O+k*e.height/t.height;return`transform: ${a} translate(${z}px, ${G}px) scale(${q}, ${Z});`}}}function yC(n,e,t){const i=n.slice();return i[15]=e[t],i[17]=t,i}const VR=n=>({item:n&1,index:n&1}),vC=n=>({item:n[15],index:n[17]});function xC(n){let e,t=[],i=new Map,r,a=n[0];const h=s=>s[8](s[15]);for(let s=0;s<a.length;s+=1){let p=yC(n,a,s),x=h(p);i.set(x,t[s]=bC(x,p))}return{c(){e=un("ul");for(let s=0;s<t.length;s+=1)t[s].c();this.h()},l(s){e=cn(s,"UL",{class:!0});var p=_n(e);for(let x=0;x<t.length;x+=1)t[x].l(p);p.forEach(Oe),this.h()},h(){tn(e,"class","svelte-1xt2noz")},m(s,p){Tt(s,e,p);for(let x=0;x<t.length;x+=1)t[x]&&t[x].m(e,null);r=!0},p(s,p){if(p&1523){a=s[0],vr();for(let x=0;x<t.length;x+=1)t[x].r();t=yP(t,p,h,1,s,a,i,e,TP,bC,null,yC);for(let x=0;x<t.length;x+=1)t[x].a();xr()}},i(s){if(!r){for(let p=0;p<a.length;p+=1)Ke(t[p]);r=!0}},o(s){for(let p=0;p<t.length;p+=1)rt(t[p]);r=!1},d(s){s&&Oe(e);for(let p=0;p<t.length;p+=1)t[p].d()}}}function GR(n){let e,t=n[8](n[15])+"",i;return{c(){e=un("p"),i=_r(t)},l(r){e=cn(r,"P",{});var a=_n(e);i=yr(a,t),a.forEach(Oe)},m(r,a){Tt(r,e,a),an(e,i)},p(r,a){a&1&&t!==(t=r[8](r[15])+"")&&Ao(i,t)},d(r){r&&Oe(e)}}}function bC(n,e){let t,i,r,a,h,s,p,x=za,I,C,M;const O=e[11].default,k=Sr(O,e,e[10],vC),z=k||GR(e);return{key:n,first:null,c(){t=un("li"),z&&z.c(),i=qn(),this.h()},l(G){t=cn(G,"LI",{"data-index":!0,"data-id":!0,draggable:!0,class:!0});var q=_n(t);z&&z.l(q),i=Hn(q),q.forEach(Oe),this.h()},h(){tn(t,"data-index",r=e[17]),tn(t,"data-id",a=JSON.stringify(e[8](e[15]))),tn(t,"draggable","true"),tn(t,"class","svelte-1xt2noz"),hv(t,"over",e[8](e[15])===e[1]),this.first=t},m(G,q){Tt(G,t,q),z&&z.m(t,null),an(t,i),I=!0,C||(M=[Vi(t,"dragstart",e[4]),Vi(t,"dragover",e[5]),Vi(t,"dragleave",e[6]),Vi(t,"drop",e[7])],C=!0)},p(G,q){e=G,k?k.p&&(!I||q&1025)&&Cr(k,O,e,e[10],I?Mr(O,e[10],q,VR):Ar(e[10]),vC):z&&z.p&&(!I||q&1)&&z.p(e,I?q:-1),(!I||q&1&&r!==(r=e[17]))&&tn(t,"data-index",r),(!I||q&1&&a!==(a=JSON.stringify(e[8](e[15]))))&&tn(t,"data-id",a),(!I||q&259)&&hv(t,"over",e[8](e[15])===e[1])},r(){p=t.getBoundingClientRect()},f(){vP(t),x(),xP(t,p)},a(){x(),x=bP(t,p,UR,{duration:300})},i(G){I||(Ke(z,G),EP(()=>{I&&(s&&s.end(1),h=wP(t,e[3],{key:e[8](e[15])}),h.start())}),I=!0)},o(G){rt(z,G),h&&h.invalidate(),s=IP(t,e[2],{key:e[8](e[15])}),I=!1},d(G){G&&Oe(t),z&&z.d(G),G&&s&&s.end(),C=!1,sa(M)}}}function jR(n){let e,t,i=n[0]&&n[0].length&&xC(n);return{c(){i&&i.c(),e=Ei()},l(r){i&&i.l(r),e=Ei()},m(r,a){i&&i.m(r,a),Tt(r,e,a),t=!0},p(r,[a]){r[0]&&r[0].length?i?(i.p(r,a),a&1&&Ke(i,1)):(i=xC(r),i.c(),Ke(i,1),i.m(e.parentNode,e)):i&&(vr(),rt(i,1,1,()=>{i=null}),xr())},i(r){t||(Ke(i),t=!0)},o(r){rt(i),t=!1},d(r){i&&i.d(r),r&&Oe(e)}}}function qR(n,e,t){let{$$slots:i={},$$scope:r}=e;const[a,h]=zR({duration:Z=>Math.sqrt(Z*200),fallback(Z,K){const te=getComputedStyle(Z),ie=te.transform==="none"?"":te.transform;return{duration:600,easing:FR,css:Te=>`
					transform: ${ie} scale(${Te});
					opacity: ${Te}
				`}}});let s=!1;const p=Z=>Z.dataset.index&&Z.dataset||p(Z.parentNode),x=Z=>{Z.dataTransfer.setData("source",Z.target.dataset.index)},I=Z=>{Z.preventDefault();let K=p(Z.target);s!==K.id&&t(1,s=JSON.parse(K.id))},C=Z=>{let K=p(Z.target);s===K.id&&t(1,s=!1)},M=Z=>{t(1,s=!1),Z.preventDefault();let K=p(Z.target),te=Z.dataTransfer.getData("source"),ie=K.index;k({from:te,to:ie})},O=z1(),k=({from:Z,to:K})=>{let te=[...G];const ie=te.splice(Z,1)[0];te.splice(K,0,ie),O("sort",{newList:te,from:Z,to:K})},z=Z=>q?Z[q]:Z;let{list:G}=e,{key:q}=e;return n.$$set=Z=>{"list"in Z&&t(0,G=Z.list),"key"in Z&&t(9,q=Z.key),"$$scope"in Z&&t(10,r=Z.$$scope)},[G,s,a,h,x,I,C,M,z,q,r,i]}class HR extends Fr{constructor(e){super(),Br(this,e,qR,jR,Lr,{list:0,key:9})}}function WR(n){let e=n[5][n[3]].muiIcon+"",t;return{c(){t=_r(e)},l(i){t=yr(i,e)},m(i,r){Tt(i,t,r)},p(i,r){r&8&&e!==(e=i[5][i[3]].muiIcon+"")&&Ao(t,e)},d(i){i&&Oe(t)}}}function XR(n){let e,t,i;return t=new hg({props:{class:"material-icons",$$slots:{default:[WR]},$$scope:{ctx:n}}}),t.$on("click",function(){as(n[5][n[3]].onClick)&&n[5][n[3]].onClick.apply(this,arguments)}),{c(){e=un("span"),Pn(t.$$.fragment),this.h()},l(r){e=cn(r,"SPAN",{class:!0});var a=_n(e);Zn(t.$$.fragment,a),a.forEach(Oe),this.h()},h(){tn(e,"class","visibility-btn svelte-1qhw7hj")},m(r,a){Tt(r,e,a),Rn(t,e,null),i=!0},p(r,a){n=r;const h={};a&8200&&(h.$$scope={dirty:a,ctx:n}),t.$set(h)},i(r){i||(Ke(t.$$.fragment,r),i=!0)},o(r){rt(t.$$.fragment,r),i=!1},d(r){r&&Oe(e),Dn(t)}}}function ZR(n){let e=n[5][n[2]].muiIcon+"",t;return{c(){t=_r(e)},l(i){t=yr(i,e)},m(i,r){Tt(i,t,r)},p(i,r){r&4&&e!==(e=i[5][i[2]].muiIcon+"")&&Ao(t,e)},d(i){i&&Oe(t)}}}function EC(n){let e,t;return e=new G1({props:{$$slots:{default:[YR]},$$scope:{ctx:n}}}),{c(){Pn(e.$$.fragment)},l(i){Zn(e.$$.fragment,i)},m(i,r){Rn(e,i,r),t=!0},p(i,r){const a={};r&8196&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Ke(e.$$.fragment,i),t=!0)},o(i){rt(e.$$.fragment,i),t=!1},d(i){Dn(e,i)}}}function YR(n){let e=n[5][n[2]].tooltip+"",t;return{c(){t=_r(e)},l(i){t=yr(i,e)},m(i,r){Tt(i,t,r)},p(i,r){r&4&&e!==(e=i[5][i[2]].tooltip+"")&&Ao(t,e)},d(i){i&&Oe(t)}}}function KR(n){let e,t,i,r,a;t=new hg({props:{class:"material-icons",$$slots:{default:[ZR]},$$scope:{ctx:n}}}),t.$on("click",function(){as(n[5][n[2]].onClick)&&n[5][n[2]].onClick.apply(this,arguments)});let h=n[5][n[2]].tooltip&&EC(n);return{c(){e=un("span"),Pn(t.$$.fragment),i=qn(),h&&h.c(),r=Ei(),this.h()},l(s){e=cn(s,"SPAN",{class:!0});var p=_n(e);Zn(t.$$.fragment,p),p.forEach(Oe),i=Hn(s),h&&h.l(s),r=Ei(),this.h()},h(){tn(e,"class","action-btn")},m(s,p){Tt(s,e,p),Rn(t,e,null),Tt(s,i,p),h&&h.m(s,p),Tt(s,r,p),a=!0},p(s,p){n=s;const x={};p&8196&&(x.$$scope={dirty:p,ctx:n}),t.$set(x),n[5][n[2]].tooltip?h?(h.p(n,p),p&4&&Ke(h,1)):(h=EC(n),h.c(),Ke(h,1),h.m(r.parentNode,r)):h&&(vr(),rt(h,1,1,()=>{h=null}),xr())},i(s){a||(Ke(t.$$.fragment,s),Ke(h),a=!0)},o(s){rt(t.$$.fragment,s),rt(h),a=!1},d(s){s&&Oe(e),Dn(t),s&&Oe(i),h&&h.d(s),s&&Oe(r)}}}function JR(n){let e,t,i,r,a,h,s,p=n[0].displayName+"",x,I,C,M,O,k,z,G;return C=new dv({props:{$$slots:{default:[XR]},$$scope:{ctx:n}}}),O=new dv({props:{$$slots:{default:[KR]},$$scope:{ctx:n}}}),{c(){e=un("div"),t=un("button"),i=un("img"),h=qn(),s=un("p"),x=_r(p),I=qn(),Pn(C.$$.fragment),M=qn(),Pn(O.$$.fragment),this.h()},l(q){e=cn(q,"DIV",{class:!0});var Z=_n(e);t=cn(Z,"BUTTON",{class:!0});var K=_n(t);i=cn(K,"IMG",{class:!0,src:!0,alt:!0}),h=Hn(K),s=cn(K,"P",{class:!0});var te=_n(s);x=yr(te,p),te.forEach(Oe),K.forEach(Oe),I=Hn(Z),Zn(C.$$.fragment,Z),M=Hn(Z),Zn(O.$$.fragment,Z),Z.forEach(Oe),this.h()},h(){tn(i,"class","icon svelte-1qhw7hj"),dE(i.src,r=wC(n[0]))||tn(i,"src",r),tn(i,"alt",a=n[0].type),tn(s,"class","description"),tn(t,"class","btn svelte-1qhw7hj"),tn(e,"class","item svelte-1qhw7hj"),hv(e,"checked",n[1])},m(q,Z){Tt(q,e,Z),an(e,t),an(t,i),an(t,h),an(t,s),an(s,x),an(e,I),Rn(C,e,null),an(e,M),Rn(O,e,null),k=!0,z||(G=Vi(t,"click",n[4]),z=!0)},p(q,[Z]){(!k||Z&1&&!dE(i.src,r=wC(q[0])))&&tn(i,"src",r),(!k||Z&1&&a!==(a=q[0].type))&&tn(i,"alt",a),(!k||Z&1)&&p!==(p=q[0].displayName+"")&&Ao(x,p);const K={};Z&8200&&(K.$$scope={dirty:Z,ctx:q}),C.$set(K);const te={};Z&8196&&(te.$$scope={dirty:Z,ctx:q}),O.$set(te),(!k||Z&2)&&hv(e,"checked",q[1])},i(q){k||(Ke(C.$$.fragment,q),Ke(O.$$.fragment,q),k=!0)},o(q){rt(C.$$.fragment,q),rt(O.$$.fragment,q),k=!1},d(q){q&&Oe(e),Dn(C),Dn(O),z=!1,G()}}}function wC(n){switch(n.type){case"circle":return"button-icons/point.png";case"line":return"button-icons/line.png";case"fill":case"fill-extrusion":return"button-icons/polygon.png";default:return"button-icons/polygon.png"}}function QR(n,e,t){let i,{map:r}=e,{layer:a}=e,{selectedTool:h}=e,{selectModeEnabled:s}=e,{selectedLayers:p}=e,x,I;const C=z1(),M=()=>C("toggled",a),O=()=>C("singleSelect",a),k={acceptEdit:{tooltip:"Accept layer edit",onClick:()=>console.log("yayaya"),muiIcon:"check"},cancelEdit:{tooltip:"Cancel edit",onClick:()=>null,muiIcon:"do_disturb"},isInvisible:{tooltip:"Show",onClick:()=>{bo.toggleVisibility(a.id)},muiIcon:"visibility_off"},isVisible:{tooltip:"Hide",onClick:()=>{bo.toggleVisibility(a.id)},muiIcon:"visibility"},remove:{onClick:()=>{r.removeLayer(a.id),r.removeSource(a.id),bo.deleteLayer(a.id)},muiIcon:"delete_outline"},checked:{onClick:()=>{M(),t(1,i=!1)},muiIcon:"check_box"},notChecked:{onClick:()=>{M(),t(1,i=!0)},muiIcon:"check_box_outline_blank"}};return n.$$set=z=>{"map"in z&&t(6,r=z.map),"layer"in z&&t(0,a=z.layer),"selectedTool"in z&&t(7,h=z.selectedTool),"selectModeEnabled"in z&&t(8,s=z.selectModeEnabled),"selectedLayers"in z&&t(9,p=z.selectedLayers)},n.$$.update=()=>{n.$$.dirty&513&&t(1,i=p.includes(a)),n.$$.dirty&386&&t(2,x=!h&&!s?"remove":i?"checked":"notChecked"),n.$$.dirty&1&&t(3,I=a.isVisible?"isVisible":"isInvisible")},[a,i,x,I,O,k,r,h,s,p]}class $R extends Fr{constructor(e){super(),Br(this,e,QR,JR,Lr,{map:6,layer:0,selectedTool:7,selectModeEnabled:8,selectedLayers:9})}}function eD(){return this._array=null,Promise.resolve()}function tD(){var n=this._array;return this._array=null,Promise.resolve(n?{done:!1,value:n}:{done:!0,value:void 0})}function y1(n){return new aS(n instanceof Uint8Array?n:new Uint8Array(n))}function aS(n){this._array=n}aS.prototype.read=tD;aS.prototype.cancel=eD;function nD(n){return fetch(n).then(function(e){return e.body&&e.body.getReader?e.body.getReader():e.arrayBuffer().then(y1)})}function iD(n){return new Promise(function(e,t){var i=new XMLHttpRequest;i.responseType="arraybuffer",i.onload=function(){e(y1(i.response))},i.onerror=t,i.ontimeout=t,i.open("GET",n,!0),i.send()})}function oE(n){return(typeof fetch=="function"?nD:iD)(n)}function wT(n){return typeof n.read=="function"?n:n.getReader()}const lS=new Uint8Array(0);function rD(){return this._source.cancel()}function sD(n,e){if(!n.length)return e;if(!e.length)return n;var t=new Uint8Array(n.length+e.length);return t.set(n),t.set(e,n.length),t}function oD(){var n=this,e=n._array.subarray(n._index);return n._source.read().then(function(t){return n._array=lS,n._index=0,t.done?e.length>0?{done:!1,value:e}:{done:!0,value:void 0}:{done:!1,value:sD(e,t.value)}})}function aD(n){if((n|=0)<0)throw new Error("invalid length");var e=this,t=this._array.length-this._index;if(this._index+n<=this._array.length)return Promise.resolve(this._array.subarray(this._index,this._index+=n));var i=new Uint8Array(n);return i.set(this._array.subarray(this._index)),function r(){return e._source.read().then(function(a){return a.done?(e._array=lS,e._index=0,t>0?i.subarray(0,t):null):t+a.value.length>=n?(e._array=a.value,e._index=n-t,i.set(a.value.subarray(0,n-t),t),i):(i.set(a.value,t),t+=a.value.length,r())})}()}function mM(n){return typeof n.slice=="function"?n:new VE(typeof n.read=="function"?n:n.getReader())}function VE(n){this._source=n,this._array=lS,this._index=0}VE.prototype.read=oD;VE.prototype.slice=aD;VE.prototype.cancel=rD;function lD(){return this._source.cancel()}function uD(n){return/^[nf]$/i.test(n)?!1:/^[yt]$/i.test(n)?!0:null}function cD(n){return new Date(+n.substring(0,4),n.substring(4,6)-1,+n.substring(6,8))}function Zb(n){return!(n=n.trim())||isNaN(n=+n)?null:n}function hD(n){return n.trim()||null}var fD={B:Zb,C:hD,D:cD,F:Zb,L:uD,M:Zb,N:Zb};function dD(){var n=this,e=1;return n._source.slice(n._recordLength).then(function(t){return t&&t[0]!==26?{done:!1,value:n._fields.reduce(function(i,r){return i[r.name]=fD[r.type](n._decode(t.subarray(e,e+=r.length))),i},{})}:{done:!0,value:void 0}})}function iv(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function gM(n,e){return n=mM(n),n.slice(32).then(function(t){var i=iv(t);return n.slice(i.getUint16(8,!0)-32).then(function(r){return new _M(n,e,i,iv(r))})})}function _M(n,e,t,i){this._source=n,this._decode=e.decode.bind(e),this._recordLength=t.getUint16(10,!0),this._fields=[];for(var r=0;i.getUint8(r)!==13;r+=32){for(var a=0;a<11&&i.getUint8(r+a)!==0;++a);this._fields.push({name:this._decode(new Uint8Array(i.buffer,i.byteOffset+r,a)),type:String.fromCharCode(i.getUint8(r+11)),length:i.getUint8(r+16)})}}var yM=_M.prototype;yM.read=dD;yM.cancel=lD;function pD(){return this._source.cancel()}function tT(n){var e=40,t,i=n.getInt32(36,!0),r=new Array(i);for(t=0;t<i;++t,e+=16)r[t]=[n.getFloat64(e,!0),n.getFloat64(e+8,!0)];return{type:"MultiPoint",coordinates:r}}function mD(){return null}function nT(n){return{type:"Point",coordinates:[n.getFloat64(4,!0),n.getFloat64(12,!0)]}}function iT(n){var e=44,t,i=n.getInt32(36,!0),r=n.getInt32(40,!0),a=new Array(i),h=new Array(r),s=[],p=[];for(t=0;t<i;++t,e+=4)a[t]=n.getInt32(e,!0);for(t=0;t<r;++t,e+=16)h[t]=[n.getFloat64(e,!0),n.getFloat64(e+8,!0)];return a.forEach(function(x,I){var C=h.slice(x,a[I+1]);gD(C)?s.push([C]):p.push(C)}),p.forEach(function(x){s.some(function(I){if(_D(I[0],x))return I.push(x),!0})||s.push([x])}),s.length===1?{type:"Polygon",coordinates:s[0]}:{type:"MultiPolygon",coordinates:s}}function gD(n){if((t=n.length)<4)return!1;for(var e=0,t,i=n[t-1][1]*n[0][0]-n[t-1][0]*n[0][1];++e<t;)i+=n[e-1][1]*n[e][0]-n[e-1][0]*n[e][1];return i>=0}function _D(n,e){for(var t=-1,i=e.length,r;++t<i;)if(r=yD(n,e[t]))return r>0;return!1}function yD(n,e){for(var t=e[0],i=e[1],r=-1,a=0,h=n.length,s=h-1;a<h;s=a++){var p=n[a],x=p[0],I=p[1],C=n[s],M=C[0],O=C[1];if(vD(p,C,e))return 0;I>i!=O>i&&t<(M-x)*(i-I)/(O-I)+x&&(r=-r)}return r}function vD(n,e,t){var i=t[0]-n[0],r=t[1]-n[1];if(i===0&&r===0)return!0;var a=e[0]-n[0],h=e[1]-n[1];if(a===0&&h===0)return!1;var s=(i*a+r*h)/(a*a+h*h);return s<0||s>1?!1:s===0||s===1?!0:s*a===i&&s*h===r}function rT(n){var e=44,t,i=n.getInt32(36,!0),r=n.getInt32(40,!0),a=new Array(i),h=new Array(r);for(t=0;t<i;++t,e+=4)a[t]=n.getInt32(e,!0);for(t=0;t<r;++t,e+=16)h[t]=[n.getFloat64(e,!0),n.getFloat64(e+8,!0)];return i===1?{type:"LineString",coordinates:h}:{type:"MultiLineString",coordinates:a.map(function(s,p){return h.slice(s,a[p+1])})}}function IC(n,e){var t=new Uint8Array(n.length+e.length);return t.set(n,0),t.set(e,n.length),t}function xD(){var n=this;return++n._index,n._source.slice(12).then(function(e){if(e==null)return{done:!0,value:void 0};var t=iv(e);function i(){return n._source.slice(4).then(function(a){return a==null?{done:!0,value:void 0}:(t=iv(e=IC(e.slice(4),a)),t.getInt32(0,!1)!==n._index?i():r())})}function r(){var a=t.getInt32(4,!1)*2-4,h=t.getInt32(8,!0);return a<0||h&&h!==n._type?i():n._source.slice(a).then(function(s){return{done:!1,value:h?n._parse(iv(IC(e.slice(8),s))):null}})}return r()})}var TC={0:mD,1:nT,3:rT,5:iT,8:tT,11:nT,13:rT,15:iT,18:tT,21:nT,23:rT,25:iT,28:tT};function bD(n){return n=mM(n),n.slice(100).then(function(e){return new vM(n,iv(e))})}function vM(n,e){var t=e.getInt32(32,!0);if(!(t in TC))throw new Error("unsupported shape type: "+t);this._source=n,this._type=t,this._index=0,this._parse=TC[t],this.bbox=[e.getFloat64(36,!0),e.getFloat64(44,!0),e.getFloat64(52,!0),e.getFloat64(60,!0)]}var xM=vM.prototype;xM.read=xD;xM.cancel=pD;function ED(){}function wD(){return Promise.all([this._dbf&&this._dbf.cancel(),this._shp.cancel()]).then(ED)}function ID(){var n=this;return Promise.all([n._dbf?n._dbf.read():{value:{}},n._shp.read()]).then(function(e){var t=e[0],i=e[1];return i.done?i:{done:!1,value:{type:"Feature",properties:t.value,geometry:i.value}}})}function TD(n,e,t){return Promise.all([bD(n),e&&gM(e,t)]).then(function(i){return new bM(i[0],i[1])})}function bM(n,e){this._shp=n,this._dbf=e,this.bbox=n.bbox}var EM=bM.prototype;EM.read=ID;EM.cancel=wD;function SD(n,e,t){return typeof e=="string"?(/\.dbf$/.test(e)||(e+=".dbf"),e=oE(e)):e instanceof ArrayBuffer||e instanceof Uint8Array?e=y1(e):e!=null&&(e=wT(e)),typeof n=="string"?(/\.shp$/.test(n)||(n+=".shp"),e===void 0&&(e=oE(n.substring(0,n.length-4)+".dbf").catch(function(){})),n=oE(n)):n instanceof ArrayBuffer||n instanceof Uint8Array?n=y1(n):n=wT(n),Promise.all([n,e]).then(function(i){var r=i[0],a=i[1],h="windows-1252";return t&&t.encoding!=null&&(h=t.encoding),TD(r,a,a&&new TextDecoder(h))})}function CD(n,e){var t="windows-1252";return e&&e.encoding!=null&&(t=e.encoding),t=new TextDecoder(t),typeof n=="string"?(/\.dbf$/.test(n)||(n+=".dbf"),n=oE(n)):n instanceof ArrayBuffer||n instanceof Uint8Array?n=y1(n):n=wT(n),Promise.resolve(n).then(function(i){return gM(i,t)})}function AD(n,e,t){return SD(n,e,t).then(function(i){var r=[],a={type:"FeatureCollection",features:r,bbox:i.bbox};return i.read().then(function h(s){return s.done?a:(r.push(s.value),i.read().then(h))})})}function MD(n){n("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),n("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),n("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),n.WGS84=n["EPSG:4326"],n["EPSG:3785"]=n["EPSG:3857"],n.GOOGLE=n["EPSG:3857"],n["EPSG:900913"]=n["EPSG:3857"],n["EPSG:102113"]=n["EPSG:3857"]}var f_=1,d_=2,rv=3,LD=4,IT=5,SC=6378137,PD=6356752314e-3,CC=.0066943799901413165,m1=484813681109536e-20,En=Math.PI/2,RD=.16666666666666666,DD=.04722222222222222,OD=.022156084656084655,ei=1e-10,Hl=.017453292519943295,Kd=57.29577951308232,Ls=Math.PI/4,v1=Math.PI*2,xa=3.14159265359,Uc={};Uc.greenwich=0;Uc.lisbon=-9.131906111111;Uc.paris=2.337229166667;Uc.bogota=-74.080916666667;Uc.madrid=-3.687938888889;Uc.rome=12.452333333333;Uc.bern=7.439583333333;Uc.jakarta=106.807719444444;Uc.ferro=-17.666666666667;Uc.brussels=4.367975;Uc.stockholm=18.058277777778;Uc.athens=23.7163375;Uc.oslo=10.722916666667;const ND={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}};var AC=/[\s_\-\/\(\)]/g;function Zm(n,e){if(n[e])return n[e];for(var t=Object.keys(n),i=e.toLowerCase().replace(AC,""),r=-1,a,h;++r<t.length;)if(a=t[r],h=a.toLowerCase().replace(AC,""),h===i)return n[a]}function TT(n){var e={},t=n.split("+").map(function(s){return s.trim()}).filter(function(s){return s}).reduce(function(s,p){var x=p.split("=");return x.push(!0),s[x[0].toLowerCase()]=x[1],s},{}),i,r,a,h={proj:"projName",datum:"datumCode",rf:function(s){e.rf=parseFloat(s)},lat_0:function(s){e.lat0=s*Hl},lat_1:function(s){e.lat1=s*Hl},lat_2:function(s){e.lat2=s*Hl},lat_ts:function(s){e.lat_ts=s*Hl},lon_0:function(s){e.long0=s*Hl},lon_1:function(s){e.long1=s*Hl},lon_2:function(s){e.long2=s*Hl},alpha:function(s){e.alpha=parseFloat(s)*Hl},gamma:function(s){e.rectified_grid_angle=parseFloat(s)},lonc:function(s){e.longc=s*Hl},x_0:function(s){e.x0=parseFloat(s)},y_0:function(s){e.y0=parseFloat(s)},k_0:function(s){e.k0=parseFloat(s)},k:function(s){e.k0=parseFloat(s)},a:function(s){e.a=parseFloat(s)},b:function(s){e.b=parseFloat(s)},r_a:function(){e.R_A=!0},zone:function(s){e.zone=parseInt(s,10)},south:function(){e.utmSouth=!0},towgs84:function(s){e.datum_params=s.split(",").map(function(p){return parseFloat(p)})},to_meter:function(s){e.to_meter=parseFloat(s)},units:function(s){e.units=s;var p=Zm(ND,s);p&&(e.to_meter=p.to_meter)},from_greenwich:function(s){e.from_greenwich=s*Hl},pm:function(s){var p=Zm(Uc,s);e.from_greenwich=(p||parseFloat(s))*Hl},nadgrids:function(s){s==="@null"?e.datumCode="none":e.nadgrids=s},axis:function(s){var p="ewnsud";s.length===3&&p.indexOf(s.substr(0,1))!==-1&&p.indexOf(s.substr(1,1))!==-1&&p.indexOf(s.substr(2,1))!==-1&&(e.axis=s)},approx:function(){e.approx=!0}};for(i in t)r=t[i],i in h?(a=h[i],typeof a=="function"?a(r):e[a]=r):e[i]=r;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e}var x1=1,wM=2,IM=3,_E=4,TM=5,uS=-1,kD=/\s/,FD=/[A-Za-z]/,BD=/[A-Za-z84_]/,GE=/[,\]]/,SM=/[\d\.E\-\+]/;function om(n){if(typeof n!="string")throw new Error("not a string");this.text=n.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=x1}om.prototype.readCharicter=function(){var n=this.text[this.place++];if(this.state!==_E)for(;kD.test(n);){if(this.place>=this.text.length)return;n=this.text[this.place++]}switch(this.state){case x1:return this.neutral(n);case wM:return this.keyword(n);case _E:return this.quoted(n);case TM:return this.afterquote(n);case IM:return this.number(n);case uS:return}};om.prototype.afterquote=function(n){if(n==='"'){this.word+='"',this.state=_E;return}if(GE.test(n)){this.word=this.word.trim(),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in afterquote yet, index '+this.place)};om.prototype.afterItem=function(n){if(n===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=x1;return}if(n==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=x1,this.currentObject=this.stack.pop(),this.currentObject||(this.state=uS);return}};om.prototype.number=function(n){if(SM.test(n)){this.word+=n;return}if(GE.test(n)){this.word=parseFloat(this.word),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in number yet, index '+this.place)};om.prototype.quoted=function(n){if(n==='"'){this.state=TM;return}this.word+=n};om.prototype.keyword=function(n){if(BD.test(n)){this.word+=n;return}if(n==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=x1;return}if(GE.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in keyword yet, index '+this.place)};om.prototype.neutral=function(n){if(FD.test(n)){this.word=n,this.state=wM;return}if(n==='"'){this.word="",this.state=_E;return}if(SM.test(n)){this.word=n,this.state=IM;return}if(GE.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in neutral yet, index '+this.place)};om.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===uS)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function zD(n){var e=new om(n);return e.output()}function MC(n,e,t){Array.isArray(e)&&(t.unshift(e),e=null);var i=e?{}:n,r=t.reduce(function(a,h){return Xy(h,a),a},i);e&&(n[e]=r)}function Xy(n,e){if(!Array.isArray(n)){e[n]=!0;return}var t=n.shift();if(t==="PARAMETER"&&(t=n.shift()),n.length===1){if(Array.isArray(n[0])){e[t]={},Xy(n[0],e[t]);return}e[t]=n[0];return}if(!n.length){e[t]=!0;return}if(t==="TOWGS84"){e[t]=n;return}if(t==="AXIS"){t in e||(e[t]=[]),e[t].push(n);return}Array.isArray(t)||(e[t]={});var i;switch(t){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[t]={name:n[0].toLowerCase(),convert:n[1]},n.length===3&&Xy(n[2],e[t]);return;case"SPHEROID":case"ELLIPSOID":e[t]={name:n[0],a:n[1],rf:n[2]},n.length===4&&Xy(n[3],e[t]);return;case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":n[0]=["name",n[0]],MC(e,t,n);return;default:for(i=-1;++i<n.length;)if(!Array.isArray(n[i]))return Xy(n,e[t]);return MC(e,t,n)}}var UD=.017453292519943295;function VD(n,e){var t=e[0],i=e[1];!(t in n)&&i in n&&(n[t]=n[i],e.length===3&&(n[t]=e[2](n[t])))}function qd(n){return n*UD}function GD(n){if(n.type==="GEOGCS"?n.projName="longlat":n.type==="LOCAL_CS"?(n.projName="identity",n.local=!0):typeof n.PROJECTION=="object"?n.projName=Object.keys(n.PROJECTION)[0]:n.projName=n.PROJECTION,n.AXIS){for(var e="",t=0,i=n.AXIS.length;t<i;++t){var r=[n.AXIS[t][0].toLowerCase(),n.AXIS[t][1].toLowerCase()];r[0].indexOf("north")!==-1||(r[0]==="y"||r[0]==="lat")&&r[1]==="north"?e+="n":r[0].indexOf("south")!==-1||(r[0]==="y"||r[0]==="lat")&&r[1]==="south"?e+="s":r[0].indexOf("east")!==-1||(r[0]==="x"||r[0]==="lon")&&r[1]==="east"?e+="e":(r[0].indexOf("west")!==-1||(r[0]==="x"||r[0]==="lon")&&r[1]==="west")&&(e+="w")}e.length===2&&(e+="u"),e.length===3&&(n.axis=e)}n.UNIT&&(n.units=n.UNIT.name.toLowerCase(),n.units==="metre"&&(n.units="meter"),n.UNIT.convert&&(n.type==="GEOGCS"?n.DATUM&&n.DATUM.SPHEROID&&(n.to_meter=n.UNIT.convert*n.DATUM.SPHEROID.a):n.to_meter=n.UNIT.convert));var a=n.GEOGCS;n.type==="GEOGCS"&&(a=n),a&&(a.DATUM?n.datumCode=a.DATUM.name.toLowerCase():n.datumCode=a.name.toLowerCase(),n.datumCode.slice(0,2)==="d_"&&(n.datumCode=n.datumCode.slice(2)),(n.datumCode==="new_zealand_geodetic_datum_1949"||n.datumCode==="new_zealand_1949")&&(n.datumCode="nzgd49"),(n.datumCode==="wgs_1984"||n.datumCode==="world_geodetic_system_1984")&&(n.PROJECTION==="Mercator_Auxiliary_Sphere"&&(n.sphere=!0),n.datumCode="wgs84"),n.datumCode.slice(-6)==="_ferro"&&(n.datumCode=n.datumCode.slice(0,-6)),n.datumCode.slice(-8)==="_jakarta"&&(n.datumCode=n.datumCode.slice(0,-8)),~n.datumCode.indexOf("belge")&&(n.datumCode="rnb72"),a.DATUM&&a.DATUM.SPHEROID&&(n.ellps=a.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),n.ellps.toLowerCase().slice(0,13)==="international"&&(n.ellps="intl"),n.a=a.DATUM.SPHEROID.a,n.rf=parseFloat(a.DATUM.SPHEROID.rf,10)),a.DATUM&&a.DATUM.TOWGS84&&(n.datum_params=a.DATUM.TOWGS84),~n.datumCode.indexOf("osgb_1936")&&(n.datumCode="osgb36"),~n.datumCode.indexOf("osni_1952")&&(n.datumCode="osni52"),(~n.datumCode.indexOf("tm65")||~n.datumCode.indexOf("geodetic_datum_of_1965"))&&(n.datumCode="ire65"),n.datumCode==="ch1903+"&&(n.datumCode="ch1903"),~n.datumCode.indexOf("israel")&&(n.datumCode="isr93")),n.b&&!isFinite(n.b)&&(n.b=n.a);function h(x){var I=n.to_meter||1;return x*I}var s=function(x){return VD(n,x)},p=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",qd],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",qd],["x0","false_easting",h],["y0","false_northing",h],["long0","central_meridian",qd],["lat0","latitude_of_origin",qd],["lat0","standard_parallel_1",qd],["lat1","standard_parallel_1",qd],["lat2","standard_parallel_2",qd],["azimuth","Azimuth"],["alpha","azimuth",qd],["srsCode","name"]];p.forEach(s),!n.long0&&n.longc&&(n.projName==="Albers_Conic_Equal_Area"||n.projName==="Lambert_Azimuthal_Equal_Area")&&(n.long0=n.longc),!n.lat_ts&&n.lat1&&(n.projName==="Stereographic_South_Pole"||n.projName==="Polar Stereographic (variant B)")?(n.lat0=qd(n.lat1>0?90:-90),n.lat_ts=n.lat1):!n.lat_ts&&n.lat0&&n.projName==="Polar_Stereographic"&&(n.lat_ts=n.lat0,n.lat0=qd(n.lat0>0?90:-90))}function CM(n){var e=zD(n),t=e.shift(),i=e.shift();e.unshift(["name",i]),e.unshift(["type",t]);var r={};return Xy(e,r),GD(r),r}function ju(n){var e=this;if(arguments.length===2){var t=arguments[1];typeof t=="string"?t.charAt(0)==="+"?ju[n]=TT(arguments[1]):ju[n]=CM(arguments[1]):ju[n]=t}else if(arguments.length===1){if(Array.isArray(n))return n.map(function(i){Array.isArray(i)?ju.apply(e,i):ju(i)});if(typeof n=="string"){if(n in ju)return ju[n]}else"EPSG"in n?ju["EPSG:"+n.EPSG]=n:"ESRI"in n?ju["ESRI:"+n.ESRI]=n:"IAU2000"in n?ju["IAU2000:"+n.IAU2000]=n:console.log(n);return}}MD(ju);function jD(n){return typeof n=="string"}function qD(n){return n in ju}var HD=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function WD(n){return HD.some(function(e){return n.indexOf(e)>-1})}var XD=["3857","900913","3785","102113"];function ZD(n){var e=Zm(n,"authority");if(e){var t=Zm(e,"epsg");return t&&XD.indexOf(t)>-1}}function YD(n){var e=Zm(n,"extension");if(e)return Zm(e,"proj4")}function KD(n){return n[0]==="+"}function JD(n){if(jD(n)){if(qD(n))return ju[n];if(WD(n)){var e=CM(n);if(ZD(e))return ju["EPSG:3857"];var t=YD(e);return t?TT(t):e}if(KD(n))return TT(n)}else return n}function LC(n,e){n=n||{};var t,i;if(!e)return n;for(i in e)t=e[i],t!==void 0&&(n[i]=t);return n}function tp(n,e,t){var i=n*e;return t/Math.sqrt(1-i*i)}function j1(n){return n<0?-1:1}function ai(n){return Math.abs(n)<=xa?n:n-j1(n)*v1}function ed(n,e,t){var i=n*t,r=.5*n;return i=Math.pow((1-i)/(1+i),r),Math.tan(.5*(En-e))/i}function b1(n,e){for(var t=.5*n,i,r,a=En-2*Math.atan(e),h=0;h<=15;h++)if(i=n*Math.sin(a),r=En-2*Math.atan(e*Math.pow((1-i)/(1+i),t))-a,a+=r,Math.abs(r)<=1e-10)return a;return-9999}function QD(){var n=this.b/this.a;this.es=1-n*n,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=tp(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function $D(n){var e=n.x,t=n.y;if(t*Kd>90&&t*Kd<-90&&e*Kd>180&&e*Kd<-180)return null;var i,r;if(Math.abs(Math.abs(t)-En)<=ei)return null;if(this.sphere)i=this.x0+this.a*this.k0*ai(e-this.long0),r=this.y0+this.a*this.k0*Math.log(Math.tan(Ls+.5*t));else{var a=Math.sin(t),h=ed(this.e,t,a);i=this.x0+this.a*this.k0*ai(e-this.long0),r=this.y0-this.a*this.k0*Math.log(h)}return n.x=i,n.y=r,n}function eO(n){var e=n.x-this.x0,t=n.y-this.y0,i,r;if(this.sphere)r=En-2*Math.atan(Math.exp(-t/(this.a*this.k0)));else{var a=Math.exp(-t/(this.a*this.k0));if(r=b1(this.e,a),r===-9999)return null}return i=ai(this.long0+e/(this.a*this.k0)),n.x=i,n.y=r,n}var tO=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"];const nO={init:QD,forward:$D,inverse:eO,names:tO};function iO(){}function PC(n){return n}var rO=["longlat","identity"];const sO={init:iO,forward:PC,inverse:PC,names:rO};var oO=[nO,sO],aE={},yE=[];function AM(n,e){var t=yE.length;return n.names?(yE[t]=n,n.names.forEach(function(i){aE[i.toLowerCase()]=t}),this):(console.log(e),!0)}function aO(n){if(!n)return!1;var e=n.toLowerCase();if(typeof aE[e]<"u"&&yE[aE[e]])return yE[aE[e]]}function lO(){oO.forEach(AM)}const uO={start:lO,add:AM,get:aO};var hr={};hr.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};hr.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};hr.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"};hr.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};hr.airy={a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"};hr.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};hr.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};hr.mod_airy={a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"};hr.andrae={a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};hr.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"};hr.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};hr.bessel={a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"};hr.bess_nam={a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};hr.clrk66={a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"};hr.clrk80={a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."};hr.clrk80ign={a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"};hr.clrk58={a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"};hr.CPM={a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};hr.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};hr.engelis={a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"};hr.evrst30={a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"};hr.evrst48={a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"};hr.evrst56={a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"};hr.evrst69={a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"};hr.evrstSS={a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"};hr.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};hr.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};hr.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};hr.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};hr.hough={a:6378270,rf:297,ellipseName:"Hough"};hr.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};hr.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};hr.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};hr.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};hr.new_intl={a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"};hr.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};hr.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};hr.SEasia={a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"};hr.walbeck={a:6376896,b:63558348467e-4,ellipseName:"Walbeck"};hr.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"};hr.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};hr.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var cO=hr.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};hr.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};function hO(n,e,t,i){var r=n*n,a=e*e,h=(r-a)/r,s=0;i?(n*=1-h*(RD+h*(DD+h*OD)),r=n*n,h=0):s=Math.sqrt(h);var p=(r-a)/a;return{es:h,e:s,ep2:p}}function fO(n,e,t,i,r){if(!n){var a=Zm(hr,i);a||(a=cO),n=a.a,e=a.b,t=a.rf}return t&&!e&&(e=(1-1/t)*n),(t===0||Math.abs(n-e)<ei)&&(r=!0,e=n),{a:n,b:e,rf:t,sphere:r}}var Pl={};Pl.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"};Pl.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"};Pl.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"};Pl.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"};Pl.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"};Pl.potsdam={towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"};Pl.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"};Pl.hermannskogel={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"};Pl.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"};Pl.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"};Pl.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"};Pl.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"};Pl.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"};Pl.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"};Pl.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"};Pl.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"};Pl.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};function dO(n,e,t,i,r,a,h){var s={};return n===void 0||n==="none"?s.datum_type=IT:s.datum_type=LD,e&&(s.datum_params=e.map(parseFloat),(s.datum_params[0]!==0||s.datum_params[1]!==0||s.datum_params[2]!==0)&&(s.datum_type=f_),s.datum_params.length>3&&(s.datum_params[3]!==0||s.datum_params[4]!==0||s.datum_params[5]!==0||s.datum_params[6]!==0)&&(s.datum_type=d_,s.datum_params[3]*=m1,s.datum_params[4]*=m1,s.datum_params[5]*=m1,s.datum_params[6]=s.datum_params[6]/1e6+1)),h&&(s.datum_type=rv,s.grids=h),s.a=t,s.b=i,s.es=r,s.ep2=a,s}var MM={};function pO(n,e){var t=new DataView(e),i=_O(t),r=yO(t,i);r.nSubgrids>1&&console.log("Only single NTv2 subgrids are currently supported, subsequent sub grids are ignored");var a=vO(t,r,i),h={header:r,subgrids:a};return MM[n]=h,h}function mO(n){if(n===void 0)return null;var e=n.split(",");return e.map(gO)}function gO(n){if(n.length===0)return null;var e=n[0]==="@";return e&&(n=n.slice(1)),n==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:n,mandatory:!e,grid:MM[n]||null,isNull:!1}}function Zy(n){return n/3600*Math.PI/180}function _O(n){var e=n.getInt32(8,!1);return e===11?!1:(e=n.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function yO(n,e){return{nFields:n.getInt32(8,e),nSubgridFields:n.getInt32(24,e),nSubgrids:n.getInt32(40,e),shiftType:ST(n,56,56+8).trim(),fromSemiMajorAxis:n.getFloat64(120,e),fromSemiMinorAxis:n.getFloat64(136,e),toSemiMajorAxis:n.getFloat64(152,e),toSemiMinorAxis:n.getFloat64(168,e)}}function ST(n,e,t){return String.fromCharCode.apply(null,new Uint8Array(n.buffer.slice(e,t)))}function vO(n,e,t){for(var i=176,r=[],a=0;a<e.nSubgrids;a++){var h=bO(n,i,t),s=EO(n,i,h,t),p=Math.round(1+(h.upperLongitude-h.lowerLongitude)/h.longitudeInterval),x=Math.round(1+(h.upperLatitude-h.lowerLatitude)/h.latitudeInterval);r.push({ll:[Zy(h.lowerLongitude),Zy(h.lowerLatitude)],del:[Zy(h.longitudeInterval),Zy(h.latitudeInterval)],lim:[p,x],count:h.gridNodeCount,cvs:xO(s)})}return r}function xO(n){return n.map(function(e){return[Zy(e.longitudeShift),Zy(e.latitudeShift)]})}function bO(n,e,t){return{name:ST(n,e+8,e+16).trim(),parent:ST(n,e+24,e+24+8).trim(),lowerLatitude:n.getFloat64(e+72,t),upperLatitude:n.getFloat64(e+88,t),lowerLongitude:n.getFloat64(e+104,t),upperLongitude:n.getFloat64(e+120,t),latitudeInterval:n.getFloat64(e+136,t),longitudeInterval:n.getFloat64(e+152,t),gridNodeCount:n.getInt32(e+168,t)}}function EO(n,e,t,i){for(var r=e+176,a=16,h=[],s=0;s<t.gridNodeCount;s++){var p={latitudeShift:n.getFloat32(r+s*a,i),longitudeShift:n.getFloat32(r+s*a+4,i),latitudeAccuracy:n.getFloat32(r+s*a+8,i),longitudeAccuracy:n.getFloat32(r+s*a+12,i)};h.push(p)}return h}function Qd(n,e){if(!(this instanceof Qd))return new Qd(n);e=e||function(x){if(x)throw x};var t=JD(n);if(typeof t!="object"){e(n);return}var i=Qd.projections.get(t.projName);if(!i){e(n);return}if(t.datumCode&&t.datumCode!=="none"){var r=Zm(Pl,t.datumCode);r&&(t.datum_params=t.datum_params||(r.towgs84?r.towgs84.split(","):null),t.ellps=r.ellipse,t.datumName=r.datumName?r.datumName:t.datumCode)}t.k0=t.k0||1,t.axis=t.axis||"enu",t.ellps=t.ellps||"wgs84",t.lat1=t.lat1||t.lat0;var a=fO(t.a,t.b,t.rf,t.ellps,t.sphere),h=hO(a.a,a.b,a.rf,t.R_A),s=mO(t.nadgrids),p=t.datum||dO(t.datumCode,t.datum_params,a.a,a.b,h.es,h.ep2,s);LC(this,t),LC(this,i),this.a=a.a,this.b=a.b,this.rf=a.rf,this.sphere=a.sphere,this.es=h.es,this.e=h.e,this.ep2=h.ep2,this.datum=p,this.init(),e(null,this)}Qd.projections=uO;Qd.projections.start();function wO(n,e){return n.datum_type!==e.datum_type||n.a!==e.a||Math.abs(n.es-e.es)>5e-11?!1:n.datum_type===f_?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]:n.datum_type===d_?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]&&n.datum_params[3]===e.datum_params[3]&&n.datum_params[4]===e.datum_params[4]&&n.datum_params[5]===e.datum_params[5]&&n.datum_params[6]===e.datum_params[6]:!0}function LM(n,e,t){var i=n.x,r=n.y,a=n.z?n.z:0,h,s,p,x;if(r<-En&&r>-1.001*En)r=-En;else if(r>En&&r<1.001*En)r=En;else{if(r<-En)return{x:-1/0,y:-1/0,z:n.z};if(r>En)return{x:1/0,y:1/0,z:n.z}}return i>Math.PI&&(i-=2*Math.PI),s=Math.sin(r),x=Math.cos(r),p=s*s,h=t/Math.sqrt(1-e*p),{x:(h+a)*x*Math.cos(i),y:(h+a)*x*Math.sin(i),z:(h*(1-e)+a)*s}}function PM(n,e,t,i){var r=1e-12,a=r*r,h=30,s,p,x,I,C,M,O,k,z,G,q,Z,K,te=n.x,ie=n.y,Te=n.z?n.z:0,le,fe,Fe;if(s=Math.sqrt(te*te+ie*ie),p=Math.sqrt(te*te+ie*ie+Te*Te),s/t<r){if(le=0,p/t<r)return fe=En,Fe=-i,{x:n.x,y:n.y,z:n.z}}else le=Math.atan2(ie,te);x=Te/p,I=s/p,C=1/Math.sqrt(1-e*(2-e)*I*I),k=I*(1-e)*C,z=x*C,K=0;do K++,O=t/Math.sqrt(1-e*z*z),Fe=s*k+Te*z-O*(1-e*z*z),M=e*O/(O+Fe),C=1/Math.sqrt(1-M*(2-M)*I*I),G=I*(1-M)*C,q=x*C,Z=q*k-G*z,k=G,z=q;while(Z*Z>a&&K<h);return fe=Math.atan(q/Math.abs(G)),{x:le,y:fe,z:Fe}}function IO(n,e,t){if(e===f_)return{x:n.x+t[0],y:n.y+t[1],z:n.z+t[2]};if(e===d_){var i=t[0],r=t[1],a=t[2],h=t[3],s=t[4],p=t[5],x=t[6];return{x:x*(n.x-p*n.y+s*n.z)+i,y:x*(p*n.x+n.y-h*n.z)+r,z:x*(-s*n.x+h*n.y+n.z)+a}}}function TO(n,e,t){if(e===f_)return{x:n.x-t[0],y:n.y-t[1],z:n.z-t[2]};if(e===d_){var i=t[0],r=t[1],a=t[2],h=t[3],s=t[4],p=t[5],x=t[6],I=(n.x-i)/x,C=(n.y-r)/x,M=(n.z-a)/x;return{x:I+p*C-s*M,y:-p*I+C+h*M,z:s*I-h*C+M}}}function Yb(n){return n===f_||n===d_}function SO(n,e,t){if(wO(n,e)||n.datum_type===IT||e.datum_type===IT)return t;var i=n.a,r=n.es;if(n.datum_type===rv){var a=RC(n,!1,t);if(a!==0)return;i=SC,r=CC}var h=e.a,s=e.b,p=e.es;if(e.datum_type===rv&&(h=SC,s=PD,p=CC),r===p&&i===h&&!Yb(n.datum_type)&&!Yb(e.datum_type))return t;if(t=LM(t,r,i),Yb(n.datum_type)&&(t=IO(t,n.datum_type,n.datum_params)),Yb(e.datum_type)&&(t=TO(t,e.datum_type,e.datum_params)),t=PM(t,p,h,s),e.datum_type===rv){var x=RC(e,!0,t);if(x!==0)return}return t}function RC(n,e,t){if(n.grids===null||n.grids.length===0)return console.log("Grid shift grids not found"),-1;for(var i={x:-t.x,y:t.y},r={x:Number.NaN,y:Number.NaN},a=[],h=0;h<n.grids.length;h++){var s=n.grids[h];if(a.push(s.name),s.isNull){r=i;break}if(s.mandatory,s.grid===null){if(s.mandatory)return console.log("Unable to find mandatory grid '"+s.name+"'"),-1;continue}var p=s.grid.subgrids[0],x=(Math.abs(p.del[1])+Math.abs(p.del[0]))/1e4,I=p.ll[0]-x,C=p.ll[1]-x,M=p.ll[0]+(p.lim[0]-1)*p.del[0]+x,O=p.ll[1]+(p.lim[1]-1)*p.del[1]+x;if(!(C>i.y||I>i.x||O<i.y||M<i.x)&&(r=CO(i,e,p),!isNaN(r.x)))break}return isNaN(r.x)?(console.log("Failed to find a grid shift table for location '"+-i.x*Kd+" "+i.y*Kd+" tried: '"+a+"'"),-1):(t.x=-r.x,t.y=r.y,0)}function CO(n,e,t){var i={x:Number.NaN,y:Number.NaN};if(isNaN(n.x))return i;var r={x:n.x,y:n.y};r.x-=t.ll[0],r.y-=t.ll[1],r.x=ai(r.x-Math.PI)+Math.PI;var a=DC(r,t);if(e){if(isNaN(a.x))return i;a.x=r.x-a.x,a.y=r.y-a.y;var h=9,s=1e-12,p,x;do{if(x=DC(a,t),isNaN(x.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}p={x:r.x-(x.x+a.x),y:r.y-(x.y+a.y)},a.x+=p.x,a.y+=p.y}while(h--&&Math.abs(p.x)>s&&Math.abs(p.y)>s);if(h<0)return console.log("Inverse grid shift iterator failed to converge."),i;i.x=ai(a.x+t.ll[0]),i.y=a.y+t.ll[1]}else isNaN(a.x)||(i.x=n.x+a.x,i.y=n.y+a.y);return i}function DC(n,e){var t={x:n.x/e.del[0],y:n.y/e.del[1]},i={x:Math.floor(t.x),y:Math.floor(t.y)},r={x:t.x-1*i.x,y:t.y-1*i.y},a={x:Number.NaN,y:Number.NaN},h;if(i.x<0||i.x>=e.lim[0]||i.y<0||i.y>=e.lim[1])return a;h=i.y*e.lim[0]+i.x;var s={x:e.cvs[h][0],y:e.cvs[h][1]};h++;var p={x:e.cvs[h][0],y:e.cvs[h][1]};h+=e.lim[0];var x={x:e.cvs[h][0],y:e.cvs[h][1]};h--;var I={x:e.cvs[h][0],y:e.cvs[h][1]},C=r.x*r.y,M=r.x*(1-r.y),O=(1-r.x)*(1-r.y),k=(1-r.x)*r.y;return a.x=O*s.x+M*p.x+k*I.x+C*x.x,a.y=O*s.y+M*p.y+k*I.y+C*x.y,a}function OC(n,e,t){var i=t.x,r=t.y,a=t.z||0,h,s,p,x={};for(p=0;p<3;p++)if(!(e&&p===2&&t.z===void 0))switch(p===0?(h=i,"ew".indexOf(n.axis[p])!==-1?s="x":s="y"):p===1?(h=r,"ns".indexOf(n.axis[p])!==-1?s="y":s="x"):(h=a,s="z"),n.axis[p]){case"e":x[s]=h;break;case"w":x[s]=-h;break;case"n":x[s]=h;break;case"s":x[s]=-h;break;case"u":t[s]!==void 0&&(x.z=h);break;case"d":t[s]!==void 0&&(x.z=-h);break;default:return null}return x}function RM(n){var e={x:n[0],y:n[1]};return n.length>2&&(e.z=n[2]),n.length>3&&(e.m=n[3]),e}function AO(n){NC(n.x),NC(n.y)}function NC(n){if(typeof Number.isFinite=="function"){if(Number.isFinite(n))return;throw new TypeError("coordinates must be finite numbers")}if(typeof n!="number"||n!==n||!isFinite(n))throw new TypeError("coordinates must be finite numbers")}function MO(n,e){return(n.datum.datum_type===f_||n.datum.datum_type===d_||n.datum.datum_type===rv)&&e.datumCode!=="WGS84"||(e.datum.datum_type===f_||e.datum.datum_type===d_||e.datum.datum_type===rv)&&n.datumCode!=="WGS84"}function vE(n,e,t,i){var r;Array.isArray(t)?t=RM(t):t={x:t.x,y:t.y,z:t.z,m:t.m};var a=t.z!==void 0;if(AO(t),n.datum&&e.datum&&MO(n,e)&&(r=new Qd("WGS84"),t=vE(n,r,t,i),n=r),i&&n.axis!=="enu"&&(t=OC(n,!1,t)),n.projName==="longlat")t={x:t.x*Hl,y:t.y*Hl,z:t.z||0};else if(n.to_meter&&(t={x:t.x*n.to_meter,y:t.y*n.to_meter,z:t.z||0}),t=n.inverse(t),!t)return;if(n.from_greenwich&&(t.x+=n.from_greenwich),t=SO(n.datum,e.datum,t),!!t)return e.from_greenwich&&(t={x:t.x-e.from_greenwich,y:t.y,z:t.z||0}),e.projName==="longlat"?t={x:t.x*Kd,y:t.y*Kd,z:t.z||0}:(t=e.forward(t),e.to_meter&&(t={x:t.x/e.to_meter,y:t.y/e.to_meter,z:t.z||0})),i&&e.axis!=="enu"?OC(e,!0,t):(a||delete t.z,t)}var kC=Qd("WGS84");function sT(n,e,t,i){var r,a,h;return Array.isArray(t)?(r=vE(n,e,t,i)||{x:NaN,y:NaN},t.length>2?typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof r.z=="number"?[r.x,r.y,r.z].concat(t.splice(3)):[r.x,r.y,t[2]].concat(t.splice(3)):[r.x,r.y].concat(t.splice(2)):[r.x,r.y]):(a=vE(n,e,t,i),h=Object.keys(t),h.length===2||h.forEach(function(s){if(typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(s==="x"||s==="y"||s==="z")return}else if(s==="x"||s==="y")return;a[s]=t[s]}),a)}function FC(n){return n instanceof Qd?n:n.oProj?n.oProj:Qd(n)}function ph(n,e,t){n=FC(n);var i=!1,r;return typeof e>"u"?(e=n,n=kC,i=!0):(typeof e.x<"u"||Array.isArray(e))&&(t=e,e=n,n=kC,i=!0),e=FC(e),t?sT(n,e,t):(r={forward:function(a,h){return sT(n,e,a,h)},inverse:function(a,h){return sT(e,n,a,h)}},i&&(r.oProj=e),r)}var BC=6,DM="AJSAJS",OM="AFAFAF",Yy=65,Cc=73,nf=79,u1=86,c1=90;const LO={forward:NM,inverse:PO,toPoint:kM};function NM(n,e){return e=e||5,OO(RO({lat:n[1],lon:n[0]}),e)}function PO(n){var e=cS(BM(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function kM(n){var e=cS(BM(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function oT(n){return n*(Math.PI/180)}function zC(n){return 180*(n/Math.PI)}function RO(n){var e=n.lat,t=n.lon,i=6378137,r=.00669438,a=.9996,h,s,p,x,I,C,M,O=oT(e),k=oT(t),z,G;G=Math.floor((t+180)/6)+1,t===180&&(G=60),e>=56&&e<64&&t>=3&&t<12&&(G=32),e>=72&&e<84&&(t>=0&&t<9?G=31:t>=9&&t<21?G=33:t>=21&&t<33?G=35:t>=33&&t<42&&(G=37)),h=(G-1)*6-180+3,z=oT(h),s=r/(1-r),p=i/Math.sqrt(1-r*Math.sin(O)*Math.sin(O)),x=Math.tan(O)*Math.tan(O),I=s*Math.cos(O)*Math.cos(O),C=Math.cos(O)*(k-z),M=i*((1-r/4-3*r*r/64-5*r*r*r/256)*O-(3*r/8+3*r*r/32+45*r*r*r/1024)*Math.sin(2*O)+(15*r*r/256+45*r*r*r/1024)*Math.sin(4*O)-35*r*r*r/3072*Math.sin(6*O));var q=a*p*(C+(1-x+I)*C*C*C/6+(5-18*x+x*x+72*I-58*s)*C*C*C*C*C/120)+5e5,Z=a*(M+p*Math.tan(O)*(C*C/2+(5-x+9*I+4*I*I)*C*C*C*C/24+(61-58*x+x*x+600*I-330*s)*C*C*C*C*C*C/720));return e<0&&(Z+=1e7),{northing:Math.round(Z),easting:Math.round(q),zoneNumber:G,zoneLetter:DO(e)}}function cS(n){var e=n.northing,t=n.easting,i=n.zoneLetter,r=n.zoneNumber;if(r<0||r>60)return null;var a=.9996,h=6378137,s=.00669438,p,x=(1-Math.sqrt(1-s))/(1+Math.sqrt(1-s)),I,C,M,O,k,z,G,q,Z,K=t-5e5,te=e;i<"N"&&(te-=1e7),G=(r-1)*6-180+3,p=s/(1-s),z=te/a,q=z/(h*(1-s/4-3*s*s/64-5*s*s*s/256)),Z=q+(3*x/2-27*x*x*x/32)*Math.sin(2*q)+(21*x*x/16-55*x*x*x*x/32)*Math.sin(4*q)+151*x*x*x/96*Math.sin(6*q),I=h/Math.sqrt(1-s*Math.sin(Z)*Math.sin(Z)),C=Math.tan(Z)*Math.tan(Z),M=p*Math.cos(Z)*Math.cos(Z),O=h*(1-s)/Math.pow(1-s*Math.sin(Z)*Math.sin(Z),1.5),k=K/(I*a);var ie=Z-I*Math.tan(Z)/O*(k*k/2-(5+3*C+10*M-4*M*M-9*p)*k*k*k*k/24+(61+90*C+298*M+45*C*C-252*p-3*M*M)*k*k*k*k*k*k/720);ie=zC(ie);var Te=(k-(1+2*C+M)*k*k*k/6+(5-2*M+28*C-3*M*M+8*p+24*C*C)*k*k*k*k*k/120)/Math.cos(Z);Te=G+zC(Te);var le;if(n.accuracy){var fe=cS({northing:n.northing+n.accuracy,easting:n.easting+n.accuracy,zoneLetter:n.zoneLetter,zoneNumber:n.zoneNumber});le={top:fe.lat,right:fe.lon,bottom:ie,left:Te}}else le={lat:ie,lon:Te};return le}function DO(n){var e="Z";return 84>=n&&n>=72?e="X":72>n&&n>=64?e="W":64>n&&n>=56?e="V":56>n&&n>=48?e="U":48>n&&n>=40?e="T":40>n&&n>=32?e="S":32>n&&n>=24?e="R":24>n&&n>=16?e="Q":16>n&&n>=8?e="P":8>n&&n>=0?e="N":0>n&&n>=-8?e="M":-8>n&&n>=-16?e="L":-16>n&&n>=-24?e="K":-24>n&&n>=-32?e="J":-32>n&&n>=-40?e="H":-40>n&&n>=-48?e="G":-48>n&&n>=-56?e="F":-56>n&&n>=-64?e="E":-64>n&&n>=-72?e="D":-72>n&&n>=-80&&(e="C"),e}function OO(n,e){var t="00000"+n.easting,i="00000"+n.northing;return n.zoneNumber+n.zoneLetter+NO(n.easting,n.northing,n.zoneNumber)+t.substr(t.length-5,e)+i.substr(i.length-5,e)}function NO(n,e,t){var i=FM(t),r=Math.floor(n/1e5),a=Math.floor(e/1e5)%20;return kO(r,a,i)}function FM(n){var e=n%BC;return e===0&&(e=BC),e}function kO(n,e,t){var i=t-1,r=DM.charCodeAt(i),a=OM.charCodeAt(i),h=r+n-1,s=a+e,p=!1;h>c1&&(h=h-c1+Yy-1,p=!0),(h===Cc||r<Cc&&h>Cc||(h>Cc||r<Cc)&&p)&&h++,(h===nf||r<nf&&h>nf||(h>nf||r<nf)&&p)&&(h++,h===Cc&&h++),h>c1&&(h=h-c1+Yy-1),s>u1?(s=s-u1+Yy-1,p=!0):p=!1,(s===Cc||a<Cc&&s>Cc||(s>Cc||a<Cc)&&p)&&s++,(s===nf||a<nf&&s>nf||(s>nf||a<nf)&&p)&&(s++,s===Cc&&s++),s>u1&&(s=s-u1+Yy-1);var x=String.fromCharCode(h)+String.fromCharCode(s);return x}function BM(n){if(n&&n.length===0)throw"MGRSPoint coverting from nothing";for(var e=n.length,t=null,i="",r,a=0;!/[A-Z]/.test(r=n.charAt(a));){if(a>=2)throw"MGRSPoint bad conversion from: "+n;i+=r,a++}var h=parseInt(i,10);if(a===0||a+3>e)throw"MGRSPoint bad conversion from: "+n;var s=n.charAt(a++);if(s<="A"||s==="B"||s==="Y"||s>="Z"||s==="I"||s==="O")throw"MGRSPoint zone letter "+s+" not handled: "+n;t=n.substring(a,a+=2);for(var p=FM(h),x=FO(t.charAt(0),p),I=BO(t.charAt(1),p);I<zO(s);)I+=2e6;var C=e-a;if(C%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+n;var M=C/2,O=0,k=0,z,G,q,Z,K;return M>0&&(z=1e5/Math.pow(10,M),G=n.substring(a,a+M),O=parseFloat(G)*z,q=n.substring(a+M),k=parseFloat(q)*z),Z=O+x,K=k+I,{easting:Z,northing:K,zoneLetter:s,zoneNumber:h,accuracy:z}}function FO(n,e){for(var t=DM.charCodeAt(e-1),i=1e5,r=!1;t!==n.charCodeAt(0);){if(t++,t===Cc&&t++,t===nf&&t++,t>c1){if(r)throw"Bad character: "+n;t=Yy,r=!0}i+=1e5}return i}function BO(n,e){if(n>"V")throw"MGRSPoint given invalid Northing "+n;for(var t=OM.charCodeAt(e-1),i=0,r=!1;t!==n.charCodeAt(0);){if(t++,t===Cc&&t++,t===nf&&t++,t>u1){if(r)throw"Bad character: "+n;t=Yy,r=!0}i+=1e5}return i}function zO(n){var e;switch(n){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+n}function pv(n,e,t){if(!(this instanceof pv))return new pv(n,e,t);if(Array.isArray(n))this.x=n[0],this.y=n[1],this.z=n[2]||0;else if(typeof n=="object")this.x=n.x,this.y=n.y,this.z=n.z||0;else if(typeof n=="string"&&typeof e>"u"){var i=n.split(",");this.x=parseFloat(i[0],10),this.y=parseFloat(i[1],10),this.z=parseFloat(i[2],10)||0}else this.x=n,this.y=e,this.z=t||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}pv.fromMGRS=function(n){return new pv(kM(n))};pv.prototype.toMGRS=function(n){return NM([this.x,this.y],n)};var UO=1,VO=.25,UC=.046875,VC=.01953125,GC=.01068115234375,GO=.75,jO=.46875,qO=.013020833333333334,HO=.007120768229166667,WO=.3645833333333333,XO=.005696614583333333,ZO=.3076171875;function zM(n){var e=[];e[0]=UO-n*(VO+n*(UC+n*(VC+n*GC))),e[1]=n*(GO-n*(UC+n*(VC+n*GC)));var t=n*n;return e[2]=t*(jO-n*(qO+n*HO)),t*=n,e[3]=t*(WO-n*XO),e[4]=t*n*ZO,e}function jE(n,e,t,i){return t*=e,e*=e,i[0]*n-t*(i[1]+e*(i[2]+e*(i[3]+e*i[4])))}var YO=20;function UM(n,e,t){for(var i=1/(1-e),r=n,a=YO;a;--a){var h=Math.sin(r),s=1-e*h*h;if(s=(jE(r,h,Math.cos(r),t)-n)*(s*Math.sqrt(s))*i,r-=s,Math.abs(s)<ei)return r}return r}function KO(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=zM(this.es),this.ml0=jE(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function JO(n){var e=n.x,t=n.y,i=ai(e-this.long0),r,a,h,s=Math.sin(t),p=Math.cos(t);if(this.es){var I=p*i,C=Math.pow(I,2),M=this.ep2*Math.pow(p,2),O=Math.pow(M,2),k=Math.abs(p)>ei?Math.tan(t):0,z=Math.pow(k,2),G=Math.pow(z,2);r=1-this.es*Math.pow(s,2),I=I/Math.sqrt(r);var q=jE(t,s,p,this.en);a=this.a*(this.k0*I*(1+C/6*(1-z+M+C/20*(5-18*z+G+14*M-58*z*M+C/42*(61+179*G-G*z-479*z)))))+this.x0,h=this.a*(this.k0*(q-this.ml0+s*i*I/2*(1+C/12*(5-z+9*M+4*O+C/30*(61+G-58*z+270*M-330*z*M+C/56*(1385+543*G-G*z-3111*z))))))+this.y0}else{var x=p*Math.sin(i);if(Math.abs(Math.abs(x)-1)<ei)return 93;if(a=.5*this.a*this.k0*Math.log((1+x)/(1-x))+this.x0,h=p*Math.cos(i)/Math.sqrt(1-Math.pow(x,2)),x=Math.abs(h),x>=1){if(x-1>ei)return 93;h=0}else h=Math.acos(h);t<0&&(h=-h),h=this.a*this.k0*(h-this.lat0)+this.y0}return n.x=a,n.y=h,n}function QO(n){var e,t,i,r,a=(n.x-this.x0)*(1/this.a),h=(n.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+h/this.k0,t=UM(e,this.es,this.en),Math.abs(t)<En){var C=Math.sin(t),M=Math.cos(t),O=Math.abs(M)>ei?Math.tan(t):0,k=this.ep2*Math.pow(M,2),z=Math.pow(k,2),G=Math.pow(O,2),q=Math.pow(G,2);e=1-this.es*Math.pow(C,2);var Z=a*Math.sqrt(e)/this.k0,K=Math.pow(Z,2);e=e*O,i=t-e*K/(1-this.es)*.5*(1-K/12*(5+3*G-9*k*G+k-4*z-K/30*(61+90*G-252*k*G+45*q+46*k-K/56*(1385+3633*G+4095*q+1574*q*G)))),r=ai(this.long0+Z*(1-K/6*(1+2*G+k-K/20*(5+28*G+24*q+8*k*G+6*k-K/42*(61+662*G+1320*q+720*q*G))))/M)}else i=En*j1(h),r=0;else{var s=Math.exp(a/this.k0),p=.5*(s-1/s),x=this.lat0+h/this.k0,I=Math.cos(x);e=Math.sqrt((1-Math.pow(I,2))/(1+Math.pow(p,2))),i=Math.asin(e),h<0&&(i=-i),p===0&&I===0?r=0:r=ai(Math.atan2(p,I)+this.long0)}return n.x=r,n.y=i,n}var $O=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const lE={init:KO,forward:JO,inverse:QO,names:$O};function VM(n){var e=Math.exp(n);return e=(e-1/e)/2,e}function Qf(n,e){n=Math.abs(n),e=Math.abs(e);var t=Math.max(n,e),i=Math.min(n,e)/(t||1);return t*Math.sqrt(1+Math.pow(i,2))}function eN(n){var e=1+n,t=e-1;return t===0?n:n*Math.log(e)/t}function tN(n){var e=Math.abs(n);return e=eN(e*(1+e/(Qf(1,e)+1))),n<0?-e:e}function hS(n,e){for(var t=2*Math.cos(2*e),i=n.length-1,r=n[i],a=0,h;--i>=0;)h=-a+t*r+n[i],a=r,r=h;return e+h*Math.sin(2*e)}function nN(n,e){for(var t=2*Math.cos(e),i=n.length-1,r=n[i],a=0,h;--i>=0;)h=-a+t*r+n[i],a=r,r=h;return Math.sin(e)*h}function iN(n){var e=Math.exp(n);return e=(e+1/e)/2,e}function GM(n,e,t){for(var i=Math.sin(e),r=Math.cos(e),a=VM(t),h=iN(t),s=2*r*h,p=-2*i*a,x=n.length-1,I=n[x],C=0,M=0,O=0,k,z;--x>=0;)k=M,z=C,M=I,C=O,I=-k+s*M-p*C+n[x],O=-z+p*M+s*C;return s=i*h,p=r*a,[s*I-p*O,s*O+p*I]}function rN(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(lE.init.apply(this),this.forward=lE.forward,this.inverse=lE.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var n=this.es/(1+Math.sqrt(1-this.es)),e=n/(2-n),t=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),t=t*e,this.cgb[1]=t*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=t*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),t=t*e,this.cgb[2]=t*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=t*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),t=t*e,this.cgb[3]=t*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=t*(1237/630+e*(-12/5+e*(-24832/14175))),t=t*e,this.cgb[4]=t*(4174/315+e*(-144838/6237)),this.cbg[4]=t*(-734/315+e*(109598/31185)),t=t*e,this.cgb[5]=t*(601676/22275),this.cbg[5]=t*(444337/155925),t=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+t*(1/4+t*(1/64+t/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=t*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=t*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),t=t*e,this.utg[2]=t*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=t*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),t=t*e,this.utg[3]=t*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=t*(49561/161280+e*(-179/168+e*(6601661/7257600))),t=t*e,this.utg[4]=t*(-4583/161280+e*(108847/3991680)),this.gtu[4]=t*(34729/80640+e*(-3418889/1995840)),t=t*e,this.utg[5]=t*(-20648693/638668800),this.gtu[5]=t*(212378941/319334400);var i=hS(this.cbg,this.lat0);this.Zb=-this.Qn*(i+nN(this.gtu,2*i))}function sN(n){var e=ai(n.x-this.long0),t=n.y;t=hS(this.cbg,t);var i=Math.sin(t),r=Math.cos(t),a=Math.sin(e),h=Math.cos(e);t=Math.atan2(i,h*r),e=Math.atan2(a*r,Qf(i,r*h)),e=tN(Math.tan(e));var s=GM(this.gtu,2*t,2*e);t=t+s[0],e=e+s[1];var p,x;return Math.abs(e)<=2.623395162778?(p=this.a*(this.Qn*e)+this.x0,x=this.a*(this.Qn*t+this.Zb)+this.y0):(p=1/0,x=1/0),n.x=p,n.y=x,n}function oN(n){var e=(n.x-this.x0)*(1/this.a),t=(n.y-this.y0)*(1/this.a);t=(t-this.Zb)/this.Qn,e=e/this.Qn;var i,r;if(Math.abs(e)<=2.623395162778){var a=GM(this.utg,2*t,2*e);t=t+a[0],e=e+a[1],e=Math.atan(VM(e));var h=Math.sin(t),s=Math.cos(t),p=Math.sin(e),x=Math.cos(e);t=Math.atan2(h*x,Qf(p,x*s)),e=Math.atan2(p,x*s),i=ai(e+this.long0),r=hS(this.cgb,t)}else i=1/0,r=1/0;return n.x=i,n.y=r,n}var aN=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","tmerc"];const uE={init:rN,forward:sN,inverse:oN,names:aN};function lN(n,e){if(n===void 0){if(n=Math.floor((ai(e)+Math.PI)*30/Math.PI)+1,n<0)return 0;if(n>60)return 60}return n}var uN="etmerc";function cN(){var n=lN(this.zone,this.long0);if(n===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(n)-183)*Hl,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,uE.init.apply(this),this.forward=uE.forward,this.inverse=uE.inverse}var hN=["Universal Transverse Mercator System","utm"];const fN={init:cN,names:hN,dependsOn:uN};function fS(n,e){return Math.pow((1-n)/(1+n),e)}var dN=20;function pN(){var n=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*n*n),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(n/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Ls)/(Math.pow(Math.tan(.5*this.lat0+Ls),this.C)*fS(this.e*n,this.ratexp))}function mN(n){var e=n.x,t=n.y;return n.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*t+Ls),this.C)*fS(this.e*Math.sin(t),this.ratexp))-En,n.x=this.C*e,n}function gN(n){for(var e=1e-14,t=n.x/this.C,i=n.y,r=Math.pow(Math.tan(.5*i+Ls)/this.K,1/this.C),a=dN;a>0&&(i=2*Math.atan(r*fS(this.e*Math.sin(n.y),-.5*this.e))-En,!(Math.abs(i-n.y)<e));--a)n.y=i;return a?(n.x=t,n.y=i,n):null}var _N=["gauss"];const dS={init:pN,forward:mN,inverse:gN,names:_N};function yN(){dS.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function vN(n){var e,t,i,r;return n.x=ai(n.x-this.long0),dS.forward.apply(this,[n]),e=Math.sin(n.y),t=Math.cos(n.y),i=Math.cos(n.x),r=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*t*i),n.x=r*t*Math.sin(n.x),n.y=r*(this.cosc0*e-this.sinc0*t*i),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function xN(n){var e,t,i,r,a;if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,a=Math.sqrt(n.x*n.x+n.y*n.y)){var h=2*Math.atan2(a,this.R2);e=Math.sin(h),t=Math.cos(h),r=Math.asin(t*this.sinc0+n.y*e*this.cosc0/a),i=Math.atan2(n.x*e,a*this.cosc0*t-n.y*this.sinc0*e)}else r=this.phic0,i=0;return n.x=i,n.y=r,dS.inverse.apply(this,[n]),n.x=ai(n.x+this.long0),n}var bN=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const EN={init:yN,forward:vN,inverse:xN,names:bN};function wN(n,e,t){return e*=t,Math.tan(.5*(En+n))*Math.pow((1-e)/(1+e),.5*t)}function IN(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ei&&(this.k0=.5*(1+j1(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=ei&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ei&&(this.k0=.5*this.cons*tp(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/ed(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=tp(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-En,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function TN(n){var e=n.x,t=n.y,i=Math.sin(t),r=Math.cos(t),a,h,s,p,x,I,C=ai(e-this.long0);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=ei&&Math.abs(t+this.lat0)<=ei?(n.x=NaN,n.y=NaN,n):this.sphere?(a=2*this.k0/(1+this.sinlat0*i+this.coslat0*r*Math.cos(C)),n.x=this.a*a*r*Math.sin(C)+this.x0,n.y=this.a*a*(this.coslat0*i-this.sinlat0*r*Math.cos(C))+this.y0,n):(h=2*Math.atan(this.ssfn_(t,i,this.e))-En,p=Math.cos(h),s=Math.sin(h),Math.abs(this.coslat0)<=ei?(x=ed(this.e,t*this.con,this.con*i),I=2*this.a*this.k0*x/this.cons,n.x=this.x0+I*Math.sin(e-this.long0),n.y=this.y0-this.con*I*Math.cos(e-this.long0),n):(Math.abs(this.sinlat0)<ei?(a=2*this.a*this.k0/(1+p*Math.cos(C)),n.y=a*s):(a=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*s+this.cosX0*p*Math.cos(C))),n.y=a*(this.cosX0*s-this.sinX0*p*Math.cos(C))+this.y0),n.x=a*p*Math.sin(C)+this.x0,n))}function SN(n){n.x-=this.x0,n.y-=this.y0;var e,t,i,r,a,h=Math.sqrt(n.x*n.x+n.y*n.y);if(this.sphere){var s=2*Math.atan(h/(2*this.a*this.k0));return e=this.long0,t=this.lat0,h<=ei?(n.x=e,n.y=t,n):(t=Math.asin(Math.cos(s)*this.sinlat0+n.y*Math.sin(s)*this.coslat0/h),Math.abs(this.coslat0)<ei?this.lat0>0?e=ai(this.long0+Math.atan2(n.x,-1*n.y)):e=ai(this.long0+Math.atan2(n.x,n.y)):e=ai(this.long0+Math.atan2(n.x*Math.sin(s),h*this.coslat0*Math.cos(s)-n.y*this.sinlat0*Math.sin(s))),n.x=e,n.y=t,n)}else if(Math.abs(this.coslat0)<=ei){if(h<=ei)return t=this.lat0,e=this.long0,n.x=e,n.y=t,n;n.x*=this.con,n.y*=this.con,i=h*this.cons/(2*this.a*this.k0),t=this.con*b1(this.e,i),e=this.con*ai(this.con*this.long0+Math.atan2(n.x,-1*n.y))}else r=2*Math.atan(h*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,h<=ei?a=this.X0:(a=Math.asin(Math.cos(r)*this.sinX0+n.y*Math.sin(r)*this.cosX0/h),e=ai(this.long0+Math.atan2(n.x*Math.sin(r),h*this.cosX0*Math.cos(r)-n.y*this.sinX0*Math.sin(r)))),t=-1*b1(this.e,Math.tan(.5*(En+a)));return n.x=e,n.y=t,n}var CN=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"];const AN={init:IN,forward:TN,inverse:SN,names:CN,ssfn_:wN};function MN(){var n=this.lat0;this.lambda0=this.long0;var e=Math.sin(n),t=this.a,i=this.rf,r=1/i,a=2*r-Math.pow(r,2),h=this.e=Math.sqrt(a);this.R=this.k0*t*Math.sqrt(1-a)/(1-a*Math.pow(e,2)),this.alpha=Math.sqrt(1+a/(1-a)*Math.pow(Math.cos(n),4)),this.b0=Math.asin(e/this.alpha);var s=Math.log(Math.tan(Math.PI/4+this.b0/2)),p=Math.log(Math.tan(Math.PI/4+n/2)),x=Math.log((1+h*e)/(1-h*e));this.K=s-this.alpha*p+this.alpha*h/2*x}function LN(n){var e=Math.log(Math.tan(Math.PI/4-n.y/2)),t=this.e/2*Math.log((1+this.e*Math.sin(n.y))/(1-this.e*Math.sin(n.y))),i=-this.alpha*(e+t)+this.K,r=2*(Math.atan(Math.exp(i))-Math.PI/4),a=this.alpha*(n.x-this.lambda0),h=Math.atan(Math.sin(a)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(a))),s=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(a));return n.y=this.R/2*Math.log((1+Math.sin(s))/(1-Math.sin(s)))+this.y0,n.x=this.R*h+this.x0,n}function PN(n){for(var e=n.x-this.x0,t=n.y-this.y0,i=e/this.R,r=2*(Math.atan(Math.exp(t/this.R))-Math.PI/4),a=Math.asin(Math.cos(this.b0)*Math.sin(r)+Math.sin(this.b0)*Math.cos(r)*Math.cos(i)),h=Math.atan(Math.sin(i)/(Math.cos(this.b0)*Math.cos(i)-Math.sin(this.b0)*Math.tan(r))),s=this.lambda0+h/this.alpha,p=0,x=a,I=-1e3,C=0;Math.abs(x-I)>1e-7;){if(++C>20)return;p=1/this.alpha*(Math.log(Math.tan(Math.PI/4+a/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(x))/2)),I=x,x=2*Math.atan(Math.exp(p))-Math.PI/2}return n.x=s,n.y=x,n}var RN=["somerc"];const DN={init:MN,forward:LN,inverse:PN,names:RN};var Wy=1e-7;function ON(n){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],t=typeof n.PROJECTION=="object"?Object.keys(n.PROJECTION)[0]:n.PROJECTION;return"no_uoff"in n||"no_off"in n||e.indexOf(t)!==-1}function NN(){var n,e,t,i,r,a,h,s,p,x,I=0,C,M=0,O=0,k=0,z=0,G=0,q=0;this.no_off=ON(this),this.no_rot="no_rot"in this;var Z=!1;"alpha"in this&&(Z=!0);var K=!1;if("rectified_grid_angle"in this&&(K=!0),Z&&(q=this.alpha),K&&(I=this.rectified_grid_angle*Hl),Z||K)M=this.longc;else if(O=this.long1,z=this.lat1,k=this.long2,G=this.lat2,Math.abs(z-G)<=Wy||(n=Math.abs(z))<=Wy||Math.abs(n-En)<=Wy||Math.abs(Math.abs(this.lat0)-En)<=Wy||Math.abs(Math.abs(G)-En)<=Wy)throw new Error;var te=1-this.es;e=Math.sqrt(te),Math.abs(this.lat0)>ei?(s=Math.sin(this.lat0),t=Math.cos(this.lat0),n=1-this.es*s*s,this.B=t*t,this.B=Math.sqrt(1+this.es*this.B*this.B/te),this.A=this.B*this.k0*e/n,i=this.B*e/(t*Math.sqrt(n)),r=i*i-1,r<=0?r=0:(r=Math.sqrt(r),this.lat0<0&&(r=-r)),this.E=r+=i,this.E*=Math.pow(ed(this.e,this.lat0,s),this.B)):(this.B=1/e,this.A=this.k0,this.E=i=r=1),Z||K?(Z?(C=Math.asin(Math.sin(q)/i),K||(I=q)):(C=I,q=Math.asin(i*Math.sin(C))),this.lam0=M-Math.asin(.5*(r-1/r)*Math.tan(C))/this.B):(a=Math.pow(ed(this.e,z,Math.sin(z)),this.B),h=Math.pow(ed(this.e,G,Math.sin(G)),this.B),r=this.E/a,p=(h-a)/(h+a),x=this.E*this.E,x=(x-h*a)/(x+h*a),n=O-k,n<-Math.pi?k-=v1:n>Math.pi&&(k+=v1),this.lam0=ai(.5*(O+k)-Math.atan(x*Math.tan(.5*this.B*(O-k))/p)/this.B),C=Math.atan(2*Math.sin(this.B*ai(O-this.lam0))/(r-1/r)),I=q=Math.asin(i*Math.sin(C))),this.singam=Math.sin(C),this.cosgam=Math.cos(C),this.sinrot=Math.sin(I),this.cosrot=Math.cos(I),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A*this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(i*i-1)/Math.cos(q))),this.lat0<0&&(this.u_0=-this.u_0)),r=.5*C,this.v_pole_n=this.ArB*Math.log(Math.tan(Ls-r)),this.v_pole_s=this.ArB*Math.log(Math.tan(Ls+r))}function kN(n){var e={},t,i,r,a,h,s,p,x;if(n.x=n.x-this.lam0,Math.abs(Math.abs(n.y)-En)>ei){if(h=this.E/Math.pow(ed(this.e,n.y,Math.sin(n.y)),this.B),s=1/h,t=.5*(h-s),i=.5*(h+s),a=Math.sin(this.B*n.x),r=(t*this.singam-a*this.cosgam)/i,Math.abs(Math.abs(r)-1)<ei)throw new Error;x=.5*this.ArB*Math.log((1-r)/(1+r)),s=Math.cos(this.B*n.x),Math.abs(s)<Wy?p=this.A*n.x:p=this.ArB*Math.atan2(t*this.cosgam+a*this.singam,s)}else x=n.y>0?this.v_pole_n:this.v_pole_s,p=this.ArB*n.y;return this.no_rot?(e.x=p,e.y=x):(p-=this.u_0,e.x=x*this.cosrot+p*this.sinrot,e.y=p*this.cosrot-x*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function FN(n){var e,t,i,r,a,h,s,p={};if(n.x=(n.x-this.x0)*(1/this.a),n.y=(n.y-this.y0)*(1/this.a),this.no_rot?(t=n.y,e=n.x):(t=n.x*this.cosrot-n.y*this.sinrot,e=n.y*this.cosrot+n.x*this.sinrot+this.u_0),i=Math.exp(-this.BrA*t),r=.5*(i-1/i),a=.5*(i+1/i),h=Math.sin(this.BrA*e),s=(h*this.cosgam+r*this.singam)/a,Math.abs(Math.abs(s)-1)<ei)p.x=0,p.y=s<0?-En:En;else{if(p.y=this.E/Math.sqrt((1+s)/(1-s)),p.y=b1(this.e,Math.pow(p.y,1/this.B)),p.y===1/0)throw new Error;p.x=-this.rB*Math.atan2(r*this.cosgam-h*this.singam,Math.cos(this.BrA*e))}return p.x+=this.lam0,p}var BN=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const zN={init:NN,forward:kN,inverse:FN,names:BN};function UN(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<ei)){var n=this.b/this.a;this.e=Math.sqrt(1-n*n);var e=Math.sin(this.lat1),t=Math.cos(this.lat1),i=tp(this.e,e,t),r=ed(this.e,this.lat1,e),a=Math.sin(this.lat2),h=Math.cos(this.lat2),s=tp(this.e,a,h),p=ed(this.e,this.lat2,a),x=ed(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>ei?this.ns=Math.log(i/s)/Math.log(r/p):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=i/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(x,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function VN(n){var e=n.x,t=n.y;Math.abs(2*Math.abs(t)-Math.PI)<=ei&&(t=j1(t)*(En-2*ei));var i=Math.abs(Math.abs(t)-En),r,a;if(i>ei)r=ed(this.e,t,Math.sin(t)),a=this.a*this.f0*Math.pow(r,this.ns);else{if(i=t*this.ns,i<=0)return null;a=0}var h=this.ns*ai(e-this.long0);return n.x=this.k0*(a*Math.sin(h))+this.x0,n.y=this.k0*(this.rh-a*Math.cos(h))+this.y0,n}function GN(n){var e,t,i,r,a,h=(n.x-this.x0)/this.k0,s=this.rh-(n.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(h*h+s*s),t=1):(e=-Math.sqrt(h*h+s*s),t=-1);var p=0;if(e!==0&&(p=Math.atan2(t*h,t*s)),e!==0||this.ns>0){if(t=1/this.ns,i=Math.pow(e/(this.a*this.f0),t),r=b1(this.e,i),r===-9999)return null}else r=-En;return a=ai(p/this.ns+this.long0),n.x=a,n.y=r,n}var jN=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const qN={init:UN,forward:VN,inverse:GN,names:jN};function HN(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function WN(n){var e,t,i,r,a,h,s,p=n.x,x=n.y,I=ai(p-this.long0);return e=Math.pow((1+this.e*Math.sin(x))/(1-this.e*Math.sin(x)),this.alfa*this.e/2),t=2*(Math.atan(this.k*Math.pow(Math.tan(x/2+this.s45),this.alfa)/e)-this.s45),i=-I*this.alfa,r=Math.asin(Math.cos(this.ad)*Math.sin(t)+Math.sin(this.ad)*Math.cos(t)*Math.cos(i)),a=Math.asin(Math.cos(t)*Math.sin(i)/Math.cos(r)),h=this.n*a,s=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(r/2+this.s45),this.n),n.y=s*Math.cos(h)/1,n.x=s*Math.sin(h)/1,this.czech||(n.y*=-1,n.x*=-1),n}function XN(n){var e,t,i,r,a,h,s,p,x=n.x;n.x=n.y,n.y=x,this.czech||(n.y*=-1,n.x*=-1),h=Math.sqrt(n.x*n.x+n.y*n.y),a=Math.atan2(n.y,n.x),r=a/Math.sin(this.s0),i=2*(Math.atan(Math.pow(this.ro0/h,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(i)-Math.sin(this.ad)*Math.cos(i)*Math.cos(r)),t=Math.asin(Math.cos(i)*Math.sin(r)/Math.cos(e)),n.x=this.long0-t/this.alfa,s=e,p=0;var I=0;do n.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(s))/(1-this.e*Math.sin(s)),this.e/2))-this.s45),Math.abs(s-n.y)<1e-10&&(p=1),s=n.y,I+=1;while(p===0&&I<15);return I>=15?null:n}var ZN=["Krovak","krovak"];const YN={init:HN,forward:WN,inverse:XN,names:ZN};function Xu(n,e,t,i,r){return n*r-e*Math.sin(2*r)+t*Math.sin(4*r)-i*Math.sin(6*r)}function q1(n){return 1-.25*n*(1+n/16*(3+1.25*n))}function H1(n){return .375*n*(1+.25*n*(1+.46875*n))}function W1(n){return .05859375*n*n*(1+.75*n)}function X1(n){return n*n*n*(35/3072)}function mv(n,e,t){var i=e*t;return n/Math.sqrt(1-i*i)}function Gv(n){return Math.abs(n)<En?n:n-j1(n)*Math.PI}function xE(n,e,t,i,r){var a,h;a=n/e;for(var s=0;s<15;s++)if(h=(n-(e*a-t*Math.sin(2*a)+i*Math.sin(4*a)-r*Math.sin(6*a)))/(e-2*t*Math.cos(2*a)+4*i*Math.cos(4*a)-6*r*Math.cos(6*a)),a+=h,Math.abs(h)<=1e-10)return a;return NaN}function KN(){this.sphere||(this.e0=q1(this.es),this.e1=H1(this.es),this.e2=W1(this.es),this.e3=X1(this.es),this.ml0=this.a*Xu(this.e0,this.e1,this.e2,this.e3,this.lat0))}function JN(n){var e,t,i=n.x,r=n.y;if(i=ai(i-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(r)*Math.sin(i)),t=this.a*(Math.atan2(Math.tan(r),Math.cos(i))-this.lat0);else{var a=Math.sin(r),h=Math.cos(r),s=mv(this.a,this.e,a),p=Math.tan(r)*Math.tan(r),x=i*Math.cos(r),I=x*x,C=this.es*h*h/(1-this.es),M=this.a*Xu(this.e0,this.e1,this.e2,this.e3,r);e=s*x*(1-I*p*(1/6-(8-p+8*C)*I/120)),t=M-this.ml0+s*a/h*I*(.5+(5-p+6*C)*I/24)}return n.x=e+this.x0,n.y=t+this.y0,n}function QN(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,i,r;if(this.sphere){var a=t+this.lat0;i=Math.asin(Math.sin(a)*Math.cos(e)),r=Math.atan2(Math.tan(e),Math.cos(a))}else{var h=this.ml0/this.a+t,s=xE(h,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(s)-En)<=ei)return n.x=this.long0,n.y=En,t<0&&(n.y*=-1),n;var p=mv(this.a,this.e,Math.sin(s)),x=p*p*p/this.a/this.a*(1-this.es),I=Math.pow(Math.tan(s),2),C=e*this.a/p,M=C*C;i=s-p*Math.tan(s)/x*C*C*(.5-(1+3*I)*C*C/24),r=C*(1-M*(I/3+(1+3*I)*I*M/15))/Math.cos(s)}return n.x=ai(r+this.long0),n.y=Gv(i),n}var $N=["Cassini","Cassini_Soldner","cass"];const e3={init:KN,forward:JN,inverse:QN,names:$N};function jm(n,e){var t;return n>1e-7?(t=n*e,(1-n*n)*(e/(1-t*t)-.5/n*Math.log((1-t)/(1+t)))):2*e}var t3=1,n3=2,i3=3,r3=4;function s3(){var n=Math.abs(this.lat0);if(Math.abs(n-En)<ei?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(n)<ei?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var e;switch(this.qp=jm(this.e,1),this.mmf=.5/(1-this.es),this.apa=p3(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=jm(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function o3(n){var e,t,i,r,a,h,s,p,x,I,C=n.x,M=n.y;if(C=ai(C-this.long0),this.sphere){if(a=Math.sin(M),I=Math.cos(M),i=Math.cos(C),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t=this.mode===this.EQUIT?1+I*i:1+this.sinph0*a+this.cosph0*I*i,t<=ei)return null;t=Math.sqrt(2/t),e=t*I*Math.sin(C),t*=this.mode===this.EQUIT?a:this.cosph0*a-this.sinph0*I*i}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),Math.abs(M+this.lat0)<ei)return null;t=Ls-M*.5,t=2*(this.mode===this.S_POLE?Math.cos(t):Math.sin(t)),e=t*Math.sin(C),t*=i}}else{switch(s=0,p=0,x=0,i=Math.cos(C),r=Math.sin(C),a=Math.sin(M),h=jm(this.e,a),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(s=h/this.qp,p=Math.sqrt(1-s*s)),this.mode){case this.OBLIQ:x=1+this.sinb1*s+this.cosb1*p*i;break;case this.EQUIT:x=1+p*i;break;case this.N_POLE:x=En+M,h=this.qp-h;break;case this.S_POLE:x=M-En,h=this.qp+h;break}if(Math.abs(x)<ei)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:x=Math.sqrt(2/x),this.mode===this.OBLIQ?t=this.ymf*x*(this.cosb1*s-this.sinb1*p*i):t=(x=Math.sqrt(2/(1+p*i)))*s*this.ymf,e=this.xmf*x*p*r;break;case this.N_POLE:case this.S_POLE:h>=0?(e=(x=Math.sqrt(h))*r,t=i*(this.mode===this.S_POLE?x:-x)):e=t=0;break}}return n.x=this.a*e+this.x0,n.y=this.a*t+this.y0,n}function a3(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,i,r,a,h,s,p,x;if(this.sphere){var I=0,C,M=0;if(C=Math.sqrt(e*e+t*t),r=C*.5,r>1)return null;switch(r=2*Math.asin(r),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(M=Math.sin(r),I=Math.cos(r)),this.mode){case this.EQUIT:r=Math.abs(C)<=ei?0:Math.asin(t*M/C),e*=M,t=I*C;break;case this.OBLIQ:r=Math.abs(C)<=ei?this.lat0:Math.asin(I*this.sinph0+t*M*this.cosph0/C),e*=M*this.cosph0,t=(I-Math.sin(r)*this.sinph0)*C;break;case this.N_POLE:t=-t,r=En-r;break;case this.S_POLE:r-=En;break}i=t===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,t)}else{if(x=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,t*=this.dd,p=Math.sqrt(e*e+t*t),p<ei)return n.x=this.long0,n.y=this.lat0,n;h=2*Math.asin(.5*p/this.rq),a=Math.cos(h),e*=h=Math.sin(h),this.mode===this.OBLIQ?(x=a*this.sinb1+t*h*this.cosb1/p,s=this.qp*x,t=p*this.cosb1*a-t*this.sinb1*h):(x=t*h/p,s=this.qp*x,t=p*a)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(t=-t),s=e*e+t*t,!s)return n.x=this.long0,n.y=this.lat0,n;x=1-s/this.qp,this.mode===this.S_POLE&&(x=-x)}i=Math.atan2(e,t),r=m3(Math.asin(x),this.apa)}return n.x=ai(this.long0+i),n.y=r,n}var l3=.3333333333333333,u3=.17222222222222222,c3=.10257936507936508,h3=.06388888888888888,f3=.0664021164021164,d3=.016415012942191543;function p3(n){var e,t=[];return t[0]=n*l3,e=n*n,t[0]+=e*u3,t[1]=e*h3,e*=n,t[0]+=e*c3,t[1]+=e*f3,t[2]=e*d3,t}function m3(n,e){var t=n+n;return n+e[0]*Math.sin(t)+e[1]*Math.sin(t+t)+e[2]*Math.sin(t+t+t)}var g3=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const _3={init:s3,forward:o3,inverse:a3,names:g3,S_POLE:t3,N_POLE:n3,EQUIT:i3,OBLIQ:r3};function Ym(n){return Math.abs(n)>1&&(n=n>1?1:-1),Math.asin(n)}function y3(){Math.abs(this.lat1+this.lat2)<ei||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=tp(this.e3,this.sin_po,this.cos_po),this.qs1=jm(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=tp(this.e3,this.sin_po,this.cos_po),this.qs2=jm(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=jm(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>ei?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function v3(n){var e=n.x,t=n.y;this.sin_phi=Math.sin(t),this.cos_phi=Math.cos(t);var i=jm(this.e3,this.sin_phi),r=this.a*Math.sqrt(this.c-this.ns0*i)/this.ns0,a=this.ns0*ai(e-this.long0),h=r*Math.sin(a)+this.x0,s=this.rh-r*Math.cos(a)+this.y0;return n.x=h,n.y=s,n}function x3(n){var e,t,i,r,a,h;return n.x-=this.x0,n.y=this.rh-n.y+this.y0,this.ns0>=0?(e=Math.sqrt(n.x*n.x+n.y*n.y),i=1):(e=-Math.sqrt(n.x*n.x+n.y*n.y),i=-1),r=0,e!==0&&(r=Math.atan2(i*n.x,i*n.y)),i=e*this.ns0/this.a,this.sphere?h=Math.asin((this.c-i*i)/(2*this.ns0)):(t=(this.c-i*i)/this.ns0,h=this.phi1z(this.e3,t)),a=ai(r/this.ns0+this.long0),n.x=a,n.y=h,n}function b3(n,e){var t,i,r,a,h,s=Ym(.5*e);if(n<ei)return s;for(var p=n*n,x=1;x<=25;x++)if(t=Math.sin(s),i=Math.cos(s),r=n*t,a=1-r*r,h=.5*a*a/i*(e/(1-p)-t/a+.5/n*Math.log((1-r)/(1+r))),s=s+h,Math.abs(h)<=1e-7)return s;return null}var E3=["Albers_Conic_Equal_Area","Albers","aea"];const w3={init:y3,forward:v3,inverse:x3,names:E3,phi1z:b3};function I3(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function T3(n){var e,t,i,r,a,h,s,p,x=n.x,I=n.y;return i=ai(x-this.long0),e=Math.sin(I),t=Math.cos(I),r=Math.cos(i),h=this.sin_p14*e+this.cos_p14*t*r,a=1,h>0||Math.abs(h)<=ei?(s=this.x0+this.a*a*t*Math.sin(i)/h,p=this.y0+this.a*a*(this.cos_p14*e-this.sin_p14*t*r)/h):(s=this.x0+this.infinity_dist*t*Math.sin(i),p=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*t*r)),n.x=s,n.y=p,n}function S3(n){var e,t,i,r,a,h;return n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,(e=Math.sqrt(n.x*n.x+n.y*n.y))?(r=Math.atan2(e,this.rc),t=Math.sin(r),i=Math.cos(r),h=Ym(i*this.sin_p14+n.y*t*this.cos_p14/e),a=Math.atan2(n.x*t,e*this.cos_p14*i-n.y*this.sin_p14*t),a=ai(this.long0+a)):(h=this.phic0,a=0),n.x=a,n.y=h,n}var C3=["gnom"];const A3={init:I3,forward:T3,inverse:S3,names:C3};function M3(n,e){var t=1-(1-n*n)/(2*n)*Math.log((1-n)/(1+n));if(Math.abs(Math.abs(e)-t)<1e-6)return e<0?-1*En:En;for(var i=Math.asin(.5*e),r,a,h,s,p=0;p<30;p++)if(a=Math.sin(i),h=Math.cos(i),s=n*a,r=Math.pow(1-s*s,2)/(2*h)*(e/(1-n*n)-a/(1-s*s)+.5/n*Math.log((1-s)/(1+s))),i+=r,Math.abs(r)<=1e-10)return i;return NaN}function L3(){this.sphere||(this.k0=tp(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function P3(n){var e=n.x,t=n.y,i,r,a=ai(e-this.long0);if(this.sphere)i=this.x0+this.a*a*Math.cos(this.lat_ts),r=this.y0+this.a*Math.sin(t)/Math.cos(this.lat_ts);else{var h=jm(this.e,Math.sin(t));i=this.x0+this.a*this.k0*a,r=this.y0+this.a*h*.5/this.k0}return n.x=i,n.y=r,n}function R3(n){n.x-=this.x0,n.y-=this.y0;var e,t;return this.sphere?(e=ai(this.long0+n.x/this.a/Math.cos(this.lat_ts)),t=Math.asin(n.y/this.a*Math.cos(this.lat_ts))):(t=M3(this.e,2*n.y*this.k0/this.a),e=ai(this.long0+n.x/(this.a*this.k0))),n.x=e,n.y=t,n}var D3=["cea"];const O3={init:L3,forward:P3,inverse:R3,names:D3};function N3(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function k3(n){var e=n.x,t=n.y,i=ai(e-this.long0),r=Gv(t-this.lat0);return n.x=this.x0+this.a*i*this.rc,n.y=this.y0+this.a*r,n}function F3(n){var e=n.x,t=n.y;return n.x=ai(this.long0+(e-this.x0)/(this.a*this.rc)),n.y=Gv(this.lat0+(t-this.y0)/this.a),n}var B3=["Equirectangular","Equidistant_Cylindrical","eqc"];const z3={init:N3,forward:k3,inverse:F3,names:B3};var jC=20;function U3(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=q1(this.es),this.e1=H1(this.es),this.e2=W1(this.es),this.e3=X1(this.es),this.ml0=this.a*Xu(this.e0,this.e1,this.e2,this.e3,this.lat0)}function V3(n){var e=n.x,t=n.y,i,r,a,h=ai(e-this.long0);if(a=h*Math.sin(t),this.sphere)Math.abs(t)<=ei?(i=this.a*h,r=-1*this.a*this.lat0):(i=this.a*Math.sin(a)/Math.tan(t),r=this.a*(Gv(t-this.lat0)+(1-Math.cos(a))/Math.tan(t)));else if(Math.abs(t)<=ei)i=this.a*h,r=-1*this.ml0;else{var s=mv(this.a,this.e,Math.sin(t))/Math.tan(t);i=s*Math.sin(a),r=this.a*Xu(this.e0,this.e1,this.e2,this.e3,t)-this.ml0+s*(1-Math.cos(a))}return n.x=i+this.x0,n.y=r+this.y0,n}function G3(n){var e,t,i,r,a,h,s,p,x;if(i=n.x-this.x0,r=n.y-this.y0,this.sphere)if(Math.abs(r+this.a*this.lat0)<=ei)e=ai(i/this.a+this.long0),t=0;else{h=this.lat0+r/this.a,s=i*i/this.a/this.a+h*h,p=h;var I;for(a=jC;a;--a)if(I=Math.tan(p),x=-1*(h*(p*I+1)-p-.5*(p*p+s)*I)/((p-h)/I-1),p+=x,Math.abs(x)<=ei){t=p;break}e=ai(this.long0+Math.asin(i*Math.tan(p)/this.a)/Math.sin(t))}else if(Math.abs(r+this.ml0)<=ei)t=0,e=ai(this.long0+i/this.a);else{h=(this.ml0+r)/this.a,s=i*i/this.a/this.a+h*h,p=h;var C,M,O,k,z;for(a=jC;a;--a)if(z=this.e*Math.sin(p),C=Math.sqrt(1-z*z)*Math.tan(p),M=this.a*Xu(this.e0,this.e1,this.e2,this.e3,p),O=this.e0-2*this.e1*Math.cos(2*p)+4*this.e2*Math.cos(4*p)-6*this.e3*Math.cos(6*p),k=M/this.a,x=(h*(C*k+1)-k-.5*C*(k*k+s))/(this.es*Math.sin(2*p)*(k*k+s-2*h*k)/(4*C)+(h-k)*(C*O-2/Math.sin(2*p))-O),p-=x,Math.abs(x)<=ei){t=p;break}C=Math.sqrt(1-this.es*Math.pow(Math.sin(t),2))*Math.tan(t),e=ai(this.long0+Math.asin(i*C/this.a)/Math.sin(t))}return n.x=e,n.y=t,n}var j3=["Polyconic","poly"];const q3={init:U3,forward:V3,inverse:G3,names:j3};function H3(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function W3(n){var e,t=n.x,i=n.y,r=i-this.lat0,a=t-this.long0,h=r/m1*1e-5,s=a,p=1,x=0;for(e=1;e<=10;e++)p=p*h,x=x+this.A[e]*p;var I=x,C=s,M=1,O=0,k,z,G=0,q=0;for(e=1;e<=6;e++)k=M*I-O*C,z=O*I+M*C,M=k,O=z,G=G+this.B_re[e]*M-this.B_im[e]*O,q=q+this.B_im[e]*M+this.B_re[e]*O;return n.x=q*this.a+this.x0,n.y=G*this.a+this.y0,n}function X3(n){var e,t=n.x,i=n.y,r=t-this.x0,a=i-this.y0,h=a/this.a,s=r/this.a,p=1,x=0,I,C,M=0,O=0;for(e=1;e<=6;e++)I=p*h-x*s,C=x*h+p*s,p=I,x=C,M=M+this.C_re[e]*p-this.C_im[e]*x,O=O+this.C_im[e]*p+this.C_re[e]*x;for(var k=0;k<this.iterations;k++){var z=M,G=O,q,Z,K=h,te=s;for(e=2;e<=6;e++)q=z*M-G*O,Z=G*M+z*O,z=q,G=Z,K=K+(e-1)*(this.B_re[e]*z-this.B_im[e]*G),te=te+(e-1)*(this.B_im[e]*z+this.B_re[e]*G);z=1,G=0;var ie=this.B_re[1],Te=this.B_im[1];for(e=2;e<=6;e++)q=z*M-G*O,Z=G*M+z*O,z=q,G=Z,ie=ie+e*(this.B_re[e]*z-this.B_im[e]*G),Te=Te+e*(this.B_im[e]*z+this.B_re[e]*G);var le=ie*ie+Te*Te;M=(K*ie+te*Te)/le,O=(te*ie-K*Te)/le}var fe=M,Fe=O,Ne=1,Ue=0;for(e=1;e<=9;e++)Ne=Ne*fe,Ue=Ue+this.D[e]*Ne;var dt=this.lat0+Ue*m1*1e5,Ge=this.long0+Fe;return n.x=Ge,n.y=dt,n}var Z3=["New_Zealand_Map_Grid","nzmg"];const Y3={init:H3,forward:W3,inverse:X3,names:Z3};function K3(){}function J3(n){var e=n.x,t=n.y,i=ai(e-this.long0),r=this.x0+this.a*i,a=this.y0+this.a*Math.log(Math.tan(Math.PI/4+t/2.5))*1.25;return n.x=r,n.y=a,n}function Q3(n){n.x-=this.x0,n.y-=this.y0;var e=ai(this.long0+n.x/this.a),t=2.5*(Math.atan(Math.exp(.8*n.y/this.a))-Math.PI/4);return n.x=e,n.y=t,n}var $3=["Miller_Cylindrical","mill"];const ek={init:K3,forward:J3,inverse:Q3,names:$3};var tk=20;function nk(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=zM(this.es)}function ik(n){var e,t,i=n.x,r=n.y;if(i=ai(i-this.long0),this.sphere){if(!this.m)r=this.n!==1?Math.asin(this.n*Math.sin(r)):r;else for(var a=this.n*Math.sin(r),h=tk;h;--h){var s=(this.m*r+Math.sin(r)-a)/(this.m+Math.cos(r));if(r-=s,Math.abs(s)<ei)break}e=this.a*this.C_x*i*(this.m+Math.cos(r)),t=this.a*this.C_y*r}else{var p=Math.sin(r),x=Math.cos(r);t=this.a*jE(r,p,x,this.en),e=this.a*i*x/Math.sqrt(1-this.es*p*p)}return n.x=e,n.y=t,n}function rk(n){var e,t,i,r;return n.x-=this.x0,i=n.x/this.a,n.y-=this.y0,e=n.y/this.a,this.sphere?(e/=this.C_y,i=i/(this.C_x*(this.m+Math.cos(e))),this.m?e=Ym((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=Ym(Math.sin(e)/this.n)),i=ai(i+this.long0),e=Gv(e)):(e=UM(n.y/this.a,this.es,this.en),r=Math.abs(e),r<En?(r=Math.sin(e),t=this.long0+n.x*Math.sqrt(1-this.es*r*r)/(this.a*Math.cos(e)),i=ai(t)):r-ei<En&&(i=this.long0)),n.x=i,n.y=e,n}var sk=["Sinusoidal","sinu"];const ok={init:nk,forward:ik,inverse:rk,names:sk};function ak(){}function lk(n){for(var e=n.x,t=n.y,i=ai(e-this.long0),r=t,a=Math.PI*Math.sin(t);;){var h=-(r+Math.sin(r)-a)/(1+Math.cos(r));if(r+=h,Math.abs(h)<ei)break}r/=2,Math.PI/2-Math.abs(t)<ei&&(i=0);var s=.900316316158*this.a*i*Math.cos(r)+this.x0,p=1.4142135623731*this.a*Math.sin(r)+this.y0;return n.x=s,n.y=p,n}function uk(n){var e,t;n.x-=this.x0,n.y-=this.y0,t=n.y/(1.4142135623731*this.a),Math.abs(t)>.999999999999&&(t=.999999999999),e=Math.asin(t);var i=ai(this.long0+n.x/(.900316316158*this.a*Math.cos(e)));i<-Math.PI&&(i=-Math.PI),i>Math.PI&&(i=Math.PI),t=(2*e+Math.sin(2*e))/Math.PI,Math.abs(t)>1&&(t=1);var r=Math.asin(t);return n.x=i,n.y=r,n}var ck=["Mollweide","moll"];const hk={init:ak,forward:lk,inverse:uk,names:ck};function fk(){Math.abs(this.lat1+this.lat2)<ei||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=q1(this.es),this.e1=H1(this.es),this.e2=W1(this.es),this.e3=X1(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=tp(this.e,this.sinphi,this.cosphi),this.ml1=Xu(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<ei?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=tp(this.e,this.sinphi,this.cosphi),this.ml2=Xu(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Xu(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function dk(n){var e=n.x,t=n.y,i;if(this.sphere)i=this.a*(this.g-t);else{var r=Xu(this.e0,this.e1,this.e2,this.e3,t);i=this.a*(this.g-r)}var a=this.ns*ai(e-this.long0),h=this.x0+i*Math.sin(a),s=this.y0+this.rh-i*Math.cos(a);return n.x=h,n.y=s,n}function pk(n){n.x-=this.x0,n.y=this.rh-n.y+this.y0;var e,t,i,r;this.ns>=0?(t=Math.sqrt(n.x*n.x+n.y*n.y),e=1):(t=-Math.sqrt(n.x*n.x+n.y*n.y),e=-1);var a=0;if(t!==0&&(a=Math.atan2(e*n.x,e*n.y)),this.sphere)return r=ai(this.long0+a/this.ns),i=Gv(this.g-t/this.a),n.x=r,n.y=i,n;var h=this.g-t/this.a;return i=xE(h,this.e0,this.e1,this.e2,this.e3),r=ai(this.long0+a/this.ns),n.x=r,n.y=i,n}var mk=["Equidistant_Conic","eqdc"];const gk={init:fk,forward:dk,inverse:pk,names:mk};function _k(){this.R=this.a}function yk(n){var e=n.x,t=n.y,i=ai(e-this.long0),r,a;Math.abs(t)<=ei&&(r=this.x0+this.R*i,a=this.y0);var h=Ym(2*Math.abs(t/Math.PI));(Math.abs(i)<=ei||Math.abs(Math.abs(t)-En)<=ei)&&(r=this.x0,t>=0?a=this.y0+Math.PI*this.R*Math.tan(.5*h):a=this.y0+Math.PI*this.R*-Math.tan(.5*h));var s=.5*Math.abs(Math.PI/i-i/Math.PI),p=s*s,x=Math.sin(h),I=Math.cos(h),C=I/(x+I-1),M=C*C,O=C*(2/x-1),k=O*O,z=Math.PI*this.R*(s*(C-k)+Math.sqrt(p*(C-k)*(C-k)-(k+p)*(M-k)))/(k+p);i<0&&(z=-z),r=this.x0+z;var G=p+C;return z=Math.PI*this.R*(O*G-s*Math.sqrt((k+p)*(p+1)-G*G))/(k+p),t>=0?a=this.y0+z:a=this.y0-z,n.x=r,n.y=a,n}function vk(n){var e,t,i,r,a,h,s,p,x,I,C,M,O;return n.x-=this.x0,n.y-=this.y0,C=Math.PI*this.R,i=n.x/C,r=n.y/C,a=i*i+r*r,h=-Math.abs(r)*(1+a),s=h-2*r*r+i*i,p=-2*h+1+2*r*r+a*a,O=r*r/p+(2*s*s*s/p/p/p-9*h*s/p/p)/27,x=(h-s*s/3/p)/p,I=2*Math.sqrt(-x/3),C=3*O/x/I,Math.abs(C)>1&&(C>=0?C=1:C=-1),M=Math.acos(C)/3,n.y>=0?t=(-I*Math.cos(M+Math.PI/3)-s/3/p)*Math.PI:t=-(-I*Math.cos(M+Math.PI/3)-s/3/p)*Math.PI,Math.abs(i)<ei?e=this.long0:e=ai(this.long0+Math.PI*(a-1+Math.sqrt(1+2*(i*i-r*r)+a*a))/2/i),n.x=e,n.y=t,n}var xk=["Van_der_Grinten_I","VanDerGrinten","vandg"];const bk={init:_k,forward:yk,inverse:vk,names:xk};function Ek(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)}function wk(n){var e=n.x,t=n.y,i=Math.sin(n.y),r=Math.cos(n.y),a=ai(e-this.long0),h,s,p,x,I,C,M,O,k,z,G,q,Z,K,te,ie,Te,le,fe,Fe,Ne,Ue,dt;return this.sphere?Math.abs(this.sin_p12-1)<=ei?(n.x=this.x0+this.a*(En-t)*Math.sin(a),n.y=this.y0-this.a*(En-t)*Math.cos(a),n):Math.abs(this.sin_p12+1)<=ei?(n.x=this.x0+this.a*(En+t)*Math.sin(a),n.y=this.y0+this.a*(En+t)*Math.cos(a),n):(le=this.sin_p12*i+this.cos_p12*r*Math.cos(a),ie=Math.acos(le),Te=ie?ie/Math.sin(ie):1,n.x=this.x0+this.a*Te*r*Math.sin(a),n.y=this.y0+this.a*Te*(this.cos_p12*i-this.sin_p12*r*Math.cos(a)),n):(h=q1(this.es),s=H1(this.es),p=W1(this.es),x=X1(this.es),Math.abs(this.sin_p12-1)<=ei?(I=this.a*Xu(h,s,p,x,En),C=this.a*Xu(h,s,p,x,t),n.x=this.x0+(I-C)*Math.sin(a),n.y=this.y0-(I-C)*Math.cos(a),n):Math.abs(this.sin_p12+1)<=ei?(I=this.a*Xu(h,s,p,x,En),C=this.a*Xu(h,s,p,x,t),n.x=this.x0+(I+C)*Math.sin(a),n.y=this.y0+(I+C)*Math.cos(a),n):(M=i/r,O=mv(this.a,this.e,this.sin_p12),k=mv(this.a,this.e,i),z=Math.atan((1-this.es)*M+this.es*O*this.sin_p12/(k*r)),G=Math.atan2(Math.sin(a),this.cos_p12*Math.tan(z)-this.sin_p12*Math.cos(a)),G===0?fe=Math.asin(this.cos_p12*Math.sin(z)-this.sin_p12*Math.cos(z)):Math.abs(Math.abs(G)-Math.PI)<=ei?fe=-Math.asin(this.cos_p12*Math.sin(z)-this.sin_p12*Math.cos(z)):fe=Math.asin(Math.sin(a)*Math.cos(z)/Math.sin(G)),q=this.e*this.sin_p12/Math.sqrt(1-this.es),Z=this.e*this.cos_p12*Math.cos(G)/Math.sqrt(1-this.es),K=q*Z,te=Z*Z,Fe=fe*fe,Ne=Fe*fe,Ue=Ne*fe,dt=Ue*fe,ie=O*fe*(1-Fe*te*(1-te)/6+Ne/8*K*(1-2*te)+Ue/120*(te*(4-7*te)-3*q*q*(1-7*te))-dt/48*K),n.x=this.x0+ie*Math.sin(G),n.y=this.y0+ie*Math.cos(G),n))}function Ik(n){n.x-=this.x0,n.y-=this.y0;var e,t,i,r,a,h,s,p,x,I,C,M,O,k,z,G,q,Z,K,te,ie,Te,le,fe;return this.sphere?(e=Math.sqrt(n.x*n.x+n.y*n.y),e>2*En*this.a?void 0:(t=e/this.a,i=Math.sin(t),r=Math.cos(t),a=this.long0,Math.abs(e)<=ei?h=this.lat0:(h=Ym(r*this.sin_p12+n.y*i*this.cos_p12/e),s=Math.abs(this.lat0)-En,Math.abs(s)<=ei?this.lat0>=0?a=ai(this.long0+Math.atan2(n.x,-n.y)):a=ai(this.long0-Math.atan2(-n.x,n.y)):a=ai(this.long0+Math.atan2(n.x*i,e*this.cos_p12*r-n.y*this.sin_p12*i))),n.x=a,n.y=h,n)):(p=q1(this.es),x=H1(this.es),I=W1(this.es),C=X1(this.es),Math.abs(this.sin_p12-1)<=ei?(M=this.a*Xu(p,x,I,C,En),e=Math.sqrt(n.x*n.x+n.y*n.y),O=M-e,h=xE(O/this.a,p,x,I,C),a=ai(this.long0+Math.atan2(n.x,-1*n.y)),n.x=a,n.y=h,n):Math.abs(this.sin_p12+1)<=ei?(M=this.a*Xu(p,x,I,C,En),e=Math.sqrt(n.x*n.x+n.y*n.y),O=e-M,h=xE(O/this.a,p,x,I,C),a=ai(this.long0+Math.atan2(n.x,n.y)),n.x=a,n.y=h,n):(e=Math.sqrt(n.x*n.x+n.y*n.y),G=Math.atan2(n.x,n.y),k=mv(this.a,this.e,this.sin_p12),q=Math.cos(G),Z=this.e*this.cos_p12*q,K=-Z*Z/(1-this.es),te=3*this.es*(1-K)*this.sin_p12*this.cos_p12*q/(1-this.es),ie=e/k,Te=ie-K*(1+K)*Math.pow(ie,3)/6-te*(1+3*K)*Math.pow(ie,4)/24,le=1-K*Te*Te/2-ie*Te*Te*Te/6,z=Math.asin(this.sin_p12*Math.cos(Te)+this.cos_p12*Math.sin(Te)*q),a=ai(this.long0+Math.asin(Math.sin(G)*Math.sin(Te)/Math.cos(z))),fe=Math.sin(z),h=Math.atan2((fe-this.es*le*this.sin_p12)*Math.tan(z),fe*(1-this.es)),n.x=a,n.y=h,n))}var Tk=["Azimuthal_Equidistant","aeqd"];const Sk={init:Ek,forward:wk,inverse:Ik,names:Tk};function Ck(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function Ak(n){var e,t,i,r,a,h,s,p,x=n.x,I=n.y;return i=ai(x-this.long0),e=Math.sin(I),t=Math.cos(I),r=Math.cos(i),h=this.sin_p14*e+this.cos_p14*t*r,a=1,(h>0||Math.abs(h)<=ei)&&(s=this.a*a*t*Math.sin(i),p=this.y0+this.a*a*(this.cos_p14*e-this.sin_p14*t*r)),n.x=s,n.y=p,n}function Mk(n){var e,t,i,r,a,h,s;return n.x-=this.x0,n.y-=this.y0,e=Math.sqrt(n.x*n.x+n.y*n.y),t=Ym(e/this.a),i=Math.sin(t),r=Math.cos(t),h=this.long0,Math.abs(e)<=ei?(s=this.lat0,n.x=h,n.y=s,n):(s=Ym(r*this.sin_p14+n.y*i*this.cos_p14/e),a=Math.abs(this.lat0)-En,Math.abs(a)<=ei?(this.lat0>=0?h=ai(this.long0+Math.atan2(n.x,-n.y)):h=ai(this.long0-Math.atan2(-n.x,n.y)),n.x=h,n.y=s,n):(h=ai(this.long0+Math.atan2(n.x*i,e*this.cos_p14*r-n.y*this.sin_p14*i)),n.x=h,n.y=s,n))}var Lk=["ortho"];const Pk={init:Ck,forward:Ak,inverse:Mk,names:Lk};var Zo={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Ps={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function Rk(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=En-Ls/2?this.face=Zo.TOP:this.lat0<=-(En-Ls/2)?this.face=Zo.BOTTOM:Math.abs(this.long0)<=Ls?this.face=Zo.FRONT:Math.abs(this.long0)<=En+Ls?this.face=this.long0>0?Zo.RIGHT:Zo.LEFT:this.face=Zo.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function Dk(n){var e={x:0,y:0},t,i,r,a,h,s,p={value:0};if(n.x-=this.long0,this.es!==0?t=Math.atan(this.one_minus_f_squared*Math.tan(n.y)):t=n.y,i=n.x,this.face===Zo.TOP)a=En-t,i>=Ls&&i<=En+Ls?(p.value=Ps.AREA_0,r=i-En):i>En+Ls||i<=-(En+Ls)?(p.value=Ps.AREA_1,r=i>0?i-xa:i+xa):i>-(En+Ls)&&i<=-Ls?(p.value=Ps.AREA_2,r=i+En):(p.value=Ps.AREA_3,r=i);else if(this.face===Zo.BOTTOM)a=En+t,i>=Ls&&i<=En+Ls?(p.value=Ps.AREA_0,r=-i+En):i<Ls&&i>=-Ls?(p.value=Ps.AREA_1,r=-i):i<-Ls&&i>=-(En+Ls)?(p.value=Ps.AREA_2,r=-i-En):(p.value=Ps.AREA_3,r=i>0?-i+xa:-i-xa);else{var x,I,C,M,O,k,z;this.face===Zo.RIGHT?i=sv(i,+En):this.face===Zo.BACK?i=sv(i,+xa):this.face===Zo.LEFT&&(i=sv(i,-En)),M=Math.sin(t),O=Math.cos(t),k=Math.sin(i),z=Math.cos(i),x=O*z,I=O*k,C=M,this.face===Zo.FRONT?(a=Math.acos(x),r=Kb(a,C,I,p)):this.face===Zo.RIGHT?(a=Math.acos(I),r=Kb(a,C,-x,p)):this.face===Zo.BACK?(a=Math.acos(-x),r=Kb(a,C,-I,p)):this.face===Zo.LEFT?(a=Math.acos(-I),r=Kb(a,C,x,p)):(a=r=0,p.value=Ps.AREA_0)}return s=Math.atan(12/xa*(r+Math.acos(Math.sin(r)*Math.cos(Ls))-En)),h=Math.sqrt((1-Math.cos(a))/(Math.cos(s)*Math.cos(s))/(1-Math.cos(Math.atan(1/Math.cos(r))))),p.value===Ps.AREA_1?s+=En:p.value===Ps.AREA_2?s+=xa:p.value===Ps.AREA_3&&(s+=1.5*xa),e.x=h*Math.cos(s),e.y=h*Math.sin(s),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,n.x=e.x,n.y=e.y,n}function Ok(n){var e={lam:0,phi:0},t,i,r,a,h,s,p,x,I,C={value:0};if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,i=Math.atan(Math.sqrt(n.x*n.x+n.y*n.y)),t=Math.atan2(n.y,n.x),n.x>=0&&n.x>=Math.abs(n.y)?C.value=Ps.AREA_0:n.y>=0&&n.y>=Math.abs(n.x)?(C.value=Ps.AREA_1,t-=En):n.x<0&&-n.x>=Math.abs(n.y)?(C.value=Ps.AREA_2,t=t<0?t+xa:t-xa):(C.value=Ps.AREA_3,t+=En),I=xa/12*Math.tan(t),h=Math.sin(I)/(Math.cos(I)-1/Math.sqrt(2)),s=Math.atan(h),r=Math.cos(t),a=Math.tan(i),p=1-r*r*a*a*(1-Math.cos(Math.atan(1/Math.cos(s)))),p<-1?p=-1:p>1&&(p=1),this.face===Zo.TOP)x=Math.acos(p),e.phi=En-x,C.value===Ps.AREA_0?e.lam=s+En:C.value===Ps.AREA_1?e.lam=s<0?s+xa:s-xa:C.value===Ps.AREA_2?e.lam=s-En:e.lam=s;else if(this.face===Zo.BOTTOM)x=Math.acos(p),e.phi=x-En,C.value===Ps.AREA_0?e.lam=-s+En:C.value===Ps.AREA_1?e.lam=-s:C.value===Ps.AREA_2?e.lam=-s-En:e.lam=s<0?-s-xa:-s+xa;else{var M,O,k;M=p,I=M*M,I>=1?k=0:k=Math.sqrt(1-I)*Math.sin(s),I+=k*k,I>=1?O=0:O=Math.sqrt(1-I),C.value===Ps.AREA_1?(I=O,O=-k,k=I):C.value===Ps.AREA_2?(O=-O,k=-k):C.value===Ps.AREA_3&&(I=O,O=k,k=-I),this.face===Zo.RIGHT?(I=M,M=-O,O=I):this.face===Zo.BACK?(M=-M,O=-O):this.face===Zo.LEFT&&(I=M,M=O,O=-I),e.phi=Math.acos(-k)-En,e.lam=Math.atan2(O,M),this.face===Zo.RIGHT?e.lam=sv(e.lam,-En):this.face===Zo.BACK?e.lam=sv(e.lam,-xa):this.face===Zo.LEFT&&(e.lam=sv(e.lam,+En))}if(this.es!==0){var z,G,q;z=e.phi<0?1:0,G=Math.tan(e.phi),q=this.b/Math.sqrt(G*G+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-q*q)/(this.one_minus_f*q)),z&&(e.phi=-e.phi)}return e.lam+=this.long0,n.x=e.lam,n.y=e.phi,n}function Kb(n,e,t,i){var r;return n<ei?(i.value=Ps.AREA_0,r=0):(r=Math.atan2(e,t),Math.abs(r)<=Ls?i.value=Ps.AREA_0:r>Ls&&r<=En+Ls?(i.value=Ps.AREA_1,r-=En):r>En+Ls||r<=-(En+Ls)?(i.value=Ps.AREA_2,r=r>=0?r-xa:r+xa):(i.value=Ps.AREA_3,r+=En)),r}function sv(n,e){var t=n+e;return t<-xa?t+=v1:t>+xa&&(t-=v1),t}var Nk=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const kk={init:Rk,forward:Dk,inverse:Ok,names:Nk};var CT=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],h1=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],jM=.8487,qM=1.3523,HM=Kd/5,Fk=1/HM,Ky=18,bE=function(n,e){return n[0]+e*(n[1]+e*(n[2]+e*n[3]))},Bk=function(n,e){return n[1]+e*(2*n[2]+e*3*n[3])};function zk(n,e,t,i){for(var r=e;i;--i){var a=n(r);if(r-=a,Math.abs(a)<t)break}return r}function Uk(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function Vk(n){var e=ai(n.x-this.long0),t=Math.abs(n.y),i=Math.floor(t*HM);i<0?i=0:i>=Ky&&(i=Ky-1),t=Kd*(t-Fk*i);var r={x:bE(CT[i],t)*e,y:bE(h1[i],t)};return n.y<0&&(r.y=-r.y),r.x=r.x*this.a*jM+this.x0,r.y=r.y*this.a*qM+this.y0,r}function Gk(n){var e={x:(n.x-this.x0)/(this.a*jM),y:Math.abs(n.y-this.y0)/(this.a*qM)};if(e.y>=1)e.x/=CT[Ky][0],e.y=n.y<0?-En:En;else{var t=Math.floor(e.y*Ky);for(t<0?t=0:t>=Ky&&(t=Ky-1);;)if(h1[t][0]>e.y)--t;else if(h1[t+1][0]<=e.y)++t;else break;var i=h1[t],r=5*(e.y-i[0])/(h1[t+1][0]-i[0]);r=zk(function(a){return(bE(i,a)-e.y)/Bk(i,a)},r,ei,100),e.x/=bE(CT[t],r),e.y=(5*t+r)*Hl,n.y<0&&(e.y=-e.y)}return e.x=ai(e.x+this.long0),e}var jk=["Robinson","robin"];const qk={init:Uk,forward:Vk,inverse:Gk,names:jk};function Hk(){this.name="geocent"}function Wk(n){var e=LM(n,this.es,this.a);return e}function Xk(n){var e=PM(n,this.es,this.a,this.b);return e}var Zk=["Geocentric","geocentric","geocent","Geocent"];const Yk={init:Hk,forward:Wk,inverse:Xk,names:Zk};var mu={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},t1={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function Kk(){if(Object.keys(t1).forEach(function(t){if(typeof this[t]>"u")this[t]=t1[t].def;else{if(t1[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);t1[t].num&&(this[t]=parseFloat(this[t]))}t1[t].degrees&&(this[t]=this[t]*Hl)}.bind(this)),Math.abs(Math.abs(this.lat0)-En)<ei?this.mode=this.lat0<0?mu.S_POLE:mu.N_POLE:Math.abs(this.lat0)<ei?this.mode=mu.EQUIT:(this.mode=mu.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var n=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(n),this.sw=Math.sin(n)}function Jk(n){n.x-=this.long0;var e=Math.sin(n.y),t=Math.cos(n.y),i=Math.cos(n.x),r,a;switch(this.mode){case mu.OBLIQ:a=this.sinph0*e+this.cosph0*t*i;break;case mu.EQUIT:a=t*i;break;case mu.S_POLE:a=-e;break;case mu.N_POLE:a=e;break}switch(a=this.pn1/(this.p-a),r=a*t*Math.sin(n.x),this.mode){case mu.OBLIQ:a*=this.cosph0*e-this.sinph0*t*i;break;case mu.EQUIT:a*=e;break;case mu.N_POLE:a*=-(t*i);break;case mu.S_POLE:a*=t*i;break}var h,s;return h=a*this.cg+r*this.sg,s=1/(h*this.sw*this.h1+this.cw),r=(r*this.cg-a*this.sg)*this.cw*s,a=h*s,n.x=r*this.a,n.y=a*this.a,n}function Qk(n){n.x/=this.a,n.y/=this.a;var e={x:n.x,y:n.y},t,i,r;r=1/(this.pn1-n.y*this.sw),t=this.pn1*n.x*r,i=this.pn1*n.y*this.cw*r,n.x=t*this.cg+i*this.sg,n.y=i*this.cg-t*this.sg;var a=Qf(n.x,n.y);if(Math.abs(a)<ei)e.x=0,e.y=n.y;else{var h,s;switch(s=1-a*a*this.pfact,s=(this.p-Math.sqrt(s))/(this.pn1/a+a/this.pn1),h=Math.sqrt(1-s*s),this.mode){case mu.OBLIQ:e.y=Math.asin(h*this.sinph0+n.y*s*this.cosph0/a),n.y=(h-this.sinph0*Math.sin(e.y))*a,n.x*=s*this.cosph0;break;case mu.EQUIT:e.y=Math.asin(n.y*s/a),n.y=h*a,n.x*=s;break;case mu.N_POLE:e.y=Math.asin(h),n.y=-n.y;break;case mu.S_POLE:e.y=-Math.asin(h);break}e.x=Math.atan2(n.x,n.y)}return n.x=e.x+this.long0,n.y=e.y,n}var $k=["Tilted_Perspective","tpers"];const eF={init:Kk,forward:Jk,inverse:Qk,names:$k};function tF(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var n=1-this.es,e=1/n;this.radius_p=Math.sqrt(n),this.radius_p2=n,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function nF(n){var e=n.x,t=n.y,i,r,a,h;if(e=e-this.long0,this.shape==="ellipse"){t=Math.atan(this.radius_p2*Math.tan(t));var s=this.radius_p/Qf(this.radius_p*Math.cos(t),Math.sin(t));if(r=s*Math.cos(e)*Math.cos(t),a=s*Math.sin(e)*Math.cos(t),h=s*Math.sin(t),(this.radius_g-r)*r-a*a-h*h*this.radius_p_inv2<0)return n.x=Number.NaN,n.y=Number.NaN,n;i=this.radius_g-r,this.flip_axis?(n.x=this.radius_g_1*Math.atan(a/Qf(h,i)),n.y=this.radius_g_1*Math.atan(h/i)):(n.x=this.radius_g_1*Math.atan(a/i),n.y=this.radius_g_1*Math.atan(h/Qf(a,i)))}else this.shape==="sphere"&&(i=Math.cos(t),r=Math.cos(e)*i,a=Math.sin(e)*i,h=Math.sin(t),i=this.radius_g-r,this.flip_axis?(n.x=this.radius_g_1*Math.atan(a/Qf(h,i)),n.y=this.radius_g_1*Math.atan(h/i)):(n.x=this.radius_g_1*Math.atan(a/i),n.y=this.radius_g_1*Math.atan(h/Qf(a,i))));return n.x=n.x*this.a,n.y=n.y*this.a,n}function iF(n){var e=-1,t=0,i=0,r,a,h,s;if(n.x=n.x/this.a,n.y=n.y/this.a,this.shape==="ellipse"){this.flip_axis?(i=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Qf(1,i)):(t=Math.tan(n.x/this.radius_g_1),i=Math.tan(n.y/this.radius_g_1)*Qf(1,t));var p=i/this.radius_p;if(r=t*t+p*p+e*e,a=2*this.radius_g*e,h=a*a-4*r*this.C,h<0)return n.x=Number.NaN,n.y=Number.NaN,n;s=(-a-Math.sqrt(h))/(2*r),e=this.radius_g+s*e,t*=s,i*=s,n.x=Math.atan2(t,e),n.y=Math.atan(i*Math.cos(n.x)/e),n.y=Math.atan(this.radius_p_inv2*Math.tan(n.y))}else if(this.shape==="sphere"){if(this.flip_axis?(i=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Math.sqrt(1+i*i)):(t=Math.tan(n.x/this.radius_g_1),i=Math.tan(n.y/this.radius_g_1)*Math.sqrt(1+t*t)),r=t*t+i*i+e*e,a=2*this.radius_g*e,h=a*a-4*r*this.C,h<0)return n.x=Number.NaN,n.y=Number.NaN,n;s=(-a-Math.sqrt(h))/(2*r),e=this.radius_g+s*e,t*=s,i*=s,n.x=Math.atan2(t,e),n.y=Math.atan(i*Math.cos(n.x)/e)}return n.x=n.x+this.long0,n}var rF=["Geostationary Satellite View","Geostationary_Satellite","geos"];const sF={init:tF,forward:nF,inverse:iF,names:rF};function oF(n){n.Proj.projections.add(lE),n.Proj.projections.add(uE),n.Proj.projections.add(fN),n.Proj.projections.add(EN),n.Proj.projections.add(AN),n.Proj.projections.add(DN),n.Proj.projections.add(zN),n.Proj.projections.add(qN),n.Proj.projections.add(YN),n.Proj.projections.add(e3),n.Proj.projections.add(_3),n.Proj.projections.add(w3),n.Proj.projections.add(A3),n.Proj.projections.add(O3),n.Proj.projections.add(z3),n.Proj.projections.add(q3),n.Proj.projections.add(Y3),n.Proj.projections.add(ek),n.Proj.projections.add(ok),n.Proj.projections.add(hk),n.Proj.projections.add(gk),n.Proj.projections.add(bk),n.Proj.projections.add(Sk),n.Proj.projections.add(Pk),n.Proj.projections.add(kk),n.Proj.projections.add(qk),n.Proj.projections.add(Yk),n.Proj.projections.add(eF),n.Proj.projections.add(sF)}ph.defaultDatum="WGS84";ph.Proj=Qd;ph.WGS84=new ph.Proj("WGS84");ph.Point=pv;ph.toPoint=RM;ph.defs=ju;ph.nadgrid=pO;ph.transform=vE;ph.mgrs=LO;ph.version="__VERSION__";oF(ph);function aF(n){const e=rd.groupBy(n,r=>r.name.split(".")[0]),i=rd.flatMap(e,r=>{const a=r.find(s=>s.name.endsWith(".shp")),h=r.find(s=>s.name.endsWith(".json"));if(a){const s=r.find(x=>x.name.endsWith(".dbf")),p=r.find(x=>x.name.endsWith(".prj"));return cF(a,s,p)}else if(h)return r.map(uF)}).filter(r=>r!==void 0);return Promise.all(i)}async function lF(n){const t=await(await fetch(`https://epsg.io/${n}.proj4js`)).text(),i=/"([^"]+)"/g,r=t.match(i);if(r&&r.length>1)return r[1].replace(/"/g,"").trim();console.error("Failed to extract Proj4 string.")}function uF(n){if(n.type!=="application/json"){console.error("Not a json file!");return}return new Promise((e,t)=>{const i=new FileReader;i.onload=r=>{if(r.target&&r.target.result){const a=r.target.result,h=JSON.parse(a);ug(h)&&rd.groupBy(h.features,s=>s.geometry.type),e({id:n.name.replace(".json",""),geojson:{type:"geojson",data:h}})}t("Could not parse geoJSON file")},i.readAsText(n)})}async function cF(n,e,t){const i=await n.arrayBuffer(),r=await AD(i),a=e&&await fF(e);if(a&&r.features.length===a.length)rd.zip(r.features,a).forEach(([s,p])=>{rd.merge(s,{properties:p})});else throw new Error(`Mismatch of features and properties (${r.features.length} vs. ${a==null?void 0:a.length})`);const h=t&&await hF(t);return h&&r.features.forEach(s=>{s.geometry=cM(s.geometry,h)}),{id:n.name.split(".")[0],geojson:{type:"geojson",data:r}}}async function hF(n){return new Promise((e,t)=>{const i=new FileReader;i.onload=async r=>{var a;try{const h=(a=r.target)==null?void 0:a.result,s=h==null?void 0:h.toString().trim(),p=await lF("4326"),x=ph(s,p);e(x)}catch(h){t(h)}},i.readAsText(n)})}async function fF(n){const e=await n.arrayBuffer(),t=await CD(e);async function i(r=[]){const a=await t.read();return a.done?r:await i([...r,a.value])}return await i()}function dF(n){let e;return{c(){e=_r("layers")},l(t){e=yr(t,"layers")},m(t,i){Tt(t,e,i)},d(t){t&&Oe(e)}}}function qC(n){let e,t,i;return t=new hg({props:{class:"material-icons",$$slots:{default:[pF]},$$scope:{ctx:n}}}),t.$on("click",n[15]),{c(){e=un("span"),Pn(t.$$.fragment),this.h()},l(r){e=cn(r,"SPAN",{class:!0});var a=_n(e);Zn(t.$$.fragment,a),a.forEach(Oe),this.h()},h(){tn(e,"class","check-all-btn svelte-ga66me")},m(r,a){Tt(r,e,a),Rn(t,e,null),i=!0},p(r,a){const h={};a[0]&32|a[1]&2&&(h.$$scope={dirty:a,ctx:r}),t.$set(h)},i(r){i||(Ke(t.$$.fragment,r),i=!0)},o(r){rt(t.$$.fragment,r),i=!1},d(r){r&&Oe(e),Dn(t)}}}function pF(n){let e=n[5]?"check_box":"check_box_outline_blank",t;return{c(){t=_r(e)},l(i){t=yr(i,e)},m(i,r){Tt(i,t,r)},p(i,r){r[0]&32&&e!==(e=i[5]?"check_box":"check_box_outline_blank")&&Ao(t,e)},d(i){i&&Oe(t)}}}function HC(n){var k,z,G;let e,t,i=((k=n[0])==null?void 0:k.name.toUpperCase())+"",r,a,h,s,p,x,I;h=new dv({props:{rich:!0,$$slots:{default:[yF]},$$scope:{ctx:n}}});const C=[(z=n[0].optionsComponent)==null?void 0:z.props,{updateOptions:n[8]}];var M=(G=n[0].optionsComponent)==null?void 0:G.component;function O(q){let Z={};for(let K=0;K<C.length;K+=1)Z=dn(Z,C[K]);return{props:Z}}return M&&(p=Tl(M,O())),{c(){e=un("span"),t=un("h3"),r=_r(i),a=qn(),Pn(h.$$.fragment),s=qn(),p&&Pn(p.$$.fragment),x=Ei(),this.h()},l(q){e=cn(q,"SPAN",{style:!0});var Z=_n(e);t=cn(Z,"H3",{});var K=_n(t);r=yr(K,i),K.forEach(Oe),a=Hn(Z),Zn(h.$$.fragment,Z),Z.forEach(Oe),s=Hn(q),p&&Zn(p.$$.fragment,q),x=Ei(),this.h()},h(){Wu(e,"display","flex"),Wu(e,"align-items","center"),Wu(e,"justify-content","space-between")},m(q,Z){Tt(q,e,Z),an(e,t),an(t,r),an(e,a),Rn(h,e,null),Tt(q,s,Z),p&&Rn(p,q,Z),Tt(q,x,Z),I=!0},p(q,Z){var ie,Te,le;(!I||Z[0]&1)&&i!==(i=((ie=q[0])==null?void 0:ie.name.toUpperCase())+"")&&Ao(r,i);const K={};Z[0]&1|Z[1]&2&&(K.$$scope={dirty:Z,ctx:q}),h.$set(K);const te=Z[0]&257?Gi(C,[Z[0]&1&&kr((Te=q[0].optionsComponent)==null?void 0:Te.props),Z[0]&256&&{updateOptions:q[8]}]):{};if(Z[0]&1&&M!==(M=(le=q[0].optionsComponent)==null?void 0:le.component)){if(p){vr();const fe=p;rt(fe.$$.fragment,1,0,()=>{Dn(fe,1)}),xr()}M?(p=Tl(M,O()),Pn(p.$$.fragment),Ke(p.$$.fragment,1),Rn(p,x.parentNode,x)):p=null}else M&&p.$set(te)},i(q){I||(Ke(h.$$.fragment,q),p&&Ke(p.$$.fragment,q),I=!0)},o(q){rt(h.$$.fragment,q),p&&rt(p.$$.fragment,q),I=!1},d(q){q&&Oe(e),Dn(h),q&&Oe(s),q&&Oe(x),p&&Dn(p,q)}}}function mF(n){let e;return{c(){e=_r("info")},l(t){e=yr(t,"info")},m(t,i){Tt(t,e,i)},d(t){t&&Oe(e)}}}function gF(n){let e=n[0].tooltip+"",t;return{c(){t=_r(e)},l(i){t=yr(i,e)},m(i,r){Tt(i,t,r)},p(i,r){r[0]&1&&e!==(e=i[0].tooltip+"")&&Ao(t,e)},d(i){i&&Oe(t)}}}function _F(n){let e,t;return e=new vR({props:{$$slots:{default:[gF]},$$scope:{ctx:n}}}),{c(){Pn(e.$$.fragment)},l(i){Zn(e.$$.fragment,i)},m(i,r){Rn(e,i,r),t=!0},p(i,r){const a={};r[0]&1|r[1]&2&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Ke(e.$$.fragment,i),t=!0)},o(i){rt(e.$$.fragment,i),t=!1},d(i){Dn(e,i)}}}function yF(n){let e,t,i,r,a;return t=new sS({props:{class:"material-icons",$$slots:{default:[mF]},$$scope:{ctx:n}}}),r=new G1({props:{$$slots:{default:[_F]},$$scope:{ctx:n}}}),{c(){e=un("span"),Pn(t.$$.fragment),i=qn(),Pn(r.$$.fragment),this.h()},l(h){e=cn(h,"SPAN",{class:!0});var s=_n(e);Zn(t.$$.fragment,s),s.forEach(Oe),i=Hn(h),Zn(r.$$.fragment,h),this.h()},h(){tn(e,"class","info-btn svelte-ga66me")},m(h,s){Tt(h,e,s),Rn(t,e,null),Tt(h,i,s),Rn(r,h,s),a=!0},p(h,s){const p={};s[1]&2&&(p.$$scope={dirty:s,ctx:h}),t.$set(p);const x={};s[0]&1|s[1]&2&&(x.$$scope={dirty:s,ctx:h}),r.$set(x)},i(h){a||(Ke(t.$$.fragment,h),Ke(r.$$.fragment,h),a=!0)},o(h){rt(t.$$.fragment,h),rt(r.$$.fragment,h),a=!1},d(h){h&&Oe(e),Dn(t),h&&Oe(i),Dn(r,h)}}}function vF(n){let e,t,i,r,a;function h(I){n[19](I)}function s(I){n[20](I)}function p(I){n[21](I)}let x={layer:n[31],map:n[1]};return n[4]!==void 0&&(x.selectModeEnabled=n[4]),n[0]!==void 0&&(x.selectedTool=n[0]),n[2]!==void 0&&(x.selectedLayers=n[2]),e=new $R({props:x}),$n.push(()=>ho(e,"selectModeEnabled",h)),$n.push(()=>ho(e,"selectedTool",s)),$n.push(()=>ho(e,"selectedLayers",p)),e.$on("toggled",n[11]),e.$on("singleSelect",n[13]),{c(){Pn(e.$$.fragment)},l(I){Zn(e.$$.fragment,I)},m(I,C){Rn(e,I,C),a=!0},p(I,C){const M={};C[1]&1&&(M.layer=I[31]),C[0]&2&&(M.map=I[1]),!t&&C[0]&16&&(t=!0,M.selectModeEnabled=I[4],Eo(()=>t=!1)),!i&&C[0]&1&&(i=!0,M.selectedTool=I[0],Eo(()=>i=!1)),!r&&C[0]&4&&(r=!0,M.selectedLayers=I[2],Eo(()=>r=!1)),e.$set(M)},i(I){a||(Ke(e.$$.fragment,I),a=!0)},o(I){rt(e.$$.fragment,I),a=!1},d(I){Dn(e,I)}}}function xF(n){let e;return{c(){e=_r("upload_file")},l(t){e=yr(t,"upload_file")},m(t,i){Tt(t,e,i)},d(t){t&&Oe(e)}}}function bF(n){let e;return{c(){e=_r("Upload layers")},l(t){e=yr(t,"Upload layers")},m(t,i){Tt(t,e,i)},d(t){t&&Oe(e)}}}function EF(n){let e,t,i,r;return e=new hg({props:{class:"material-icons",$$slots:{default:[xF]},$$scope:{ctx:n}}}),e.$on("click",n[22]),i=new G1({props:{$$slots:{default:[bF]},$$scope:{ctx:n}}}),{c(){Pn(e.$$.fragment),t=qn(),Pn(i.$$.fragment)},l(a){Zn(e.$$.fragment,a),t=Hn(a),Zn(i.$$.fragment,a)},m(a,h){Rn(e,a,h),Tt(a,t,h),Rn(i,a,h),r=!0},p(a,h){const s={};h[1]&2&&(s.$$scope={dirty:h,ctx:a}),e.$set(s);const p={};h[1]&2&&(p.$$scope={dirty:h,ctx:a}),i.$set(p)},i(a){r||(Ke(e.$$.fragment,a),Ke(i.$$.fragment,a),r=!0)},o(a){rt(e.$$.fragment,a),rt(i.$$.fragment,a),r=!1},d(a){Dn(e,a),a&&Oe(t),Dn(i,a)}}}function wF(n){let e;return{c(){e=_r("download")},l(t){e=yr(t,"download")},m(t,i){Tt(t,e,i)},d(t){t&&Oe(e)}}}function IF(n){let e;return{c(){e=_r("Download layer(s)")},l(t){e=yr(t,"Download layer(s)")},m(t,i){Tt(t,e,i)},d(t){t&&Oe(e)}}}function TF(n){let e,t,i,r;return e=new hg({props:{class:"material-icons",$$slots:{default:[wF]},$$scope:{ctx:n}}}),e.$on("click",n[14]),i=new G1({props:{$$slots:{default:[IF]},$$scope:{ctx:n}}}),{c(){Pn(e.$$.fragment),t=qn(),Pn(i.$$.fragment)},l(a){Zn(e.$$.fragment,a),t=Hn(a),Zn(i.$$.fragment,a)},m(a,h){Rn(e,a,h),Tt(a,t,h),Rn(i,a,h),r=!0},p(a,h){const s={};h[1]&2&&(s.$$scope={dirty:h,ctx:a}),e.$set(s);const p={};h[1]&2&&(p.$$scope={dirty:h,ctx:a}),i.$set(p)},i(a){r||(Ke(e.$$.fragment,a),Ke(i.$$.fragment,a),r=!0)},o(a){rt(e.$$.fragment,a),rt(i.$$.fragment,a),r=!1},d(a){Dn(e,a),a&&Oe(t),Dn(i,a)}}}function SF(n){let e,t,i,r;e=new dv({props:{$$slots:{default:[LF]},$$scope:{ctx:n}}});let a=n[4]&&WC(n);return{c(){Pn(e.$$.fragment),t=qn(),a&&a.c(),i=Ei()},l(h){Zn(e.$$.fragment,h),t=Hn(h),a&&a.l(h),i=Ei()},m(h,s){Rn(e,h,s),Tt(h,t,s),a&&a.m(h,s),Tt(h,i,s),r=!0},p(h,s){const p={};s[0]&20|s[1]&2&&(p.$$scope={dirty:s,ctx:h}),e.$set(p),h[4]?a?(a.p(h,s),s[0]&16&&Ke(a,1)):(a=WC(h),a.c(),Ke(a,1),a.m(i.parentNode,i)):a&&(vr(),rt(a,1,1,()=>{a=null}),xr())},i(h){r||(Ke(e.$$.fragment,h),Ke(a),r=!0)},o(h){rt(e.$$.fragment,h),rt(a),r=!1},d(h){Dn(e,h),h&&Oe(t),a&&a.d(h),h&&Oe(i)}}}function CF(n){let e,t,i,r,a;function h(p){n[24](p)}let s={variant:"unelevated",$$slots:{default:[DF]},$$scope:{ctx:n}};return n[6]!==void 0&&(s.disabled=n[6]),e=new _1({props:s}),$n.push(()=>ho(e,"disabled",h)),e.$on("click",n[10]),r=new _1({props:{variant:"outlined",$$slots:{default:[NF]},$$scope:{ctx:n}}}),r.$on("click",n[25]),{c(){Pn(e.$$.fragment),i=qn(),Pn(r.$$.fragment)},l(p){Zn(e.$$.fragment,p),i=Hn(p),Zn(r.$$.fragment,p)},m(p,x){Rn(e,p,x),Tt(p,i,x),Rn(r,p,x),a=!0},p(p,x){const I={};x[1]&2&&(I.$$scope={dirty:x,ctx:p}),!t&&x[0]&64&&(t=!0,I.disabled=p[6],Eo(()=>t=!1)),e.$set(I);const C={};x[1]&2&&(C.$$scope={dirty:x,ctx:p}),r.$set(C)},i(p){a||(Ke(e.$$.fragment,p),Ke(r.$$.fragment,p),a=!0)},o(p){rt(e.$$.fragment,p),rt(r.$$.fragment,p),a=!1},d(p){Dn(e,p),p&&Oe(i),Dn(r,p)}}}function AF(n){let e=n[4]?"check":"rule",t;return{c(){t=_r(e)},l(i){t=yr(i,e)},m(i,r){Tt(i,t,r)},p(i,r){r[0]&16&&e!==(e=i[4]?"check":"rule")&&Ao(t,e)},d(i){i&&Oe(t)}}}function MF(n){let e=n[4]?"Quit selection mode":"Select layers",t;return{c(){t=_r(e)},l(i){t=yr(i,e)},m(i,r){Tt(i,t,r)},p(i,r){r[0]&16&&e!==(e=i[4]?"Quit selection mode":"Select layers")&&Ao(t,e)},d(i){i&&Oe(t)}}}function LF(n){let e,t,i,r;return e=new hg({props:{class:"material-icons",$$slots:{default:[AF]},$$scope:{ctx:n}}}),e.$on("click",n[26]),i=new G1({props:{$$slots:{default:[MF]},$$scope:{ctx:n}}}),{c(){Pn(e.$$.fragment),t=qn(),Pn(i.$$.fragment)},l(a){Zn(e.$$.fragment,a),t=Hn(a),Zn(i.$$.fragment,a)},m(a,h){Rn(e,a,h),Tt(a,t,h),Rn(i,a,h),r=!0},p(a,h){const s={};h[0]&16|h[1]&2&&(s.$$scope={dirty:h,ctx:a}),e.$set(s);const p={};h[0]&16|h[1]&2&&(p.$$scope={dirty:h,ctx:a}),i.$set(p)},i(a){r||(Ke(e.$$.fragment,a),Ke(i.$$.fragment,a),r=!0)},o(a){rt(e.$$.fragment,a),rt(i.$$.fragment,a),r=!1},d(a){Dn(e,a),a&&Oe(t),Dn(i,a)}}}function WC(n){let e,t;return e=new hg({props:{class:"material-icons",disabled:n[2].length===0,$$slots:{default:[PF]},$$scope:{ctx:n}}}),e.$on("click",n[27]),{c(){Pn(e.$$.fragment)},l(i){Zn(e.$$.fragment,i)},m(i,r){Rn(e,i,r),t=!0},p(i,r){const a={};r[0]&4&&(a.disabled=i[2].length===0),r[1]&2&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Ke(e.$$.fragment,i),t=!0)},o(i){rt(e.$$.fragment,i),t=!1},d(i){Dn(e,i)}}}function PF(n){let e;return{c(){e=_r("delete_outline")},l(t){e=yr(t,"delete_outline")},m(t,i){Tt(t,e,i)},d(t){t&&Oe(e)}}}function RF(n){let e;return{c(){e=_r("Apply")},l(t){e=yr(t,"Apply")},m(t,i){Tt(t,e,i)},d(t){t&&Oe(e)}}}function DF(n){let e,t;return e=new rS({props:{$$slots:{default:[RF]},$$scope:{ctx:n}}}),{c(){Pn(e.$$.fragment)},l(i){Zn(e.$$.fragment,i)},m(i,r){Rn(e,i,r),t=!0},p(i,r){const a={};r[1]&2&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Ke(e.$$.fragment,i),t=!0)},o(i){rt(e.$$.fragment,i),t=!1},d(i){Dn(e,i)}}}function OF(n){let e;return{c(){e=_r("Cancel")},l(t){e=yr(t,"Cancel")},m(t,i){Tt(t,e,i)},d(t){t&&Oe(e)}}}function NF(n){let e,t;return e=new rS({props:{$$slots:{default:[OF]},$$scope:{ctx:n}}}),{c(){Pn(e.$$.fragment)},l(i){Zn(e.$$.fragment,i)},m(i,r){Rn(e,i,r),t=!0},p(i,r){const a={};r[1]&2&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Ke(e.$$.fragment,i),t=!0)},o(i){rt(e.$$.fragment,i),t=!1},d(i){Dn(e,i)}}}function kF(n){let e,t,i,r,a,h,s,p,x,I,C,M,O,k,z,G,q,Z,K,te,ie,Te,le,fe,Fe,Ne,Ue;s=new sS({props:{class:"material-icons",$$slots:{default:[dF]},$$scope:{ctx:n}}});let dt=n[4]&&qC(n),Ge=n[0]&&HC(n);O=new HR({props:{list:n[7],key:null,$$slots:{default:[vF,({item:Ot})=>({31:Ot}),({item:Ot})=>[0,Ot?1:0]]},$$scope:{ctx:n}}}),O.$on("sort",n[9]),Z=new dv({props:{$$slots:{default:[EF]},$$scope:{ctx:n}}}),Te=new dv({props:{$$slots:{default:[TF]},$$scope:{ctx:n}}});const Le=[CF,SF],nt=[];function zt(Ot,et){return Ot[0]?0:1}return Fe=zt(n),Ne=nt[Fe]=Le[Fe](n),{c(){e=un("div"),t=un("div"),i=un("span"),r=un("h2"),a=_r("Layers"),h=qn(),Pn(s.$$.fragment),p=qn(),dt&&dt.c(),x=qn(),I=un("hr"),C=qn(),Ge&&Ge.c(),M=qn(),Pn(O.$$.fragment),k=qn(),z=un("hr"),G=qn(),q=un("span"),Pn(Z.$$.fragment),K=qn(),te=un("input"),ie=qn(),Pn(Te.$$.fragment),le=qn(),fe=un("span"),Ne.c(),this.h()},l(Ot){e=cn(Ot,"DIV",{class:!0});var et=_n(e);t=cn(et,"DIV",{class:!0});var Ze=_n(t);i=cn(Ze,"SPAN",{class:!0});var At=_n(i);r=cn(At,"H2",{style:!0});var Kt=_n(r);a=yr(Kt,"Layers"),Kt.forEach(Oe),h=Hn(At),Zn(s.$$.fragment,At),p=Hn(At),dt&&dt.l(At),At.forEach(Oe),x=Hn(Ze),I=cn(Ze,"HR",{class:!0}),C=Hn(Ze),Ge&&Ge.l(Ze),M=Hn(Ze),Zn(O.$$.fragment,Ze),k=Hn(Ze),z=cn(Ze,"HR",{style:!0,class:!0}),G=Hn(Ze),q=cn(Ze,"SPAN",{class:!0});var sn=_n(q);Zn(Z.$$.fragment,sn),K=Hn(sn),te=cn(sn,"INPUT",{id:!0,type:!0,style:!0}),ie=Hn(sn),Zn(Te.$$.fragment,sn),le=Hn(sn),fe=cn(sn,"SPAN",{style:!0});var zn=_n(fe);Ne.l(zn),zn.forEach(Oe),sn.forEach(Oe),Ze.forEach(Oe),et.forEach(Oe),this.h()},h(){Wu(r,"margin","0"),tn(i,"class","layer-title svelte-ga66me"),tn(I,"class","svelte-ga66me"),Wu(z,"margin-top","auto"),tn(z,"class","svelte-ga66me"),tn(te,"id","file-upload"),te.multiple=!0,tn(te,"type","file"),Wu(te,"display","none"),Wu(fe,"margin-left","auto"),tn(q,"class","file-action-row svelte-ga66me"),tn(t,"class","content svelte-ga66me"),tn(e,"class","container pulsating-border svelte-ga66me")},m(Ot,et){Tt(Ot,e,et),an(e,t),an(t,i),an(i,r),an(r,a),an(i,h),Rn(s,i,null),an(i,p),dt&&dt.m(i,null),an(t,x),an(t,I),an(t,C),Ge&&Ge.m(t,null),an(t,M),Rn(O,t,null),an(t,k),an(t,z),an(t,G),an(t,q),Rn(Z,q,null),an(q,K),an(q,te),n[23](te),an(q,ie),Rn(Te,q,null),an(q,le),an(q,fe),nt[Fe].m(fe,null),Ue=!0},p(Ot,et){const Ze={};et[1]&2&&(Ze.$$scope={dirty:et,ctx:Ot}),s.$set(Ze),Ot[4]?dt?(dt.p(Ot,et),et[0]&16&&Ke(dt,1)):(dt=qC(Ot),dt.c(),Ke(dt,1),dt.m(i,null)):dt&&(vr(),rt(dt,1,1,()=>{dt=null}),xr()),Ot[0]?Ge?(Ge.p(Ot,et),et[0]&1&&Ke(Ge,1)):(Ge=HC(Ot),Ge.c(),Ke(Ge,1),Ge.m(t,M)):Ge&&(vr(),rt(Ge,1,1,()=>{Ge=null}),xr());const At={};et[0]&128&&(At.list=Ot[7]),et[0]&23|et[1]&3&&(At.$$scope={dirty:et,ctx:Ot}),O.$set(At);const Kt={};et[0]&8|et[1]&2&&(Kt.$$scope={dirty:et,ctx:Ot}),Z.$set(Kt);const sn={};et[1]&2&&(sn.$$scope={dirty:et,ctx:Ot}),Te.$set(sn);let zn=Fe;Fe=zt(Ot),Fe===zn?nt[Fe].p(Ot,et):(vr(),rt(nt[zn],1,1,()=>{nt[zn]=null}),xr(),Ne=nt[Fe],Ne?Ne.p(Ot,et):(Ne=nt[Fe]=Le[Fe](Ot),Ne.c()),Ke(Ne,1),Ne.m(fe,null))},i(Ot){Ue||(Ke(s.$$.fragment,Ot),Ke(dt),Ke(Ge),Ke(O.$$.fragment,Ot),Ke(Z.$$.fragment,Ot),Ke(Te.$$.fragment,Ot),Ke(Ne),Ue=!0)},o(Ot){rt(s.$$.fragment,Ot),rt(dt),rt(Ge),rt(O.$$.fragment,Ot),rt(Z.$$.fragment,Ot),rt(Te.$$.fragment,Ot),rt(Ne),Ue=!1},d(Ot){Ot&&Oe(e),Dn(s),dt&&dt.d(),Ge&&Ge.d(),Dn(O),Dn(Z),n[23](null),Dn(Te),nt[Fe].d()}}}function FF(n,e,t){let i,r,a;id(n,bo,et=>t(7,a=et));let{map:h}=e,{draw:s}=e,{tools:p}=e,{selectedTool:x}=e,I,C,M=!1,O=[],k,z;function G(et,Ze){t(18,k=et.args),z=Ze,et.layerSelection!==void 0&&et.layerSelection.length!==void 0&&t(2,O=et.layerSelection)}function q(et){const{newList:Ze,from:At,to:Kt}=et.detail,sn=Ze[Kt];bo.set(Ze),bo.setNewLayerIndex({layerId:sn,index:parseInt(Kt)})}function Z(){var Ze;let et=(Ze=x==null?void 0:x.geoProcessor)==null?void 0:Ze.processor(O,k);et&&!Array.isArray(et)&&(et=[et]),et==null||et.forEach(At=>eS(h,{id:x.name,geojson:{type:"geojson",data:At}})),t(0,x=null),t(2,O=[]),z&&z()}function K(et){const Ze=et.detail;if(O.find(Kt=>Kt.id===Ze.id)!==void 0){t(2,O=O.filter(Kt=>Kt.id!==Ze.id));return}t(2,O=[...O,Ze])}const te=z1();function ie(et){const Ze=et.detail;O.length===1&&O[0]===Ze?(t(2,O=[]),te("singleLayerSelect",{layer:null})):(t(2,O=[Ze]),te("singleLayerSelect",{layer:Ze}))}async function Te(et){const Ze=et.target;if(Ze.files&&Ze.files.length>0){C=Ze.files;const At=await aF(C);Uv.add(At),Ze.value=""}}function le(){O.forEach(et=>{const Ze=et.source.data;if(!Ze)return;const At=et.displayName+".geojson",Kt="application/json";JSON.stringify(Ze);const sn=new Blob([JSON.stringify(Ze)],{type:Kt}),zn=URL.createObjectURL(sn),ri=document.createElement("a");ri.href=zn,ri.download=At,ri.click(),URL.revokeObjectURL(zn)})}function fe(){r?t(2,O=[]):t(2,O=Xp(bo))}Ll(()=>{I.addEventListener("change",Te)});function Fe(et){M=et,t(4,M)}function Ne(et){x=et,t(0,x)}function Ue(et){O=et,t(2,O)}const dt=()=>I.click();function Ge(et){$n[et?"unshift":"push"](()=>{I=et,t(3,I)})}function Le(et){i=et,t(6,i),t(0,x),t(2,O),t(18,k)}const nt=()=>t(0,x=null),zt=()=>{t(4,M=!M),M||(t(2,O=[]),te("singleLayerSelect",{layer:null}))},Ot=()=>{O.forEach(et=>{h.removeLayer(et.id),h.removeSource(et.id),bo.deleteLayer(et.id)}),t(4,M=!M)};return n.$$set=et=>{"map"in et&&t(1,h=et.map),"draw"in et&&t(16,s=et.draw),"tools"in et&&t(17,p=et.tools),"selectedTool"in et&&t(0,x=et.selectedTool)},n.$$.update=()=>{var et;n.$$.dirty[0]&262149&&t(6,i=!((et=x==null?void 0:x.geoProcessor)!=null&&et.validator(O,k))),n.$$.dirty[0]&4&&t(5,r=O.length===Xp(bo).length)},[x,h,O,I,M,r,i,a,G,q,Z,K,te,ie,le,fe,s,p,k,Fe,Ne,Ue,dt,Ge,Le,nt,zt,Ot]}class BF extends Fr{constructor(e){super(),Br(this,e,FF,kF,Lr,{map:1,draw:16,tools:17,selectedTool:0},null,[-1,-1])}}function zF(n){let e,t,i,r,a,h=n[1].name.toUpperCase()+"",s,p,x;return{c(){e=un("button"),t=un("img"),r=qn(),a=un("p"),s=_r(h),this.h()},l(I){e=cn(I,"BUTTON",{class:!0});var C=_n(e);t=cn(C,"IMG",{class:!0,alt:!0,src:!0}),r=Hn(C),a=cn(C,"P",{class:!0});var M=_n(a);s=yr(M,h),M.forEach(Oe),C.forEach(Oe),this.h()},h(){tn(t,"class","button-icon svelte-dbbhwe"),tn(t,"alt","button"),dE(t.src,i=n[1].iconPath||"button-icons/intersection.png")||tn(t,"src",i),tn(a,"class","svelte-dbbhwe"),tn(e,"class","svelte-dbbhwe"),hv(e,"selected",n[0])},m(I,C){Tt(I,e,C),an(e,t),an(e,r),an(e,a),an(a,s),p||(x=Vi(e,"click",n[2]),p=!0)},p(I,[C]){C&2&&!dE(t.src,i=I[1].iconPath||"button-icons/intersection.png")&&tn(t,"src",i),C&2&&h!==(h=I[1].name.toUpperCase()+"")&&Ao(s,h),C&1&&hv(e,"selected",I[0])},i:za,o:za,d(I){I&&Oe(e),p=!1,x()}}}function UF(n,e,t){let{tool:i}=e,{selected:r=!1}=e;const a=z1();function h(){t(0,r=!r),a("toolSelected",r?i:null)}return n.$$set=s=>{"tool"in s&&t(1,i=s.tool),"selected"in s&&t(0,r=s.selected)},[r,i,h]}class VF extends Fr{constructor(e){super(),Br(this,e,UF,zF,Lr,{tool:1,selected:0})}}function XC(n,e,t){const i=n.slice();return i[3]=e[t],i}function ZC(n){let e,t,i=rd.sortBy(n[1],KC),r=[];for(let h=0;h<i.length;h+=1)r[h]=YC(XC(n,i,h));const a=h=>rt(r[h],1,1,()=>{r[h]=null});return{c(){for(let h=0;h<r.length;h+=1)r[h].c();e=Ei()},l(h){for(let s=0;s<r.length;s+=1)r[s].l(h);e=Ei()},m(h,s){for(let p=0;p<r.length;p+=1)r[p]&&r[p].m(h,s);Tt(h,e,s),t=!0},p(h,s){if(s&3){i=rd.sortBy(h[1],KC);let p;for(p=0;p<i.length;p+=1){const x=XC(h,i,p);r[p]?(r[p].p(x,s),Ke(r[p],1)):(r[p]=YC(x),r[p].c(),Ke(r[p],1),r[p].m(e.parentNode,e))}for(vr(),p=i.length;p<r.length;p+=1)a(p);xr()}},i(h){if(!t){for(let s=0;s<i.length;s+=1)Ke(r[s]);t=!0}},o(h){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)rt(r[s]);t=!1},d(h){U1(r,h),h&&Oe(e)}}}function YC(n){let e,t;return e=new VF({props:{tool:n[3],selected:n[3]===n[0]}}),e.$on("toolSelected",n[2]),{c(){Pn(e.$$.fragment)},l(i){Zn(e.$$.fragment,i)},m(i,r){Rn(e,i,r),t=!0},p(i,r){const a={};r&2&&(a.tool=i[3]),r&3&&(a.selected=i[3]===i[0]),e.$set(a)},i(i){t||(Ke(e.$$.fragment,i),t=!0)},o(i){rt(e.$$.fragment,i),t=!1},d(i){Dn(e,i)}}}function GF(n){let e,t,i=n[1]&&ZC(n);return{c(){e=un("div"),i&&i.c(),this.h()},l(r){e=cn(r,"DIV",{class:!0});var a=_n(e);i&&i.l(a),a.forEach(Oe),this.h()},h(){tn(e,"class","container svelte-ux8w1b")},m(r,a){Tt(r,e,a),i&&i.m(e,null),t=!0},p(r,[a]){r[1]?i?(i.p(r,a),a&2&&Ke(i,1)):(i=ZC(r),i.c(),Ke(i,1),i.m(e,null)):i&&(vr(),rt(i,1,1,()=>{i=null}),xr())},i(r){t||(Ke(i),t=!0)},o(r){rt(i),t=!1},d(r){r&&Oe(e),i&&i.d()}}}const KC=n=>n.name;function jF(n,e,t){let{selectedTool:i}=e,{tools:r}=e;function a(h){Zl.call(this,n,h)}return n.$$set=h=>{"selectedTool"in h&&t(0,i=h.selectedTool),"tools"in h&&t(1,r=h.tools)},[i,r,a]}class qF extends Fr{constructor(e){super(),Br(this,e,jF,GF,Lr,{selectedTool:0,tools:1})}}var WM={};Object.defineProperty(WM,"__esModule",{value:!0});var JC={enable:function(e){setTimeout(function(){!e.map||!e.map.doubleClickZoom||!e._ctx||!e._ctx.store||!e._ctx.store.getInitialConfigValue||e._ctx.store.getInitialConfigValue("doubleClickZoom")&&e.map.doubleClickZoom.enable()},0)},disable:function(e){setTimeout(function(){!e.map||!e.map.doubleClickZoom||e.map.doubleClickZoom.disable()},0)}},HF={onSetup:function(e){var t=this.newFeature({type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),JC.disable(this),this.updateUIClasses({mouse:"add"}),this.setActionableState({trash:!0}),{rectangle:t}},onTap:function(e,t){e.startPoint&&this.onMouseMove(e,t),this.onClick(e,t)},onClick:function(e,t){e.startPoint&&e.startPoint[0]!==t.lngLat.lng&&e.startPoint[1]!==t.lngLat.lat&&(this.updateUIClasses({mouse:"pointer"}),e.endPoint=[t.lngLat.lng,t.lngLat.lat],this.changeMode("simple_select",{featuresId:e.rectangle.id}));var i=[t.lngLat.lng,t.lngLat.lat];e.startPoint=i},onMouseMove:function(e,t){e.startPoint&&(e.rectangle.updateCoordinate("0.0",e.startPoint[0],e.startPoint[1]),e.rectangle.updateCoordinate("0.1",t.lngLat.lng,e.startPoint[1]),e.rectangle.updateCoordinate("0.2",t.lngLat.lng,t.lngLat.lat),e.rectangle.updateCoordinate("0.3",e.startPoint[0],t.lngLat.lat),e.rectangle.updateCoordinate("0.4",e.startPoint[0],e.startPoint[1]))},onKeyUp:function(e,t){if(t.keyCode===27)return this.changeMode("simple_select")},onStop:function(e){JC.enable(this),this.updateUIClasses({mouse:"none"}),this.activateUIButton(),this.getFeature(e.rectangle.id)!==void 0&&(e.rectangle.removeCoordinate("0.4"),e.rectangle.isValid()?this.map.fire("draw.create",{features:[e.rectangle.toGeoJSON()]}):(this.deleteFeature([e.rectangle.id],{silent:!0}),this.changeMode("simple_select",{},{silent:!0})))},toDisplayFeatures:function(e,t,i){var r=t.properties.id===e.rectangle.id;if(t.properties.active=r?"true":"false",!r)return i(t);if(e.startPoint)return i(t)},onTrash:function(e){this.deleteFeature([e.rectangle.id],{silent:!0}),this.changeMode("simple_select")}},WF=WM.default=HF,Gu=63710088e-1,XM={centimeters:Gu*100,centimetres:Gu*100,degrees:Gu/111325,feet:Gu*3.28084,inches:Gu*39.37,kilometers:Gu/1e3,kilometres:Gu/1e3,meters:Gu,metres:Gu,miles:Gu/1609.344,millimeters:Gu*1e3,millimetres:Gu*1e3,nauticalmiles:Gu/1852,radians:1,yards:Gu*1.0936};function Km(n,e,t){t===void 0&&(t={});var i={type:"Feature"};return(t.id===0||t.id)&&(i.id=t.id),t.bbox&&(i.bbox=t.bbox),i.properties=e||{},i.geometry=n,i}function XF(n,e,t){if(t===void 0&&(t={}),!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!QC(n[0])||!QC(n[1]))throw new Error("coordinates must contain numbers");var i={type:"Point",coordinates:n};return Km(i,e,t)}function jv(n,e,t){t===void 0&&(t={});for(var i=0,r=n;i<r.length;i++){var a=r[i];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var h=0;h<a[a.length-1].length;h++)if(a[a.length-1][h]!==a[0][h])throw new Error("First and last Position are not equivalent.")}var s={type:"Polygon",coordinates:n};return Km(s,e,t)}function ZF(n,e,t){if(t===void 0&&(t={}),n.length<2)throw new Error("coordinates must be an array of two or more positions");var i={type:"LineString",coordinates:n};return Km(i,e,t)}function gv(n,e){e===void 0&&(e={});var t={type:"FeatureCollection"};return e.id&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.features=n,t}function YF(n,e,t){t===void 0&&(t={});var i={type:"MultiLineString",coordinates:n};return Km(i,e,t)}function _v(n,e,t){t===void 0&&(t={});var i={type:"MultiPolygon",coordinates:n};return Km(i,e,t)}function KF(n,e){e===void 0&&(e="kilometers");var t=XM[e];if(!t)throw new Error(e+" units is invalid");return n*t}function JF(n,e){e===void 0&&(e="kilometers");var t=XM[e];if(!t)throw new Error(e+" units is invalid");return n/t}function QC(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}function ZM(n){return!!n&&n.constructor===Object}function YM(n,e,t){if(n!==null)for(var i,r,a,h,s,p,x,I=0,C=0,M,O=n.type,k=O==="FeatureCollection",z=O==="Feature",G=k?n.features.length:1,q=0;q<G;q++){x=k?n.features[q].geometry:z?n.geometry:n,M=x?x.type==="GeometryCollection":!1,s=M?x.geometries.length:1;for(var Z=0;Z<s;Z++){var K=0,te=0;if(h=M?x.geometries[Z]:x,h!==null){p=h.coordinates;var ie=h.type;switch(I=t&&(ie==="Polygon"||ie==="MultiPolygon")?1:0,ie){case null:break;case"Point":if(e(p,C,q,K,te)===!1)return!1;C++,K++;break;case"LineString":case"MultiPoint":for(i=0;i<p.length;i++){if(e(p[i],C,q,K,te)===!1)return!1;C++,ie==="MultiPoint"&&K++}ie==="LineString"&&K++;break;case"Polygon":case"MultiLineString":for(i=0;i<p.length;i++){for(r=0;r<p[i].length-I;r++){if(e(p[i][r],C,q,K,te)===!1)return!1;C++}ie==="MultiLineString"&&K++,ie==="Polygon"&&te++}ie==="Polygon"&&K++;break;case"MultiPolygon":for(i=0;i<p.length;i++){for(te=0,r=0;r<p[i].length;r++){for(a=0;a<p[i][r].length-I;a++){if(e(p[i][r][a],C,q,K,te)===!1)return!1;C++}te++}K++}break;case"GeometryCollection":for(i=0;i<h.geometries.length;i++)if(YM(h.geometries[i],e,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function AT(n,e){if(n.type==="Feature")e(n,0);else if(n.type==="FeatureCollection")for(var t=0;t<n.features.length&&e(n.features[t],t)!==!1;t++);}function pS(n,e){var t,i,r,a,h,s,p,x,I,C,M=0,O=n.type==="FeatureCollection",k=n.type==="Feature",z=O?n.features.length:1;for(t=0;t<z;t++){for(s=O?n.features[t].geometry:k?n.geometry:n,x=O?n.features[t].properties:k?n.properties:{},I=O?n.features[t].bbox:k?n.bbox:void 0,C=O?n.features[t].id:k?n.id:void 0,p=s?s.type==="GeometryCollection":!1,h=p?s.geometries.length:1,r=0;r<h;r++){if(a=p?s.geometries[r]:s,a===null){if(e(null,M,x,I,C)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(a,M,x,I,C)===!1)return!1;break}case"GeometryCollection":{for(i=0;i<a.geometries.length;i++)if(e(a.geometries[i],M,x,I,C)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}M++}}function QF(n,e){pS(n,function(t,i,r,a,h){var s=t===null?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return e(Km(t,r,{bbox:a,id:h}),i,0)===!1?!1:void 0}var p;switch(s){case"MultiPoint":p="Point";break;case"MultiLineString":p="LineString";break;case"MultiPolygon":p="Polygon";break}for(var x=0;x<t.coordinates.length;x++){var I=t.coordinates[x],C={type:p,coordinates:I};if(e(Km(C,r),i,x)===!1)return!1}})}function Jm(n){var e=[1/0,1/0,-1/0,-1/0];return YM(n,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}Jm.default=Jm;function $F(n,e){e===void 0&&(e={});var t=Jm(n),i=(t[0]+t[2])/2,r=(t[1]+t[3])/2;return XF([i,r],e.properties,e)}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(e){if(this===void 0||this===null)throw new TypeError(this+" is not an object");var t=Object(this),i=Math.max(Math.min(t.length,9007199254740991),0)||0,r=1 in arguments&&parseInt(Number(arguments[1]),10)||0;r=r<0?Math.max(i+r,0):Math.min(r,i);var a=2 in arguments&&arguments[2]!==void 0?parseInt(Number(arguments[2]),10)||0:i;for(a=a<0?Math.max(i+arguments[2],0):Math.min(a,i);r<a;)t[r]=e,++r;return t},writable:!0});Number.isFinite=Number.isFinite||function(n){return typeof n=="number"&&isFinite(n)};Number.isInteger=Number.isInteger||function(n){return typeof n=="number"&&isFinite(n)&&Math.floor(n)===n};Number.parseFloat=Number.parseFloat||parseFloat;Number.isNaN=Number.isNaN||function(n){return n!==n};Math.trunc=Math.trunc||function(n){return n<0?Math.ceil(n):Math.floor(n)};var p_=function(){};p_.prototype.interfaces_=function(){return[]};p_.prototype.getClass=function(){return p_};p_.prototype.equalsWithTolerance=function(e,t,i){return Math.abs(e-t)<=i};var Xs=function(n){function e(t){n.call(this,t),this.name="IllegalArgumentException",this.message=t,this.stack=new n().stack}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e}(Error),zi=function(){},KM={MAX_VALUE:{configurable:!0}};zi.isNaN=function(e){return Number.isNaN(e)};zi.doubleToLongBits=function(e){return e};zi.longBitsToDouble=function(e){return e};zi.isInfinite=function(e){return!Number.isFinite(e)};KM.MAX_VALUE.get=function(){return Number.MAX_VALUE};Object.defineProperties(zi,KM);var Vc=function(){},qE=function(){},yv=function(){};function Gc(){}var ht=function n(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)this.x=0,this.y=0,this.z=n.NULL_ORDINATE;else if(arguments.length===1){var e=arguments[0];this.x=e.x,this.y=e.y,this.z=e.z}else arguments.length===2?(this.x=arguments[0],this.y=arguments[1],this.z=n.NULL_ORDINATE):arguments.length===3&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},A_={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};ht.prototype.setOrdinate=function(e,t){switch(e){case ht.X:this.x=t;break;case ht.Y:this.y=t;break;case ht.Z:this.z=t;break;default:throw new Xs("Invalid ordinate index: "+e)}};ht.prototype.equals2D=function(){if(arguments.length===1){var e=arguments[0];return!(this.x!==e.x||this.y!==e.y)}else if(arguments.length===2){var t=arguments[0],i=arguments[1];return!(!p_.equalsWithTolerance(this.x,t.x,i)||!p_.equalsWithTolerance(this.y,t.y,i))}};ht.prototype.getOrdinate=function(e){switch(e){case ht.X:return this.x;case ht.Y:return this.y;case ht.Z:return this.z}throw new Xs("Invalid ordinate index: "+e)};ht.prototype.equals3D=function(e){return this.x===e.x&&this.y===e.y&&(this.z===e.z||zi.isNaN(this.z))&&zi.isNaN(e.z)};ht.prototype.equals=function(e){return e instanceof ht?this.equals2D(e):!1};ht.prototype.equalInZ=function(e,t){return p_.equalsWithTolerance(this.z,e.z,t)};ht.prototype.compareTo=function(e){var t=e;return this.x<t.x?-1:this.x>t.x?1:this.y<t.y?-1:this.y>t.y?1:0};ht.prototype.clone=function(){};ht.prototype.copy=function(){return new ht(this)};ht.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"};ht.prototype.distance3D=function(e){var t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return Math.sqrt(t*t+i*i+r*r)};ht.prototype.distance=function(e){var t=this.x-e.x,i=this.y-e.y;return Math.sqrt(t*t+i*i)};ht.prototype.hashCode=function(){var e=17;return e=37*e+ht.hashCode(this.x),e=37*e+ht.hashCode(this.y),e};ht.prototype.setCoordinate=function(e){this.x=e.x,this.y=e.y,this.z=e.z};ht.prototype.interfaces_=function(){return[Vc,qE,Gc]};ht.prototype.getClass=function(){return ht};ht.hashCode=function(){if(arguments.length===1){var e=arguments[0],t=zi.doubleToLongBits(e);return Math.trunc((t^t)>>>32)}};A_.DimensionalComparator.get=function(){return Zp};A_.serialVersionUID.get=function(){return 6683108902428367e3};A_.NULL_ORDINATE.get=function(){return zi.NaN};A_.X.get=function(){return 0};A_.Y.get=function(){return 1};A_.Z.get=function(){return 2};Object.defineProperties(ht,A_);var Zp=function(e){if(this._dimensionsToTest=2,arguments.length!==0){if(arguments.length===1){var t=arguments[0];if(t!==2&&t!==3)throw new Xs("only 2 or 3 dimensions may be specified");this._dimensionsToTest=t}}};Zp.prototype.compare=function(e,t){var i=e,r=t,a=Zp.compare(i.x,r.x);if(a!==0)return a;var h=Zp.compare(i.y,r.y);if(h!==0)return h;if(this._dimensionsToTest<=2)return 0;var s=Zp.compare(i.z,r.z);return s};Zp.prototype.interfaces_=function(){return[yv]};Zp.prototype.getClass=function(){return Zp};Zp.compare=function(e,t){return e<t?-1:e>t?1:zi.isNaN(e)?zi.isNaN(t)?0:-1:zi.isNaN(t)?1:0};var vv=function(){};vv.prototype.create=function(){};vv.prototype.interfaces_=function(){return[]};vv.prototype.getClass=function(){return vv};var vt=function(){},Z1={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};vt.prototype.interfaces_=function(){return[]};vt.prototype.getClass=function(){return vt};vt.toLocationSymbol=function(e){switch(e){case vt.EXTERIOR:return"e";case vt.BOUNDARY:return"b";case vt.INTERIOR:return"i";case vt.NONE:return"-"}throw new Xs("Unknown location value: "+e)};Z1.INTERIOR.get=function(){return 0};Z1.BOUNDARY.get=function(){return 1};Z1.EXTERIOR.get=function(){return 2};Z1.NONE.get=function(){return-1};Object.defineProperties(vt,Z1);var Si=function(n,e){return n.interfaces_&&n.interfaces_().indexOf(e)>-1},Yu=function(){},JM={LOG_10:{configurable:!0}};Yu.prototype.interfaces_=function(){return[]};Yu.prototype.getClass=function(){return Yu};Yu.log10=function(e){var t=Math.log(e);return zi.isInfinite(t)||zi.isNaN(t)?t:t/Yu.LOG_10};Yu.min=function(e,t,i,r){var a=e;return t<a&&(a=t),i<a&&(a=i),r<a&&(a=r),a};Yu.clamp=function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],t=arguments[1],i=arguments[2];return e<t?t:e>i?i:e}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var r=arguments[0],a=arguments[1],h=arguments[2];return r<a?a:r>h?h:r}};Yu.wrap=function(e,t){return e<0?t- -e%t:e%t};Yu.max=function(){if(arguments.length===3){var e=arguments[0],t=arguments[1],i=arguments[2],r=e;return t>r&&(r=t),i>r&&(r=i),r}else if(arguments.length===4){var a=arguments[0],h=arguments[1],s=arguments[2],p=arguments[3],x=a;return h>x&&(x=h),s>x&&(x=s),p>x&&(x=p),x}};Yu.average=function(e,t){return(e+t)/2};JM.LOG_10.get=function(){return Math.log(10)};Object.defineProperties(Yu,JM);var wf=function(e){this.str=e};wf.prototype.append=function(e){this.str+=e};wf.prototype.setCharAt=function(e,t){this.str=this.str.substr(0,e)+t+this.str.substr(e+1)};wf.prototype.toString=function(e){return this.str};var df=function(e){this.value=e};df.prototype.intValue=function(){return this.value};df.prototype.compareTo=function(e){return this.value<e?-1:this.value>e?1:0};df.isNaN=function(e){return Number.isNaN(e)};var E1=function(){};E1.isWhitespace=function(e){return e<=32&&e>=0||e===127};E1.toUpperCase=function(e){return e.toUpperCase()};var Ct=function n(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof n){var t=arguments[0];this.init(t)}else if(typeof arguments[0]=="string"){var i=arguments[0];n.call(this,n.parse(i))}}else if(arguments.length===2){var r=arguments[0],a=arguments[1];this.init(r,a)}},Ih={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};Ct.prototype.le=function(e){return(this._hi<e._hi||this._hi===e._hi)&&this._lo<=e._lo};Ct.prototype.extractSignificantDigits=function(e,t){var i=this.abs(),r=Ct.magnitude(i._hi),a=Ct.TEN.pow(r);i=i.divide(a),i.gt(Ct.TEN)?(i=i.divide(Ct.TEN),r+=1):i.lt(Ct.ONE)&&(i=i.multiply(Ct.TEN),r-=1);for(var h=r+1,s=new wf,p=Ct.MAX_PRINT_DIGITS-1,x=0;x<=p;x++){e&&x===h&&s.append(".");var I=Math.trunc(i._hi);if(I<0)break;var C=!1,M=0;I>9?(C=!0,M="9"):M="0"+I,s.append(M),i=i.subtract(Ct.valueOf(I)).multiply(Ct.TEN),C&&i.selfAdd(Ct.TEN);var O=!0,k=Ct.magnitude(i._hi);if(k<0&&Math.abs(k)>=p-x&&(O=!1),!O)break}return t[0]=r,s.toString()};Ct.prototype.sqr=function(){return this.multiply(this)};Ct.prototype.doubleValue=function(){return this._hi+this._lo};Ct.prototype.subtract=function(){if(arguments[0]instanceof Ct){var e=arguments[0];return this.add(e.negate())}else if(typeof arguments[0]=="number"){var t=arguments[0];return this.add(-t)}};Ct.prototype.equals=function(){if(arguments.length===1){var e=arguments[0];return this._hi===e._hi&&this._lo===e._lo}};Ct.prototype.isZero=function(){return this._hi===0&&this._lo===0};Ct.prototype.selfSubtract=function(){if(arguments[0]instanceof Ct){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e._hi,-e._lo)}else if(typeof arguments[0]=="number"){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t,0)}};Ct.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null};Ct.prototype.min=function(e){return this.le(e)?this:e};Ct.prototype.selfDivide=function(){if(arguments.length===1){if(arguments[0]instanceof Ct){var e=arguments[0];return this.selfDivide(e._hi,e._lo)}else if(typeof arguments[0]=="number"){var t=arguments[0];return this.selfDivide(t,0)}}else if(arguments.length===2){var i=arguments[0],r=arguments[1],a=null,h=null,s=null,p=null,x=null,I=null,C=null,M=null;return x=this._hi/i,I=Ct.SPLIT*x,a=I-x,M=Ct.SPLIT*i,a=I-a,h=x-a,s=M-i,C=x*i,s=M-s,p=i-s,M=a*s-C+a*p+h*s+h*p,I=(this._hi-C-M+this._lo-x*r)/i,M=x+I,this._hi=M,this._lo=x-M+I,this}};Ct.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"};Ct.prototype.divide=function(){if(arguments[0]instanceof Ct){var e=arguments[0],t=null,i=null,r=null,a=null,h=null,s=null,p=null,x=null;h=this._hi/e._hi,s=Ct.SPLIT*h,t=s-h,x=Ct.SPLIT*e._hi,t=s-t,i=h-t,r=x-e._hi,p=h*e._hi,r=x-r,a=e._hi-r,x=t*r-p+t*a+i*r+i*a,s=(this._hi-p-x+this._lo-h*e._lo)/e._hi,x=h+s;var I=x,C=h-x+s;return new Ct(I,C)}else if(typeof arguments[0]=="number"){var M=arguments[0];return zi.isNaN(M)?Ct.createNaN():Ct.copy(this).selfDivide(M,0)}};Ct.prototype.ge=function(e){return(this._hi>e._hi||this._hi===e._hi)&&this._lo>=e._lo};Ct.prototype.pow=function(e){if(e===0)return Ct.valueOf(1);var t=new Ct(this),i=Ct.valueOf(1),r=Math.abs(e);if(r>1)for(;r>0;)r%2===1&&i.selfMultiply(t),r/=2,r>0&&(t=t.sqr());else i=t;return e<0?i.reciprocal():i};Ct.prototype.ceil=function(){if(this.isNaN())return Ct.NaN;var e=Math.ceil(this._hi),t=0;return e===this._hi&&(t=Math.ceil(this._lo)),new Ct(e,t)};Ct.prototype.compareTo=function(e){var t=e;return this._hi<t._hi?-1:this._hi>t._hi?1:this._lo<t._lo?-1:this._lo>t._lo?1:0};Ct.prototype.rint=function(){if(this.isNaN())return this;var e=this.add(.5);return e.floor()};Ct.prototype.setValue=function(){if(arguments[0]instanceof Ct){var e=arguments[0];return this.init(e),this}else if(typeof arguments[0]=="number"){var t=arguments[0];return this.init(t),this}};Ct.prototype.max=function(e){return this.ge(e)?this:e};Ct.prototype.sqrt=function(){if(this.isZero())return Ct.valueOf(0);if(this.isNegative())return Ct.NaN;var e=1/Math.sqrt(this._hi),t=this._hi*e,i=Ct.valueOf(t),r=this.subtract(i.sqr()),a=r._hi*(e*.5);return i.add(a)};Ct.prototype.selfAdd=function(){if(arguments.length===1){if(arguments[0]instanceof Ct){var e=arguments[0];return this.selfAdd(e._hi,e._lo)}else if(typeof arguments[0]=="number"){var t=arguments[0],i=null,r=null,a=null,h=null,s=null,p=null;return a=this._hi+t,s=a-this._hi,h=a-s,h=t-s+(this._hi-h),p=h+this._lo,i=a+p,r=p+(a-i),this._hi=i+r,this._lo=r+(i-this._hi),this}}else if(arguments.length===2){var x=arguments[0],I=arguments[1],C=null,M=null,O=null,k=null,z=null,G=null,q=null,Z=null;z=this._hi+x,O=this._lo+I,q=z-this._hi,Z=O-this._lo,G=z-q,k=O-Z,G=x-q+(this._hi-G),k=I-Z+(this._lo-k),q=G+O,C=z+q,M=q+(z-C),q=k+M;var K=C+q,te=q+(C-K);return this._hi=K,this._lo=te,this}};Ct.prototype.selfMultiply=function(){if(arguments.length===1){if(arguments[0]instanceof Ct){var e=arguments[0];return this.selfMultiply(e._hi,e._lo)}else if(typeof arguments[0]=="number"){var t=arguments[0];return this.selfMultiply(t,0)}}else if(arguments.length===2){var i=arguments[0],r=arguments[1],a=null,h=null,s=null,p=null,x=null,I=null;x=Ct.SPLIT*this._hi,a=x-this._hi,I=Ct.SPLIT*i,a=x-a,h=this._hi-a,s=I-i,x=this._hi*i,s=I-s,p=i-s,I=a*s-x+a*p+h*s+h*p+(this._hi*r+this._lo*i);var C=x+I;a=x-C;var M=I+a;return this._hi=C,this._lo=M,this}};Ct.prototype.selfSqr=function(){return this.selfMultiply(this)};Ct.prototype.floor=function(){if(this.isNaN())return Ct.NaN;var e=Math.floor(this._hi),t=0;return e===this._hi&&(t=Math.floor(this._lo)),new Ct(e,t)};Ct.prototype.negate=function(){return this.isNaN()?this:new Ct(-this._hi,-this._lo)};Ct.prototype.clone=function(){};Ct.prototype.multiply=function(){if(arguments[0]instanceof Ct){var e=arguments[0];return e.isNaN()?Ct.createNaN():Ct.copy(this).selfMultiply(e)}else if(typeof arguments[0]=="number"){var t=arguments[0];return zi.isNaN(t)?Ct.createNaN():Ct.copy(this).selfMultiply(t,0)}};Ct.prototype.isNaN=function(){return zi.isNaN(this._hi)};Ct.prototype.intValue=function(){return Math.trunc(this._hi)};Ct.prototype.toString=function(){var e=Ct.magnitude(this._hi);return e>=-3&&e<=20?this.toStandardNotation():this.toSciNotation()};Ct.prototype.toStandardNotation=function(){var e=this.getSpecialNumberString();if(e!==null)return e;var t=new Array(1).fill(null),i=this.extractSignificantDigits(!0,t),r=t[0]+1,a=i;if(i.charAt(0)===".")a="0"+i;else if(r<0)a="0."+Ct.stringOfChar("0",-r)+i;else if(i.indexOf(".")===-1){var h=r-i.length,s=Ct.stringOfChar("0",h);a=i+s+".0"}return this.isNegative()?"-"+a:a};Ct.prototype.reciprocal=function(){var e=null,t=null,i=null,r=null,a=null,h=null,s=null,p=null;a=1/this._hi,h=Ct.SPLIT*a,e=h-a,p=Ct.SPLIT*this._hi,e=h-e,t=a-e,i=p-this._hi,s=a*this._hi,i=p-i,r=this._hi-i,p=e*i-s+e*r+t*i+t*r,h=(1-s-p-a*this._lo)/this._hi;var x=a+h,I=a-x+h;return new Ct(x,I)};Ct.prototype.toSciNotation=function(){if(this.isZero())return Ct.SCI_NOT_ZERO;var e=this.getSpecialNumberString();if(e!==null)return e;var t=new Array(1).fill(null),i=this.extractSignificantDigits(!1,t),r=Ct.SCI_NOT_EXPONENT_CHAR+t[0];if(i.charAt(0)==="0")throw new Error("Found leading zero: "+i);var a="";i.length>1&&(a=i.substring(1));var h=i.charAt(0)+"."+a;return this.isNegative()?"-"+h+r:h+r};Ct.prototype.abs=function(){return this.isNaN()?Ct.NaN:this.isNegative()?this.negate():new Ct(this)};Ct.prototype.isPositive=function(){return(this._hi>0||this._hi===0)&&this._lo>0};Ct.prototype.lt=function(e){return(this._hi<e._hi||this._hi===e._hi)&&this._lo<e._lo};Ct.prototype.add=function(){if(arguments[0]instanceof Ct){var e=arguments[0];return Ct.copy(this).selfAdd(e)}else if(typeof arguments[0]=="number"){var t=arguments[0];return Ct.copy(this).selfAdd(t)}};Ct.prototype.init=function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var e=arguments[0];this._hi=e,this._lo=0}else if(arguments[0]instanceof Ct){var t=arguments[0];this._hi=t._hi,this._lo=t._lo}}else if(arguments.length===2){var i=arguments[0],r=arguments[1];this._hi=i,this._lo=r}};Ct.prototype.gt=function(e){return(this._hi>e._hi||this._hi===e._hi)&&this._lo>e._lo};Ct.prototype.isNegative=function(){return(this._hi<0||this._hi===0)&&this._lo<0};Ct.prototype.trunc=function(){return this.isNaN()?Ct.NaN:this.isPositive()?this.floor():this.ceil()};Ct.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0};Ct.prototype.interfaces_=function(){return[Gc,Vc,qE]};Ct.prototype.getClass=function(){return Ct};Ct.sqr=function(e){return Ct.valueOf(e).selfMultiply(e)};Ct.valueOf=function(){if(typeof arguments[0]=="string"){var e=arguments[0];return Ct.parse(e)}else if(typeof arguments[0]=="number"){var t=arguments[0];return new Ct(t)}};Ct.sqrt=function(e){return Ct.valueOf(e).sqrt()};Ct.parse=function(e){for(var t=0,i=e.length;E1.isWhitespace(e.charAt(t));)t++;var r=!1;if(t<i){var a=e.charAt(t);(a==="-"||a==="+")&&(t++,a==="-"&&(r=!0))}for(var h=new Ct,s=0,p=0,x=0;!(t>=i);){var I=e.charAt(t);if(t++,E1.isDigit(I)){var C=I-"0";h.selfMultiply(Ct.TEN),h.selfAdd(C),s++;continue}if(I==="."){p=s;continue}if(I==="e"||I==="E"){var M=e.substring(t);try{x=df.parseInt(M)}catch(q){throw q instanceof Error?new Error("Invalid exponent "+M+" in string "+e):q}finally{}break}throw new Error("Unexpected character '"+I+"' at position "+t+" in string "+e)}var O=h,k=s-p-x;if(k===0)O=h;else if(k>0){var z=Ct.TEN.pow(k);O=h.divide(z)}else if(k<0){var G=Ct.TEN.pow(-k);O=h.multiply(G)}return r?O.negate():O};Ct.createNaN=function(){return new Ct(zi.NaN,zi.NaN)};Ct.copy=function(e){return new Ct(e)};Ct.magnitude=function(e){var t=Math.abs(e),i=Math.log(t)/Math.log(10),r=Math.trunc(Math.floor(i)),a=Math.pow(10,r);return a*10<=t&&(r+=1),r};Ct.stringOfChar=function(e,t){for(var i=new wf,r=0;r<t;r++)i.append(e);return i.toString()};Ih.PI.get=function(){return new Ct(3.141592653589793,12246467991473532e-32)};Ih.TWO_PI.get=function(){return new Ct(6.283185307179586,24492935982947064e-32)};Ih.PI_2.get=function(){return new Ct(1.5707963267948966,6123233995736766e-32)};Ih.E.get=function(){return new Ct(2.718281828459045,14456468917292502e-32)};Ih.NaN.get=function(){return new Ct(zi.NaN,zi.NaN)};Ih.EPS.get=function(){return 123259516440783e-46};Ih.SPLIT.get=function(){return 134217729};Ih.MAX_PRINT_DIGITS.get=function(){return 32};Ih.TEN.get=function(){return Ct.valueOf(10)};Ih.ONE.get=function(){return Ct.valueOf(1)};Ih.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"};Ih.SCI_NOT_ZERO.get=function(){return"0.0E0"};Object.defineProperties(Ct,Ih);var Yl=function(){},QM={DP_SAFE_EPSILON:{configurable:!0}};Yl.prototype.interfaces_=function(){return[]};Yl.prototype.getClass=function(){return Yl};Yl.orientationIndex=function(e,t,i){var r=Yl.orientationIndexFilter(e,t,i);if(r<=1)return r;var a=Ct.valueOf(t.x).selfAdd(-e.x),h=Ct.valueOf(t.y).selfAdd(-e.y),s=Ct.valueOf(i.x).selfAdd(-t.x),p=Ct.valueOf(i.y).selfAdd(-t.y);return a.selfMultiply(p).selfSubtract(h.selfMultiply(s)).signum()};Yl.signOfDet2x2=function(e,t,i,r){var a=e.multiply(r).selfSubtract(t.multiply(i));return a.signum()};Yl.intersection=function(e,t,i,r){var a=Ct.valueOf(r.y).selfSubtract(i.y).selfMultiply(Ct.valueOf(t.x).selfSubtract(e.x)),h=Ct.valueOf(r.x).selfSubtract(i.x).selfMultiply(Ct.valueOf(t.y).selfSubtract(e.y)),s=a.subtract(h),p=Ct.valueOf(r.x).selfSubtract(i.x).selfMultiply(Ct.valueOf(e.y).selfSubtract(i.y)),x=Ct.valueOf(r.y).selfSubtract(i.y).selfMultiply(Ct.valueOf(e.x).selfSubtract(i.x)),I=p.subtract(x),C=I.selfDivide(s).doubleValue(),M=Ct.valueOf(e.x).selfAdd(Ct.valueOf(t.x).selfSubtract(e.x).selfMultiply(C)).doubleValue(),O=Ct.valueOf(t.x).selfSubtract(e.x).selfMultiply(Ct.valueOf(e.y).selfSubtract(i.y)),k=Ct.valueOf(t.y).selfSubtract(e.y).selfMultiply(Ct.valueOf(e.x).selfSubtract(i.x)),z=O.subtract(k),G=z.selfDivide(s).doubleValue(),q=Ct.valueOf(i.y).selfAdd(Ct.valueOf(r.y).selfSubtract(i.y).selfMultiply(G)).doubleValue();return new ht(M,q)};Yl.orientationIndexFilter=function(e,t,i){var r=null,a=(e.x-i.x)*(t.y-i.y),h=(e.y-i.y)*(t.x-i.x),s=a-h;if(a>0){if(h<=0)return Yl.signum(s);r=a+h}else if(a<0){if(h>=0)return Yl.signum(s);r=-a-h}else return Yl.signum(s);var p=Yl.DP_SAFE_EPSILON*r;return s>=p||-s>=p?Yl.signum(s):2};Yl.signum=function(e){return e>0?1:e<0?-1:0};QM.DP_SAFE_EPSILON.get=function(){return 1e-15};Object.defineProperties(Yl,QM);var Or=function(){},Y1={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};Y1.X.get=function(){return 0};Y1.Y.get=function(){return 1};Y1.Z.get=function(){return 2};Y1.M.get=function(){return 3};Or.prototype.setOrdinate=function(e,t,i){};Or.prototype.size=function(){};Or.prototype.getOrdinate=function(e,t){};Or.prototype.getCoordinate=function(){};Or.prototype.getCoordinateCopy=function(e){};Or.prototype.getDimension=function(){};Or.prototype.getX=function(e){};Or.prototype.clone=function(){};Or.prototype.expandEnvelope=function(e){};Or.prototype.copy=function(){};Or.prototype.getY=function(e){};Or.prototype.toCoordinateArray=function(){};Or.prototype.interfaces_=function(){return[qE]};Or.prototype.getClass=function(){return Or};Object.defineProperties(Or,Y1);var $M=function(){},qv=function(n){function e(){n.call(this,"Projective point not representable on the Cartesian plane.")}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}($M),Ua=function(){};Ua.arraycopy=function(e,t,i,r,a){for(var h=0,s=t;s<t+a;s++)i[r+h]=e[s],h++};Ua.getProperty=function(e){return{"line.separator":`
`}[e]};var fh=function n(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],i=arguments[1];this.x=t,this.y=i,this.w=1}else if(arguments[0]instanceof n&&arguments[1]instanceof n){var r=arguments[0],a=arguments[1];this.x=r.y*a.w-a.y*r.w,this.y=a.x*r.w-r.x*a.w,this.w=r.x*a.y-a.x*r.y}else if(arguments[0]instanceof ht&&arguments[1]instanceof ht){var h=arguments[0],s=arguments[1];this.x=h.y-s.y,this.y=s.x-h.x,this.w=h.x*s.y-s.x*h.y}}else if(arguments.length===3){var p=arguments[0],x=arguments[1],I=arguments[2];this.x=p,this.y=x,this.w=I}else if(arguments.length===4){var C=arguments[0],M=arguments[1],O=arguments[2],k=arguments[3],z=C.y-M.y,G=M.x-C.x,q=C.x*M.y-M.x*C.y,Z=O.y-k.y,K=k.x-O.x,te=O.x*k.y-k.x*O.y;this.x=G*te-K*q,this.y=Z*q-z*te,this.w=z*K-Z*G}};fh.prototype.getY=function(){var e=this.y/this.w;if(zi.isNaN(e)||zi.isInfinite(e))throw new qv;return e};fh.prototype.getX=function(){var e=this.x/this.w;if(zi.isNaN(e)||zi.isInfinite(e))throw new qv;return e};fh.prototype.getCoordinate=function(){var e=new ht;return e.x=this.getX(),e.y=this.getY(),e};fh.prototype.interfaces_=function(){return[]};fh.prototype.getClass=function(){return fh};fh.intersection=function(e,t,i,r){var a=e.y-t.y,h=t.x-e.x,s=e.x*t.y-t.x*e.y,p=i.y-r.y,x=r.x-i.x,I=i.x*r.y-r.x*i.y,C=h*I-x*s,M=p*s-a*I,O=a*x-p*h,k=C/O,z=M/O;if(zi.isNaN(k)||zi.isInfinite(k)||zi.isNaN(z)||zi.isInfinite(z))throw new qv;return new ht(k,z)};var li=function n(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof ht){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof n){var t=arguments[0];this.init(t)}}else if(arguments.length===2){var i=arguments[0],r=arguments[1];this.init(i.x,r.x,i.y,r.y)}else if(arguments.length===4){var a=arguments[0],h=arguments[1],s=arguments[2],p=arguments[3];this.init(a,h,s,p)}},eL={serialVersionUID:{configurable:!0}};li.prototype.getArea=function(){return this.getWidth()*this.getHeight()};li.prototype.equals=function(e){if(!(e instanceof li))return!1;var t=e;return this.isNull()?t.isNull():this._maxx===t.getMaxX()&&this._maxy===t.getMaxY()&&this._minx===t.getMinX()&&this._miny===t.getMinY()};li.prototype.intersection=function(e){if(this.isNull()||e.isNull()||!this.intersects(e))return new li;var t=this._minx>e._minx?this._minx:e._minx,i=this._miny>e._miny?this._miny:e._miny,r=this._maxx<e._maxx?this._maxx:e._maxx,a=this._maxy<e._maxy?this._maxy:e._maxy;return new li(t,r,i,a)};li.prototype.isNull=function(){return this._maxx<this._minx};li.prototype.getMaxX=function(){return this._maxx};li.prototype.covers=function(){if(arguments.length===1){if(arguments[0]instanceof ht){var e=arguments[0];return this.covers(e.x,e.y)}else if(arguments[0]instanceof li){var t=arguments[0];return this.isNull()||t.isNull()?!1:t.getMinX()>=this._minx&&t.getMaxX()<=this._maxx&&t.getMinY()>=this._miny&&t.getMaxY()<=this._maxy}}else if(arguments.length===2){var i=arguments[0],r=arguments[1];return this.isNull()?!1:i>=this._minx&&i<=this._maxx&&r>=this._miny&&r<=this._maxy}};li.prototype.intersects=function(){if(arguments.length===1){if(arguments[0]instanceof li){var e=arguments[0];return this.isNull()||e.isNull()?!1:!(e._minx>this._maxx||e._maxx<this._minx||e._miny>this._maxy||e._maxy<this._miny)}else if(arguments[0]instanceof ht){var t=arguments[0];return this.intersects(t.x,t.y)}}else if(arguments.length===2){var i=arguments[0],r=arguments[1];return this.isNull()?!1:!(i>this._maxx||i<this._minx||r>this._maxy||r<this._miny)}};li.prototype.getMinY=function(){return this._miny};li.prototype.getMinX=function(){return this._minx};li.prototype.expandToInclude=function(){if(arguments.length===1){if(arguments[0]instanceof ht){var e=arguments[0];this.expandToInclude(e.x,e.y)}else if(arguments[0]instanceof li){var t=arguments[0];if(t.isNull())return null;this.isNull()?(this._minx=t.getMinX(),this._maxx=t.getMaxX(),this._miny=t.getMinY(),this._maxy=t.getMaxY()):(t._minx<this._minx&&(this._minx=t._minx),t._maxx>this._maxx&&(this._maxx=t._maxx),t._miny<this._miny&&(this._miny=t._miny),t._maxy>this._maxy&&(this._maxy=t._maxy))}}else if(arguments.length===2){var i=arguments[0],r=arguments[1];this.isNull()?(this._minx=i,this._maxx=i,this._miny=r,this._maxy=r):(i<this._minx&&(this._minx=i),i>this._maxx&&(this._maxx=i),r<this._miny&&(this._miny=r),r>this._maxy&&(this._maxy=r))}};li.prototype.minExtent=function(){if(this.isNull())return 0;var e=this.getWidth(),t=this.getHeight();return e<t?e:t};li.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx};li.prototype.compareTo=function(e){var t=e;return this.isNull()?t.isNull()?0:-1:t.isNull()?1:this._minx<t._minx?-1:this._minx>t._minx?1:this._miny<t._miny?-1:this._miny>t._miny?1:this._maxx<t._maxx?-1:this._maxx>t._maxx?1:this._maxy<t._maxy?-1:this._maxy>t._maxy?1:0};li.prototype.translate=function(e,t){if(this.isNull())return null;this.init(this.getMinX()+e,this.getMaxX()+e,this.getMinY()+t,this.getMaxY()+t)};li.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"};li.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1};li.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny};li.prototype.maxExtent=function(){if(this.isNull())return 0;var e=this.getWidth(),t=this.getHeight();return e>t?e:t};li.prototype.expandBy=function(){if(arguments.length===1){var e=arguments[0];this.expandBy(e,e)}else if(arguments.length===2){var t=arguments[0],i=arguments[1];if(this.isNull())return null;this._minx-=t,this._maxx+=t,this._miny-=i,this._maxy+=i,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}};li.prototype.contains=function(){if(arguments.length===1){if(arguments[0]instanceof li){var e=arguments[0];return this.covers(e)}else if(arguments[0]instanceof ht){var t=arguments[0];return this.covers(t)}}else if(arguments.length===2){var i=arguments[0],r=arguments[1];return this.covers(i,r)}};li.prototype.centre=function(){return this.isNull()?null:new ht((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)};li.prototype.init=function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof ht){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof li){var t=arguments[0];this._minx=t._minx,this._maxx=t._maxx,this._miny=t._miny,this._maxy=t._maxy}}else if(arguments.length===2){var i=arguments[0],r=arguments[1];this.init(i.x,r.x,i.y,r.y)}else if(arguments.length===4){var a=arguments[0],h=arguments[1],s=arguments[2],p=arguments[3];a<h?(this._minx=a,this._maxx=h):(this._minx=h,this._maxx=a),s<p?(this._miny=s,this._maxy=p):(this._miny=p,this._maxy=s)}};li.prototype.getMaxY=function(){return this._maxy};li.prototype.distance=function(e){if(this.intersects(e))return 0;var t=0;this._maxx<e._minx?t=e._minx-this._maxx:this._minx>e._maxx&&(t=this._minx-e._maxx);var i=0;return this._maxy<e._miny?i=e._miny-this._maxy:this._miny>e._maxy&&(i=this._miny-e._maxy),t===0?i:i===0?t:Math.sqrt(t*t+i*i)};li.prototype.hashCode=function(){var e=17;return e=37*e+ht.hashCode(this._minx),e=37*e+ht.hashCode(this._maxx),e=37*e+ht.hashCode(this._miny),e=37*e+ht.hashCode(this._maxy),e};li.prototype.interfaces_=function(){return[Vc,Gc]};li.prototype.getClass=function(){return li};li.intersects=function(){if(arguments.length===3){var e=arguments[0],t=arguments[1],i=arguments[2];return i.x>=(e.x<t.x?e.x:t.x)&&i.x<=(e.x>t.x?e.x:t.x)&&i.y>=(e.y<t.y?e.y:t.y)&&i.y<=(e.y>t.y?e.y:t.y)}else if(arguments.length===4){var r=arguments[0],a=arguments[1],h=arguments[2],s=arguments[3],p=Math.min(h.x,s.x),x=Math.max(h.x,s.x),I=Math.min(r.x,a.x),C=Math.max(r.x,a.x);return!(I>x||C<p||(p=Math.min(h.y,s.y),x=Math.max(h.y,s.y),I=Math.min(r.y,a.y),C=Math.max(r.y,a.y),I>x)||C<p)}};eL.serialVersionUID.get=function(){return 5873921885273102e3};Object.defineProperties(li,eL);var rf={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},HE=function(e){this.geometryFactory=e||new mr};HE.prototype.read=function(e){var t,i,r;e=e.replace(/[\n\r]/g," ");var a=rf.typeStr.exec(e);if(e.search("EMPTY")!==-1&&(a=rf.emptyTypeStr.exec(e),a[2]=void 0),a&&(i=a[1].toLowerCase(),r=a[2],Jy[i]&&(t=Jy[i].apply(this,[r]))),t===void 0)throw new Error("Could not parse WKT "+e);return t};HE.prototype.write=function(e){return this.extractGeometry(e)};HE.prototype.extractGeometry=function(e){var t=e.getGeometryType().toLowerCase();if(!Wd[t])return null;var i=t.toUpperCase(),r;return e.isEmpty()?r=i+" EMPTY":r=i+"("+Wd[t].apply(this,[e])+")",r};var Wd={coordinate:function(e){return e.x+" "+e.y},point:function(e){return Wd.coordinate.call(this,e._coordinates._coordinates[0])},multipoint:function(e){for(var t=this,i=[],r=0,a=e._geometries.length;r<a;++r)i.push("("+Wd.point.apply(t,[e._geometries[r]])+")");return i.join(",")},linestring:function(e){for(var t=this,i=[],r=0,a=e._points._coordinates.length;r<a;++r)i.push(Wd.coordinate.apply(t,[e._points._coordinates[r]]));return i.join(",")},linearring:function(e){for(var t=this,i=[],r=0,a=e._points._coordinates.length;r<a;++r)i.push(Wd.coordinate.apply(t,[e._points._coordinates[r]]));return i.join(",")},multilinestring:function(e){for(var t=this,i=[],r=0,a=e._geometries.length;r<a;++r)i.push("("+Wd.linestring.apply(t,[e._geometries[r]])+")");return i.join(",")},polygon:function(e){var t=this,i=[];i.push("("+Wd.linestring.apply(this,[e._shell])+")");for(var r=0,a=e._holes.length;r<a;++r)i.push("("+Wd.linestring.apply(t,[e._holes[r]])+")");return i.join(",")},multipolygon:function(e){for(var t=this,i=[],r=0,a=e._geometries.length;r<a;++r)i.push("("+Wd.polygon.apply(t,[e._geometries[r]])+")");return i.join(",")},geometrycollection:function(e){for(var t=this,i=[],r=0,a=e._geometries.length;r<a;++r)i.push(t.extractGeometry(e._geometries[r]));return i.join(",")}},Jy={point:function(e){if(e===void 0)return this.geometryFactory.createPoint();var t=e.trim().split(rf.spaces);return this.geometryFactory.createPoint(new ht(Number.parseFloat(t[0]),Number.parseFloat(t[1])))},multipoint:function(e){var t=this;if(e===void 0)return this.geometryFactory.createMultiPoint();for(var i,r=e.trim().split(","),a=[],h=0,s=r.length;h<s;++h)i=r[h].replace(rf.trimParens,"$1"),a.push(Jy.point.apply(t,[i]));return this.geometryFactory.createMultiPoint(a)},linestring:function(e){if(e===void 0)return this.geometryFactory.createLineString();for(var t=e.trim().split(","),i=[],r,a=0,h=t.length;a<h;++a)r=t[a].trim().split(rf.spaces),i.push(new ht(Number.parseFloat(r[0]),Number.parseFloat(r[1])));return this.geometryFactory.createLineString(i)},linearring:function(e){if(e===void 0)return this.geometryFactory.createLinearRing();for(var t=e.trim().split(","),i=[],r,a=0,h=t.length;a<h;++a)r=t[a].trim().split(rf.spaces),i.push(new ht(Number.parseFloat(r[0]),Number.parseFloat(r[1])));return this.geometryFactory.createLinearRing(i)},multilinestring:function(e){var t=this;if(e===void 0)return this.geometryFactory.createMultiLineString();for(var i,r=e.trim().split(rf.parenComma),a=[],h=0,s=r.length;h<s;++h)i=r[h].replace(rf.trimParens,"$1"),a.push(Jy.linestring.apply(t,[i]));return this.geometryFactory.createMultiLineString(a)},polygon:function(e){var t=this;if(e===void 0)return this.geometryFactory.createPolygon();for(var i,r,a,h=e.trim().split(rf.parenComma),s,p=[],x=0,I=h.length;x<I;++x)i=h[x].replace(rf.trimParens,"$1"),r=Jy.linestring.apply(t,[i]),a=t.geometryFactory.createLinearRing(r._points),x===0?s=a:p.push(a);return this.geometryFactory.createPolygon(s,p)},multipolygon:function(e){var t=this;if(e===void 0)return this.geometryFactory.createMultiPolygon();for(var i,r=e.trim().split(rf.doubleParenComma),a=[],h=0,s=r.length;h<s;++h)i=r[h].replace(rf.trimParens,"$1"),a.push(Jy.polygon.apply(t,[i]));return this.geometryFactory.createMultiPolygon(a)},geometrycollection:function(e){var t=this;if(e===void 0)return this.geometryFactory.createGeometryCollection();e=e.replace(/,\s*([A-Za-z])/g,"|$1");for(var i=e.trim().split("|"),r=[],a=0,h=i.length;a<h;++a)r.push(t.read(i[a]));return this.geometryFactory.createGeometryCollection(r)}},mh=function(e){this.parser=new HE(e)};mh.prototype.write=function(e){return this.parser.write(e)};mh.toLineString=function(e,t){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+e.x+" "+e.y+", "+t.x+" "+t.y+" )"};var np=function(n){function e(t){n.call(this,t),this.name="RuntimeException",this.message=t,this.stack=new n().stack}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e}(Error),EE=function(n){function e(){if(n.call(this),arguments.length===0)n.call(this);else if(arguments.length===1){var t=arguments[0];n.call(this,t)}}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(np),Zi=function(){};Zi.prototype.interfaces_=function(){return[]};Zi.prototype.getClass=function(){return Zi};Zi.shouldNeverReachHere=function(){if(arguments.length===0)Zi.shouldNeverReachHere(null);else if(arguments.length===1){var e=arguments[0];throw new EE("Should never reach here"+(e!==null?": "+e:""))}};Zi.isTrue=function(){var e,t;if(arguments.length===1)e=arguments[0],Zi.isTrue(e,null);else if(arguments.length===2&&(e=arguments[0],t=arguments[1],!e))throw t===null?new EE:new EE(t)};Zi.equals=function(){var e,t,i;if(arguments.length===2)e=arguments[0],t=arguments[1],Zi.equals(e,t,null);else if(arguments.length===3&&(e=arguments[0],t=arguments[1],i=arguments[2],!t.equals(e)))throw new EE("Expected "+e+" but encountered "+t+(i!==null?": "+i:""))};var to=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new ht,this._intPt[1]=new ht,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},M_={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};to.prototype.getIndexAlongSegment=function(e,t){return this.computeIntLineIndex(),this._intLineIndex[e][t]};to.prototype.getTopologySummary=function(){var e=new wf;return this.isEndPoint()&&e.append(" endpoint"),this._isProper&&e.append(" proper"),this.isCollinear()&&e.append(" collinear"),e.toString()};to.prototype.computeIntersection=function(e,t,i,r){this._inputLines[0][0]=e,this._inputLines[0][1]=t,this._inputLines[1][0]=i,this._inputLines[1][1]=r,this._result=this.computeIntersect(e,t,i,r)};to.prototype.getIntersectionNum=function(){return this._result};to.prototype.computeIntLineIndex=function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var e=arguments[0],t=this.getEdgeDistance(e,0),i=this.getEdgeDistance(e,1);t>i?(this._intLineIndex[e][0]=0,this._intLineIndex[e][1]=1):(this._intLineIndex[e][0]=1,this._intLineIndex[e][1]=0)}};to.prototype.isProper=function(){return this.hasIntersection()&&this._isProper};to.prototype.setPrecisionModel=function(e){this._precisionModel=e};to.prototype.isInteriorIntersection=function(){var e=this;if(arguments.length===0)return!!(this.isInteriorIntersection(0)||this.isInteriorIntersection(1));if(arguments.length===1){for(var t=arguments[0],i=0;i<this._result;i++)if(!(e._intPt[i].equals2D(e._inputLines[t][0])||e._intPt[i].equals2D(e._inputLines[t][1])))return!0;return!1}};to.prototype.getIntersection=function(e){return this._intPt[e]};to.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper};to.prototype.hasIntersection=function(){return this._result!==to.NO_INTERSECTION};to.prototype.getEdgeDistance=function(e,t){var i=to.computeEdgeDistance(this._intPt[t],this._inputLines[e][0],this._inputLines[e][1]);return i};to.prototype.isCollinear=function(){return this._result===to.COLLINEAR_INTERSECTION};to.prototype.toString=function(){return mh.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+mh.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()};to.prototype.getEndpoint=function(e,t){return this._inputLines[e][t]};to.prototype.isIntersection=function(e){for(var t=this,i=0;i<this._result;i++)if(t._intPt[i].equals2D(e))return!0;return!1};to.prototype.getIntersectionAlongSegment=function(e,t){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[e][t]]};to.prototype.interfaces_=function(){return[]};to.prototype.getClass=function(){return to};to.computeEdgeDistance=function(e,t,i){var r=Math.abs(i.x-t.x),a=Math.abs(i.y-t.y),h=-1;if(e.equals(t))h=0;else if(e.equals(i))r>a?h=r:h=a;else{var s=Math.abs(e.x-t.x),p=Math.abs(e.y-t.y);r>a?h=s:h=p,h===0&&!e.equals(t)&&(h=Math.max(s,p))}return Zi.isTrue(!(h===0&&!e.equals(t)),"Bad distance calculation"),h};to.nonRobustComputeEdgeDistance=function(e,t,i){var r=e.x-t.x,a=e.y-t.y,h=Math.sqrt(r*r+a*a);return Zi.isTrue(!(h===0&&!e.equals(t)),"Invalid distance calculation"),h};M_.DONT_INTERSECT.get=function(){return 0};M_.DO_INTERSECT.get=function(){return 1};M_.COLLINEAR.get=function(){return 2};M_.NO_INTERSECTION.get=function(){return 0};M_.POINT_INTERSECTION.get=function(){return 1};M_.COLLINEAR_INTERSECTION.get=function(){return 2};Object.defineProperties(to,M_);var fg=function(n){function e(){n.apply(this,arguments)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.isInSegmentEnvelopes=function(i){var r=new li(this._inputLines[0][0],this._inputLines[0][1]),a=new li(this._inputLines[1][0],this._inputLines[1][1]);return r.contains(i)&&a.contains(i)},e.prototype.computeIntersection=function(){if(arguments.length===3){var i=arguments[0],r=arguments[1],a=arguments[2];if(this._isProper=!1,li.intersects(r,a,i)&&Nn.orientationIndex(r,a,i)===0&&Nn.orientationIndex(a,r,i)===0)return this._isProper=!0,(i.equals(r)||i.equals(a))&&(this._isProper=!1),this._result=n.POINT_INTERSECTION,null;this._result=n.NO_INTERSECTION}else return n.prototype.computeIntersection.apply(this,arguments)},e.prototype.normalizeToMinimum=function(i,r,a,h,s){s.x=this.smallestInAbsValue(i.x,r.x,a.x,h.x),s.y=this.smallestInAbsValue(i.y,r.y,a.y,h.y),i.x-=s.x,i.y-=s.y,r.x-=s.x,r.y-=s.y,a.x-=s.x,a.y-=s.y,h.x-=s.x,h.y-=s.y},e.prototype.safeHCoordinateIntersection=function(i,r,a,h){var s=null;try{s=fh.intersection(i,r,a,h)}catch(p){if(p instanceof qv)s=e.nearestEndpoint(i,r,a,h);else throw p}finally{}return s},e.prototype.intersection=function(i,r,a,h){var s=this.intersectionWithNormalization(i,r,a,h);return this.isInSegmentEnvelopes(s)||(s=new ht(e.nearestEndpoint(i,r,a,h))),this._precisionModel!==null&&this._precisionModel.makePrecise(s),s},e.prototype.smallestInAbsValue=function(i,r,a,h){var s=i,p=Math.abs(s);return Math.abs(r)<p&&(s=r,p=Math.abs(r)),Math.abs(a)<p&&(s=a,p=Math.abs(a)),Math.abs(h)<p&&(s=h),s},e.prototype.checkDD=function(i,r,a,h,s){var p=Yl.intersection(i,r,a,h),x=this.isInSegmentEnvelopes(p);Ua.out.println("DD in env = "+x+"  --------------------- "+p),s.distance(p)>1e-4&&Ua.out.println("Distance = "+s.distance(p))},e.prototype.intersectionWithNormalization=function(i,r,a,h){var s=new ht(i),p=new ht(r),x=new ht(a),I=new ht(h),C=new ht;this.normalizeToEnvCentre(s,p,x,I,C);var M=this.safeHCoordinateIntersection(s,p,x,I);return M.x+=C.x,M.y+=C.y,M},e.prototype.computeCollinearIntersection=function(i,r,a,h){var s=li.intersects(i,r,a),p=li.intersects(i,r,h),x=li.intersects(a,h,i),I=li.intersects(a,h,r);return s&&p?(this._intPt[0]=a,this._intPt[1]=h,n.COLLINEAR_INTERSECTION):x&&I?(this._intPt[0]=i,this._intPt[1]=r,n.COLLINEAR_INTERSECTION):s&&x?(this._intPt[0]=a,this._intPt[1]=i,a.equals(i)&&!p&&!I?n.POINT_INTERSECTION:n.COLLINEAR_INTERSECTION):s&&I?(this._intPt[0]=a,this._intPt[1]=r,a.equals(r)&&!p&&!x?n.POINT_INTERSECTION:n.COLLINEAR_INTERSECTION):p&&x?(this._intPt[0]=h,this._intPt[1]=i,h.equals(i)&&!s&&!I?n.POINT_INTERSECTION:n.COLLINEAR_INTERSECTION):p&&I?(this._intPt[0]=h,this._intPt[1]=r,h.equals(r)&&!s&&!x?n.POINT_INTERSECTION:n.COLLINEAR_INTERSECTION):n.NO_INTERSECTION},e.prototype.normalizeToEnvCentre=function(i,r,a,h,s){var p=i.x<r.x?i.x:r.x,x=i.y<r.y?i.y:r.y,I=i.x>r.x?i.x:r.x,C=i.y>r.y?i.y:r.y,M=a.x<h.x?a.x:h.x,O=a.y<h.y?a.y:h.y,k=a.x>h.x?a.x:h.x,z=a.y>h.y?a.y:h.y,G=p>M?p:M,q=I<k?I:k,Z=x>O?x:O,K=C<z?C:z,te=(G+q)/2,ie=(Z+K)/2;s.x=te,s.y=ie,i.x-=s.x,i.y-=s.y,r.x-=s.x,r.y-=s.y,a.x-=s.x,a.y-=s.y,h.x-=s.x,h.y-=s.y},e.prototype.computeIntersect=function(i,r,a,h){if(this._isProper=!1,!li.intersects(i,r,a,h))return n.NO_INTERSECTION;var s=Nn.orientationIndex(i,r,a),p=Nn.orientationIndex(i,r,h);if(s>0&&p>0||s<0&&p<0)return n.NO_INTERSECTION;var x=Nn.orientationIndex(a,h,i),I=Nn.orientationIndex(a,h,r);if(x>0&&I>0||x<0&&I<0)return n.NO_INTERSECTION;var C=s===0&&p===0&&x===0&&I===0;return C?this.computeCollinearIntersection(i,r,a,h):(s===0||p===0||x===0||I===0?(this._isProper=!1,i.equals2D(a)||i.equals2D(h)?this._intPt[0]=i:r.equals2D(a)||r.equals2D(h)?this._intPt[0]=r:s===0?this._intPt[0]=new ht(a):p===0?this._intPt[0]=new ht(h):x===0?this._intPt[0]=new ht(i):I===0&&(this._intPt[0]=new ht(r))):(this._isProper=!0,this._intPt[0]=this.intersection(i,r,a,h)),n.POINT_INTERSECTION)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.nearestEndpoint=function(i,r,a,h){var s=i,p=Nn.distancePointLine(i,a,h),x=Nn.distancePointLine(r,a,h);return x<p&&(p=x,s=r),x=Nn.distancePointLine(a,i,r),x<p&&(p=x,s=a),x=Nn.distancePointLine(h,i,r),x<p&&(p=x,s=h),s},e}(to),m_=function(){};m_.prototype.interfaces_=function(){return[]};m_.prototype.getClass=function(){return m_};m_.orientationIndex=function(e,t,i){var r=t.x-e.x,a=t.y-e.y,h=i.x-t.x,s=i.y-t.y;return m_.signOfDet2x2(r,a,h,s)};m_.signOfDet2x2=function(e,t,i,r){var a=null,h=null,s=null;if(a=1,e===0||r===0)return t===0||i===0?0:t>0?i>0?-a:a:i>0?a:-a;if(t===0||i===0)return r>0?e>0?a:-a:e>0?-a:a;if(t>0?r>0?t<=r||(a=-a,h=e,e=i,i=h,h=t,t=r,r=h):t<=-r?(a=-a,i=-i,r=-r):(h=e,e=-i,i=h,h=t,t=-r,r=h):r>0?-t<=r?(a=-a,e=-e,t=-t):(h=-e,e=i,i=h,h=-t,t=r,r=h):t>=r?(e=-e,t=-t,i=-i,r=-r):(a=-a,h=-e,e=-i,i=h,h=-t,t=-r,r=h),e>0)if(i>0){if(!(e<=i))return a}else return a;else{if(i>0)return-a;if(e>=i)a=-a,e=-e,i=-i;else return-a}for(;;){if(s=Math.floor(i/e),i=i-s*e,r=r-s*t,r<0)return-a;if(r>t)return a;if(e>i+i){if(t<r+r)return a}else{if(t>r+r)return-a;i=e-i,r=t-r,a=-a}if(r===0)return i===0?0:-a;if(i===0||(s=Math.floor(e/i),e=e-s*i,t=t-s*r,t<0))return a;if(t>r)return-a;if(i>e+e){if(r<t+t)return-a}else{if(r>t+t)return a;e=i-e,t=r-t,a=-a}if(t===0)return e===0?0:a;if(e===0)return-a}};var cf=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var e=arguments[0];this._p=e};cf.prototype.countSegment=function(e,t){if(e.x<this._p.x&&t.x<this._p.x)return null;if(this._p.x===t.x&&this._p.y===t.y)return this._isPointOnSegment=!0,null;if(e.y===this._p.y&&t.y===this._p.y){var i=e.x,r=t.x;return i>r&&(i=t.x,r=e.x),this._p.x>=i&&this._p.x<=r&&(this._isPointOnSegment=!0),null}if(e.y>this._p.y&&t.y<=this._p.y||t.y>this._p.y&&e.y<=this._p.y){var a=e.x-this._p.x,h=e.y-this._p.y,s=t.x-this._p.x,p=t.y-this._p.y,x=m_.signOfDet2x2(a,h,s,p);if(x===0)return this._isPointOnSegment=!0,null;p<h&&(x=-x),x>0&&this._crossingCount++}};cf.prototype.isPointInPolygon=function(){return this.getLocation()!==vt.EXTERIOR};cf.prototype.getLocation=function(){return this._isPointOnSegment?vt.BOUNDARY:this._crossingCount%2===1?vt.INTERIOR:vt.EXTERIOR};cf.prototype.isOnSegment=function(){return this._isPointOnSegment};cf.prototype.interfaces_=function(){return[]};cf.prototype.getClass=function(){return cf};cf.locatePointInRing=function(){if(arguments[0]instanceof ht&&Si(arguments[1],Or)){for(var e=arguments[0],t=arguments[1],i=new cf(e),r=new ht,a=new ht,h=1;h<t.size();h++)if(t.getCoordinate(h,r),t.getCoordinate(h-1,a),i.countSegment(r,a),i.isOnSegment())return i.getLocation();return i.getLocation()}else if(arguments[0]instanceof ht&&arguments[1]instanceof Array){for(var s=arguments[0],p=arguments[1],x=new cf(s),I=1;I<p.length;I++){var C=p[I],M=p[I-1];if(x.countSegment(C,M),x.isOnSegment())return x.getLocation()}return x.getLocation()}};var Nn=function(){},L_={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};Nn.prototype.interfaces_=function(){return[]};Nn.prototype.getClass=function(){return Nn};Nn.orientationIndex=function(e,t,i){return Yl.orientationIndex(e,t,i)};Nn.signedArea=function(){if(arguments[0]instanceof Array){var e=arguments[0];if(e.length<3)return 0;for(var t=0,i=e[0].x,r=1;r<e.length-1;r++){var a=e[r].x-i,h=e[r+1].y,s=e[r-1].y;t+=a*(s-h)}return t/2}else if(Si(arguments[0],Or)){var p=arguments[0],x=p.size();if(x<3)return 0;var I=new ht,C=new ht,M=new ht;p.getCoordinate(0,C),p.getCoordinate(1,M);var O=C.x;M.x-=O;for(var k=0,z=1;z<x-1;z++)I.y=C.y,C.x=M.x,C.y=M.y,p.getCoordinate(z+1,M),M.x-=O,k+=C.x*(I.y-M.y);return k/2}};Nn.distanceLineLine=function(e,t,i,r){if(e.equals(t))return Nn.distancePointLine(e,i,r);if(i.equals(r))return Nn.distancePointLine(r,e,t);var a=!1;if(!li.intersects(e,t,i,r))a=!0;else{var h=(t.x-e.x)*(r.y-i.y)-(t.y-e.y)*(r.x-i.x);if(h===0)a=!0;else{var s=(e.y-i.y)*(r.x-i.x)-(e.x-i.x)*(r.y-i.y),p=(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y),x=p/h,I=s/h;(I<0||I>1||x<0||x>1)&&(a=!0)}}return a?Yu.min(Nn.distancePointLine(e,i,r),Nn.distancePointLine(t,i,r),Nn.distancePointLine(i,e,t),Nn.distancePointLine(r,e,t)):0};Nn.isPointInRing=function(e,t){return Nn.locatePointInRing(e,t)!==vt.EXTERIOR};Nn.computeLength=function(e){var t=e.size();if(t<=1)return 0;var i=0,r=new ht;e.getCoordinate(0,r);for(var a=r.x,h=r.y,s=1;s<t;s++){e.getCoordinate(s,r);var p=r.x,x=r.y,I=p-a,C=x-h;i+=Math.sqrt(I*I+C*C),a=p,h=x}return i};Nn.isCCW=function(e){var t=e.length-1;if(t<3)throw new Xs("Ring has fewer than 4 points, so orientation cannot be determined");for(var i=e[0],r=0,a=1;a<=t;a++){var h=e[a];h.y>i.y&&(i=h,r=a)}var s=r;do s=s-1,s<0&&(s=t);while(e[s].equals2D(i)&&s!==r);var p=r;do p=(p+1)%t;while(e[p].equals2D(i)&&p!==r);var x=e[s],I=e[p];if(x.equals2D(i)||I.equals2D(i)||x.equals2D(I))return!1;var C=Nn.computeOrientation(x,i,I),M=!1;return C===0?M=x.x>I.x:M=C>0,M};Nn.locatePointInRing=function(e,t){return cf.locatePointInRing(e,t)};Nn.distancePointLinePerpendicular=function(e,t,i){var r=(i.x-t.x)*(i.x-t.x)+(i.y-t.y)*(i.y-t.y),a=((t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y))/r;return Math.abs(a)*Math.sqrt(r)};Nn.computeOrientation=function(e,t,i){return Nn.orientationIndex(e,t,i)};Nn.distancePointLine=function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];if(t.length===0)throw new Xs("Line array must contain at least one vertex");for(var i=e.distance(t[0]),r=0;r<t.length-1;r++){var a=Nn.distancePointLine(e,t[r],t[r+1]);a<i&&(i=a)}return i}else if(arguments.length===3){var h=arguments[0],s=arguments[1],p=arguments[2];if(s.x===p.x&&s.y===p.y)return h.distance(s);var x=(p.x-s.x)*(p.x-s.x)+(p.y-s.y)*(p.y-s.y),I=((h.x-s.x)*(p.x-s.x)+(h.y-s.y)*(p.y-s.y))/x;if(I<=0)return h.distance(s);if(I>=1)return h.distance(p);var C=((s.y-h.y)*(p.x-s.x)-(s.x-h.x)*(p.y-s.y))/x;return Math.abs(C)*Math.sqrt(x)}};Nn.isOnLine=function(e,t){for(var i=new fg,r=1;r<t.length;r++){var a=t[r-1],h=t[r];if(i.computeIntersection(e,a,h),i.hasIntersection())return!0}return!1};L_.CLOCKWISE.get=function(){return-1};L_.RIGHT.get=function(){return Nn.CLOCKWISE};L_.COUNTERCLOCKWISE.get=function(){return 1};L_.LEFT.get=function(){return Nn.COUNTERCLOCKWISE};L_.COLLINEAR.get=function(){return 0};L_.STRAIGHT.get=function(){return Nn.COLLINEAR};Object.defineProperties(Nn,L_);var ip=function(){};ip.prototype.filter=function(e){};ip.prototype.interfaces_=function(){return[]};ip.prototype.getClass=function(){return ip};var bi=function(){var e=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=e,this._SRID=e.getSRID()},md={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};bi.prototype.isGeometryCollection=function(){return this.getSortIndex()===bi.SORTINDEX_GEOMETRYCOLLECTION};bi.prototype.getFactory=function(){return this._factory};bi.prototype.getGeometryN=function(e){return this};bi.prototype.getArea=function(){return 0};bi.prototype.isRectangle=function(){return!1};bi.prototype.equals=function(){if(arguments[0]instanceof bi){var e=arguments[0];return e===null?!1:this.equalsTopo(e)}else if(arguments[0]instanceof Object){var t=arguments[0];if(!(t instanceof bi))return!1;var i=t;return this.equalsExact(i)}};bi.prototype.equalsExact=function(e){return this===e||this.equalsExact(e,0)};bi.prototype.geometryChanged=function(){this.apply(bi.geometryChangedFilter)};bi.prototype.geometryChangedAction=function(){this._envelope=null};bi.prototype.equalsNorm=function(e){return e===null?!1:this.norm().equalsExact(e.norm())};bi.prototype.getLength=function(){return 0};bi.prototype.getNumGeometries=function(){return 1};bi.prototype.compareTo=function(){if(arguments.length===1){var e=arguments[0],t=e;return this.getSortIndex()!==t.getSortIndex()?this.getSortIndex()-t.getSortIndex():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e)}else if(arguments.length===2){var i=arguments[0],r=arguments[1];return this.getSortIndex()!==i.getSortIndex()?this.getSortIndex()-i.getSortIndex():this.isEmpty()&&i.isEmpty()?0:this.isEmpty()?-1:i.isEmpty()?1:this.compareToSameClass(i,r)}};bi.prototype.getUserData=function(){return this._userData};bi.prototype.getSRID=function(){return this._SRID};bi.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())};bi.prototype.checkNotGeometryCollection=function(e){if(e.getSortIndex()===bi.SORTINDEX_GEOMETRYCOLLECTION)throw new Xs("This method does not support GeometryCollection arguments")};bi.prototype.equal=function(e,t,i){return i===0?e.equals(t):e.distance(t)<=i};bi.prototype.norm=function(){var e=this.copy();return e.normalize(),e};bi.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()};bi.prototype.getEnvelopeInternal=function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new li(this._envelope)};bi.prototype.setSRID=function(e){this._SRID=e};bi.prototype.setUserData=function(e){this._userData=e};bi.prototype.compare=function(e,t){for(var i=e.iterator(),r=t.iterator();i.hasNext()&&r.hasNext();){var a=i.next(),h=r.next(),s=a.compareTo(h);if(s!==0)return s}return i.hasNext()?1:r.hasNext()?-1:0};bi.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()};bi.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===bi.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===bi.SORTINDEX_MULTIPOINT||this.getSortIndex()===bi.SORTINDEX_MULTILINESTRING||this.getSortIndex()===bi.SORTINDEX_MULTIPOLYGON};bi.prototype.interfaces_=function(){return[qE,Vc,Gc]};bi.prototype.getClass=function(){return bi};bi.hasNonEmptyElements=function(e){for(var t=0;t<e.length;t++)if(!e[t].isEmpty())return!0;return!1};bi.hasNullElements=function(e){for(var t=0;t<e.length;t++)if(e[t]===null)return!0;return!1};md.serialVersionUID.get=function(){return 8763622679187377e3};md.SORTINDEX_POINT.get=function(){return 0};md.SORTINDEX_MULTIPOINT.get=function(){return 1};md.SORTINDEX_LINESTRING.get=function(){return 2};md.SORTINDEX_LINEARRING.get=function(){return 3};md.SORTINDEX_MULTILINESTRING.get=function(){return 4};md.SORTINDEX_POLYGON.get=function(){return 5};md.SORTINDEX_MULTIPOLYGON.get=function(){return 6};md.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7};md.geometryChangedFilter.get=function(){return mS};Object.defineProperties(bi,md);var mS=function(){};mS.interfaces_=function(){return[ip]};mS.filter=function(e){e.geometryChangedAction()};var sd=function(){};sd.prototype.filter=function(e){};sd.prototype.interfaces_=function(){return[]};sd.prototype.getClass=function(){return sd};var Nc=function(){},lp={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};Nc.prototype.isInBoundary=function(e){};Nc.prototype.interfaces_=function(){return[]};Nc.prototype.getClass=function(){return Nc};lp.Mod2BoundaryNodeRule.get=function(){return xv};lp.EndPointBoundaryNodeRule.get=function(){return bv};lp.MultiValentEndPointBoundaryNodeRule.get=function(){return Ev};lp.MonoValentEndPointBoundaryNodeRule.get=function(){return wv};lp.MOD2_BOUNDARY_RULE.get=function(){return new xv};lp.ENDPOINT_BOUNDARY_RULE.get=function(){return new bv};lp.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Ev};lp.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new wv};lp.OGC_SFS_BOUNDARY_RULE.get=function(){return Nc.MOD2_BOUNDARY_RULE};Object.defineProperties(Nc,lp);var xv=function(){};xv.prototype.isInBoundary=function(e){return e%2===1};xv.prototype.interfaces_=function(){return[Nc]};xv.prototype.getClass=function(){return xv};var bv=function(){};bv.prototype.isInBoundary=function(e){return e>0};bv.prototype.interfaces_=function(){return[Nc]};bv.prototype.getClass=function(){return bv};var Ev=function(){};Ev.prototype.isInBoundary=function(e){return e>1};Ev.prototype.interfaces_=function(){return[Nc]};Ev.prototype.getClass=function(){return Ev};var wv=function(){};wv.prototype.isInBoundary=function(e){return e===1};wv.prototype.interfaces_=function(){return[Nc]};wv.prototype.getClass=function(){return wv};var Yo=function(){};Yo.prototype.add=function(){};Yo.prototype.addAll=function(){};Yo.prototype.isEmpty=function(){};Yo.prototype.iterator=function(){};Yo.prototype.size=function(){};Yo.prototype.toArray=function(){};Yo.prototype.remove=function(){};function gS(n){this.message=n||""}gS.prototype=new Error;gS.prototype.name="IndexOutOfBoundsException";var Hv=function(){};Hv.prototype.hasNext=function(){};Hv.prototype.next=function(){};Hv.prototype.remove=function(){};var dh=function(n){function e(){n.apply(this,arguments)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.get=function(){},e.prototype.set=function(){},e.prototype.isEmpty=function(){},e}(Yo);function Wv(n){this.message=n||""}Wv.prototype=new Error;Wv.prototype.name="NoSuchElementException";var In=function(n){function e(){n.call(this),this.array_=[],arguments[0]instanceof Yo&&this.addAll(arguments[0])}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.ensureCapacity=function(){},e.prototype.interfaces_=function(){return[n,Yo]},e.prototype.add=function(i){return arguments.length===1?this.array_.push(i):this.array_.splice(arguments[0],arguments[1]),!0},e.prototype.clear=function(){this.array_=[]},e.prototype.addAll=function(i){for(var r=this,a=i.iterator();a.hasNext();)r.add(a.next());return!0},e.prototype.set=function(i,r){var a=this.array_[i];return this.array_[i]=r,a},e.prototype.iterator=function(){return new eB(this)},e.prototype.get=function(i){if(i<0||i>=this.size())throw new gS;return this.array_[i]},e.prototype.isEmpty=function(){return this.array_.length===0},e.prototype.size=function(){return this.array_.length},e.prototype.toArray=function(){for(var i=this,r=[],a=0,h=this.array_.length;a<h;a++)r.push(i.array_[a]);return r},e.prototype.remove=function(i){for(var r=this,a=!1,h=0,s=this.array_.length;h<s;h++)if(r.array_[h]===i){r.array_.splice(h,1),a=!0;break}return a},e}(dh),eB=function(n){function e(t){n.call(this),this.arrayList_=t,this.position_=0}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new Wv;return this.arrayList_.get(this.position_++)},e.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},e.prototype.set=function(i){return this.arrayList_.set(this.position_-1,i)},e.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},e}(Hv),K1=function(n){function e(){if(n.call(this),arguments.length!==0){if(arguments.length===1){var i=arguments[0];this.ensureCapacity(i.length),this.add(i,!0)}else if(arguments.length===2){var r=arguments[0],a=arguments[1];this.ensureCapacity(r.length),this.add(r,a)}}}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={coordArrayType:{configurable:!0}};return t.coordArrayType.get=function(){return new Array(0).fill(null)},e.prototype.getCoordinate=function(r){return this.get(r)},e.prototype.addAll=function(){var r=this;if(arguments.length===2){for(var a=arguments[0],h=arguments[1],s=!1,p=a.iterator();p.hasNext();)r.add(p.next(),h),s=!0;return s}else return n.prototype.addAll.apply(this,arguments)},e.prototype.clone=function(){for(var r=this,a=n.prototype.clone.call(this),h=0;h<this.size();h++)a.add(h,r.get(h).copy());return a},e.prototype.toCoordinateArray=function(){return this.toArray(e.coordArrayType)},e.prototype.add=function(){var r=this;if(arguments.length===1){var a=arguments[0];n.prototype.add.call(this,a)}else if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var h=arguments[0],s=arguments[1];return this.add(h,s,!0),!0}else if(arguments[0]instanceof ht&&typeof arguments[1]=="boolean"){var p=arguments[0],x=arguments[1];if(!x&&this.size()>=1){var I=this.get(this.size()-1);if(I.equals2D(p))return null}n.prototype.add.call(this,p)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var C=arguments[0],M=arguments[1];return this.add(C,M),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var O=arguments[0],k=arguments[1],z=arguments[2];if(z)for(var G=0;G<O.length;G++)r.add(O[G],k);else for(var q=O.length-1;q>=0;q--)r.add(O[q],k);return!0}else if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof ht){var Z=arguments[0],K=arguments[1],te=arguments[2];if(!te){var ie=this.size();if(ie>0){if(Z>0){var Te=this.get(Z-1);if(Te.equals2D(K))return null}if(Z<ie){var le=this.get(Z);if(le.equals2D(K))return null}}}n.prototype.add.call(this,Z,K)}}else if(arguments.length===4){var fe=arguments[0],Fe=arguments[1],Ne=arguments[2],Ue=arguments[3],dt=1;Ne>Ue&&(dt=-1);for(var Ge=Ne;Ge!==Ue;Ge+=dt)r.add(fe[Ge],Fe);return!0}},e.prototype.closeRing=function(){this.size()>0&&this.add(new ht(this.get(0)),!1)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},Object.defineProperties(e,t),e}(In),gr=function(){},WE={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};WE.ForwardComparator.get=function(){return w1};WE.BidirectionalComparator.get=function(){return Iv};WE.coordArrayType.get=function(){return new Array(0).fill(null)};gr.prototype.interfaces_=function(){return[]};gr.prototype.getClass=function(){return gr};gr.isRing=function(e){return!(e.length<4||!e[0].equals2D(e[e.length-1]))};gr.ptNotInList=function(e,t){for(var i=0;i<e.length;i++){var r=e[i];if(gr.indexOf(r,t)<0)return r}return null};gr.scroll=function(e,t){var i=gr.indexOf(t,e);if(i<0)return null;var r=new Array(e.length).fill(null);Ua.arraycopy(e,i,r,0,e.length-i),Ua.arraycopy(e,0,r,e.length-i,i),Ua.arraycopy(r,0,e,0,e.length)};gr.equals=function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];if(e===t)return!0;if(e===null||t===null||e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(!e[i].equals(t[i]))return!1;return!0}else if(arguments.length===3){var r=arguments[0],a=arguments[1],h=arguments[2];if(r===a)return!0;if(r===null||a===null||r.length!==a.length)return!1;for(var s=0;s<r.length;s++)if(h.compare(r[s],a[s])!==0)return!1;return!0}};gr.intersection=function(e,t){for(var i=new K1,r=0;r<e.length;r++)t.intersects(e[r])&&i.add(e[r],!0);return i.toCoordinateArray()};gr.hasRepeatedPoints=function(e){for(var t=1;t<e.length;t++)if(e[t-1].equals(e[t]))return!0;return!1};gr.removeRepeatedPoints=function(e){if(!gr.hasRepeatedPoints(e))return e;var t=new K1(e,!1);return t.toCoordinateArray()};gr.reverse=function(e){for(var t=e.length-1,i=Math.trunc(t/2),r=0;r<=i;r++){var a=e[r];e[r]=e[t-r],e[t-r]=a}};gr.removeNull=function(e){for(var t=0,i=0;i<e.length;i++)e[i]!==null&&t++;var r=new Array(t).fill(null);if(t===0)return r;for(var a=0,h=0;h<e.length;h++)e[h]!==null&&(r[a++]=e[h]);return r};gr.copyDeep=function(){if(arguments.length===1){for(var e=arguments[0],t=new Array(e.length).fill(null),i=0;i<e.length;i++)t[i]=new ht(e[i]);return t}else if(arguments.length===5)for(var r=arguments[0],a=arguments[1],h=arguments[2],s=arguments[3],p=arguments[4],x=0;x<p;x++)h[s+x]=new ht(r[a+x])};gr.isEqualReversed=function(e,t){for(var i=0;i<e.length;i++){var r=e[i],a=t[e.length-i-1];if(r.compareTo(a)!==0)return!1}return!0};gr.envelope=function(e){for(var t=new li,i=0;i<e.length;i++)t.expandToInclude(e[i]);return t};gr.toCoordinateArray=function(e){return e.toArray(gr.coordArrayType)};gr.atLeastNCoordinatesOrNothing=function(e,t){return t.length>=e?t:[]};gr.indexOf=function(e,t){for(var i=0;i<t.length;i++)if(e.equals(t[i]))return i;return-1};gr.increasingDirection=function(e){for(var t=0;t<Math.trunc(e.length/2);t++){var i=e.length-1-t,r=e[t].compareTo(e[i]);if(r!==0)return r}return 1};gr.compare=function(e,t){for(var i=0;i<e.length&&i<t.length;){var r=e[i].compareTo(t[i]);if(r!==0)return r;i++}return i<t.length?-1:i<e.length?1:0};gr.minCoordinate=function(e){for(var t=null,i=0;i<e.length;i++)(t===null||t.compareTo(e[i])>0)&&(t=e[i]);return t};gr.extract=function(e,t,i){t=Yu.clamp(t,0,e.length),i=Yu.clamp(i,-1,e.length);var r=i-t+1;i<0&&(r=0),t>=e.length&&(r=0),i<t&&(r=0);var a=new Array(r).fill(null);if(r===0)return a;for(var h=0,s=t;s<=i;s++)a[h++]=e[s];return a};Object.defineProperties(gr,WE);var w1=function(){};w1.prototype.compare=function(e,t){var i=e,r=t;return gr.compare(i,r)};w1.prototype.interfaces_=function(){return[yv]};w1.prototype.getClass=function(){return w1};var Iv=function(){};Iv.prototype.compare=function(e,t){var i=e,r=t;if(i.length<r.length)return-1;if(i.length>r.length)return 1;if(i.length===0)return 0;var a=gr.compare(i,r),h=gr.isEqualReversed(i,r);return h?0:a};Iv.prototype.OLDcompare=function(e,t){var i=e,r=t;if(i.length<r.length)return-1;if(i.length>r.length)return 1;if(i.length===0)return 0;for(var a=gr.increasingDirection(i),h=gr.increasingDirection(r),s=a>0?0:i.length-1,p=h>0?0:i.length-1,x=0;x<i.length;x++){var I=i[s].compareTo(r[p]);if(I!==0)return I;s+=a,p+=h}return 0};Iv.prototype.interfaces_=function(){return[yv]};Iv.prototype.getClass=function(){return Iv};var P_=function(){};P_.prototype.get=function(){};P_.prototype.put=function(){};P_.prototype.size=function(){};P_.prototype.values=function(){};P_.prototype.entrySet=function(){};var tB=function(n){function e(){n.apply(this,arguments)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e}(P_);function J1(n){this.message=n||""}J1.prototype=new Error;J1.prototype.name="OperationNotSupported";function XE(){}XE.prototype=new Yo;XE.prototype.contains=function(){};var _S=function(n){function e(){n.call(this),this.array_=[],arguments[0]instanceof Yo&&this.addAll(arguments[0])}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.contains=function(i){for(var r=this,a=0,h=this.array_.length;a<h;a++){var s=r.array_[a];if(s===i)return!0}return!1},e.prototype.add=function(i){return this.contains(i)?!1:(this.array_.push(i),!0)},e.prototype.addAll=function(i){for(var r=this,a=i.iterator();a.hasNext();)r.add(a.next());return!0},e.prototype.remove=function(i){throw new Error},e.prototype.size=function(){return this.array_.length},e.prototype.isEmpty=function(){return this.array_.length===0},e.prototype.toArray=function(){for(var i=this,r=[],a=0,h=this.array_.length;a<h;a++)r.push(i.array_[a]);return r},e.prototype.iterator=function(){return new nB(this)},e}(XE),nB=function(n){function e(t){n.call(this),this.hashSet_=t,this.position_=0}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new Wv;return this.hashSet_.array_[this.position_++]},e.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},e.prototype.remove=function(){throw new J1},e}(Hv),Zd=0,Nm=1;function $C(n){return n===null?Zd:n.color}function Is(n){return n===null?null:n.parent}function Hd(n,e){n!==null&&(n.color=e)}function aT(n){return n===null?null:n.left}function e2(n){return n===null?null:n.right}function cl(){this.root_=null,this.size_=0}cl.prototype=new tB;cl.prototype.get=function(n){for(var e=this.root_;e!==null;){var t=n.compareTo(e.key);if(t<0)e=e.left;else if(t>0)e=e.right;else return e.value}return null};cl.prototype.put=function(n,e){if(this.root_===null)return this.root_={key:n,value:e,left:null,right:null,parent:null,color:Zd,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var t=this.root_,i,r;do if(i=t,r=n.compareTo(t.key),r<0)t=t.left;else if(r>0)t=t.right;else{var a=t.value;return t.value=e,a}while(t!==null);var h={key:n,left:null,right:null,value:e,parent:i,color:Zd,getValue:function(){return this.value},getKey:function(){return this.key}};return r<0?i.left=h:i.right=h,this.fixAfterInsertion(h),this.size_++,null};cl.prototype.fixAfterInsertion=function(n){var e=this;for(n.color=Nm;n!=null&&n!==this.root_&&n.parent.color===Nm;)if(Is(n)===aT(Is(Is(n)))){var t=e2(Is(Is(n)));$C(t)===Nm?(Hd(Is(n),Zd),Hd(t,Zd),Hd(Is(Is(n)),Nm),n=Is(Is(n))):(n===e2(Is(n))&&(n=Is(n),e.rotateLeft(n)),Hd(Is(n),Zd),Hd(Is(Is(n)),Nm),e.rotateRight(Is(Is(n))))}else{var i=aT(Is(Is(n)));$C(i)===Nm?(Hd(Is(n),Zd),Hd(i,Zd),Hd(Is(Is(n)),Nm),n=Is(Is(n))):(n===aT(Is(n))&&(n=Is(n),e.rotateRight(n)),Hd(Is(n),Zd),Hd(Is(Is(n)),Nm),e.rotateLeft(Is(Is(n))))}this.root_.color=Zd};cl.prototype.values=function(){var n=new In,e=this.getFirstEntry();if(e!==null)for(n.add(e.value);(e=cl.successor(e))!==null;)n.add(e.value);return n};cl.prototype.entrySet=function(){var n=new _S,e=this.getFirstEntry();if(e!==null)for(n.add(e);(e=cl.successor(e))!==null;)n.add(e);return n};cl.prototype.rotateLeft=function(n){if(n!=null){var e=n.right;n.right=e.left,e.left!=null&&(e.left.parent=n),e.parent=n.parent,n.parent===null?this.root_=e:n.parent.left===n?n.parent.left=e:n.parent.right=e,e.left=n,n.parent=e}};cl.prototype.rotateRight=function(n){if(n!=null){var e=n.left;n.left=e.right,e.right!=null&&(e.right.parent=n),e.parent=n.parent,n.parent===null?this.root_=e:n.parent.right===n?n.parent.right=e:n.parent.left=e,e.right=n,n.parent=e}};cl.prototype.getFirstEntry=function(){var n=this.root_;if(n!=null)for(;n.left!=null;)n=n.left;return n};cl.successor=function(n){if(n===null)return null;if(n.right!==null){for(var e=n.right;e.left!==null;)e=e.left;return e}else{for(var t=n.parent,i=n;t!==null&&i===t.right;)i=t,t=t.parent;return t}};cl.prototype.size=function(){return this.size_};var I1=function(){};I1.prototype.interfaces_=function(){return[]};I1.prototype.getClass=function(){return I1};function tL(){}tL.prototype=new XE;function pf(){this.array_=[],arguments[0]instanceof Yo&&this.addAll(arguments[0])}pf.prototype=new tL;pf.prototype.contains=function(n){for(var e=this,t=0,i=this.array_.length;t<i;t++){var r=e.array_[t];if(r.compareTo(n)===0)return!0}return!1};pf.prototype.add=function(n){var e=this;if(this.contains(n))return!1;for(var t=0,i=this.array_.length;t<i;t++){var r=e.array_[t];if(r.compareTo(n)===1)return e.array_.splice(t,0,n),!0}return this.array_.push(n),!0};pf.prototype.addAll=function(n){for(var e=this,t=n.iterator();t.hasNext();)e.add(t.next());return!0};pf.prototype.remove=function(n){throw new J1};pf.prototype.size=function(){return this.array_.length};pf.prototype.isEmpty=function(){return this.array_.length===0};pf.prototype.toArray=function(){for(var n=this,e=[],t=0,i=this.array_.length;t<i;t++)e.push(n.array_[t]);return e};pf.prototype.iterator=function(){return new ZE(this)};var ZE=function(n){this.treeSet_=n,this.position_=0};ZE.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new Wv;return this.treeSet_.array_[this.position_++]};ZE.prototype.hasNext=function(){return this.position_<this.treeSet_.size()};ZE.prototype.remove=function(){throw new J1};var qm=function(){};qm.sort=function(){var e=arguments[0],t,i,r,a;if(arguments.length===1)a=function(s,p){return s.compareTo(p)},e.sort(a);else if(arguments.length===2)r=arguments[1],a=function(s,p){return r.compare(s,p)},e.sort(a);else if(arguments.length===3){i=e.slice(arguments[1],arguments[2]),i.sort();var h=e.slice(0,arguments[1]).concat(i,e.slice(arguments[2],e.length));for(e.splice(0,e.length),t=0;t<h.length;t++)e.push(h[t])}else if(arguments.length===4)for(i=e.slice(arguments[1],arguments[2]),r=arguments[3],a=function(s,p){return r.compare(s,p)},i.sort(a),h=e.slice(0,arguments[1]).concat(i,e.slice(arguments[2],e.length)),e.splice(0,e.length),t=0;t<h.length;t++)e.push(h[t])};qm.asList=function(e){for(var t=new In,i=0,r=e.length;i<r;i++)t.add(e[i]);return t};var Hr=function(){},Th={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};Th.P.get=function(){return 0};Th.L.get=function(){return 1};Th.A.get=function(){return 2};Th.FALSE.get=function(){return-1};Th.TRUE.get=function(){return-2};Th.DONTCARE.get=function(){return-3};Th.SYM_FALSE.get=function(){return"F"};Th.SYM_TRUE.get=function(){return"T"};Th.SYM_DONTCARE.get=function(){return"*"};Th.SYM_P.get=function(){return"0"};Th.SYM_L.get=function(){return"1"};Th.SYM_A.get=function(){return"2"};Hr.prototype.interfaces_=function(){return[]};Hr.prototype.getClass=function(){return Hr};Hr.toDimensionSymbol=function(e){switch(e){case Hr.FALSE:return Hr.SYM_FALSE;case Hr.TRUE:return Hr.SYM_TRUE;case Hr.DONTCARE:return Hr.SYM_DONTCARE;case Hr.P:return Hr.SYM_P;case Hr.L:return Hr.SYM_L;case Hr.A:return Hr.SYM_A}throw new Xs("Unknown dimension value: "+e)};Hr.toDimensionValue=function(e){switch(E1.toUpperCase(e)){case Hr.SYM_FALSE:return Hr.FALSE;case Hr.SYM_TRUE:return Hr.TRUE;case Hr.SYM_DONTCARE:return Hr.DONTCARE;case Hr.SYM_P:return Hr.P;case Hr.SYM_L:return Hr.L;case Hr.SYM_A:return Hr.A}throw new Xs("Unknown dimension symbol: "+e)};Object.defineProperties(Hr,Th);var mf=function(){};mf.prototype.filter=function(e){};mf.prototype.interfaces_=function(){return[]};mf.prototype.getClass=function(){return mf};var gh=function(){};gh.prototype.filter=function(e,t){};gh.prototype.isDone=function(){};gh.prototype.isGeometryChanged=function(){};gh.prototype.interfaces_=function(){return[]};gh.prototype.getClass=function(){return gh};var Sl=function(n){function e(i,r){if(n.call(this,r),this._geometries=i||[],n.hasNullElements(this._geometries))throw new Xs("geometries must not contain null elements")}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){for(var r=this,a=new li,h=0;h<this._geometries.length;h++)a.expandToInclude(r._geometries[h].getEnvelopeInternal());return a},e.prototype.getGeometryN=function(r){return this._geometries[r]},e.prototype.getSortIndex=function(){return n.SORTINDEX_GEOMETRYCOLLECTION},e.prototype.getCoordinates=function(){for(var r=this,a=new Array(this.getNumPoints()).fill(null),h=-1,s=0;s<this._geometries.length;s++)for(var p=r._geometries[s].getCoordinates(),x=0;x<p.length;x++)h++,a[h]=p[x];return a},e.prototype.getArea=function(){for(var r=this,a=0,h=0;h<this._geometries.length;h++)a+=r._geometries[h].getArea();return a},e.prototype.equalsExact=function(){var r=this;if(arguments.length===2){var a=arguments[0],h=arguments[1];if(!this.isEquivalentClass(a))return!1;var s=a;if(this._geometries.length!==s._geometries.length)return!1;for(var p=0;p<this._geometries.length;p++)if(!r._geometries[p].equalsExact(s._geometries[p],h))return!1;return!0}else return n.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var r=this,a=0;a<this._geometries.length;a++)r._geometries[a].normalize();qm.sort(this._geometries)},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},e.prototype.getBoundaryDimension=function(){for(var r=this,a=Hr.FALSE,h=0;h<this._geometries.length;h++)a=Math.max(a,r._geometries[h].getBoundaryDimension());return a},e.prototype.getDimension=function(){for(var r=this,a=Hr.FALSE,h=0;h<this._geometries.length;h++)a=Math.max(a,r._geometries[h].getDimension());return a},e.prototype.getLength=function(){for(var r=this,a=0,h=0;h<this._geometries.length;h++)a+=r._geometries[h].getLength();return a},e.prototype.getNumPoints=function(){for(var r=this,a=0,h=0;h<this._geometries.length;h++)a+=r._geometries[h].getNumPoints();return a},e.prototype.getNumGeometries=function(){return this._geometries.length},e.prototype.reverse=function(){for(var r=this,a=this._geometries.length,h=new Array(a).fill(null),s=0;s<this._geometries.length;s++)h[s]=r._geometries[s].reverse();return this.getFactory().createGeometryCollection(h)},e.prototype.compareToSameClass=function(){var r=this;if(arguments.length===1){var a=arguments[0],h=new pf(qm.asList(this._geometries)),s=new pf(qm.asList(a._geometries));return this.compare(h,s)}else if(arguments.length===2){for(var p=arguments[0],x=arguments[1],I=p,C=this.getNumGeometries(),M=I.getNumGeometries(),O=0;O<C&&O<M;){var k=r.getGeometryN(O),z=I.getGeometryN(O),G=k.compareToSameClass(z,x);if(G!==0)return G;O++}return O<C?1:O<M?-1:0}},e.prototype.apply=function(){var r=this;if(Si(arguments[0],sd))for(var a=arguments[0],h=0;h<this._geometries.length;h++)r._geometries[h].apply(a);else if(Si(arguments[0],gh)){var s=arguments[0];if(this._geometries.length===0)return null;for(var p=0;p<this._geometries.length&&(r._geometries[p].apply(s),!s.isDone());p++);s.isGeometryChanged()&&this.geometryChanged()}else if(Si(arguments[0],mf)){var x=arguments[0];x.filter(this);for(var I=0;I<this._geometries.length;I++)r._geometries[I].apply(x)}else if(Si(arguments[0],ip)){var C=arguments[0];C.filter(this);for(var M=0;M<this._geometries.length;M++)r._geometries[M].apply(C)}},e.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),Zi.shouldNeverReachHere(),null},e.prototype.clone=function(){var r=this,a=n.prototype.clone.call(this);a._geometries=new Array(this._geometries.length).fill(null);for(var h=0;h<this._geometries.length;h++)a._geometries[h]=r._geometries[h].clone();return a},e.prototype.getGeometryType=function(){return"GeometryCollection"},e.prototype.copy=function(){for(var r=this,a=new Array(this._geometries.length).fill(null),h=0;h<a.length;h++)a[h]=r._geometries[h].copy();return new e(a,this._factory)},e.prototype.isEmpty=function(){for(var r=this,a=0;a<this._geometries.length;a++)if(!r._geometries[a].isEmpty())return!1;return!0},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},t.serialVersionUID.get=function(){return-5694727726395021e3},Object.defineProperties(e,t),e}(bi),Qm=function(n){function e(){n.apply(this,arguments)}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return bi.SORTINDEX_MULTILINESTRING},e.prototype.equalsExact=function(){if(arguments.length===2){var r=arguments[0],a=arguments[1];return this.isEquivalentClass(r)?n.prototype.equalsExact.call(this,r,a):!1}else return n.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?Hr.FALSE:0},e.prototype.isClosed=function(){var r=this;if(this.isEmpty())return!1;for(var a=0;a<this._geometries.length;a++)if(!r._geometries[a].isClosed())return!1;return!0},e.prototype.getDimension=function(){return 1},e.prototype.reverse=function(){for(var r=this,a=this._geometries.length,h=new Array(a).fill(null),s=0;s<this._geometries.length;s++)h[a-1-s]=r._geometries[s].reverse();return this.getFactory().createMultiLineString(h)},e.prototype.getBoundary=function(){return new Pc(this).getBoundary()},e.prototype.getGeometryType=function(){return"MultiLineString"},e.prototype.copy=function(){for(var r=this,a=new Array(this._geometries.length).fill(null),h=0;h<a.length;h++)a[h]=r._geometries[h].copy();return new e(a,this._factory)},e.prototype.interfaces_=function(){return[I1]},e.prototype.getClass=function(){return e},t.serialVersionUID.get=function(){return 8166665132445434e3},Object.defineProperties(e,t),e}(Sl),Pc=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,arguments.length===1){var e=arguments[0],t=Nc.MOD2_BOUNDARY_RULE;this._geom=e,this._geomFact=e.getFactory(),this._bnRule=t}else if(arguments.length===2){var i=arguments[0],r=arguments[1];this._geom=i,this._geomFact=i.getFactory(),this._bnRule=r}};Pc.prototype.boundaryMultiLineString=function(e){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var t=this.computeBoundaryCoordinates(e);return t.length===1?this._geomFact.createPoint(t[0]):this._geomFact.createMultiPointFromCoords(t)};Pc.prototype.getBoundary=function(){return this._geom instanceof fo?this.boundaryLineString(this._geom):this._geom instanceof Qm?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()};Pc.prototype.boundaryLineString=function(e){if(this._geom.isEmpty())return this.getEmptyMultiPoint();if(e.isClosed()){var t=this._bnRule.isInBoundary(2);return t?e.getStartPoint():this._geomFact.createMultiPoint()}return this._geomFact.createMultiPoint([e.getStartPoint(),e.getEndPoint()])};Pc.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()};Pc.prototype.computeBoundaryCoordinates=function(e){var t=this,i=new In;this._endpointMap=new cl;for(var r=0;r<e.getNumGeometries();r++){var a=e.getGeometryN(r);a.getNumPoints()!==0&&(t.addEndpoint(a.getCoordinateN(0)),t.addEndpoint(a.getCoordinateN(a.getNumPoints()-1)))}for(var h=this._endpointMap.entrySet().iterator();h.hasNext();){var s=h.next(),p=s.getValue(),x=p.count;t._bnRule.isInBoundary(x)&&i.add(s.getKey())}return gr.toCoordinateArray(i)};Pc.prototype.addEndpoint=function(e){var t=this._endpointMap.get(e);t===null&&(t=new wE,this._endpointMap.put(e,t)),t.count++};Pc.prototype.interfaces_=function(){return[]};Pc.prototype.getClass=function(){return Pc};Pc.getBoundary=function(){if(arguments.length===1){var e=arguments[0],t=new Pc(e);return t.getBoundary()}else if(arguments.length===2){var i=arguments[0],r=arguments[1],a=new Pc(i,r);return a.getBoundary()}};var wE=function(){this.count=null};wE.prototype.interfaces_=function(){return[]};wE.prototype.getClass=function(){return wE};function iB(){}function rB(){}var sB=function(){};function oB(){}function aB(){}function lB(){}var Rc=function(){},yS={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Rc.prototype.interfaces_=function(){return[]};Rc.prototype.getClass=function(){return Rc};Rc.chars=function(e,t){for(var i=new Array(t).fill(null),r=0;r<t;r++)i[r]=e;return String(i)};Rc.getStackTrace=function(){if(arguments.length===1){var e=arguments[0],t=new oB,i=new iB;return e.printStackTrace(i),t.toString()}else if(arguments.length===2){var r=arguments[0],a=arguments[1],h="";new rB(Rc.getStackTrace(r));for(var s=new lB,p=0;p<a;p++)try{h+=s.readLine()+Rc.NEWLINE}catch(x){if(x instanceof aB)Zi.shouldNeverReachHere();else throw x}finally{}return h}};Rc.split=function(e,t){for(var i=t.length,r=new In,a=""+e,h=a.indexOf(t);h>=0;){var s=a.substring(0,h);r.add(s),a=a.substring(h+i),h=a.indexOf(t)}a.length>0&&r.add(a);for(var p=new Array(r.size()).fill(null),x=0;x<p.length;x++)p[x]=r.get(x);return p};Rc.toString=function(){if(arguments.length===1){var e=arguments[0];return Rc.SIMPLE_ORDINATE_FORMAT.format(e)}};Rc.spaces=function(e){return Rc.chars(" ",e)};yS.NEWLINE.get=function(){return Ua.getProperty("line.separator")};yS.SIMPLE_ORDINATE_FORMAT.get=function(){return new sB};Object.defineProperties(Rc,yS);var To=function(){};To.prototype.interfaces_=function(){return[]};To.prototype.getClass=function(){return To};To.copyCoord=function(e,t,i,r){for(var a=Math.min(e.getDimension(),i.getDimension()),h=0;h<a;h++)i.setOrdinate(r,h,e.getOrdinate(t,h))};To.isRing=function(e){var t=e.size();return t===0?!0:t<=3?!1:e.getOrdinate(0,Or.X)===e.getOrdinate(t-1,Or.X)&&e.getOrdinate(0,Or.Y)===e.getOrdinate(t-1,Or.Y)};To.isEqual=function(e,t){var i=e.size(),r=t.size();if(i!==r)return!1;for(var a=Math.min(e.getDimension(),t.getDimension()),h=0;h<i;h++)for(var s=0;s<a;s++){var p=e.getOrdinate(h,s),x=t.getOrdinate(h,s);if(e.getOrdinate(h,s)!==t.getOrdinate(h,s)&&!(zi.isNaN(p)&&zi.isNaN(x)))return!1}return!0};To.extend=function(e,t,i){var r=e.create(i,t.getDimension()),a=t.size();if(To.copy(t,0,r,0,a),a>0)for(var h=a;h<i;h++)To.copy(t,a-1,r,h,1);return r};To.reverse=function(e){for(var t=e.size()-1,i=Math.trunc(t/2),r=0;r<=i;r++)To.swap(e,r,t-r)};To.swap=function(e,t,i){if(t===i)return null;for(var r=0;r<e.getDimension();r++){var a=e.getOrdinate(t,r);e.setOrdinate(t,r,e.getOrdinate(i,r)),e.setOrdinate(i,r,a)}};To.copy=function(e,t,i,r,a){for(var h=0;h<a;h++)To.copyCoord(e,t+h,i,r+h)};To.toString=function(){if(arguments.length===1){var e=arguments[0],t=e.size();if(t===0)return"()";var i=e.getDimension(),r=new wf;r.append("(");for(var a=0;a<t;a++){a>0&&r.append(" ");for(var h=0;h<i;h++)h>0&&r.append(","),r.append(Rc.toString(e.getOrdinate(a,h)))}return r.append(")"),r.toString()}};To.ensureValidRing=function(e,t){var i=t.size();if(i===0)return t;if(i<=3)return To.createClosedRing(e,t,4);var r=t.getOrdinate(0,Or.X)===t.getOrdinate(i-1,Or.X)&&t.getOrdinate(0,Or.Y)===t.getOrdinate(i-1,Or.Y);return r?t:To.createClosedRing(e,t,i+1)};To.createClosedRing=function(e,t,i){var r=e.create(i,t.getDimension()),a=t.size();To.copy(t,0,r,0,a);for(var h=a;h<i;h++)To.copy(t,0,r,h,1);return r};var fo=function(n){function e(i,r){n.call(this,r),this._points=null,this.init(i)}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new li:this._points.expandEnvelope(new li)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return n.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){var r=this;if(arguments.length===2){var a=arguments[0],h=arguments[1];if(!this.isEquivalentClass(a))return!1;var s=a;if(this._points.size()!==s._points.size())return!1;for(var p=0;p<this._points.size();p++)if(!r.equal(r._points.getCoordinate(p),s._points.getCoordinate(p),h))return!1;return!0}else return n.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var r=this,a=0;a<Math.trunc(this._points.size()/2);a++){var h=r._points.size()-1-a;if(!r._points.getCoordinate(a).equals(r._points.getCoordinate(h)))return r._points.getCoordinate(a).compareTo(r._points.getCoordinate(h))>0&&To.reverse(r._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?Hr.FALSE:0},e.prototype.isClosed=function(){return this.isEmpty()?!1:this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return Nn.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var r=this._points.copy();To.reverse(r);var a=this.getFactory().createLineString(r);return a},e.prototype.compareToSameClass=function(){var r=this;if(arguments.length===1){for(var a=arguments[0],h=a,s=0,p=0;s<this._points.size()&&p<h._points.size();){var x=r._points.getCoordinate(s).compareTo(h._points.getCoordinate(p));if(x!==0)return x;s++,p++}return s<this._points.size()?1:p<h._points.size()?-1:0}else if(arguments.length===2){var I=arguments[0],C=arguments[1],M=I;return C.compare(this._points,M._points)}},e.prototype.apply=function(){var r=this;if(Si(arguments[0],sd))for(var a=arguments[0],h=0;h<this._points.size();h++)a.filter(r._points.getCoordinate(h));else if(Si(arguments[0],gh)){var s=arguments[0];if(this._points.size()===0)return null;for(var p=0;p<this._points.size()&&(s.filter(r._points,p),!s.isDone());p++);s.isGeometryChanged()&&this.geometryChanged()}else if(Si(arguments[0],mf)){var x=arguments[0];x.filter(this)}else if(Si(arguments[0],ip)){var I=arguments[0];I.filter(this)}},e.prototype.getBoundary=function(){return new Pc(this).getBoundary()},e.prototype.isEquivalentClass=function(r){return r instanceof e},e.prototype.clone=function(){var r=n.prototype.clone.call(this);return r._points=this._points.clone(),r},e.prototype.getCoordinateN=function(r){return this._points.getCoordinate(r)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return this._points.size()===0},e.prototype.init=function(r){if(r===null&&(r=this.getFactory().getCoordinateSequenceFactory().create([])),r.size()===1)throw new Xs("Invalid number of points in LineString (found "+r.size()+" - must be 0 or >= 2)");this._points=r},e.prototype.isCoordinate=function(r){for(var a=this,h=0;h<this._points.size();h++)if(a._points.getCoordinate(h).equals(r))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(r){return this.getFactory().createPoint(this._points.getCoordinate(r))},e.prototype.interfaces_=function(){return[I1]},e.prototype.getClass=function(){return e},t.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,t),e}(bi),T1=function(){};T1.prototype.interfaces_=function(){return[]};T1.prototype.getClass=function(){return T1};var yu=function(n){function e(i,r){n.call(this,r),this._coordinates=i||null,this.init(this._coordinates)}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new li;var r=new li;return r.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),r},e.prototype.getSortIndex=function(){return n.SORTINDEX_POINT},e.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},e.prototype.equalsExact=function(){if(arguments.length===2){var r=arguments[0],a=arguments[1];return this.isEquivalentClass(r)?this.isEmpty()&&r.isEmpty()?!0:this.isEmpty()!==r.isEmpty()?!1:this.equal(r.getCoordinate(),this.getCoordinate(),a):!1}else return n.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){},e.prototype.getCoordinate=function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null},e.prototype.getBoundaryDimension=function(){return Hr.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getNumPoints=function(){return this.isEmpty()?0:1},e.prototype.reverse=function(){return this.copy()},e.prototype.getX=function(){if(this.getCoordinate()===null)throw new Error("getX called on empty Point");return this.getCoordinate().x},e.prototype.compareToSameClass=function(){if(arguments.length===1){var r=arguments[0],a=r;return this.getCoordinate().compareTo(a.getCoordinate())}else if(arguments.length===2){var h=arguments[0],s=arguments[1],p=h;return s.compare(this._coordinates,p._coordinates)}},e.prototype.apply=function(){if(Si(arguments[0],sd)){var r=arguments[0];if(this.isEmpty())return null;r.filter(this.getCoordinate())}else if(Si(arguments[0],gh)){var a=arguments[0];if(this.isEmpty())return null;a.filter(this._coordinates,0),a.isGeometryChanged()&&this.geometryChanged()}else if(Si(arguments[0],mf)){var h=arguments[0];h.filter(this)}else if(Si(arguments[0],ip)){var s=arguments[0];s.filter(this)}},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.clone=function(){var r=n.prototype.clone.call(this);return r._coordinates=this._coordinates.clone(),r},e.prototype.getGeometryType=function(){return"Point"},e.prototype.copy=function(){return new e(this._coordinates.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._coordinates},e.prototype.getY=function(){if(this.getCoordinate()===null)throw new Error("getY called on empty Point");return this.getCoordinate().y},e.prototype.isEmpty=function(){return this._coordinates.size()===0},e.prototype.init=function(r){r===null&&(r=this.getFactory().getCoordinateSequenceFactory().create([])),Zi.isTrue(r.size()<=1),this._coordinates=r},e.prototype.isSimple=function(){return!0},e.prototype.interfaces_=function(){return[T1]},e.prototype.getClass=function(){return e},t.serialVersionUID.get=function(){return 4902022702746615e3},Object.defineProperties(e,t),e}(bi),Jp=function(){};Jp.prototype.interfaces_=function(){return[]};Jp.prototype.getClass=function(){return Jp};var ea=function(n){function e(i,r,a){if(n.call(this,a),this._shell=null,this._holes=null,i===null&&(i=this.getFactory().createLinearRing()),r===null&&(r=[]),n.hasNullElements(r))throw new Xs("holes must not contain null elements");if(i.isEmpty()&&n.hasNonEmptyElements(r))throw new Xs("shell is empty but holes are not");this._shell=i,this._holes=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},e.prototype.getSortIndex=function(){return n.SORTINDEX_POLYGON},e.prototype.getCoordinates=function(){var r=this;if(this.isEmpty())return[];for(var a=new Array(this.getNumPoints()).fill(null),h=-1,s=this._shell.getCoordinates(),p=0;p<s.length;p++)h++,a[h]=s[p];for(var x=0;x<this._holes.length;x++)for(var I=r._holes[x].getCoordinates(),C=0;C<I.length;C++)h++,a[h]=I[C];return a},e.prototype.getArea=function(){var r=this,a=0;a+=Math.abs(Nn.signedArea(this._shell.getCoordinateSequence()));for(var h=0;h<this._holes.length;h++)a-=Math.abs(Nn.signedArea(r._holes[h].getCoordinateSequence()));return a},e.prototype.isRectangle=function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var r=this._shell.getCoordinateSequence(),a=this.getEnvelopeInternal(),h=0;h<5;h++){var s=r.getX(h);if(!(s===a.getMinX()||s===a.getMaxX()))return!1;var p=r.getY(h);if(!(p===a.getMinY()||p===a.getMaxY()))return!1}for(var x=r.getX(0),I=r.getY(0),C=1;C<=4;C++){var M=r.getX(C),O=r.getY(C),k=M!==x,z=O!==I;if(k===z)return!1;x=M,I=O}return!0},e.prototype.equalsExact=function(){var r=this;if(arguments.length===2){var a=arguments[0],h=arguments[1];if(!this.isEquivalentClass(a))return!1;var s=a,p=this._shell,x=s._shell;if(!p.equalsExact(x,h)||this._holes.length!==s._holes.length)return!1;for(var I=0;I<this._holes.length;I++)if(!r._holes[I].equalsExact(s._holes[I],h))return!1;return!0}else return n.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){var r=this;if(arguments.length===0){this.normalize(this._shell,!0);for(var a=0;a<this._holes.length;a++)r.normalize(r._holes[a],!1);qm.sort(this._holes)}else if(arguments.length===2){var h=arguments[0],s=arguments[1];if(h.isEmpty())return null;var p=new Array(h.getCoordinates().length-1).fill(null);Ua.arraycopy(h.getCoordinates(),0,p,0,p.length);var x=gr.minCoordinate(h.getCoordinates());gr.scroll(p,x),Ua.arraycopy(p,0,h.getCoordinates(),0,p.length),h.getCoordinates()[p.length]=p[0],Nn.isCCW(h.getCoordinates())===s&&gr.reverse(h.getCoordinates())}},e.prototype.getCoordinate=function(){return this._shell.getCoordinate()},e.prototype.getNumInteriorRing=function(){return this._holes.length},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.getLength=function(){var r=this,a=0;a+=this._shell.getLength();for(var h=0;h<this._holes.length;h++)a+=r._holes[h].getLength();return a},e.prototype.getNumPoints=function(){for(var r=this,a=this._shell.getNumPoints(),h=0;h<this._holes.length;h++)a+=r._holes[h].getNumPoints();return a},e.prototype.reverse=function(){var r=this,a=this.copy();a._shell=this._shell.copy().reverse(),a._holes=new Array(this._holes.length).fill(null);for(var h=0;h<this._holes.length;h++)a._holes[h]=r._holes[h].copy().reverse();return a},e.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},e.prototype.compareToSameClass=function(){var r=this;if(arguments.length===1){var a=arguments[0],h=this._shell,s=a._shell;return h.compareToSameClass(s)}else if(arguments.length===2){var p=arguments[0],x=arguments[1],I=p,C=this._shell,M=I._shell,O=C.compareToSameClass(M,x);if(O!==0)return O;for(var k=this.getNumInteriorRing(),z=I.getNumInteriorRing(),G=0;G<k&&G<z;){var q=r.getInteriorRingN(G),Z=I.getInteriorRingN(G),K=q.compareToSameClass(Z,x);if(K!==0)return K;G++}return G<k?1:G<z?-1:0}},e.prototype.apply=function(r){var a=this;if(Si(r,sd)){this._shell.apply(r);for(var h=0;h<this._holes.length;h++)a._holes[h].apply(r)}else if(Si(r,gh)){if(this._shell.apply(r),!r.isDone())for(var s=0;s<this._holes.length&&(a._holes[s].apply(r),!r.isDone());s++);r.isGeometryChanged()&&this.geometryChanged()}else if(Si(r,mf))r.filter(this);else if(Si(r,ip)){r.filter(this),this._shell.apply(r);for(var p=0;p<this._holes.length;p++)a._holes[p].apply(r)}},e.prototype.getBoundary=function(){var r=this;if(this.isEmpty())return this.getFactory().createMultiLineString();var a=new Array(this._holes.length+1).fill(null);a[0]=this._shell;for(var h=0;h<this._holes.length;h++)a[h+1]=r._holes[h];return a.length<=1?this.getFactory().createLinearRing(a[0].getCoordinateSequence()):this.getFactory().createMultiLineString(a)},e.prototype.clone=function(){var r=this,a=n.prototype.clone.call(this);a._shell=this._shell.clone(),a._holes=new Array(this._holes.length).fill(null);for(var h=0;h<this._holes.length;h++)a._holes[h]=r._holes[h].clone();return a},e.prototype.getGeometryType=function(){return"Polygon"},e.prototype.copy=function(){for(var r=this,a=this._shell.copy(),h=new Array(this._holes.length).fill(null),s=0;s<h.length;s++)h[s]=r._holes[s].copy();return new e(a,h,this._factory)},e.prototype.getExteriorRing=function(){return this._shell},e.prototype.isEmpty=function(){return this._shell.isEmpty()},e.prototype.getInteriorRingN=function(r){return this._holes[r]},e.prototype.interfaces_=function(){return[Jp]},e.prototype.getClass=function(){return e},t.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(e,t),e}(bi),Tv=function(n){function e(){n.apply(this,arguments)}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return bi.SORTINDEX_MULTIPOINT},e.prototype.isValid=function(){return!0},e.prototype.equalsExact=function(){if(arguments.length===2){var r=arguments[0],a=arguments[1];return this.isEquivalentClass(r)?n.prototype.equalsExact.call(this,r,a):!1}else return n.prototype.equalsExact.apply(this,arguments)},e.prototype.getCoordinate=function(){if(arguments.length===1){var r=arguments[0];return this._geometries[r].getCoordinate()}else return n.prototype.getCoordinate.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return Hr.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.getGeometryType=function(){return"MultiPoint"},e.prototype.copy=function(){for(var r=this,a=new Array(this._geometries.length).fill(null),h=0;h<a.length;h++)a[h]=r._geometries[h].copy();return new e(a,this._factory)},e.prototype.interfaces_=function(){return[T1]},e.prototype.getClass=function(){return e},t.serialVersionUID.get=function(){return-8048474874175356e3},Object.defineProperties(e,t),e}(Sl),od=function(n){function e(i,r){i instanceof ht&&r instanceof mr&&(i=r.getCoordinateSequenceFactory().create(i)),n.call(this,i,r),this.validateConstruction()}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return bi.SORTINDEX_LINEARRING},e.prototype.getBoundaryDimension=function(){return Hr.FALSE},e.prototype.isClosed=function(){return this.isEmpty()?!0:n.prototype.isClosed.call(this)},e.prototype.reverse=function(){var r=this._points.copy();To.reverse(r);var a=this.getFactory().createLinearRing(r);return a},e.prototype.validateConstruction=function(){if(!this.isEmpty()&&!n.prototype.isClosed.call(this))throw new Xs("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new Xs("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},e.prototype.getGeometryType=function(){return"LinearRing"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},t.MINIMUM_VALID_SIZE.get=function(){return 4},t.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(e,t),e}(fo),td=function(n){function e(){n.apply(this,arguments)}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return bi.SORTINDEX_MULTIPOLYGON},e.prototype.equalsExact=function(){if(arguments.length===2){var r=arguments[0],a=arguments[1];return this.isEquivalentClass(r)?n.prototype.equalsExact.call(this,r,a):!1}else return n.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.reverse=function(){for(var r=this,a=this._geometries.length,h=new Array(a).fill(null),s=0;s<this._geometries.length;s++)h[s]=r._geometries[s].reverse();return this.getFactory().createMultiPolygon(h)},e.prototype.getBoundary=function(){var r=this;if(this.isEmpty())return this.getFactory().createMultiLineString();for(var a=new In,h=0;h<this._geometries.length;h++)for(var s=r._geometries[h],p=s.getBoundary(),x=0;x<p.getNumGeometries();x++)a.add(p.getGeometryN(x));var I=new Array(a.size()).fill(null);return this.getFactory().createMultiLineString(a.toArray(I))},e.prototype.getGeometryType=function(){return"MultiPolygon"},e.prototype.copy=function(){for(var r=this,a=new Array(this._geometries.length).fill(null),h=0;h<a.length;h++)a[h]=r._geometries[h].copy();return new e(a,this._factory)},e.prototype.interfaces_=function(){return[Jp]},e.prototype.getClass=function(){return e},t.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(e,t),e}(Sl),kc=function(e){this._factory=e||null,this._isUserDataCopied=!1},YE={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};kc.prototype.setCopyUserData=function(e){this._isUserDataCopied=e};kc.prototype.edit=function(e,t){if(e===null)return null;var i=this.editInternal(e,t);return this._isUserDataCopied&&i.setUserData(e.getUserData()),i};kc.prototype.editInternal=function(e,t){return this._factory===null&&(this._factory=e.getFactory()),e instanceof Sl?this.editGeometryCollection(e,t):e instanceof ea?this.editPolygon(e,t):e instanceof yu?t.edit(e,this._factory):e instanceof fo?t.edit(e,this._factory):(Zi.shouldNeverReachHere("Unsupported Geometry class: "+e.getClass().getName()),null)};kc.prototype.editGeometryCollection=function(e,t){for(var i=this,r=t.edit(e,this._factory),a=new In,h=0;h<r.getNumGeometries();h++){var s=i.edit(r.getGeometryN(h),t);s===null||s.isEmpty()||a.add(s)}return r.getClass()===Tv?this._factory.createMultiPoint(a.toArray([])):r.getClass()===Qm?this._factory.createMultiLineString(a.toArray([])):r.getClass()===td?this._factory.createMultiPolygon(a.toArray([])):this._factory.createGeometryCollection(a.toArray([]))};kc.prototype.editPolygon=function(e,t){var i=this,r=t.edit(e,this._factory);if(r===null&&(r=this._factory.createPolygon(null)),r.isEmpty())return r;var a=this.edit(r.getExteriorRing(),t);if(a===null||a.isEmpty())return this._factory.createPolygon();for(var h=new In,s=0;s<r.getNumInteriorRing();s++){var p=i.edit(r.getInteriorRingN(s),t);p===null||p.isEmpty()||h.add(p)}return this._factory.createPolygon(a,h.toArray([]))};kc.prototype.interfaces_=function(){return[]};kc.prototype.getClass=function(){return kc};kc.GeometryEditorOperation=function(){};YE.NoOpGeometryOperation.get=function(){return S1};YE.CoordinateOperation.get=function(){return C1};YE.CoordinateSequenceOperation.get=function(){return A1};Object.defineProperties(kc,YE);var S1=function(){};S1.prototype.edit=function(e,t){return e};S1.prototype.interfaces_=function(){return[kc.GeometryEditorOperation]};S1.prototype.getClass=function(){return S1};var C1=function(){};C1.prototype.edit=function(e,t){var i=this.editCoordinates(e.getCoordinates(),e);return i===null?e:e instanceof od?t.createLinearRing(i):e instanceof fo?t.createLineString(i):e instanceof yu?i.length>0?t.createPoint(i[0]):t.createPoint():e};C1.prototype.interfaces_=function(){return[kc.GeometryEditorOperation]};C1.prototype.getClass=function(){return C1};var A1=function(){};A1.prototype.edit=function(e,t){return e instanceof od?t.createLinearRing(this.edit(e.getCoordinateSequence(),e)):e instanceof fo?t.createLineString(this.edit(e.getCoordinateSequence(),e)):e instanceof yu?t.createPoint(this.edit(e.getCoordinateSequence(),e)):e};A1.prototype.interfaces_=function(){return[kc.GeometryEditorOperation]};A1.prototype.getClass=function(){return A1};var wo=function(){var e=this;if(this._dimension=3,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var t=arguments[0];this._coordinates=new Array(t).fill(null);for(var i=0;i<t;i++)e._coordinates[i]=new ht}else if(Si(arguments[0],Or)){var r=arguments[0];if(r===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=r.getDimension(),this._coordinates=new Array(r.size()).fill(null);for(var a=0;a<this._coordinates.length;a++)e._coordinates[a]=r.getCoordinateCopy(a)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var h=arguments[0],s=arguments[1];this._coordinates=h,this._dimension=s,h===null&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var p=arguments[0],x=arguments[1];this._coordinates=new Array(p).fill(null),this._dimension=x;for(var I=0;I<p;I++)e._coordinates[I]=new ht}}},nL={serialVersionUID:{configurable:!0}};wo.prototype.setOrdinate=function(e,t,i){switch(t){case Or.X:this._coordinates[e].x=i;break;case Or.Y:this._coordinates[e].y=i;break;case Or.Z:this._coordinates[e].z=i;break;default:throw new Xs("invalid ordinateIndex")}};wo.prototype.size=function(){return this._coordinates.length};wo.prototype.getOrdinate=function(e,t){switch(t){case Or.X:return this._coordinates[e].x;case Or.Y:return this._coordinates[e].y;case Or.Z:return this._coordinates[e].z}return zi.NaN};wo.prototype.getCoordinate=function(){if(arguments.length===1){var e=arguments[0];return this._coordinates[e]}else if(arguments.length===2){var t=arguments[0],i=arguments[1];i.x=this._coordinates[t].x,i.y=this._coordinates[t].y,i.z=this._coordinates[t].z}};wo.prototype.getCoordinateCopy=function(e){return new ht(this._coordinates[e])};wo.prototype.getDimension=function(){return this._dimension};wo.prototype.getX=function(e){return this._coordinates[e].x};wo.prototype.clone=function(){for(var e=this,t=new Array(this.size()).fill(null),i=0;i<this._coordinates.length;i++)t[i]=e._coordinates[i].clone();return new wo(t,this._dimension)};wo.prototype.expandEnvelope=function(e){for(var t=this,i=0;i<this._coordinates.length;i++)e.expandToInclude(t._coordinates[i]);return e};wo.prototype.copy=function(){for(var e=this,t=new Array(this.size()).fill(null),i=0;i<this._coordinates.length;i++)t[i]=e._coordinates[i].copy();return new wo(t,this._dimension)};wo.prototype.toString=function(){var e=this;if(this._coordinates.length>0){var t=new wf(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var i=1;i<this._coordinates.length;i++)t.append(", "),t.append(e._coordinates[i]);return t.append(")"),t.toString()}else return"()"};wo.prototype.getY=function(e){return this._coordinates[e].y};wo.prototype.toCoordinateArray=function(){return this._coordinates};wo.prototype.interfaces_=function(){return[Or,Gc]};wo.prototype.getClass=function(){return wo};nL.serialVersionUID.get=function(){return-0xcb44a778db18e00};Object.defineProperties(wo,nL);var ad=function(){},vS={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};ad.prototype.readResolve=function(){return ad.instance()};ad.prototype.create=function(){if(arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];return new wo(e)}else if(Si(arguments[0],Or)){var t=arguments[0];return new wo(t)}}else if(arguments.length===2){var i=arguments[0],r=arguments[1];return r>3&&(r=3),r<2?new wo(i):new wo(i,r)}};ad.prototype.interfaces_=function(){return[vv,Gc]};ad.prototype.getClass=function(){return ad};ad.instance=function(){return ad.instanceObject};vS.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00};vS.instanceObject.get=function(){return new ad};Object.defineProperties(ad,vS);var iL=function(n){function e(){n.call(this),this.map_=new Map}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.get=function(i){return this.map_.get(i)||null},e.prototype.put=function(i,r){return this.map_.set(i,r),r},e.prototype.values=function(){for(var i=new In,r=this.map_.values(),a=r.next();!a.done;)i.add(a.value),a=r.next();return i},e.prototype.entrySet=function(){var i=new _S;return this.map_.entries().forEach(function(r){return i.add(r)}),i},e.prototype.size=function(){return this.map_.size()},e}(P_),Xr=function n(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=n.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof gf){var e=arguments[0];this._modelType=e,e===n.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var t=arguments[0];this._modelType=n.FIXED,this.setScale(t)}else if(arguments[0]instanceof n){var i=arguments[0];this._modelType=i._modelType,this._scale=i._scale}}},xS={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};Xr.prototype.equals=function(e){if(!(e instanceof Xr))return!1;var t=e;return this._modelType===t._modelType&&this._scale===t._scale};Xr.prototype.compareTo=function(e){var t=e,i=this.getMaximumSignificantDigits(),r=t.getMaximumSignificantDigits();return new df(i).compareTo(new df(r))};Xr.prototype.getScale=function(){return this._scale};Xr.prototype.isFloating=function(){return this._modelType===Xr.FLOATING||this._modelType===Xr.FLOATING_SINGLE};Xr.prototype.getType=function(){return this._modelType};Xr.prototype.toString=function(){var e="UNKNOWN";return this._modelType===Xr.FLOATING?e="Floating":this._modelType===Xr.FLOATING_SINGLE?e="Floating-Single":this._modelType===Xr.FIXED&&(e="Fixed (Scale="+this.getScale()+")"),e};Xr.prototype.makePrecise=function(){if(typeof arguments[0]=="number"){var e=arguments[0];if(zi.isNaN(e))return e;if(this._modelType===Xr.FLOATING_SINGLE){var t=e;return t}return this._modelType===Xr.FIXED?Math.round(e*this._scale)/this._scale:e}else if(arguments[0]instanceof ht){var i=arguments[0];if(this._modelType===Xr.FLOATING)return null;i.x=this.makePrecise(i.x),i.y=this.makePrecise(i.y)}};Xr.prototype.getMaximumSignificantDigits=function(){var e=16;return this._modelType===Xr.FLOATING?e=16:this._modelType===Xr.FLOATING_SINGLE?e=6:this._modelType===Xr.FIXED&&(e=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),e};Xr.prototype.setScale=function(e){this._scale=Math.abs(e)};Xr.prototype.interfaces_=function(){return[Gc,Vc]};Xr.prototype.getClass=function(){return Xr};Xr.mostPrecise=function(e,t){return e.compareTo(t)>=0?e:t};xS.serialVersionUID.get=function(){return 7777263578777804e3};xS.maximumPreciseValue.get=function(){return 9007199254740992};Object.defineProperties(Xr,xS);var gf=function n(e){this._name=e||null,n.nameToTypeMap.put(e,this)},bS={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};gf.prototype.readResolve=function(){return gf.nameToTypeMap.get(this._name)};gf.prototype.toString=function(){return this._name};gf.prototype.interfaces_=function(){return[Gc]};gf.prototype.getClass=function(){return gf};bS.serialVersionUID.get=function(){return-552860263173159e4};bS.nameToTypeMap.get=function(){return new iL};Object.defineProperties(gf,bS);Xr.Type=gf;Xr.FIXED=new gf("FIXED");Xr.FLOATING=new gf("FLOATING");Xr.FLOATING_SINGLE=new gf("FLOATING SINGLE");var mr=function n(){this._precisionModel=new Xr,this._SRID=0,this._coordinateSequenceFactory=n.getDefaultCoordinateSequenceFactory(),arguments.length===0||(arguments.length===1?Si(arguments[0],vv)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof Xr&&(this._precisionModel=arguments[0]):arguments.length===2?(this._precisionModel=arguments[0],this._SRID=arguments[1]):arguments.length===3&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},rL={serialVersionUID:{configurable:!0}};mr.prototype.toGeometry=function(e){return e.isNull()?this.createPoint(null):e.getMinX()===e.getMaxX()&&e.getMinY()===e.getMaxY()?this.createPoint(new ht(e.getMinX(),e.getMinY())):e.getMinX()===e.getMaxX()||e.getMinY()===e.getMaxY()?this.createLineString([new ht(e.getMinX(),e.getMinY()),new ht(e.getMaxX(),e.getMaxY())]):this.createPolygon(this.createLinearRing([new ht(e.getMinX(),e.getMinY()),new ht(e.getMinX(),e.getMaxY()),new ht(e.getMaxX(),e.getMaxY()),new ht(e.getMaxX(),e.getMinY()),new ht(e.getMinX(),e.getMinY())]),null)};mr.prototype.createLineString=function(e){if(e){if(e instanceof Array)return new fo(this.getCoordinateSequenceFactory().create(e),this);if(Si(e,Or))return new fo(e,this)}else return new fo(this.getCoordinateSequenceFactory().create([]),this)};mr.prototype.createMultiLineString=function(){if(arguments.length===0)return new Qm(null,this);if(arguments.length===1){var e=arguments[0];return new Qm(e,this)}};mr.prototype.buildGeometry=function(e){for(var t=null,i=!1,r=!1,a=e.iterator();a.hasNext();){var h=a.next(),s=h.getClass();t===null&&(t=s),s!==t&&(i=!0),h.isGeometryCollectionOrDerived()&&(r=!0)}if(t===null)return this.createGeometryCollection();if(i||r)return this.createGeometryCollection(mr.toGeometryArray(e));var p=e.iterator().next(),x=e.size()>1;if(x){if(p instanceof ea)return this.createMultiPolygon(mr.toPolygonArray(e));if(p instanceof fo)return this.createMultiLineString(mr.toLineStringArray(e));if(p instanceof yu)return this.createMultiPoint(mr.toPointArray(e));Zi.shouldNeverReachHere("Unhandled class: "+p.getClass().getName())}return p};mr.prototype.createMultiPointFromCoords=function(e){return this.createMultiPoint(e!==null?this.getCoordinateSequenceFactory().create(e):null)};mr.prototype.createPoint=function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof ht){var e=arguments[0];return this.createPoint(e!==null?this.getCoordinateSequenceFactory().create([e]):null)}else if(Si(arguments[0],Or)){var t=arguments[0];return new yu(t,this)}}};mr.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory};mr.prototype.createPolygon=function(){if(arguments.length===0)return new ea(null,null,this);if(arguments.length===1){if(Si(arguments[0],Or)){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}else if(arguments[0]instanceof Array){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}else if(arguments[0]instanceof od){var i=arguments[0];return this.createPolygon(i,null)}}else if(arguments.length===2){var r=arguments[0],a=arguments[1];return new ea(r,a,this)}};mr.prototype.getSRID=function(){return this._SRID};mr.prototype.createGeometryCollection=function(){if(arguments.length===0)return new Sl(null,this);if(arguments.length===1){var e=arguments[0];return new Sl(e,this)}};mr.prototype.createGeometry=function(e){var t=new kc(this);return t.edit(e,{edit:function(){if(arguments.length===2){var i=arguments[0];return this._coordinateSequenceFactory.create(i)}}})};mr.prototype.getPrecisionModel=function(){return this._precisionModel};mr.prototype.createLinearRing=function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];return this.createLinearRing(e!==null?this.getCoordinateSequenceFactory().create(e):null)}else if(Si(arguments[0],Or)){var t=arguments[0];return new od(t,this)}}};mr.prototype.createMultiPolygon=function(){if(arguments.length===0)return new td(null,this);if(arguments.length===1){var e=arguments[0];return new td(e,this)}};mr.prototype.createMultiPoint=function(){var e=this;if(arguments.length===0)return new Tv(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return new Tv(t,this)}else if(arguments[0]instanceof Array){var i=arguments[0];return this.createMultiPoint(i!==null?this.getCoordinateSequenceFactory().create(i):null)}else if(Si(arguments[0],Or)){var r=arguments[0];if(r===null)return this.createMultiPoint(new Array(0).fill(null));for(var a=new Array(r.size()).fill(null),h=0;h<r.size();h++){var s=e.getCoordinateSequenceFactory().create(1,r.getDimension());To.copy(r,h,s,0,1),a[h]=e.createPoint(s)}return this.createMultiPoint(a)}}};mr.prototype.interfaces_=function(){return[Gc]};mr.prototype.getClass=function(){return mr};mr.toMultiPolygonArray=function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)};mr.toGeometryArray=function(e){if(e===null)return null;var t=new Array(e.size()).fill(null);return e.toArray(t)};mr.getDefaultCoordinateSequenceFactory=function(){return ad.instance()};mr.toMultiLineStringArray=function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)};mr.toLineStringArray=function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)};mr.toMultiPointArray=function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)};mr.toLinearRingArray=function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)};mr.toPointArray=function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)};mr.toPolygonArray=function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)};mr.createPointFromInternalCoord=function(e,t){return t.getPrecisionModel().makePrecise(e),t.getFactory().createPoint(e)};rL.serialVersionUID.get=function(){return-6820524753094096e3};Object.defineProperties(mr,rL);var uB=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],KE=function(e){this.geometryFactory=e||new mr};KE.prototype.read=function(e){var t;typeof e=="string"?t=JSON.parse(e):t=e;var i=t.type;if(!af[i])throw new Error("Unknown GeoJSON type: "+t.type);return uB.indexOf(i)!==-1?af[i].apply(this,[t.coordinates]):i==="GeometryCollection"?af[i].apply(this,[t.geometries]):af[i].apply(this,[t])};KE.prototype.write=function(e){var t=e.getGeometryType();if(!Xd[t])throw new Error("Geometry is not supported");return Xd[t].apply(this,[e])};var af={Feature:function(n){var e={};for(var t in n)e[t]=n[t];if(n.geometry){var i=n.geometry.type;if(!af[i])throw new Error("Unknown GeoJSON type: "+n.type);e.geometry=this.read(n.geometry)}return n.bbox&&(e.bbox=af.bbox.apply(this,[n.bbox])),e},FeatureCollection:function(n){var e=this,t={};if(n.features){t.features=[];for(var i=0;i<n.features.length;++i)t.features.push(e.read(n.features[i]))}return n.bbox&&(t.bbox=this.parse.bbox.apply(this,[n.bbox])),t},coordinates:function(n){for(var e=[],t=0;t<n.length;++t){var i=n[t];e.push(new ht(i[0],i[1]))}return e},bbox:function(n){return this.geometryFactory.createLinearRing([new ht(n[0],n[1]),new ht(n[2],n[1]),new ht(n[2],n[3]),new ht(n[0],n[3]),new ht(n[0],n[1])])},Point:function(n){var e=new ht(n[0],n[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(n){for(var e=this,t=[],i=0;i<n.length;++i)t.push(af.Point.apply(e,[n[i]]));return this.geometryFactory.createMultiPoint(t)},LineString:function(n){var e=af.coordinates.apply(this,[n]);return this.geometryFactory.createLineString(e)},MultiLineString:function(n){for(var e=this,t=[],i=0;i<n.length;++i)t.push(af.LineString.apply(e,[n[i]]));return this.geometryFactory.createMultiLineString(t)},Polygon:function(n){for(var e=this,t=af.coordinates.apply(this,[n[0]]),i=this.geometryFactory.createLinearRing(t),r=[],a=1;a<n.length;++a){var h=n[a],s=af.coordinates.apply(e,[h]),p=e.geometryFactory.createLinearRing(s);r.push(p)}return this.geometryFactory.createPolygon(i,r)},MultiPolygon:function(n){for(var e=this,t=[],i=0;i<n.length;++i){var r=n[i];t.push(af.Polygon.apply(e,[r]))}return this.geometryFactory.createMultiPolygon(t)},GeometryCollection:function(n){for(var e=this,t=[],i=0;i<n.length;++i){var r=n[i];t.push(e.read(r))}return this.geometryFactory.createGeometryCollection(t)}},Xd={coordinate:function(n){return[n.x,n.y]},Point:function(n){var e=Xd.coordinate.apply(this,[n.getCoordinate()]);return{type:"Point",coordinates:e}},MultiPoint:function(n){for(var e=this,t=[],i=0;i<n._geometries.length;++i){var r=n._geometries[i],a=Xd.Point.apply(e,[r]);t.push(a.coordinates)}return{type:"MultiPoint",coordinates:t}},LineString:function(n){for(var e=this,t=[],i=n.getCoordinates(),r=0;r<i.length;++r){var a=i[r];t.push(Xd.coordinate.apply(e,[a]))}return{type:"LineString",coordinates:t}},MultiLineString:function(n){for(var e=this,t=[],i=0;i<n._geometries.length;++i){var r=n._geometries[i],a=Xd.LineString.apply(e,[r]);t.push(a.coordinates)}return{type:"MultiLineString",coordinates:t}},Polygon:function(n){var e=this,t=[],i=Xd.LineString.apply(this,[n._shell]);t.push(i.coordinates);for(var r=0;r<n._holes.length;++r){var a=n._holes[r],h=Xd.LineString.apply(e,[a]);t.push(h.coordinates)}return{type:"Polygon",coordinates:t}},MultiPolygon:function(n){for(var e=this,t=[],i=0;i<n._geometries.length;++i){var r=n._geometries[i],a=Xd.Polygon.apply(e,[r]);t.push(a.coordinates)}return{type:"MultiPolygon",coordinates:t}},GeometryCollection:function(n){for(var e=this,t=[],i=0;i<n._geometries.length;++i){var r=n._geometries[i],a=r.getGeometryType();t.push(Xd[a].apply(e,[r]))}return{type:"GeometryCollection",geometries:t}}},ES=function(e){this.geometryFactory=e||new mr,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new KE(this.geometryFactory)};ES.prototype.read=function(e){var t=this.parser.read(e);return this.precisionModel.getType()===Xr.FIXED&&this.reducePrecision(t),t};ES.prototype.reducePrecision=function(e){var t=this,i,r;if(e.coordinate)this.precisionModel.makePrecise(e.coordinate);else if(e.points)for(i=0,r=e.points.length;i<r;i++)t.precisionModel.makePrecise(e.points[i]);else if(e.geometries)for(i=0,r=e.geometries.length;i<r;i++)t.reducePrecision(e.geometries[i])};var sL=function(){this.parser=new KE(this.geometryFactory)};sL.prototype.write=function(e){return this.parser.write(e)};var fn=function(){},JE={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};fn.prototype.interfaces_=function(){return[]};fn.prototype.getClass=function(){return fn};fn.opposite=function(e){return e===fn.LEFT?fn.RIGHT:e===fn.RIGHT?fn.LEFT:e};JE.ON.get=function(){return 0};JE.LEFT.get=function(){return 1};JE.RIGHT.get=function(){return 2};Object.defineProperties(fn,JE);function QE(n){this.message=n||""}QE.prototype=new Error;QE.prototype.name="EmptyStackException";function If(){this.array_=[]}If.prototype=new dh;If.prototype.add=function(n){return this.array_.push(n),!0};If.prototype.get=function(n){if(n<0||n>=this.size())throw new Error;return this.array_[n]};If.prototype.push=function(n){return this.array_.push(n),n};If.prototype.pop=function(n){if(this.array_.length===0)throw new QE;return this.array_.pop()};If.prototype.peek=function(){if(this.array_.length===0)throw new QE;return this.array_[this.array_.length-1]};If.prototype.empty=function(){return this.array_.length===0};If.prototype.isEmpty=function(){return this.empty()};If.prototype.search=function(n){return this.array_.indexOf(n)};If.prototype.size=function(){return this.array_.length};If.prototype.toArray=function(){for(var n=this,e=[],t=0,i=this.array_.length;t<i;t++)e.push(n.array_[t]);return e};var _f=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};_f.prototype.getCoordinate=function(){return this._minCoord};_f.prototype.getRightmostSide=function(e,t){var i=this.getRightmostSideOfSegment(e,t);return i<0&&(i=this.getRightmostSideOfSegment(e,t-1)),i<0&&(this._minCoord=null,this.checkForRightmostCoordinate(e)),i};_f.prototype.findRightmostEdgeAtVertex=function(){var e=this._minDe.getEdge().getCoordinates();Zi.isTrue(this._minIndex>0&&this._minIndex<e.length,"rightmost point expected to be interior vertex of edge");var t=e[this._minIndex-1],i=e[this._minIndex+1],r=Nn.computeOrientation(this._minCoord,i,t),a=!1;(t.y<this._minCoord.y&&i.y<this._minCoord.y&&r===Nn.COUNTERCLOCKWISE||t.y>this._minCoord.y&&i.y>this._minCoord.y&&r===Nn.CLOCKWISE)&&(a=!0),a&&(this._minIndex=this._minIndex-1)};_f.prototype.getRightmostSideOfSegment=function(e,t){var i=e.getEdge(),r=i.getCoordinates();if(t<0||t+1>=r.length||r[t].y===r[t+1].y)return-1;var a=fn.LEFT;return r[t].y<r[t+1].y&&(a=fn.RIGHT),a};_f.prototype.getEdge=function(){return this._orientedDe};_f.prototype.checkForRightmostCoordinate=function(e){for(var t=this,i=e.getEdge().getCoordinates(),r=0;r<i.length-1;r++)(t._minCoord===null||i[r].x>t._minCoord.x)&&(t._minDe=e,t._minIndex=r,t._minCoord=i[r])};_f.prototype.findRightmostEdgeAtNode=function(){var e=this._minDe.getNode(),t=e.getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)};_f.prototype.findEdge=function(e){for(var t=this,i=e.iterator();i.hasNext();){var r=i.next();r.isForward()&&t.checkForRightmostCoordinate(r)}Zi.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe;var a=this.getRightmostSide(this._minDe,this._minIndex);a===fn.LEFT&&(this._orientedDe=this._minDe.getSym())};_f.prototype.interfaces_=function(){return[]};_f.prototype.getClass=function(){return _f};var rp=function(n){function e(t,i){n.call(this,e.msgWithCoord(t,i)),this.pt=i?new ht(i):null,this.name="TopologyException"}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.getCoordinate=function(){return this.pt},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.msgWithCoord=function(i,r){return r?i:i+" [ "+r+" ]"},e}(np),$E=function(){this.array_=[]};$E.prototype.addLast=function(e){this.array_.push(e)};$E.prototype.removeFirst=function(){return this.array_.shift()};$E.prototype.isEmpty=function(){return this.array_.length===0};var Cl=function(){this._finder=null,this._dirEdgeList=new In,this._nodes=new In,this._rightMostCoord=null,this._env=null,this._finder=new _f};Cl.prototype.clearVisitedEdges=function(){for(var e=this._dirEdgeList.iterator();e.hasNext();){var t=e.next();t.setVisited(!1)}};Cl.prototype.getRightmostCoordinate=function(){return this._rightMostCoord};Cl.prototype.computeNodeDepth=function(e){for(var t=this,i=null,r=e.getEdges().iterator();r.hasNext();){var a=r.next();if(a.isVisited()||a.getSym().isVisited()){i=a;break}}if(i===null)throw new rp("unable to find edge to compute depths at "+e.getCoordinate());e.getEdges().computeDepths(i);for(var h=e.getEdges().iterator();h.hasNext();){var s=h.next();s.setVisited(!0),t.copySymDepths(s)}};Cl.prototype.computeDepth=function(e){this.clearVisitedEdges();var t=this._finder.getEdge();t.setEdgeDepths(fn.RIGHT,e),this.copySymDepths(t),this.computeDepths(t)};Cl.prototype.create=function(e){this.addReachable(e),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()};Cl.prototype.findResultEdges=function(){for(var e=this._dirEdgeList.iterator();e.hasNext();){var t=e.next();t.getDepth(fn.RIGHT)>=1&&t.getDepth(fn.LEFT)<=0&&!t.isInteriorAreaEdge()&&t.setInResult(!0)}};Cl.prototype.computeDepths=function(e){var t=this,i=new _S,r=new $E,a=e.getNode();for(r.addLast(a),i.add(a),e.setVisited(!0);!r.isEmpty();){var h=r.removeFirst();i.add(h),t.computeNodeDepth(h);for(var s=h.getEdges().iterator();s.hasNext();){var p=s.next(),x=p.getSym();if(!x.isVisited()){var I=x.getNode();i.contains(I)||(r.addLast(I),i.add(I))}}}};Cl.prototype.compareTo=function(e){var t=e;return this._rightMostCoord.x<t._rightMostCoord.x?-1:this._rightMostCoord.x>t._rightMostCoord.x?1:0};Cl.prototype.getEnvelope=function(){if(this._env===null){for(var e=new li,t=this._dirEdgeList.iterator();t.hasNext();)for(var i=t.next(),r=i.getEdge().getCoordinates(),a=0;a<r.length-1;a++)e.expandToInclude(r[a]);this._env=e}return this._env};Cl.prototype.addReachable=function(e){var t=this,i=new If;for(i.add(e);!i.empty();){var r=i.pop();t.add(r,i)}};Cl.prototype.copySymDepths=function(e){var t=e.getSym();t.setDepth(fn.LEFT,e.getDepth(fn.RIGHT)),t.setDepth(fn.RIGHT,e.getDepth(fn.LEFT))};Cl.prototype.add=function(e,t){var i=this;e.setVisited(!0),this._nodes.add(e);for(var r=e.getEdges().iterator();r.hasNext();){var a=r.next();i._dirEdgeList.add(a);var h=a.getSym(),s=h.getNode();s.isVisited()||t.push(s)}};Cl.prototype.getNodes=function(){return this._nodes};Cl.prototype.getDirectedEdges=function(){return this._dirEdgeList};Cl.prototype.interfaces_=function(){return[Vc]};Cl.prototype.getClass=function(){return Cl};var Ts=function n(){var e=this;if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){var i=arguments[0];this.init(1),this.location[fn.ON]=i}else if(arguments[0]instanceof n){var r=arguments[0];if(this.init(r.location.length),r!==null)for(var a=0;a<this.location.length;a++)e.location[a]=r.location[a]}}else if(arguments.length===3){var h=arguments[0],s=arguments[1],p=arguments[2];this.init(3),this.location[fn.ON]=h,this.location[fn.LEFT]=s,this.location[fn.RIGHT]=p}};Ts.prototype.setAllLocations=function(e){for(var t=this,i=0;i<this.location.length;i++)t.location[i]=e};Ts.prototype.isNull=function(){for(var e=this,t=0;t<this.location.length;t++)if(e.location[t]!==vt.NONE)return!1;return!0};Ts.prototype.setAllLocationsIfNull=function(e){for(var t=this,i=0;i<this.location.length;i++)t.location[i]===vt.NONE&&(t.location[i]=e)};Ts.prototype.isLine=function(){return this.location.length===1};Ts.prototype.merge=function(e){var t=this;if(e.location.length>this.location.length){var i=new Array(3).fill(null);i[fn.ON]=this.location[fn.ON],i[fn.LEFT]=vt.NONE,i[fn.RIGHT]=vt.NONE,this.location=i}for(var r=0;r<this.location.length;r++)t.location[r]===vt.NONE&&r<e.location.length&&(t.location[r]=e.location[r])};Ts.prototype.getLocations=function(){return this.location};Ts.prototype.flip=function(){if(this.location.length<=1)return null;var e=this.location[fn.LEFT];this.location[fn.LEFT]=this.location[fn.RIGHT],this.location[fn.RIGHT]=e};Ts.prototype.toString=function(){var e=new wf;return this.location.length>1&&e.append(vt.toLocationSymbol(this.location[fn.LEFT])),e.append(vt.toLocationSymbol(this.location[fn.ON])),this.location.length>1&&e.append(vt.toLocationSymbol(this.location[fn.RIGHT])),e.toString()};Ts.prototype.setLocations=function(e,t,i){this.location[fn.ON]=e,this.location[fn.LEFT]=t,this.location[fn.RIGHT]=i};Ts.prototype.get=function(e){return e<this.location.length?this.location[e]:vt.NONE};Ts.prototype.isArea=function(){return this.location.length>1};Ts.prototype.isAnyNull=function(){for(var e=this,t=0;t<this.location.length;t++)if(e.location[t]===vt.NONE)return!0;return!1};Ts.prototype.setLocation=function(){if(arguments.length===1){var e=arguments[0];this.setLocation(fn.ON,e)}else if(arguments.length===2){var t=arguments[0],i=arguments[1];this.location[t]=i}};Ts.prototype.init=function(e){this.location=new Array(e).fill(null),this.setAllLocations(vt.NONE)};Ts.prototype.isEqualOnSide=function(e,t){return this.location[t]===e.location[t]};Ts.prototype.allPositionsEqual=function(e){for(var t=this,i=0;i<this.location.length;i++)if(t.location[i]!==e)return!1;return!0};Ts.prototype.interfaces_=function(){return[]};Ts.prototype.getClass=function(){return Ts};var is=function n(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new Ts(e),this.elt[1]=new Ts(e)}else if(arguments[0]instanceof n){var t=arguments[0];this.elt[0]=new Ts(t.elt[0]),this.elt[1]=new Ts(t.elt[1])}}else if(arguments.length===2){var i=arguments[0],r=arguments[1];this.elt[0]=new Ts(vt.NONE),this.elt[1]=new Ts(vt.NONE),this.elt[i].setLocation(r)}else if(arguments.length===3){var a=arguments[0],h=arguments[1],s=arguments[2];this.elt[0]=new Ts(a,h,s),this.elt[1]=new Ts(a,h,s)}else if(arguments.length===4){var p=arguments[0],x=arguments[1],I=arguments[2],C=arguments[3];this.elt[0]=new Ts(vt.NONE,vt.NONE,vt.NONE),this.elt[1]=new Ts(vt.NONE,vt.NONE,vt.NONE),this.elt[p].setLocations(x,I,C)}};is.prototype.getGeometryCount=function(){var e=0;return this.elt[0].isNull()||e++,this.elt[1].isNull()||e++,e};is.prototype.setAllLocations=function(e,t){this.elt[e].setAllLocations(t)};is.prototype.isNull=function(e){return this.elt[e].isNull()};is.prototype.setAllLocationsIfNull=function(){if(arguments.length===1){var e=arguments[0];this.setAllLocationsIfNull(0,e),this.setAllLocationsIfNull(1,e)}else if(arguments.length===2){var t=arguments[0],i=arguments[1];this.elt[t].setAllLocationsIfNull(i)}};is.prototype.isLine=function(e){return this.elt[e].isLine()};is.prototype.merge=function(e){for(var t=this,i=0;i<2;i++)t.elt[i]===null&&e.elt[i]!==null?t.elt[i]=new Ts(e.elt[i]):t.elt[i].merge(e.elt[i])};is.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()};is.prototype.getLocation=function(){if(arguments.length===1){var e=arguments[0];return this.elt[e].get(fn.ON)}else if(arguments.length===2){var t=arguments[0],i=arguments[1];return this.elt[t].get(i)}};is.prototype.toString=function(){var e=new wf;return this.elt[0]!==null&&(e.append("A:"),e.append(this.elt[0].toString())),this.elt[1]!==null&&(e.append(" B:"),e.append(this.elt[1].toString())),e.toString()};is.prototype.isArea=function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var e=arguments[0];return this.elt[e].isArea()}};is.prototype.isAnyNull=function(e){return this.elt[e].isAnyNull()};is.prototype.setLocation=function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];this.elt[e].setLocation(fn.ON,t)}else if(arguments.length===3){var i=arguments[0],r=arguments[1],a=arguments[2];this.elt[i].setLocation(r,a)}};is.prototype.isEqualOnSide=function(e,t){return this.elt[0].isEqualOnSide(e.elt[0],t)&&this.elt[1].isEqualOnSide(e.elt[1],t)};is.prototype.allPositionsEqual=function(e,t){return this.elt[e].allPositionsEqual(t)};is.prototype.toLine=function(e){this.elt[e].isArea()&&(this.elt[e]=new Ts(this.elt[e].location[0]))};is.prototype.interfaces_=function(){return[]};is.prototype.getClass=function(){return is};is.toLineLabel=function(e){for(var t=new is(vt.NONE),i=0;i<2;i++)t.setLocation(i,e.getLocation(i));return t};var Bo=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new In,this._pts=new In,this._label=new is(vt.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new In,this._geometryFactory=null;var e=arguments[0],t=arguments[1];this._geometryFactory=t,this.computePoints(e),this.computeRing()};Bo.prototype.computeRing=function(){var e=this;if(this._ring!==null)return null;for(var t=new Array(this._pts.size()).fill(null),i=0;i<this._pts.size();i++)t[i]=e._pts.get(i);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=Nn.isCCW(this._ring.getCoordinates())};Bo.prototype.isIsolated=function(){return this._label.getGeometryCount()===1};Bo.prototype.computePoints=function(e){var t=this;this._startDe=e;var i=e,r=!0;do{if(i===null)throw new rp("Found null DirectedEdge");if(i.getEdgeRing()===t)throw new rp("Directed Edge visited twice during ring-building at "+i.getCoordinate());t._edges.add(i);var a=i.getLabel();Zi.isTrue(a.isArea()),t.mergeLabel(a),t.addPoints(i.getEdge(),i.isForward(),r),r=!1,t.setEdgeRing(i,t),i=t.getNext(i)}while(i!==this._startDe)};Bo.prototype.getLinearRing=function(){return this._ring};Bo.prototype.getCoordinate=function(e){return this._pts.get(e)};Bo.prototype.computeMaxNodeDegree=function(){var e=this;this._maxNodeDegree=0;var t=this._startDe;do{var i=t.getNode(),r=i.getEdges().getOutgoingDegree(e);r>e._maxNodeDegree&&(e._maxNodeDegree=r),t=e.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2};Bo.prototype.addPoints=function(e,t,i){var r=this,a=e.getCoordinates();if(t){var h=1;i&&(h=0);for(var s=h;s<a.length;s++)r._pts.add(a[s])}else{var p=a.length-2;i&&(p=a.length-1);for(var x=p;x>=0;x--)r._pts.add(a[x])}};Bo.prototype.isHole=function(){return this._isHole};Bo.prototype.setInResult=function(){var e=this._startDe;do e.getEdge().setInResult(!0),e=e.getNext();while(e!==this._startDe)};Bo.prototype.containsPoint=function(e){var t=this.getLinearRing(),i=t.getEnvelopeInternal();if(!i.contains(e)||!Nn.isPointInRing(e,t.getCoordinates()))return!1;for(var r=this._holes.iterator();r.hasNext();){var a=r.next();if(a.containsPoint(e))return!1}return!0};Bo.prototype.addHole=function(e){this._holes.add(e)};Bo.prototype.isShell=function(){return this._shell===null};Bo.prototype.getLabel=function(){return this._label};Bo.prototype.getEdges=function(){return this._edges};Bo.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree};Bo.prototype.getShell=function(){return this._shell};Bo.prototype.mergeLabel=function(){if(arguments.length===1){var e=arguments[0];this.mergeLabel(e,0),this.mergeLabel(e,1)}else if(arguments.length===2){var t=arguments[0],i=arguments[1],r=t.getLocation(i,fn.RIGHT);if(r===vt.NONE)return null;if(this._label.getLocation(i)===vt.NONE)return this._label.setLocation(i,r),null}};Bo.prototype.setShell=function(e){this._shell=e,e!==null&&e.addHole(this)};Bo.prototype.toPolygon=function(e){for(var t=this,i=new Array(this._holes.size()).fill(null),r=0;r<this._holes.size();r++)i[r]=t._holes.get(r).getLinearRing();var a=e.createPolygon(this.getLinearRing(),i);return a};Bo.prototype.interfaces_=function(){return[]};Bo.prototype.getClass=function(){return Bo};var cB=function(n){function e(){var t=arguments[0],i=arguments[1];n.call(this,t,i)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.setEdgeRing=function(i,r){i.setMinEdgeRing(r)},e.prototype.getNext=function(i){return i.getNextMin()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Bo),hB=function(n){function e(){var t=arguments[0],i=arguments[1];n.call(this,t,i)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.buildMinimalRings=function(){var i=this,r=new In,a=this._startDe;do{if(a.getMinEdgeRing()===null){var h=new cB(a,i._geometryFactory);r.add(h)}a=a.getNext()}while(a!==this._startDe);return r},e.prototype.setEdgeRing=function(i,r){i.setEdgeRing(r)},e.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var i=this,r=this._startDe;do{var a=r.getNode();a.getEdges().linkMinimalDirectedEdges(i),r=r.getNext()}while(r!==this._startDe)},e.prototype.getNext=function(i){return i.getNext()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Bo),Ku=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this._label=e}}};Ku.prototype.setVisited=function(e){this._isVisited=e};Ku.prototype.setInResult=function(e){this._isInResult=e};Ku.prototype.isCovered=function(){return this._isCovered};Ku.prototype.isCoveredSet=function(){return this._isCoveredSet};Ku.prototype.setLabel=function(e){this._label=e};Ku.prototype.getLabel=function(){return this._label};Ku.prototype.setCovered=function(e){this._isCovered=e,this._isCoveredSet=!0};Ku.prototype.updateIM=function(e){Zi.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(e)};Ku.prototype.isInResult=function(){return this._isInResult};Ku.prototype.isVisited=function(){return this._isVisited};Ku.prototype.interfaces_=function(){return[]};Ku.prototype.getClass=function(){return Ku};var ew=function(n){function e(){n.call(this),this._coord=null,this._edges=null;var t=arguments[0],i=arguments[1];this._coord=t,this._edges=i,this._label=new is(0,vt.NONE)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.isIncidentEdgeInResult=function(){for(var i=this.getEdges().getEdges().iterator();i.hasNext();){var r=i.next();if(r.getEdge().isInResult())return!0}return!1},e.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},e.prototype.getCoordinate=function(){return this._coord},e.prototype.print=function(i){i.println("node "+this._coord+" lbl: "+this._label)},e.prototype.computeIM=function(i){},e.prototype.computeMergedLocation=function(i,r){var a=vt.NONE;if(a=this._label.getLocation(r),!i.isNull(r)){var h=i.getLocation(r);a!==vt.BOUNDARY&&(a=h)}return a},e.prototype.setLabel=function(){if(arguments.length===2){var i=arguments[0],r=arguments[1];this._label===null?this._label=new is(i,r):this._label.setLocation(i,r)}else return n.prototype.setLabel.apply(this,arguments)},e.prototype.getEdges=function(){return this._edges},e.prototype.mergeLabel=function(){var i=this;if(arguments[0]instanceof e){var r=arguments[0];this.mergeLabel(r._label)}else if(arguments[0]instanceof is)for(var a=arguments[0],h=0;h<2;h++){var s=i.computeMergedLocation(a,h),p=i._label.getLocation(h);p===vt.NONE&&i._label.setLocation(h,s)}},e.prototype.add=function(i){this._edges.insert(i),i.setNode(this)},e.prototype.setLabelBoundary=function(i){if(this._label===null)return null;var r=vt.NONE;this._label!==null&&(r=this._label.getLocation(i));var a=null;switch(r){case vt.BOUNDARY:a=vt.INTERIOR;break;case vt.INTERIOR:a=vt.BOUNDARY;break;default:a=vt.BOUNDARY;break}this._label.setLocation(i,a)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ku),yf=function(){this.nodeMap=new cl,this.nodeFact=null;var e=arguments[0];this.nodeFact=e};yf.prototype.find=function(e){return this.nodeMap.get(e)};yf.prototype.addNode=function(){if(arguments[0]instanceof ht){var e=arguments[0],t=this.nodeMap.get(e);return t===null&&(t=this.nodeFact.createNode(e),this.nodeMap.put(e,t)),t}else if(arguments[0]instanceof ew){var i=arguments[0],r=this.nodeMap.get(i.getCoordinate());return r===null?(this.nodeMap.put(i.getCoordinate(),i),i):(r.mergeLabel(i),r)}};yf.prototype.print=function(e){for(var t=this.iterator();t.hasNext();){var i=t.next();i.print(e)}};yf.prototype.iterator=function(){return this.nodeMap.values().iterator()};yf.prototype.values=function(){return this.nodeMap.values()};yf.prototype.getBoundaryNodes=function(e){for(var t=new In,i=this.iterator();i.hasNext();){var r=i.next();r.getLabel().getLocation(e)===vt.BOUNDARY&&t.add(r)}return t};yf.prototype.add=function(e){var t=e.getCoordinate(),i=this.addNode(t);i.add(e)};yf.prototype.interfaces_=function(){return[]};yf.prototype.getClass=function(){return yf};var ps=function(){},Q1={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};ps.prototype.interfaces_=function(){return[]};ps.prototype.getClass=function(){return ps};ps.isNorthern=function(e){return e===ps.NE||e===ps.NW};ps.isOpposite=function(e,t){if(e===t)return!1;var i=(e-t+4)%4;return i===2};ps.commonHalfPlane=function(e,t){if(e===t)return e;var i=(e-t+4)%4;if(i===2)return-1;var r=e<t?e:t,a=e>t?e:t;return r===0&&a===3?3:r};ps.isInHalfPlane=function(e,t){return t===ps.SE?e===ps.SE||e===ps.SW:e===t||e===t+1};ps.quadrant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],t=arguments[1];if(e===0&&t===0)throw new Xs("Cannot compute the quadrant for point ( "+e+", "+t+" )");return e>=0?t>=0?ps.NE:ps.SE:t>=0?ps.NW:ps.SW}else if(arguments[0]instanceof ht&&arguments[1]instanceof ht){var i=arguments[0],r=arguments[1];if(r.x===i.x&&r.y===i.y)throw new Xs("Cannot compute the quadrant for two identical points "+i);return r.x>=i.x?r.y>=i.y?ps.NE:ps.SE:r.y>=i.y?ps.NW:ps.SW}};Q1.NE.get=function(){return 0};Q1.NW.get=function(){return 1};Q1.SW.get=function(){return 2};Q1.SE.get=function(){return 3};Object.defineProperties(ps,Q1);var hl=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var e=arguments[0];this._edge=e}else if(arguments.length===3){var t=arguments[0],i=arguments[1],r=arguments[2],a=null;this._edge=t,this.init(i,r),this._label=a}else if(arguments.length===4){var h=arguments[0],s=arguments[1],p=arguments[2],x=arguments[3];this._edge=h,this.init(s,p),this._label=x}};hl.prototype.compareDirection=function(e){return this._dx===e._dx&&this._dy===e._dy?0:this._quadrant>e._quadrant?1:this._quadrant<e._quadrant?-1:Nn.computeOrientation(e._p0,e._p1,this._p1)};hl.prototype.getDy=function(){return this._dy};hl.prototype.getCoordinate=function(){return this._p0};hl.prototype.setNode=function(e){this._node=e};hl.prototype.print=function(e){var t=Math.atan2(this._dy,this._dx),i=this.getClass().getName(),r=i.lastIndexOf("."),a=i.substring(r+1);e.print("  "+a+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label)};hl.prototype.compareTo=function(e){var t=e;return this.compareDirection(t)};hl.prototype.getDirectedCoordinate=function(){return this._p1};hl.prototype.getDx=function(){return this._dx};hl.prototype.getLabel=function(){return this._label};hl.prototype.getEdge=function(){return this._edge};hl.prototype.getQuadrant=function(){return this._quadrant};hl.prototype.getNode=function(){return this._node};hl.prototype.toString=function(){var e=Math.atan2(this._dy,this._dx),t=this.getClass().getName(),i=t.lastIndexOf("."),r=t.substring(i+1);return"  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label};hl.prototype.computeLabel=function(e){};hl.prototype.init=function(e,t){this._p0=e,this._p1=t,this._dx=t.x-e.x,this._dy=t.y-e.y,this._quadrant=ps.quadrant(this._dx,this._dy),Zi.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")};hl.prototype.interfaces_=function(){return[Vc]};hl.prototype.getClass=function(){return hl};var MT=function(n){function e(){var t=arguments[0],i=arguments[1];if(n.call(this,t),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=i,i)this.init(t.getCoordinate(0),t.getCoordinate(1));else{var r=t.getNumPoints()-1;this.init(t.getCoordinate(r),t.getCoordinate(r-1))}this.computeDirectedLabel()}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.getNextMin=function(){return this._nextMin},e.prototype.getDepth=function(i){return this._depth[i]},e.prototype.setVisited=function(i){this._isVisited=i},e.prototype.computeDirectedLabel=function(){this._label=new is(this._edge.getLabel()),this._isForward||this._label.flip()},e.prototype.getNext=function(){return this._next},e.prototype.setDepth=function(i,r){if(this._depth[i]!==-999&&this._depth[i]!==r)throw new rp("assigned depths do not match",this.getCoordinate());this._depth[i]=r},e.prototype.isInteriorAreaEdge=function(){for(var i=this,r=!0,a=0;a<2;a++)i._label.isArea(a)&&i._label.getLocation(a,fn.LEFT)===vt.INTERIOR&&i._label.getLocation(a,fn.RIGHT)===vt.INTERIOR||(r=!1);return r},e.prototype.setNextMin=function(i){this._nextMin=i},e.prototype.print=function(i){n.prototype.print.call(this,i),i.print(" "+this._depth[fn.LEFT]+"/"+this._depth[fn.RIGHT]),i.print(" ("+this.getDepthDelta()+")"),this._isInResult&&i.print(" inResult")},e.prototype.setMinEdgeRing=function(i){this._minEdgeRing=i},e.prototype.isLineEdge=function(){var i=this._label.isLine(0)||this._label.isLine(1),r=!this._label.isArea(0)||this._label.allPositionsEqual(0,vt.EXTERIOR),a=!this._label.isArea(1)||this._label.allPositionsEqual(1,vt.EXTERIOR);return i&&r&&a},e.prototype.setEdgeRing=function(i){this._edgeRing=i},e.prototype.getMinEdgeRing=function(){return this._minEdgeRing},e.prototype.getDepthDelta=function(){var i=this._edge.getDepthDelta();return this._isForward||(i=-i),i},e.prototype.setInResult=function(i){this._isInResult=i},e.prototype.getSym=function(){return this._sym},e.prototype.isForward=function(){return this._isForward},e.prototype.getEdge=function(){return this._edge},e.prototype.printEdge=function(i){this.print(i),i.print(" "),this._isForward?this._edge.print(i):this._edge.printReverse(i)},e.prototype.setSym=function(i){this._sym=i},e.prototype.setVisitedEdge=function(i){this.setVisited(i),this._sym.setVisited(i)},e.prototype.setEdgeDepths=function(i,r){var a=this.getEdge().getDepthDelta();this._isForward||(a=-a);var h=1;i===fn.LEFT&&(h=-1);var s=fn.opposite(i),p=a*h,x=r+p;this.setDepth(i,r),this.setDepth(s,x)},e.prototype.getEdgeRing=function(){return this._edgeRing},e.prototype.isInResult=function(){return this._isInResult},e.prototype.setNext=function(i){this._next=i},e.prototype.isVisited=function(){return this._isVisited},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.depthFactor=function(i,r){return i===vt.EXTERIOR&&r===vt.INTERIOR?1:i===vt.INTERIOR&&r===vt.EXTERIOR?-1:0},e}(hl),Sv=function(){};Sv.prototype.createNode=function(e){return new ew(e,null)};Sv.prototype.interfaces_=function(){return[]};Sv.prototype.getClass=function(){return Sv};var no=function(){if(this._edges=new In,this._nodes=null,this._edgeEndList=new In,arguments.length===0)this._nodes=new yf(new Sv);else if(arguments.length===1){var e=arguments[0];this._nodes=new yf(e)}};no.prototype.printEdges=function(e){var t=this;e.println("Edges:");for(var i=0;i<this._edges.size();i++){e.println("edge "+i+":");var r=t._edges.get(i);r.print(e),r.eiList.print(e)}};no.prototype.find=function(e){return this._nodes.find(e)};no.prototype.addNode=function(){if(arguments[0]instanceof ew){var e=arguments[0];return this._nodes.addNode(e)}else if(arguments[0]instanceof ht){var t=arguments[0];return this._nodes.addNode(t)}};no.prototype.getNodeIterator=function(){return this._nodes.iterator()};no.prototype.linkResultDirectedEdges=function(){for(var e=this._nodes.iterator();e.hasNext();){var t=e.next();t.getEdges().linkResultDirectedEdges()}};no.prototype.debugPrintln=function(e){Ua.out.println(e)};no.prototype.isBoundaryNode=function(e,t){var i=this._nodes.find(t);if(i===null)return!1;var r=i.getLabel();return r!==null&&r.getLocation(e)===vt.BOUNDARY};no.prototype.linkAllDirectedEdges=function(){for(var e=this._nodes.iterator();e.hasNext();){var t=e.next();t.getEdges().linkAllDirectedEdges()}};no.prototype.matchInSameDirection=function(e,t,i,r){return e.equals(i)?Nn.computeOrientation(e,t,r)===Nn.COLLINEAR&&ps.quadrant(e,t)===ps.quadrant(i,r):!1};no.prototype.getEdgeEnds=function(){return this._edgeEndList};no.prototype.debugPrint=function(e){Ua.out.print(e)};no.prototype.getEdgeIterator=function(){return this._edges.iterator()};no.prototype.findEdgeInSameDirection=function(e,t){for(var i=this,r=0;r<this._edges.size();r++){var a=i._edges.get(r),h=a.getCoordinates();if(i.matchInSameDirection(e,t,h[0],h[1])||i.matchInSameDirection(e,t,h[h.length-1],h[h.length-2]))return a}return null};no.prototype.insertEdge=function(e){this._edges.add(e)};no.prototype.findEdgeEnd=function(e){for(var t=this.getEdgeEnds().iterator();t.hasNext();){var i=t.next();if(i.getEdge()===e)return i}return null};no.prototype.addEdges=function(e){for(var t=this,i=e.iterator();i.hasNext();){var r=i.next();t._edges.add(r);var a=new MT(r,!0),h=new MT(r,!1);a.setSym(h),h.setSym(a),t.add(a),t.add(h)}};no.prototype.add=function(e){this._nodes.add(e),this._edgeEndList.add(e)};no.prototype.getNodes=function(){return this._nodes.values()};no.prototype.findEdge=function(e,t){for(var i=this,r=0;r<this._edges.size();r++){var a=i._edges.get(r),h=a.getCoordinates();if(e.equals(h[0])&&t.equals(h[1]))return a}return null};no.prototype.interfaces_=function(){return[]};no.prototype.getClass=function(){return no};no.linkResultDirectedEdges=function(e){for(var t=e.iterator();t.hasNext();){var i=t.next();i.getEdges().linkResultDirectedEdges()}};var vu=function(){this._geometryFactory=null,this._shellList=new In;var e=arguments[0];this._geometryFactory=e};vu.prototype.sortShellsAndHoles=function(e,t,i){for(var r=e.iterator();r.hasNext();){var a=r.next();a.isHole()?i.add(a):t.add(a)}};vu.prototype.computePolygons=function(e){for(var t=this,i=new In,r=e.iterator();r.hasNext();){var a=r.next(),h=a.toPolygon(t._geometryFactory);i.add(h)}return i};vu.prototype.placeFreeHoles=function(e,t){for(var i=this,r=t.iterator();r.hasNext();){var a=r.next();if(a.getShell()===null){var h=i.findEdgeRingContaining(a,e);if(h===null)throw new rp("unable to assign hole to a shell",a.getCoordinate(0));a.setShell(h)}}};vu.prototype.buildMinimalEdgeRings=function(e,t,i){for(var r=this,a=new In,h=e.iterator();h.hasNext();){var s=h.next();if(s.getMaxNodeDegree()>2){s.linkDirectedEdgesForMinimalEdgeRings();var p=s.buildMinimalRings(),x=r.findShell(p);x!==null?(r.placePolygonHoles(x,p),t.add(x)):i.addAll(p)}else a.add(s)}return a};vu.prototype.containsPoint=function(e){for(var t=this._shellList.iterator();t.hasNext();){var i=t.next();if(i.containsPoint(e))return!0}return!1};vu.prototype.buildMaximalEdgeRings=function(e){for(var t=this,i=new In,r=e.iterator();r.hasNext();){var a=r.next();if(a.isInResult()&&a.getLabel().isArea()&&a.getEdgeRing()===null){var h=new hB(a,t._geometryFactory);i.add(h),h.setInResult()}}return i};vu.prototype.placePolygonHoles=function(e,t){for(var i=t.iterator();i.hasNext();){var r=i.next();r.isHole()&&r.setShell(e)}};vu.prototype.getPolygons=function(){var e=this.computePolygons(this._shellList);return e};vu.prototype.findEdgeRingContaining=function(e,t){for(var i=e.getLinearRing(),r=i.getEnvelopeInternal(),a=i.getCoordinateN(0),h=null,s=null,p=t.iterator();p.hasNext();){var x=p.next(),I=x.getLinearRing(),C=I.getEnvelopeInternal();h!==null&&(s=h.getLinearRing().getEnvelopeInternal());var M=!1;C.contains(r)&&Nn.isPointInRing(a,I.getCoordinates())&&(M=!0),M&&(h===null||s.contains(C))&&(h=x)}return h};vu.prototype.findShell=function(e){for(var t=0,i=null,r=e.iterator();r.hasNext();){var a=r.next();a.isHole()||(i=a,t++)}return Zi.isTrue(t<=1,"found two shells in MinimalEdgeRing list"),i};vu.prototype.add=function(){if(arguments.length===1){var e=arguments[0];this.add(e.getEdgeEnds(),e.getNodes())}else if(arguments.length===2){var t=arguments[0],i=arguments[1];no.linkResultDirectedEdges(i);var r=this.buildMaximalEdgeRings(t),a=new In,h=this.buildMinimalEdgeRings(r,this._shellList,a);this.sortShellsAndHoles(h,this._shellList,a),this.placeFreeHoles(this._shellList,a)}};vu.prototype.interfaces_=function(){return[]};vu.prototype.getClass=function(){return vu};var Cv=function(){};Cv.prototype.getBounds=function(){};Cv.prototype.interfaces_=function(){return[]};Cv.prototype.getClass=function(){return Cv};var _h=function(){this._bounds=null,this._item=null;var e=arguments[0],t=arguments[1];this._bounds=e,this._item=t};_h.prototype.getItem=function(){return this._item};_h.prototype.getBounds=function(){return this._bounds};_h.prototype.interfaces_=function(){return[Cv,Gc]};_h.prototype.getClass=function(){return _h};var sp=function(){this._size=null,this._items=null,this._size=0,this._items=new In,this._items.add(null)};sp.prototype.poll=function(){if(this.isEmpty())return null;var e=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),e};sp.prototype.size=function(){return this._size};sp.prototype.reorder=function(e){for(var t=this,i=null,r=this._items.get(e);e*2<=this._size&&(i=e*2,i!==t._size&&t._items.get(i+1).compareTo(t._items.get(i))<0&&i++,t._items.get(i).compareTo(r)<0);e=i)t._items.set(e,t._items.get(i));this._items.set(e,r)};sp.prototype.clear=function(){this._size=0,this._items.clear()};sp.prototype.isEmpty=function(){return this._size===0};sp.prototype.add=function(e){var t=this;this._items.add(null),this._size+=1;var i=this._size;for(this._items.set(0,e);e.compareTo(this._items.get(Math.trunc(i/2)))<0;i/=2)t._items.set(i,t._items.get(Math.trunc(i/2)));this._items.set(i,e)};sp.prototype.interfaces_=function(){return[]};sp.prototype.getClass=function(){return sp};var Qp=function(){};Qp.prototype.visitItem=function(e){};Qp.prototype.interfaces_=function(){return[]};Qp.prototype.getClass=function(){return Qp};var g_=function(){};g_.prototype.insert=function(e,t){};g_.prototype.remove=function(e,t){};g_.prototype.query=function(){};g_.prototype.interfaces_=function(){return[]};g_.prototype.getClass=function(){return g_};var Qo=function(){if(this._childBoundables=new In,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this._level=e}}},oL={serialVersionUID:{configurable:!0}};Qo.prototype.getLevel=function(){return this._level};Qo.prototype.size=function(){return this._childBoundables.size()};Qo.prototype.getChildBoundables=function(){return this._childBoundables};Qo.prototype.addChildBoundable=function(e){Zi.isTrue(this._bounds===null),this._childBoundables.add(e)};Qo.prototype.isEmpty=function(){return this._childBoundables.isEmpty()};Qo.prototype.getBounds=function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds};Qo.prototype.interfaces_=function(){return[Cv,Gc]};Qo.prototype.getClass=function(){return Qo};oL.serialVersionUID.get=function(){return 6493722185909574e3};Object.defineProperties(Qo,oL);var yh=function(){};yh.reverseOrder=function(){return{compare:function(t,i){return i.compareTo(t)}}};yh.min=function(e){return yh.sort(e),e.get(0)};yh.sort=function(e,t){var i=e.toArray();t?qm.sort(i,t):qm.sort(i);for(var r=e.iterator(),a=0,h=i.length;a<h;a++)r.next(),r.set(i[a])};yh.singletonList=function(e){var t=new In;return t.add(e),t};var ko=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var e=arguments[0],t=arguments[1],i=arguments[2];this._boundable1=e,this._boundable2=t,this._itemDistance=i,this._distance=this.distance()};ko.prototype.expandToQueue=function(e,t){var i=ko.isComposite(this._boundable1),r=ko.isComposite(this._boundable2);if(i&&r)return ko.area(this._boundable1)>ko.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,e,t),null):(this.expand(this._boundable2,this._boundable1,e,t),null);if(i)return this.expand(this._boundable1,this._boundable2,e,t),null;if(r)return this.expand(this._boundable2,this._boundable1,e,t),null;throw new Xs("neither boundable is composite")};ko.prototype.isLeaves=function(){return!(ko.isComposite(this._boundable1)||ko.isComposite(this._boundable2))};ko.prototype.compareTo=function(e){var t=e;return this._distance<t._distance?-1:this._distance>t._distance?1:0};ko.prototype.expand=function(e,t,i,r){for(var a=this,h=e.getChildBoundables(),s=h.iterator();s.hasNext();){var p=s.next(),x=new ko(p,t,a._itemDistance);x.getDistance()<r&&i.add(x)}};ko.prototype.getBoundable=function(e){return e===0?this._boundable1:this._boundable2};ko.prototype.getDistance=function(){return this._distance};ko.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())};ko.prototype.interfaces_=function(){return[Vc]};ko.prototype.getClass=function(){return ko};ko.area=function(e){return e.getBounds().getArea()};ko.isComposite=function(e){return e instanceof Qo};var ba=function n(){if(this._root=null,this._built=!1,this._itemBoundables=new In,this._nodeCapacity=null,arguments.length===0){var e=n.DEFAULT_NODE_CAPACITY;this._nodeCapacity=e}else if(arguments.length===1){var t=arguments[0];Zi.isTrue(t>1,"Node capacity must be greater than 1"),this._nodeCapacity=t}},tw={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};ba.prototype.getNodeCapacity=function(){return this._nodeCapacity};ba.prototype.lastNode=function(e){return e.get(e.size()-1)};ba.prototype.size=function(){var e=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var t=arguments[0],i=0,r=t.getChildBoundables().iterator();r.hasNext();){var a=r.next();a instanceof Qo?i+=e.size(a):a instanceof _h&&(i+=1)}return i}};ba.prototype.removeItem=function(e,t){for(var i=null,r=e.getChildBoundables().iterator();r.hasNext();){var a=r.next();a instanceof _h&&a.getItem()===t&&(i=a)}return i!==null?(e.getChildBoundables().remove(i),!0):!1};ba.prototype.itemsTree=function(){var e=this;if(arguments.length===0){this.build();var t=this.itemsTree(this._root);return t===null?new In:t}else if(arguments.length===1){for(var i=arguments[0],r=new In,a=i.getChildBoundables().iterator();a.hasNext();){var h=a.next();if(h instanceof Qo){var s=e.itemsTree(h);s!==null&&r.add(s)}else h instanceof _h?r.add(h.getItem()):Zi.shouldNeverReachHere()}return r.size()<=0?null:r}};ba.prototype.insert=function(e,t){Zi.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new _h(e,t))};ba.prototype.boundablesAtLevel=function(){var e=this;if(arguments.length===1){var t=arguments[0],i=new In;return this.boundablesAtLevel(t,this._root,i),i}else if(arguments.length===3){var r=arguments[0],a=arguments[1],h=arguments[2];if(Zi.isTrue(r>-2),a.getLevel()===r)return h.add(a),null;for(var s=a.getChildBoundables().iterator();s.hasNext();){var p=s.next();p instanceof Qo?e.boundablesAtLevel(r,p,h):(Zi.isTrue(p instanceof _h),r===-1&&h.add(p))}return null}};ba.prototype.query=function(){var e=this;if(arguments.length===1){var t=arguments[0];this.build();var i=new In;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.query(t,this._root,i),i}else if(arguments.length===2){var r=arguments[0],a=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),r)&&this.query(r,this._root,a)}else if(arguments.length===3){if(Si(arguments[2],Qp)&&arguments[0]instanceof Object&&arguments[1]instanceof Qo)for(var h=arguments[0],s=arguments[1],p=arguments[2],x=s.getChildBoundables(),I=0;I<x.size();I++){var C=x.get(I);e.getIntersectsOp().intersects(C.getBounds(),h)&&(C instanceof Qo?e.query(h,C,p):C instanceof _h?p.visitItem(C.getItem()):Zi.shouldNeverReachHere())}else if(Si(arguments[2],dh)&&arguments[0]instanceof Object&&arguments[1]instanceof Qo)for(var M=arguments[0],O=arguments[1],k=arguments[2],z=O.getChildBoundables(),G=0;G<z.size();G++){var q=z.get(G);e.getIntersectsOp().intersects(q.getBounds(),M)&&(q instanceof Qo?e.query(M,q,k):q instanceof _h?k.add(q.getItem()):Zi.shouldNeverReachHere())}}};ba.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0};ba.prototype.getRoot=function(){return this.build(),this._root};ba.prototype.remove=function(){var e=this;if(arguments.length===2){var t=arguments[0],i=arguments[1];return this.build(),this.getIntersectsOp().intersects(this._root.getBounds(),t)?this.remove(t,this._root,i):!1}else if(arguments.length===3){var r=arguments[0],a=arguments[1],h=arguments[2],s=this.removeItem(a,h);if(s)return!0;for(var p=null,x=a.getChildBoundables().iterator();x.hasNext();){var I=x.next();if(e.getIntersectsOp().intersects(I.getBounds(),r)&&I instanceof Qo&&(s=e.remove(r,I,h),s)){p=I;break}}return p!==null&&p.getChildBoundables().isEmpty()&&a.getChildBoundables().remove(p),s}};ba.prototype.createHigherLevels=function(e,t){Zi.isTrue(!e.isEmpty());var i=this.createParentBoundables(e,t+1);return i.size()===1?i.get(0):this.createHigherLevels(i,t+1)};ba.prototype.depth=function(){var e=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var t=arguments[0],i=0,r=t.getChildBoundables().iterator();r.hasNext();){var a=r.next();if(a instanceof Qo){var h=e.depth(a);h>i&&(i=h)}}return i+1}};ba.prototype.createParentBoundables=function(e,t){var i=this;Zi.isTrue(!e.isEmpty());var r=new In;r.add(this.createNode(t));var a=new In(e);yh.sort(a,this.getComparator());for(var h=a.iterator();h.hasNext();){var s=h.next();i.lastNode(r).getChildBoundables().size()===i.getNodeCapacity()&&r.add(i.createNode(t)),i.lastNode(r).addChildBoundable(s)}return r};ba.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()};ba.prototype.interfaces_=function(){return[Gc]};ba.prototype.getClass=function(){return ba};ba.compareDoubles=function(e,t){return e>t?1:e<t?-1:0};tw.IntersectsOp.get=function(){return fB};tw.serialVersionUID.get=function(){return-3886435814360241e3};tw.DEFAULT_NODE_CAPACITY.get=function(){return 10};Object.defineProperties(ba,tw);var fB=function(){},Av=function(){};Av.prototype.distance=function(e,t){};Av.prototype.interfaces_=function(){return[]};Av.prototype.getClass=function(){return Av};var aL=function(n){function e(i){i=i||e.DEFAULT_NODE_CAPACITY,n.call(this,i)}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return e.prototype.createParentBoundablesFromVerticalSlices=function(r,a){var h=this;Zi.isTrue(r.length>0);for(var s=new In,p=0;p<r.length;p++)s.addAll(h.createParentBoundablesFromVerticalSlice(r[p],a));return s},e.prototype.createNode=function(r){return new t2(r)},e.prototype.size=function(){return arguments.length===0?n.prototype.size.call(this):n.prototype.size.apply(this,arguments)},e.prototype.insert=function(){if(arguments.length===2){var r=arguments[0],a=arguments[1];if(r.isNull())return null;n.prototype.insert.call(this,r,a)}else return n.prototype.insert.apply(this,arguments)},e.prototype.getIntersectsOp=function(){return e.intersectsOp},e.prototype.verticalSlices=function(r,a){for(var h=Math.trunc(Math.ceil(r.size()/a)),s=new Array(a).fill(null),p=r.iterator(),x=0;x<a;x++){s[x]=new In;for(var I=0;p.hasNext()&&I<h;){var C=p.next();s[x].add(C),I++}}return s},e.prototype.query=function(){if(arguments.length===1){var r=arguments[0];return n.prototype.query.call(this,r)}else if(arguments.length===2){var a=arguments[0],h=arguments[1];n.prototype.query.call(this,a,h)}else if(arguments.length===3){if(Si(arguments[2],Qp)&&arguments[0]instanceof Object&&arguments[1]instanceof Qo){var s=arguments[0],p=arguments[1],x=arguments[2];n.prototype.query.call(this,s,p,x)}else if(Si(arguments[2],dh)&&arguments[0]instanceof Object&&arguments[1]instanceof Qo){var I=arguments[0],C=arguments[1],M=arguments[2];n.prototype.query.call(this,I,C,M)}}},e.prototype.getComparator=function(){return e.yComparator},e.prototype.createParentBoundablesFromVerticalSlice=function(r,a){return n.prototype.createParentBoundables.call(this,r,a)},e.prototype.remove=function(){if(arguments.length===2){var r=arguments[0],a=arguments[1];return n.prototype.remove.call(this,r,a)}else return n.prototype.remove.apply(this,arguments)},e.prototype.depth=function(){return arguments.length===0?n.prototype.depth.call(this):n.prototype.depth.apply(this,arguments)},e.prototype.createParentBoundables=function(r,a){Zi.isTrue(!r.isEmpty());var h=Math.trunc(Math.ceil(r.size()/this.getNodeCapacity())),s=new In(r);yh.sort(s,e.xComparator);var p=this.verticalSlices(s,Math.trunc(Math.ceil(Math.sqrt(h))));return this.createParentBoundablesFromVerticalSlices(p,a)},e.prototype.nearestNeighbour=function(){if(arguments.length===1){if(Si(arguments[0],Av)){var r=arguments[0],a=new ko(this.getRoot(),this.getRoot(),r);return this.nearestNeighbour(a)}else if(arguments[0]instanceof ko){var h=arguments[0];return this.nearestNeighbour(h,zi.POSITIVE_INFINITY)}}else if(arguments.length===2){if(arguments[0]instanceof e&&Si(arguments[1],Av)){var s=arguments[0],p=arguments[1],x=new ko(this.getRoot(),s.getRoot(),p);return this.nearestNeighbour(x)}else if(arguments[0]instanceof ko&&typeof arguments[1]=="number"){var I=arguments[0],C=arguments[1],M=C,O=null,k=new sp;for(k.add(I);!k.isEmpty()&&M>0;){var z=k.poll(),G=z.getDistance();if(G>=M)break;z.isLeaves()?(M=G,O=z):z.expandToQueue(k,M)}return[O.getBoundable(0).getItem(),O.getBoundable(1).getItem()]}}else if(arguments.length===3){var q=arguments[0],Z=arguments[1],K=arguments[2],te=new _h(q,Z),ie=new ko(this.getRoot(),te,K);return this.nearestNeighbour(ie)[0]}},e.prototype.interfaces_=function(){return[g_,Gc]},e.prototype.getClass=function(){return e},e.centreX=function(r){return e.avg(r.getMinX(),r.getMaxX())},e.avg=function(r,a){return(r+a)/2},e.centreY=function(r){return e.avg(r.getMinY(),r.getMaxY())},t.STRtreeNode.get=function(){return t2},t.serialVersionUID.get=function(){return 0x39920f7d5f261e0},t.xComparator.get=function(){return{interfaces_:function(){return[yv]},compare:function(i,r){return n.compareDoubles(e.centreX(i.getBounds()),e.centreX(r.getBounds()))}}},t.yComparator.get=function(){return{interfaces_:function(){return[yv]},compare:function(i,r){return n.compareDoubles(e.centreY(i.getBounds()),e.centreY(r.getBounds()))}}},t.intersectsOp.get=function(){return{interfaces_:function(){return[n.IntersectsOp]},intersects:function(i,r){return i.intersects(r)}}},t.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(e,t),e}(ba),t2=function(n){function e(){var t=arguments[0];n.call(this,t)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.computeBounds=function(){for(var i=null,r=this.getChildBoundables().iterator();r.hasNext();){var a=r.next();i===null?i=new li(a.getBounds()):i.expandToInclude(a.getBounds())}return i},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Qo),Wl=function(){};Wl.prototype.interfaces_=function(){return[]};Wl.prototype.getClass=function(){return Wl};Wl.relativeSign=function(e,t){return e<t?-1:e>t?1:0};Wl.compare=function(e,t,i){if(t.equals2D(i))return 0;var r=Wl.relativeSign(t.x,i.x),a=Wl.relativeSign(t.y,i.y);switch(e){case 0:return Wl.compareValue(r,a);case 1:return Wl.compareValue(a,r);case 2:return Wl.compareValue(a,-r);case 3:return Wl.compareValue(-r,a);case 4:return Wl.compareValue(-r,-a);case 5:return Wl.compareValue(-a,-r);case 6:return Wl.compareValue(-a,r);case 7:return Wl.compareValue(r,-a)}return Zi.shouldNeverReachHere("invalid octant value"),0};Wl.compareValue=function(e,t){return e<0?-1:e>0?1:t<0?-1:t>0?1:0};var $p=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var e=arguments[0],t=arguments[1],i=arguments[2],r=arguments[3];this._segString=e,this.coord=new ht(t),this.segmentIndex=i,this._segmentOctant=r,this._isInterior=!t.equals2D(e.getCoordinate(i))};$p.prototype.getCoordinate=function(){return this.coord};$p.prototype.print=function(e){e.print(this.coord),e.print(" seg # = "+this.segmentIndex)};$p.prototype.compareTo=function(e){var t=e;return this.segmentIndex<t.segmentIndex?-1:this.segmentIndex>t.segmentIndex?1:this.coord.equals2D(t.coord)?0:Wl.compare(this._segmentOctant,this.coord,t.coord)};$p.prototype.isEndPoint=function(e){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===e};$p.prototype.isInterior=function(){return this._isInterior};$p.prototype.interfaces_=function(){return[Vc]};$p.prototype.getClass=function(){return $p};var Al=function(){this._nodeMap=new cl,this._edge=null;var e=arguments[0];this._edge=e};Al.prototype.getSplitCoordinates=function(){var e=this,t=new K1;this.addEndpoints();for(var i=this.iterator(),r=i.next();i.hasNext();){var a=i.next();e.addEdgeCoordinates(r,a,t),r=a}return t.toCoordinateArray()};Al.prototype.addCollapsedNodes=function(){var e=this,t=new In;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var i=t.iterator();i.hasNext();){var r=i.next().intValue();e.add(e._edge.getCoordinate(r),r)}};Al.prototype.print=function(e){e.println("Intersections:");for(var t=this.iterator();t.hasNext();){var i=t.next();i.print(e)}};Al.prototype.findCollapsesFromExistingVertices=function(e){for(var t=this,i=0;i<this._edge.size()-2;i++){var r=t._edge.getCoordinate(i),a=t._edge.getCoordinate(i+2);r.equals2D(a)&&e.add(new df(i+1))}};Al.prototype.addEdgeCoordinates=function(e,t,i){var r=this,a=this._edge.getCoordinate(t.segmentIndex),h=t.isInterior()||!t.coord.equals2D(a);i.add(new ht(e.coord),!1);for(var s=e.segmentIndex+1;s<=t.segmentIndex;s++)i.add(r._edge.getCoordinate(s));h&&i.add(new ht(t.coord))};Al.prototype.iterator=function(){return this._nodeMap.values().iterator()};Al.prototype.addSplitEdges=function(e){var t=this;this.addEndpoints(),this.addCollapsedNodes();for(var i=this.iterator(),r=i.next();i.hasNext();){var a=i.next(),h=t.createSplitEdge(r,a);e.add(h),r=a}};Al.prototype.findCollapseIndex=function(e,t,i){if(!e.coord.equals2D(t.coord))return!1;var r=t.segmentIndex-e.segmentIndex;return t.isInterior()||r--,r===1?(i[0]=e.segmentIndex+1,!0):!1};Al.prototype.findCollapsesFromInsertedNodes=function(e){for(var t=this,i=new Array(1).fill(null),r=this.iterator(),a=r.next();r.hasNext();){var h=r.next(),s=t.findCollapseIndex(a,h,i);s&&e.add(new df(i[0])),a=h}};Al.prototype.getEdge=function(){return this._edge};Al.prototype.addEndpoints=function(){var e=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(e),e)};Al.prototype.createSplitEdge=function(e,t){var i=this,r=t.segmentIndex-e.segmentIndex+2,a=this._edge.getCoordinate(t.segmentIndex),h=t.isInterior()||!t.coord.equals2D(a);h||r--;var s=new Array(r).fill(null),p=0;s[p++]=new ht(e.coord);for(var x=e.segmentIndex+1;x<=t.segmentIndex;x++)s[p++]=i._edge.getCoordinate(x);return h&&(s[p]=new ht(t.coord)),new Co(s,this._edge.getData())};Al.prototype.add=function(e,t){var i=new $p(this._edge,e,t,this._edge.getSegmentOctant(t)),r=this._nodeMap.get(i);return r!==null?(Zi.isTrue(r.coord.equals2D(e),"Found equal nodes with different coordinates"),r):(this._nodeMap.put(i,i),i)};Al.prototype.checkSplitEdgesCorrectness=function(e){var t=this._edge.getCoordinates(),i=e.get(0),r=i.getCoordinate(0);if(!r.equals2D(t[0]))throw new np("bad split edge start point at "+r);var a=e.get(e.size()-1),h=a.getCoordinates(),s=h[h.length-1];if(!s.equals2D(t[t.length-1]))throw new np("bad split edge end point at "+s)};Al.prototype.interfaces_=function(){return[]};Al.prototype.getClass=function(){return Al};var __=function(){};__.prototype.interfaces_=function(){return[]};__.prototype.getClass=function(){return __};__.octant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],t=arguments[1];if(e===0&&t===0)throw new Xs("Cannot compute the octant for point ( "+e+", "+t+" )");var i=Math.abs(e),r=Math.abs(t);return e>=0?t>=0?i>=r?0:1:i>=r?7:6:t>=0?i>=r?3:2:i>=r?4:5}else if(arguments[0]instanceof ht&&arguments[1]instanceof ht){var a=arguments[0],h=arguments[1],s=h.x-a.x,p=h.y-a.y;if(s===0&&p===0)throw new Xs("Cannot compute the octant for two identical points "+a);return __.octant(s,p)}};var ld=function(){};ld.prototype.getCoordinates=function(){};ld.prototype.size=function(){};ld.prototype.getCoordinate=function(e){};ld.prototype.isClosed=function(){};ld.prototype.setData=function(e){};ld.prototype.getData=function(){};ld.prototype.interfaces_=function(){return[]};ld.prototype.getClass=function(){return ld};var M1=function(){};M1.prototype.addIntersection=function(e,t){};M1.prototype.interfaces_=function(){return[ld]};M1.prototype.getClass=function(){return M1};var Co=function(){this._nodeList=new Al(this),this._pts=null,this._data=null;var e=arguments[0],t=arguments[1];this._pts=e,this._data=t};Co.prototype.getCoordinates=function(){return this._pts};Co.prototype.size=function(){return this._pts.length};Co.prototype.getCoordinate=function(e){return this._pts[e]};Co.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};Co.prototype.getSegmentOctant=function(e){return e===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(e),this.getCoordinate(e+1))};Co.prototype.setData=function(e){this._data=e};Co.prototype.safeOctant=function(e,t){return e.equals2D(t)?0:__.octant(e,t)};Co.prototype.getData=function(){return this._data};Co.prototype.addIntersection=function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];this.addIntersectionNode(e,t)}else if(arguments.length===4){var i=arguments[0],r=arguments[1],a=arguments[3],h=new ht(i.getIntersection(a));this.addIntersection(h,r)}};Co.prototype.toString=function(){return mh.toLineString(new wo(this._pts))};Co.prototype.getNodeList=function(){return this._nodeList};Co.prototype.addIntersectionNode=function(e,t){var i=t,r=i+1;if(r<this._pts.length){var a=this._pts[r];e.equals2D(a)&&(i=r)}var h=this._nodeList.add(e,i);return h};Co.prototype.addIntersections=function(e,t,i){for(var r=this,a=0;a<e.getIntersectionNum();a++)r.addIntersection(e,t,i,a)};Co.prototype.interfaces_=function(){return[M1]};Co.prototype.getClass=function(){return Co};Co.getNodedSubstrings=function(){if(arguments.length===1){var e=arguments[0],t=new In;return Co.getNodedSubstrings(e,t),t}else if(arguments.length===2)for(var i=arguments[0],r=arguments[1],a=i.iterator();a.hasNext();){var h=a.next();h.getNodeList().addSplitEdges(r)}};var ci=function(){if(this.p0=null,this.p1=null,arguments.length===0)this.p0=new ht,this.p1=new ht;else if(arguments.length===1){var e=arguments[0];this.p0=new ht(e.p0),this.p1=new ht(e.p1)}else if(arguments.length===2)this.p0=arguments[0],this.p1=arguments[1];else if(arguments.length===4){var t=arguments[0],i=arguments[1],r=arguments[2],a=arguments[3];this.p0=new ht(t,i),this.p1=new ht(r,a)}},lL={serialVersionUID:{configurable:!0}};ci.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)};ci.prototype.orientationIndex=function(){if(arguments[0]instanceof ci){var e=arguments[0],t=Nn.orientationIndex(this.p0,this.p1,e.p0),i=Nn.orientationIndex(this.p0,this.p1,e.p1);return t>=0&&i>=0||t<=0&&i<=0?Math.max(t,i):0}else if(arguments[0]instanceof ht){var r=arguments[0];return Nn.orientationIndex(this.p0,this.p1,r)}};ci.prototype.toGeometry=function(e){return e.createLineString([this.p0,this.p1])};ci.prototype.isVertical=function(){return this.p0.x===this.p1.x};ci.prototype.equals=function(e){if(!(e instanceof ci))return!1;var t=e;return this.p0.equals(t.p0)&&this.p1.equals(t.p1)};ci.prototype.intersection=function(e){var t=new fg;return t.computeIntersection(this.p0,this.p1,e.p0,e.p1),t.hasIntersection()?t.getIntersection(0):null};ci.prototype.project=function(){if(arguments[0]instanceof ht){var e=arguments[0];if(e.equals(this.p0)||e.equals(this.p1))return new ht(e);var t=this.projectionFactor(e),i=new ht;return i.x=this.p0.x+t*(this.p1.x-this.p0.x),i.y=this.p0.y+t*(this.p1.y-this.p0.y),i}else if(arguments[0]instanceof ci){var r=arguments[0],a=this.projectionFactor(r.p0),h=this.projectionFactor(r.p1);if(a>=1&&h>=1||a<=0&&h<=0)return null;var s=this.project(r.p0);a<0&&(s=this.p0),a>1&&(s=this.p1);var p=this.project(r.p1);return h<0&&(p=this.p0),h>1&&(p=this.p1),new ci(s,p)}};ci.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()};ci.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)};ci.prototype.getCoordinate=function(e){return e===0?this.p0:this.p1};ci.prototype.distancePerpendicular=function(e){return Nn.distancePointLinePerpendicular(e,this.p0,this.p1)};ci.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)};ci.prototype.midPoint=function(){return ci.midPoint(this.p0,this.p1)};ci.prototype.projectionFactor=function(e){if(e.equals(this.p0))return 0;if(e.equals(this.p1))return 1;var t=this.p1.x-this.p0.x,i=this.p1.y-this.p0.y,r=t*t+i*i;if(r<=0)return zi.NaN;var a=((e.x-this.p0.x)*t+(e.y-this.p0.y)*i)/r;return a};ci.prototype.closestPoints=function(e){var t=this.intersection(e);if(t!==null)return[t,t];var i=new Array(2).fill(null),r=zi.MAX_VALUE,a=null,h=this.closestPoint(e.p0);r=h.distance(e.p0),i[0]=h,i[1]=e.p0;var s=this.closestPoint(e.p1);a=s.distance(e.p1),a<r&&(r=a,i[0]=s,i[1]=e.p1);var p=e.closestPoint(this.p0);a=p.distance(this.p0),a<r&&(r=a,i[0]=this.p0,i[1]=p);var x=e.closestPoint(this.p1);return a=x.distance(this.p1),a<r&&(r=a,i[0]=this.p1,i[1]=x),i};ci.prototype.closestPoint=function(e){var t=this.projectionFactor(e);if(t>0&&t<1)return this.project(e);var i=this.p0.distance(e),r=this.p1.distance(e);return i<r?this.p0:this.p1};ci.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)};ci.prototype.getLength=function(){return this.p0.distance(this.p1)};ci.prototype.compareTo=function(e){var t=e,i=this.p0.compareTo(t.p0);return i!==0?i:this.p1.compareTo(t.p1)};ci.prototype.reverse=function(){var e=this.p0;this.p0=this.p1,this.p1=e};ci.prototype.equalsTopo=function(e){return this.p0.equals(e.p0)&&(this.p1.equals(e.p1)||this.p0.equals(e.p1))&&this.p1.equals(e.p0)};ci.prototype.lineIntersection=function(e){try{var t=fh.intersection(this.p0,this.p1,e.p0,e.p1);return t}catch(i){if(!(i instanceof qv))throw i}finally{}return null};ci.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)};ci.prototype.pointAlongOffset=function(e,t){var i=this.p0.x+e*(this.p1.x-this.p0.x),r=this.p0.y+e*(this.p1.y-this.p0.y),a=this.p1.x-this.p0.x,h=this.p1.y-this.p0.y,s=Math.sqrt(a*a+h*h),p=0,x=0;if(t!==0){if(s<=0)throw new Error("Cannot compute offset from zero-length line segment");p=t*a/s,x=t*h/s}var I=i-x,C=r+p,M=new ht(I,C);return M};ci.prototype.setCoordinates=function(){if(arguments.length===1){var e=arguments[0];this.setCoordinates(e.p0,e.p1)}else if(arguments.length===2){var t=arguments[0],i=arguments[1];this.p0.x=t.x,this.p0.y=t.y,this.p1.x=i.x,this.p1.y=i.y}};ci.prototype.segmentFraction=function(e){var t=this.projectionFactor(e);return t<0?t=0:(t>1||zi.isNaN(t))&&(t=1),t};ci.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"};ci.prototype.isHorizontal=function(){return this.p0.y===this.p1.y};ci.prototype.distance=function(){if(arguments[0]instanceof ci){var e=arguments[0];return Nn.distanceLineLine(this.p0,this.p1,e.p0,e.p1)}else if(arguments[0]instanceof ht){var t=arguments[0];return Nn.distancePointLine(t,this.p0,this.p1)}};ci.prototype.pointAlong=function(e){var t=new ht;return t.x=this.p0.x+e*(this.p1.x-this.p0.x),t.y=this.p0.y+e*(this.p1.y-this.p0.y),t};ci.prototype.hashCode=function(){var e=zi.doubleToLongBits(this.p0.x);e^=zi.doubleToLongBits(this.p0.y)*31;var t=Math.trunc(e)^Math.trunc(e>>32),i=zi.doubleToLongBits(this.p1.x);i^=zi.doubleToLongBits(this.p1.y)*31;var r=Math.trunc(i)^Math.trunc(i>>32);return t^r};ci.prototype.interfaces_=function(){return[Vc,Gc]};ci.prototype.getClass=function(){return ci};ci.midPoint=function(e,t){return new ht((e.x+t.x)/2,(e.y+t.y)/2)};lL.serialVersionUID.get=function(){return 0x2d2172135f411c00};Object.defineProperties(ci,lL);var L1=function(){this.tempEnv1=new li,this.tempEnv2=new li,this._overlapSeg1=new ci,this._overlapSeg2=new ci};L1.prototype.overlap=function(){if(arguments.length!==2){if(arguments.length===4){var e=arguments[0],t=arguments[1],i=arguments[2],r=arguments[3];e.getLineSegment(t,this._overlapSeg1),i.getLineSegment(r,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}};L1.prototype.interfaces_=function(){return[]};L1.prototype.getClass=function(){return L1};var xu=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var e=arguments[0],t=arguments[1],i=arguments[2],r=arguments[3];this._pts=e,this._start=t,this._end=i,this._context=r};xu.prototype.getLineSegment=function(e,t){t.p0=this._pts[e],t.p1=this._pts[e+1]};xu.prototype.computeSelect=function(e,t,i,r){var a=this._pts[t],h=this._pts[i];if(r.tempEnv1.init(a,h),i-t===1)return r.select(this,t),null;if(!e.intersects(r.tempEnv1))return null;var s=Math.trunc((t+i)/2);t<s&&this.computeSelect(e,t,s,r),s<i&&this.computeSelect(e,s,i,r)};xu.prototype.getCoordinates=function(){for(var e=this,t=new Array(this._end-this._start+1).fill(null),i=0,r=this._start;r<=this._end;r++)t[i++]=e._pts[r];return t};xu.prototype.computeOverlaps=function(e,t){this.computeOverlapsInternal(this._start,this._end,e,e._start,e._end,t)};xu.prototype.setId=function(e){this._id=e};xu.prototype.select=function(e,t){this.computeSelect(e,this._start,this._end,t)};xu.prototype.getEnvelope=function(){if(this._env===null){var e=this._pts[this._start],t=this._pts[this._end];this._env=new li(e,t)}return this._env};xu.prototype.getEndIndex=function(){return this._end};xu.prototype.getStartIndex=function(){return this._start};xu.prototype.getContext=function(){return this._context};xu.prototype.getId=function(){return this._id};xu.prototype.computeOverlapsInternal=function(e,t,i,r,a,h){var s=this._pts[e],p=this._pts[t],x=i._pts[r],I=i._pts[a];if(t-e===1&&a-r===1)return h.overlap(this,e,i,r),null;if(h.tempEnv1.init(s,p),h.tempEnv2.init(x,I),!h.tempEnv1.intersects(h.tempEnv2))return null;var C=Math.trunc((e+t)/2),M=Math.trunc((r+a)/2);e<C&&(r<M&&this.computeOverlapsInternal(e,C,i,r,M,h),M<a&&this.computeOverlapsInternal(e,C,i,M,a,h)),C<t&&(r<M&&this.computeOverlapsInternal(C,t,i,r,M,h),M<a&&this.computeOverlapsInternal(C,t,i,M,a,h))};xu.prototype.interfaces_=function(){return[]};xu.prototype.getClass=function(){return xu};var hf=function(){};hf.prototype.interfaces_=function(){return[]};hf.prototype.getClass=function(){return hf};hf.getChainStartIndices=function(e){var t=0,i=new In;i.add(new df(t));do{var r=hf.findChainEnd(e,t);i.add(new df(r)),t=r}while(t<e.length-1);var a=hf.toIntArray(i);return a};hf.findChainEnd=function(e,t){for(var i=t;i<e.length-1&&e[i].equals2D(e[i+1]);)i++;if(i>=e.length-1)return e.length-1;for(var r=ps.quadrant(e[i],e[i+1]),a=t+1;a<e.length;){if(!e[a-1].equals2D(e[a])){var h=ps.quadrant(e[a-1],e[a]);if(h!==r)break}a++}return a-1};hf.getChains=function(){if(arguments.length===1){var e=arguments[0];return hf.getChains(e,null)}else if(arguments.length===2){for(var t=arguments[0],i=arguments[1],r=new In,a=hf.getChainStartIndices(t),h=0;h<a.length-1;h++){var s=new xu(t,a[h],a[h+1],i);r.add(s)}return r}};hf.toIntArray=function(e){for(var t=new Array(e.size()).fill(null),i=0;i<t.length;i++)t[i]=e.get(i).intValue();return t};var $m=function(){};$m.prototype.computeNodes=function(e){};$m.prototype.getNodedSubstrings=function(){};$m.prototype.interfaces_=function(){return[]};$m.prototype.getClass=function(){return $m};var P1=function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this.setSegmentIntersector(e)}}};P1.prototype.setSegmentIntersector=function(e){this._segInt=e};P1.prototype.interfaces_=function(){return[$m]};P1.prototype.getClass=function(){return P1};var wS=function(n){function e(i){i?n.call(this,i):n.call(this),this._monoChains=new In,this._index=new aL,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={SegmentOverlapAction:{configurable:!0}};return e.prototype.getMonotoneChains=function(){return this._monoChains},e.prototype.getNodedSubstrings=function(){return Co.getNodedSubstrings(this._nodedSegStrings)},e.prototype.getIndex=function(){return this._index},e.prototype.add=function(r){for(var a=this,h=hf.getChains(r.getCoordinates(),r),s=h.iterator();s.hasNext();){var p=s.next();p.setId(a._idCounter++),a._index.insert(p.getEnvelope(),p),a._monoChains.add(p)}},e.prototype.computeNodes=function(r){var a=this;this._nodedSegStrings=r;for(var h=r.iterator();h.hasNext();)a.add(h.next());this.intersectChains()},e.prototype.intersectChains=function(){for(var r=this,a=new n2(this._segInt),h=this._monoChains.iterator();h.hasNext();)for(var s=h.next(),p=r._index.query(s.getEnvelope()),x=p.iterator();x.hasNext();){var I=x.next();if(I.getId()>s.getId()&&(s.computeOverlaps(I,a),r._nOverlaps++),r._segInt.isDone())return null}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},t.SegmentOverlapAction.get=function(){return n2},Object.defineProperties(e,t),e}(P1),n2=function(n){function e(){n.call(this),this._si=null;var t=arguments[0];this._si=t}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.overlap=function(){if(arguments.length===4){var i=arguments[0],r=arguments[1],a=arguments[2],h=arguments[3],s=i.getContext(),p=a.getContext();this._si.processIntersections(s,r,p,h)}else return n.prototype.overlap.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(L1),Wr=function n(){if(this._quadrantSegments=n.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=n.CAP_ROUND,this._joinStyle=n.JOIN_ROUND,this._mitreLimit=n.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=n.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this.setQuadrantSegments(e)}else if(arguments.length===2){var t=arguments[0],i=arguments[1];this.setQuadrantSegments(t),this.setEndCapStyle(i)}else if(arguments.length===4){var r=arguments[0],a=arguments[1],h=arguments[2],s=arguments[3];this.setQuadrantSegments(r),this.setEndCapStyle(a),this.setJoinStyle(h),this.setMitreLimit(s)}}},up={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};Wr.prototype.getEndCapStyle=function(){return this._endCapStyle};Wr.prototype.isSingleSided=function(){return this._isSingleSided};Wr.prototype.setQuadrantSegments=function(e){this._quadrantSegments=e,this._quadrantSegments===0&&(this._joinStyle=Wr.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=Wr.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),e<=0&&(this._quadrantSegments=1),this._joinStyle!==Wr.JOIN_ROUND&&(this._quadrantSegments=Wr.DEFAULT_QUADRANT_SEGMENTS)};Wr.prototype.getJoinStyle=function(){return this._joinStyle};Wr.prototype.setJoinStyle=function(e){this._joinStyle=e};Wr.prototype.setSimplifyFactor=function(e){this._simplifyFactor=e<0?0:e};Wr.prototype.getSimplifyFactor=function(){return this._simplifyFactor};Wr.prototype.getQuadrantSegments=function(){return this._quadrantSegments};Wr.prototype.setEndCapStyle=function(e){this._endCapStyle=e};Wr.prototype.getMitreLimit=function(){return this._mitreLimit};Wr.prototype.setMitreLimit=function(e){this._mitreLimit=e};Wr.prototype.setSingleSided=function(e){this._isSingleSided=e};Wr.prototype.interfaces_=function(){return[]};Wr.prototype.getClass=function(){return Wr};Wr.bufferDistanceError=function(e){var t=Math.PI/2/e;return 1-Math.cos(t/2)};up.CAP_ROUND.get=function(){return 1};up.CAP_FLAT.get=function(){return 2};up.CAP_SQUARE.get=function(){return 3};up.JOIN_ROUND.get=function(){return 1};up.JOIN_MITRE.get=function(){return 2};up.JOIN_BEVEL.get=function(){return 3};up.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8};up.DEFAULT_MITRE_LIMIT.get=function(){return 5};up.DEFAULT_SIMPLIFY_FACTOR.get=function(){return .01};Object.defineProperties(Wr,up);var po=function(e){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Nn.COUNTERCLOCKWISE,this._inputLine=e||null},$1={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};po.prototype.isDeletable=function(e,t,i,r){var a=this._inputLine[e],h=this._inputLine[t],s=this._inputLine[i];return!this.isConcave(a,h,s)||!this.isShallow(a,h,s,r)?!1:this.isShallowSampled(a,h,e,i,r)};po.prototype.deleteShallowConcavities=function(){for(var e=this,t=1,i=this.findNextNonDeletedIndex(t),r=this.findNextNonDeletedIndex(i),a=!1;r<this._inputLine.length;){var h=!1;e.isDeletable(t,i,r,e._distanceTol)&&(e._isDeleted[i]=po.DELETE,h=!0,a=!0),h?t=r:t=i,i=e.findNextNonDeletedIndex(t),r=e.findNextNonDeletedIndex(i)}return a};po.prototype.isShallowConcavity=function(e,t,i,r){var a=Nn.computeOrientation(e,t,i),h=a===this._angleOrientation;if(!h)return!1;var s=Nn.distancePointLine(t,e,i);return s<r};po.prototype.isShallowSampled=function(e,t,i,r,a){var h=this,s=Math.trunc((r-i)/po.NUM_PTS_TO_CHECK);s<=0&&(s=1);for(var p=i;p<r;p+=s)if(!h.isShallow(e,t,h._inputLine[p],a))return!1;return!0};po.prototype.isConcave=function(e,t,i){var r=Nn.computeOrientation(e,t,i),a=r===this._angleOrientation;return a};po.prototype.simplify=function(e){var t=this;this._distanceTol=Math.abs(e),e<0&&(this._angleOrientation=Nn.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var i=!1;do i=t.deleteShallowConcavities();while(i);return this.collapseLine()};po.prototype.findNextNonDeletedIndex=function(e){for(var t=e+1;t<this._inputLine.length&&this._isDeleted[t]===po.DELETE;)t++;return t};po.prototype.isShallow=function(e,t,i,r){var a=Nn.distancePointLine(t,e,i);return a<r};po.prototype.collapseLine=function(){for(var e=this,t=new K1,i=0;i<this._inputLine.length;i++)e._isDeleted[i]!==po.DELETE&&t.add(e._inputLine[i]);return t.toCoordinateArray()};po.prototype.interfaces_=function(){return[]};po.prototype.getClass=function(){return po};po.simplify=function(e,t){var i=new po(e);return i.simplify(t)};$1.INIT.get=function(){return 0};$1.DELETE.get=function(){return 1};$1.KEEP.get=function(){return 1};$1.NUM_PTS_TO_CHECK.get=function(){return 10};Object.defineProperties(po,$1);var Ju=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new In},uL={COORDINATE_ARRAY_TYPE:{configurable:!0}};Ju.prototype.getCoordinates=function(){var e=this._ptList.toArray(Ju.COORDINATE_ARRAY_TYPE);return e};Ju.prototype.setPrecisionModel=function(e){this._precisionModel=e};Ju.prototype.addPt=function(e){var t=new ht(e);if(this._precisionModel.makePrecise(t),this.isRedundant(t))return null;this._ptList.add(t)};Ju.prototype.revere=function(){};Ju.prototype.addPts=function(e,t){var i=this;if(t)for(var r=0;r<e.length;r++)i.addPt(e[r]);else for(var a=e.length-1;a>=0;a--)i.addPt(e[a])};Ju.prototype.isRedundant=function(e){if(this._ptList.size()<1)return!1;var t=this._ptList.get(this._ptList.size()-1),i=e.distance(t);return i<this._minimimVertexDistance};Ju.prototype.toString=function(){var e=new mr,t=e.createLineString(this.getCoordinates());return t.toString()};Ju.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var e=new ht(this._ptList.get(0)),t=this._ptList.get(this._ptList.size()-1);if(e.equals(t))return null;this._ptList.add(e)};Ju.prototype.setMinimumVertexDistance=function(e){this._minimimVertexDistance=e};Ju.prototype.interfaces_=function(){return[]};Ju.prototype.getClass=function(){return Ju};uL.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)};Object.defineProperties(Ju,uL);var Tr=function(){},R_={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Tr.prototype.interfaces_=function(){return[]};Tr.prototype.getClass=function(){return Tr};Tr.toDegrees=function(e){return e*180/Math.PI};Tr.normalize=function(e){for(;e>Math.PI;)e-=Tr.PI_TIMES_2;for(;e<=-Math.PI;)e+=Tr.PI_TIMES_2;return e};Tr.angle=function(){if(arguments.length===1){var e=arguments[0];return Math.atan2(e.y,e.x)}else if(arguments.length===2){var t=arguments[0],i=arguments[1],r=i.x-t.x,a=i.y-t.y;return Math.atan2(a,r)}};Tr.isAcute=function(e,t,i){var r=e.x-t.x,a=e.y-t.y,h=i.x-t.x,s=i.y-t.y,p=r*h+a*s;return p>0};Tr.isObtuse=function(e,t,i){var r=e.x-t.x,a=e.y-t.y,h=i.x-t.x,s=i.y-t.y,p=r*h+a*s;return p<0};Tr.interiorAngle=function(e,t,i){var r=Tr.angle(t,e),a=Tr.angle(t,i);return Math.abs(a-r)};Tr.normalizePositive=function(e){if(e<0){for(;e<0;)e+=Tr.PI_TIMES_2;e>=Tr.PI_TIMES_2&&(e=0)}else{for(;e>=Tr.PI_TIMES_2;)e-=Tr.PI_TIMES_2;e<0&&(e=0)}return e};Tr.angleBetween=function(e,t,i){var r=Tr.angle(t,e),a=Tr.angle(t,i);return Tr.diff(r,a)};Tr.diff=function(e,t){var i=null;return e<t?i=t-e:i=e-t,i>Math.PI&&(i=2*Math.PI-i),i};Tr.toRadians=function(e){return e*Math.PI/180};Tr.getTurn=function(e,t){var i=Math.sin(t-e);return i>0?Tr.COUNTERCLOCKWISE:i<0?Tr.CLOCKWISE:Tr.NONE};Tr.angleBetweenOriented=function(e,t,i){var r=Tr.angle(t,e),a=Tr.angle(t,i),h=a-r;return h<=-Math.PI?h+Tr.PI_TIMES_2:h>Math.PI?h-Tr.PI_TIMES_2:h};R_.PI_TIMES_2.get=function(){return 2*Math.PI};R_.PI_OVER_2.get=function(){return Math.PI/2};R_.PI_OVER_4.get=function(){return Math.PI/4};R_.COUNTERCLOCKWISE.get=function(){return Nn.COUNTERCLOCKWISE};R_.CLOCKWISE.get=function(){return Nn.CLOCKWISE};R_.NONE.get=function(){return Nn.COLLINEAR};Object.defineProperties(Tr,R_);var Fs=function n(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new ci,this._seg1=new ci,this._offset0=new ci,this._offset1=new ci,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],t=arguments[1],i=arguments[2];this._precisionModel=e,this._bufParams=t,this._li=new fg,this._filletAngleQuantum=Math.PI/2/t.getQuadrantSegments(),t.getQuadrantSegments()>=8&&t.getJoinStyle()===Wr.JOIN_ROUND&&(this._closingSegLengthFactor=n.MAX_CLOSING_SEG_LEN_FACTOR),this.init(i)},ex={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Fs.prototype.addNextSegment=function(e,t){if(this._s0=this._s1,this._s1=this._s2,this._s2=e,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var i=Nn.computeOrientation(this._s0,this._s1,this._s2),r=i===Nn.CLOCKWISE&&this._side===fn.LEFT||i===Nn.COUNTERCLOCKWISE&&this._side===fn.RIGHT;i===0?this.addCollinear(t):r?this.addOutsideTurn(i,t):this.addInsideTurn(i,t)};Fs.prototype.addLineEndCap=function(e,t){var i=new ci(e,t),r=new ci;this.computeOffsetSegment(i,fn.LEFT,this._distance,r);var a=new ci;this.computeOffsetSegment(i,fn.RIGHT,this._distance,a);var h=t.x-e.x,s=t.y-e.y,p=Math.atan2(s,h);switch(this._bufParams.getEndCapStyle()){case Wr.CAP_ROUND:this._segList.addPt(r.p1),this.addFilletArc(t,p+Math.PI/2,p-Math.PI/2,Nn.CLOCKWISE,this._distance),this._segList.addPt(a.p1);break;case Wr.CAP_FLAT:this._segList.addPt(r.p1),this._segList.addPt(a.p1);break;case Wr.CAP_SQUARE:var x=new ht;x.x=Math.abs(this._distance)*Math.cos(p),x.y=Math.abs(this._distance)*Math.sin(p);var I=new ht(r.p1.x+x.x,r.p1.y+x.y),C=new ht(a.p1.x+x.x,a.p1.y+x.y);this._segList.addPt(I),this._segList.addPt(C);break}};Fs.prototype.getCoordinates=function(){var e=this._segList.getCoordinates();return e};Fs.prototype.addMitreJoin=function(e,t,i,r){var a=!0,h=null;try{h=fh.intersection(t.p0,t.p1,i.p0,i.p1);var s=r<=0?1:h.distance(e)/Math.abs(r);s>this._bufParams.getMitreLimit()&&(a=!1)}catch(p){if(p instanceof qv)h=new ht(0,0),a=!1;else throw p}finally{}a?this._segList.addPt(h):this.addLimitedMitreJoin(t,i,r,this._bufParams.getMitreLimit())};Fs.prototype.addFilletCorner=function(e,t,i,r,a){var h=t.x-e.x,s=t.y-e.y,p=Math.atan2(s,h),x=i.x-e.x,I=i.y-e.y,C=Math.atan2(I,x);r===Nn.CLOCKWISE?p<=C&&(p+=2*Math.PI):p>=C&&(p-=2*Math.PI),this._segList.addPt(t),this.addFilletArc(e,p,C,r,a),this._segList.addPt(i)};Fs.prototype.addOutsideTurn=function(e,t){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Fs.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Wr.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Wr.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(t&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,e,this._distance),this._segList.addPt(this._offset1.p0))};Fs.prototype.createSquare=function(e){this._segList.addPt(new ht(e.x+this._distance,e.y+this._distance)),this._segList.addPt(new ht(e.x+this._distance,e.y-this._distance)),this._segList.addPt(new ht(e.x-this._distance,e.y-this._distance)),this._segList.addPt(new ht(e.x-this._distance,e.y+this._distance)),this._segList.closeRing()};Fs.prototype.addSegments=function(e,t){this._segList.addPts(e,t)};Fs.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)};Fs.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)};Fs.prototype.initSideSegments=function(e,t,i){this._s1=e,this._s2=t,this._side=i,this._seg1.setCoordinates(e,t),this.computeOffsetSegment(this._seg1,i,this._distance,this._offset1)};Fs.prototype.addLimitedMitreJoin=function(e,t,i,r){var a=this._seg0.p1,h=Tr.angle(a,this._seg0.p0),s=Tr.angleBetweenOriented(this._seg0.p0,a,this._seg1.p1),p=s/2,x=Tr.normalize(h+p),I=Tr.normalize(x+Math.PI),C=r*i,M=C*Math.abs(Math.sin(p)),O=i-M,k=a.x+C*Math.cos(I),z=a.y+C*Math.sin(I),G=new ht(k,z),q=new ci(a,G),Z=q.pointAlongOffset(1,O),K=q.pointAlongOffset(1,-O);this._side===fn.LEFT?(this._segList.addPt(Z),this._segList.addPt(K)):(this._segList.addPt(K),this._segList.addPt(Z))};Fs.prototype.computeOffsetSegment=function(e,t,i,r){var a=t===fn.LEFT?1:-1,h=e.p1.x-e.p0.x,s=e.p1.y-e.p0.y,p=Math.sqrt(h*h+s*s),x=a*i*h/p,I=a*i*s/p;r.p0.x=e.p0.x-I,r.p0.y=e.p0.y+x,r.p1.x=e.p1.x-I,r.p1.y=e.p1.y+x};Fs.prototype.addFilletArc=function(e,t,i,r,a){var h=this,s=r===Nn.CLOCKWISE?-1:1,p=Math.abs(t-i),x=Math.trunc(p/this._filletAngleQuantum+.5);if(x<1)return null;for(var I=0,C=p/x,M=I,O=new ht;M<p;){var k=t+s*M;O.x=e.x+a*Math.cos(k),O.y=e.y+a*Math.sin(k),h._segList.addPt(O),M+=C}};Fs.prototype.addInsideTurn=function(e,t){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Fs.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var i=new ht((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(i);var r=new ht((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}};Fs.prototype.createCircle=function(e){var t=new ht(e.x+this._distance,e.y);this._segList.addPt(t),this.addFilletArc(e,0,2*Math.PI,-1,this._distance),this._segList.closeRing()};Fs.prototype.addBevelJoin=function(e,t){this._segList.addPt(e.p1),this._segList.addPt(t.p0)};Fs.prototype.init=function(e){this._distance=e,this._maxCurveSegmentError=e*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Ju,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(e*Fs.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)};Fs.prototype.addCollinear=function(e){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2);var t=this._li.getIntersectionNum();t>=2&&(this._bufParams.getJoinStyle()===Wr.JOIN_BEVEL||this._bufParams.getJoinStyle()===Wr.JOIN_MITRE?(e&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,Nn.CLOCKWISE,this._distance))};Fs.prototype.closeRing=function(){this._segList.closeRing()};Fs.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle};Fs.prototype.interfaces_=function(){return[]};Fs.prototype.getClass=function(){return Fs};ex.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return .001};ex.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return .001};ex.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6};ex.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80};Object.defineProperties(Fs,ex);var Kl=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var e=arguments[0],t=arguments[1];this._precisionModel=e,this._bufParams=t};Kl.prototype.getOffsetCurve=function(e,t){if(this._distance=t,t===0)return null;var i=t<0,r=Math.abs(t),a=this.getSegGen(r);e.length<=1?this.computePointCurve(e[0],a):this.computeOffsetCurve(e,i,a);var h=a.getCoordinates();return i&&gr.reverse(h),h};Kl.prototype.computeSingleSidedBufferCurve=function(e,t,i){var r=this.simplifyTolerance(this._distance);if(t){i.addSegments(e,!0);var a=po.simplify(e,-r),h=a.length-1;i.initSideSegments(a[h],a[h-1],fn.LEFT),i.addFirstSegment();for(var s=h-2;s>=0;s--)i.addNextSegment(a[s],!0)}else{i.addSegments(e,!1);var p=po.simplify(e,r),x=p.length-1;i.initSideSegments(p[0],p[1],fn.LEFT),i.addFirstSegment();for(var I=2;I<=x;I++)i.addNextSegment(p[I],!0)}i.addLastSegment(),i.closeRing()};Kl.prototype.computeRingBufferCurve=function(e,t,i){var r=this.simplifyTolerance(this._distance);t===fn.RIGHT&&(r=-r);var a=po.simplify(e,r),h=a.length-1;i.initSideSegments(a[h-1],a[0],t);for(var s=1;s<=h;s++){var p=s!==1;i.addNextSegment(a[s],p)}i.closeRing()};Kl.prototype.computeLineBufferCurve=function(e,t){var i=this.simplifyTolerance(this._distance),r=po.simplify(e,i),a=r.length-1;t.initSideSegments(r[0],r[1],fn.LEFT);for(var h=2;h<=a;h++)t.addNextSegment(r[h],!0);t.addLastSegment(),t.addLineEndCap(r[a-1],r[a]);var s=po.simplify(e,-i),p=s.length-1;t.initSideSegments(s[p],s[p-1],fn.LEFT);for(var x=p-2;x>=0;x--)t.addNextSegment(s[x],!0);t.addLastSegment(),t.addLineEndCap(s[1],s[0]),t.closeRing()};Kl.prototype.computePointCurve=function(e,t){switch(this._bufParams.getEndCapStyle()){case Wr.CAP_ROUND:t.createCircle(e);break;case Wr.CAP_SQUARE:t.createSquare(e);break}};Kl.prototype.getLineCurve=function(e,t){if(this._distance=t,t<0&&!this._bufParams.isSingleSided()||t===0)return null;var i=Math.abs(t),r=this.getSegGen(i);if(e.length<=1)this.computePointCurve(e[0],r);else if(this._bufParams.isSingleSided()){var a=t<0;this.computeSingleSidedBufferCurve(e,a,r)}else this.computeLineBufferCurve(e,r);var h=r.getCoordinates();return h};Kl.prototype.getBufferParameters=function(){return this._bufParams};Kl.prototype.simplifyTolerance=function(e){return e*this._bufParams.getSimplifyFactor()};Kl.prototype.getRingCurve=function(e,t,i){if(this._distance=i,e.length<=2)return this.getLineCurve(e,i);if(i===0)return Kl.copyCoordinates(e);var r=this.getSegGen(i);return this.computeRingBufferCurve(e,t,r),r.getCoordinates()};Kl.prototype.computeOffsetCurve=function(e,t,i){var r=this.simplifyTolerance(this._distance);if(t){var a=po.simplify(e,-r),h=a.length-1;i.initSideSegments(a[h],a[h-1],fn.LEFT),i.addFirstSegment();for(var s=h-2;s>=0;s--)i.addNextSegment(a[s],!0)}else{var p=po.simplify(e,r),x=p.length-1;i.initSideSegments(p[0],p[1],fn.LEFT),i.addFirstSegment();for(var I=2;I<=x;I++)i.addNextSegment(p[I],!0)}i.addLastSegment()};Kl.prototype.getSegGen=function(e){return new Fs(this._precisionModel,this._bufParams,e)};Kl.prototype.interfaces_=function(){return[]};Kl.prototype.getClass=function(){return Kl};Kl.copyCoordinates=function(e){for(var t=new Array(e.length).fill(null),i=0;i<t.length;i++)t[i]=new ht(e[i]);return t};var y_=function(){this._subgraphs=null,this._seg=new ci,this._cga=new Nn;var e=arguments[0];this._subgraphs=e},cL={DepthSegment:{configurable:!0}};y_.prototype.findStabbedSegments=function(){var e=this;if(arguments.length===1){for(var t=arguments[0],i=new In,r=this._subgraphs.iterator();r.hasNext();){var a=r.next(),h=a.getEnvelope();t.y<h.getMinY()||t.y>h.getMaxY()||e.findStabbedSegments(t,a.getDirectedEdges(),i)}return i}else if(arguments.length===3){if(Si(arguments[2],dh)&&arguments[0]instanceof ht&&arguments[1]instanceof MT)for(var s=arguments[0],p=arguments[1],x=arguments[2],I=p.getEdge().getCoordinates(),C=0;C<I.length-1;C++){e._seg.p0=I[C],e._seg.p1=I[C+1],e._seg.p0.y>e._seg.p1.y&&e._seg.reverse();var M=Math.max(e._seg.p0.x,e._seg.p1.x);if(!(M<s.x)&&!e._seg.isHorizontal()&&!(s.y<e._seg.p0.y||s.y>e._seg.p1.y)&&Nn.computeOrientation(e._seg.p0,e._seg.p1,s)!==Nn.RIGHT){var O=p.getDepth(fn.LEFT);e._seg.p0.equals(I[C])||(O=p.getDepth(fn.RIGHT));var k=new eg(e._seg,O);x.add(k)}}else if(Si(arguments[2],dh)&&arguments[0]instanceof ht&&Si(arguments[1],dh))for(var z=arguments[0],G=arguments[1],q=arguments[2],Z=G.iterator();Z.hasNext();){var K=Z.next();K.isForward()&&e.findStabbedSegments(z,K,q)}}};y_.prototype.getDepth=function(e){var t=this.findStabbedSegments(e);if(t.size()===0)return 0;var i=yh.min(t);return i._leftDepth};y_.prototype.interfaces_=function(){return[]};y_.prototype.getClass=function(){return y_};cL.DepthSegment.get=function(){return eg};Object.defineProperties(y_,cL);var eg=function(){this._upwardSeg=null,this._leftDepth=null;var e=arguments[0],t=arguments[1];this._upwardSeg=new ci(e),this._leftDepth=t};eg.prototype.compareTo=function(e){var t=e;if(this._upwardSeg.minX()>=t._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=t._upwardSeg.minX())return-1;var i=this._upwardSeg.orientationIndex(t._upwardSeg);return i!==0||(i=-1*t._upwardSeg.orientationIndex(this._upwardSeg),i!==0)?i:this._upwardSeg.compareTo(t._upwardSeg)};eg.prototype.compareX=function(e,t){var i=e.p0.compareTo(t.p0);return i!==0?i:e.p1.compareTo(t.p1)};eg.prototype.toString=function(){return this._upwardSeg.toString()};eg.prototype.interfaces_=function(){return[Vc]};eg.prototype.getClass=function(){return eg};var Zr=function(e,t,i){this.p0=e||null,this.p1=t||null,this.p2=i||null};Zr.prototype.area=function(){return Zr.area(this.p0,this.p1,this.p2)};Zr.prototype.signedArea=function(){return Zr.signedArea(this.p0,this.p1,this.p2)};Zr.prototype.interpolateZ=function(e){if(e===null)throw new Xs("Supplied point is null.");return Zr.interpolateZ(e,this.p0,this.p1,this.p2)};Zr.prototype.longestSideLength=function(){return Zr.longestSideLength(this.p0,this.p1,this.p2)};Zr.prototype.isAcute=function(){return Zr.isAcute(this.p0,this.p1,this.p2)};Zr.prototype.circumcentre=function(){return Zr.circumcentre(this.p0,this.p1,this.p2)};Zr.prototype.area3D=function(){return Zr.area3D(this.p0,this.p1,this.p2)};Zr.prototype.centroid=function(){return Zr.centroid(this.p0,this.p1,this.p2)};Zr.prototype.inCentre=function(){return Zr.inCentre(this.p0,this.p1,this.p2)};Zr.prototype.interfaces_=function(){return[]};Zr.prototype.getClass=function(){return Zr};Zr.area=function(e,t,i){return Math.abs(((i.x-e.x)*(t.y-e.y)-(t.x-e.x)*(i.y-e.y))/2)};Zr.signedArea=function(e,t,i){return((i.x-e.x)*(t.y-e.y)-(t.x-e.x)*(i.y-e.y))/2};Zr.det=function(e,t,i,r){return e*r-t*i};Zr.interpolateZ=function(e,t,i,r){var a=t.x,h=t.y,s=i.x-a,p=r.x-a,x=i.y-h,I=r.y-h,C=s*I-p*x,M=e.x-a,O=e.y-h,k=(I*M-p*O)/C,z=(-x*M+s*O)/C,G=t.z+k*(i.z-t.z)+z*(r.z-t.z);return G};Zr.longestSideLength=function(e,t,i){var r=e.distance(t),a=t.distance(i),h=i.distance(e),s=r;return a>s&&(s=a),h>s&&(s=h),s};Zr.isAcute=function(e,t,i){return!(!Tr.isAcute(e,t,i)||!Tr.isAcute(t,i,e)||!Tr.isAcute(i,e,t))};Zr.circumcentre=function(e,t,i){var r=i.x,a=i.y,h=e.x-r,s=e.y-a,p=t.x-r,x=t.y-a,I=2*Zr.det(h,s,p,x),C=Zr.det(s,h*h+s*s,x,p*p+x*x),M=Zr.det(h,h*h+s*s,p,p*p+x*x),O=r-C/I,k=a+M/I;return new ht(O,k)};Zr.perpendicularBisector=function(e,t){var i=t.x-e.x,r=t.y-e.y,a=new fh(e.x+i/2,e.y+r/2,1),h=new fh(e.x-r+i/2,e.y+i+r/2,1);return new fh(a,h)};Zr.angleBisector=function(e,t,i){var r=t.distance(e),a=t.distance(i),h=r/(r+a),s=i.x-e.x,p=i.y-e.y,x=new ht(e.x+h*s,e.y+h*p);return x};Zr.area3D=function(e,t,i){var r=t.x-e.x,a=t.y-e.y,h=t.z-e.z,s=i.x-e.x,p=i.y-e.y,x=i.z-e.z,I=a*x-h*p,C=h*s-r*x,M=r*p-a*s,O=I*I+C*C+M*M,k=Math.sqrt(O)/2;return k};Zr.centroid=function(e,t,i){var r=(e.x+t.x+i.x)/3,a=(e.y+t.y+i.y)/3;return new ht(r,a)};Zr.inCentre=function(e,t,i){var r=t.distance(i),a=e.distance(i),h=e.distance(t),s=r+a+h,p=(r*e.x+a*t.x+h*i.x)/s,x=(r*e.y+a*t.y+h*i.y)/s;return new ht(p,x)};var Fc=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new In;var e=arguments[0],t=arguments[1],i=arguments[2];this._inputGeom=e,this._distance=t,this._curveBuilder=i};Fc.prototype.addPoint=function(e){if(this._distance<=0)return null;var t=e.getCoordinates(),i=this._curveBuilder.getLineCurve(t,this._distance);this.addCurve(i,vt.EXTERIOR,vt.INTERIOR)};Fc.prototype.addPolygon=function(e){var t=this,i=this._distance,r=fn.LEFT;this._distance<0&&(i=-this._distance,r=fn.RIGHT);var a=e.getExteriorRing(),h=gr.removeRepeatedPoints(a.getCoordinates());if(this._distance<0&&this.isErodedCompletely(a,this._distance)||this._distance<=0&&h.length<3)return null;this.addPolygonRing(h,i,r,vt.EXTERIOR,vt.INTERIOR);for(var s=0;s<e.getNumInteriorRing();s++){var p=e.getInteriorRingN(s),x=gr.removeRepeatedPoints(p.getCoordinates());t._distance>0&&t.isErodedCompletely(p,-t._distance)||t.addPolygonRing(x,i,fn.opposite(r),vt.INTERIOR,vt.EXTERIOR)}};Fc.prototype.isTriangleErodedCompletely=function(e,t){var i=new Zr(e[0],e[1],e[2]),r=i.inCentre(),a=Nn.distancePointLine(r,i.p0,i.p1);return a<Math.abs(t)};Fc.prototype.addLineString=function(e){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var t=gr.removeRepeatedPoints(e.getCoordinates()),i=this._curveBuilder.getLineCurve(t,this._distance);this.addCurve(i,vt.EXTERIOR,vt.INTERIOR)};Fc.prototype.addCurve=function(e,t,i){if(e===null||e.length<2)return null;var r=new Co(e,new is(0,vt.BOUNDARY,t,i));this._curveList.add(r)};Fc.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList};Fc.prototype.addPolygonRing=function(e,t,i,r,a){if(t===0&&e.length<od.MINIMUM_VALID_SIZE)return null;var h=r,s=a;e.length>=od.MINIMUM_VALID_SIZE&&Nn.isCCW(e)&&(h=a,s=r,i=fn.opposite(i));var p=this._curveBuilder.getRingCurve(e,i,t);this.addCurve(p,h,s)};Fc.prototype.add=function(e){if(e.isEmpty())return null;e instanceof ea?this.addPolygon(e):e instanceof fo?this.addLineString(e):e instanceof yu?this.addPoint(e):e instanceof Tv?this.addCollection(e):e instanceof Qm?this.addCollection(e):e instanceof td?this.addCollection(e):e instanceof Sl&&this.addCollection(e)};Fc.prototype.isErodedCompletely=function(e,t){var i=e.getCoordinates();if(i.length<4)return t<0;if(i.length===4)return this.isTriangleErodedCompletely(i,t);var r=e.getEnvelopeInternal(),a=Math.min(r.getHeight(),r.getWidth());return t<0&&2*Math.abs(t)>a};Fc.prototype.addCollection=function(e){for(var t=this,i=0;i<e.getNumGeometries();i++){var r=e.getGeometryN(i);t.add(r)}};Fc.prototype.interfaces_=function(){return[]};Fc.prototype.getClass=function(){return Fc};var Mv=function(){};Mv.prototype.locate=function(e){};Mv.prototype.interfaces_=function(){return[]};Mv.prototype.getClass=function(){return Mv};var nd=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var e=arguments[0];this._parent=e,this._atStart=!0,this._index=0,this._max=e.getNumGeometries()};nd.prototype.next=function(){if(this._atStart)return this._atStart=!1,nd.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new Wv;var e=this._parent.getGeometryN(this._index++);return e instanceof Sl?(this._subcollectionIterator=new nd(e),this._subcollectionIterator.next()):e};nd.prototype.remove=function(){throw new Error(this.getClass().getName())};nd.prototype.hasNext=function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)};nd.prototype.interfaces_=function(){return[Hv]};nd.prototype.getClass=function(){return nd};nd.isAtomic=function(e){return!(e instanceof Sl)};var Zu=function(){this._geom=null;var e=arguments[0];this._geom=e};Zu.prototype.locate=function(e){return Zu.locate(e,this._geom)};Zu.prototype.interfaces_=function(){return[Mv]};Zu.prototype.getClass=function(){return Zu};Zu.isPointInRing=function(e,t){return t.getEnvelopeInternal().intersects(e)?Nn.isPointInRing(e,t.getCoordinates()):!1};Zu.containsPointInPolygon=function(e,t){if(t.isEmpty())return!1;var i=t.getExteriorRing();if(!Zu.isPointInRing(e,i))return!1;for(var r=0;r<t.getNumInteriorRing();r++){var a=t.getInteriorRingN(r);if(Zu.isPointInRing(e,a))return!1}return!0};Zu.containsPoint=function(e,t){if(t instanceof ea)return Zu.containsPointInPolygon(e,t);if(t instanceof Sl)for(var i=new nd(t);i.hasNext();){var r=i.next();if(r!==t&&Zu.containsPoint(e,r))return!0}return!1};Zu.locate=function(e,t){return t.isEmpty()?vt.EXTERIOR:Zu.containsPoint(e,t)?vt.INTERIOR:vt.EXTERIOR};var fl=function(){this._edgeMap=new cl,this._edgeList=null,this._ptInAreaLocation=[vt.NONE,vt.NONE]};fl.prototype.getNextCW=function(e){this.getEdges();var t=this._edgeList.indexOf(e),i=t-1;return t===0&&(i=this._edgeList.size()-1),this._edgeList.get(i)};fl.prototype.propagateSideLabels=function(e){for(var t=vt.NONE,i=this.iterator();i.hasNext();){var r=i.next(),a=r.getLabel();a.isArea(e)&&a.getLocation(e,fn.LEFT)!==vt.NONE&&(t=a.getLocation(e,fn.LEFT))}if(t===vt.NONE)return null;for(var h=t,s=this.iterator();s.hasNext();){var p=s.next(),x=p.getLabel();if(x.getLocation(e,fn.ON)===vt.NONE&&x.setLocation(e,fn.ON,h),x.isArea(e)){var I=x.getLocation(e,fn.LEFT),C=x.getLocation(e,fn.RIGHT);if(C!==vt.NONE){if(C!==h)throw new rp("side location conflict",p.getCoordinate());I===vt.NONE&&Zi.shouldNeverReachHere("found single null side (at "+p.getCoordinate()+")"),h=I}else Zi.isTrue(x.getLocation(e,fn.LEFT)===vt.NONE,"found single null side"),x.setLocation(e,fn.RIGHT,h),x.setLocation(e,fn.LEFT,h)}}};fl.prototype.getCoordinate=function(){var e=this.iterator();if(!e.hasNext())return null;var t=e.next();return t.getCoordinate()};fl.prototype.print=function(e){Ua.out.println("EdgeEndStar:   "+this.getCoordinate());for(var t=this.iterator();t.hasNext();){var i=t.next();i.print(e)}};fl.prototype.isAreaLabelsConsistent=function(e){return this.computeEdgeEndLabels(e.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)};fl.prototype.checkAreaLabelsConsistent=function(e){var t=this.getEdges();if(t.size()<=0)return!0;var i=t.size()-1,r=t.get(i).getLabel(),a=r.getLocation(e,fn.LEFT);Zi.isTrue(a!==vt.NONE,"Found unlabelled area edge");for(var h=a,s=this.iterator();s.hasNext();){var p=s.next(),x=p.getLabel();Zi.isTrue(x.isArea(e),"Found non-area edge");var I=x.getLocation(e,fn.LEFT),C=x.getLocation(e,fn.RIGHT);if(I===C||C!==h)return!1;h=I}return!0};fl.prototype.findIndex=function(e){var t=this;this.iterator();for(var i=0;i<this._edgeList.size();i++){var r=t._edgeList.get(i);if(r===e)return i}return-1};fl.prototype.iterator=function(){return this.getEdges().iterator()};fl.prototype.getEdges=function(){return this._edgeList===null&&(this._edgeList=new In(this._edgeMap.values())),this._edgeList};fl.prototype.getLocation=function(e,t,i){return this._ptInAreaLocation[e]===vt.NONE&&(this._ptInAreaLocation[e]=Zu.locate(t,i[e].getGeometry())),this._ptInAreaLocation[e]};fl.prototype.toString=function(){var e=new wf;e.append("EdgeEndStar:   "+this.getCoordinate()),e.append(`
`);for(var t=this.iterator();t.hasNext();){var i=t.next();e.append(i),e.append(`
`)}return e.toString()};fl.prototype.computeEdgeEndLabels=function(e){for(var t=this.iterator();t.hasNext();){var i=t.next();i.computeLabel(e)}};fl.prototype.computeLabelling=function(e){var t=this;this.computeEdgeEndLabels(e[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var i=[!1,!1],r=this.iterator();r.hasNext();)for(var a=r.next(),h=a.getLabel(),s=0;s<2;s++)h.isLine(s)&&h.getLocation(s)===vt.BOUNDARY&&(i[s]=!0);for(var p=this.iterator();p.hasNext();)for(var x=p.next(),I=x.getLabel(),C=0;C<2;C++)if(I.isAnyNull(C)){var M=vt.NONE;if(i[C])M=vt.EXTERIOR;else{var O=x.getCoordinate();M=t.getLocation(C,O,e)}I.setAllLocationsIfNull(C,M)}};fl.prototype.getDegree=function(){return this._edgeMap.size()};fl.prototype.insertEdgeEnd=function(e,t){this._edgeMap.put(e,t),this._edgeList=null};fl.prototype.interfaces_=function(){return[]};fl.prototype.getClass=function(){return fl};var dB=function(n){function e(){n.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.linkResultDirectedEdges=function(){var i=this;this.getResultAreaEdges();for(var r=null,a=null,h=this._SCANNING_FOR_INCOMING,s=0;s<this._resultAreaEdgeList.size();s++){var p=i._resultAreaEdgeList.get(s),x=p.getSym();if(p.getLabel().isArea())switch(r===null&&p.isInResult()&&(r=p),h){case i._SCANNING_FOR_INCOMING:if(!x.isInResult())continue;a=x,h=i._LINKING_TO_OUTGOING;break;case i._LINKING_TO_OUTGOING:if(!p.isInResult())continue;a.setNext(p),h=i._SCANNING_FOR_INCOMING;break}}if(h===this._LINKING_TO_OUTGOING){if(r===null)throw new rp("no outgoing dirEdge found",this.getCoordinate());Zi.isTrue(r.isInResult(),"unable to link last incoming dirEdge"),a.setNext(r)}},e.prototype.insert=function(i){var r=i;this.insertEdgeEnd(r,r)},e.prototype.getRightmostEdge=function(){var i=this.getEdges(),r=i.size();if(r<1)return null;var a=i.get(0);if(r===1)return a;var h=i.get(r-1),s=a.getQuadrant(),p=h.getQuadrant();return ps.isNorthern(s)&&ps.isNorthern(p)?a:!ps.isNorthern(s)&&!ps.isNorthern(p)?h:a.getDy()!==0?a:h.getDy()!==0?h:(Zi.shouldNeverReachHere("found two horizontal edges incident on node"),null)},e.prototype.print=function(i){Ua.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var r=this.iterator();r.hasNext();){var a=r.next();i.print("out "),a.print(i),i.println(),i.print("in "),a.getSym().print(i),i.println()}},e.prototype.getResultAreaEdges=function(){var i=this;if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new In;for(var r=this.iterator();r.hasNext();){var a=r.next();(a.isInResult()||a.getSym().isInResult())&&i._resultAreaEdgeList.add(a)}return this._resultAreaEdgeList},e.prototype.updateLabelling=function(i){for(var r=this.iterator();r.hasNext();){var a=r.next(),h=a.getLabel();h.setAllLocationsIfNull(0,i.getLocation(0)),h.setAllLocationsIfNull(1,i.getLocation(1))}},e.prototype.linkAllDirectedEdges=function(){var i=this;this.getEdges();for(var r=null,a=null,h=this._edgeList.size()-1;h>=0;h--){var s=i._edgeList.get(h),p=s.getSym();a===null&&(a=p),r!==null&&p.setNext(r),r=s}a.setNext(r)},e.prototype.computeDepths=function(){var i=this;if(arguments.length===1){var r=arguments[0],a=this.findIndex(r),h=r.getDepth(fn.LEFT),s=r.getDepth(fn.RIGHT),p=this.computeDepths(a+1,this._edgeList.size(),h),x=this.computeDepths(0,a,p);if(x!==s)throw new rp("depth mismatch at "+r.getCoordinate())}else if(arguments.length===3){for(var I=arguments[0],C=arguments[1],M=arguments[2],O=M,k=I;k<C;k++){var z=i._edgeList.get(k);z.setEdgeDepths(fn.RIGHT,O),O=z.getDepth(fn.LEFT)}return O}},e.prototype.mergeSymLabels=function(){for(var i=this.iterator();i.hasNext();){var r=i.next(),a=r.getLabel();a.merge(r.getSym().getLabel())}},e.prototype.linkMinimalDirectedEdges=function(i){for(var r=this,a=null,h=null,s=this._SCANNING_FOR_INCOMING,p=this._resultAreaEdgeList.size()-1;p>=0;p--){var x=r._resultAreaEdgeList.get(p),I=x.getSym();switch(a===null&&x.getEdgeRing()===i&&(a=x),s){case r._SCANNING_FOR_INCOMING:if(I.getEdgeRing()!==i)continue;h=I,s=r._LINKING_TO_OUTGOING;break;case r._LINKING_TO_OUTGOING:if(x.getEdgeRing()!==i)continue;h.setNextMin(x),s=r._SCANNING_FOR_INCOMING;break}}s===this._LINKING_TO_OUTGOING&&(Zi.isTrue(a!==null,"found null for first outgoing dirEdge"),Zi.isTrue(a.getEdgeRing()===i,"unable to link last incoming dirEdge"),h.setNextMin(a))},e.prototype.getOutgoingDegree=function(){if(arguments.length===0){for(var i=0,r=this.iterator();r.hasNext();){var a=r.next();a.isInResult()&&i++}return i}else if(arguments.length===1){for(var h=arguments[0],s=0,p=this.iterator();p.hasNext();){var x=p.next();x.getEdgeRing()===h&&s++}return s}},e.prototype.getLabel=function(){return this._label},e.prototype.findCoveredLineEdges=function(){for(var i=vt.NONE,r=this.iterator();r.hasNext();){var a=r.next(),h=a.getSym();if(!a.isLineEdge()){if(a.isInResult()){i=vt.INTERIOR;break}if(h.isInResult()){i=vt.EXTERIOR;break}}}if(i===vt.NONE)return null;for(var s=i,p=this.iterator();p.hasNext();){var x=p.next(),I=x.getSym();x.isLineEdge()?x.getEdge().setCovered(s===vt.INTERIOR):(x.isInResult()&&(s=vt.EXTERIOR),I.isInResult()&&(s=vt.INTERIOR))}},e.prototype.computeLabelling=function(i){var r=this;n.prototype.computeLabelling.call(this,i),this._label=new is(vt.NONE);for(var a=this.iterator();a.hasNext();)for(var h=a.next(),s=h.getEdge(),p=s.getLabel(),x=0;x<2;x++){var I=p.getLocation(x);(I===vt.INTERIOR||I===vt.BOUNDARY)&&r._label.setLocation(x,vt.INTERIOR)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(fl),hL=function(n){function e(){n.apply(this,arguments)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.createNode=function(i){return new ew(i,new dB)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Sv),em=function n(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=n.orientation(e)};em.prototype.compareTo=function(e){var t=e,i=em.compareOriented(this._pts,this._orientation,t._pts,t._orientation);return i};em.prototype.interfaces_=function(){return[Vc]};em.prototype.getClass=function(){return em};em.orientation=function(e){return gr.increasingDirection(e)===1};em.compareOriented=function(e,t,i,r){for(var a=t?1:-1,h=r?1:-1,s=t?e.length:-1,p=r?i.length:-1,x=t?0:e.length-1,I=r?0:i.length-1;;){var C=e[x].compareTo(i[I]);if(C!==0)return C;x+=a,I+=h;var M=x===s,O=I===p;if(M&&!O)return-1;if(!M&&O)return 1;if(M&&O)return 0}};var vh=function(){this._edges=new In,this._ocaMap=new cl};vh.prototype.print=function(e){var t=this;e.print("MULTILINESTRING ( ");for(var i=0;i<this._edges.size();i++){var r=t._edges.get(i);i>0&&e.print(","),e.print("(");for(var a=r.getCoordinates(),h=0;h<a.length;h++)h>0&&e.print(","),e.print(a[h].x+" "+a[h].y);e.println(")")}e.print(")  ")};vh.prototype.addAll=function(e){for(var t=this,i=e.iterator();i.hasNext();)t.add(i.next())};vh.prototype.findEdgeIndex=function(e){for(var t=this,i=0;i<this._edges.size();i++)if(t._edges.get(i).equals(e))return i;return-1};vh.prototype.iterator=function(){return this._edges.iterator()};vh.prototype.getEdges=function(){return this._edges};vh.prototype.get=function(e){return this._edges.get(e)};vh.prototype.findEqualEdge=function(e){var t=new em(e.getCoordinates()),i=this._ocaMap.get(t);return i};vh.prototype.add=function(e){this._edges.add(e);var t=new em(e.getCoordinates());this._ocaMap.put(t,e)};vh.prototype.interfaces_=function(){return[]};vh.prototype.getClass=function(){return vh};var tg=function(){};tg.prototype.processIntersections=function(e,t,i,r){};tg.prototype.isDone=function(){};tg.prototype.interfaces_=function(){return[]};tg.prototype.getClass=function(){return tg};var Qu=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var e=arguments[0];this._li=e};Qu.prototype.isTrivialIntersection=function(e,t,i,r){if(e===i&&this._li.getIntersectionNum()===1){if(Qu.isAdjacentSegments(t,r))return!0;if(e.isClosed()){var a=e.size()-1;if(t===0&&r===a||r===0&&t===a)return!0}}return!1};Qu.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};Qu.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};Qu.prototype.getLineIntersector=function(){return this._li};Qu.prototype.hasProperIntersection=function(){return this._hasProper};Qu.prototype.processIntersections=function(e,t,i,r){if(e===i&&t===r)return null;this.numTests++;var a=e.getCoordinates()[t],h=e.getCoordinates()[t+1],s=i.getCoordinates()[r],p=i.getCoordinates()[r+1];this._li.computeIntersection(a,h,s,p),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(e,t,i,r)||(this._hasIntersection=!0,e.addIntersections(this._li,t,0),i.addIntersections(this._li,r,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))};Qu.prototype.hasIntersection=function(){return this._hasIntersection};Qu.prototype.isDone=function(){return!1};Qu.prototype.hasInteriorIntersection=function(){return this._hasInterior};Qu.prototype.interfaces_=function(){return[tg]};Qu.prototype.getClass=function(){return Qu};Qu.isAdjacentSegments=function(e,t){return Math.abs(e-t)===1};var vf=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var e=arguments[0],t=arguments[1],i=arguments[2];this.coord=new ht(e),this.segmentIndex=t,this.dist=i};vf.prototype.getSegmentIndex=function(){return this.segmentIndex};vf.prototype.getCoordinate=function(){return this.coord};vf.prototype.print=function(e){e.print(this.coord),e.print(" seg # = "+this.segmentIndex),e.println(" dist = "+this.dist)};vf.prototype.compareTo=function(e){var t=e;return this.compare(t.segmentIndex,t.dist)};vf.prototype.isEndPoint=function(e){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===e};vf.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist};vf.prototype.getDistance=function(){return this.dist};vf.prototype.compare=function(e,t){return this.segmentIndex<e?-1:this.segmentIndex>e?1:this.dist<t?-1:this.dist>t?1:0};vf.prototype.interfaces_=function(){return[Vc]};vf.prototype.getClass=function(){return vf};var ud=function(){this._nodeMap=new cl,this.edge=null;var e=arguments[0];this.edge=e};ud.prototype.print=function(e){e.println("Intersections:");for(var t=this.iterator();t.hasNext();){var i=t.next();i.print(e)}};ud.prototype.iterator=function(){return this._nodeMap.values().iterator()};ud.prototype.addSplitEdges=function(e){var t=this;this.addEndpoints();for(var i=this.iterator(),r=i.next();i.hasNext();){var a=i.next(),h=t.createSplitEdge(r,a);e.add(h),r=a}};ud.prototype.addEndpoints=function(){var e=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[e],e,0)};ud.prototype.createSplitEdge=function(e,t){var i=this,r=t.segmentIndex-e.segmentIndex+2,a=this.edge.pts[t.segmentIndex],h=t.dist>0||!t.coord.equals2D(a);h||r--;var s=new Array(r).fill(null),p=0;s[p++]=new ht(e.coord);for(var x=e.segmentIndex+1;x<=t.segmentIndex;x++)s[p++]=i.edge.pts[x];return h&&(s[p]=t.coord),new IE(s,new is(this.edge._label))};ud.prototype.add=function(e,t,i){var r=new vf(e,t,i),a=this._nodeMap.get(r);return a!==null?a:(this._nodeMap.put(r,r),r)};ud.prototype.isIntersection=function(e){for(var t=this.iterator();t.hasNext();){var i=t.next();if(i.coord.equals(e))return!0}return!1};ud.prototype.interfaces_=function(){return[]};ud.prototype.getClass=function(){return ud};var ng=function(){};ng.prototype.getChainStartIndices=function(e){var t=this,i=0,r=new In;r.add(new df(i));do{var a=t.findChainEnd(e,i);r.add(new df(a)),i=a}while(i<e.length-1);var h=ng.toIntArray(r);return h};ng.prototype.findChainEnd=function(e,t){for(var i=ps.quadrant(e[t],e[t+1]),r=t+1;r<e.length;){var a=ps.quadrant(e[r-1],e[r]);if(a!==i)break;r++}return r-1};ng.prototype.interfaces_=function(){return[]};ng.prototype.getClass=function(){return ng};ng.toIntArray=function(e){for(var t=new Array(e.size()).fill(null),i=0;i<t.length;i++)t[i]=e.get(i).intValue();return t};var op=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new li,this.env2=new li;var e=arguments[0];this.e=e,this.pts=e.getCoordinates();var t=new ng;this.startIndex=t.getChainStartIndices(this.pts)};op.prototype.getCoordinates=function(){return this.pts};op.prototype.getMaxX=function(e){var t=this.pts[this.startIndex[e]].x,i=this.pts[this.startIndex[e+1]].x;return t>i?t:i};op.prototype.getMinX=function(e){var t=this.pts[this.startIndex[e]].x,i=this.pts[this.startIndex[e+1]].x;return t<i?t:i};op.prototype.computeIntersectsForChain=function(){if(arguments.length===4){var e=arguments[0],t=arguments[1],i=arguments[2],r=arguments[3];this.computeIntersectsForChain(this.startIndex[e],this.startIndex[e+1],t,t.startIndex[i],t.startIndex[i+1],r)}else if(arguments.length===6){var a=arguments[0],h=arguments[1],s=arguments[2],p=arguments[3],x=arguments[4],I=arguments[5],C=this.pts[a],M=this.pts[h],O=s.pts[p],k=s.pts[x];if(h-a===1&&x-p===1)return I.addIntersections(this.e,a,s.e,p),null;if(this.env1.init(C,M),this.env2.init(O,k),!this.env1.intersects(this.env2))return null;var z=Math.trunc((a+h)/2),G=Math.trunc((p+x)/2);a<z&&(p<G&&this.computeIntersectsForChain(a,z,s,p,G,I),G<x&&this.computeIntersectsForChain(a,z,s,G,x,I)),z<h&&(p<G&&this.computeIntersectsForChain(z,h,s,p,G,I),G<x&&this.computeIntersectsForChain(z,h,s,G,x,I))}};op.prototype.getStartIndexes=function(){return this.startIndex};op.prototype.computeIntersects=function(e,t){for(var i=this,r=0;r<this.startIndex.length-1;r++)for(var a=0;a<e.startIndex.length-1;a++)i.computeIntersectsForChain(r,e,a,t)};op.prototype.interfaces_=function(){return[]};op.prototype.getClass=function(){return op};var Ba=function n(){var e=this;this._depth=Array(2).fill().map(function(){return Array(3)});for(var t=0;t<2;t++)for(var i=0;i<3;i++)e._depth[t][i]=n.NULL_VALUE},fL={NULL_VALUE:{configurable:!0}};Ba.prototype.getDepth=function(e,t){return this._depth[e][t]};Ba.prototype.setDepth=function(e,t,i){this._depth[e][t]=i};Ba.prototype.isNull=function(){var e=this;if(arguments.length===0){for(var t=0;t<2;t++)for(var i=0;i<3;i++)if(e._depth[t][i]!==Ba.NULL_VALUE)return!1;return!0}else if(arguments.length===1){var r=arguments[0];return this._depth[r][1]===Ba.NULL_VALUE}else if(arguments.length===2){var a=arguments[0],h=arguments[1];return this._depth[a][h]===Ba.NULL_VALUE}};Ba.prototype.normalize=function(){for(var e=this,t=0;t<2;t++)if(!e.isNull(t)){var i=e._depth[t][1];e._depth[t][2]<i&&(i=e._depth[t][2]),i<0&&(i=0);for(var r=1;r<3;r++){var a=0;e._depth[t][r]>i&&(a=1),e._depth[t][r]=a}}};Ba.prototype.getDelta=function(e){return this._depth[e][fn.RIGHT]-this._depth[e][fn.LEFT]};Ba.prototype.getLocation=function(e,t){return this._depth[e][t]<=0?vt.EXTERIOR:vt.INTERIOR};Ba.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]};Ba.prototype.add=function(){var e=this;if(arguments.length===1)for(var t=arguments[0],i=0;i<2;i++)for(var r=1;r<3;r++){var a=t.getLocation(i,r);(a===vt.EXTERIOR||a===vt.INTERIOR)&&(e.isNull(i,r)?e._depth[i][r]=Ba.depthAtLocation(a):e._depth[i][r]+=Ba.depthAtLocation(a))}else if(arguments.length===3){var h=arguments[0],s=arguments[1],p=arguments[2];p===vt.INTERIOR&&this._depth[h][s]++}};Ba.prototype.interfaces_=function(){return[]};Ba.prototype.getClass=function(){return Ba};Ba.depthAtLocation=function(e){return e===vt.EXTERIOR?0:e===vt.INTERIOR?1:Ba.NULL_VALUE};fL.NULL_VALUE.get=function(){return-1};Object.defineProperties(Ba,fL);var IE=function(n){function e(){if(n.call(this),this.pts=null,this._env=null,this.eiList=new ud(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Ba,this._depthDelta=0,arguments.length===1){var t=arguments[0];e.call(this,t,null)}else if(arguments.length===2){var i=arguments[0],r=arguments[1];this.pts=i,this._label=r}}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.getDepth=function(){return this._depth},e.prototype.getCollapsedEdge=function(){var i=new Array(2).fill(null);i[0]=this.pts[0],i[1]=this.pts[1];var r=new e(i,is.toLineLabel(this._label));return r},e.prototype.isIsolated=function(){return this._isIsolated},e.prototype.getCoordinates=function(){return this.pts},e.prototype.setIsolated=function(i){this._isIsolated=i},e.prototype.setName=function(i){this._name=i},e.prototype.equals=function(i){var r=this;if(!(i instanceof e))return!1;var a=i;if(this.pts.length!==a.pts.length)return!1;for(var h=!0,s=!0,p=this.pts.length,x=0;x<this.pts.length;x++)if(r.pts[x].equals2D(a.pts[x])||(h=!1),r.pts[x].equals2D(a.pts[--p])||(s=!1),!h&&!s)return!1;return!0},e.prototype.getCoordinate=function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var i=arguments[0];return this.pts[i]}},e.prototype.print=function(i){var r=this;i.print("edge "+this._name+": "),i.print("LINESTRING (");for(var a=0;a<this.pts.length;a++)a>0&&i.print(","),i.print(r.pts[a].x+" "+r.pts[a].y);i.print(")  "+this._label+" "+this._depthDelta)},e.prototype.computeIM=function(i){e.updateIM(this._label,i)},e.prototype.isCollapsed=function(){return!this._label.isArea()||this.pts.length!==3?!1:!!this.pts[0].equals(this.pts[2])},e.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},e.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},e.prototype.getDepthDelta=function(){return this._depthDelta},e.prototype.getNumPoints=function(){return this.pts.length},e.prototype.printReverse=function(i){var r=this;i.print("edge "+this._name+": ");for(var a=this.pts.length-1;a>=0;a--)i.print(r.pts[a]+" ");i.println("")},e.prototype.getMonotoneChainEdge=function(){return this._mce===null&&(this._mce=new op(this)),this._mce},e.prototype.getEnvelope=function(){var i=this;if(this._env===null){this._env=new li;for(var r=0;r<this.pts.length;r++)i._env.expandToInclude(i.pts[r])}return this._env},e.prototype.addIntersection=function(i,r,a,h){var s=new ht(i.getIntersection(h)),p=r,x=i.getEdgeDistance(a,h),I=p+1;if(I<this.pts.length){var C=this.pts[I];s.equals2D(C)&&(p=I,x=0)}this.eiList.add(s,p,x)},e.prototype.toString=function(){var i=this,r=new wf;r.append("edge "+this._name+": "),r.append("LINESTRING (");for(var a=0;a<this.pts.length;a++)a>0&&r.append(","),r.append(i.pts[a].x+" "+i.pts[a].y);return r.append(")  "+this._label+" "+this._depthDelta),r.toString()},e.prototype.isPointwiseEqual=function(i){var r=this;if(this.pts.length!==i.pts.length)return!1;for(var a=0;a<this.pts.length;a++)if(!r.pts[a].equals2D(i.pts[a]))return!1;return!0},e.prototype.setDepthDelta=function(i){this._depthDelta=i},e.prototype.getEdgeIntersectionList=function(){return this.eiList},e.prototype.addIntersections=function(i,r,a){for(var h=this,s=0;s<i.getIntersectionNum();s++)h.addIntersection(i,r,a,s)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.updateIM=function(){if(arguments.length===2){var i=arguments[0],r=arguments[1];r.setAtLeastIfValid(i.getLocation(0,fn.ON),i.getLocation(1,fn.ON),1),i.isArea()&&(r.setAtLeastIfValid(i.getLocation(0,fn.LEFT),i.getLocation(1,fn.LEFT),2),r.setAtLeastIfValid(i.getLocation(0,fn.RIGHT),i.getLocation(1,fn.RIGHT),2))}else return n.prototype.updateIM.apply(this,arguments)},e}(Ku),Il=function(e){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new vh,this._bufParams=e||null};Il.prototype.setWorkingPrecisionModel=function(e){this._workingPrecisionModel=e};Il.prototype.insertUniqueEdge=function(e){var t=this._edgeList.findEqualEdge(e);if(t!==null){var i=t.getLabel(),r=e.getLabel();t.isPointwiseEqual(e)||(r=new is(e.getLabel()),r.flip()),i.merge(r);var a=Il.depthDelta(r),h=t.getDepthDelta(),s=h+a;t.setDepthDelta(s)}else this._edgeList.add(e),e.setDepthDelta(Il.depthDelta(e.getLabel()))};Il.prototype.buildSubgraphs=function(e,t){for(var i=new In,r=e.iterator();r.hasNext();){var a=r.next(),h=a.getRightmostCoordinate(),s=new y_(i),p=s.getDepth(h);a.computeDepth(p),a.findResultEdges(),i.add(a),t.add(a.getDirectedEdges(),a.getNodes())}};Il.prototype.createSubgraphs=function(e){for(var t=new In,i=e.getNodes().iterator();i.hasNext();){var r=i.next();if(!r.isVisited()){var a=new Cl;a.create(r),t.add(a)}}return yh.sort(t,yh.reverseOrder()),t};Il.prototype.createEmptyResultGeometry=function(){var e=this._geomFact.createPolygon();return e};Il.prototype.getNoder=function(e){if(this._workingNoder!==null)return this._workingNoder;var t=new wS,i=new fg;return i.setPrecisionModel(e),t.setSegmentIntersector(new Qu(i)),t};Il.prototype.buffer=function(e,t){var i=this._workingPrecisionModel;i===null&&(i=e.getPrecisionModel()),this._geomFact=e.getFactory();var r=new Kl(i,this._bufParams),a=new Fc(e,t,r),h=a.getCurves();if(h.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(h,i),this._graph=new no(new hL),this._graph.addEdges(this._edgeList.getEdges());var s=this.createSubgraphs(this._graph),p=new vu(this._geomFact);this.buildSubgraphs(s,p);var x=p.getPolygons();if(x.size()<=0)return this.createEmptyResultGeometry();var I=this._geomFact.buildGeometry(x);return I};Il.prototype.computeNodedEdges=function(e,t){var i=this,r=this.getNoder(t);r.computeNodes(e);for(var a=r.getNodedSubstrings(),h=a.iterator();h.hasNext();){var s=h.next(),p=s.getCoordinates();if(!(p.length===2&&p[0].equals2D(p[1]))){var x=s.getData(),I=new IE(s.getCoordinates(),new is(x));i.insertUniqueEdge(I)}}};Il.prototype.setNoder=function(e){this._workingNoder=e};Il.prototype.interfaces_=function(){return[]};Il.prototype.getClass=function(){return Il};Il.depthDelta=function(e){var t=e.getLocation(0,fn.LEFT),i=e.getLocation(0,fn.RIGHT);return t===vt.INTERIOR&&i===vt.EXTERIOR?1:t===vt.EXTERIOR&&i===vt.INTERIOR?-1:0};Il.convertSegStrings=function(e){for(var t=new mr,i=new In;e.hasNext();){var r=e.next(),a=t.createLineString(r.getCoordinates());i.add(a)}return t.buildGeometry(i)};var tm=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var e=arguments[0],t=arguments[1];this._noder=e,this._scaleFactor=t,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(arguments.length===4){var i=arguments[0],r=arguments[1],a=arguments[2],h=arguments[3];this._noder=i,this._scaleFactor=r,this._offsetX=a,this._offsetY=h,this._isScaled=!this.isIntegerPrecision()}};tm.prototype.rescale=function(){var e=this;if(Si(arguments[0],Yo))for(var t=arguments[0],i=t.iterator();i.hasNext();){var r=i.next();e.rescale(r.getCoordinates())}else if(arguments[0]instanceof Array){for(var a=arguments[0],h=0;h<a.length;h++)a[h].x=a[h].x/e._scaleFactor+e._offsetX,a[h].y=a[h].y/e._scaleFactor+e._offsetY;a.length===2&&a[0].equals2D(a[1])&&Ua.out.println(a)}};tm.prototype.scale=function(){var e=this;if(Si(arguments[0],Yo)){for(var t=arguments[0],i=new In,r=t.iterator();r.hasNext();){var a=r.next();i.add(new Co(e.scale(a.getCoordinates()),a.getData()))}return i}else if(arguments[0]instanceof Array){for(var h=arguments[0],s=new Array(h.length).fill(null),p=0;p<h.length;p++)s[p]=new ht(Math.round((h[p].x-e._offsetX)*e._scaleFactor),Math.round((h[p].y-e._offsetY)*e._scaleFactor),h[p].z);var x=gr.removeRepeatedPoints(s);return x}};tm.prototype.isIntegerPrecision=function(){return this._scaleFactor===1};tm.prototype.getNodedSubstrings=function(){var e=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(e),e};tm.prototype.computeNodes=function(e){var t=e;this._isScaled&&(t=this.scale(e)),this._noder.computeNodes(t)};tm.prototype.interfaces_=function(){return[$m]};tm.prototype.getClass=function(){return tm};var xf=function(){this._li=new fg,this._segStrings=null;var e=arguments[0];this._segStrings=e},dL={fact:{configurable:!0}};xf.prototype.checkEndPtVertexIntersections=function(){var e=this;if(arguments.length===0)for(var t=this._segStrings.iterator();t.hasNext();){var i=t.next(),r=i.getCoordinates();e.checkEndPtVertexIntersections(r[0],e._segStrings),e.checkEndPtVertexIntersections(r[r.length-1],e._segStrings)}else if(arguments.length===2){for(var a=arguments[0],h=arguments[1],s=h.iterator();s.hasNext();)for(var p=s.next(),x=p.getCoordinates(),I=1;I<x.length-1;I++)if(x[I].equals(a))throw new np("found endpt/interior pt intersection at index "+I+" :pt "+a)}};xf.prototype.checkInteriorIntersections=function(){var e=this;if(arguments.length===0)for(var t=this._segStrings.iterator();t.hasNext();)for(var i=t.next(),r=this._segStrings.iterator();r.hasNext();){var a=r.next();e.checkInteriorIntersections(i,a)}else if(arguments.length===2)for(var h=arguments[0],s=arguments[1],p=h.getCoordinates(),x=s.getCoordinates(),I=0;I<p.length-1;I++)for(var C=0;C<x.length-1;C++)e.checkInteriorIntersections(h,I,s,C);else if(arguments.length===4){var M=arguments[0],O=arguments[1],k=arguments[2],z=arguments[3];if(M===k&&O===z)return null;var G=M.getCoordinates()[O],q=M.getCoordinates()[O+1],Z=k.getCoordinates()[z],K=k.getCoordinates()[z+1];if(this._li.computeIntersection(G,q,Z,K),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,G,q)||this.hasInteriorIntersection(this._li,Z,K)))throw new np("found non-noded intersection at "+G+"-"+q+" and "+Z+"-"+K)}};xf.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()};xf.prototype.checkCollapses=function(){var e=this;if(arguments.length===0)for(var t=this._segStrings.iterator();t.hasNext();){var i=t.next();e.checkCollapses(i)}else if(arguments.length===1)for(var r=arguments[0],a=r.getCoordinates(),h=0;h<a.length-2;h++)e.checkCollapse(a[h],a[h+1],a[h+2])};xf.prototype.hasInteriorIntersection=function(e,t,i){for(var r=0;r<e.getIntersectionNum();r++){var a=e.getIntersection(r);if(!(a.equals(t)||a.equals(i)))return!0}return!1};xf.prototype.checkCollapse=function(e,t,i){if(e.equals(i))throw new np("found non-noded collapse at "+xf.fact.createLineString([e,t,i]))};xf.prototype.interfaces_=function(){return[]};xf.prototype.getClass=function(){return xf};dL.fact.get=function(){return new mr};Object.defineProperties(xf,dL);var Jl=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var e=arguments[0],t=arguments[1],i=arguments[2];if(this._originalPt=e,this._pt=e,this._scaleFactor=t,this._li=i,t<=0)throw new Xs("Scale factor must be non-zero");t!==1&&(this._pt=new ht(this.scale(e.x),this.scale(e.y)),this._p0Scaled=new ht,this._p1Scaled=new ht),this.initCorners(this._pt)},pL={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};Jl.prototype.intersectsScaled=function(e,t){var i=Math.min(e.x,t.x),r=Math.max(e.x,t.x),a=Math.min(e.y,t.y),h=Math.max(e.y,t.y),s=this._maxx<i||this._minx>r||this._maxy<a||this._miny>h;if(s)return!1;var p=this.intersectsToleranceSquare(e,t);return Zi.isTrue(!(s&&p),"Found bad envelope test"),p};Jl.prototype.initCorners=function(e){var t=.5;this._minx=e.x-t,this._maxx=e.x+t,this._miny=e.y-t,this._maxy=e.y+t,this._corner[0]=new ht(this._maxx,this._maxy),this._corner[1]=new ht(this._minx,this._maxy),this._corner[2]=new ht(this._minx,this._miny),this._corner[3]=new ht(this._maxx,this._miny)};Jl.prototype.intersects=function(e,t){return this._scaleFactor===1?this.intersectsScaled(e,t):(this.copyScaled(e,this._p0Scaled),this.copyScaled(t,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))};Jl.prototype.scale=function(e){return Math.round(e*this._scaleFactor)};Jl.prototype.getCoordinate=function(){return this._originalPt};Jl.prototype.copyScaled=function(e,t){t.x=this.scale(e.x),t.y=this.scale(e.y)};Jl.prototype.getSafeEnvelope=function(){if(this._safeEnv===null){var e=Jl.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new li(this._originalPt.x-e,this._originalPt.x+e,this._originalPt.y-e,this._originalPt.y+e)}return this._safeEnv};Jl.prototype.intersectsPixelClosure=function(e,t){return this._li.computeIntersection(e,t,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(e,t,this._corner[1],this._corner[2]),this._li.hasIntersection())||(this._li.computeIntersection(e,t,this._corner[2],this._corner[3]),this._li.hasIntersection())||(this._li.computeIntersection(e,t,this._corner[3],this._corner[0]),this._li.hasIntersection()))};Jl.prototype.intersectsToleranceSquare=function(e,t){var i=!1,r=!1;return this._li.computeIntersection(e,t,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(e,t,this._corner[1],this._corner[2]),this._li.isProper())||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(e,t,this._corner[2],this._corner[3]),this._li.isProper())||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(e,t,this._corner[3],this._corner[0]),this._li.isProper())||i&&r||e.equals(this._pt)||t.equals(this._pt))};Jl.prototype.addSnappedNode=function(e,t){var i=e.getCoordinate(t),r=e.getCoordinate(t+1);return this.intersects(i,r)?(e.addIntersection(this.getCoordinate(),t),!0):!1};Jl.prototype.interfaces_=function(){return[]};Jl.prototype.getClass=function(){return Jl};pL.SAFE_ENV_EXPANSION_FACTOR.get=function(){return .75};Object.defineProperties(Jl,pL);var R1=function(){this.tempEnv1=new li,this.selectedSegment=new ci};R1.prototype.select=function(){if(arguments.length!==1){if(arguments.length===2){var e=arguments[0],t=arguments[1];e.getLineSegment(t,this.selectedSegment),this.select(this.selectedSegment)}}};R1.prototype.interfaces_=function(){return[]};R1.prototype.getClass=function(){return R1};var Lv=function(){this._index=null;var e=arguments[0];this._index=e},mL={HotPixelSnapAction:{configurable:!0}};Lv.prototype.snap=function(){if(arguments.length===1){var e=arguments[0];return this.snap(e,null,-1)}else if(arguments.length===3){var t=arguments[0],i=arguments[1],r=arguments[2],a=t.getSafeEnvelope(),h=new gL(t,i,r);return this._index.query(a,{interfaces_:function(){return[Qp]},visitItem:function(s){var p=s;p.select(a,h)}}),h.isNodeAdded()}};Lv.prototype.interfaces_=function(){return[]};Lv.prototype.getClass=function(){return Lv};mL.HotPixelSnapAction.get=function(){return gL};Object.defineProperties(Lv,mL);var gL=function(n){function e(){n.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var t=arguments[0],i=arguments[1],r=arguments[2];this._hotPixel=t,this._parentEdge=i,this._hotPixelVertexIndex=r}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.isNodeAdded=function(){return this._isNodeAdded},e.prototype.select=function(){if(arguments.length===2){var i=arguments[0],r=arguments[1],a=i.getContext();if(this._parentEdge!==null&&a===this._parentEdge&&r===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(a,r)}else return n.prototype.select.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(R1),v_=function(){this._li=null,this._interiorIntersections=null;var e=arguments[0];this._li=e,this._interiorIntersections=new In};v_.prototype.processIntersections=function(e,t,i,r){var a=this;if(e===i&&t===r)return null;var h=e.getCoordinates()[t],s=e.getCoordinates()[t+1],p=i.getCoordinates()[r],x=i.getCoordinates()[r+1];if(this._li.computeIntersection(h,s,p,x),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var I=0;I<this._li.getIntersectionNum();I++)a._interiorIntersections.add(a._li.getIntersection(I));e.addIntersections(this._li,t,0),i.addIntersections(this._li,r,1)}};v_.prototype.isDone=function(){return!1};v_.prototype.getInteriorIntersections=function(){return this._interiorIntersections};v_.prototype.interfaces_=function(){return[tg]};v_.prototype.getClass=function(){return v_};var cd=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var e=arguments[0];this._pm=e,this._li=new fg,this._li.setPrecisionModel(e),this._scaleFactor=e.getScale()};cd.prototype.checkCorrectness=function(e){var t=Co.getNodedSubstrings(e),i=new xf(t);try{i.checkValid()}catch(r){if(r instanceof $M)r.printStackTrace();else throw r}finally{}};cd.prototype.getNodedSubstrings=function(){return Co.getNodedSubstrings(this._nodedSegStrings)};cd.prototype.snapRound=function(e,t){var i=this.findInteriorIntersections(e,t);this.computeIntersectionSnaps(i),this.computeVertexSnaps(e)};cd.prototype.findInteriorIntersections=function(e,t){var i=new v_(t);return this._noder.setSegmentIntersector(i),this._noder.computeNodes(e),i.getInteriorIntersections()};cd.prototype.computeVertexSnaps=function(){var e=this;if(Si(arguments[0],Yo))for(var t=arguments[0],i=t.iterator();i.hasNext();){var r=i.next();e.computeVertexSnaps(r)}else if(arguments[0]instanceof Co)for(var a=arguments[0],h=a.getCoordinates(),s=0;s<h.length;s++){var p=new Jl(h[s],e._scaleFactor,e._li),x=e._pointSnapper.snap(p,a,s);x&&a.addIntersection(h[s],s)}};cd.prototype.computeNodes=function(e){this._nodedSegStrings=e,this._noder=new wS,this._pointSnapper=new Lv(this._noder.getIndex()),this.snapRound(e,this._li)};cd.prototype.computeIntersectionSnaps=function(e){for(var t=this,i=e.iterator();i.hasNext();){var r=i.next(),a=new Jl(r,t._scaleFactor,t._li);t._pointSnapper.snap(a)}};cd.prototype.interfaces_=function(){return[$m]};cd.prototype.getClass=function(){return cd};var Fa=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new Wr,this._resultGeometry=null,this._saveException=null,arguments.length===1){var e=arguments[0];this._argGeom=e}else if(arguments.length===2){var t=arguments[0],i=arguments[1];this._argGeom=t,this._bufParams=i}},Xv={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};Fa.prototype.bufferFixedPrecision=function(e){var t=new tm(new cd(new Xr(1)),e.getScale()),i=new Il(this._bufParams);i.setWorkingPrecisionModel(e),i.setNoder(t),this._resultGeometry=i.buffer(this._argGeom,this._distance)};Fa.prototype.bufferReducedPrecision=function(){var e=this;if(arguments.length===0){for(var t=Fa.MAX_PRECISION_DIGITS;t>=0;t--){try{e.bufferReducedPrecision(t)}catch(h){if(h instanceof rp)e._saveException=h;else throw h}finally{}if(e._resultGeometry!==null)return null}throw this._saveException}else if(arguments.length===1){var i=arguments[0],r=Fa.precisionScaleFactor(this._argGeom,this._distance,i),a=new Xr(r);this.bufferFixedPrecision(a)}};Fa.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var e=this._argGeom.getFactory().getPrecisionModel();e.getType()===Xr.FIXED?this.bufferFixedPrecision(e):this.bufferReducedPrecision()};Fa.prototype.setQuadrantSegments=function(e){this._bufParams.setQuadrantSegments(e)};Fa.prototype.bufferOriginalPrecision=function(){try{var e=new Il(this._bufParams);this._resultGeometry=e.buffer(this._argGeom,this._distance)}catch(t){if(t instanceof np)this._saveException=t;else throw t}finally{}};Fa.prototype.getResultGeometry=function(e){return this._distance=e,this.computeGeometry(),this._resultGeometry};Fa.prototype.setEndCapStyle=function(e){this._bufParams.setEndCapStyle(e)};Fa.prototype.interfaces_=function(){return[]};Fa.prototype.getClass=function(){return Fa};Fa.bufferOp=function(){if(arguments.length===2){var e=arguments[0],t=arguments[1],i=new Fa(e),r=i.getResultGeometry(t);return r}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof bi&&typeof arguments[1]=="number"){var a=arguments[0],h=arguments[1],s=arguments[2],p=new Fa(a);p.setQuadrantSegments(s);var x=p.getResultGeometry(h);return x}else if(arguments[2]instanceof Wr&&arguments[0]instanceof bi&&typeof arguments[1]=="number"){var I=arguments[0],C=arguments[1],M=arguments[2],O=new Fa(I,M),k=O.getResultGeometry(C);return k}}else if(arguments.length===4){var z=arguments[0],G=arguments[1],q=arguments[2],Z=arguments[3],K=new Fa(z);K.setQuadrantSegments(q),K.setEndCapStyle(Z);var te=K.getResultGeometry(G);return te}};Fa.precisionScaleFactor=function(e,t,i){var r=e.getEnvelopeInternal(),a=Yu.max(Math.abs(r.getMaxX()),Math.abs(r.getMaxY()),Math.abs(r.getMinX()),Math.abs(r.getMinY())),h=t>0?t:0,s=a+2*h,p=Math.trunc(Math.log(s)/Math.log(10)+1),x=i-p,I=Math.pow(10,x);return I};Xv.CAP_ROUND.get=function(){return Wr.CAP_ROUND};Xv.CAP_BUTT.get=function(){return Wr.CAP_FLAT};Xv.CAP_FLAT.get=function(){return Wr.CAP_FLAT};Xv.CAP_SQUARE.get=function(){return Wr.CAP_SQUARE};Xv.MAX_PRECISION_DIGITS.get=function(){return 12};Object.defineProperties(Fa,Xv);var bl=function(){this._pt=[new ht,new ht],this._distance=zi.NaN,this._isNull=!0};bl.prototype.getCoordinates=function(){return this._pt};bl.prototype.getCoordinate=function(e){return this._pt[e]};bl.prototype.setMinimum=function(){if(arguments.length===1){var e=arguments[0];this.setMinimum(e._pt[0],e._pt[1])}else if(arguments.length===2){var t=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(t,i),null;var r=t.distance(i);r<this._distance&&this.initialize(t,i,r)}};bl.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var e=arguments[0],t=arguments[1];this._pt[0].setCoordinate(e),this._pt[1].setCoordinate(t),this._distance=e.distance(t),this._isNull=!1}else if(arguments.length===3){var i=arguments[0],r=arguments[1],a=arguments[2];this._pt[0].setCoordinate(i),this._pt[1].setCoordinate(r),this._distance=a,this._isNull=!1}};bl.prototype.getDistance=function(){return this._distance};bl.prototype.setMaximum=function(){if(arguments.length===1){var e=arguments[0];this.setMaximum(e._pt[0],e._pt[1])}else if(arguments.length===2){var t=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(t,i),null;var r=t.distance(i);r>this._distance&&this.initialize(t,i,r)}};bl.prototype.interfaces_=function(){return[]};bl.prototype.getClass=function(){return bl};var Yf=function(){};Yf.prototype.interfaces_=function(){return[]};Yf.prototype.getClass=function(){return Yf};Yf.computeDistance=function(){if(arguments[2]instanceof bl&&arguments[0]instanceof fo&&arguments[1]instanceof ht)for(var e=arguments[0],t=arguments[1],i=arguments[2],r=e.getCoordinates(),a=new ci,h=0;h<r.length-1;h++){a.setCoordinates(r[h],r[h+1]);var s=a.closestPoint(t);i.setMinimum(s,t)}else if(arguments[2]instanceof bl&&arguments[0]instanceof ea&&arguments[1]instanceof ht){var p=arguments[0],x=arguments[1],I=arguments[2];Yf.computeDistance(p.getExteriorRing(),x,I);for(var C=0;C<p.getNumInteriorRing();C++)Yf.computeDistance(p.getInteriorRingN(C),x,I)}else if(arguments[2]instanceof bl&&arguments[0]instanceof bi&&arguments[1]instanceof ht){var M=arguments[0],O=arguments[1],k=arguments[2];if(M instanceof fo)Yf.computeDistance(M,O,k);else if(M instanceof ea)Yf.computeDistance(M,O,k);else if(M instanceof Sl)for(var z=M,G=0;G<z.getNumGeometries();G++){var q=z.getGeometryN(G);Yf.computeDistance(q,O,k)}else k.setMinimum(M.getCoordinate(),O)}else if(arguments[2]instanceof bl&&arguments[0]instanceof ci&&arguments[1]instanceof ht){var Z=arguments[0],K=arguments[1],te=arguments[2],ie=Z.closestPoint(K);te.setMinimum(ie,K)}};var ig=function(e){this._maxPtDist=new bl,this._inputGeom=e||null},IS={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};ig.prototype.computeMaxMidpointDistance=function(e){var t=new nm(this._inputGeom);e.apply(t),this._maxPtDist.setMaximum(t.getMaxPointDistance())};ig.prototype.computeMaxVertexDistance=function(e){var t=new x_(this._inputGeom);e.apply(t),this._maxPtDist.setMaximum(t.getMaxPointDistance())};ig.prototype.findDistance=function(e){return this.computeMaxVertexDistance(e),this.computeMaxMidpointDistance(e),this._maxPtDist.getDistance()};ig.prototype.getDistancePoints=function(){return this._maxPtDist};ig.prototype.interfaces_=function(){return[]};ig.prototype.getClass=function(){return ig};IS.MaxPointDistanceFilter.get=function(){return x_};IS.MaxMidpointDistanceFilter.get=function(){return nm};Object.defineProperties(ig,IS);var x_=function(e){this._maxPtDist=new bl,this._minPtDist=new bl,this._geom=e||null};x_.prototype.filter=function(e){this._minPtDist.initialize(),Yf.computeDistance(this._geom,e,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};x_.prototype.getMaxPointDistance=function(){return this._maxPtDist};x_.prototype.interfaces_=function(){return[sd]};x_.prototype.getClass=function(){return x_};var nm=function(e){this._maxPtDist=new bl,this._minPtDist=new bl,this._geom=e||null};nm.prototype.filter=function(e,t){if(t===0)return null;var i=e.getCoordinate(t-1),r=e.getCoordinate(t),a=new ht((i.x+r.x)/2,(i.y+r.y)/2);this._minPtDist.initialize(),Yf.computeDistance(this._geom,a,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};nm.prototype.isDone=function(){return!1};nm.prototype.isGeometryChanged=function(){return!1};nm.prototype.getMaxPointDistance=function(){return this._maxPtDist};nm.prototype.interfaces_=function(){return[gh]};nm.prototype.getClass=function(){return nm};var $d=function(e){this._comps=e||null};$d.prototype.filter=function(e){e instanceof ea&&this._comps.add(e)};$d.prototype.interfaces_=function(){return[mf]};$d.prototype.getClass=function(){return $d};$d.getPolygons=function(){if(arguments.length===1){var e=arguments[0];return $d.getPolygons(e,new In)}else if(arguments.length===2){var t=arguments[0],i=arguments[1];return t instanceof ea?i.add(t):t instanceof Sl&&t.apply(new $d(i)),i}};var ka=function(){if(this._lines=null,this._isForcedToLineString=!1,arguments.length===1){var e=arguments[0];this._lines=e}else if(arguments.length===2){var t=arguments[0],i=arguments[1];this._lines=t,this._isForcedToLineString=i}};ka.prototype.filter=function(e){if(this._isForcedToLineString&&e instanceof od){var t=e.getFactory().createLineString(e.getCoordinateSequence());return this._lines.add(t),null}e instanceof fo&&this._lines.add(e)};ka.prototype.setForceToLineString=function(e){this._isForcedToLineString=e};ka.prototype.interfaces_=function(){return[ip]};ka.prototype.getClass=function(){return ka};ka.getGeometry=function(){if(arguments.length===1){var e=arguments[0];return e.getFactory().buildGeometry(ka.getLines(e))}else if(arguments.length===2){var t=arguments[0],i=arguments[1];return t.getFactory().buildGeometry(ka.getLines(t,i))}};ka.getLines=function(){if(arguments.length===1){var e=arguments[0];return ka.getLines(e,!1)}else if(arguments.length===2){if(Si(arguments[0],Yo)&&Si(arguments[1],Yo)){for(var t=arguments[0],i=arguments[1],r=t.iterator();r.hasNext();){var a=r.next();ka.getLines(a,i)}return i}else if(arguments[0]instanceof bi&&typeof arguments[1]=="boolean"){var h=arguments[0],s=arguments[1],p=new In;return h.apply(new ka(p,s)),p}else if(arguments[0]instanceof bi&&Si(arguments[1],Yo)){var x=arguments[0],I=arguments[1];return x instanceof fo?I.add(x):x.apply(new ka(I)),I}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&Si(arguments[0],Yo)&&Si(arguments[1],Yo)){for(var C=arguments[0],M=arguments[1],O=arguments[2],k=C.iterator();k.hasNext();){var z=k.next();ka.getLines(z,M,O)}return M}else if(typeof arguments[2]=="boolean"&&arguments[0]instanceof bi&&Si(arguments[1],Yo)){var G=arguments[0],q=arguments[1],Z=arguments[2];return G.apply(new ka(q,Z)),q}}};var xh=function(){if(this._boundaryRule=Nc.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,arguments.length!==0){if(arguments.length===1){var e=arguments[0];if(e===null)throw new Xs("Rule must be non-null");this._boundaryRule=e}}};xh.prototype.locateInternal=function(){var e=this;if(arguments[0]instanceof ht&&arguments[1]instanceof ea){var t=arguments[0],i=arguments[1];if(i.isEmpty())return vt.EXTERIOR;var r=i.getExteriorRing(),a=this.locateInPolygonRing(t,r);if(a===vt.EXTERIOR)return vt.EXTERIOR;if(a===vt.BOUNDARY)return vt.BOUNDARY;for(var h=0;h<i.getNumInteriorRing();h++){var s=i.getInteriorRingN(h),p=e.locateInPolygonRing(t,s);if(p===vt.INTERIOR)return vt.EXTERIOR;if(p===vt.BOUNDARY)return vt.BOUNDARY}return vt.INTERIOR}else if(arguments[0]instanceof ht&&arguments[1]instanceof fo){var x=arguments[0],I=arguments[1];if(!I.getEnvelopeInternal().intersects(x))return vt.EXTERIOR;var C=I.getCoordinates();return!I.isClosed()&&(x.equals(C[0])||x.equals(C[C.length-1]))?vt.BOUNDARY:Nn.isOnLine(x,C)?vt.INTERIOR:vt.EXTERIOR}else if(arguments[0]instanceof ht&&arguments[1]instanceof yu){var M=arguments[0],O=arguments[1],k=O.getCoordinate();return k.equals2D(M)?vt.INTERIOR:vt.EXTERIOR}};xh.prototype.locateInPolygonRing=function(e,t){return t.getEnvelopeInternal().intersects(e)?Nn.locatePointInRing(e,t.getCoordinates()):vt.EXTERIOR};xh.prototype.intersects=function(e,t){return this.locate(e,t)!==vt.EXTERIOR};xh.prototype.updateLocationInfo=function(e){e===vt.INTERIOR&&(this._isIn=!0),e===vt.BOUNDARY&&this._numBoundaries++};xh.prototype.computeLocation=function(e,t){var i=this;if(t instanceof yu&&this.updateLocationInfo(this.locateInternal(e,t)),t instanceof fo)this.updateLocationInfo(this.locateInternal(e,t));else if(t instanceof ea)this.updateLocationInfo(this.locateInternal(e,t));else if(t instanceof Qm)for(var r=t,a=0;a<r.getNumGeometries();a++){var h=r.getGeometryN(a);i.updateLocationInfo(i.locateInternal(e,h))}else if(t instanceof td)for(var s=t,p=0;p<s.getNumGeometries();p++){var x=s.getGeometryN(p);i.updateLocationInfo(i.locateInternal(e,x))}else if(t instanceof Sl)for(var I=new nd(t);I.hasNext();){var C=I.next();C!==t&&i.computeLocation(e,C)}};xh.prototype.locate=function(e,t){return t.isEmpty()?vt.EXTERIOR:t instanceof fo?this.locateInternal(e,t):t instanceof ea?this.locateInternal(e,t):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(e,t),this._boundaryRule.isInBoundary(this._numBoundaries)?vt.BOUNDARY:this._numBoundaries>0||this._isIn?vt.INTERIOR:vt.EXTERIOR)};xh.prototype.interfaces_=function(){return[]};xh.prototype.getClass=function(){return xh};var El=function n(){if(this._component=null,this._segIndex=null,this._pt=null,arguments.length===2){var e=arguments[0],t=arguments[1];n.call(this,e,n.INSIDE_AREA,t)}else if(arguments.length===3){var i=arguments[0],r=arguments[1],a=arguments[2];this._component=i,this._segIndex=r,this._pt=a}},_L={INSIDE_AREA:{configurable:!0}};El.prototype.isInsideArea=function(){return this._segIndex===El.INSIDE_AREA};El.prototype.getCoordinate=function(){return this._pt};El.prototype.getGeometryComponent=function(){return this._component};El.prototype.getSegmentIndex=function(){return this._segIndex};El.prototype.interfaces_=function(){return[]};El.prototype.getClass=function(){return El};_L.INSIDE_AREA.get=function(){return-1};Object.defineProperties(El,_L);var Yp=function(e){this._pts=e||null};Yp.prototype.filter=function(e){e instanceof yu&&this._pts.add(e)};Yp.prototype.interfaces_=function(){return[mf]};Yp.prototype.getClass=function(){return Yp};Yp.getPoints=function(){if(arguments.length===1){var e=arguments[0];return e instanceof yu?yh.singletonList(e):Yp.getPoints(e,new In)}else if(arguments.length===2){var t=arguments[0],i=arguments[1];return t instanceof yu?i.add(t):t instanceof Sl&&t.apply(new Yp(i)),i}};var b_=function(){this._locations=null;var e=arguments[0];this._locations=e};b_.prototype.filter=function(e){(e instanceof yu||e instanceof fo||e instanceof ea)&&this._locations.add(new El(e,0,e.getCoordinate()))};b_.prototype.interfaces_=function(){return[mf]};b_.prototype.getClass=function(){return b_};b_.getLocations=function(e){var t=new In;return e.apply(new b_(t)),t};var Va=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new xh,this._minDistanceLocation=null,this._minDistance=zi.MAX_VALUE,arguments.length===2){var e=arguments[0],t=arguments[1];this._geom=[e,t],this._terminateDistance=0}else if(arguments.length===3){var i=arguments[0],r=arguments[1],a=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=i,this._geom[1]=r,this._terminateDistance=a}};Va.prototype.computeContainmentDistance=function(){var e=this;if(arguments.length===0){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(arguments.length===2){var i=arguments[0],r=arguments[1],a=1-i,h=$d.getPolygons(this._geom[i]);if(h.size()>0){var s=b_.getLocations(this._geom[a]);if(this.computeContainmentDistance(s,h,r),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[a]=r[0],this._minDistanceLocation[i]=r[1],null}}else if(arguments.length===3){if(arguments[2]instanceof Array&&Si(arguments[0],dh)&&Si(arguments[1],dh)){for(var p=arguments[0],x=arguments[1],I=arguments[2],C=0;C<p.size();C++)for(var M=p.get(C),O=0;O<x.size();O++)if(e.computeContainmentDistance(M,x.get(O),I),e._minDistance<=e._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof El&&arguments[1]instanceof ea){var k=arguments[0],z=arguments[1],G=arguments[2],q=k.getCoordinate();if(vt.EXTERIOR!==this._ptLocator.locate(q,z))return this._minDistance=0,G[0]=k,G[1]=new El(z,q),null}}};Va.prototype.computeMinDistanceLinesPoints=function(e,t,i){for(var r=this,a=0;a<e.size();a++)for(var h=e.get(a),s=0;s<t.size();s++){var p=t.get(s);if(r.computeMinDistance(h,p,i),r._minDistance<=r._terminateDistance)return null}};Va.prototype.computeFacetDistance=function(){var e=new Array(2).fill(null),t=ka.getLines(this._geom[0]),i=ka.getLines(this._geom[1]),r=Yp.getPoints(this._geom[0]),a=Yp.getPoints(this._geom[1]);if(this.computeMinDistanceLines(t,i,e),this.updateMinDistance(e,!1),this._minDistance<=this._terminateDistance||(e[0]=null,e[1]=null,this.computeMinDistanceLinesPoints(t,a,e),this.updateMinDistance(e,!1),this._minDistance<=this._terminateDistance)||(e[0]=null,e[1]=null,this.computeMinDistanceLinesPoints(i,r,e),this.updateMinDistance(e,!0),this._minDistance<=this._terminateDistance))return null;e[0]=null,e[1]=null,this.computeMinDistancePoints(r,a,e),this.updateMinDistance(e,!1)};Va.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation};Va.prototype.updateMinDistance=function(e,t){if(e[0]===null)return null;t?(this._minDistanceLocation[0]=e[1],this._minDistanceLocation[1]=e[0]):(this._minDistanceLocation[0]=e[0],this._minDistanceLocation[1]=e[1])};Va.prototype.nearestPoints=function(){this.computeMinDistance();var e=[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()];return e};Va.prototype.computeMinDistance=function(){var e=this;if(arguments.length===0){if(this._minDistanceLocation!==null||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(arguments.length===3){if(arguments[2]instanceof Array&&arguments[0]instanceof fo&&arguments[1]instanceof yu){var t=arguments[0],i=arguments[1],r=arguments[2];if(t.getEnvelopeInternal().distance(i.getEnvelopeInternal())>this._minDistance)return null;for(var a=t.getCoordinates(),h=i.getCoordinate(),s=0;s<a.length-1;s++){var p=Nn.distancePointLine(h,a[s],a[s+1]);if(p<e._minDistance){e._minDistance=p;var x=new ci(a[s],a[s+1]),I=x.closestPoint(h);r[0]=new El(t,s,I),r[1]=new El(i,0,h)}if(e._minDistance<=e._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof fo&&arguments[1]instanceof fo){var C=arguments[0],M=arguments[1],O=arguments[2];if(C.getEnvelopeInternal().distance(M.getEnvelopeInternal())>this._minDistance)return null;for(var k=C.getCoordinates(),z=M.getCoordinates(),G=0;G<k.length-1;G++)for(var q=0;q<z.length-1;q++){var Z=Nn.distanceLineLine(k[G],k[G+1],z[q],z[q+1]);if(Z<e._minDistance){e._minDistance=Z;var K=new ci(k[G],k[G+1]),te=new ci(z[q],z[q+1]),ie=K.closestPoints(te);O[0]=new El(C,G,ie[0]),O[1]=new El(M,q,ie[1])}if(e._minDistance<=e._terminateDistance)return null}}}};Va.prototype.computeMinDistancePoints=function(e,t,i){for(var r=this,a=0;a<e.size();a++)for(var h=e.get(a),s=0;s<t.size();s++){var p=t.get(s),x=h.getCoordinate().distance(p.getCoordinate());if(x<r._minDistance&&(r._minDistance=x,i[0]=new El(h,0,h.getCoordinate()),i[1]=new El(p,0,p.getCoordinate())),r._minDistance<=r._terminateDistance)return null}};Va.prototype.distance=function(){if(this._geom[0]===null||this._geom[1]===null)throw new Xs("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)};Va.prototype.computeMinDistanceLines=function(e,t,i){for(var r=this,a=0;a<e.size();a++)for(var h=e.get(a),s=0;s<t.size();s++){var p=t.get(s);if(r.computeMinDistance(h,p,i),r._minDistance<=r._terminateDistance)return null}};Va.prototype.interfaces_=function(){return[]};Va.prototype.getClass=function(){return Va};Va.distance=function(e,t){var i=new Va(e,t);return i.distance()};Va.isWithinDistance=function(e,t,i){var r=new Va(e,t,i);return r.distance()<=i};Va.nearestPoints=function(e,t){var i=new Va(e,t);return i.nearestPoints()};var ul=function(){this._pt=[new ht,new ht],this._distance=zi.NaN,this._isNull=!0};ul.prototype.getCoordinates=function(){return this._pt};ul.prototype.getCoordinate=function(e){return this._pt[e]};ul.prototype.setMinimum=function(){if(arguments.length===1){var e=arguments[0];this.setMinimum(e._pt[0],e._pt[1])}else if(arguments.length===2){var t=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(t,i),null;var r=t.distance(i);r<this._distance&&this.initialize(t,i,r)}};ul.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var e=arguments[0],t=arguments[1];this._pt[0].setCoordinate(e),this._pt[1].setCoordinate(t),this._distance=e.distance(t),this._isNull=!1}else if(arguments.length===3){var i=arguments[0],r=arguments[1],a=arguments[2];this._pt[0].setCoordinate(i),this._pt[1].setCoordinate(r),this._distance=a,this._isNull=!1}};ul.prototype.toString=function(){return mh.toLineString(this._pt[0],this._pt[1])};ul.prototype.getDistance=function(){return this._distance};ul.prototype.setMaximum=function(){if(arguments.length===1){var e=arguments[0];this.setMaximum(e._pt[0],e._pt[1])}else if(arguments.length===2){var t=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(t,i),null;var r=t.distance(i);r>this._distance&&this.initialize(t,i,r)}};ul.prototype.interfaces_=function(){return[]};ul.prototype.getClass=function(){return ul};var lf=function(){};lf.prototype.interfaces_=function(){return[]};lf.prototype.getClass=function(){return lf};lf.computeDistance=function(){if(arguments[2]instanceof ul&&arguments[0]instanceof fo&&arguments[1]instanceof ht)for(var e=arguments[0],t=arguments[1],i=arguments[2],r=new ci,a=e.getCoordinates(),h=0;h<a.length-1;h++){r.setCoordinates(a[h],a[h+1]);var s=r.closestPoint(t);i.setMinimum(s,t)}else if(arguments[2]instanceof ul&&arguments[0]instanceof ea&&arguments[1]instanceof ht){var p=arguments[0],x=arguments[1],I=arguments[2];lf.computeDistance(p.getExteriorRing(),x,I);for(var C=0;C<p.getNumInteriorRing();C++)lf.computeDistance(p.getInteriorRingN(C),x,I)}else if(arguments[2]instanceof ul&&arguments[0]instanceof bi&&arguments[1]instanceof ht){var M=arguments[0],O=arguments[1],k=arguments[2];if(M instanceof fo)lf.computeDistance(M,O,k);else if(M instanceof ea)lf.computeDistance(M,O,k);else if(M instanceof Sl)for(var z=M,G=0;G<z.getNumGeometries();G++){var q=z.getGeometryN(G);lf.computeDistance(q,O,k)}else k.setMinimum(M.getCoordinate(),O)}else if(arguments[2]instanceof ul&&arguments[0]instanceof ci&&arguments[1]instanceof ht){var Z=arguments[0],K=arguments[1],te=arguments[2],ie=Z.closestPoint(K);te.setMinimum(ie,K)}};var Dc=function(){this._g0=null,this._g1=null,this._ptDist=new ul,this._densifyFrac=0;var e=arguments[0],t=arguments[1];this._g0=e,this._g1=t},TS={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Dc.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()};Dc.prototype.setDensifyFraction=function(e){if(e>1||e<=0)throw new Xs("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=e};Dc.prototype.compute=function(e,t){this.computeOrientedDistance(e,t,this._ptDist),this.computeOrientedDistance(t,e,this._ptDist)};Dc.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()};Dc.prototype.computeOrientedDistance=function(e,t,i){var r=new E_(t);if(e.apply(r),i.setMaximum(r.getMaxPointDistance()),this._densifyFrac>0){var a=new im(t,this._densifyFrac);e.apply(a),i.setMaximum(a.getMaxPointDistance())}};Dc.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()};Dc.prototype.interfaces_=function(){return[]};Dc.prototype.getClass=function(){return Dc};Dc.distance=function(){if(arguments.length===2){var e=arguments[0],t=arguments[1],i=new Dc(e,t);return i.distance()}else if(arguments.length===3){var r=arguments[0],a=arguments[1],h=arguments[2],s=new Dc(r,a);return s.setDensifyFraction(h),s.distance()}};TS.MaxPointDistanceFilter.get=function(){return E_};TS.MaxDensifiedByFractionDistanceFilter.get=function(){return im};Object.defineProperties(Dc,TS);var E_=function(){this._maxPtDist=new ul,this._minPtDist=new ul,this._euclideanDist=new lf,this._geom=null;var e=arguments[0];this._geom=e};E_.prototype.filter=function(e){this._minPtDist.initialize(),lf.computeDistance(this._geom,e,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};E_.prototype.getMaxPointDistance=function(){return this._maxPtDist};E_.prototype.interfaces_=function(){return[sd]};E_.prototype.getClass=function(){return E_};var im=function(){this._maxPtDist=new ul,this._minPtDist=new ul,this._geom=null,this._numSubSegs=0;var e=arguments[0],t=arguments[1];this._geom=e,this._numSubSegs=Math.trunc(Math.round(1/t))};im.prototype.filter=function(e,t){var i=this;if(t===0)return null;for(var r=e.getCoordinate(t-1),a=e.getCoordinate(t),h=(a.x-r.x)/this._numSubSegs,s=(a.y-r.y)/this._numSubSegs,p=0;p<this._numSubSegs;p++){var x=r.x+p*h,I=r.y+p*s,C=new ht(x,I);i._minPtDist.initialize(),lf.computeDistance(i._geom,C,i._minPtDist),i._maxPtDist.setMaximum(i._minPtDist)}};im.prototype.isDone=function(){return!1};im.prototype.isGeometryChanged=function(){return!1};im.prototype.getMaxPointDistance=function(){return this._maxPtDist};im.prototype.interfaces_=function(){return[gh]};im.prototype.getClass=function(){return im};var _u=function(e,t,i){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=e||null,this._bufDistance=t||null,this._result=i||null},SS={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};_u.prototype.checkMaximumDistance=function(e,t,i){var r=new Dc(t,e);if(r.setDensifyFraction(.25),this._maxDistanceFound=r.orientedDistance(),this._maxDistanceFound>i){this._isValid=!1;var a=r.getCoordinates();this._errorLocation=a[1],this._errorIndicator=e.getFactory().createLineString(a),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+mh.toLineString(a[0],a[1])+")"}};_u.prototype.isValid=function(){var e=Math.abs(this._bufDistance),t=_u.MAX_DISTANCE_DIFF_FRAC*e;return this._minValidDistance=e-t,this._maxValidDistance=e+t,this._input.isEmpty()||this._result.isEmpty()?!0:(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),_u.VERBOSE&&Ua.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)};_u.prototype.checkNegativeValid=function(){if(!(this._input instanceof ea||this._input instanceof td||this._input instanceof Sl))return null;var e=this.getPolygonLines(this._input);if(this.checkMinimumDistance(e,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(e,this._result,this._maxValidDistance)};_u.prototype.getErrorIndicator=function(){return this._errorIndicator};_u.prototype.checkMinimumDistance=function(e,t,i){var r=new Va(e,t,i);if(this._minDistanceFound=r.distance(),this._minDistanceFound<i){this._isValid=!1;var a=r.nearestPoints();this._errorLocation=r.nearestPoints()[1],this._errorIndicator=e.getFactory().createLineString(a),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+mh.toLineString(a[0],a[1])+" )"}};_u.prototype.checkPositiveValid=function(){var e=this._result.getBoundary();if(this.checkMinimumDistance(this._input,e,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,e,this._maxValidDistance)};_u.prototype.getErrorLocation=function(){return this._errorLocation};_u.prototype.getPolygonLines=function(e){for(var t=new In,i=new ka(t),r=$d.getPolygons(e),a=r.iterator();a.hasNext();){var h=a.next();h.apply(i)}return e.getFactory().buildGeometry(t)};_u.prototype.getErrorMessage=function(){return this._errMsg};_u.prototype.interfaces_=function(){return[]};_u.prototype.getClass=function(){return _u};SS.VERBOSE.get=function(){return!1};SS.MAX_DISTANCE_DIFF_FRAC.get=function(){return .012};Object.defineProperties(_u,SS);var Ga=function(e,t,i){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=e||null,this._distance=t||null,this._result=i||null},CS={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};Ga.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid};Ga.prototype.checkEnvelope=function(){if(this._distance<0)return null;var e=this._distance*Ga.MAX_ENV_DIFF_FRAC;e===0&&(e=.001);var t=new li(this._input.getEnvelopeInternal());t.expandBy(this._distance);var i=new li(this._result.getEnvelopeInternal());i.expandBy(e),i.contains(t)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(i)),this.report("Envelope")};Ga.prototype.checkDistance=function(){var e=new _u(this._input,this._distance,this._result);e.isValid()||(this._isValid=!1,this._errorMsg=e.getErrorMessage(),this._errorLocation=e.getErrorLocation(),this._errorIndicator=e.getErrorIndicator()),this.report("Distance")};Ga.prototype.checkArea=function(){var e=this._input.getArea(),t=this._result.getArea();this._distance>0&&e>t&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&e<t&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")};Ga.prototype.checkPolygonal=function(){this._result instanceof ea||this._result instanceof td||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")};Ga.prototype.getErrorIndicator=function(){return this._errorIndicator};Ga.prototype.getErrorLocation=function(){return this._errorLocation};Ga.prototype.checkExpectedEmpty=function(){if(this._input.getDimension()>=2||this._distance>0)return null;this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),this.report("ExpectedEmpty")};Ga.prototype.report=function(e){if(!Ga.VERBOSE)return null;Ua.out.println("Check "+e+": "+(this._isValid?"passed":"FAILED"))};Ga.prototype.getErrorMessage=function(){return this._errorMsg};Ga.prototype.interfaces_=function(){return[]};Ga.prototype.getClass=function(){return Ga};Ga.isValidMsg=function(e,t,i){var r=new Ga(e,t,i);return r.isValid()?null:r.getErrorMessage()};Ga.isValid=function(e,t,i){var r=new Ga(e,t,i);return!!r.isValid()};CS.VERBOSE.get=function(){return!1};CS.MAX_ENV_DIFF_FRAC.get=function(){return .012};Object.defineProperties(Ga,CS);var bf=function(){this._pts=null,this._data=null;var e=arguments[0],t=arguments[1];this._pts=e,this._data=t};bf.prototype.getCoordinates=function(){return this._pts};bf.prototype.size=function(){return this._pts.length};bf.prototype.getCoordinate=function(e){return this._pts[e]};bf.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};bf.prototype.getSegmentOctant=function(e){return e===this._pts.length-1?-1:__.octant(this.getCoordinate(e),this.getCoordinate(e+1))};bf.prototype.setData=function(e){this._data=e};bf.prototype.getData=function(){return this._data};bf.prototype.toString=function(){return mh.toLineString(new wo(this._pts))};bf.prototype.interfaces_=function(){return[ld]};bf.prototype.getClass=function(){return bf};var Ea=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new In,this._intersectionCount=0,this._keepIntersections=!0;var e=arguments[0];this._li=e,this._interiorIntersection=null};Ea.prototype.getInteriorIntersection=function(){return this._interiorIntersection};Ea.prototype.setCheckEndSegmentsOnly=function(e){this._isCheckEndSegmentsOnly=e};Ea.prototype.getIntersectionSegments=function(){return this._intSegments};Ea.prototype.count=function(){return this._intersectionCount};Ea.prototype.getIntersections=function(){return this._intersections};Ea.prototype.setFindAllIntersections=function(e){this._findAllIntersections=e};Ea.prototype.setKeepIntersections=function(e){this._keepIntersections=e};Ea.prototype.processIntersections=function(e,t,i,r){if(!this._findAllIntersections&&this.hasIntersection()||e===i&&t===r)return null;if(this._isCheckEndSegmentsOnly){var a=this.isEndSegment(e,t)||this.isEndSegment(i,r);if(!a)return null}var h=e.getCoordinates()[t],s=e.getCoordinates()[t+1],p=i.getCoordinates()[r],x=i.getCoordinates()[r+1];this._li.computeIntersection(h,s,p,x),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=h,this._intSegments[1]=s,this._intSegments[2]=p,this._intSegments[3]=x,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)};Ea.prototype.isEndSegment=function(e,t){return t===0||t>=e.size()-2};Ea.prototype.hasIntersection=function(){return this._interiorIntersection!==null};Ea.prototype.isDone=function(){return this._findAllIntersections?!1:this._interiorIntersection!==null};Ea.prototype.interfaces_=function(){return[tg]};Ea.prototype.getClass=function(){return Ea};Ea.createAllIntersectionsFinder=function(e){var t=new Ea(e);return t.setFindAllIntersections(!0),t};Ea.createAnyIntersectionFinder=function(e){return new Ea(e)};Ea.createIntersectionCounter=function(e){var t=new Ea(e);return t.setFindAllIntersections(!0),t.setKeepIntersections(!1),t};var bh=function(){this._li=new fg,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var e=arguments[0];this._segStrings=e};bh.prototype.execute=function(){if(this._segInt!==null)return null;this.checkInteriorIntersections()};bh.prototype.getIntersections=function(){return this._segInt.getIntersections()};bh.prototype.isValid=function(){return this.execute(),this._isValid};bh.prototype.setFindAllIntersections=function(e){this._findAllIntersections=e};bh.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Ea(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var e=new wS;if(e.setSegmentIntersector(this._segInt),e.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null};bh.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new rp(this.getErrorMessage(),this._segInt.getInteriorIntersection())};bh.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var e=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+mh.toLineString(e[0],e[1])+" and "+mh.toLineString(e[2],e[3])};bh.prototype.interfaces_=function(){return[]};bh.prototype.getClass=function(){return bh};bh.computeIntersections=function(e){var t=new bh(e);return t.setFindAllIntersections(!0),t.isValid(),t.getIntersections()};var rg=function n(){this._nv=null;var e=arguments[0];this._nv=new bh(n.toSegmentStrings(e))};rg.prototype.checkValid=function(){this._nv.checkValid()};rg.prototype.interfaces_=function(){return[]};rg.prototype.getClass=function(){return rg};rg.toSegmentStrings=function(e){for(var t=new In,i=e.iterator();i.hasNext();){var r=i.next();t.add(new bf(r.getCoordinates(),r))}return t};rg.checkValid=function(e){var t=new rg(e);t.checkValid()};var w_=function(e){this._mapOp=e};w_.prototype.map=function(e){for(var t=this,i=new In,r=0;r<e.getNumGeometries();r++){var a=t._mapOp.map(e.getGeometryN(r));a.isEmpty()||i.add(a)}return e.getFactory().createGeometryCollection(mr.toGeometryArray(i))};w_.prototype.interfaces_=function(){return[]};w_.prototype.getClass=function(){return w_};w_.map=function(e,t){var i=new w_(t);return i.map(e)};var Ef=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new In,this._resultLineList=new In;var e=arguments[0],t=arguments[1],i=arguments[2];this._op=e,this._geometryFactory=t,this._ptLocator=i};Ef.prototype.collectLines=function(e){for(var t=this,i=this._op.getGraph().getEdgeEnds().iterator();i.hasNext();){var r=i.next();t.collectLineEdge(r,e,t._lineEdgesList),t.collectBoundaryTouchEdge(r,e,t._lineEdgesList)}};Ef.prototype.labelIsolatedLine=function(e,t){var i=this._ptLocator.locate(e.getCoordinate(),this._op.getArgGeometry(t));e.getLabel().setLocation(t,i)};Ef.prototype.build=function(e){return this.findCoveredLineEdges(),this.collectLines(e),this.buildLines(e),this._resultLineList};Ef.prototype.collectLineEdge=function(e,t,i){var r=e.getLabel(),a=e.getEdge();e.isLineEdge()&&!e.isVisited()&&qi.isResultOfOp(r,t)&&!a.isCovered()&&(i.add(a),e.setVisitedEdge(!0))};Ef.prototype.findCoveredLineEdges=function(){for(var e=this,t=this._op.getGraph().getNodes().iterator();t.hasNext();){var i=t.next();i.getEdges().findCoveredLineEdges()}for(var r=this._op.getGraph().getEdgeEnds().iterator();r.hasNext();){var a=r.next(),h=a.getEdge();if(a.isLineEdge()&&!h.isCoveredSet()){var s=e._op.isCoveredByA(a.getCoordinate());h.setCovered(s)}}};Ef.prototype.labelIsolatedLines=function(e){for(var t=this,i=e.iterator();i.hasNext();){var r=i.next(),a=r.getLabel();r.isIsolated()&&(a.isNull(0)?t.labelIsolatedLine(r,0):t.labelIsolatedLine(r,1))}};Ef.prototype.buildLines=function(e){for(var t=this,i=this._lineEdgesList.iterator();i.hasNext();){var r=i.next(),a=t._geometryFactory.createLineString(r.getCoordinates());t._resultLineList.add(a),r.setInResult(!0)}};Ef.prototype.collectBoundaryTouchEdge=function(e,t,i){var r=e.getLabel();if(e.isLineEdge()||e.isVisited()||e.isInteriorAreaEdge()||e.getEdge().isInResult())return null;Zi.isTrue(!(e.isInResult()||e.getSym().isInResult())||!e.getEdge().isInResult()),qi.isResultOfOp(r,t)&&t===qi.INTERSECTION&&(i.add(e.getEdge()),e.setVisitedEdge(!0))};Ef.prototype.interfaces_=function(){return[]};Ef.prototype.getClass=function(){return Ef};var I_=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new In;var e=arguments[0],t=arguments[1];this._op=e,this._geometryFactory=t};I_.prototype.filterCoveredNodeToPoint=function(e){var t=e.getCoordinate();if(!this._op.isCoveredByLA(t)){var i=this._geometryFactory.createPoint(t);this._resultPointList.add(i)}};I_.prototype.extractNonCoveredResultNodes=function(e){for(var t=this,i=this._op.getGraph().getNodes().iterator();i.hasNext();){var r=i.next();if(!r.isInResult()&&!r.isIncidentEdgeInResult()&&(r.getEdges().getDegree()===0||e===qi.INTERSECTION)){var a=r.getLabel();qi.isResultOfOp(a,e)&&t.filterCoveredNodeToPoint(r)}}};I_.prototype.build=function(e){return this.extractNonCoveredResultNodes(e),this._resultPointList};I_.prototype.interfaces_=function(){return[]};I_.prototype.getClass=function(){return I_};var Ql=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Ql.prototype.transformPoint=function(e,t){return this._factory.createPoint(this.transformCoordinates(e.getCoordinateSequence(),e))};Ql.prototype.transformPolygon=function(e,t){var i=this,r=!0,a=this.transformLinearRing(e.getExteriorRing(),e);(a===null||!(a instanceof od)||a.isEmpty())&&(r=!1);for(var h=new In,s=0;s<e.getNumInteriorRing();s++){var p=i.transformLinearRing(e.getInteriorRingN(s),e);p===null||p.isEmpty()||(p instanceof od||(r=!1),h.add(p))}if(r)return this._factory.createPolygon(a,h.toArray([]));var x=new In;return a!==null&&x.add(a),x.addAll(h),this._factory.buildGeometry(x)};Ql.prototype.createCoordinateSequence=function(e){return this._factory.getCoordinateSequenceFactory().create(e)};Ql.prototype.getInputGeometry=function(){return this._inputGeom};Ql.prototype.transformMultiLineString=function(e,t){for(var i=this,r=new In,a=0;a<e.getNumGeometries();a++){var h=i.transformLineString(e.getGeometryN(a),e);h!==null&&(h.isEmpty()||r.add(h))}return this._factory.buildGeometry(r)};Ql.prototype.transformCoordinates=function(e,t){return this.copy(e)};Ql.prototype.transformLineString=function(e,t){return this._factory.createLineString(this.transformCoordinates(e.getCoordinateSequence(),e))};Ql.prototype.transformMultiPoint=function(e,t){for(var i=this,r=new In,a=0;a<e.getNumGeometries();a++){var h=i.transformPoint(e.getGeometryN(a),e);h!==null&&(h.isEmpty()||r.add(h))}return this._factory.buildGeometry(r)};Ql.prototype.transformMultiPolygon=function(e,t){for(var i=this,r=new In,a=0;a<e.getNumGeometries();a++){var h=i.transformPolygon(e.getGeometryN(a),e);h!==null&&(h.isEmpty()||r.add(h))}return this._factory.buildGeometry(r)};Ql.prototype.copy=function(e){return e.copy()};Ql.prototype.transformGeometryCollection=function(e,t){for(var i=this,r=new In,a=0;a<e.getNumGeometries();a++){var h=i.transform(e.getGeometryN(a));h!==null&&(i._pruneEmptyGeometry&&h.isEmpty()||r.add(h))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(mr.toGeometryArray(r)):this._factory.buildGeometry(r)};Ql.prototype.transform=function(e){if(this._inputGeom=e,this._factory=e.getFactory(),e instanceof yu)return this.transformPoint(e,null);if(e instanceof Tv)return this.transformMultiPoint(e,null);if(e instanceof od)return this.transformLinearRing(e,null);if(e instanceof fo)return this.transformLineString(e,null);if(e instanceof Qm)return this.transformMultiLineString(e,null);if(e instanceof ea)return this.transformPolygon(e,null);if(e instanceof td)return this.transformMultiPolygon(e,null);if(e instanceof Sl)return this.transformGeometryCollection(e,null);throw new Xs("Unknown Geometry subtype: "+e.getClass().getName())};Ql.prototype.transformLinearRing=function(e,t){var i=this.transformCoordinates(e.getCoordinateSequence(),e);if(i===null)return this._factory.createLinearRing(null);var r=i.size();return r>0&&r<4&&!this._preserveType?this._factory.createLineString(i):this._factory.createLinearRing(i)};Ql.prototype.interfaces_=function(){return[]};Ql.prototype.getClass=function(){return Ql};var hd=function n(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new ci,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof fo&&typeof arguments[1]=="number"){var e=arguments[0],t=arguments[1];n.call(this,e.getCoordinates(),t)}else if(arguments[0]instanceof Array&&typeof arguments[1]=="number"){var i=arguments[0],r=arguments[1];this._srcPts=i,this._isClosed=n.isClosed(i),this._snapTolerance=r}};hd.prototype.snapVertices=function(e,t){for(var i=this,r=this._isClosed?e.size()-1:e.size(),a=0;a<r;a++){var h=e.get(a),s=i.findSnapForVertex(h,t);s!==null&&(e.set(a,new ht(s)),a===0&&i._isClosed&&e.set(e.size()-1,new ht(s)))}};hd.prototype.findSnapForVertex=function(e,t){for(var i=this,r=0;r<t.length;r++){if(e.equals2D(t[r]))return null;if(e.distance(t[r])<i._snapTolerance)return t[r]}return null};hd.prototype.snapTo=function(e){var t=new K1(this._srcPts);this.snapVertices(t,e),this.snapSegments(t,e);var i=t.toCoordinateArray();return i};hd.prototype.snapSegments=function(e,t){var i=this;if(t.length===0)return null;var r=t.length;t[0].equals2D(t[t.length-1])&&(r=t.length-1);for(var a=0;a<r;a++){var h=t[a],s=i.findSegmentIndexToSnap(h,e);s>=0&&e.add(s+1,new ht(h),!1)}};hd.prototype.findSegmentIndexToSnap=function(e,t){for(var i=this,r=zi.MAX_VALUE,a=-1,h=0;h<t.size()-1;h++){if(i._seg.p0=t.get(h),i._seg.p1=t.get(h+1),i._seg.p0.equals2D(e)||i._seg.p1.equals2D(e)){if(i._allowSnappingToSourceVertices)continue;return-1}var s=i._seg.distance(e);s<i._snapTolerance&&s<r&&(r=s,a=h)}return a};hd.prototype.setAllowSnappingToSourceVertices=function(e){this._allowSnappingToSourceVertices=e};hd.prototype.interfaces_=function(){return[]};hd.prototype.getClass=function(){return hd};hd.isClosed=function(e){return e.length<=1?!1:e[0].equals2D(e[e.length-1])};var Io=function(e){this._srcGeom=e||null},yL={SNAP_PRECISION_FACTOR:{configurable:!0}};Io.prototype.snapTo=function(e,t){var i=this.extractTargetCoordinates(e),r=new vL(t,i);return r.transform(this._srcGeom)};Io.prototype.snapToSelf=function(e,t){var i=this.extractTargetCoordinates(this._srcGeom),r=new vL(e,i,!0),a=r.transform(this._srcGeom),h=a;return t&&Si(h,Jp)&&(h=a.buffer(0)),h};Io.prototype.computeSnapTolerance=function(e){var t=this.computeMinimumSegmentLength(e),i=t/10;return i};Io.prototype.extractTargetCoordinates=function(e){for(var t=new pf,i=e.getCoordinates(),r=0;r<i.length;r++)t.add(i[r]);return t.toArray(new Array(0).fill(null))};Io.prototype.computeMinimumSegmentLength=function(e){for(var t=zi.MAX_VALUE,i=0;i<e.length-1;i++){var r=e[i].distance(e[i+1]);r<t&&(t=r)}return t};Io.prototype.interfaces_=function(){return[]};Io.prototype.getClass=function(){return Io};Io.snap=function(e,t,i){var r=new Array(2).fill(null),a=new Io(e);r[0]=a.snapTo(t,i);var h=new Io(t);return r[1]=h.snapTo(r[0],i),r};Io.computeOverlaySnapTolerance=function(){if(arguments.length===1){var e=arguments[0],t=Io.computeSizeBasedSnapTolerance(e),i=e.getPrecisionModel();if(i.getType()===Xr.FIXED){var r=1/i.getScale()*2/1.415;r>t&&(t=r)}return t}else if(arguments.length===2){var a=arguments[0],h=arguments[1];return Math.min(Io.computeOverlaySnapTolerance(a),Io.computeOverlaySnapTolerance(h))}};Io.computeSizeBasedSnapTolerance=function(e){var t=e.getEnvelopeInternal(),i=Math.min(t.getHeight(),t.getWidth()),r=i*Io.SNAP_PRECISION_FACTOR;return r};Io.snapToSelf=function(e,t,i){var r=new Io(e);return r.snapToSelf(t,i)};yL.SNAP_PRECISION_FACTOR.get=function(){return 1e-9};Object.defineProperties(Io,yL);var vL=function(n){function e(t,i,r){n.call(this),this._snapTolerance=t||null,this._snapPts=i||null,this._isSelfSnap=r!==void 0?r:!1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.snapLine=function(i,r){var a=new hd(i,this._snapTolerance);return a.setAllowSnappingToSourceVertices(this._isSelfSnap),a.snapTo(r)},e.prototype.transformCoordinates=function(i,r){var a=i.toCoordinateArray(),h=this.snapLine(a,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(h)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ql),xl=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};xl.prototype.getCommon=function(){return zi.longBitsToDouble(this._commonBits)};xl.prototype.add=function(e){var t=zi.doubleToLongBits(e);if(this._isFirst)return this._commonBits=t,this._commonSignExp=xl.signExpBits(this._commonBits),this._isFirst=!1,null;var i=xl.signExpBits(t);if(i!==this._commonSignExp)return this._commonBits=0,null;this._commonMantissaBitsCount=xl.numCommonMostSigMantissaBits(this._commonBits,t),this._commonBits=xl.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))};xl.prototype.toString=function(){if(arguments.length===1){var e=arguments[0],t=zi.longBitsToDouble(e),i=zi.toBinaryString(e),r="0000000000000000000000000000000000000000000000000000000000000000"+i,a=r.substring(r.length-64),h=a.substring(0,1)+"  "+a.substring(1,12)+"(exp) "+a.substring(12)+" [ "+t+" ]";return h}};xl.prototype.interfaces_=function(){return[]};xl.prototype.getClass=function(){return xl};xl.getBit=function(e,t){var i=1<<t;return e&i?1:0};xl.signExpBits=function(e){return e>>52};xl.zeroLowerBits=function(e,t){var i=(1<<t)-1,r=~i,a=e&r;return a};xl.numCommonMostSigMantissaBits=function(e,t){for(var i=0,r=52;r>=0;r--){if(xl.getBit(e,r)!==xl.getBit(t,r))return i;i++}return 52};var rm=function(){this._commonCoord=null,this._ccFilter=new T_},AS={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};rm.prototype.addCommonBits=function(e){var t=new sm(this._commonCoord);e.apply(t),e.geometryChanged()};rm.prototype.removeCommonBits=function(e){if(this._commonCoord.x===0&&this._commonCoord.y===0)return e;var t=new ht(this._commonCoord);t.x=-t.x,t.y=-t.y;var i=new sm(t);return e.apply(i),e.geometryChanged(),e};rm.prototype.getCommonCoordinate=function(){return this._commonCoord};rm.prototype.add=function(e){e.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()};rm.prototype.interfaces_=function(){return[]};rm.prototype.getClass=function(){return rm};AS.CommonCoordinateFilter.get=function(){return T_};AS.Translater.get=function(){return sm};Object.defineProperties(rm,AS);var T_=function(){this._commonBitsX=new xl,this._commonBitsY=new xl};T_.prototype.filter=function(e){this._commonBitsX.add(e.x),this._commonBitsY.add(e.y)};T_.prototype.getCommonCoordinate=function(){return new ht(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())};T_.prototype.interfaces_=function(){return[sd]};T_.prototype.getClass=function(){return T_};var sm=function(){this.trans=null;var e=arguments[0];this.trans=e};sm.prototype.filter=function(e,t){var i=e.getOrdinate(t,0)+this.trans.x,r=e.getOrdinate(t,1)+this.trans.y;e.setOrdinate(t,0,i),e.setOrdinate(t,1,r)};sm.prototype.isDone=function(){return!1};sm.prototype.isGeometryChanged=function(){return!0};sm.prototype.interfaces_=function(){return[gh]};sm.prototype.getClass=function(){return sm};var wa=function(e,t){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=e,this._geom[1]=t,this.computeSnapTolerance()};wa.prototype.selfSnap=function(e){var t=new Io(e),i=t.snapTo(e,this._snapTolerance);return i};wa.prototype.removeCommonBits=function(e){this._cbr=new rm,this._cbr.add(e[0]),this._cbr.add(e[1]);var t=new Array(2).fill(null);return t[0]=this._cbr.removeCommonBits(e[0].copy()),t[1]=this._cbr.removeCommonBits(e[1].copy()),t};wa.prototype.prepareResult=function(e){return this._cbr.addCommonBits(e),e};wa.prototype.getResultGeometry=function(e){var t=this.snap(this._geom),i=qi.overlayOp(t[0],t[1],e);return this.prepareResult(i)};wa.prototype.checkValid=function(e){e.isValid()||Ua.out.println("Snapped geometry is invalid")};wa.prototype.computeSnapTolerance=function(){this._snapTolerance=Io.computeOverlaySnapTolerance(this._geom[0],this._geom[1])};wa.prototype.snap=function(e){var t=this.removeCommonBits(e),i=Io.snap(t[0],t[1],this._snapTolerance);return i};wa.prototype.interfaces_=function(){return[]};wa.prototype.getClass=function(){return wa};wa.overlayOp=function(e,t,i){var r=new wa(e,t);return r.getResultGeometry(i)};wa.union=function(e,t){return wa.overlayOp(e,t,qi.UNION)};wa.intersection=function(e,t){return wa.overlayOp(e,t,qi.INTERSECTION)};wa.symDifference=function(e,t){return wa.overlayOp(e,t,qi.SYMDIFFERENCE)};wa.difference=function(e,t){return wa.overlayOp(e,t,qi.DIFFERENCE)};var Ml=function(e,t){this._geom=new Array(2).fill(null),this._geom[0]=e,this._geom[1]=t};Ml.prototype.getResultGeometry=function(e){var t=null,i=!1,r=null;try{t=qi.overlayOp(this._geom[0],this._geom[1],e);var a=!0;a&&(i=!0)}catch(h){if(h instanceof np)r=h;else throw h}finally{}if(!i)try{t=wa.overlayOp(this._geom[0],this._geom[1],e)}catch(h){throw h instanceof np?r:h}finally{}return t};Ml.prototype.interfaces_=function(){return[]};Ml.prototype.getClass=function(){return Ml};Ml.overlayOp=function(e,t,i){var r=new Ml(e,t);return r.getResultGeometry(i)};Ml.union=function(e,t){return Ml.overlayOp(e,t,qi.UNION)};Ml.intersection=function(e,t){return Ml.overlayOp(e,t,qi.INTERSECTION)};Ml.symDifference=function(e,t){return Ml.overlayOp(e,t,qi.SYMDIFFERENCE)};Ml.difference=function(e,t){return Ml.overlayOp(e,t,qi.DIFFERENCE)};var D1=function(){this.mce=null,this.chainIndex=null;var e=arguments[0],t=arguments[1];this.mce=e,this.chainIndex=t};D1.prototype.computeIntersections=function(e,t){this.mce.computeIntersectsForChain(this.chainIndex,e.mce,e.chainIndex,t)};D1.prototype.interfaces_=function(){return[]};D1.prototype.getClass=function(){return D1};var bu=function n(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,arguments.length===2){var e=arguments[0],t=arguments[1];this._eventType=n.DELETE,this._xValue=e,this._insertEvent=t}else if(arguments.length===3){var i=arguments[0],r=arguments[1],a=arguments[2];this._eventType=n.INSERT,this._label=i,this._xValue=r,this._obj=a}},MS={INSERT:{configurable:!0},DELETE:{configurable:!0}};bu.prototype.isDelete=function(){return this._eventType===bu.DELETE};bu.prototype.setDeleteEventIndex=function(e){this._deleteEventIndex=e};bu.prototype.getObject=function(){return this._obj};bu.prototype.compareTo=function(e){var t=e;return this._xValue<t._xValue?-1:this._xValue>t._xValue?1:this._eventType<t._eventType?-1:this._eventType>t._eventType?1:0};bu.prototype.getInsertEvent=function(){return this._insertEvent};bu.prototype.isInsert=function(){return this._eventType===bu.INSERT};bu.prototype.isSameLabel=function(e){return this._label===null?!1:this._label===e._label};bu.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex};bu.prototype.interfaces_=function(){return[Vc]};bu.prototype.getClass=function(){return bu};MS.INSERT.get=function(){return 1};MS.DELETE.get=function(){return 2};Object.defineProperties(bu,MS);var TE=function(){};TE.prototype.interfaces_=function(){return[]};TE.prototype.getClass=function(){return TE};var ja=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var e=arguments[0],t=arguments[1],i=arguments[2];this._li=e,this._includeProper=t,this._recordIsolated=i};ja.prototype.isTrivialIntersection=function(e,t,i,r){if(e===i&&this._li.getIntersectionNum()===1){if(ja.isAdjacentSegments(t,r))return!0;if(e.isClosed()){var a=e.getNumPoints()-1;if(t===0&&r===a||r===0&&t===a)return!0}}return!1};ja.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};ja.prototype.setIsDoneIfProperInt=function(e){this._isDoneWhenProperInt=e};ja.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};ja.prototype.isBoundaryPointInternal=function(e,t){for(var i=t.iterator();i.hasNext();){var r=i.next(),a=r.getCoordinate();if(e.isIntersection(a))return!0}return!1};ja.prototype.hasProperIntersection=function(){return this._hasProper};ja.prototype.hasIntersection=function(){return this._hasIntersection};ja.prototype.isDone=function(){return this._isDone};ja.prototype.isBoundaryPoint=function(e,t){return t===null?!1:!!(this.isBoundaryPointInternal(e,t[0])||this.isBoundaryPointInternal(e,t[1]))};ja.prototype.setBoundaryNodes=function(e,t){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=e,this._bdyNodes[1]=t};ja.prototype.addIntersections=function(e,t,i,r){if(e===i&&t===r)return null;this.numTests++;var a=e.getCoordinates()[t],h=e.getCoordinates()[t+1],s=i.getCoordinates()[r],p=i.getCoordinates()[r+1];this._li.computeIntersection(a,h,s,p),this._li.hasIntersection()&&(this._recordIsolated&&(e.setIsolated(!1),i.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(e,t,i,r)||(this._hasIntersection=!0,(this._includeProper||!this._li.isProper())&&(e.addIntersections(this._li,t,0),i.addIntersections(this._li,r,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))};ja.prototype.interfaces_=function(){return[]};ja.prototype.getClass=function(){return ja};ja.isAdjacentSegments=function(e,t){return Math.abs(e-t)===1};var pB=function(n){function e(){n.call(this),this.events=new In,this.nOverlaps=null}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.prepareEvents=function(){var i=this;yh.sort(this.events);for(var r=0;r<this.events.size();r++){var a=i.events.get(r);a.isDelete()&&a.getInsertEvent().setDeleteEventIndex(r)}},e.prototype.computeIntersections=function(){var i=this;if(arguments.length===1){var r=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var a=0;a<this.events.size();a++){var h=i.events.get(a);if(h.isInsert()&&i.processOverlaps(a,h.getDeleteEventIndex(),h,r),r.isDone())break}}else if(arguments.length===3){if(arguments[2]instanceof ja&&Si(arguments[0],dh)&&Si(arguments[1],dh)){var s=arguments[0],p=arguments[1],x=arguments[2];this.addEdges(s,s),this.addEdges(p,p),this.computeIntersections(x)}else if(typeof arguments[2]=="boolean"&&Si(arguments[0],dh)&&arguments[1]instanceof ja){var I=arguments[0],C=arguments[1],M=arguments[2];M?this.addEdges(I,null):this.addEdges(I),this.computeIntersections(C)}}},e.prototype.addEdge=function(i,r){for(var a=this,h=i.getMonotoneChainEdge(),s=h.getStartIndexes(),p=0;p<s.length-1;p++){var x=new D1(h,p),I=new bu(r,h.getMinX(p),x);a.events.add(I),a.events.add(new bu(h.getMaxX(p),I))}},e.prototype.processOverlaps=function(i,r,a,h){for(var s=this,p=a.getObject(),x=i;x<r;x++){var I=s.events.get(x);if(I.isInsert()){var C=I.getObject();a.isSameLabel(I)||(p.computeIntersections(C,h),s.nOverlaps++)}}},e.prototype.addEdges=function(){var i=this;if(arguments.length===1)for(var r=arguments[0],a=r.iterator();a.hasNext();){var h=a.next();i.addEdge(h,h)}else if(arguments.length===2)for(var s=arguments[0],p=arguments[1],x=s.iterator();x.hasNext();){var I=x.next();i.addEdge(I,p)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(TE),fd=function(){this._min=zi.POSITIVE_INFINITY,this._max=zi.NEGATIVE_INFINITY},xL={NodeComparator:{configurable:!0}};fd.prototype.getMin=function(){return this._min};fd.prototype.intersects=function(e,t){return!(this._min>t||this._max<e)};fd.prototype.getMax=function(){return this._max};fd.prototype.toString=function(){return mh.toLineString(new ht(this._min,0),new ht(this._max,0))};fd.prototype.interfaces_=function(){return[]};fd.prototype.getClass=function(){return fd};xL.NodeComparator.get=function(){return O1};Object.defineProperties(fd,xL);var O1=function(){};O1.prototype.compare=function(e,t){var i=e,r=t,a=(i._min+i._max)/2,h=(r._min+r._max)/2;return a<h?-1:a>h?1:0};O1.prototype.interfaces_=function(){return[yv]};O1.prototype.getClass=function(){return O1};var mB=function(n){function e(){n.call(this),this._item=null;var t=arguments[0],i=arguments[1],r=arguments[2];this._min=t,this._max=i,this._item=r}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.query=function(i,r,a){if(!this.intersects(i,r))return null;a.visitItem(this._item)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(fd),gB=function(n){function e(){n.call(this),this._node1=null,this._node2=null;var t=arguments[0],i=arguments[1];this._node1=t,this._node2=i,this.buildExtent(this._node1,this._node2)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.buildExtent=function(i,r){this._min=Math.min(i._min,r._min),this._max=Math.max(i._max,r._max)},e.prototype.query=function(i,r,a){if(!this.intersects(i,r))return null;this._node1!==null&&this._node1.query(i,r,a),this._node2!==null&&this._node2.query(i,r,a)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(fd),dd=function(){this._leaves=new In,this._root=null,this._level=0};dd.prototype.buildTree=function(){var e=this;yh.sort(this._leaves,new fd.NodeComparator);for(var t=this._leaves,i=null,r=new In;;){if(e.buildLevel(t,r),r.size()===1)return r.get(0);i=t,t=r,r=i}};dd.prototype.insert=function(e,t,i){if(this._root!==null)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new mB(e,t,i))};dd.prototype.query=function(e,t,i){this.init(),this._root.query(e,t,i)};dd.prototype.buildRoot=function(){if(this._root!==null)return null;this._root=this.buildTree()};dd.prototype.printNode=function(e){Ua.out.println(mh.toLineString(new ht(e._min,this._level),new ht(e._max,this._level)))};dd.prototype.init=function(){if(this._root!==null)return null;this.buildRoot()};dd.prototype.buildLevel=function(e,t){this._level++,t.clear();for(var i=0;i<e.size();i+=2){var r=e.get(i),a=i+1<e.size()?e.get(i):null;if(a===null)t.add(r);else{var h=new gB(e.get(i),e.get(i+1));t.add(h)}}};dd.prototype.interfaces_=function(){return[]};dd.prototype.getClass=function(){return dd};var Pv=function(){this._items=new In};Pv.prototype.visitItem=function(e){this._items.add(e)};Pv.prototype.getItems=function(){return this._items};Pv.prototype.interfaces_=function(){return[Qp]};Pv.prototype.getClass=function(){return Pv};var Rv=function(){this._index=null;var e=arguments[0];if(!Si(e,Jp))throw new Xs("Argument must be Polygonal");this._index=new sg(e)},LS={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};Rv.prototype.locate=function(e){var t=new cf(e),i=new Dv(t);return this._index.query(e.y,e.y,i),t.getLocation()};Rv.prototype.interfaces_=function(){return[Mv]};Rv.prototype.getClass=function(){return Rv};LS.SegmentVisitor.get=function(){return Dv};LS.IntervalIndexedGeometry.get=function(){return sg};Object.defineProperties(Rv,LS);var Dv=function(){this._counter=null;var e=arguments[0];this._counter=e};Dv.prototype.visitItem=function(e){var t=e;this._counter.countSegment(t.getCoordinate(0),t.getCoordinate(1))};Dv.prototype.interfaces_=function(){return[Qp]};Dv.prototype.getClass=function(){return Dv};var sg=function(){this._index=new dd;var e=arguments[0];this.init(e)};sg.prototype.init=function(e){for(var t=this,i=ka.getLines(e),r=i.iterator();r.hasNext();){var a=r.next(),h=a.getCoordinates();t.addLine(h)}};sg.prototype.addLine=function(e){for(var t=this,i=1;i<e.length;i++){var r=new ci(e[i-1],e[i]),a=Math.min(r.p0.y,r.p1.y),h=Math.max(r.p0.y,r.p1.y);t._index.insert(a,h,r)}};sg.prototype.query=function(){if(arguments.length===2){var e=arguments[0],t=arguments[1],i=new Pv;return this._index.query(e,t,i),i.getItems()}else if(arguments.length===3){var r=arguments[0],a=arguments[1],h=arguments[2];this._index.query(r,a,h)}};sg.prototype.interfaces_=function(){return[]};sg.prototype.getClass=function(){return sg};var n1=function(n){function e(){if(n.call(this),this._parentGeom=null,this._lineEdgeMap=new iL,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new xh,arguments.length===2){var t=arguments[0],i=arguments[1],r=Nc.OGC_SFS_BOUNDARY_RULE;this._argIndex=t,this._parentGeom=i,this._boundaryNodeRule=r,i!==null&&this.add(i)}else if(arguments.length===3){var a=arguments[0],h=arguments[1],s=arguments[2];this._argIndex=a,this._parentGeom=h,this._boundaryNodeRule=s,h!==null&&this.add(h)}}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.insertBoundaryPoint=function(i,r){var a=this._nodes.addNode(r),h=a.getLabel(),s=1,p=vt.NONE;p=h.getLocation(i,fn.ON),p===vt.BOUNDARY&&s++;var x=e.determineBoundary(this._boundaryNodeRule,s);h.setLocation(i,x)},e.prototype.computeSelfNodes=function(){if(arguments.length===2){var i=arguments[0],r=arguments[1];return this.computeSelfNodes(i,r,!1)}else if(arguments.length===3){var a=arguments[0],h=arguments[1],s=arguments[2],p=new ja(a,!0,!1);p.setIsDoneIfProperInt(s);var x=this.createEdgeSetIntersector(),I=this._parentGeom instanceof od||this._parentGeom instanceof ea||this._parentGeom instanceof td,C=h||!I;return x.computeIntersections(this._edges,p,C),this.addSelfIntersectionNodes(this._argIndex),p}},e.prototype.computeSplitEdges=function(i){for(var r=this._edges.iterator();r.hasNext();){var a=r.next();a.eiList.addSplitEdges(i)}},e.prototype.computeEdgeIntersections=function(i,r,a){var h=new ja(r,a,!0);h.setBoundaryNodes(this.getBoundaryNodes(),i.getBoundaryNodes());var s=this.createEdgeSetIntersector();return s.computeIntersections(this._edges,i._edges,h),h},e.prototype.getGeometry=function(){return this._parentGeom},e.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},e.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},e.prototype.addPoint=function(){if(arguments[0]instanceof yu){var i=arguments[0],r=i.getCoordinate();this.insertPoint(this._argIndex,r,vt.INTERIOR)}else if(arguments[0]instanceof ht){var a=arguments[0];this.insertPoint(this._argIndex,a,vt.INTERIOR)}},e.prototype.addPolygon=function(i){var r=this;this.addPolygonRing(i.getExteriorRing(),vt.EXTERIOR,vt.INTERIOR);for(var a=0;a<i.getNumInteriorRing();a++){var h=i.getInteriorRingN(a);r.addPolygonRing(h,vt.INTERIOR,vt.EXTERIOR)}},e.prototype.addEdge=function(i){this.insertEdge(i);var r=i.getCoordinates();this.insertPoint(this._argIndex,r[0],vt.BOUNDARY),this.insertPoint(this._argIndex,r[r.length-1],vt.BOUNDARY)},e.prototype.addLineString=function(i){var r=gr.removeRepeatedPoints(i.getCoordinates());if(r.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=r[0],null;var a=new IE(r,new is(this._argIndex,vt.INTERIOR));this._lineEdgeMap.put(i,a),this.insertEdge(a),Zi.isTrue(r.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,r[0]),this.insertBoundaryPoint(this._argIndex,r[r.length-1])},e.prototype.getInvalidPoint=function(){return this._invalidPoint},e.prototype.getBoundaryPoints=function(){for(var i=this.getBoundaryNodes(),r=new Array(i.size()).fill(null),a=0,h=i.iterator();h.hasNext();){var s=h.next();r[a++]=s.getCoordinate().copy()}return r},e.prototype.getBoundaryNodes=function(){return this._boundaryNodes===null&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},e.prototype.addSelfIntersectionNode=function(i,r,a){if(this.isBoundaryNode(i,r))return null;a===vt.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(i,r):this.insertPoint(i,r,a)},e.prototype.addPolygonRing=function(i,r,a){if(i.isEmpty())return null;var h=gr.removeRepeatedPoints(i.getCoordinates());if(h.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=h[0],null;var s=r,p=a;Nn.isCCW(h)&&(s=a,p=r);var x=new IE(h,new is(this._argIndex,vt.BOUNDARY,s,p));this._lineEdgeMap.put(i,x),this.insertEdge(x),this.insertPoint(this._argIndex,h[0],vt.BOUNDARY)},e.prototype.insertPoint=function(i,r,a){var h=this._nodes.addNode(r),s=h.getLabel();s===null?h._label=new is(i,a):s.setLocation(i,a)},e.prototype.createEdgeSetIntersector=function(){return new pB},e.prototype.addSelfIntersectionNodes=function(i){for(var r=this,a=this._edges.iterator();a.hasNext();)for(var h=a.next(),s=h.getLabel().getLocation(i),p=h.eiList.iterator();p.hasNext();){var x=p.next();r.addSelfIntersectionNode(i,x.coord,s)}},e.prototype.add=function(){if(arguments.length===1){var i=arguments[0];if(i.isEmpty())return null;if(i instanceof td&&(this._useBoundaryDeterminationRule=!1),i instanceof ea)this.addPolygon(i);else if(i instanceof fo)this.addLineString(i);else if(i instanceof yu)this.addPoint(i);else if(i instanceof Tv)this.addCollection(i);else if(i instanceof Qm)this.addCollection(i);else if(i instanceof td)this.addCollection(i);else if(i instanceof Sl)this.addCollection(i);else throw new Error(i.getClass().getName())}else return n.prototype.add.apply(this,arguments)},e.prototype.addCollection=function(i){for(var r=this,a=0;a<i.getNumGeometries();a++){var h=i.getGeometryN(a);r.add(h)}},e.prototype.locate=function(i){return Si(this._parentGeom,Jp)&&this._parentGeom.getNumGeometries()>50?(this._areaPtLocator===null&&(this._areaPtLocator=new Rv(this._parentGeom)),this._areaPtLocator.locate(i)):this._ptLocator.locate(i,this._parentGeom)},e.prototype.findEdge=function(){if(arguments.length===1){var i=arguments[0];return this._lineEdgeMap.get(i)}else return n.prototype.findEdge.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.determineBoundary=function(i,r){return i.isInBoundary(r)?vt.BOUNDARY:vt.INTERIOR},e}(no),Ov=function(){if(this._li=new fg,this._resultPrecisionModel=null,this._arg=null,arguments.length===1){var e=arguments[0];this.setComputationPrecision(e.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new n1(0,e)}else if(arguments.length===2){var t=arguments[0],i=arguments[1],r=Nc.OGC_SFS_BOUNDARY_RULE;t.getPrecisionModel().compareTo(i.getPrecisionModel())>=0?this.setComputationPrecision(t.getPrecisionModel()):this.setComputationPrecision(i.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new n1(0,t,r),this._arg[1]=new n1(1,i,r)}else if(arguments.length===3){var a=arguments[0],h=arguments[1],s=arguments[2];a.getPrecisionModel().compareTo(h.getPrecisionModel())>=0?this.setComputationPrecision(a.getPrecisionModel()):this.setComputationPrecision(h.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new n1(0,a,s),this._arg[1]=new n1(1,h,s)}};Ov.prototype.getArgGeometry=function(e){return this._arg[e].getGeometry()};Ov.prototype.setComputationPrecision=function(e){this._resultPrecisionModel=e,this._li.setPrecisionModel(this._resultPrecisionModel)};Ov.prototype.interfaces_=function(){return[]};Ov.prototype.getClass=function(){return Ov};var Hm=function(){};Hm.prototype.interfaces_=function(){return[]};Hm.prototype.getClass=function(){return Hm};Hm.map=function(){if(arguments[0]instanceof bi&&Si(arguments[1],Hm.MapOp)){for(var e=arguments[0],t=arguments[1],i=new In,r=0;r<e.getNumGeometries();r++){var a=t.map(e.getGeometryN(r));a!==null&&i.add(a)}return e.getFactory().buildGeometry(i)}else if(Si(arguments[0],Yo)&&Si(arguments[1],Hm.MapOp)){for(var h=arguments[0],s=arguments[1],p=new In,x=h.iterator();x.hasNext();){var I=x.next(),C=s.map(I);C!==null&&p.add(C)}return p}};Hm.MapOp=function(){};var qi=function(n){function e(){var t=arguments[0],i=arguments[1];n.call(this,t,i),this._ptLocator=new xh,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new vh,this._resultPolyList=new In,this._resultLineList=new In,this._resultPointList=new In,this._graph=new no(new hL),this._geomFact=t.getFactory()}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.insertUniqueEdge=function(i){var r=this._edgeList.findEqualEdge(i);if(r!==null){var a=r.getLabel(),h=i.getLabel();r.isPointwiseEqual(i)||(h=new is(i.getLabel()),h.flip());var s=r.getDepth();s.isNull()&&s.add(a),s.add(h),a.merge(h)}else this._edgeList.add(i)},e.prototype.getGraph=function(){return this._graph},e.prototype.cancelDuplicateResultEdges=function(){for(var i=this._graph.getEdgeEnds().iterator();i.hasNext();){var r=i.next(),a=r.getSym();r.isInResult()&&a.isInResult()&&(r.setInResult(!1),a.setInResult(!1))}},e.prototype.isCoveredByLA=function(i){return!!(this.isCovered(i,this._resultLineList)||this.isCovered(i,this._resultPolyList))},e.prototype.computeGeometry=function(i,r,a,h){var s=new In;return s.addAll(i),s.addAll(r),s.addAll(a),s.isEmpty()?e.createEmptyResult(h,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(s)},e.prototype.mergeSymLabels=function(){for(var i=this._graph.getNodes().iterator();i.hasNext();){var r=i.next();r.getEdges().mergeSymLabels()}},e.prototype.isCovered=function(i,r){for(var a=this,h=r.iterator();h.hasNext();){var s=h.next(),p=a._ptLocator.locate(i,s);if(p!==vt.EXTERIOR)return!0}return!1},e.prototype.replaceCollapsedEdges=function(){for(var i=new In,r=this._edgeList.iterator();r.hasNext();){var a=r.next();a.isCollapsed()&&(r.remove(),i.add(a.getCollapsedEdge()))}this._edgeList.addAll(i)},e.prototype.updateNodeLabelling=function(){for(var i=this._graph.getNodes().iterator();i.hasNext();){var r=i.next(),a=r.getEdges().getLabel();r.getLabel().merge(a)}},e.prototype.getResultGeometry=function(i){return this.computeOverlay(i),this._resultGeom},e.prototype.insertUniqueEdges=function(i){for(var r=this,a=i.iterator();a.hasNext();){var h=a.next();r.insertUniqueEdge(h)}},e.prototype.computeOverlay=function(i){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var r=new In;this._arg[0].computeSplitEdges(r),this._arg[1].computeSplitEdges(r),this.insertUniqueEdges(r),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),rg.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(i),this.cancelDuplicateResultEdges();var a=new vu(this._geomFact);a.add(this._graph),this._resultPolyList=a.getPolygons();var h=new Ef(this,this._geomFact,this._ptLocator);this._resultLineList=h.build(i);var s=new I_(this,this._geomFact,this._ptLocator);this._resultPointList=s.build(i),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,i)},e.prototype.labelIncompleteNode=function(i,r){var a=this._ptLocator.locate(i.getCoordinate(),this._arg[r].getGeometry());i.getLabel().setLocation(r,a)},e.prototype.copyPoints=function(i){for(var r=this,a=this._arg[i].getNodeIterator();a.hasNext();){var h=a.next(),s=r._graph.addNode(h.getCoordinate());s.setLabel(i,h.getLabel().getLocation(i))}},e.prototype.findResultAreaEdges=function(i){for(var r=this._graph.getEdgeEnds().iterator();r.hasNext();){var a=r.next(),h=a.getLabel();h.isArea()&&!a.isInteriorAreaEdge()&&e.isResultOfOp(h.getLocation(0,fn.RIGHT),h.getLocation(1,fn.RIGHT),i)&&a.setInResult(!0)}},e.prototype.computeLabelsFromDepths=function(){for(var i=this._edgeList.iterator();i.hasNext();){var r=i.next(),a=r.getLabel(),h=r.getDepth();if(!h.isNull()){h.normalize();for(var s=0;s<2;s++)!a.isNull(s)&&a.isArea()&&!h.isNull(s)&&(h.getDelta(s)===0?a.toLine(s):(Zi.isTrue(!h.isNull(s,fn.LEFT),"depth of LEFT side has not been initialized"),a.setLocation(s,fn.LEFT,h.getLocation(s,fn.LEFT)),Zi.isTrue(!h.isNull(s,fn.RIGHT),"depth of RIGHT side has not been initialized"),a.setLocation(s,fn.RIGHT,h.getLocation(s,fn.RIGHT))))}}},e.prototype.computeLabelling=function(){for(var i=this,r=this._graph.getNodes().iterator();r.hasNext();){var a=r.next();a.getEdges().computeLabelling(i._arg)}this.mergeSymLabels(),this.updateNodeLabelling()},e.prototype.labelIncompleteNodes=function(){for(var i=this,r=this._graph.getNodes().iterator();r.hasNext();){var a=r.next(),h=a.getLabel();a.isIsolated()&&(h.isNull(0)?i.labelIncompleteNode(a,0):i.labelIncompleteNode(a,1)),a.getEdges().updateLabelling(h)}},e.prototype.isCoveredByA=function(i){return!!this.isCovered(i,this._resultPolyList)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ov);qi.overlayOp=function(n,e,t){var i=new qi(n,e),r=i.getResultGeometry(t);return r};qi.intersection=function(n,e){if(n.isEmpty()||e.isEmpty())return qi.createEmptyResult(qi.INTERSECTION,n,e,n.getFactory());if(n.isGeometryCollection()){var t=e;return w_.map(n,{interfaces_:function(){return[Hm.MapOp]},map:function(i){return i.intersection(t)}})}return n.checkNotGeometryCollection(n),n.checkNotGeometryCollection(e),Ml.overlayOp(n,e,qi.INTERSECTION)};qi.symDifference=function(n,e){if(n.isEmpty()||e.isEmpty()){if(n.isEmpty()&&e.isEmpty())return qi.createEmptyResult(qi.SYMDIFFERENCE,n,e,n.getFactory());if(n.isEmpty())return e.copy();if(e.isEmpty())return n.copy()}return n.checkNotGeometryCollection(n),n.checkNotGeometryCollection(e),Ml.overlayOp(n,e,qi.SYMDIFFERENCE)};qi.resultDimension=function(n,e,t){var i=e.getDimension(),r=t.getDimension(),a=-1;switch(n){case qi.INTERSECTION:a=Math.min(i,r);break;case qi.UNION:a=Math.max(i,r);break;case qi.DIFFERENCE:a=i;break;case qi.SYMDIFFERENCE:a=Math.max(i,r);break}return a};qi.createEmptyResult=function(n,e,t,i){var r=null;switch(qi.resultDimension(n,e,t)){case-1:r=i.createGeometryCollection(new Array(0).fill(null));break;case 0:r=i.createPoint();break;case 1:r=i.createLineString();break;case 2:r=i.createPolygon();break}return r};qi.difference=function(n,e){return n.isEmpty()?qi.createEmptyResult(qi.DIFFERENCE,n,e,n.getFactory()):e.isEmpty()?n.copy():(n.checkNotGeometryCollection(n),n.checkNotGeometryCollection(e),Ml.overlayOp(n,e,qi.DIFFERENCE))};qi.isResultOfOp=function(){if(arguments.length===2){var n=arguments[0],e=arguments[1],t=n.getLocation(0),i=n.getLocation(1);return qi.isResultOfOp(t,i,e)}else if(arguments.length===3){var r=arguments[0],a=arguments[1],h=arguments[2];switch(r===vt.BOUNDARY&&(r=vt.INTERIOR),a===vt.BOUNDARY&&(a=vt.INTERIOR),h){case qi.INTERSECTION:return r===vt.INTERIOR&&a===vt.INTERIOR;case qi.UNION:return r===vt.INTERIOR||a===vt.INTERIOR;case qi.DIFFERENCE:return r===vt.INTERIOR&&a!==vt.INTERIOR;case qi.SYMDIFFERENCE:return r===vt.INTERIOR&&a!==vt.INTERIOR||r!==vt.INTERIOR&&a===vt.INTERIOR}return!1}};qi.INTERSECTION=1;qi.UNION=2;qi.DIFFERENCE=3;qi.SYMDIFFERENCE=4;var Kp=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new xh,this._seg=new ci;var e=arguments[0],t=arguments[1];this._g=e,this._boundaryDistanceTolerance=t,this._linework=this.extractLinework(e)};Kp.prototype.isWithinToleranceOfBoundary=function(e){for(var t=this,i=0;i<this._linework.getNumGeometries();i++)for(var r=t._linework.getGeometryN(i),a=r.getCoordinateSequence(),h=0;h<a.size()-1;h++){a.getCoordinate(h,t._seg.p0),a.getCoordinate(h+1,t._seg.p1);var s=t._seg.distance(e);if(s<=t._boundaryDistanceTolerance)return!0}return!1};Kp.prototype.getLocation=function(e){return this.isWithinToleranceOfBoundary(e)?vt.BOUNDARY:this._ptLocator.locate(e,this._g)};Kp.prototype.extractLinework=function(e){var t=new Nv;e.apply(t);var i=t.getLinework(),r=mr.toLineStringArray(i);return e.getFactory().createMultiLineString(r)};Kp.prototype.interfaces_=function(){return[]};Kp.prototype.getClass=function(){return Kp};var Nv=function(){this._linework=null,this._linework=new In};Nv.prototype.getLinework=function(){return this._linework};Nv.prototype.filter=function(e){var t=this;if(e instanceof ea){var i=e;this._linework.add(i.getExteriorRing());for(var r=0;r<i.getNumInteriorRing();r++)t._linework.add(i.getInteriorRingN(r))}};Nv.prototype.interfaces_=function(){return[mf]};Nv.prototype.getClass=function(){return Nv};var og=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var e=arguments[0];this._g=e};og.prototype.extractPoints=function(e,t,i){for(var r=this,a=e.getCoordinates(),h=0;h<a.length-1;h++)r.computeOffsetPoints(a[h],a[h+1],t,i)};og.prototype.setSidesToGenerate=function(e,t){this._doLeft=e,this._doRight=t};og.prototype.getPoints=function(e){for(var t=this,i=new In,r=ka.getLines(this._g),a=r.iterator();a.hasNext();){var h=a.next();t.extractPoints(h,e,i)}return i};og.prototype.computeOffsetPoints=function(e,t,i,r){var a=t.x-e.x,h=t.y-e.y,s=Math.sqrt(a*a+h*h),p=i*a/s,x=i*h/s,I=(t.x+e.x)/2,C=(t.y+e.y)/2;if(this._doLeft){var M=new ht(I-x,C+p);r.add(M)}if(this._doRight){var O=new ht(I+x,C-p);r.add(O)}};og.prototype.interfaces_=function(){return[]};og.prototype.getClass=function(){return og};var $u=function n(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=n.TOLERANCE,this._testCoords=new In;var e=arguments[0],t=arguments[1],i=arguments[2];this._boundaryDistanceTolerance=n.computeBoundaryDistanceTolerance(e,t),this._geom=[e,t,i],this._locFinder=[new Kp(this._geom[0],this._boundaryDistanceTolerance),new Kp(this._geom[1],this._boundaryDistanceTolerance),new Kp(this._geom[2],this._boundaryDistanceTolerance)]},bL={TOLERANCE:{configurable:!0}};$u.prototype.reportResult=function(e,t,i){Ua.out.println("Overlay result invalid - A:"+vt.toLocationSymbol(t[0])+" B:"+vt.toLocationSymbol(t[1])+" expected:"+(i?"i":"e")+" actual:"+vt.toLocationSymbol(t[2]))};$u.prototype.isValid=function(e){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var t=this.checkValid(e);return t};$u.prototype.checkValid=function(){var e=this;if(arguments.length===1){for(var t=arguments[0],i=0;i<this._testCoords.size();i++){var r=e._testCoords.get(i);if(!e.checkValid(t,r))return e._invalidLocation=r,!1}return!0}else if(arguments.length===2){var a=arguments[0],h=arguments[1];return this._location[0]=this._locFinder[0].getLocation(h),this._location[1]=this._locFinder[1].getLocation(h),this._location[2]=this._locFinder[2].getLocation(h),$u.hasLocation(this._location,vt.BOUNDARY)?!0:this.isValidResult(a,this._location)}};$u.prototype.addTestPts=function(e){var t=new og(e);this._testCoords.addAll(t.getPoints(5*this._boundaryDistanceTolerance))};$u.prototype.isValidResult=function(e,t){var i=qi.isResultOfOp(t[0],t[1],e),r=t[2]===vt.INTERIOR,a=!(i^r);return a||this.reportResult(e,t,i),a};$u.prototype.getInvalidLocation=function(){return this._invalidLocation};$u.prototype.interfaces_=function(){return[]};$u.prototype.getClass=function(){return $u};$u.hasLocation=function(e,t){for(var i=0;i<3;i++)if(e[i]===t)return!0;return!1};$u.computeBoundaryDistanceTolerance=function(e,t){return Math.min(Io.computeSizeBasedSnapTolerance(e),Io.computeSizeBasedSnapTolerance(t))};$u.isValid=function(e,t,i,r){var a=new $u(e,t,r);return a.isValid(i)};bL.TOLERANCE.get=function(){return 1e-6};Object.defineProperties($u,bL);var qu=function n(e){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=n.extractFactory(e),this._inputGeoms=e};qu.prototype.extractElements=function(e,t){var i=this;if(e===null)return null;for(var r=0;r<e.getNumGeometries();r++){var a=e.getGeometryN(r);i._skipEmpty&&a.isEmpty()||t.add(a)}};qu.prototype.combine=function(){for(var e=this,t=new In,i=this._inputGeoms.iterator();i.hasNext();){var r=i.next();e.extractElements(r,t)}return t.size()===0?this._geomFactory!==null?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(t)};qu.prototype.interfaces_=function(){return[]};qu.prototype.getClass=function(){return qu};qu.combine=function(){if(arguments.length===1){var e=arguments[0],t=new qu(e);return t.combine()}else if(arguments.length===2){var i=arguments[0],r=arguments[1],a=new qu(qu.createList(i,r));return a.combine()}else if(arguments.length===3){var h=arguments[0],s=arguments[1],p=arguments[2],x=new qu(qu.createList(h,s,p));return x.combine()}};qu.extractFactory=function(e){return e.isEmpty()?null:e.iterator().next().getFactory()};qu.createList=function(){if(arguments.length===2){var e=arguments[0],t=arguments[1],i=new In;return i.add(e),i.add(t),i}else if(arguments.length===3){var r=arguments[0],a=arguments[1],h=arguments[2],s=new In;return s.add(r),s.add(a),s.add(h),s}};var Fo=function(){this._inputPolys=null,this._geomFactory=null;var e=arguments[0];this._inputPolys=e,this._inputPolys===null&&(this._inputPolys=new In)},EL={STRTREE_NODE_CAPACITY:{configurable:!0}};Fo.prototype.reduceToGeometries=function(e){for(var t=this,i=new In,r=e.iterator();r.hasNext();){var a=r.next(),h=null;Si(a,dh)?h=t.unionTree(a):a instanceof bi&&(h=a),i.add(h)}return i};Fo.prototype.extractByEnvelope=function(e,t,i){for(var r=new In,a=0;a<t.getNumGeometries();a++){var h=t.getGeometryN(a);h.getEnvelopeInternal().intersects(e)?r.add(h):i.add(h)}return this._geomFactory.buildGeometry(r)};Fo.prototype.unionOptimized=function(e,t){var i=e.getEnvelopeInternal(),r=t.getEnvelopeInternal();if(!i.intersects(r)){var a=qu.combine(e,t);return a}if(e.getNumGeometries()<=1&&t.getNumGeometries()<=1)return this.unionActual(e,t);var h=i.intersection(r);return this.unionUsingEnvelopeIntersection(e,t,h)};Fo.prototype.union=function(){if(this._inputPolys===null)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var e=new aL(Fo.STRTREE_NODE_CAPACITY),t=this._inputPolys.iterator();t.hasNext();){var i=t.next();e.insert(i.getEnvelopeInternal(),i)}this._inputPolys=null;var r=e.itemsTree(),a=this.unionTree(r);return a};Fo.prototype.binaryUnion=function(){if(arguments.length===1){var e=arguments[0];return this.binaryUnion(e,0,e.size())}else if(arguments.length===3){var t=arguments[0],i=arguments[1],r=arguments[2];if(r-i<=1){var a=Fo.getGeometry(t,i);return this.unionSafe(a,null)}else{if(r-i===2)return this.unionSafe(Fo.getGeometry(t,i),Fo.getGeometry(t,i+1));var h=Math.trunc((r+i)/2),s=this.binaryUnion(t,i,h),p=this.binaryUnion(t,h,r);return this.unionSafe(s,p)}}};Fo.prototype.repeatedUnion=function(e){for(var t=null,i=e.iterator();i.hasNext();){var r=i.next();t===null?t=r.copy():t=t.union(r)}return t};Fo.prototype.unionSafe=function(e,t){return e===null&&t===null?null:e===null?t.copy():t===null?e.copy():this.unionOptimized(e,t)};Fo.prototype.unionActual=function(e,t){return Fo.restrictToPolygons(e.union(t))};Fo.prototype.unionTree=function(e){var t=this.reduceToGeometries(e),i=this.binaryUnion(t);return i};Fo.prototype.unionUsingEnvelopeIntersection=function(e,t,i){var r=new In,a=this.extractByEnvelope(i,e,r),h=this.extractByEnvelope(i,t,r),s=this.unionActual(a,h);r.add(s);var p=qu.combine(r);return p};Fo.prototype.bufferUnion=function(){if(arguments.length===1){var e=arguments[0],t=e.get(0).getFactory(),i=t.buildGeometry(e),r=i.buffer(0);return r}else if(arguments.length===2){var a=arguments[0],h=arguments[1],s=a.getFactory(),p=s.createGeometryCollection([a,h]),x=p.buffer(0);return x}};Fo.prototype.interfaces_=function(){return[]};Fo.prototype.getClass=function(){return Fo};Fo.restrictToPolygons=function(e){if(Si(e,Jp))return e;var t=$d.getPolygons(e);return t.size()===1?t.get(0):e.getFactory().createMultiPolygon(mr.toPolygonArray(t))};Fo.getGeometry=function(e,t){return t>=e.size()?null:e.get(t)};Fo.union=function(e){var t=new Fo(e);return t.union()};EL.STRTREE_NODE_CAPACITY.get=function(){return 4};Object.defineProperties(Fo,EL);var SE=function(){};SE.prototype.interfaces_=function(){return[]};SE.prototype.getClass=function(){return SE};SE.union=function(e,t){if(e.isEmpty()||t.isEmpty()){if(e.isEmpty()&&t.isEmpty())return qi.createEmptyResult(qi.UNION,e,t,e.getFactory());if(e.isEmpty())return t.copy();if(t.isEmpty())return e.copy()}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),Ml.overlayOp(e,t,qi.UNION)};function dg(){return new CE}function CE(){this.reset()}CE.prototype={constructor:CE,reset:function(){this.s=this.t=0},add:function(n){i2(Jb,n,this.t),i2(this,Jb.s,this.s),this.s?this.t+=Jb.t:this.s=Jb.t},valueOf:function(){return this.s}};var Jb=new CE;function i2(n,e,t){var i=n.s=e+t,r=i-e,a=i-r;n.t=e-a+(t-r)}var co=1e-6,ys=Math.PI,Jd=ys/2,r2=ys/4,ap=ys*2,km=180/ys,of=ys/180,wl=Math.abs,_B=Math.atan,kv=Math.atan2,Ko=Math.cos,Jo=Math.sin,tx=Math.sqrt;function wL(n){return n>1?0:n<-1?ys:Math.acos(n)}function Fv(n){return n>1?Jd:n<-1?-Jd:Math.asin(n)}function f1(){}function AE(n,e){n&&o2.hasOwnProperty(n.type)&&o2[n.type](n,e)}var s2={Feature:function(n,e){AE(n.geometry,e)},FeatureCollection:function(n,e){for(var t=n.features,i=-1,r=t.length;++i<r;)AE(t[i].geometry,e)}},o2={Sphere:function(n,e){e.sphere()},Point:function(n,e){n=n.coordinates,e.point(n[0],n[1],n[2])},MultiPoint:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)n=t[i],e.point(n[0],n[1],n[2])},LineString:function(n,e){LT(n.coordinates,e,0)},MultiLineString:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)LT(t[i],e,0)},Polygon:function(n,e){a2(n.coordinates,e)},MultiPolygon:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)a2(t[i],e)},GeometryCollection:function(n,e){for(var t=n.geometries,i=-1,r=t.length;++i<r;)AE(t[i],e)}};function LT(n,e,t){var i=-1,r=n.length-t,a;for(e.lineStart();++i<r;)a=n[i],e.point(a[0],a[1],a[2]);e.lineEnd()}function a2(n,e){var t=-1,i=n.length;for(e.polygonStart();++t<i;)LT(n[t],e,1);e.polygonEnd()}function yB(n,e){n&&s2.hasOwnProperty(n.type)?s2[n.type](n,e):AE(n,e)}dg();dg();function PT(n){return[kv(n[1],n[0]),Fv(n[2])]}function Bv(n){var e=n[0],t=n[1],i=Ko(t);return[i*Ko(e),i*Jo(e),Jo(t)]}function Qb(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function ME(n,e){return[n[1]*e[2]-n[2]*e[1],n[2]*e[0]-n[0]*e[2],n[0]*e[1]-n[1]*e[0]]}function lT(n,e){n[0]+=e[0],n[1]+=e[1],n[2]+=e[2]}function $b(n,e){return[n[0]*e,n[1]*e,n[2]*e]}function RT(n){var e=tx(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=e,n[1]/=e,n[2]/=e}dg();function IL(n,e){function t(i,r){return i=n(i,r),e(i[0],i[1])}return n.invert&&e.invert&&(t.invert=function(i,r){return i=e.invert(i,r),i&&n.invert(i[0],i[1])}),t}function DT(n,e){return[n>ys?n-ap:n<-ys?n+ap:n,e]}DT.invert=DT;function vB(n,e,t){return(n%=ap)?e||t?IL(u2(n),c2(e,t)):u2(n):e||t?c2(e,t):DT}function l2(n){return function(e,t){return e+=n,[e>ys?e-ap:e<-ys?e+ap:e,t]}}function u2(n){var e=l2(n);return e.invert=l2(-n),e}function c2(n,e){var t=Ko(n),i=Jo(n),r=Ko(e),a=Jo(e);function h(s,p){var x=Ko(p),I=Ko(s)*x,C=Jo(s)*x,M=Jo(p),O=M*t+I*i;return[kv(C*r-O*a,I*t-M*i),Fv(O*r+C*a)]}return h.invert=function(s,p){var x=Ko(p),I=Ko(s)*x,C=Jo(s)*x,M=Jo(p),O=M*r-C*a;return[kv(C*r+M*a,I*t+O*i),Fv(O*t-I*i)]},h}function xB(n,e,t,i,r,a){if(t){var h=Ko(e),s=Jo(e),p=i*t;r==null?(r=e+i*ap,a=e-p/2):(r=h2(h,r),a=h2(h,a),(i>0?r<a:r>a)&&(r+=i*ap));for(var x,I=r;i>0?I>a:I<a;I-=p)x=PT([h,-s*Ko(I),-s*Jo(I)]),n.point(x[0],x[1])}}function h2(n,e){e=Bv(e),e[0]-=n,RT(e);var t=wL(-e[1]);return((-e[2]<0?-t:t)+ap-co)%ap}function TL(){var n=[],e;return{point:function(t,i){e.push([t,i])},lineStart:function(){n.push(e=[])},lineEnd:f1,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var t=n;return n=[],e=null,t}}}function bB(n,e,t,i,r,a){var h=n[0],s=n[1],p=e[0],x=e[1],I=0,C=1,M=p-h,O=x-s,k;if(k=t-h,!(!M&&k>0)){if(k/=M,M<0){if(k<I)return;k<C&&(C=k)}else if(M>0){if(k>C)return;k>I&&(I=k)}if(k=r-h,!(!M&&k<0)){if(k/=M,M<0){if(k>C)return;k>I&&(I=k)}else if(M>0){if(k<I)return;k<C&&(C=k)}if(k=i-s,!(!O&&k>0)){if(k/=O,O<0){if(k<I)return;k<C&&(C=k)}else if(O>0){if(k>C)return;k>I&&(I=k)}if(k=a-s,!(!O&&k<0)){if(k/=O,O<0){if(k>C)return;k>I&&(I=k)}else if(O>0){if(k<I)return;k<C&&(C=k)}return I>0&&(n[0]=h+I*M,n[1]=s+I*O),C<1&&(e[0]=h+C*M,e[1]=s+C*O),!0}}}}}function cE(n,e){return wl(n[0]-e[0])<co&&wl(n[1]-e[1])<co}function eE(n,e,t,i){this.x=n,this.z=e,this.o=t,this.e=i,this.v=!1,this.n=this.p=null}function SL(n,e,t,i,r){var a=[],h=[],s,p;if(n.forEach(function(k){if(!((z=k.length-1)<=0)){var z,G=k[0],q=k[z],Z;if(cE(G,q)){for(r.lineStart(),s=0;s<z;++s)r.point((G=k[s])[0],G[1]);r.lineEnd();return}a.push(Z=new eE(G,k,null,!0)),h.push(Z.o=new eE(G,null,Z,!1)),a.push(Z=new eE(q,k,null,!1)),h.push(Z.o=new eE(q,null,Z,!0))}}),!!a.length){for(h.sort(e),f2(a),f2(h),s=0,p=h.length;s<p;++s)h[s].e=t=!t;for(var x=a[0],I,C;;){for(var M=x,O=!0;M.v;)if((M=M.n)===x)return;I=M.z,r.lineStart();do{if(M.v=M.o.v=!0,M.e){if(O)for(s=0,p=I.length;s<p;++s)r.point((C=I[s])[0],C[1]);else i(M.x,M.n.x,1,r);M=M.n}else{if(O)for(I=M.p.z,s=I.length-1;s>=0;--s)r.point((C=I[s])[0],C[1]);else i(M.x,M.p.x,-1,r);M=M.p}M=M.o,I=M.z,O=!O}while(!M.v);r.lineEnd()}}}function f2(n){if(e=n.length){for(var e,t=0,i=n[0],r;++t<e;)i.n=r=n[t],r.p=i,i=r;i.n=r=n[0],r.p=i}}function CL(n,e){return n<e?-1:n>e?1:n>=e?0:NaN}function EB(n){return n.length===1&&(n=wB(n)),{left:function(e,t,i,r){for(i==null&&(i=0),r==null&&(r=e.length);i<r;){var a=i+r>>>1;n(e[a],t)<0?i=a+1:r=a}return i},right:function(e,t,i,r){for(i==null&&(i=0),r==null&&(r=e.length);i<r;){var a=i+r>>>1;n(e[a],t)>0?r=a:i=a+1}return i}}}function wB(n){return function(e,t){return CL(n(e),t)}}EB(CL);function AL(n){for(var e=n.length,t,i=-1,r=0,a,h;++i<e;)r+=n[i].length;for(a=new Array(r);--e>=0;)for(h=n[e],t=h.length;--t>=0;)a[--r]=h[t];return a}var d1=1e9,tE=-d1;function IB(n,e,t,i){function r(x,I){return n<=x&&x<=t&&e<=I&&I<=i}function a(x,I,C,M){var O=0,k=0;if(x==null||(O=h(x,C))!==(k=h(I,C))||p(x,I)<0^C>0)do M.point(O===0||O===3?n:t,O>1?i:e);while((O=(O+C+4)%4)!==k);else M.point(I[0],I[1])}function h(x,I){return wl(x[0]-n)<co?I>0?0:3:wl(x[0]-t)<co?I>0?2:1:wl(x[1]-e)<co?I>0?1:0:I>0?3:2}function s(x,I){return p(x.x,I.x)}function p(x,I){var C=h(x,1),M=h(I,1);return C!==M?C-M:C===0?I[1]-x[1]:C===1?x[0]-I[0]:C===2?x[1]-I[1]:I[0]-x[0]}return function(x){var I=x,C=TL(),M,O,k,z,G,q,Z,K,te,ie,Te,le={point:fe,lineStart:dt,lineEnd:Ge,polygonStart:Ne,polygonEnd:Ue};function fe(nt,zt){r(nt,zt)&&I.point(nt,zt)}function Fe(){for(var nt=0,zt=0,Ot=O.length;zt<Ot;++zt)for(var et=O[zt],Ze=1,At=et.length,Kt=et[0],sn,zn,ri=Kt[0],Yt=Kt[1];Ze<At;++Ze)sn=ri,zn=Yt,Kt=et[Ze],ri=Kt[0],Yt=Kt[1],zn<=i?Yt>i&&(ri-sn)*(i-zn)>(Yt-zn)*(n-sn)&&++nt:Yt<=i&&(ri-sn)*(i-zn)<(Yt-zn)*(n-sn)&&--nt;return nt}function Ne(){I=C,M=[],O=[],Te=!0}function Ue(){var nt=Fe(),zt=Te&&nt,Ot=(M=AL(M)).length;(zt||Ot)&&(x.polygonStart(),zt&&(x.lineStart(),a(null,null,1,x),x.lineEnd()),Ot&&SL(M,s,nt,a,x),x.polygonEnd()),I=x,M=O=k=null}function dt(){le.point=Le,O&&O.push(k=[]),ie=!0,te=!1,Z=K=NaN}function Ge(){M&&(Le(z,G),q&&te&&C.rejoin(),M.push(C.result())),le.point=fe,te&&I.lineEnd()}function Le(nt,zt){var Ot=r(nt,zt);if(O&&k.push([nt,zt]),ie)z=nt,G=zt,q=Ot,ie=!1,Ot&&(I.lineStart(),I.point(nt,zt));else if(Ot&&te)I.point(nt,zt);else{var et=[Z=Math.max(tE,Math.min(d1,Z)),K=Math.max(tE,Math.min(d1,K))],Ze=[nt=Math.max(tE,Math.min(d1,nt)),zt=Math.max(tE,Math.min(d1,zt))];bB(et,Ze,n,e,t,i)?(te||(I.lineStart(),I.point(et[0],et[1])),I.point(Ze[0],Ze[1]),Ot||I.lineEnd(),Te=!1):Ot&&(I.lineStart(),I.point(nt,zt),Te=!1)}Z=nt,K=zt,te=Ot}return le}}var uT=dg();function TB(n,e){var t=e[0],i=e[1],r=[Jo(t),-Ko(t),0],a=0,h=0;uT.reset();for(var s=0,p=n.length;s<p;++s)if(I=(x=n[s]).length)for(var x,I,C=x[I-1],M=C[0],O=C[1]/2+r2,k=Jo(O),z=Ko(O),G=0;G<I;++G,M=Z,k=te,z=ie,C=q){var q=x[G],Z=q[0],K=q[1]/2+r2,te=Jo(K),ie=Ko(K),Te=Z-M,le=Te>=0?1:-1,fe=le*Te,Fe=fe>ys,Ne=k*te;if(uT.add(kv(Ne*le*Jo(fe),z*ie+Ne*Ko(fe))),a+=Fe?Te+le*ap:Te,Fe^M>=t^Z>=t){var Ue=ME(Bv(C),Bv(q));RT(Ue);var dt=ME(r,Ue);RT(dt);var Ge=(Fe^Te>=0?-1:1)*Fv(dt[2]);(i>Ge||i===Ge&&(Ue[0]||Ue[1]))&&(h+=Fe^Te>=0?1:-1)}}return(a<-co||a<co&&uT<-co)^h&1}dg();function d2(n){return n}dg();dg();var zv=1/0,LE=zv,N1=-zv,PE=N1,p2={point:SB,lineStart:f1,lineEnd:f1,polygonStart:f1,polygonEnd:f1,result:function(){var n=[[zv,LE],[N1,PE]];return N1=PE=-(LE=zv=1/0),n}};function SB(n,e){n<zv&&(zv=n),n>N1&&(N1=n),e<LE&&(LE=e),e>PE&&(PE=e)}dg();function ML(n,e,t,i){return function(r,a){var h=e(a),s=r.invert(i[0],i[1]),p=TL(),x=e(p),I=!1,C,M,O,k={point:z,lineStart:q,lineEnd:Z,polygonStart:function(){k.point=K,k.lineStart=te,k.lineEnd=ie,M=[],C=[]},polygonEnd:function(){k.point=z,k.lineStart=q,k.lineEnd=Z,M=AL(M);var Te=TB(C,s);M.length?(I||(a.polygonStart(),I=!0),SL(M,AB,Te,t,a)):Te&&(I||(a.polygonStart(),I=!0),a.lineStart(),t(null,null,1,a),a.lineEnd()),I&&(a.polygonEnd(),I=!1),M=C=null},sphere:function(){a.polygonStart(),a.lineStart(),t(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function z(Te,le){var fe=r(Te,le);n(Te=fe[0],le=fe[1])&&a.point(Te,le)}function G(Te,le){var fe=r(Te,le);h.point(fe[0],fe[1])}function q(){k.point=G,h.lineStart()}function Z(){k.point=z,h.lineEnd()}function K(Te,le){O.push([Te,le]);var fe=r(Te,le);x.point(fe[0],fe[1])}function te(){x.lineStart(),O=[]}function ie(){K(O[0][0],O[0][1]),x.lineEnd();var Te=x.clean(),le=p.result(),fe,Fe=le.length,Ne,Ue,dt;if(O.pop(),C.push(O),O=null,!!Fe){if(Te&1){if(Ue=le[0],(Ne=Ue.length-1)>0){for(I||(a.polygonStart(),I=!0),a.lineStart(),fe=0;fe<Ne;++fe)a.point((dt=Ue[fe])[0],dt[1]);a.lineEnd()}return}Fe>1&&Te&2&&le.push(le.pop().concat(le.shift())),M.push(le.filter(CB))}}return k}}function CB(n){return n.length>1}function AB(n,e){return((n=n.x)[0]<0?n[1]-Jd-co:Jd-n[1])-((e=e.x)[0]<0?e[1]-Jd-co:Jd-e[1])}const m2=ML(function(){return!0},MB,PB,[-ys,-Jd]);function MB(n){var e=NaN,t=NaN,i=NaN,r;return{lineStart:function(){n.lineStart(),r=1},point:function(a,h){var s=a>0?ys:-ys,p=wl(a-e);wl(p-ys)<co?(n.point(e,t=(t+h)/2>0?Jd:-Jd),n.point(i,t),n.lineEnd(),n.lineStart(),n.point(s,t),n.point(a,t),r=0):i!==s&&p>=ys&&(wl(e-i)<co&&(e-=i*co),wl(a-s)<co&&(a-=s*co),t=LB(e,t,a,h),n.point(i,t),n.lineEnd(),n.lineStart(),n.point(s,t),r=0),n.point(e=a,t=h),i=s},lineEnd:function(){n.lineEnd(),e=t=NaN},clean:function(){return 2-r}}}function LB(n,e,t,i){var r,a,h=Jo(n-t);return wl(h)>co?_B((Jo(e)*(a=Ko(i))*Jo(t)-Jo(i)*(r=Ko(e))*Jo(n))/(r*a*h)):(e+i)/2}function PB(n,e,t,i){var r;if(n==null)r=t*Jd,i.point(-ys,r),i.point(0,r),i.point(ys,r),i.point(ys,0),i.point(ys,-r),i.point(0,-r),i.point(-ys,-r),i.point(-ys,0),i.point(-ys,r);else if(wl(n[0]-e[0])>co){var a=n[0]<e[0]?ys:-ys;r=t*a/2,i.point(-a,r),i.point(0,r),i.point(a,r)}else i.point(e[0],e[1])}function RB(n,e){var t=Ko(n),i=t>0,r=wl(t)>co;function a(I,C,M,O){xB(O,n,e,M,I,C)}function h(I,C){return Ko(I)*Ko(C)>t}function s(I){var C,M,O,k,z;return{lineStart:function(){k=O=!1,z=1},point:function(G,q){var Z=[G,q],K,te=h(G,q),ie=i?te?0:x(G,q):te?x(G+(G<0?ys:-ys),q):0;if(!C&&(k=O=te)&&I.lineStart(),te!==O&&(K=p(C,Z),(!K||cE(C,K)||cE(Z,K))&&(Z[0]+=co,Z[1]+=co,te=h(Z[0],Z[1]))),te!==O)z=0,te?(I.lineStart(),K=p(Z,C),I.point(K[0],K[1])):(K=p(C,Z),I.point(K[0],K[1]),I.lineEnd()),C=K;else if(r&&C&&i^te){var Te;!(ie&M)&&(Te=p(Z,C,!0))&&(z=0,i?(I.lineStart(),I.point(Te[0][0],Te[0][1]),I.point(Te[1][0],Te[1][1]),I.lineEnd()):(I.point(Te[1][0],Te[1][1]),I.lineEnd(),I.lineStart(),I.point(Te[0][0],Te[0][1])))}te&&(!C||!cE(C,Z))&&I.point(Z[0],Z[1]),C=Z,O=te,M=ie},lineEnd:function(){O&&I.lineEnd(),C=null},clean:function(){return z|(k&&O)<<1}}}function p(I,C,M){var O=Bv(I),k=Bv(C),z=[1,0,0],G=ME(O,k),q=Qb(G,G),Z=G[0],K=q-Z*Z;if(!K)return!M&&I;var te=t*q/K,ie=-t*Z/K,Te=ME(z,G),le=$b(z,te),fe=$b(G,ie);lT(le,fe);var Fe=Te,Ne=Qb(le,Fe),Ue=Qb(Fe,Fe),dt=Ne*Ne-Ue*(Qb(le,le)-1);if(!(dt<0)){var Ge=tx(dt),Le=$b(Fe,(-Ne-Ge)/Ue);if(lT(Le,le),Le=PT(Le),!M)return Le;var nt=I[0],zt=C[0],Ot=I[1],et=C[1],Ze;zt<nt&&(Ze=nt,nt=zt,zt=Ze);var At=zt-nt,Kt=wl(At-ys)<co,sn=Kt||At<co;if(!Kt&&et<Ot&&(Ze=Ot,Ot=et,et=Ze),sn?Kt?Ot+et>0^Le[1]<(wl(Le[0]-nt)<co?Ot:et):Ot<=Le[1]&&Le[1]<=et:At>ys^(nt<=Le[0]&&Le[0]<=zt)){var zn=$b(Fe,(-Ne+Ge)/Ue);return lT(zn,le),[Le,PT(zn)]}}}function x(I,C){var M=i?n:ys-n,O=0;return I<-M?O|=1:I>M&&(O|=2),C<-M?O|=4:C>M&&(O|=8),O}return ML(h,s,a,i?[0,-n]:[-ys,n-ys])}function LL(n){return function(e){var t=new OT;for(var i in n)t[i]=n[i];return t.stream=e,t}}function OT(){}OT.prototype={constructor:OT,point:function(n,e){this.stream.point(n,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function PL(n,e,t){var i=e[1][0]-e[0][0],r=e[1][1]-e[0][1],a=n.clipExtent&&n.clipExtent();n.scale(150).translate([0,0]),a!=null&&n.clipExtent(null),yB(t,n.stream(p2));var h=p2.result(),s=Math.min(i/(h[1][0]-h[0][0]),r/(h[1][1]-h[0][1])),p=+e[0][0]+(i-s*(h[1][0]+h[0][0]))/2,x=+e[0][1]+(r-s*(h[1][1]+h[0][1]))/2;return a!=null&&n.clipExtent(a),n.scale(s*150).translate([p,x])}function DB(n,e,t){return PL(n,[[0,0],e],t)}var g2=16,OB=Ko(30*of);function _2(n,e){return+e?kB(n,e):NB(n)}function NB(n){return LL({point:function(e,t){e=n(e,t),this.stream.point(e[0],e[1])}})}function kB(n,e){function t(i,r,a,h,s,p,x,I,C,M,O,k,z,G){var q=x-i,Z=I-r,K=q*q+Z*Z;if(K>4*e&&z--){var te=h+M,ie=s+O,Te=p+k,le=tx(te*te+ie*ie+Te*Te),fe=Fv(Te/=le),Fe=wl(wl(Te)-1)<co||wl(a-C)<co?(a+C)/2:kv(ie,te),Ne=n(Fe,fe),Ue=Ne[0],dt=Ne[1],Ge=Ue-i,Le=dt-r,nt=Z*Ge-q*Le;(nt*nt/K>e||wl((q*Ge+Z*Le)/K-.5)>.3||h*M+s*O+p*k<OB)&&(t(i,r,a,h,s,p,Ue,dt,Fe,te/=le,ie/=le,Te,z,G),G.point(Ue,dt),t(Ue,dt,Fe,te,ie,Te,x,I,C,M,O,k,z,G))}}return function(i){var r,a,h,s,p,x,I,C,M,O,k,z,G={point:q,lineStart:Z,lineEnd:te,polygonStart:function(){i.polygonStart(),G.lineStart=ie},polygonEnd:function(){i.polygonEnd(),G.lineStart=Z}};function q(fe,Fe){fe=n(fe,Fe),i.point(fe[0],fe[1])}function Z(){C=NaN,G.point=K,i.lineStart()}function K(fe,Fe){var Ne=Bv([fe,Fe]),Ue=n(fe,Fe);t(C,M,I,O,k,z,C=Ue[0],M=Ue[1],I=fe,O=Ne[0],k=Ne[1],z=Ne[2],g2,i),i.point(C,M)}function te(){G.point=q,i.lineEnd()}function ie(){Z(),G.point=Te,G.lineEnd=le}function Te(fe,Fe){K(r=fe,Fe),a=C,h=M,s=O,p=k,x=z,G.point=K}function le(){t(C,M,I,O,k,z,a,h,r,s,p,x,g2,i),G.lineEnd=te,te()}return G}}var FB=LL({point:function(n,e){this.stream.point(n*of,e*of)}});function BB(n){return zB(function(){return n})()}function zB(n){var e,t=150,i=480,r=250,a,h,s=0,p=0,x=0,I=0,C=0,M,O,k=null,z=m2,G=null,q,Z,K,te=d2,ie=.5,Te=_2(Ue,ie),le,fe;function Fe(Le){return Le=O(Le[0]*of,Le[1]*of),[Le[0]*t+a,h-Le[1]*t]}function Ne(Le){return Le=O.invert((Le[0]-a)/t,(h-Le[1])/t),Le&&[Le[0]*km,Le[1]*km]}function Ue(Le,nt){return Le=e(Le,nt),[Le[0]*t+a,h-Le[1]*t]}Fe.stream=function(Le){return le&&fe===Le?le:le=FB(z(M,Te(te(fe=Le))))},Fe.clipAngle=function(Le){return arguments.length?(z=+Le?RB(k=Le*of,6*of):(k=null,m2),Ge()):k*km},Fe.clipExtent=function(Le){return arguments.length?(te=Le==null?(G=q=Z=K=null,d2):IB(G=+Le[0][0],q=+Le[0][1],Z=+Le[1][0],K=+Le[1][1]),Ge()):G==null?null:[[G,q],[Z,K]]},Fe.scale=function(Le){return arguments.length?(t=+Le,dt()):t},Fe.translate=function(Le){return arguments.length?(i=+Le[0],r=+Le[1],dt()):[i,r]},Fe.center=function(Le){return arguments.length?(s=Le[0]%360*of,p=Le[1]%360*of,dt()):[s*km,p*km]},Fe.rotate=function(Le){return arguments.length?(x=Le[0]%360*of,I=Le[1]%360*of,C=Le.length>2?Le[2]%360*of:0,dt()):[x*km,I*km,C*km]},Fe.precision=function(Le){return arguments.length?(Te=_2(Ue,ie=Le*Le),Ge()):tx(ie)},Fe.fitExtent=function(Le,nt){return PL(Fe,Le,nt)},Fe.fitSize=function(Le,nt){return DB(Fe,Le,nt)};function dt(){O=IL(M=vB(x,I,C),e);var Le=e(s,p);return a=i-Le[0]*t,h=r+Le[1]*t,Ge()}function Ge(){return le=fe=null,Fe}return function(){return e=n.apply(this,arguments),Fe.invert=e.invert&&Ne,dt()}}function UB(n){return function(e,t){var i=Ko(e),r=Ko(t),a=n(i*r);return[a*r*Jo(e),a*Jo(t)]}}function VB(n){return function(e,t){var i=tx(e*e+t*t),r=n(i),a=Jo(r),h=Ko(r);return[kv(e*a,i*h),Fv(i&&t*a/i)]}}var RL=UB(function(n){return(n=wL(n))&&n/Jo(n)});RL.invert=VB(function(n){return n});function GB(){return BB(RL).scale(79.4188).clipAngle(180-.001)}function y2(n,e){return[n,e]}y2.invert=y2;function jB(n,e,t){t=t||{};var i=t.units||"kilometers",r=t.steps||8;if(!n)throw new Error("geojson is required");if(typeof t!="object")throw new Error("options must be an object");if(typeof r!="number")throw new Error("steps must be an number");if(e===void 0)throw new Error("radius is required");if(r<=0)throw new Error("steps must be greater than 0");var a=[];switch(n.type){case"GeometryCollection":return pS(n,function(h){var s=hE(h,e,i,r);s&&a.push(s)}),gv(a);case"FeatureCollection":return AT(n,function(h){var s=hE(h,e,i,r);s&&AT(s,function(p){p&&a.push(p)})}),gv(a)}return hE(n,e,i,r)}function hE(n,e,t,i){var r=n.properties||{},a=n.type==="Feature"?n.geometry:n;if(a.type==="GeometryCollection"){var h=[];return pS(n,function(z){var G=hE(z,e,t,i);G&&h.push(G)}),gv(h)}var s=qB(a),p={type:a.type,coordinates:OL(a.coordinates,s)},x=new ES,I=x.read(p),C=KF(JF(e,t),"meters"),M=Fa.bufferOp(I,C,i),O=new sL;if(M=O.write(M),!DL(M.coordinates)){var k={type:M.type,coordinates:NL(M.coordinates,s)};return Km(k,r)}}function DL(n){return Array.isArray(n[0])?DL(n[0]):isNaN(n[0])}function OL(n,e){return typeof n[0]!="object"?e(n):n.map(function(t){return OL(t,e)})}function NL(n,e){return typeof n[0]!="object"?e.invert(n):n.map(function(t){return NL(t,e)})}function qB(n){var e=$F(n).geometry.coordinates,t=[-e[0],-e[1]];return GB().rotate(t).scale(Gu)}function HB(n,e){return n.map(i=>i.source.data).map(i=>jB(i,(e==null?void 0:e.radius)||1,{units:(e==null?void 0:e.units)||"kilometers"})).filter(i=>i!==void 0)}function WB(n){return n.length>0}const XB={processor:HB,validator:WB};function ZB(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return n.geometry.coordinates;if(n.type==="Point")return n.coordinates}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return n;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function kL(n,e,t){if(!n)throw new Error("No featureCollection passed");if(!t)throw new Error(".collectionOf() requires a name");if(!n||n.type!=="FeatureCollection")throw new Error("Invalid input to "+t+", FeatureCollection required");for(var i=0,r=n.features;i<r.length;i++){var a=r[i];if(!a||a.type!=="Feature"||!a.geometry)throw new Error("Invalid input to "+t+", Feature with geometry required");if(!a.geometry||a.geometry.type!==e)throw new Error("Invalid input to "+t+": must be a "+e+", given "+a.geometry.type)}}function ag(n){return n.type==="Feature"?n.geometry:n}/**
 * splaytree v3.1.2
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function YB(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,r,a,h;return h={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function s(x){return function(I){return p([x,I])}}function p(x){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,r&&(a=x[0]&2?r.return:x[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,x[1])).done)return a;switch(r=0,a&&(x=[x[0]&2,a.value]),x[0]){case 0:case 1:a=x;break;case 4:return t.label++,{value:x[1],done:!1};case 5:t.label++,r=x[1],x=[0];continue;case 7:x=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(x[0]===6||x[0]===2)){t=0;continue}if(x[0]===3&&(!a||x[1]>a[0]&&x[1]<a[3])){t.label=x[1];break}if(x[0]===6&&t.label<a[1]){t.label=a[1],a=x;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(x);break}a[2]&&t.ops.pop(),t.trys.pop();continue}x=e.call(n,t)}catch(I){x=[6,I],r=0}finally{i=a=0}if(x[0]&5)throw x[1];return{value:x[0]?x[1]:void 0,done:!0}}}var lg=function(){function n(e,t){this.next=null,this.key=e,this.data=t,this.left=null,this.right=null}return n}();function KB(n,e){return n>e?1:n<e?-1:0}function zm(n,e,t){for(var i=new lg(null,null),r=i,a=i;;){var h=t(n,e.key);if(h<0){if(e.left===null)break;if(t(n,e.left.key)<0){var s=e.left;if(e.left=s.right,s.right=e,e=s,e.left===null)break}a.left=e,a=e,e=e.left}else if(h>0){if(e.right===null)break;if(t(n,e.right.key)>0){var s=e.right;if(e.right=s.left,s.left=e,e=s,e.right===null)break}r.right=e,r=e,e=e.right}else break}return r.right=e.left,a.left=e.right,e.left=i.right,e.right=i.left,e}function cT(n,e,t,i){var r=new lg(n,e);if(t===null)return r.left=r.right=null,r;t=zm(n,t,i);var a=i(n,t.key);return a<0?(r.left=t.left,r.right=t,t.left=null):a>=0&&(r.right=t.right,r.left=t,t.right=null),r}function v2(n,e,t){var i=null,r=null;if(e){e=zm(n,e,t);var a=t(e.key,n);a===0?(i=e.left,r=e.right):a<0?(r=e.right,e.right=null,i=e):(i=e.left,e.left=null,r=e)}return{left:i,right:r}}function JB(n,e,t){return e===null?n:(n===null||(e=zm(n.key,e,t),e.left=n),e)}function NT(n,e,t,i,r){if(n){i(""+e+(t?" ":" ")+r(n)+`
`);var a=e+(t?"    ":"   ");n.left&&NT(n.left,a,!1,i,r),n.right&&NT(n.right,a,!0,i,r)}}var PS=function(){function n(e){e===void 0&&(e=KB),this._root=null,this._size=0,this._comparator=e}return n.prototype.insert=function(e,t){return this._size++,this._root=cT(e,t,this._root,this._comparator)},n.prototype.add=function(e,t){var i=new lg(e,t);this._root===null&&(i.left=i.right=null,this._size++,this._root=i);var r=this._comparator,a=zm(e,this._root,r),h=r(e,a.key);return h===0?this._root=a:(h<0?(i.left=a.left,i.right=a,a.left=null):h>0&&(i.right=a.right,i.left=a,a.right=null),this._size++,this._root=i),this._root},n.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},n.prototype._remove=function(e,t,i){var r;if(t===null)return null;t=zm(e,t,i);var a=i(e,t.key);return a===0?(t.left===null?r=t.right:(r=zm(e,t.left,i),r.right=t.right),this._size--,r):t},n.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=zm(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},n.prototype.findStatic=function(e){for(var t=this._root,i=this._comparator;t;){var r=i(e,t.key);if(r===0)return t;r<0?t=t.left:t=t.right}return null},n.prototype.find=function(e){return this._root&&(this._root=zm(e,this._root,this._comparator),this._comparator(e,this._root.key)!==0)?null:this._root},n.prototype.contains=function(e){for(var t=this._root,i=this._comparator;t;){var r=i(e,t.key);if(r===0)return!0;r<0?t=t.left:t=t.right}return!1},n.prototype.forEach=function(e,t){for(var i=this._root,r=[],a=!1;!a;)i!==null?(r.push(i),i=i.left):r.length!==0?(i=r.pop(),e.call(t,i),i=i.right):a=!0;return this},n.prototype.range=function(e,t,i,r){for(var a=[],h=this._comparator,s=this._root,p;a.length!==0||s;)if(s)a.push(s),s=s.left;else{if(s=a.pop(),p=h(s.key,t),p>0)break;if(h(s.key,e)>=0&&i.call(r,s))return this;s=s.right}return this},n.prototype.keys=function(){var e=[];return this.forEach(function(t){var i=t.key;return e.push(i)}),e},n.prototype.values=function(){var e=[];return this.forEach(function(t){var i=t.data;return e.push(i)}),e},n.prototype.min=function(){return this._root?this.minNode(this._root).key:null},n.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},n.prototype.minNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.left;)e=e.left;return e},n.prototype.maxNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.right;)e=e.right;return e},n.prototype.at=function(e){for(var t=this._root,i=!1,r=0,a=[];!i;)if(t)a.push(t),t=t.left;else if(a.length>0){if(t=a.pop(),r===e)return t;r++,t=t.right}else i=!0;return null},n.prototype.next=function(e){var t=this._root,i=null;if(e.right){for(i=e.right;i.left;)i=i.left;return i}for(var r=this._comparator;t;){var a=r(e.key,t.key);if(a===0)break;a<0?(i=t,t=t.left):t=t.right}return i},n.prototype.prev=function(e){var t=this._root,i=null;if(e.left!==null){for(i=e.left;i.right;)i=i.right;return i}for(var r=this._comparator;t;){var a=r(e.key,t.key);if(a===0)break;a<0?t=t.left:(i=t,t=t.right)}return i},n.prototype.clear=function(){return this._root=null,this._size=0,this},n.prototype.toList=function(){return $B(this._root)},n.prototype.load=function(e,t,i){t===void 0&&(t=[]),i===void 0&&(i=!1);var r=e.length,a=this._comparator;if(i&&BT(e,t,0,r-1,a),this._root===null)this._root=kT(e,t,0,r),this._size=r;else{var h=ez(this.toList(),QB(e,t),a);r=this._size+r,this._root=FT({head:h},0,r)}return this},n.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(n.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),n.prototype.toString=function(e){e===void 0&&(e=function(i){return String(i.key)});var t=[];return NT(this._root,"",!0,function(i){return t.push(i)},e),t.join("")},n.prototype.update=function(e,t,i){var r=this._comparator,a=v2(e,this._root,r),h=a.left,s=a.right;r(e,t)<0?s=cT(t,i,s,r):h=cT(t,i,h,r),this._root=JB(h,s,r)},n.prototype.split=function(e){return v2(e,this._root,this._comparator)},n.prototype[Symbol.iterator]=function(){var e,t,i;return YB(this,function(r){switch(r.label){case 0:e=this._root,t=[],i=!1,r.label=1;case 1:return i?[3,6]:e===null?[3,2]:(t.push(e),e=e.left,[3,5]);case 2:return t.length===0?[3,4]:(e=t.pop(),[4,e]);case 3:return r.sent(),e=e.right,[3,5];case 4:i=!0,r.label=5;case 5:return[3,1];case 6:return[2]}})},n}();function kT(n,e,t,i){var r=i-t;if(r>0){var a=t+Math.floor(r/2),h=n[a],s=e[a],p=new lg(h,s);return p.left=kT(n,e,t,a),p.right=kT(n,e,a+1,i),p}return null}function QB(n,e){for(var t=new lg(null,null),i=t,r=0;r<n.length;r++)i=i.next=new lg(n[r],e[r]);return i.next=null,t.next}function $B(n){for(var e=n,t=[],i=!1,r=new lg(null,null),a=r;!i;)e?(t.push(e),e=e.left):t.length>0?(e=a=a.next=t.pop(),e=e.right):i=!0;return a.next=null,r.next}function FT(n,e,t){var i=t-e;if(i>0){var r=e+Math.floor(i/2),a=FT(n,e,r),h=n.head;return h.left=a,n.head=n.head.next,h.right=FT(n,r+1,t),h}return null}function ez(n,e,t){for(var i=new lg(null,null),r=i,a=n,h=e;a!==null&&h!==null;)t(a.key,h.key)<0?(r.next=a,a=a.next):(r.next=h,h=h.next),r=r.next;return a!==null?r.next=a:h!==null&&(r.next=h),i.next}function BT(n,e,t,i,r){if(!(t>=i)){for(var a=n[t+i>>1],h=t-1,s=i+1;;){do h++;while(r(n[h],a)<0);do s--;while(r(n[s],a)>0);if(h>=s)break;var p=n[h];n[h]=n[s],n[s]=p,p=e[h],e[h]=e[s],e[s]=p}BT(n,e,t,s,r),BT(n,e,s+1,i,r)}}function Tf(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function x2(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function ec(n,e,t){return e&&x2(n.prototype,e),t&&x2(n,t),n}var i1=function(e,t){return e.ll.x<=t.x&&t.x<=e.ur.x&&e.ll.y<=t.y&&t.y<=e.ur.y},zT=function(e,t){if(t.ur.x<e.ll.x||e.ur.x<t.ll.x||t.ur.y<e.ll.y||e.ur.y<t.ll.y)return null;var i=e.ll.x<t.ll.x?t.ll.x:e.ll.x,r=e.ur.x<t.ur.x?e.ur.x:t.ur.x,a=e.ll.y<t.ll.y?t.ll.y:e.ll.y,h=e.ur.y<t.ur.y?e.ur.y:t.ur.y;return{ll:{x:i,y:a},ur:{x:r,y:h}}},Vm=Number.EPSILON;Vm===void 0&&(Vm=Math.pow(2,-52));var tz=Vm*Vm,UT=function(e,t){if(-Vm<e&&e<Vm&&-Vm<t&&t<Vm)return 0;var i=e-t;return i*i<tz*e*t?0:e<t?-1:1},nz=function(){function n(){Tf(this,n),this.reset()}return ec(n,[{key:"reset",value:function(){this.xRounder=new b2,this.yRounder=new b2}},{key:"round",value:function(t,i){return{x:this.xRounder.round(t),y:this.yRounder.round(i)}}}]),n}(),b2=function(){function n(){Tf(this,n),this.tree=new PS,this.round(0)}return ec(n,[{key:"round",value:function(t){var i=this.tree.add(t),r=this.tree.prev(i);if(r!==null&&UT(i.key,r.key)===0)return this.tree.remove(t),r.key;var a=this.tree.next(i);return a!==null&&UT(i.key,a.key)===0?(this.tree.remove(t),a.key):t}}]),n}(),k1=new nz,g1=function(e,t){return e.x*t.y-e.y*t.x},FL=function(e,t){return e.x*t.x+e.y*t.y},E2=function(e,t,i){var r={x:t.x-e.x,y:t.y-e.y},a={x:i.x-e.x,y:i.y-e.y},h=g1(r,a);return UT(h,0)},RE=function(e){return Math.sqrt(FL(e,e))},iz=function(e,t,i){var r={x:t.x-e.x,y:t.y-e.y},a={x:i.x-e.x,y:i.y-e.y};return g1(a,r)/RE(a)/RE(r)},rz=function(e,t,i){var r={x:t.x-e.x,y:t.y-e.y},a={x:i.x-e.x,y:i.y-e.y};return FL(a,r)/RE(a)/RE(r)},w2=function(e,t,i){return t.y===0?null:{x:e.x+t.x/t.y*(i-e.y),y:i}},I2=function(e,t,i){return t.x===0?null:{x:i,y:e.y+t.y/t.x*(i-e.x)}},sz=function(e,t,i,r){if(t.x===0)return I2(i,r,e.x);if(r.x===0)return I2(e,t,i.x);if(t.y===0)return w2(i,r,e.y);if(r.y===0)return w2(e,t,i.y);var a=g1(t,r);if(a==0)return null;var h={x:i.x-e.x,y:i.y-e.y},s=g1(h,t)/a,p=g1(h,r)/a,x=e.x+p*t.x,I=i.x+s*r.x,C=e.y+p*t.y,M=i.y+s*r.y,O=(x+I)/2,k=(C+M)/2;return{x:O,y:k}},Yd=function(){ec(n,null,[{key:"compare",value:function(t,i){var r=n.comparePoints(t.point,i.point);return r!==0?r:(t.point!==i.point&&t.link(i),t.isLeft!==i.isLeft?t.isLeft?1:-1:DE.compare(t.segment,i.segment))}},{key:"comparePoints",value:function(t,i){return t.x<i.x?-1:t.x>i.x?1:t.y<i.y?-1:t.y>i.y?1:0}}]);function n(e,t){Tf(this,n),e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=t}return ec(n,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var i=t.point.events,r=0,a=i.length;r<a;r++){var h=i[r];this.point.events.push(h),h.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,i=0;i<t;i++){var r=this.point.events[i];if(r.segment.consumedBy===void 0)for(var a=i+1;a<t;a++){var h=this.point.events[a];h.consumedBy===void 0&&r.otherSE.point.events===h.otherSE.point.events&&r.segment.consume(h.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],i=0,r=this.point.events.length;i<r;i++){var a=this.point.events[i];a!==this&&!a.segment.ringOut&&a.segment.isInResult()&&t.push(a)}return t}},{key:"getLeftmostComparator",value:function(t){var i=this,r=new Map,a=function(s){var p=s.otherSE;r.set(s,{sine:iz(i.point,t.point,p.point),cosine:rz(i.point,t.point,p.point)})};return function(h,s){r.has(h)||a(h),r.has(s)||a(s);var p=r.get(h),x=p.sine,I=p.cosine,C=r.get(s),M=C.sine,O=C.cosine;return x>=0&&M>=0?I<O?1:I>O?-1:0:x<0&&M<0?I<O?-1:I>O?1:0:M<x?-1:M>x?1:0}}}]),n}(),oz=0,DE=function(){ec(n,null,[{key:"compare",value:function(t,i){var r=t.leftSE.point.x,a=i.leftSE.point.x,h=t.rightSE.point.x,s=i.rightSE.point.x;if(s<r)return 1;if(h<a)return-1;var p=t.leftSE.point.y,x=i.leftSE.point.y,I=t.rightSE.point.y,C=i.rightSE.point.y;if(r<a){if(x<p&&x<I)return 1;if(x>p&&x>I)return-1;var M=t.comparePoint(i.leftSE.point);if(M<0)return 1;if(M>0)return-1;var O=i.comparePoint(t.rightSE.point);return O!==0?O:-1}if(r>a){if(p<x&&p<C)return-1;if(p>x&&p>C)return 1;var k=i.comparePoint(t.leftSE.point);if(k!==0)return k;var z=t.comparePoint(i.rightSE.point);return z<0?1:z>0?-1:1}if(p<x)return-1;if(p>x)return 1;if(h<s){var G=i.comparePoint(t.rightSE.point);if(G!==0)return G}if(h>s){var q=t.comparePoint(i.rightSE.point);if(q<0)return 1;if(q>0)return-1}if(h!==s){var Z=I-p,K=h-r,te=C-x,ie=s-a;if(Z>K&&te<ie)return 1;if(Z<K&&te>ie)return-1}return h>s?1:h<s||I<C?-1:I>C?1:t.id<i.id?-1:t.id>i.id?1:0}}]);function n(e,t,i,r){Tf(this,n),this.id=++oz,this.leftSE=e,e.segment=this,e.otherSE=t,this.rightSE=t,t.segment=this,t.otherSE=e,this.rings=i,this.windings=r}return ec(n,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,i=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<i?t:i},ur:{x:this.rightSE.point.x,y:t>i?t:i}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var i=this.leftSE.point,r=this.rightSE.point,a=this.vector();if(i.x===r.x)return t.x===i.x?0:t.x<i.x?1:-1;var h=(t.y-i.y)/a.y,s=i.x+h*a.x;if(t.x===s)return 0;var p=(t.x-i.x)/a.x,x=i.y+p*a.y;return t.y===x?0:t.y<x?-1:1}},{key:"getIntersection",value:function(t){var i=this.bbox(),r=t.bbox(),a=zT(i,r);if(a===null)return null;var h=this.leftSE.point,s=this.rightSE.point,p=t.leftSE.point,x=t.rightSE.point,I=i1(i,p)&&this.comparePoint(p)===0,C=i1(r,h)&&t.comparePoint(h)===0,M=i1(i,x)&&this.comparePoint(x)===0,O=i1(r,s)&&t.comparePoint(s)===0;if(C&&I)return O&&!M?s:!O&&M?x:null;if(C)return M&&h.x===x.x&&h.y===x.y?null:h;if(I)return O&&s.x===p.x&&s.y===p.y?null:p;if(O&&M)return null;if(O)return s;if(M)return x;var k=sz(h,this.vector(),p,t.vector());return k===null||!i1(a,k)?null:k1.round(k.x,k.y)}},{key:"split",value:function(t){var i=[],r=t.events!==void 0,a=new Yd(t,!0),h=new Yd(t,!1),s=this.rightSE;this.replaceRightSE(h),i.push(h),i.push(a);var p=new n(a,s,this.rings.slice(),this.windings.slice());return Yd.comparePoints(p.leftSE.point,p.rightSE.point)>0&&p.swapEvents(),Yd.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(a.checkForConsuming(),h.checkForConsuming()),i}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var i=0,r=this.windings.length;i<r;i++)this.windings[i]*=-1}},{key:"consume",value:function(t){for(var i=this,r=t;i.consumedBy;)i=i.consumedBy;for(;r.consumedBy;)r=r.consumedBy;var a=n.compare(i,r);if(a!==0){if(a>0){var h=i;i=r,r=h}if(i.prev===r){var s=i;i=r,r=s}for(var p=0,x=r.rings.length;p<x;p++){var I=r.rings[p],C=r.windings[p],M=i.rings.indexOf(I);M===-1?(i.rings.push(I),i.windings.push(C)):i.windings[M]+=C}r.rings=null,r.windings=null,r.consumedBy=i,r.leftSE.consumedBy=i.leftSE,r.rightSE.consumedBy=i.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var i=this._afterState.rings,r=this._afterState.windings,a=this._afterState.multiPolys,h=0,s=this.rings.length;h<s;h++){var p=this.rings[h],x=this.windings[h],I=i.indexOf(p);I===-1?(i.push(p),r.push(x)):r[I]+=x}for(var C=[],M=[],O=0,k=i.length;O<k;O++)if(r[O]!==0){var z=i[O],G=z.poly;if(M.indexOf(G)===-1)if(z.isExterior)C.push(G);else{M.indexOf(G)===-1&&M.push(G);var q=C.indexOf(z.poly);q!==-1&&C.splice(q,1)}}for(var Z=0,K=C.length;Z<K;Z++){var te=C[Z].multiPoly;a.indexOf(te)===-1&&a.push(te)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var t=this.beforeState().multiPolys,i=this.afterState().multiPolys;switch($f.type){case"union":{var r=t.length===0,a=i.length===0;this._isInResult=r!==a;break}case"intersection":{var h,s;t.length<i.length?(h=t.length,s=i.length):(h=i.length,s=t.length),this._isInResult=s===$f.numMultiPolys&&h<s;break}case"xor":{var p=Math.abs(t.length-i.length);this._isInResult=p%2===1;break}case"difference":{var x=function(C){return C.length===1&&C[0].isSubject};this._isInResult=x(t)!==x(i);break}default:throw new Error("Unrecognized operation type found ".concat($f.type))}return this._isInResult}}],[{key:"fromRing",value:function(t,i,r){var a,h,s,p=Yd.comparePoints(t,i);if(p<0)a=t,h=i,s=1;else if(p>0)a=i,h=t,s=-1;else throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));var x=new Yd(a,!0),I=new Yd(h,!1);return new n(x,I,[r],[s])}}]),n}(),T2=function(){function n(e,t,i){if(Tf(this,n),!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=t,this.isExterior=i,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var r=k1.round(e[0][0],e[0][1]);this.bbox={ll:{x:r.x,y:r.y},ur:{x:r.x,y:r.y}};for(var a=r,h=1,s=e.length;h<s;h++){if(typeof e[h][0]!="number"||typeof e[h][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var p=k1.round(e[h][0],e[h][1]);p.x===a.x&&p.y===a.y||(this.segments.push(DE.fromRing(a,p,this)),p.x<this.bbox.ll.x&&(this.bbox.ll.x=p.x),p.y<this.bbox.ll.y&&(this.bbox.ll.y=p.y),p.x>this.bbox.ur.x&&(this.bbox.ur.x=p.x),p.y>this.bbox.ur.y&&(this.bbox.ur.y=p.y),a=p)}(r.x!==a.x||r.y!==a.y)&&this.segments.push(DE.fromRing(a,r,this))}return ec(n,[{key:"getSweepEvents",value:function(){for(var t=[],i=0,r=this.segments.length;i<r;i++){var a=this.segments[i];t.push(a.leftSE),t.push(a.rightSE)}return t}}]),n}(),az=function(){function n(e,t){if(Tf(this,n),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new T2(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var i=1,r=e.length;i<r;i++){var a=new T2(e[i],this,!1);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.interiorRings.push(a)}this.multiPoly=t}return ec(n,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),i=0,r=this.interiorRings.length;i<r;i++)for(var a=this.interiorRings[i].getSweepEvents(),h=0,s=a.length;h<s;h++)t.push(a[h]);return t}}]),n}(),S2=function(){function n(e,t){if(Tf(this,n),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var i=0,r=e.length;i<r;i++){var a=new az(e[i],this);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.polys.push(a)}this.isSubject=t}return ec(n,[{key:"getSweepEvents",value:function(){for(var t=[],i=0,r=this.polys.length;i<r;i++)for(var a=this.polys[i].getSweepEvents(),h=0,s=a.length;h<s;h++)t.push(a[h]);return t}}]),n}(),lz=function(){ec(n,null,[{key:"factory",value:function(t){for(var i=[],r=0,a=t.length;r<a;r++){var h=t[r];if(!(!h.isInResult()||h.ringOut)){for(var s=null,p=h.leftSE,x=h.rightSE,I=[p],C=p.point,M=[];s=p,p=x,I.push(p),p.point!==C;)for(;;){var O=p.getAvailableLinkedEvents();if(O.length===0){var k=I[0].point,z=I[I.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(k.x,",")+" ".concat(k.y,"]. Last matching segment found ends at")+" [".concat(z.x,", ").concat(z.y,"]."))}if(O.length===1){x=O[0].otherSE;break}for(var G=null,q=0,Z=M.length;q<Z;q++)if(M[q].point===p.point){G=q;break}if(G!==null){var K=M.splice(G)[0],te=I.splice(K.index);te.unshift(te[0].otherSE),i.push(new n(te.reverse()));continue}M.push({index:I.length,point:p.point});var ie=p.getLeftmostComparator(s);x=O.sort(ie)[0].otherSE;break}i.push(new n(I))}}return i}}]);function n(e){Tf(this,n),this.events=e;for(var t=0,i=e.length;t<i;t++)e[t].segment.ringOut=this;this.poly=null}return ec(n,[{key:"getGeom",value:function(){for(var t=this.events[0].point,i=[t],r=1,a=this.events.length-1;r<a;r++){var h=this.events[r].point,s=this.events[r+1].point;E2(h,t,s)!==0&&(i.push(h),t=h)}if(i.length===1)return null;var p=i[0],x=i[1];E2(p,t,x)===0&&i.shift(),i.push(i[0]);for(var I=this.isExteriorRing()?1:-1,C=this.isExteriorRing()?0:i.length-1,M=this.isExteriorRing()?i.length:-1,O=[],k=C;k!=M;k+=I)O.push([i[k].x,i[k].y]);return O}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var t=this.enclosingRing();this._isExteriorRing=t?!t.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],i=1,r=this.events.length;i<r;i++){var a=this.events[i];Yd.compare(t,a)>0&&(t=a)}for(var h=t.segment.prevInResult(),s=h?h.prevInResult():null;;){if(!h)return null;if(!s)return h.ringOut;if(s.ringOut!==h.ringOut)return s.ringOut.enclosingRing()!==h.ringOut?h.ringOut:h.ringOut.enclosingRing();h=s.prevInResult(),s=h?h.prevInResult():null}}}]),n}(),C2=function(){function n(e){Tf(this,n),this.exteriorRing=e,e.poly=this,this.interiorRings=[]}return ec(n,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(t[0]===null)return null;for(var i=0,r=this.interiorRings.length;i<r;i++){var a=this.interiorRings[i].getGeom();a!==null&&t.push(a)}return t}}]),n}(),uz=function(){function n(e){Tf(this,n),this.rings=e,this.polys=this._composePolys(e)}return ec(n,[{key:"getGeom",value:function(){for(var t=[],i=0,r=this.polys.length;i<r;i++){var a=this.polys[i].getGeom();a!==null&&t.push(a)}return t}},{key:"_composePolys",value:function(t){for(var i=[],r=0,a=t.length;r<a;r++){var h=t[r];if(!h.poly)if(h.isExteriorRing())i.push(new C2(h));else{var s=h.enclosingRing();s.poly||i.push(new C2(s)),s.poly.addInterior(h)}}return i}}]),n}(),cz=function(){function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:DE.compare;Tf(this,n),this.queue=e,this.tree=new PS(t),this.segments=[]}return ec(n,[{key:"process",value:function(t){var i=t.segment,r=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(i),r;var a=t.isLeft?this.tree.insert(i):this.tree.find(i);if(!a)throw new Error("Unable to find segment #".concat(i.id," ")+"[".concat(i.leftSE.point.x,", ").concat(i.leftSE.point.y,"] -> ")+"[".concat(i.rightSE.point.x,", ").concat(i.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var h=a,s=a,p=void 0,x=void 0;p===void 0;)h=this.tree.prev(h),h===null?p=null:h.key.consumedBy===void 0&&(p=h.key);for(;x===void 0;)s=this.tree.next(s),s===null?x=null:s.key.consumedBy===void 0&&(x=s.key);if(t.isLeft){var I=null;if(p){var C=p.getIntersection(i);if(C!==null&&(i.isAnEndpoint(C)||(I=C),!p.isAnEndpoint(C)))for(var M=this._splitSafely(p,C),O=0,k=M.length;O<k;O++)r.push(M[O])}var z=null;if(x){var G=x.getIntersection(i);if(G!==null&&(i.isAnEndpoint(G)||(z=G),!x.isAnEndpoint(G)))for(var q=this._splitSafely(x,G),Z=0,K=q.length;Z<K;Z++)r.push(q[Z])}if(I!==null||z!==null){var te=null;if(I===null)te=z;else if(z===null)te=I;else{var ie=Yd.comparePoints(I,z);te=ie<=0?I:z}this.queue.remove(i.rightSE),r.push(i.rightSE);for(var Te=i.split(te),le=0,fe=Te.length;le<fe;le++)r.push(Te[le])}r.length>0?(this.tree.remove(i),r.push(t)):(this.segments.push(i),i.prev=p)}else{if(p&&x){var Fe=p.getIntersection(x);if(Fe!==null){if(!p.isAnEndpoint(Fe))for(var Ne=this._splitSafely(p,Fe),Ue=0,dt=Ne.length;Ue<dt;Ue++)r.push(Ne[Ue]);if(!x.isAnEndpoint(Fe))for(var Ge=this._splitSafely(x,Fe),Le=0,nt=Ge.length;Le<nt;Le++)r.push(Ge[Le])}}this.tree.remove(i)}return r}},{key:"_splitSafely",value:function(t,i){this.tree.remove(t);var r=t.rightSE;this.queue.remove(r);var a=t.split(i);return a.push(r),t.consumedBy===void 0&&this.tree.insert(t),a}}]),n}(),A2=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,hz=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,fz=function(){function n(){Tf(this,n)}return ec(n,[{key:"run",value:function(t,i,r){$f.type=t,k1.reset();for(var a=[new S2(i,!0)],h=0,s=r.length;h<s;h++)a.push(new S2(r[h],!1));if($f.numMultiPolys=a.length,$f.type==="difference")for(var p=a[0],x=1;x<a.length;)zT(a[x].bbox,p.bbox)!==null?x++:a.splice(x,1);if($f.type==="intersection"){for(var I=0,C=a.length;I<C;I++)for(var M=a[I],O=I+1,k=a.length;O<k;O++)if(zT(M.bbox,a[O].bbox)===null)return[]}for(var z=new PS(Yd.compare),G=0,q=a.length;G<q;G++)for(var Z=a[G].getSweepEvents(),K=0,te=Z.length;K<te;K++)if(z.insert(Z[K]),z.size>A2)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var ie=new cz(z),Te=z.size,le=z.pop();le;){var fe=le.key;if(z.size===Te){var Fe=fe.segment;throw new Error("Unable to pop() ".concat(fe.isLeft?"left":"right"," SweepEvent ")+"[".concat(fe.point.x,", ").concat(fe.point.y,"] from segment #").concat(Fe.id," ")+"[".concat(Fe.leftSE.point.x,", ").concat(Fe.leftSE.point.y,"] -> ")+"[".concat(Fe.rightSE.point.x,", ").concat(Fe.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(z.size>A2)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(ie.segments.length>hz)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var Ne=ie.process(fe),Ue=0,dt=Ne.length;Ue<dt;Ue++){var Ge=Ne[Ue];Ge.consumedBy===void 0&&z.insert(Ge)}Te=z.size,le=z.pop()}k1.reset();var Le=lz.factory(ie.segments),nt=new uz(Le);return nt.getGeom()}}]),n}(),$f=new fz,dz=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return $f.run("union",e,i)},pz=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return $f.run("intersection",e,i)},mz=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return $f.run("xor",e,i)},gz=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return $f.run("difference",e,i)},_z={union:dz,intersection:pz,xor:mz,difference:gz};const F1=_z;function yz(n,e,t){t===void 0&&(t={});var i=ag(n),r=ag(e),a=F1.intersection(i.coordinates,r.coordinates);return a.length===0?null:a.length===1?jv(a[0],t.properties):_v(a,t.properties)}function vz(n){const e=n.map(h=>h.source.data);let t=UE(e);const[i,r]=t;return[yz(i,r)]}function xz(n){const e=n.map(i=>i.source.data),t=UE(e).filter(i=>i!==null);return n.length===t.length&&t.length===2}const bz={processor:vz,validator:xz};function Ez(n,e,t){t===void 0&&(t={});var i=ag(n),r=ag(e),a=F1.union(i.coordinates,r.coordinates);return a.length===0?null:a.length===1?jv(a[0],t.properties):_v(a,t.properties)}function wz(n){const e=n.map(r=>r.source.data),[t,i]=e.map(r=>ug(r)?r.features.every(a=>Mc(a.geometry)||Jf(a.geometry))?{type:"MultiPolygon",coordinates:r.features.flatMap(a=>Jf(a.geometry)?a.geometry.coordinates:Mc(a.geometry)?[a.geometry.coordinates]:[])}:null:r);return[Ez(t,i)].filter(r=>r!==null)}function Iz(n){const e=n.map(i=>i.source.data),t=UE(e).filter(i=>i!==null);return n.length===t.length&&t.length===2}const Tz={processor:wz,validator:Iz};function Sz(n,e){var t=ag(n),i=ag(e),r=n.properties||{},a=F1.difference(t.coordinates,i.coordinates);return a.length===0?null:a.length===1?jv(a[0],r):_v(a,r)}function Cz(n,e){if(!e)return null;const{layerA:t,layerB:i}=e,r=[t,i].map(p=>p.source.data),[a,h]=r.map(p=>ug(p)?p.features.every(x=>Mc(x.geometry)||Jf(x.geometry))?{type:"MultiPolygon",coordinates:p.features.flatMap(x=>Jf(x.geometry)?x.geometry.coordinates:Mc(x.geometry)?[x.geometry.coordinates]:[])}:null:p);console.log(a,h);const s=[Sz(a,h)];return console.log(s),s}function Az(n){const e=n.map(i=>i.source.data),t=UE(e).filter(i=>i!==null);return n.length===t.length&&t.length===2}const Mz={processor:Cz,validator:Az};function VT(n,e){e===void 0&&(e={});var t=Number(n[0]),i=Number(n[1]),r=Number(n[2]),a=Number(n[3]);if(n.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var h=[t,i],s=[t,a],p=[r,a],x=[r,i];return jv([[h,x,p,s,h]],e.properties,{bbox:n,id:e.id})}function Lz(n){const t=n.map(r=>r.source.data).map(Jm).map(r=>VT(r)),i=Jm({type:"FeatureCollection",features:t});return[VT(i)]}function Pz(n){if(console.log(n),n.length===0)return!1;const e=n.map(t=>t.source.data).filter(uM);return n.length===e.length}const Rz={processor:Lz,validator:Pz};function M2(n){return function(){return n}}function Dz(n){return n[0]}function Oz(n){return n[1]}function OE(){this._=null}function nw(n){n.U=n.C=n.L=n.R=n.P=n.N=null}OE.prototype={constructor:OE,insert:function(n,e){var t,i,r;if(n){if(e.P=n,e.N=n.N,n.N&&(n.N.P=e),n.N=e,n.R){for(n=n.R;n.L;)n=n.L;n.L=e}else n.R=e;t=n}else this._?(n=L2(this._),e.P=null,e.N=n,n.P=n.L=e,t=n):(e.P=e.N=null,this._=e,t=null);for(e.L=e.R=null,e.U=t,e.C=!0,n=e;t&&t.C;)i=t.U,t===i.L?(r=i.R,r&&r.C?(t.C=r.C=!1,i.C=!0,n=i):(n===t.R&&(r1(this,t),n=t,t=n.U),t.C=!1,i.C=!0,s1(this,i))):(r=i.L,r&&r.C?(t.C=r.C=!1,i.C=!0,n=i):(n===t.L&&(s1(this,t),n=t,t=n.U),t.C=!1,i.C=!0,r1(this,i))),t=n.U;this._.C=!1},remove:function(n){n.N&&(n.N.P=n.P),n.P&&(n.P.N=n.N),n.N=n.P=null;var e=n.U,t,i=n.L,r=n.R,a,h;if(i?r?a=L2(r):a=i:a=r,e?e.L===n?e.L=a:e.R=a:this._=a,i&&r?(h=a.C,a.C=n.C,a.L=i,i.U=a,a!==r?(e=a.U,a.U=n.U,n=a.R,e.L=n,a.R=r,r.U=a):(a.U=e,e=a,n=a.R)):(h=n.C,n=a),n&&(n.U=e),!h){if(n&&n.C){n.C=!1;return}do{if(n===this._)break;if(n===e.L){if(t=e.R,t.C&&(t.C=!1,e.C=!0,r1(this,e),t=e.R),t.L&&t.L.C||t.R&&t.R.C){(!t.R||!t.R.C)&&(t.L.C=!1,t.C=!0,s1(this,t),t=e.R),t.C=e.C,e.C=t.R.C=!1,r1(this,e),n=this._;break}}else if(t=e.L,t.C&&(t.C=!1,e.C=!0,s1(this,e),t=e.L),t.L&&t.L.C||t.R&&t.R.C){(!t.L||!t.L.C)&&(t.R.C=!1,t.C=!0,r1(this,t),t=e.L),t.C=e.C,e.C=t.L.C=!1,s1(this,e),n=this._;break}t.C=!0,n=e,e=e.U}while(!n.C);n&&(n.C=!1)}}};function r1(n,e){var t=e,i=e.R,r=t.U;r?r.L===t?r.L=i:r.R=i:n._=i,i.U=r,t.U=i,t.R=i.L,t.R&&(t.R.U=t),i.L=t}function s1(n,e){var t=e,i=e.L,r=t.U;r?r.L===t?r.L=i:r.R=i:n._=i,i.U=r,t.U=i,t.L=i.R,t.L&&(t.L.U=t),i.R=t}function L2(n){for(;n.L;)n=n.L;return n}function p1(n,e,t,i){var r=[null,null],a=gu.push(r)-1;return r.left=n,r.right=e,t&&NE(r,n,e,t),i&&NE(r,e,n,i),hh[n.index].halfedges.push(a),hh[e.index].halfedges.push(a),r}function o1(n,e,t){var i=[e,t];return i.left=n,i}function NE(n,e,t,i){!n[0]&&!n[1]?(n[0]=i,n.left=e,n.right=t):n.left===t?n[1]=i:n[0]=i}function Nz(n,e,t,i,r){var a=n[0],h=n[1],s=a[0],p=a[1],x=h[0],I=h[1],C=0,M=1,O=x-s,k=I-p,z;if(z=e-s,!(!O&&z>0)){if(z/=O,O<0){if(z<C)return;z<M&&(M=z)}else if(O>0){if(z>M)return;z>C&&(C=z)}if(z=i-s,!(!O&&z<0)){if(z/=O,O<0){if(z>M)return;z>C&&(C=z)}else if(O>0){if(z<C)return;z<M&&(M=z)}if(z=t-p,!(!k&&z>0)){if(z/=k,k<0){if(z<C)return;z<M&&(M=z)}else if(k>0){if(z>M)return;z>C&&(C=z)}if(z=r-p,!(!k&&z<0)){if(z/=k,k<0){if(z>M)return;z>C&&(C=z)}else if(k>0){if(z<C)return;z<M&&(M=z)}return!(C>0)&&!(M<1)||(C>0&&(n[0]=[s+C*O,p+C*k]),M<1&&(n[1]=[s+M*O,p+M*k])),!0}}}}}function kz(n,e,t,i,r){var a=n[1];if(a)return!0;var h=n[0],s=n.left,p=n.right,x=s[0],I=s[1],C=p[0],M=p[1],O=(x+C)/2,k=(I+M)/2,z,G;if(M===I){if(O<e||O>=i)return;if(x>C){if(!h)h=[O,t];else if(h[1]>=r)return;a=[O,r]}else{if(!h)h=[O,r];else if(h[1]<t)return;a=[O,t]}}else if(z=(x-C)/(M-I),G=k-z*O,z<-1||z>1)if(x>C){if(!h)h=[(t-G)/z,t];else if(h[1]>=r)return;a=[(r-G)/z,r]}else{if(!h)h=[(r-G)/z,r];else if(h[1]<t)return;a=[(t-G)/z,t]}else if(I<M){if(!h)h=[e,z*e+G];else if(h[0]>=i)return;a=[i,z*i+G]}else{if(!h)h=[i,z*i+G];else if(h[0]<e)return;a=[e,z*e+G]}return n[0]=h,n[1]=a,!0}function Fz(n,e,t,i){for(var r=gu.length,a;r--;)(!kz(a=gu[r],n,e,t,i)||!Nz(a,n,e,t,i)||!(Math.abs(a[0][0]-a[1][0])>Hs||Math.abs(a[0][1]-a[1][1])>Hs))&&delete gu[r]}function Bz(n){return hh[n.index]={site:n,halfedges:[]}}function zz(n,e){var t=n.site,i=e.left,r=e.right;return t===r&&(r=i,i=t),r?Math.atan2(r[1]-i[1],r[0]-i[0]):(t===i?(i=e[1],r=e[0]):(i=e[0],r=e[1]),Math.atan2(i[0]-r[0],r[1]-i[1]))}function BL(n,e){return e[+(e.left!==n.site)]}function Uz(n,e){return e[+(e.left===n.site)]}function Vz(){for(var n=0,e=hh.length,t,i,r,a;n<e;++n)if((t=hh[n])&&(a=(i=t.halfedges).length)){var h=new Array(a),s=new Array(a);for(r=0;r<a;++r)h[r]=r,s[r]=zz(t,gu[i[r]]);for(h.sort(function(p,x){return s[x]-s[p]}),r=0;r<a;++r)s[r]=i[h[r]];for(r=0;r<a;++r)i[r]=s[r]}}function Gz(n,e,t,i){var r=hh.length,a,h,s,p,x,I,C,M,O,k,z,G,q=!0;for(a=0;a<r;++a)if(h=hh[a]){for(s=h.site,x=h.halfedges,p=x.length;p--;)gu[x[p]]||x.splice(p,1);for(p=0,I=x.length;p<I;)k=Uz(h,gu[x[p]]),z=k[0],G=k[1],C=BL(h,gu[x[++p%I]]),M=C[0],O=C[1],(Math.abs(z-M)>Hs||Math.abs(G-O)>Hs)&&(x.splice(p,0,gu.push(o1(s,k,Math.abs(z-n)<Hs&&i-G>Hs?[n,Math.abs(M-n)<Hs?O:i]:Math.abs(G-i)<Hs&&t-z>Hs?[Math.abs(O-i)<Hs?M:t,i]:Math.abs(z-t)<Hs&&G-e>Hs?[t,Math.abs(M-t)<Hs?O:e]:Math.abs(G-e)<Hs&&z-n>Hs?[Math.abs(O-e)<Hs?M:n,e]:null))-1),++I);I&&(q=!1)}if(q){var Z,K,te,ie=1/0;for(a=0,q=null;a<r;++a)(h=hh[a])&&(s=h.site,Z=s[0]-n,K=s[1]-e,te=Z*Z+K*K,te<ie&&(ie=te,q=h));if(q){var Te=[n,e],le=[n,i],fe=[t,i],Fe=[t,e];q.halfedges.push(gu.push(o1(s=q.site,Te,le))-1,gu.push(o1(s,le,fe))-1,gu.push(o1(s,fe,Fe))-1,gu.push(o1(s,Fe,Te))-1)}}for(a=0;a<r;++a)(h=hh[a])&&(h.halfedges.length||delete hh[a])}var zL=[],RS;function jz(){nw(this),this.x=this.y=this.arc=this.site=this.cy=null}function Qy(n){var e=n.P,t=n.N;if(!(!e||!t)){var i=e.site,r=n.site,a=t.site;if(i!==a){var h=r[0],s=r[1],p=i[0]-h,x=i[1]-s,I=a[0]-h,C=a[1]-s,M=2*(p*C-x*I);if(!(M>=-Zz)){var O=p*p+x*x,k=I*I+C*C,z=(C*O-x*k)/M,G=(p*k-I*O)/M,q=zL.pop()||new jz;q.arc=n,q.site=r,q.x=z+h,q.y=(q.cy=G+s)+Math.sqrt(z*z+G*G),n.circle=q;for(var Z=null,K=B1._;K;)if(q.y<K.y||q.y===K.y&&q.x<=K.x)if(K.L)K=K.L;else{Z=K.P;break}else if(K.R)K=K.R;else{Z=K;break}B1.insert(Z,q),Z||(RS=q)}}}}function ov(n){var e=n.circle;e&&(e.P||(RS=e.N),B1.remove(e),zL.push(e),nw(e),n.circle=null)}var UL=[];function qz(){nw(this),this.edge=this.site=this.circle=null}function P2(n){var e=UL.pop()||new qz;return e.site=n,e}function hT(n){ov(n),av.remove(n),UL.push(n),nw(n)}function Hz(n){var e=n.circle,t=e.x,i=e.cy,r=[t,i],a=n.P,h=n.N,s=[n];hT(n);for(var p=a;p.circle&&Math.abs(t-p.circle.x)<Hs&&Math.abs(i-p.circle.cy)<Hs;)a=p.P,s.unshift(p),hT(p),p=a;s.unshift(p),ov(p);for(var x=h;x.circle&&Math.abs(t-x.circle.x)<Hs&&Math.abs(i-x.circle.cy)<Hs;)h=x.N,s.push(x),hT(x),x=h;s.push(x),ov(x);var I=s.length,C;for(C=1;C<I;++C)x=s[C],p=s[C-1],NE(x.edge,p.site,x.site,r);p=s[0],x=s[I-1],x.edge=p1(p.site,x.site,null,r),Qy(p),Qy(x)}function Wz(n){for(var e=n[0],t=n[1],i,r,a,h,s=av._;s;)if(a=VL(s,t)-e,a>Hs)s=s.L;else if(h=e-Xz(s,t),h>Hs){if(!s.R){i=s;break}s=s.R}else{a>-Hs?(i=s.P,r=s):h>-Hs?(i=s,r=s.N):i=r=s;break}Bz(n);var p=P2(n);if(av.insert(i,p),!(!i&&!r)){if(i===r){ov(i),r=P2(i.site),av.insert(p,r),p.edge=r.edge=p1(i.site,p.site),Qy(i),Qy(r);return}if(!r){p.edge=p1(i.site,p.site);return}ov(i),ov(r);var x=i.site,I=x[0],C=x[1],M=n[0]-I,O=n[1]-C,k=r.site,z=k[0]-I,G=k[1]-C,q=2*(M*G-O*z),Z=M*M+O*O,K=z*z+G*G,te=[(G*Z-O*K)/q+I,(M*K-z*Z)/q+C];NE(r.edge,x,k,te),p.edge=p1(x,n,null,te),r.edge=p1(n,k,null,te),Qy(i),Qy(r)}}function VL(n,e){var t=n.site,i=t[0],r=t[1],a=r-e;if(!a)return i;var h=n.P;if(!h)return-1/0;t=h.site;var s=t[0],p=t[1],x=p-e;if(!x)return s;var I=s-i,C=1/a-1/x,M=I/x;return C?(-M+Math.sqrt(M*M-2*C*(I*I/(-2*x)-p+x/2+r-a/2)))/C+i:(i+s)/2}function Xz(n,e){var t=n.N;if(t)return VL(t,e);var i=n.site;return i[1]===e?i[0]:1/0}var Hs=1e-6,Zz=1e-12,av,hh,B1,gu;function Yz(n,e,t){return(n[0]-t[0])*(e[1]-n[1])-(n[0]-e[0])*(t[1]-n[1])}function Kz(n,e){return e[1]-n[1]||e[0]-n[0]}function GT(n,e){var t=n.sort(Kz).pop(),i,r,a;for(gu=[],hh=new Array(n.length),av=new OE,B1=new OE;;)if(a=RS,t&&(!a||t[1]<a.y||t[1]===a.y&&t[0]<a.x))(t[0]!==i||t[1]!==r)&&(Wz(t),i=t[0],r=t[1]),t=n.pop();else if(a)Hz(a.arc);else break;if(Vz(),e){var h=+e[0][0],s=+e[0][1],p=+e[1][0],x=+e[1][1];Fz(h,s,p,x),Gz(h,s,p,x)}this.edges=gu,this.cells=hh,av=B1=gu=hh=null}GT.prototype={constructor:GT,polygons:function(){var n=this.edges;return this.cells.map(function(e){var t=e.halfedges.map(function(i){return BL(e,n[i])});return t.data=e.site.data,t})},triangles:function(){var n=[],e=this.edges;return this.cells.forEach(function(t,i){if(s=(a=t.halfedges).length)for(var r=t.site,a,h=-1,s,p,x=e[a[s-1]],I=x.left===r?x.right:x.left;++h<s;)p=I,x=e[a[h]],I=x.left===r?x.right:x.left,p&&I&&i<p.index&&i<I.index&&Yz(r,p,I)<0&&n.push([r.data,p.data,I.data])}),n},links:function(){return this.edges.filter(function(n){return n.right}).map(function(n){return{source:n.left.data,target:n.right.data}})},find:function(n,e,t){for(var i=this,r,a=i._found||0,h=i.cells.length,s;!(s=i.cells[a]);)if(++a>=h)return null;var p=n-s.site[0],x=e-s.site[1],I=p*p+x*x;do s=i.cells[r=a],a=null,s.halfedges.forEach(function(C){var M=i.edges[C],O=M.left;if(!((O===s.site||!O)&&!(O=M.right))){var k=n-O[0],z=e-O[1],G=k*k+z*z;G<I&&(I=G,a=O.index)}});while(a!==null);return i._found=r,t==null||I<=t*t?s.site:null}};function Jz(){var n=Dz,e=Oz,t=null;function i(r){return new GT(r.map(function(a,h){var s=[Math.round(n(a,h,r)/Hs)*Hs,Math.round(e(a,h,r)/Hs)*Hs];return s.index=h,s.data=a,s}),t)}return i.polygons=function(r){return i(r).polygons()},i.links=function(r){return i(r).links()},i.triangles=function(r){return i(r).triangles()},i.x=function(r){return arguments.length?(n=typeof r=="function"?r:M2(+r),i):n},i.y=function(r){return arguments.length?(e=typeof r=="function"?r:M2(+r),i):e},i.extent=function(r){return arguments.length?(t=r==null?null:[[+r[0][0],+r[0][1]],[+r[1][0],+r[1][1]]],i):t&&[[t[0][0],t[0][1]],[t[1][0],t[1][1]]]},i.size=function(r){return arguments.length?(t=r==null?null:[[0,0],[+r[0],+r[1]]],i):t&&[t[1][0]-t[0][0],t[1][1]-t[0][1]]},i}function Qz(n){return n=n.slice(),n.push(n[0]),jv([n])}function $z(n,e){if(e=e||{},!ZM(e))throw new Error("options is invalid");var t=e.bbox||[-180,-85,180,85];if(!n)throw new Error("points is required");if(!Array.isArray(t))throw new Error("bbox is invalid");return kL(n,"Point","points"),gv(Jz().x(function(i){return i.geometry.coordinates[0]}).y(function(i){return i.geometry.coordinates[1]}).extent([[t[0],t[1]],[t[2],t[3]]]).polygons(n.features).map(Qz))}function jT(n){if(!n)throw new Error("geojson is required");var e=[];return QF(n,function(t){e.push(t)}),gv(e)}function e4(n,e){let t=n[0].source.data;if(!t||fv.isString(t)||(V1(t)&&(t={type:"FeatureCollection",features:t.geometries.map(a=>({type:"Feature",geometry:a,properties:{}}))}),!ug(t)||!t.features.every(a=>JT(a.geometry)||QT(a.geometry))))return null;const i=jT(t),r=$z(i,{bbox:(e==null?void 0:e.bbox)||Jm(i)});return r.features=r.features.filter(a=>a!==void 0),[r]}function t4(n){if(n.length===0)return!1;const e=n[0].source.data;return!(!e||!uM(e))}const n4={processor:e4,validator:t4};function i4(n,e,t){var i=n.length,r=$y(n[0],e),a=[],h,s,p,x,I;for(t||(t=[]),h=1;h<i;h++){for(x=n[h-1],I=n[h],s=p=$y(I,e);;)if(r|s){if(r&s)break;r?(x=qT(x,I,r,e),r=$y(x,e)):(I=qT(x,I,s,e),s=$y(I,e))}else{a.push(x),s!==p?(a.push(I),h<i-1&&(t.push(a),a=[])):h===i-1&&a.push(I);break}r=p}return a.length&&t.push(a),t}function r4(n,e){var t,i,r,a,h,s,p;for(i=1;i<=8;i*=2){for(t=[],r=n[n.length-1],a=!($y(r,e)&i),h=0;h<n.length;h++)s=n[h],p=!($y(s,e)&i),p!==a&&t.push(qT(r,s,i,e)),p&&t.push(s),r=s,a=p;if(n=t,!n.length)break}return t}function qT(n,e,t,i){return t&8?[n[0]+(e[0]-n[0])*(i[3]-n[1])/(e[1]-n[1]),i[3]]:t&4?[n[0]+(e[0]-n[0])*(i[1]-n[1])/(e[1]-n[1]),i[1]]:t&2?[i[2],n[1]+(e[1]-n[1])*(i[2]-n[0])/(e[0]-n[0])]:t&1?[i[0],n[1]+(e[1]-n[1])*(i[0]-n[0])/(e[0]-n[0])]:null}function $y(n,e){var t=0;return n[0]<e[0]?t|=1:n[0]>e[2]&&(t|=2),n[1]<e[1]?t|=4:n[1]>e[3]&&(t|=8),t}function s4(n,e){var t=ag(n),i=t.type,r=n.type==="Feature"?n.properties:{},a=t.coordinates;switch(i){case"LineString":case"MultiLineString":{var h=[];return i==="LineString"&&(a=[a]),a.forEach(function(s){i4(s,e,h)}),h.length===1?ZF(h[0],r):YF(h,r)}case"Polygon":return jv(R2(a,e),r);case"MultiPolygon":return _v(a.map(function(s){return R2(s,e)}),r);default:throw new Error("geometry "+i+" not supported")}}function R2(n,e){for(var t=[],i=0,r=n;i<r.length;i++){var a=r[i],h=r4(a,e);h.length>0&&((h[0][0]!==h[h.length-1][0]||h[0][1]!==h[h.length-1][1])&&h.push(h[0]),h.length>=4&&t.push(h))}return t}function D2(n,e,t){if(t===void 0&&(t={}),!n)throw new Error("point is required");if(!e)throw new Error("polygon is required");var i=ZB(n),r=ag(e),a=r.type,h=e.bbox,s=r.coordinates;if(h&&o4(i,h)===!1)return!1;a==="Polygon"&&(s=[s]);for(var p=!1,x=0;x<s.length&&!p;x++)if(O2(i,s[x][0],t.ignoreBoundary)){for(var I=!1,C=1;C<s[x].length&&!I;)O2(i,s[x][C],!t.ignoreBoundary)&&(I=!0),C++;I||(p=!0)}return p}function O2(n,e,t){var i=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var r=0,a=e.length-1;r<e.length;a=r++){var h=e[r][0],s=e[r][1],p=e[a][0],x=e[a][1],I=n[1]*(h-p)+s*(p-n[0])+x*(n[0]-h)===0&&(h-n[0])*(p-n[0])<=0&&(s-n[1])*(x-n[1])<=0;if(I)return!t;var C=s>n[1]!=x>n[1]&&n[0]<(p-h)*(n[1]-s)/(x-s)+h;C&&(i=!i)}return i}function o4(n,e){return e[0]<=n[0]&&e[1]<=n[1]&&e[2]>=n[0]&&e[3]>=n[1]}function fT(n,e){let t;if(Vv(n))t=n.geometry;else if(oM(n))t=n;else return[];const i=VT(e.bbox);if(JT(t)){if(D2(t,i))return{type:"Feature",geometry:t,properties:{}}}else if(QT(t))return{type:"Feature",geometry:{type:"MultiPoint",coordinates:t.coordinates.filter(r=>D2(r,i))},properties:{}};return aM(t)||lM(t)||Mc(t)||Jf(t)?s4(t,e.bbox):[]}function a4(n,e){return n.map(r=>r.source.data).map(r=>V1(r)?{type:"GeometryCollection",geometries:r.geometries.flatMap(a=>fT(a,e)).map(a=>a.geometry)}:ug(r)?{type:"FeatureCollection",features:r.features.flatMap(a=>fT(a,e))}:Vv(r)||oM(r)?fT(r,e):null).filter(r=>r!==void 0)}function l4(n,e){const t=n.map(i=>i.source.data)[0];return n.length>0&&e!==void 0&&C_(t)}const u4={processor:a4,validator:l4};function c4(n,e){if(e=e||{},!ZM(e))throw new Error("options is invalid");var t=e.propertyName;kL(n,"Polygon","dissolve");var i=[];if(e.propertyName){var r={};AT(n,function(p){Object.prototype.hasOwnProperty.call(r,p.properties[t])||(r[p.properties[t]]=[]),r[p.properties[t]].push(p)});for(var a=Object.keys(r),h=0;h<a.length;h++){var s=_v(F1.union.apply(null,r[a[h]].map(function(p){return p.geometry.coordinates})));s.properties[t]=a[h],i.push(s)}}else return jT(_v(F1.union.apply(null,n.features.map(function(p){return p.geometry.coordinates}))));return jT(gv(i))}function h4(n){return GL(n)?n.map(t=>t.source.data).map(t=>c4(t)):null}function GL(n){return n.length===0?!1:n.every(e=>{const t=e.source.data;return C_(t)&&ug(t)&&t.features.every(i=>Mc(i.geometry))})}const f4={processor:h4,validator:GL};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Oa={DISABLED:"mdc-slider--disabled",DISCRETE:"mdc-slider--discrete",INPUT:"mdc-slider__input",RANGE:"mdc-slider--range",THUMB:"mdc-slider__thumb",THUMB_FOCUSED:"mdc-slider__thumb--focused",THUMB_KNOB:"mdc-slider__thumb-knob",THUMB_TOP:"mdc-slider__thumb--top",THUMB_WITH_INDICATOR:"mdc-slider__thumb--with-indicator",TICK_MARKS:"mdc-slider--tick-marks",TICK_MARKS_CONTAINER:"mdc-slider__tick-marks",TICK_MARK_ACTIVE:"mdc-slider__tick-mark--active",TICK_MARK_INACTIVE:"mdc-slider__tick-mark--inactive",TRACK:"mdc-slider__track",TRACK_ACTIVE:"mdc-slider__track--active_fill",VALUE_INDICATOR_CONTAINER:"mdc-slider__value-indicator-container",VALUE_INDICATOR_TEXT:"mdc-slider__value-indicator-text"},dT={STEP_SIZE:1,MIN_RANGE:0,THUMB_UPDATE_MIN_PX:5},Na={ARIA_VALUETEXT:"aria-valuetext",INPUT_DISABLED:"disabled",INPUT_MIN:"min",INPUT_MAX:"max",INPUT_VALUE:"value",INPUT_STEP:"step",DATA_MIN_RANGE:"data-min-range"},vl={VAR_VALUE_INDICATOR_CARET_LEFT:"--slider-value-indicator-caret-left",VAR_VALUE_INDICATOR_CARET_RIGHT:"--slider-value-indicator-caret-right",VAR_VALUE_INDICATOR_CARET_TRANSFORM:"--slider-value-indicator-caret-transform",VAR_VALUE_INDICATOR_CONTAINER_LEFT:"--slider-value-indicator-container-left",VAR_VALUE_INDICATOR_CONTAINER_RIGHT:"--slider-value-indicator-container-right",VAR_VALUE_INDICATOR_CONTAINER_TRANSFORM:"--slider-value-indicator-container-transform"};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var uf;(function(n){n[n.ACTIVE=0]="ACTIVE",n[n.INACTIVE=1]="INACTIVE"})(uf||(uf={}));var Dt;(function(n){n[n.START=1]="START",n[n.END=2]="END"})(Dt||(Dt={}));/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var kE;(function(n){n.SLIDER_UPDATE="slider_update"})(kE||(kE={}));var pT=typeof window<"u",d4=function(n){Eh(e,n);function e(t){var i=n.call(this,ks(ks({},e.defaultAdapter),t))||this;return i.initialStylesRemoved=!1,i.isDisabled=!1,i.isDiscrete=!1,i.step=dT.STEP_SIZE,i.minRange=dT.MIN_RANGE,i.hasTickMarks=!1,i.isRange=!1,i.thumb=null,i.downEventClientX=null,i.startThumbKnobWidth=0,i.endThumbKnobWidth=0,i.animFrame=new hM,i}return Object.defineProperty(e,"defaultAdapter",{get:function(){return{hasClass:function(){return!1},addClass:function(){},removeClass:function(){},addThumbClass:function(){},removeThumbClass:function(){},getAttribute:function(){return null},getInputValue:function(){return""},setInputValue:function(){},getInputAttribute:function(){return null},setInputAttribute:function(){return null},removeInputAttribute:function(){return null},focusInput:function(){},isInputFocused:function(){return!1},shouldHideFocusStylesForPointerEvents:function(){return!1},getThumbKnobWidth:function(){return 0},getValueIndicatorContainerWidth:function(){return 0},getThumbBoundingClientRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},getBoundingClientRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},isRTL:function(){return!1},setThumbStyleProperty:function(){},removeThumbStyleProperty:function(){},setTrackActiveStyleProperty:function(){},removeTrackActiveStyleProperty:function(){},setValueIndicatorText:function(){},getValueToAriaValueTextFn:function(){return null},updateTickMarks:function(){},setPointerCapture:function(){},emitChangeEvent:function(){},emitInputEvent:function(){},emitDragStartEvent:function(){},emitDragEndEvent:function(){},registerEventHandler:function(){},deregisterEventHandler:function(){},registerThumbEventHandler:function(){},deregisterThumbEventHandler:function(){},registerInputEventHandler:function(){},deregisterInputEventHandler:function(){},registerBodyEventHandler:function(){},deregisterBodyEventHandler:function(){},registerWindowEventHandler:function(){},deregisterWindowEventHandler:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){var t=this;this.isDisabled=this.adapter.hasClass(Oa.DISABLED),this.isDiscrete=this.adapter.hasClass(Oa.DISCRETE),this.hasTickMarks=this.adapter.hasClass(Oa.TICK_MARKS),this.isRange=this.adapter.hasClass(Oa.RANGE);var i=this.convertAttributeValueToNumber(this.adapter.getInputAttribute(Na.INPUT_MIN,this.isRange?Dt.START:Dt.END),Na.INPUT_MIN),r=this.convertAttributeValueToNumber(this.adapter.getInputAttribute(Na.INPUT_MAX,Dt.END),Na.INPUT_MAX),a=this.convertAttributeValueToNumber(this.adapter.getInputAttribute(Na.INPUT_VALUE,Dt.END),Na.INPUT_VALUE),h=this.isRange?this.convertAttributeValueToNumber(this.adapter.getInputAttribute(Na.INPUT_VALUE,Dt.START),Na.INPUT_VALUE):i,s=this.adapter.getInputAttribute(Na.INPUT_STEP,Dt.END),p=s?this.convertAttributeValueToNumber(s,Na.INPUT_STEP):this.step,x=this.adapter.getAttribute(Na.DATA_MIN_RANGE),I=x?this.convertAttributeValueToNumber(x,Na.DATA_MIN_RANGE):this.minRange;this.validateProperties({min:i,max:r,value:a,valueStart:h,step:p,minRange:I}),this.min=i,this.max=r,this.value=a,this.valueStart=h,this.step=p,this.minRange=I,this.numDecimalPlaces=N2(this.step),this.valueBeforeDownEvent=a,this.valueStartBeforeDownEvent=h,this.mousedownOrTouchstartListener=this.handleMousedownOrTouchstart.bind(this),this.moveListener=this.handleMove.bind(this),this.pointerdownListener=this.handlePointerdown.bind(this),this.pointerupListener=this.handlePointerup.bind(this),this.thumbMouseenterListener=this.handleThumbMouseenter.bind(this),this.thumbMouseleaveListener=this.handleThumbMouseleave.bind(this),this.inputStartChangeListener=function(){t.handleInputChange(Dt.START)},this.inputEndChangeListener=function(){t.handleInputChange(Dt.END)},this.inputStartFocusListener=function(){t.handleInputFocus(Dt.START)},this.inputEndFocusListener=function(){t.handleInputFocus(Dt.END)},this.inputStartBlurListener=function(){t.handleInputBlur(Dt.START)},this.inputEndBlurListener=function(){t.handleInputBlur(Dt.END)},this.resizeListener=this.handleResize.bind(this),this.registerEventHandlers()},e.prototype.destroy=function(){this.deregisterEventHandlers()},e.prototype.setMin=function(t){this.min=t,this.isRange||(this.valueStart=t),this.updateUI()},e.prototype.setMax=function(t){this.max=t,this.updateUI()},e.prototype.getMin=function(){return this.min},e.prototype.getMax=function(){return this.max},e.prototype.getValue=function(){return this.value},e.prototype.setValue=function(t){if(this.isRange&&t<this.valueStart+this.minRange)throw new Error("end thumb value ("+t+") must be >= start thumb "+("value ("+this.valueStart+") + min range ("+this.minRange+")"));this.updateValue(t,Dt.END)},e.prototype.getValueStart=function(){if(!this.isRange)throw new Error("`valueStart` is only applicable for range sliders.");return this.valueStart},e.prototype.setValueStart=function(t){if(!this.isRange)throw new Error("`valueStart` is only applicable for range sliders.");if(this.isRange&&t>this.value-this.minRange)throw new Error("start thumb value ("+t+") must be <= end thumb "+("value ("+this.value+") - min range ("+this.minRange+")"));this.updateValue(t,Dt.START)},e.prototype.setStep=function(t){this.step=t,this.numDecimalPlaces=N2(t),this.updateUI()},e.prototype.setMinRange=function(t){if(!this.isRange)throw new Error("`minRange` is only applicable for range sliders.");if(t<0)throw new Error("`minRange` must be non-negative. "+("Current value: "+t));if(this.value-this.valueStart<t)throw new Error("start thumb value ("+this.valueStart+") and end thumb value "+("("+this.value+") must differ by at least "+t+"."));this.minRange=t},e.prototype.setIsDiscrete=function(t){this.isDiscrete=t,this.updateValueIndicatorUI(),this.updateTickMarksUI()},e.prototype.getStep=function(){return this.step},e.prototype.getMinRange=function(){if(!this.isRange)throw new Error("`minRange` is only applicable for range sliders.");return this.minRange},e.prototype.setHasTickMarks=function(t){this.hasTickMarks=t,this.updateTickMarksUI()},e.prototype.getDisabled=function(){return this.isDisabled},e.prototype.setDisabled=function(t){this.isDisabled=t,t?(this.adapter.addClass(Oa.DISABLED),this.isRange&&this.adapter.setInputAttribute(Na.INPUT_DISABLED,"",Dt.START),this.adapter.setInputAttribute(Na.INPUT_DISABLED,"",Dt.END)):(this.adapter.removeClass(Oa.DISABLED),this.isRange&&this.adapter.removeInputAttribute(Na.INPUT_DISABLED,Dt.START),this.adapter.removeInputAttribute(Na.INPUT_DISABLED,Dt.END))},e.prototype.getIsRange=function(){return this.isRange},e.prototype.layout=function(t){var i=t===void 0?{}:t,r=i.skipUpdateUI;this.rect=this.adapter.getBoundingClientRect(),this.isRange&&(this.startThumbKnobWidth=this.adapter.getThumbKnobWidth(Dt.START),this.endThumbKnobWidth=this.adapter.getThumbKnobWidth(Dt.END)),r||this.updateUI()},e.prototype.handleResize=function(){this.layout()},e.prototype.handleDown=function(t){if(!this.isDisabled){this.valueStartBeforeDownEvent=this.valueStart,this.valueBeforeDownEvent=this.value;var i=t.clientX!=null?t.clientX:t.targetTouches[0].clientX;this.downEventClientX=i;var r=this.mapClientXOnSliderScale(i);this.thumb=this.getThumbFromDownEvent(i,r),this.thumb!==null&&(this.handleDragStart(t,r,this.thumb),this.updateValue(r,this.thumb,{emitInputEvent:!0}))}},e.prototype.handleMove=function(t){if(!this.isDisabled){t.preventDefault();var i=t.clientX!=null?t.clientX:t.targetTouches[0].clientX,r=this.thumb!=null;if(this.thumb=this.getThumbFromMoveEvent(i),this.thumb!==null){var a=this.mapClientXOnSliderScale(i);r||(this.handleDragStart(t,a,this.thumb),this.adapter.emitDragStartEvent(a,this.thumb)),this.updateValue(a,this.thumb,{emitInputEvent:!0})}}},e.prototype.handleUp=function(){var t,i;if(!(this.isDisabled||this.thumb===null)){!((i=(t=this.adapter).shouldHideFocusStylesForPointerEvents)===null||i===void 0)&&i.call(t)&&this.handleInputBlur(this.thumb);var r=this.thumb===Dt.START?this.valueStartBeforeDownEvent:this.valueBeforeDownEvent,a=this.thumb===Dt.START?this.valueStart:this.value;r!==a&&this.adapter.emitChangeEvent(a,this.thumb),this.adapter.emitDragEndEvent(a,this.thumb),this.thumb=null}},e.prototype.handleThumbMouseenter=function(){!this.isDiscrete||!this.isRange||(this.adapter.addThumbClass(Oa.THUMB_WITH_INDICATOR,Dt.START),this.adapter.addThumbClass(Oa.THUMB_WITH_INDICATOR,Dt.END))},e.prototype.handleThumbMouseleave=function(){var t,i;!this.isDiscrete||!this.isRange||!(!((i=(t=this.adapter).shouldHideFocusStylesForPointerEvents)===null||i===void 0)&&i.call(t))&&(this.adapter.isInputFocused(Dt.START)||this.adapter.isInputFocused(Dt.END))||this.thumb||(this.adapter.removeThumbClass(Oa.THUMB_WITH_INDICATOR,Dt.START),this.adapter.removeThumbClass(Oa.THUMB_WITH_INDICATOR,Dt.END))},e.prototype.handleMousedownOrTouchstart=function(t){var i=this,r=t.type==="mousedown"?"mousemove":"touchmove";this.adapter.registerBodyEventHandler(r,this.moveListener);var a=function(){i.handleUp(),i.adapter.deregisterBodyEventHandler(r,i.moveListener),i.adapter.deregisterEventHandler("mouseup",a),i.adapter.deregisterEventHandler("touchend",a)};this.adapter.registerBodyEventHandler("mouseup",a),this.adapter.registerBodyEventHandler("touchend",a),this.handleDown(t)},e.prototype.handlePointerdown=function(t){var i=t.button===0;i&&(t.pointerId!=null&&this.adapter.setPointerCapture(t.pointerId),this.adapter.registerEventHandler("pointermove",this.moveListener),this.handleDown(t))},e.prototype.handleInputChange=function(t){var i=Number(this.adapter.getInputValue(t));t===Dt.START?this.setValueStart(i):this.setValue(i),this.adapter.emitChangeEvent(t===Dt.START?this.valueStart:this.value,t),this.adapter.emitInputEvent(t===Dt.START?this.valueStart:this.value,t)},e.prototype.handleInputFocus=function(t){if(this.adapter.addThumbClass(Oa.THUMB_FOCUSED,t),!!this.isDiscrete&&(this.adapter.addThumbClass(Oa.THUMB_WITH_INDICATOR,t),this.isRange)){var i=t===Dt.START?Dt.END:Dt.START;this.adapter.addThumbClass(Oa.THUMB_WITH_INDICATOR,i)}},e.prototype.handleInputBlur=function(t){if(this.adapter.removeThumbClass(Oa.THUMB_FOCUSED,t),!!this.isDiscrete&&(this.adapter.removeThumbClass(Oa.THUMB_WITH_INDICATOR,t),this.isRange)){var i=t===Dt.START?Dt.END:Dt.START;this.adapter.removeThumbClass(Oa.THUMB_WITH_INDICATOR,i)}},e.prototype.handleDragStart=function(t,i,r){var a,h;this.adapter.emitDragStartEvent(i,r),this.adapter.focusInput(r),!((h=(a=this.adapter).shouldHideFocusStylesForPointerEvents)===null||h===void 0)&&h.call(a)&&this.handleInputFocus(r),t.preventDefault()},e.prototype.getThumbFromDownEvent=function(t,i){if(!this.isRange)return Dt.END;var r=this.adapter.getThumbBoundingClientRect(Dt.START),a=this.adapter.getThumbBoundingClientRect(Dt.END),h=t>=r.left&&t<=r.right,s=t>=a.left&&t<=a.right;return h&&s?null:h?Dt.START:s?Dt.END:i<this.valueStart?Dt.START:i>this.value?Dt.END:i-this.valueStart<=this.value-i?Dt.START:Dt.END},e.prototype.getThumbFromMoveEvent=function(t){if(this.thumb!==null)return this.thumb;if(this.downEventClientX===null)throw new Error("`downEventClientX` is null after move event.");var i=Math.abs(this.downEventClientX-t)<dT.THUMB_UPDATE_MIN_PX;if(i)return this.thumb;var r=t<this.downEventClientX;return r?this.adapter.isRTL()?Dt.END:Dt.START:this.adapter.isRTL()?Dt.START:Dt.END},e.prototype.updateUI=function(t){t?this.updateThumbAndInputAttributes(t):(this.updateThumbAndInputAttributes(Dt.START),this.updateThumbAndInputAttributes(Dt.END)),this.updateThumbAndTrackUI(t),this.updateValueIndicatorUI(t),this.updateTickMarksUI()},e.prototype.updateThumbAndInputAttributes=function(t){if(t){var i=this.isRange&&t===Dt.START?this.valueStart:this.value,r=String(i);this.adapter.setInputAttribute(Na.INPUT_VALUE,r,t),this.isRange&&t===Dt.START?this.adapter.setInputAttribute(Na.INPUT_MIN,String(i+this.minRange),Dt.END):this.isRange&&t===Dt.END&&this.adapter.setInputAttribute(Na.INPUT_MAX,String(i-this.minRange),Dt.START),this.adapter.getInputValue(t)!==r&&this.adapter.setInputValue(r,t);var a=this.adapter.getValueToAriaValueTextFn();a&&this.adapter.setInputAttribute(Na.ARIA_VALUETEXT,a(i,t),t)}},e.prototype.updateValueIndicatorUI=function(t){if(this.isDiscrete){var i=this.isRange&&t===Dt.START?this.valueStart:this.value;this.adapter.setValueIndicatorText(i,t===Dt.START?Dt.START:Dt.END),!t&&this.isRange&&this.adapter.setValueIndicatorText(this.valueStart,Dt.START)}},e.prototype.updateTickMarksUI=function(){if(!(!this.isDiscrete||!this.hasTickMarks)){var t=(this.valueStart-this.min)/this.step,i=(this.value-this.valueStart)/this.step+1,r=(this.max-this.value)/this.step,a=Array.from({length:t}).fill(uf.INACTIVE),h=Array.from({length:i}).fill(uf.ACTIVE),s=Array.from({length:r}).fill(uf.INACTIVE);this.adapter.updateTickMarks(a.concat(h).concat(s))}},e.prototype.mapClientXOnSliderScale=function(t){var i=t-this.rect.left,r=i/this.rect.width;this.adapter.isRTL()&&(r=1-r);var a=this.min+r*(this.max-this.min);return a===this.max||a===this.min?a:Number(this.quantize(a).toFixed(this.numDecimalPlaces))},e.prototype.quantize=function(t){var i=Math.round((t-this.min)/this.step);return this.min+i*this.step},e.prototype.updateValue=function(t,i,r){var a=r===void 0?{}:r,h=a.emitInputEvent;if(t=this.clampValue(t,i),this.isRange&&i===Dt.START){if(this.valueStart===t)return;this.valueStart=t}else{if(this.value===t)return;this.value=t}this.updateUI(i),h&&this.adapter.emitInputEvent(i===Dt.START?this.valueStart:this.value,i)},e.prototype.clampValue=function(t,i){t=Math.min(Math.max(t,this.min),this.max);var r=this.isRange&&i===Dt.START&&t>this.value-this.minRange;if(r)return this.value-this.minRange;var a=this.isRange&&i===Dt.END&&t<this.valueStart+this.minRange;return a?this.valueStart+this.minRange:t},e.prototype.updateThumbAndTrackUI=function(t){var i=this,r=this,a=r.max,h=r.min,s=(this.value-this.valueStart)/(a-h),p=s*this.rect.width,x=this.adapter.isRTL(),I=pT?mE(window,"transform"):"transform";if(this.isRange){var C=this.adapter.isRTL()?(a-this.value)/(a-h)*this.rect.width:(this.valueStart-h)/(a-h)*this.rect.width,M=C+p;this.animFrame.request(kE.SLIDER_UPDATE,function(){var O=!x&&t===Dt.START||x&&t!==Dt.START;O?(i.adapter.setTrackActiveStyleProperty("transform-origin","right"),i.adapter.setTrackActiveStyleProperty("left","auto"),i.adapter.setTrackActiveStyleProperty("right",i.rect.width-M+"px")):(i.adapter.setTrackActiveStyleProperty("transform-origin","left"),i.adapter.setTrackActiveStyleProperty("right","auto"),i.adapter.setTrackActiveStyleProperty("left",C+"px")),i.adapter.setTrackActiveStyleProperty(I,"scaleX("+s+")");var k=x?M:C,z=i.adapter.isRTL()?C:M;(t===Dt.START||!t||!i.initialStylesRemoved)&&(i.adapter.setThumbStyleProperty(I,"translateX("+k+"px)",Dt.START),i.alignValueIndicator(Dt.START,k)),(t===Dt.END||!t||!i.initialStylesRemoved)&&(i.adapter.setThumbStyleProperty(I,"translateX("+z+"px)",Dt.END),i.alignValueIndicator(Dt.END,z)),i.removeInitialStyles(x),i.updateOverlappingThumbsUI(k,z,t)})}else this.animFrame.request(kE.SLIDER_UPDATE,function(){var O=x?i.rect.width-p:p;i.adapter.setThumbStyleProperty(I,"translateX("+O+"px)",Dt.END),i.alignValueIndicator(Dt.END,O),i.adapter.setTrackActiveStyleProperty(I,"scaleX("+s+")"),i.removeInitialStyles(x)})},e.prototype.alignValueIndicator=function(t,i){if(this.isDiscrete){var r=this.adapter.getThumbBoundingClientRect(t).width/2,a=this.adapter.getValueIndicatorContainerWidth(t),h=this.adapter.getBoundingClientRect().width;a/2>i+r?(this.adapter.setThumbStyleProperty(vl.VAR_VALUE_INDICATOR_CARET_LEFT,r+"px",t),this.adapter.setThumbStyleProperty(vl.VAR_VALUE_INDICATOR_CARET_RIGHT,"auto",t),this.adapter.setThumbStyleProperty(vl.VAR_VALUE_INDICATOR_CARET_TRANSFORM,"translateX(-50%)",t),this.adapter.setThumbStyleProperty(vl.VAR_VALUE_INDICATOR_CONTAINER_LEFT,"0",t),this.adapter.setThumbStyleProperty(vl.VAR_VALUE_INDICATOR_CONTAINER_RIGHT,"auto",t),this.adapter.setThumbStyleProperty(vl.VAR_VALUE_INDICATOR_CONTAINER_TRANSFORM,"none",t)):a/2>h-i+r?(this.adapter.setThumbStyleProperty(vl.VAR_VALUE_INDICATOR_CARET_LEFT,"auto",t),this.adapter.setThumbStyleProperty(vl.VAR_VALUE_INDICATOR_CARET_RIGHT,r+"px",t),this.adapter.setThumbStyleProperty(vl.VAR_VALUE_INDICATOR_CARET_TRANSFORM,"translateX(50%)",t),this.adapter.setThumbStyleProperty(vl.VAR_VALUE_INDICATOR_CONTAINER_LEFT,"auto",t),this.adapter.setThumbStyleProperty(vl.VAR_VALUE_INDICATOR_CONTAINER_RIGHT,"0",t),this.adapter.setThumbStyleProperty(vl.VAR_VALUE_INDICATOR_CONTAINER_TRANSFORM,"none",t)):(this.adapter.setThumbStyleProperty(vl.VAR_VALUE_INDICATOR_CARET_LEFT,"50%",t),this.adapter.setThumbStyleProperty(vl.VAR_VALUE_INDICATOR_CARET_RIGHT,"auto",t),this.adapter.setThumbStyleProperty(vl.VAR_VALUE_INDICATOR_CARET_TRANSFORM,"translateX(-50%)",t),this.adapter.setThumbStyleProperty(vl.VAR_VALUE_INDICATOR_CONTAINER_LEFT,"50%",t),this.adapter.setThumbStyleProperty(vl.VAR_VALUE_INDICATOR_CONTAINER_RIGHT,"auto",t),this.adapter.setThumbStyleProperty(vl.VAR_VALUE_INDICATOR_CONTAINER_TRANSFORM,"translateX(-50%)",t))}},e.prototype.removeInitialStyles=function(t){if(!this.initialStylesRemoved){var i=t?"right":"left";this.adapter.removeThumbStyleProperty(i,Dt.END),this.isRange&&this.adapter.removeThumbStyleProperty(i,Dt.START),this.initialStylesRemoved=!0,this.resetTrackAndThumbAnimation()}},e.prototype.resetTrackAndThumbAnimation=function(){var t=this;if(this.isDiscrete){var i=pT?mE(window,"transition"):"transition",r="none 0s ease 0s";this.adapter.setThumbStyleProperty(i,r,Dt.END),this.isRange&&this.adapter.setThumbStyleProperty(i,r,Dt.START),this.adapter.setTrackActiveStyleProperty(i,r),requestAnimationFrame(function(){t.adapter.removeThumbStyleProperty(i,Dt.END),t.adapter.removeTrackActiveStyleProperty(i),t.isRange&&t.adapter.removeThumbStyleProperty(i,Dt.START)})}},e.prototype.updateOverlappingThumbsUI=function(t,i,r){var a=!1;if(this.adapter.isRTL()){var h=t-this.startThumbKnobWidth/2,s=i+this.endThumbKnobWidth/2;a=s>=h}else{var p=t+this.startThumbKnobWidth/2,x=i-this.endThumbKnobWidth/2;a=p>=x}a?(this.adapter.addThumbClass(Oa.THUMB_TOP,r||Dt.END),this.adapter.removeThumbClass(Oa.THUMB_TOP,r===Dt.START?Dt.END:Dt.START)):(this.adapter.removeThumbClass(Oa.THUMB_TOP,Dt.START),this.adapter.removeThumbClass(Oa.THUMB_TOP,Dt.END))},e.prototype.convertAttributeValueToNumber=function(t,i){if(t===null)throw new Error("MDCSliderFoundation: `"+i+"` must be non-null.");var r=Number(t);if(isNaN(r))throw new Error("MDCSliderFoundation: `"+i+"` value is `"+t+"`, but must be a number.");return r},e.prototype.validateProperties=function(t){var i=t.min,r=t.max,a=t.value,h=t.valueStart,s=t.step,p=t.minRange;if(i>=r)throw new Error("MDCSliderFoundation: min must be strictly less than max. "+("Current: [min: "+i+", max: "+r+"]"));if(s<=0)throw new Error("MDCSliderFoundation: step must be a positive number. "+("Current step: "+s));if(this.isRange){if(a<i||a>r||h<i||h>r)throw new Error("MDCSliderFoundation: values must be in [min, max] range. "+("Current values: [start value: "+h+", end value: ")+(a+", min: "+i+", max: "+r+"]"));if(h>a)throw new Error("MDCSliderFoundation: start value must be <= end value. "+("Current values: [start value: "+h+", end value: "+a+"]"));if(p<0)throw new Error("MDCSliderFoundation: minimum range must be non-negative. "+("Current min range: "+p));if(a-h<p)throw new Error("MDCSliderFoundation: start value and end value must differ by at least "+(p+". Current values: [start value: "+h+", ")+("end value: "+a+"]"));var x=(h-i)/s,I=(a-i)/s;if(!Number.isInteger(parseFloat(x.toFixed(6)))||!Number.isInteger(parseFloat(I.toFixed(6))))throw new Error("MDCSliderFoundation: Slider values must be valid based on the "+("step value ("+s+"). Current values: [start value: ")+(h+", end value: "+a+", min: "+i+"]"))}else{if(a<i||a>r)throw new Error("MDCSliderFoundation: value must be in [min, max] range. "+("Current values: [value: "+a+", min: "+i+", max: "+r+"]"));var I=(a-i)/s;if(!Number.isInteger(parseFloat(I.toFixed(6))))throw new Error("MDCSliderFoundation: Slider value must be valid based on the "+("step value ("+s+"). Current value: "+a))}},e.prototype.registerEventHandlers=function(){this.adapter.registerWindowEventHandler("resize",this.resizeListener),e.SUPPORTS_POINTER_EVENTS?(this.adapter.registerEventHandler("pointerdown",this.pointerdownListener),this.adapter.registerEventHandler("pointerup",this.pointerupListener)):(this.adapter.registerEventHandler("mousedown",this.mousedownOrTouchstartListener),this.adapter.registerEventHandler("touchstart",this.mousedownOrTouchstartListener)),this.isRange&&(this.adapter.registerThumbEventHandler(Dt.START,"mouseenter",this.thumbMouseenterListener),this.adapter.registerThumbEventHandler(Dt.START,"mouseleave",this.thumbMouseleaveListener),this.adapter.registerInputEventHandler(Dt.START,"change",this.inputStartChangeListener),this.adapter.registerInputEventHandler(Dt.START,"focus",this.inputStartFocusListener),this.adapter.registerInputEventHandler(Dt.START,"blur",this.inputStartBlurListener)),this.adapter.registerThumbEventHandler(Dt.END,"mouseenter",this.thumbMouseenterListener),this.adapter.registerThumbEventHandler(Dt.END,"mouseleave",this.thumbMouseleaveListener),this.adapter.registerInputEventHandler(Dt.END,"change",this.inputEndChangeListener),this.adapter.registerInputEventHandler(Dt.END,"focus",this.inputEndFocusListener),this.adapter.registerInputEventHandler(Dt.END,"blur",this.inputEndBlurListener)},e.prototype.deregisterEventHandlers=function(){this.adapter.deregisterWindowEventHandler("resize",this.resizeListener),e.SUPPORTS_POINTER_EVENTS?(this.adapter.deregisterEventHandler("pointerdown",this.pointerdownListener),this.adapter.deregisterEventHandler("pointerup",this.pointerupListener)):(this.adapter.deregisterEventHandler("mousedown",this.mousedownOrTouchstartListener),this.adapter.deregisterEventHandler("touchstart",this.mousedownOrTouchstartListener)),this.isRange&&(this.adapter.deregisterThumbEventHandler(Dt.START,"mouseenter",this.thumbMouseenterListener),this.adapter.deregisterThumbEventHandler(Dt.START,"mouseleave",this.thumbMouseleaveListener),this.adapter.deregisterInputEventHandler(Dt.START,"change",this.inputStartChangeListener),this.adapter.deregisterInputEventHandler(Dt.START,"focus",this.inputStartFocusListener),this.adapter.deregisterInputEventHandler(Dt.START,"blur",this.inputStartBlurListener)),this.adapter.deregisterThumbEventHandler(Dt.END,"mouseenter",this.thumbMouseenterListener),this.adapter.deregisterThumbEventHandler(Dt.END,"mouseleave",this.thumbMouseleaveListener),this.adapter.deregisterInputEventHandler(Dt.END,"change",this.inputEndChangeListener),this.adapter.deregisterInputEventHandler(Dt.END,"focus",this.inputEndFocusListener),this.adapter.deregisterInputEventHandler(Dt.END,"blur",this.inputEndBlurListener)},e.prototype.handlePointerup=function(){this.handleUp(),this.adapter.deregisterEventHandler("pointermove",this.moveListener)},e.SUPPORTS_POINTER_EVENTS=pT&&!!window.PointerEvent&&!p4(),e}(wh);function p4(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function N2(n){var e=/(?:\.(\d+))?(?:[eE]([+\-]?\d+))?$/.exec(String(n));if(!e)return 0;var t=e[1]||"",i=e[2]||0;return Math.max(0,(t==="0"?0:t.length)-Number(i))}function k2(n,e,t){const i=n.slice();return i[92]=e[t],i}function m4(n){let e,t,i,r,a=[{class:t=si({[n[13]]:!0,"mdc-slider__input":!0})},{type:"range"},{disabled:n[5]},{step:n[9]},{min:n[10]},{max:n[11]},n[33],n[24],sr(n[37],"input$")],h={};for(let s=0;s<a.length;s+=1)h=dn(h,a[s]);return{c(){e=un("input"),this.h()},l(s){e=cn(s,"INPUT",{class:!0,type:!0,step:!0,min:!0,max:!0}),this.h()},h(){Ki(e,h)},m(s,p){Tt(s,e,p),e.autofocus&&e.focus(),n[62](e),Um(e,n[0]),i||(r=[Vi(e,"change",n[63]),Vi(e,"input",n[63]),Vi(e,"blur",n[56]),Vi(e,"focus",n[57])],i=!0)},p(s,p){Ki(e,h=Gi(a,[p[0]&8192&&t!==(t=si({[s[13]]:!0,"mdc-slider__input":!0}))&&{class:t},{type:"range"},p[0]&32&&{disabled:s[5]},p[0]&512&&{step:s[9]},p[0]&1024&&{min:s[10]},p[0]&2048&&{max:s[11]},s[33],p[0]&16777216&&s[24],p[1]&64&&sr(s[37],"input$")])),p[0]&1&&Um(e,s[0])},d(s){s&&Oe(e),n[62](null),i=!1,sa(r)}}}function g4(n){let e,t,i,r,a,h,s,p=[{class:t=si({[n[13]]:!0,"mdc-slider__input":!0})},{type:"range"},{disabled:n[5]},{step:n[9]},{min:n[10]},{max:n[2]},n[25],sr(n[37],"input$")],x={};for(let M=0;M<p.length;M+=1)x=dn(x,p[M]);let I=[{class:a=si({[n[13]]:!0,"mdc-slider__input":!0})},{type:"range"},{disabled:n[5]},{step:n[9]},{min:n[1]},{max:n[11]},n[33],n[24],sr(n[37],"input$")],C={};for(let M=0;M<I.length;M+=1)C=dn(C,I[M]);return{c(){e=un("input"),i=qn(),r=un("input"),this.h()},l(M){e=cn(M,"INPUT",{class:!0,type:!0,step:!0,min:!0,max:!0}),i=Hn(M),r=cn(M,"INPUT",{class:!0,type:!0,step:!0,min:!0,max:!0}),this.h()},h(){Ki(e,x),Ki(r,C)},m(M,O){Tt(M,e,O),e.autofocus&&e.focus(),n[58](e),Um(e,n[1]),Tt(M,i,O),Tt(M,r,O),r.autofocus&&r.focus(),n[60](r),Um(r,n[2]),h||(s=[Vi(e,"change",n[59]),Vi(e,"input",n[59]),Vi(e,"blur",n[54]),Vi(e,"focus",n[55]),Vi(r,"change",n[61]),Vi(r,"input",n[61]),Vi(r,"blur",n[52]),Vi(r,"focus",n[53])],h=!0)},p(M,O){Ki(e,x=Gi(p,[O[0]&8192&&t!==(t=si({[M[13]]:!0,"mdc-slider__input":!0}))&&{class:t},{type:"range"},O[0]&32&&{disabled:M[5]},O[0]&512&&{step:M[9]},O[0]&1024&&{min:M[10]},O[0]&4&&{max:M[2]},O[0]&33554432&&M[25],O[1]&64&&sr(M[37],"input$")])),O[0]&2&&Um(e,M[1]),Ki(r,C=Gi(I,[O[0]&8192&&a!==(a=si({[M[13]]:!0,"mdc-slider__input":!0}))&&{class:a},{type:"range"},O[0]&32&&{disabled:M[5]},O[0]&512&&{step:M[9]},O[0]&2&&{min:M[1]},O[0]&2048&&{max:M[11]},M[33],O[0]&16777216&&M[24],O[1]&64&&sr(M[37],"input$")])),O[0]&4&&Um(r,M[2])},d(M){M&&Oe(e),n[58](null),M&&Oe(i),M&&Oe(r),n[60](null),h=!1,sa(s)}}}function F2(n){let e,t=n[31],i=[];for(let r=0;r<t.length;r+=1)i[r]=B2(k2(n,t,r));return{c(){e=un("div");for(let r=0;r<i.length;r+=1)i[r].c();this.h()},l(r){e=cn(r,"DIV",{class:!0});var a=_n(e);for(let h=0;h<i.length;h+=1)i[h].l(a);a.forEach(Oe),this.h()},h(){tn(e,"class","mdc-slider__tick-marks")},m(r,a){Tt(r,e,a);for(let h=0;h<i.length;h+=1)i[h]&&i[h].m(e,null)},p(r,a){if(a[1]&1){t=r[31];let h;for(h=0;h<t.length;h+=1){const s=k2(r,t,h);i[h]?i[h].p(s,a):(i[h]=B2(s),i[h].c(),i[h].m(e,null))}for(;h<i.length;h+=1)i[h].d(1);i.length=t.length}},d(r){r&&Oe(e),U1(i,r)}}}function B2(n){let e,t;return{c(){e=un("div"),this.h()},l(i){e=cn(i,"DIV",{class:!0}),_n(e).forEach(Oe),this.h()},h(){tn(e,"class",t=n[92]===uf.ACTIVE?"mdc-slider__tick-mark--active":"mdc-slider__tick-mark--inactive")},m(i,r){Tt(i,e,r)},p(i,r){r[1]&1&&t!==(t=i[92]===uf.ACTIVE?"mdc-slider__tick-mark--active":"mdc-slider__tick-mark--inactive")&&tn(e,"class",t)},d(i){i&&Oe(e)}}}function _4(n){let e,t,i,r,a,h,s,p,x=n[7]&&z2(n);return{c(){e=un("div"),x&&x.c(),t=qn(),i=un("div"),this.h()},l(I){e=cn(I,"DIV",{class:!0,style:!0});var C=_n(e);x&&x.l(C),t=Hn(C),i=cn(C,"DIV",{class:!0}),_n(i).forEach(Oe),C.forEach(Oe),this.h()},h(){tn(i,"class","mdc-slider__thumb-knob"),tn(e,"class",r=si({"mdc-slider__thumb":!0,...n[23]})),tn(e,"style",a=Object.entries(n[27]).map(H2).join(" "))},m(I,C){Tt(I,e,C),x&&x.m(e,null),an(e,t),an(e,i),n[74](i),n[75](e),s||(p=tr(h=ff.call(null,e,{unbounded:!0,disabled:n[5],active:n[29],eventTarget:n[15],activeTarget:n[15],addClass:n[76],removeClass:n[77],addStyle:n[78]})),s=!0)},p(I,C){I[7]?x?x.p(I,C):(x=z2(I),x.c(),x.m(e,t)):x&&(x.d(1),x=null),C[0]&8388608&&r!==(r=si({"mdc-slider__thumb":!0,...I[23]}))&&tn(e,"class",r),C[0]&134217728&&a!==(a=Object.entries(I[27]).map(H2).join(" "))&&tn(e,"style",a),h&&as(h.update)&&C[0]&536903712&&h.update.call(null,{unbounded:!0,disabled:I[5],active:I[29],eventTarget:I[15],activeTarget:I[15],addClass:I[76],removeClass:I[77],addStyle:I[78]})},d(I){I&&Oe(e),x&&x.d(),n[74](null),n[75](null),s=!1,p()}}}function y4(n){let e,t,i,r,a,h,s,p,x,I,C,M,O,k,z,G=n[7]&&U2(n),q=n[7]&&V2(n);return{c(){e=un("div"),G&&G.c(),t=qn(),i=un("div"),s=qn(),p=un("div"),q&&q.c(),x=qn(),I=un("div"),this.h()},l(Z){e=cn(Z,"DIV",{class:!0,style:!0});var K=_n(e);G&&G.l(K),t=Hn(K),i=cn(K,"DIV",{class:!0}),_n(i).forEach(Oe),K.forEach(Oe),s=Hn(Z),p=cn(Z,"DIV",{class:!0,style:!0});var te=_n(p);q&&q.l(te),x=Hn(te),I=cn(te,"DIV",{class:!0}),_n(I).forEach(Oe),te.forEach(Oe),this.h()},h(){tn(i,"class","mdc-slider__thumb-knob"),tn(e,"class",r=si({"mdc-slider__thumb":!0,...n[22]})),tn(e,"style",a=Object.entries(n[28]).map(j2).join(" ")),tn(I,"class","mdc-slider__thumb-knob"),tn(p,"class",C=si({"mdc-slider__thumb":!0,...n[23]})),tn(p,"style",M=Object.entries(n[27]).map(q2).join(" "))},m(Z,K){Tt(Z,e,K),G&&G.m(e,null),an(e,t),an(e,i),n[64](i),n[65](e),Tt(Z,s,K),Tt(Z,p,K),q&&q.m(p,null),an(p,x),an(p,I),n[69](I),n[70](p),k||(z=[tr(h=ff.call(null,e,{unbounded:!0,disabled:n[5],active:n[30],eventTarget:n[16],activeTarget:n[16],addClass:n[66],removeClass:n[67],addStyle:n[68]})),tr(O=ff.call(null,p,{unbounded:!0,disabled:n[5],active:n[29],eventTarget:n[15],activeTarget:n[15],addClass:n[71],removeClass:n[72],addStyle:n[73]}))],k=!0)},p(Z,K){Z[7]?G?G.p(Z,K):(G=U2(Z),G.c(),G.m(e,t)):G&&(G.d(1),G=null),K[0]&4194304&&r!==(r=si({"mdc-slider__thumb":!0,...Z[22]}))&&tn(e,"class",r),K[0]&268435456&&a!==(a=Object.entries(Z[28]).map(j2).join(" "))&&tn(e,"style",a),h&&as(h.update)&&K[0]&1073807392&&h.update.call(null,{unbounded:!0,disabled:Z[5],active:Z[30],eventTarget:Z[16],activeTarget:Z[16],addClass:Z[66],removeClass:Z[67],addStyle:Z[68]}),Z[7]?q?q.p(Z,K):(q=V2(Z),q.c(),q.m(p,x)):q&&(q.d(1),q=null),K[0]&8388608&&C!==(C=si({"mdc-slider__thumb":!0,...Z[23]}))&&tn(p,"class",C),K[0]&134217728&&M!==(M=Object.entries(Z[27]).map(q2).join(" "))&&tn(p,"style",M),O&&as(O.update)&&K[0]&536903712&&O.update.call(null,{unbounded:!0,disabled:Z[5],active:Z[29],eventTarget:Z[15],activeTarget:Z[15],addClass:Z[71],removeClass:Z[72],addStyle:Z[73]})},d(Z){Z&&Oe(e),G&&G.d(),n[64](null),n[65](null),Z&&Oe(s),Z&&Oe(p),q&&q.d(),n[69](null),n[70](null),k=!1,sa(z)}}}function z2(n){let e,t,i,r;return{c(){e=un("div"),t=un("div"),i=un("span"),r=_r(n[0]),this.h()},l(a){e=cn(a,"DIV",{class:!0,"aria-hidden":!0});var h=_n(e);t=cn(h,"DIV",{class:!0});var s=_n(t);i=cn(s,"SPAN",{class:!0});var p=_n(i);r=yr(p,n[0]),p.forEach(Oe),s.forEach(Oe),h.forEach(Oe),this.h()},h(){tn(i,"class","mdc-slider__value-indicator-text"),tn(t,"class","mdc-slider__value-indicator"),tn(e,"class","mdc-slider__value-indicator-container"),tn(e,"aria-hidden","true")},m(a,h){Tt(a,e,h),an(e,t),an(t,i),an(i,r)},p(a,h){h[0]&1&&Ao(r,a[0])},d(a){a&&Oe(e)}}}function U2(n){let e,t,i,r;return{c(){e=un("div"),t=un("div"),i=un("span"),r=_r(n[1]),this.h()},l(a){e=cn(a,"DIV",{class:!0,"aria-hidden":!0});var h=_n(e);t=cn(h,"DIV",{class:!0});var s=_n(t);i=cn(s,"SPAN",{class:!0});var p=_n(i);r=yr(p,n[1]),p.forEach(Oe),s.forEach(Oe),h.forEach(Oe),this.h()},h(){tn(i,"class","mdc-slider__value-indicator-text"),tn(t,"class","mdc-slider__value-indicator"),tn(e,"class","mdc-slider__value-indicator-container"),tn(e,"aria-hidden","true")},m(a,h){Tt(a,e,h),an(e,t),an(t,i),an(i,r)},p(a,h){h[0]&2&&Ao(r,a[1])},d(a){a&&Oe(e)}}}function V2(n){let e,t,i,r;return{c(){e=un("div"),t=un("div"),i=un("span"),r=_r(n[2]),this.h()},l(a){e=cn(a,"DIV",{class:!0,"aria-hidden":!0});var h=_n(e);t=cn(h,"DIV",{class:!0});var s=_n(t);i=cn(s,"SPAN",{class:!0});var p=_n(i);r=yr(p,n[2]),p.forEach(Oe),s.forEach(Oe),h.forEach(Oe),this.h()},h(){tn(i,"class","mdc-slider__value-indicator-text"),tn(t,"class","mdc-slider__value-indicator"),tn(e,"class","mdc-slider__value-indicator-container"),tn(e,"aria-hidden","true")},m(a,h){Tt(a,e,h),an(e,t),an(t,i),an(i,r)},p(a,h){h[0]&4&&Ao(r,a[2])},d(a){a&&Oe(e)}}}function v4(n){let e,t,i,r,a,h,s,p,x,I,C,M,O,k;function z(fe,Fe){return fe[6]?g4:m4}let G=z(n),q=G(n),Z=n[7]&&n[8]&&n[9]>0&&F2(n);function K(fe,Fe){return fe[6]?y4:_4}let te=K(n),ie=te(n),Te=[{class:C=Object.entries({[n[4]]:!0,"mdc-slider":!0,"mdc-slider--range":n[6],"mdc-slider--discrete":n[7],"mdc-slider--tick-marks":n[7]&&n[8],"mdc-slider--disabled":n[5],...n[21]}).filter(W2).map(X2).join(" ")},n[6]?{"data-min-range":`${n[12]}`}:{},ep(n[37],["input$"])],le={};for(let fe=0;fe<Te.length;fe+=1)le=dn(le,Te[fe]);return{c(){e=un("div"),q.c(),t=qn(),i=un("div"),r=un("div"),a=qn(),h=un("div"),s=un("div"),x=qn(),Z&&Z.c(),I=qn(),ie.c(),this.h()},l(fe){e=cn(fe,"DIV",{class:!0});var Fe=_n(e);q.l(Fe),t=Hn(Fe),i=cn(Fe,"DIV",{class:!0});var Ne=_n(i);r=cn(Ne,"DIV",{class:!0}),_n(r).forEach(Oe),a=Hn(Ne),h=cn(Ne,"DIV",{class:!0});var Ue=_n(h);s=cn(Ue,"DIV",{class:!0,style:!0}),_n(s).forEach(Oe),Ue.forEach(Oe),x=Hn(Ne),Z&&Z.l(Ne),Ne.forEach(Oe),I=Hn(Fe),ie.l(Fe),Fe.forEach(Oe),this.h()},h(){tn(r,"class","mdc-slider__track--inactive"),tn(s,"class","mdc-slider__track--active_fill"),tn(s,"style",p=Object.entries(n[26]).map(G2).join(" ")),tn(h,"class","mdc-slider__track--active"),tn(i,"class","mdc-slider__track"),Ki(e,le)},m(fe,Fe){Tt(fe,e,Fe),q.m(e,null),an(e,t),an(e,i),an(i,r),an(i,a),an(i,h),an(h,s),an(i,x),Z&&Z.m(i,null),an(e,I),ie.m(e,null),n[79](e),O||(k=[tr(M=ra.call(null,e,n[3])),tr(n[32].call(null,e))],O=!0)},p(fe,Fe){G===(G=z(fe))&&q?q.p(fe,Fe):(q.d(1),q=G(fe),q&&(q.c(),q.m(e,t))),Fe[0]&67108864&&p!==(p=Object.entries(fe[26]).map(G2).join(" "))&&tn(s,"style",p),fe[7]&&fe[8]&&fe[9]>0?Z?Z.p(fe,Fe):(Z=F2(fe),Z.c(),Z.m(i,null)):Z&&(Z.d(1),Z=null),te===(te=K(fe))&&ie?ie.p(fe,Fe):(ie.d(1),ie=te(fe),ie&&(ie.c(),ie.m(e,null))),Ki(e,le=Gi(Te,[Fe[0]&2097648&&C!==(C=Object.entries({[fe[4]]:!0,"mdc-slider":!0,"mdc-slider--range":fe[6],"mdc-slider--discrete":fe[7],"mdc-slider--tick-marks":fe[7]&&fe[8],"mdc-slider--disabled":fe[5],...fe[21]}).filter(W2).map(X2).join(" "))&&{class:C},Fe[0]&4160&&(fe[6]?{"data-min-range":`${fe[12]}`}:{}),Fe[1]&64&&ep(fe[37],["input$"])])),M&&as(M.update)&&Fe[0]&8&&M.update.call(null,fe[3])},i:za,o:za,d(fe){fe&&Oe(e),q.d(),Z&&Z.d(),ie.d(),n[79](null),O=!1,sa(k)}}}const G2=([n,e])=>`${n}: ${e};`,j2=([n,e])=>`${n}: ${e};`,q2=([n,e])=>`${n}: ${e};`,H2=([n,e])=>`${n}: ${e};`,W2=([n,e])=>n!==""&&e,X2=([n])=>n;function x4(n,e,t){const i=["use","class","disabled","range","discrete","tickMarks","step","min","max","minRange","value","start","end","valueToAriaValueTextFn","hideFocusStylesForPointerEvents","input$class","layout","getId","getElement"];let r=Ji(e,i);var a;const h=Uo(zo());let{use:s=[]}=e,{class:p=""}=e,{disabled:x=!1}=e,{range:I=!1}=e,{discrete:C=!1}=e,{tickMarks:M=!1}=e,{step:O=1}=e,{min:k=0}=e,{max:z=100}=e,{minRange:G=0}=e,{value:q=void 0}=e,{start:Z=void 0}=e,{end:K=void 0}=e,{valueToAriaValueTextFn:te=ue=>`${ue}`}=e,{hideFocusStylesForPointerEvents:ie=!1}=e,{input$class:Te=""}=e,le,fe,Fe,Ne,Ue,dt,Ge,Le,nt={},zt={},Ot={},et={},Ze={},At={},Kt={},sn={},zn=!1,ri=!1,Yt,ii=(a=Ws("SMUI:generic:input:props"))!==null&&a!==void 0?a:{},kn=Ws("SMUI:addLayoutListener"),on,Di=k,Ut=z,Nt=O,Gn=C,Ci=M;if(M&&O>0){const ue=z+Math.abs(k);if(I&&typeof Z=="number"&&typeof K=="number"){const Ye=Z+Math.abs(k),ge=K+Math.abs(k);Yt=[...Array(Ye/O).map(()=>uf.INACTIVE),...Array(ue/O-Ye/O-(ue-ge)/O+1).map(()=>uf.ACTIVE),...Array((ue-ge)/O).map(()=>uf.INACTIVE)]}else if(typeof q=="number"){const Ye=q+Math.abs(k);Yt=[...Array(Ye/O+1).map(()=>uf.ACTIVE),...Array((ue-Ye)/O).map(()=>uf.INACTIVE)]}}if(I&&typeof Z=="number"&&typeof K=="number"){const ue=(K-Z)/(z-k),Ye=Z/(z-k),ge=K/(z-k);At.transform=`scaleX(${ue})`,Kt.left=`calc(${ge*100}% -24px)`,sn.left=`calc(${Ye*100}% -24px)`}else if(typeof q=="number"){const ue=q/(z-k);At.transform=`scaleX(${ue})`,Kt.left=`calc(${ue*100}% -24px)`}kn&&(on=kn(Rs));let ln=q,Mt=Z,Un=K;Ll(()=>{t(43,fe=new d4({hasClass:ti,addClass:jr,removeClass:Yr,addThumbClass:hi,removeThumbClass:Hi,getAttribute:Ye=>mn().getAttribute(Ye),getInputValue:Ye=>{var ge;return`${(ge=I?Ye===Dt.START?Z:K:q)!==null&&ge!==void 0?ge:0}`},setInputValue:(Ye,ge)=>{I?ge===Dt.START?(t(1,Z=Number(Ye)),t(50,Mt=Z)):(t(2,K=Number(Ye)),t(51,Un=K)):(t(0,q=Number(Ye)),t(49,ln=q))},getInputAttribute:Tn,setInputAttribute:fi,removeInputAttribute:Kn,focusInput:Ye=>{I&&Ye===Dt.START&&Ne?Ne.focus():Fe.focus()},isInputFocused:Ye=>(I&&Ye===Dt.START?Ne:Fe)===document.activeElement,shouldHideFocusStylesForPointerEvents:()=>ie,getThumbKnobWidth:Ye=>{var ge;return((ge=I&&Ye===Dt.START?Le:Ge)!==null&&ge!==void 0?ge:Ge).getBoundingClientRect().width},getThumbBoundingClientRect:Ye=>{var ge;return((ge=I&&Ye===Dt.START?dt:Ue)!==null&&ge!==void 0?ge:Ue).getBoundingClientRect()},getBoundingClientRect:()=>mn().getBoundingClientRect(),getValueIndicatorContainerWidth:Ye=>{var ge;return((ge=I&&Ye===Dt.START?dt:Ue)!==null&&ge!==void 0?ge:Ue).querySelector(".mdc-slider__value-indicator-container").getBoundingClientRect().width},isRTL:()=>getComputedStyle(mn()).direction==="rtl",setThumbStyleProperty:or,removeThumbStyleProperty:$e,setTrackActiveStyleProperty:pn,removeTrackActiveStyleProperty:vi,setValueIndicatorText:(Ye,ge)=>{},getValueToAriaValueTextFn:()=>te,updateTickMarks:Ye=>{t(31,Yt=Ye)},setPointerCapture:Ye=>{mn().setPointerCapture(Ye)},emitChangeEvent:(Ye,ge)=>{vs(mn(),"SMUISlider:change",{value:Ye,thumb:ge},void 0,!0)},emitInputEvent:(Ye,ge)=>{vs(mn(),"SMUISlider:input",{value:Ye,thumb:ge},void 0,!0)},emitDragStartEvent:(Ye,ge)=>{I&&ge===Dt.START?t(30,ri=!0):t(29,zn=!0)},emitDragEndEvent:(Ye,ge)=>{I&&ge===Dt.START?t(30,ri=!1):t(29,zn=!1)},registerEventHandler:(Ye,ge)=>{mn().addEventListener(Ye,ge)},deregisterEventHandler:(Ye,ge)=>{mn().removeEventListener(Ye,ge)},registerThumbEventHandler:(Ye,ge,It)=>{var vn;(vn=I&&Ye===Dt.START?dt:Ue)===null||vn===void 0||vn.addEventListener(ge,It)},deregisterThumbEventHandler:(Ye,ge,It)=>{var vn;(vn=I&&Ye===Dt.START?dt:Ue)===null||vn===void 0||vn.removeEventListener(ge,It)},registerInputEventHandler:(Ye,ge,It)=>{var vn;(vn=I&&Ye===Dt.START?Ne:Fe)===null||vn===void 0||vn.addEventListener(ge,It)},deregisterInputEventHandler:(Ye,ge,It)=>{var vn;(vn=I&&Ye===Dt.START?Ne:Fe)===null||vn===void 0||vn.removeEventListener(ge,It)},registerBodyEventHandler:(Ye,ge)=>{document.body.addEventListener(Ye,ge)},deregisterBodyEventHandler:(Ye,ge)=>{document.body.removeEventListener(Ye,ge)},registerWindowEventHandler:(Ye,ge)=>{window.addEventListener(Ye,ge)},deregisterWindowEventHandler:(Ye,ge)=>{window.removeEventListener(Ye,ge)}}));const ue={get element(){return mn()},activateRipple(){x||t(29,zn=!0)},deactivateRipple(){t(29,zn=!1)}};return vs(le,"SMUIGenericInput:mount",ue),fe.init(),fe.layout({skipUpdateUI:!0}),()=>{vs(le,"SMUIGenericInput:unmount",ue),fe.destroy()}}),pd(()=>{on&&on()});function ti(ue){return ue in nt?nt[ue]:mn().classList.contains(ue)}function jr(ue){nt[ue]||t(21,nt[ue]=!0,nt)}function Yr(ue){(!(ue in nt)||nt[ue])&&t(21,nt[ue]=!1,nt)}function hi(ue,Ye){I&&Ye===Dt.START?zt[ue]||t(22,zt[ue]=!0,zt):Ot[ue]||t(23,Ot[ue]=!0,Ot)}function Hi(ue,Ye){I&&Ye===Dt.START?(!(ue in zt)||zt[ue])&&t(22,zt[ue]=!1,zt):(!(ue in Ot)||Ot[ue])&&t(23,Ot[ue]=!1,Ot)}function or(ue,Ye,ge){I&&ge===Dt.START?sn[ue]!=Ye&&(Ye===""||Ye==null?(delete sn[ue],t(28,sn)):t(28,sn[ue]=Ye,sn)):Kt[ue]!=Ye&&(Ye===""||Ye==null?(delete Kt[ue],t(27,Kt)):t(27,Kt[ue]=Ye,Kt))}function $e(ue,Ye){I&&Ye===Dt.START?ue in sn&&(delete sn[ue],t(28,sn)):ue in Kt&&(delete Kt[ue],t(27,Kt))}function Tn(ue,Ye){var ge,It,vn;return I&&Ye===Dt.START?ue==="value"?`${Z}`:ue in Ze?(ge=Ze[ue])!==null&&ge!==void 0?ge:null:(It=Ne==null?void 0:Ne.getAttribute(ue))!==null&&It!==void 0?It:null:ue==="value"?`${I?K:q}`:ue in et?(vn=et[ue])!==null&&vn!==void 0?vn:null:Fe.getAttribute(ue)}function fi(ue,Ye,ge){I&&ge===Dt.START?Ze[ue]!==Ye&&t(25,Ze[ue]=Ye,Ze):et[ue]!==Ye&&t(24,et[ue]=Ye,et)}function Kn(ue,Ye){I&&Ye===Dt.START?(!(ue in Ze)||Ze[ue]!=null)&&t(25,Ze[ue]=void 0,Ze):(!(ue in et)||et[ue]!=null)&&t(24,et[ue]=void 0,et)}function pn(ue,Ye){At[ue]!=Ye&&(Ye===""||Ye==null?(delete At[ue],t(26,At)):t(26,At[ue]=Ye,At))}function vi(ue){ue in At&&(delete At[ue],t(26,At))}function Rs(){return fe.layout()}function kt(){return ii&&ii.id}function mn(){return le}function jn(ue){Zl.call(this,n,ue)}function ki(ue){Zl.call(this,n,ue)}function Ds(ue){Zl.call(this,n,ue)}function io(ue){Zl.call(this,n,ue)}function oa(ue){Zl.call(this,n,ue)}function Vo(ue){Zl.call(this,n,ue)}function Os(ue){$n[ue?"unshift":"push"](()=>{Ne=ue,t(16,Ne)})}function Mo(){Z=KI(this.value),t(1,Z)}function qa(ue){$n[ue?"unshift":"push"](()=>{Fe=ue,t(15,Fe)})}function ro(){K=KI(this.value),t(2,K)}function Ia(ue){$n[ue?"unshift":"push"](()=>{Fe=ue,t(15,Fe)})}function Rl(){q=KI(this.value),t(0,q)}function Ha(ue){$n[ue?"unshift":"push"](()=>{Le=ue,t(20,Le)})}function aa(ue){$n[ue?"unshift":"push"](()=>{dt=ue,t(18,dt)})}const Wa=ue=>hi(ue,Dt.START),Bs=ue=>Hi(ue,Dt.START),Ta=(ue,Ye)=>or(ue,Ye,Dt.START);function Zs(ue){$n[ue?"unshift":"push"](()=>{Ge=ue,t(19,Ge)})}function Sa(ue){$n[ue?"unshift":"push"](()=>{Ue=ue,t(17,Ue)})}const xe=ue=>hi(ue,Dt.END),Q=ue=>Hi(ue,Dt.END),ne=(ue,Ye)=>or(ue,Ye,Dt.END);function ve(ue){$n[ue?"unshift":"push"](()=>{Ge=ue,t(19,Ge)})}function Ce(ue){$n[ue?"unshift":"push"](()=>{Ue=ue,t(17,Ue)})}const Be=ue=>hi(ue,Dt.END),st=ue=>Hi(ue,Dt.END),tt=(ue,Ye)=>or(ue,Ye,Dt.END);function He(ue){$n[ue?"unshift":"push"](()=>{le=ue,t(14,le)})}return n.$$set=ue=>{e=dn(dn({},e),So(ue)),t(37,r=Ji(e,i)),"use"in ue&&t(3,s=ue.use),"class"in ue&&t(4,p=ue.class),"disabled"in ue&&t(5,x=ue.disabled),"range"in ue&&t(6,I=ue.range),"discrete"in ue&&t(7,C=ue.discrete),"tickMarks"in ue&&t(8,M=ue.tickMarks),"step"in ue&&t(9,O=ue.step),"min"in ue&&t(10,k=ue.min),"max"in ue&&t(11,z=ue.max),"minRange"in ue&&t(12,G=ue.minRange),"value"in ue&&t(0,q=ue.value),"start"in ue&&t(1,Z=ue.start),"end"in ue&&t(2,K=ue.end),"valueToAriaValueTextFn"in ue&&t(38,te=ue.valueToAriaValueTextFn),"hideFocusStylesForPointerEvents"in ue&&t(39,ie=ue.hideFocusStylesForPointerEvents),"input$class"in ue&&t(13,Te=ue.input$class)},n.$$.update=()=>{n.$$.dirty[0]&1024|n.$$.dirty[1]&12288&&k!==Di&&(fe&&fe.setMin(k),t(44,Di=k)),n.$$.dirty[0]&2048|n.$$.dirty[1]&20480&&z!==Ut&&(fe&&fe.setMax(z),t(45,Ut=z)),n.$$.dirty[0]&512|n.$$.dirty[1]&36864&&O!==Nt&&(fe&&fe.setStep(O),t(46,Nt=O)),n.$$.dirty[0]&128|n.$$.dirty[1]&69632&&C!==Gn&&(fe&&fe.setIsDiscrete(C),t(47,Gn=C)),n.$$.dirty[0]&256|n.$$.dirty[1]&135168&&M!==Ci&&(fe&&fe.setHasTickMarks(M),t(48,Ci=M)),n.$$.dirty[0]&7|n.$$.dirty[1]&1839104&&fe&&(ln!==q&&typeof q=="number"&&fe.setValue(q),Mt!==Z&&typeof Z=="number"&&fe.setValueStart(Z),Un!==K&&typeof K=="number"&&fe.setValue(K),t(49,ln=q),t(50,Mt=Z),t(51,Un=K),fe.layout())},[q,Z,K,s,p,x,I,C,M,O,k,z,G,Te,le,Fe,Ne,Ue,dt,Ge,Le,nt,zt,Ot,et,Ze,At,Kt,sn,zn,ri,Yt,h,ii,hi,Hi,or,r,te,ie,Rs,kt,mn,fe,Di,Ut,Nt,Gn,Ci,ln,Mt,Un,jn,ki,Ds,io,oa,Vo,Os,Mo,qa,ro,Ia,Rl,Ha,aa,Wa,Bs,Ta,Zs,Sa,xe,Q,ne,ve,Ce,Be,st,tt,He]}class jL extends Fr{constructor(e){super(),Br(this,e,x4,v4,Lr,{use:3,class:4,disabled:5,range:6,discrete:7,tickMarks:8,step:9,min:10,max:11,minRange:12,value:0,start:1,end:2,valueToAriaValueTextFn:38,hideFocusStylesForPointerEvents:39,input$class:13,layout:40,getId:41,getElement:42},null,[-1,-1,-1,-1])}get layout(){return this.$$.ctx[40]}get getId(){return this.$$.ctx[41]}get getElement(){return this.$$.ctx[42]}}/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var b4={LABEL_FLOAT_ABOVE:"mdc-floating-label--float-above",LABEL_REQUIRED:"mdc-floating-label--required",LABEL_SHAKE:"mdc-floating-label--shake",ROOT:"mdc-floating-label"};/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var E4=function(n){Eh(e,n);function e(t){var i=n.call(this,ks(ks({},e.defaultAdapter),t))||this;return i.shakeAnimationEndHandler=function(){i.handleShakeAnimationEnd()},i}return Object.defineProperty(e,"cssClasses",{get:function(){return b4},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},getWidth:function(){return 0},registerInteractionHandler:function(){},deregisterInteractionHandler:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){this.adapter.registerInteractionHandler("animationend",this.shakeAnimationEndHandler)},e.prototype.destroy=function(){this.adapter.deregisterInteractionHandler("animationend",this.shakeAnimationEndHandler)},e.prototype.getWidth=function(){return this.adapter.getWidth()},e.prototype.shake=function(t){var i=e.cssClasses.LABEL_SHAKE;t?this.adapter.addClass(i):this.adapter.removeClass(i)},e.prototype.float=function(t){var i=e.cssClasses,r=i.LABEL_FLOAT_ABOVE,a=i.LABEL_SHAKE;t?this.adapter.addClass(r):(this.adapter.removeClass(r),this.adapter.removeClass(a))},e.prototype.setRequired=function(t){var i=e.cssClasses.LABEL_REQUIRED;t?this.adapter.addClass(i):this.adapter.removeClass(i)},e.prototype.handleShakeAnimationEnd=function(){var t=e.cssClasses.LABEL_SHAKE;this.adapter.removeClass(t)},e}(wh);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var i_={LINE_RIPPLE_ACTIVE:"mdc-line-ripple--active",LINE_RIPPLE_DEACTIVATING:"mdc-line-ripple--deactivating"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var w4=function(n){Eh(e,n);function e(t){var i=n.call(this,ks(ks({},e.defaultAdapter),t))||this;return i.transitionEndHandler=function(r){i.handleTransitionEnd(r)},i}return Object.defineProperty(e,"cssClasses",{get:function(){return i_},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setStyle:function(){},registerEventHandler:function(){},deregisterEventHandler:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){this.adapter.registerEventHandler("transitionend",this.transitionEndHandler)},e.prototype.destroy=function(){this.adapter.deregisterEventHandler("transitionend",this.transitionEndHandler)},e.prototype.activate=function(){this.adapter.removeClass(i_.LINE_RIPPLE_DEACTIVATING),this.adapter.addClass(i_.LINE_RIPPLE_ACTIVE)},e.prototype.setRippleCenter=function(t){this.adapter.setStyle("transform-origin",t+"px center")},e.prototype.deactivate=function(){this.adapter.addClass(i_.LINE_RIPPLE_DEACTIVATING)},e.prototype.handleTransitionEnd=function(t){var i=this.adapter.hasClass(i_.LINE_RIPPLE_DEACTIVATING);t.propertyName==="opacity"&&i&&(this.adapter.removeClass(i_.LINE_RIPPLE_ACTIVE),this.adapter.removeClass(i_.LINE_RIPPLE_DEACTIVATING))},e}(wh);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var I4={NOTCH_ELEMENT_SELECTOR:".mdc-notched-outline__notch"},Z2={NOTCH_ELEMENT_PADDING:8},T4={NO_LABEL:"mdc-notched-outline--no-label",OUTLINE_NOTCHED:"mdc-notched-outline--notched",OUTLINE_UPGRADED:"mdc-notched-outline--upgraded"};/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var S4=function(n){Eh(e,n);function e(t){return n.call(this,ks(ks({},e.defaultAdapter),t))||this}return Object.defineProperty(e,"strings",{get:function(){return I4},enumerable:!1,configurable:!0}),Object.defineProperty(e,"cssClasses",{get:function(){return T4},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return Z2},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},setNotchWidthProperty:function(){},removeNotchWidthProperty:function(){}}},enumerable:!1,configurable:!0}),e.prototype.notch=function(t){var i=e.cssClasses.OUTLINE_NOTCHED;t>0&&(t+=Z2.NOTCH_ELEMENT_PADDING),this.adapter.setNotchWidthProperty(t),this.adapter.addClass(i)},e.prototype.closeNotch=function(){var t=e.cssClasses.OUTLINE_NOTCHED;this.adapter.removeClass(t),this.adapter.removeNotchWidthProperty()},e}(wh);/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var mT={ARIA_CONTROLS:"aria-controls",ARIA_DESCRIBEDBY:"aria-describedby",INPUT_SELECTOR:".mdc-text-field__input",LABEL_SELECTOR:".mdc-floating-label",LEADING_ICON_SELECTOR:".mdc-text-field__icon--leading",LINE_RIPPLE_SELECTOR:".mdc-line-ripple",OUTLINE_SELECTOR:".mdc-notched-outline",PREFIX_SELECTOR:".mdc-text-field__affix--prefix",SUFFIX_SELECTOR:".mdc-text-field__affix--suffix",TRAILING_ICON_SELECTOR:".mdc-text-field__icon--trailing"},C4={DISABLED:"mdc-text-field--disabled",FOCUSED:"mdc-text-field--focused",HELPER_LINE:"mdc-text-field-helper-line",INVALID:"mdc-text-field--invalid",LABEL_FLOATING:"mdc-text-field--label-floating",NO_LABEL:"mdc-text-field--no-label",OUTLINED:"mdc-text-field--outlined",ROOT:"mdc-text-field",TEXTAREA:"mdc-text-field--textarea",WITH_LEADING_ICON:"mdc-text-field--with-leading-icon",WITH_TRAILING_ICON:"mdc-text-field--with-trailing-icon",WITH_INTERNAL_COUNTER:"mdc-text-field--with-internal-counter"},Y2={LABEL_SCALE:.75},A4=["pattern","min","max","required","step","minlength","maxlength"],M4=["color","date","datetime-local","month","range","time","week"];/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var K2=["mousedown","touchstart"],J2=["click","keydown"],L4=function(n){Eh(e,n);function e(t,i){i===void 0&&(i={});var r=n.call(this,ks(ks({},e.defaultAdapter),t))||this;return r.isFocused=!1,r.receivedUserInput=!1,r.valid=!0,r.useNativeValidation=!0,r.validateOnValueChange=!0,r.helperText=i.helperText,r.characterCounter=i.characterCounter,r.leadingIcon=i.leadingIcon,r.trailingIcon=i.trailingIcon,r.inputFocusHandler=function(){r.activateFocus()},r.inputBlurHandler=function(){r.deactivateFocus()},r.inputInputHandler=function(){r.handleInput()},r.setPointerXOffset=function(a){r.setTransformOrigin(a)},r.textFieldInteractionHandler=function(){r.handleTextFieldInteraction()},r.validationAttributeChangeHandler=function(a){r.handleValidationAttributeChange(a)},r}return Object.defineProperty(e,"cssClasses",{get:function(){return C4},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return mT},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return Y2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shouldAlwaysFloat",{get:function(){var t=this.getNativeInput().type;return M4.indexOf(t)>=0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shouldFloat",{get:function(){return this.shouldAlwaysFloat||this.isFocused||!!this.getValue()||this.isBadInput()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shouldShake",{get:function(){return!this.isFocused&&!this.isValid()&&!!this.getValue()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!0},setInputAttr:function(){},removeInputAttr:function(){},registerTextFieldInteractionHandler:function(){},deregisterTextFieldInteractionHandler:function(){},registerInputInteractionHandler:function(){},deregisterInputInteractionHandler:function(){},registerValidationAttributeChangeHandler:function(){return new MutationObserver(function(){})},deregisterValidationAttributeChangeHandler:function(){},getNativeInput:function(){return null},isFocused:function(){return!1},activateLineRipple:function(){},deactivateLineRipple:function(){},setLineRippleTransformOrigin:function(){},shakeLabel:function(){},floatLabel:function(){},setLabelRequired:function(){},hasLabel:function(){return!1},getLabelWidth:function(){return 0},hasOutline:function(){return!1},notchOutline:function(){},closeOutline:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){var t,i,r,a;this.adapter.hasLabel()&&this.getNativeInput().required&&this.adapter.setLabelRequired(!0),this.adapter.isFocused()?this.inputFocusHandler():this.adapter.hasLabel()&&this.shouldFloat&&(this.notchOutline(!0),this.adapter.floatLabel(!0),this.styleFloating(!0)),this.adapter.registerInputInteractionHandler("focus",this.inputFocusHandler),this.adapter.registerInputInteractionHandler("blur",this.inputBlurHandler),this.adapter.registerInputInteractionHandler("input",this.inputInputHandler);try{for(var h=Xl(K2),s=h.next();!s.done;s=h.next()){var p=s.value;this.adapter.registerInputInteractionHandler(p,this.setPointerXOffset)}}catch(C){t={error:C}}finally{try{s&&!s.done&&(i=h.return)&&i.call(h)}finally{if(t)throw t.error}}try{for(var x=Xl(J2),I=x.next();!I.done;I=x.next()){var p=I.value;this.adapter.registerTextFieldInteractionHandler(p,this.textFieldInteractionHandler)}}catch(C){r={error:C}}finally{try{I&&!I.done&&(a=x.return)&&a.call(x)}finally{if(r)throw r.error}}this.validationObserver=this.adapter.registerValidationAttributeChangeHandler(this.validationAttributeChangeHandler),this.setcharacterCounter(this.getValue().length)},e.prototype.destroy=function(){var t,i,r,a;this.adapter.deregisterInputInteractionHandler("focus",this.inputFocusHandler),this.adapter.deregisterInputInteractionHandler("blur",this.inputBlurHandler),this.adapter.deregisterInputInteractionHandler("input",this.inputInputHandler);try{for(var h=Xl(K2),s=h.next();!s.done;s=h.next()){var p=s.value;this.adapter.deregisterInputInteractionHandler(p,this.setPointerXOffset)}}catch(C){t={error:C}}finally{try{s&&!s.done&&(i=h.return)&&i.call(h)}finally{if(t)throw t.error}}try{for(var x=Xl(J2),I=x.next();!I.done;I=x.next()){var p=I.value;this.adapter.deregisterTextFieldInteractionHandler(p,this.textFieldInteractionHandler)}}catch(C){r={error:C}}finally{try{I&&!I.done&&(a=x.return)&&a.call(x)}finally{if(r)throw r.error}}this.adapter.deregisterValidationAttributeChangeHandler(this.validationObserver)},e.prototype.handleTextFieldInteraction=function(){var t=this.adapter.getNativeInput();t&&t.disabled||(this.receivedUserInput=!0)},e.prototype.handleValidationAttributeChange=function(t){var i=this;t.some(function(r){return A4.indexOf(r)>-1?(i.styleValidity(!0),i.adapter.setLabelRequired(i.getNativeInput().required),!0):!1}),t.indexOf("maxlength")>-1&&this.setcharacterCounter(this.getValue().length)},e.prototype.notchOutline=function(t){if(!(!this.adapter.hasOutline()||!this.adapter.hasLabel()))if(t){var i=this.adapter.getLabelWidth()*Y2.LABEL_SCALE;this.adapter.notchOutline(i)}else this.adapter.closeOutline()},e.prototype.activateFocus=function(){this.isFocused=!0,this.styleFocused(this.isFocused),this.adapter.activateLineRipple(),this.adapter.hasLabel()&&(this.notchOutline(this.shouldFloat),this.adapter.floatLabel(this.shouldFloat),this.styleFloating(this.shouldFloat),this.adapter.shakeLabel(this.shouldShake)),this.helperText&&(this.helperText.isPersistent()||!this.helperText.isValidation()||!this.valid)&&this.helperText.showToScreenReader()},e.prototype.setTransformOrigin=function(t){if(!(this.isDisabled()||this.adapter.hasOutline())){var i=t.touches,r=i?i[0]:t,a=r.target.getBoundingClientRect(),h=r.clientX-a.left;this.adapter.setLineRippleTransformOrigin(h)}},e.prototype.handleInput=function(){this.autoCompleteFocus(),this.setcharacterCounter(this.getValue().length)},e.prototype.autoCompleteFocus=function(){this.receivedUserInput||this.activateFocus()},e.prototype.deactivateFocus=function(){this.isFocused=!1,this.adapter.deactivateLineRipple();var t=this.isValid();this.styleValidity(t),this.styleFocused(this.isFocused),this.adapter.hasLabel()&&(this.notchOutline(this.shouldFloat),this.adapter.floatLabel(this.shouldFloat),this.styleFloating(this.shouldFloat),this.adapter.shakeLabel(this.shouldShake)),this.shouldFloat||(this.receivedUserInput=!1)},e.prototype.getValue=function(){return this.getNativeInput().value},e.prototype.setValue=function(t){if(this.getValue()!==t&&(this.getNativeInput().value=t),this.setcharacterCounter(t.length),this.validateOnValueChange){var i=this.isValid();this.styleValidity(i)}this.adapter.hasLabel()&&(this.notchOutline(this.shouldFloat),this.adapter.floatLabel(this.shouldFloat),this.styleFloating(this.shouldFloat),this.validateOnValueChange&&this.adapter.shakeLabel(this.shouldShake))},e.prototype.isValid=function(){return this.useNativeValidation?this.isNativeInputValid():this.valid},e.prototype.setValid=function(t){this.valid=t,this.styleValidity(t);var i=!t&&!this.isFocused&&!!this.getValue();this.adapter.hasLabel()&&this.adapter.shakeLabel(i)},e.prototype.setValidateOnValueChange=function(t){this.validateOnValueChange=t},e.prototype.getValidateOnValueChange=function(){return this.validateOnValueChange},e.prototype.setUseNativeValidation=function(t){this.useNativeValidation=t},e.prototype.isDisabled=function(){return this.getNativeInput().disabled},e.prototype.setDisabled=function(t){this.getNativeInput().disabled=t,this.styleDisabled(t)},e.prototype.setHelperTextContent=function(t){this.helperText&&this.helperText.setContent(t)},e.prototype.setLeadingIconAriaLabel=function(t){this.leadingIcon&&this.leadingIcon.setAriaLabel(t)},e.prototype.setLeadingIconContent=function(t){this.leadingIcon&&this.leadingIcon.setContent(t)},e.prototype.setTrailingIconAriaLabel=function(t){this.trailingIcon&&this.trailingIcon.setAriaLabel(t)},e.prototype.setTrailingIconContent=function(t){this.trailingIcon&&this.trailingIcon.setContent(t)},e.prototype.setcharacterCounter=function(t){if(this.characterCounter){var i=this.getNativeInput().maxLength;if(i===-1)throw new Error("MDCTextFieldFoundation: Expected maxlength html property on text input or textarea.");this.characterCounter.setCounterValue(t,i)}},e.prototype.isBadInput=function(){return this.getNativeInput().validity.badInput||!1},e.prototype.isNativeInputValid=function(){return this.getNativeInput().validity.valid},e.prototype.styleValidity=function(t){var i=e.cssClasses.INVALID;if(t?this.adapter.removeClass(i):this.adapter.addClass(i),this.helperText){this.helperText.setValidity(t);var r=this.helperText.isValidation();if(!r)return;var a=this.helperText.isVisible(),h=this.helperText.getId();a&&h?this.adapter.setInputAttr(mT.ARIA_DESCRIBEDBY,h):this.adapter.removeInputAttr(mT.ARIA_DESCRIBEDBY)}},e.prototype.styleFocused=function(t){var i=e.cssClasses.FOCUSED;t?this.adapter.addClass(i):this.adapter.removeClass(i)},e.prototype.styleDisabled=function(t){var i=e.cssClasses,r=i.DISABLED,a=i.INVALID;t?(this.adapter.addClass(r),this.adapter.removeClass(a)):this.adapter.removeClass(r),this.leadingIcon&&this.leadingIcon.setDisabled(t),this.trailingIcon&&this.trailingIcon.setDisabled(t)},e.prototype.styleFloating=function(t){var i=e.cssClasses.LABEL_FLOATING;t?this.adapter.addClass(i):this.adapter.removeClass(i)},e.prototype.getNativeInput=function(){var t=this.adapter?this.adapter.getNativeInput():null;return t||{disabled:!1,maxLength:-1,required:!1,type:"input",validity:{badInput:!1,valid:!0},value:""}},e}(wh);function P4(n){let e,t,i,r,a,h,s,p;const x=n[22].default,I=Sr(x,n,n[21],null);let C=[{class:t=si({[n[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":n[0],"mdc-floating-label--required":n[1],...n[8]})},{style:i=Object.entries(n[9]).map($2).concat([n[4]]).join(" ")},{for:r=n[5]||(n[11]?n[11].id:void 0)},n[12]],M={};for(let O=0;O<C.length;O+=1)M=dn(M,C[O]);return{c(){e=un("label"),I&&I.c(),this.h()},l(O){e=cn(O,"LABEL",{class:!0,style:!0,for:!0});var k=_n(e);I&&I.l(k),k.forEach(Oe),this.h()},h(){Ki(e,M)},m(O,k){Tt(O,e,k),I&&I.m(e,null),n[24](e),h=!0,s||(p=[tr(a=ra.call(null,e,n[2])),tr(n[10].call(null,e))],s=!0)},p(O,k){I&&I.p&&(!h||k&2097152)&&Cr(I,x,O,O[21],h?Mr(x,O[21],k,null):Ar(O[21]),null),Ki(e,M=Gi(C,[(!h||k&267&&t!==(t=si({[O[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":O[0],"mdc-floating-label--required":O[1],...O[8]})))&&{class:t},(!h||k&528&&i!==(i=Object.entries(O[9]).map($2).concat([O[4]]).join(" ")))&&{style:i},(!h||k&32&&r!==(r=O[5]||(O[11]?O[11].id:void 0)))&&{for:r},k&4096&&O[12]])),a&&as(a.update)&&k&4&&a.update.call(null,O[2])},i(O){h||(Ke(I,O),h=!0)},o(O){rt(I,O),h=!1},d(O){O&&Oe(e),I&&I.d(O),n[24](null),s=!1,sa(p)}}}function R4(n){let e,t,i,r,a,h,s;const p=n[22].default,x=Sr(p,n,n[21],null);let I=[{class:t=si({[n[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":n[0],"mdc-floating-label--required":n[1],...n[8]})},{style:i=Object.entries(n[9]).map(Q2).concat([n[4]]).join(" ")},n[12]],C={};for(let M=0;M<I.length;M+=1)C=dn(C,I[M]);return{c(){e=un("span"),x&&x.c(),this.h()},l(M){e=cn(M,"SPAN",{class:!0,style:!0});var O=_n(e);x&&x.l(O),O.forEach(Oe),this.h()},h(){Ki(e,C)},m(M,O){Tt(M,e,O),x&&x.m(e,null),n[23](e),a=!0,h||(s=[tr(r=ra.call(null,e,n[2])),tr(n[10].call(null,e))],h=!0)},p(M,O){x&&x.p&&(!a||O&2097152)&&Cr(x,p,M,M[21],a?Mr(p,M[21],O,null):Ar(M[21]),null),Ki(e,C=Gi(I,[(!a||O&267&&t!==(t=si({[M[3]]:!0,"mdc-floating-label":!0,"mdc-floating-label--float-above":M[0],"mdc-floating-label--required":M[1],...M[8]})))&&{class:t},(!a||O&528&&i!==(i=Object.entries(M[9]).map(Q2).concat([M[4]]).join(" ")))&&{style:i},O&4096&&M[12]])),r&&as(r.update)&&O&4&&r.update.call(null,M[2])},i(M){a||(Ke(x,M),a=!0)},o(M){rt(x,M),a=!1},d(M){M&&Oe(e),x&&x.d(M),n[23](null),h=!1,sa(s)}}}function D4(n){let e,t,i,r;const a=[R4,P4],h=[];function s(p,x){return p[6]?0:1}return e=s(n),t=h[e]=a[e](n),{c(){t.c(),i=Ei()},l(p){t.l(p),i=Ei()},m(p,x){h[e].m(p,x),Tt(p,i,x),r=!0},p(p,[x]){let I=e;e=s(p),e===I?h[e].p(p,x):(vr(),rt(h[I],1,1,()=>{h[I]=null}),xr(),t=h[e],t?t.p(p,x):(t=h[e]=a[e](p),t.c()),Ke(t,1),t.m(i.parentNode,i))},i(p){r||(Ke(t),r=!0)},o(p){rt(t),r=!1},d(p){h[e].d(p),p&&Oe(i)}}}const Q2=([n,e])=>`${n}: ${e};`,$2=([n,e])=>`${n}: ${e};`;function O4(n,e,t){const i=["use","class","style","for","floatAbove","required","wrapped","shake","float","setRequired","getWidth","getElement"];let r=Ji(e,i),{$$slots:a={},$$scope:h}=e;var s;const p=Uo(zo());let{use:x=[]}=e,{class:I=""}=e,{style:C=""}=e,{for:M=void 0}=e,{floatAbove:O=!1}=e,{required:k=!1}=e,{wrapped:z=!1}=e,G,q,Z={},K={},te=(s=Ws("SMUI:generic:input:props"))!==null&&s!==void 0?s:{},ie=O,Te=k;Ll(()=>{t(18,q=new E4({addClass:le,removeClass:fe,getWidth:()=>{var Ze,At;const Kt=nt(),sn=Kt.cloneNode(!0);(Ze=Kt.parentNode)===null||Ze===void 0||Ze.appendChild(sn),sn.classList.add("smui-floating-label--remove-transition"),sn.classList.add("smui-floating-label--force-size"),sn.classList.remove("mdc-floating-label--float-above");const zn=sn.scrollWidth;return(At=Kt.parentNode)===null||At===void 0||At.removeChild(sn),zn},registerInteractionHandler:(Ze,At)=>nt().addEventListener(Ze,At),deregisterInteractionHandler:(Ze,At)=>nt().removeEventListener(Ze,At)}));const et={get element(){return nt()},addStyle:Fe,removeStyle:Ne};return vs(G,"SMUIFloatingLabel:mount",et),q.init(),()=>{vs(G,"SMUIFloatingLabel:unmount",et),q.destroy()}});function le(et){Z[et]||t(8,Z[et]=!0,Z)}function fe(et){(!(et in Z)||Z[et])&&t(8,Z[et]=!1,Z)}function Fe(et,Ze){K[et]!=Ze&&(Ze===""||Ze==null?(delete K[et],t(9,K)):t(9,K[et]=Ze,K))}function Ne(et){et in K&&(delete K[et],t(9,K))}function Ue(et){q.shake(et)}function dt(et){t(0,O=et)}function Ge(et){t(1,k=et)}function Le(){return q.getWidth()}function nt(){return G}function zt(et){$n[et?"unshift":"push"](()=>{G=et,t(7,G)})}function Ot(et){$n[et?"unshift":"push"](()=>{G=et,t(7,G)})}return n.$$set=et=>{e=dn(dn({},e),So(et)),t(12,r=Ji(e,i)),"use"in et&&t(2,x=et.use),"class"in et&&t(3,I=et.class),"style"in et&&t(4,C=et.style),"for"in et&&t(5,M=et.for),"floatAbove"in et&&t(0,O=et.floatAbove),"required"in et&&t(1,k=et.required),"wrapped"in et&&t(6,z=et.wrapped),"$$scope"in et&&t(21,h=et.$$scope)},n.$$.update=()=>{n.$$.dirty&786433&&q&&ie!==O&&(t(19,ie=O),q.float(O)),n.$$.dirty&1310722&&q&&Te!==k&&(t(20,Te=k),q.setRequired(k))},[O,k,x,I,C,M,z,G,Z,K,p,te,r,Ue,dt,Ge,Le,nt,q,ie,Te,h,a,zt,Ot]}class iw extends Fr{constructor(e){super(),Br(this,e,O4,D4,Lr,{use:2,class:3,style:4,for:5,floatAbove:0,required:1,wrapped:6,shake:13,float:14,setRequired:15,getWidth:16,getElement:17})}get shake(){return this.$$.ctx[13]}get float(){return this.$$.ctx[14]}get setRequired(){return this.$$.ctx[15]}get getWidth(){return this.$$.ctx[16]}get getElement(){return this.$$.ctx[17]}}function N4(n){let e,t,i,r,a,h,s=[{class:t=si({[n[1]]:!0,"mdc-line-ripple":!0,"mdc-line-ripple--active":n[3],...n[5]})},{style:i=Object.entries(n[6]).map(eA).concat([n[2]]).join(" ")},n[8]],p={};for(let x=0;x<s.length;x+=1)p=dn(p,s[x]);return{c(){e=un("div"),this.h()},l(x){e=cn(x,"DIV",{class:!0,style:!0}),_n(e).forEach(Oe),this.h()},h(){Ki(e,p)},m(x,I){Tt(x,e,I),n[13](e),a||(h=[tr(r=ra.call(null,e,n[0])),tr(n[7].call(null,e))],a=!0)},p(x,[I]){Ki(e,p=Gi(s,[I&42&&t!==(t=si({[x[1]]:!0,"mdc-line-ripple":!0,"mdc-line-ripple--active":x[3],...x[5]}))&&{class:t},I&68&&i!==(i=Object.entries(x[6]).map(eA).concat([x[2]]).join(" "))&&{style:i},I&256&&x[8]])),r&&as(r.update)&&I&1&&r.update.call(null,x[0])},i:za,o:za,d(x){x&&Oe(e),n[13](null),a=!1,sa(h)}}}const eA=([n,e])=>`${n}: ${e};`;function k4(n,e,t){const i=["use","class","style","active","activate","deactivate","setRippleCenter","getElement"];let r=Ji(e,i);const a=Uo(zo());let{use:h=[]}=e,{class:s=""}=e,{style:p=""}=e,{active:x=!1}=e,I,C,M={},O={};Ll(()=>(C=new w4({addClass:z,removeClass:G,hasClass:k,setStyle:q,registerEventHandler:(le,fe)=>ie().addEventListener(le,fe),deregisterEventHandler:(le,fe)=>ie().removeEventListener(le,fe)}),C.init(),()=>{C.destroy()}));function k(le){return le in M?M[le]:ie().classList.contains(le)}function z(le){M[le]||t(5,M[le]=!0,M)}function G(le){(!(le in M)||M[le])&&t(5,M[le]=!1,M)}function q(le,fe){O[le]!=fe&&(fe===""||fe==null?(delete O[le],t(6,O)):t(6,O[le]=fe,O))}function Z(){C.activate()}function K(){C.deactivate()}function te(le){C.setRippleCenter(le)}function ie(){return I}function Te(le){$n[le?"unshift":"push"](()=>{I=le,t(4,I)})}return n.$$set=le=>{e=dn(dn({},e),So(le)),t(8,r=Ji(e,i)),"use"in le&&t(0,h=le.use),"class"in le&&t(1,s=le.class),"style"in le&&t(2,p=le.style),"active"in le&&t(3,x=le.active)},[h,s,p,x,I,M,O,a,r,Z,K,te,ie,Te]}class qL extends Fr{constructor(e){super(),Br(this,e,k4,N4,Lr,{use:0,class:1,style:2,active:3,activate:9,deactivate:10,setRippleCenter:11,getElement:12})}get activate(){return this.$$.ctx[9]}get deactivate(){return this.$$.ctx[10]}get setRippleCenter(){return this.$$.ctx[11]}get getElement(){return this.$$.ctx[12]}}function tA(n){let e,t,i;const r=n[15].default,a=Sr(r,n,n[14],null);return{c(){e=un("div"),a&&a.c(),this.h()},l(h){e=cn(h,"DIV",{class:!0,style:!0});var s=_n(e);a&&a.l(s),s.forEach(Oe),this.h()},h(){tn(e,"class","mdc-notched-outline__notch"),tn(e,"style",t=Object.entries(n[7]).map(nA).join(" "))},m(h,s){Tt(h,e,s),a&&a.m(e,null),i=!0},p(h,s){a&&a.p&&(!i||s&16384)&&Cr(a,r,h,h[14],i?Mr(r,h[14],s,null):Ar(h[14]),null),(!i||s&128&&t!==(t=Object.entries(h[7]).map(nA).join(" ")))&&tn(e,"style",t)},i(h){i||(Ke(a,h),i=!0)},o(h){rt(a,h),i=!1},d(h){h&&Oe(e),a&&a.d(h)}}}function F4(n){let e,t,i,r,a,h,s,p,x,I,C=!n[3]&&tA(n),M=[{class:h=si({[n[1]]:!0,"mdc-notched-outline":!0,"mdc-notched-outline--notched":n[2],"mdc-notched-outline--no-label":n[3],...n[6]})},n[10]],O={};for(let k=0;k<M.length;k+=1)O=dn(O,M[k]);return{c(){e=un("div"),t=un("div"),i=qn(),C&&C.c(),r=qn(),a=un("div"),this.h()},l(k){e=cn(k,"DIV",{class:!0});var z=_n(e);t=cn(z,"DIV",{class:!0}),_n(t).forEach(Oe),i=Hn(z),C&&C.l(z),r=Hn(z),a=cn(z,"DIV",{class:!0}),_n(a).forEach(Oe),z.forEach(Oe),this.h()},h(){tn(t,"class","mdc-notched-outline__leading"),tn(a,"class","mdc-notched-outline__trailing"),Ki(e,O)},m(k,z){Tt(k,e,z),an(e,t),an(e,i),C&&C.m(e,null),an(e,r),an(e,a),n[16](e),p=!0,x||(I=[tr(s=ra.call(null,e,n[0])),tr(n[8].call(null,e)),Vi(e,"SMUIFloatingLabel:mount",n[9]),Vi(e,"SMUIFloatingLabel:unmount",n[17])],x=!0)},p(k,[z]){k[3]?C&&(vr(),rt(C,1,1,()=>{C=null}),xr()):C?(C.p(k,z),z&8&&Ke(C,1)):(C=tA(k),C.c(),Ke(C,1),C.m(e,r)),Ki(e,O=Gi(M,[(!p||z&78&&h!==(h=si({[k[1]]:!0,"mdc-notched-outline":!0,"mdc-notched-outline--notched":k[2],"mdc-notched-outline--no-label":k[3],...k[6]})))&&{class:h},z&1024&&k[10]])),s&&as(s.update)&&z&1&&s.update.call(null,k[0])},i(k){p||(Ke(C),p=!0)},o(k){rt(C),p=!1},d(k){k&&Oe(e),C&&C.d(),n[16](null),x=!1,sa(I)}}}const nA=([n,e])=>`${n}: ${e};`;function B4(n,e,t){const i=["use","class","notched","noLabel","notch","closeNotch","getElement"];let r=Ji(e,i),{$$slots:a={},$$scope:h}=e;const s=Uo(zo());let{use:p=[]}=e,{class:x=""}=e,{notched:I=!1}=e,{noLabel:C=!1}=e,M,O,k,z={},G={};Ll(()=>(O=new S4({addClass:Z,removeClass:K,setNotchWidthProperty:Ue=>te("width",Ue+"px"),removeNotchWidthProperty:()=>ie("width")}),O.init(),()=>{O.destroy()}));function q(Ue){t(4,k=Ue.detail)}function Z(Ue){z[Ue]||t(6,z[Ue]=!0,z)}function K(Ue){(!(Ue in z)||z[Ue])&&t(6,z[Ue]=!1,z)}function te(Ue,dt){G[Ue]!=dt&&(dt===""||dt==null?(delete G[Ue],t(7,G)):t(7,G[Ue]=dt,G))}function ie(Ue){Ue in G&&(delete G[Ue],t(7,G))}function Te(Ue){O.notch(Ue)}function le(){O.closeNotch()}function fe(){return M}function Fe(Ue){$n[Ue?"unshift":"push"](()=>{M=Ue,t(5,M)})}const Ne=()=>t(4,k=void 0);return n.$$set=Ue=>{e=dn(dn({},e),So(Ue)),t(10,r=Ji(e,i)),"use"in Ue&&t(0,p=Ue.use),"class"in Ue&&t(1,x=Ue.class),"notched"in Ue&&t(2,I=Ue.notched),"noLabel"in Ue&&t(3,C=Ue.noLabel),"$$scope"in Ue&&t(14,h=Ue.$$scope)},n.$$.update=()=>{n.$$.dirty&16&&(k?(k.addStyle("transition-duration","0s"),Z("mdc-notched-outline--upgraded"),requestAnimationFrame(()=>{k&&k.removeStyle("transition-duration")})):K("mdc-notched-outline--upgraded"))},[p,x,I,C,k,M,z,G,s,q,r,Te,le,fe,h,a,Fe,Ne]}class HL extends Fr{constructor(e){super(),Br(this,e,B4,F4,Lr,{use:0,class:1,notched:2,noLabel:3,notch:11,closeNotch:12,getElement:13})}get notch(){return this.$$.ctx[11]}get closeNotch(){return this.$$.ctx[12]}get getElement(){return this.$$.ctx[13]}}const z4=zc({class:"mdc-text-field-helper-line",tag:"div"}),U4=zc({class:"mdc-text-field__affix mdc-text-field__affix--prefix",tag:"span"}),V4=zc({class:"mdc-text-field__affix mdc-text-field__affix--suffix",tag:"span"});function G4(n){let e,t,i,r,a,h=[{class:t=si({[n[1]]:!0,"mdc-text-field__input":!0})},{type:n[2]},{placeholder:n[3]},n[4],n[6],n[10]],s={};for(let p=0;p<h.length;p+=1)s=dn(s,h[p]);return{c(){e=un("input"),this.h()},l(p){e=cn(p,"INPUT",{class:!0,type:!0,placeholder:!0}),this.h()},h(){Ki(e,s)},m(p,x){Tt(p,e,x),e.autofocus&&e.focus(),n[26](e),r||(a=[tr(i=ra.call(null,e,n[0])),tr(n[7].call(null,e)),Vi(e,"input",n[27]),Vi(e,"change",n[9]),Vi(e,"blur",n[24]),Vi(e,"focus",n[25])],r=!0)},p(p,[x]){Ki(e,s=Gi(h,[x&2&&t!==(t=si({[p[1]]:!0,"mdc-text-field__input":!0}))&&{class:t},x&4&&{type:p[2]},x&8&&{placeholder:p[3]},x&16&&p[4],x&64&&p[6],x&1024&&p[10]])),i&&as(i.update)&&x&1&&i.update.call(null,p[0])},i:za,o:za,d(p){p&&Oe(e),n[26](null),r=!1,sa(a)}}}function j4(n){return n===""?Number.NaN:+n}function q4(n,e,t){const i=["use","class","type","placeholder","value","files","dirty","invalid","updateInvalid","emptyValueNull","emptyValueUndefined","getAttr","addAttr","removeAttr","focus","blur","getElement"];let r=Ji(e,i);const a=Uo(zo());let h=()=>{};function s(Ze){return Ze===h}let{use:p=[]}=e,{class:x=""}=e,{type:I="text"}=e,{placeholder:C=" "}=e,{value:M=h}=e;const O=s(M);O&&(M="");let{files:k=null}=e,{dirty:z=!1}=e,{invalid:G=!1}=e,{updateInvalid:q=!0}=e,{emptyValueNull:Z=M===null}=e;O&&Z&&(M=null);let{emptyValueUndefined:K=M===void 0}=e;O&&K&&(M=void 0);let te,ie={},Te={};Ll(()=>{q&&t(14,G=te.matches(":invalid"))});function le(Ze){if(I==="file"){t(12,k=Ze.currentTarget.files);return}if(Ze.currentTarget.value===""&&Z){t(11,M=null);return}if(Ze.currentTarget.value===""&&K){t(11,M=void 0);return}switch(I){case"number":case"range":t(11,M=j4(Ze.currentTarget.value));break;default:t(11,M=Ze.currentTarget.value);break}}function fe(Ze){(I==="file"||I==="range")&&le(Ze),t(13,z=!0),q&&t(14,G=te.matches(":invalid"))}function Fe(Ze){var At;return Ze in ie?(At=ie[Ze])!==null&&At!==void 0?At:null:Le().getAttribute(Ze)}function Ne(Ze,At){ie[Ze]!==At&&t(6,ie[Ze]=At,ie)}function Ue(Ze){(!(Ze in ie)||ie[Ze]!=null)&&t(6,ie[Ze]=void 0,ie)}function dt(){Le().focus()}function Ge(){Le().blur()}function Le(){return te}function nt(Ze){Zl.call(this,n,Ze)}function zt(Ze){Zl.call(this,n,Ze)}function Ot(Ze){$n[Ze?"unshift":"push"](()=>{te=Ze,t(5,te)})}const et=Ze=>I!=="file"&&le(Ze);return n.$$set=Ze=>{e=dn(dn({},e),So(Ze)),t(10,r=Ji(e,i)),"use"in Ze&&t(0,p=Ze.use),"class"in Ze&&t(1,x=Ze.class),"type"in Ze&&t(2,I=Ze.type),"placeholder"in Ze&&t(3,C=Ze.placeholder),"value"in Ze&&t(11,M=Ze.value),"files"in Ze&&t(12,k=Ze.files),"dirty"in Ze&&t(13,z=Ze.dirty),"invalid"in Ze&&t(14,G=Ze.invalid),"updateInvalid"in Ze&&t(15,q=Ze.updateInvalid),"emptyValueNull"in Ze&&t(16,Z=Ze.emptyValueNull),"emptyValueUndefined"in Ze&&t(17,K=Ze.emptyValueUndefined)},n.$$.update=()=>{n.$$.dirty&2068&&(I==="file"?(delete Te.value,t(4,Te),t(2,I),t(11,M)):t(4,Te.value=M??"",Te))},[p,x,I,C,Te,te,ie,a,le,fe,r,M,k,z,G,q,Z,K,Fe,Ne,Ue,dt,Ge,Le,nt,zt,Ot,et]}class H4 extends Fr{constructor(e){super(),Br(this,e,q4,G4,Lr,{use:0,class:1,type:2,placeholder:3,value:11,files:12,dirty:13,invalid:14,updateInvalid:15,emptyValueNull:16,emptyValueUndefined:17,getAttr:18,addAttr:19,removeAttr:20,focus:21,blur:22,getElement:23})}get getAttr(){return this.$$.ctx[18]}get addAttr(){return this.$$.ctx[19]}get removeAttr(){return this.$$.ctx[20]}get focus(){return this.$$.ctx[21]}get blur(){return this.$$.ctx[22]}get getElement(){return this.$$.ctx[23]}}function W4(n){let e,t,i,r,a,h,s=[{class:t=si({[n[2]]:!0,"mdc-text-field__input":!0})},{style:i=`${n[4]?"":"resize: none; "}${n[3]}`},n[6],n[9]],p={};for(let x=0;x<s.length;x+=1)p=dn(p,s[x]);return{c(){e=un("textarea"),this.h()},l(x){e=cn(x,"TEXTAREA",{class:!0,style:!0}),_n(e).forEach(Oe),this.h()},h(){Ki(e,p)},m(x,I){Tt(x,e,I),e.autofocus&&e.focus(),n[21](e),Um(e,n[0]),a||(h=[tr(r=ra.call(null,e,n[1])),tr(n[7].call(null,e)),Vi(e,"change",n[8]),Vi(e,"blur",n[19]),Vi(e,"focus",n[20]),Vi(e,"input",n[22])],a=!0)},p(x,[I]){Ki(e,p=Gi(s,[I&4&&t!==(t=si({[x[2]]:!0,"mdc-text-field__input":!0}))&&{class:t},I&24&&i!==(i=`${x[4]?"":"resize: none; "}${x[3]}`)&&{style:i},I&64&&x[6],I&512&&x[9]])),r&&as(r.update)&&I&2&&r.update.call(null,x[1]),I&1&&Um(e,x[0])},i:za,o:za,d(x){x&&Oe(e),n[21](null),a=!1,sa(h)}}}function X4(n,e,t){const i=["use","class","style","value","dirty","invalid","updateInvalid","resizable","getAttr","addAttr","removeAttr","focus","blur","getElement"];let r=Ji(e,i);const a=Uo(zo());let{use:h=[]}=e,{class:s=""}=e,{style:p=""}=e,{value:x=""}=e,{dirty:I=!1}=e,{invalid:C=!1}=e,{updateInvalid:M=!0}=e,{resizable:O=!0}=e,k,z={};Ll(()=>{M&&t(11,C=k.matches(":invalid"))});function G(){t(10,I=!0),M&&t(11,C=k.matches(":invalid"))}function q(Ue){var dt;return Ue in z?(dt=z[Ue])!==null&&dt!==void 0?dt:null:Te().getAttribute(Ue)}function Z(Ue,dt){z[Ue]!==dt&&t(6,z[Ue]=dt,z)}function K(Ue){(!(Ue in z)||z[Ue]!=null)&&t(6,z[Ue]=void 0,z)}function te(){Te().focus()}function ie(){Te().blur()}function Te(){return k}function le(Ue){Zl.call(this,n,Ue)}function fe(Ue){Zl.call(this,n,Ue)}function Fe(Ue){$n[Ue?"unshift":"push"](()=>{k=Ue,t(5,k)})}function Ne(){x=this.value,t(0,x)}return n.$$set=Ue=>{e=dn(dn({},e),So(Ue)),t(9,r=Ji(e,i)),"use"in Ue&&t(1,h=Ue.use),"class"in Ue&&t(2,s=Ue.class),"style"in Ue&&t(3,p=Ue.style),"value"in Ue&&t(0,x=Ue.value),"dirty"in Ue&&t(10,I=Ue.dirty),"invalid"in Ue&&t(11,C=Ue.invalid),"updateInvalid"in Ue&&t(12,M=Ue.updateInvalid),"resizable"in Ue&&t(4,O=Ue.resizable)},[x,h,s,p,O,k,z,a,G,r,I,C,M,q,Z,K,te,ie,Te,le,fe,Fe,Ne]}class Z4 extends Fr{constructor(e){super(),Br(this,e,X4,W4,Lr,{use:1,class:2,style:3,value:0,dirty:10,invalid:11,updateInvalid:12,resizable:4,getAttr:13,addAttr:14,removeAttr:15,focus:16,blur:17,getElement:18})}get getAttr(){return this.$$.ctx[13]}get addAttr(){return this.$$.ctx[14]}get removeAttr(){return this.$$.ctx[15]}get focus(){return this.$$.ctx[16]}get blur(){return this.$$.ctx[17]}get getElement(){return this.$$.ctx[18]}}const Y4=n=>({}),iA=n=>({}),K4=n=>({}),rA=n=>({}),J4=n=>({}),sA=n=>({}),Q4=n=>({}),oA=n=>({}),$4=n=>({}),aA=n=>({}),e5=n=>({}),lA=n=>({}),t5=n=>({}),uA=n=>({}),n5=n=>({}),cA=n=>({}),i5=n=>({}),hA=n=>({}),r5=n=>({}),fA=n=>({}),s5=n=>({}),dA=n=>({}),o5=n=>({}),pA=n=>({});function a5(n){let e,t,i,r,a,h,s,p,x,I,C,M,O,k;const z=n[56].label,G=Sr(z,n,n[87],aA);i=new gE({props:{key:"SMUI:textfield:icon:leading",value:!0,$$slots:{default:[u5]},$$scope:{ctx:n}}});const q=n[56].default,Z=Sr(q,n,n[87],null);h=new gE({props:{key:"SMUI:textfield:icon:leading",value:!1,$$slots:{default:[c5]},$$scope:{ctx:n}}});const K=n[56].ripple,te=Sr(K,n,n[87],rA);let ie=[{class:p=si({[n[9]]:!0,"mdc-text-field":!0,"mdc-text-field--disabled":n[12],"mdc-text-field--textarea":n[14],"mdc-text-field--filled":n[15]==="filled","mdc-text-field--outlined":n[15]==="outlined","smui-text-field--standard":n[15]==="standard"&&!n[14],"mdc-text-field--no-label":n[16]||!n[47].label,"mdc-text-field--with-leading-icon":n[47].leadingIcon,"mdc-text-field--with-trailing-icon":n[47].trailingIcon,"mdc-text-field--invalid":n[1],...n[25]})},{style:x=Object.entries(n[26]).map(TA).concat([n[10]]).join(" ")},ep(n[46],["input$","label$","ripple$","outline$","helperLine$"])],Te={};for(let le=0;le<ie.length;le+=1)Te=dn(Te,ie[le]);return{c(){e=un("div"),G&&G.c(),t=qn(),Pn(i.$$.fragment),r=qn(),Z&&Z.c(),a=qn(),Pn(h.$$.fragment),s=qn(),te&&te.c(),this.h()},l(le){e=cn(le,"DIV",{class:!0,style:!0});var fe=_n(e);G&&G.l(fe),t=Hn(fe),Zn(i.$$.fragment,fe),r=Hn(fe),Z&&Z.l(fe),a=Hn(fe),Zn(h.$$.fragment,fe),s=Hn(fe),te&&te.l(fe),fe.forEach(Oe),this.h()},h(){Ki(e,Te)},m(le,fe){Tt(le,e,fe),G&&G.m(e,null),an(e,t),Rn(i,e,null),an(e,r),Z&&Z.m(e,null),an(e,a),Rn(h,e,null),an(e,s),te&&te.m(e,null),n[82](e),M=!0,O||(k=[tr(I=ff.call(null,e,{ripple:n[11],unbounded:!1,addClass:n[43],removeClass:n[44],addStyle:n[45]})),tr(C=ra.call(null,e,n[8])),tr(n[34].call(null,e)),Vi(e,"SMUITextfieldLeadingIcon:mount",n[38]),Vi(e,"SMUITextfieldLeadingIcon:unmount",n[83]),Vi(e,"SMUITextfieldTrailingIcon:mount",n[39]),Vi(e,"SMUITextfieldTrailingIcon:unmount",n[84])],O=!0)},p(le,fe){G&&G.p&&(!M||fe[2]&33554432)&&Cr(G,z,le,le[87],M?Mr(z,le[87],fe,$4):Ar(le[87]),aA);const Fe={};fe[2]&33554432&&(Fe.$$scope={dirty:fe,ctx:le}),i.$set(Fe),Z&&Z.p&&(!M||fe[2]&33554432)&&Cr(Z,q,le,le[87],M?Mr(q,le[87],fe,null):Ar(le[87]),null);const Ne={};fe[2]&33554432&&(Ne.$$scope={dirty:fe,ctx:le}),h.$set(Ne),te&&te.p&&(!M||fe[2]&33554432)&&Cr(te,K,le,le[87],M?Mr(K,le[87],fe,K4):Ar(le[87]),rA),Ki(e,Te=Gi(ie,[(!M||fe[0]&33673730|fe[1]&65536&&p!==(p=si({[le[9]]:!0,"mdc-text-field":!0,"mdc-text-field--disabled":le[12],"mdc-text-field--textarea":le[14],"mdc-text-field--filled":le[15]==="filled","mdc-text-field--outlined":le[15]==="outlined","smui-text-field--standard":le[15]==="standard"&&!le[14],"mdc-text-field--no-label":le[16]||!le[47].label,"mdc-text-field--with-leading-icon":le[47].leadingIcon,"mdc-text-field--with-trailing-icon":le[47].trailingIcon,"mdc-text-field--invalid":le[1],...le[25]})))&&{class:p},(!M||fe[0]&67109888&&x!==(x=Object.entries(le[26]).map(TA).concat([le[10]]).join(" ")))&&{style:x},fe[1]&32768&&ep(le[46],["input$","label$","ripple$","outline$","helperLine$"])])),I&&as(I.update)&&fe[0]&2048&&I.update.call(null,{ripple:le[11],unbounded:!1,addClass:le[43],removeClass:le[44],addStyle:le[45]}),C&&as(C.update)&&fe[0]&256&&C.update.call(null,le[8])},i(le){M||(Ke(G,le),Ke(i.$$.fragment,le),Ke(Z,le),Ke(h.$$.fragment,le),Ke(te,le),M=!0)},o(le){rt(G,le),rt(i.$$.fragment,le),rt(Z,le),rt(h.$$.fragment,le),rt(te,le),M=!1},d(le){le&&Oe(e),G&&G.d(le),Dn(i),Z&&Z.d(le),Dn(h),te&&te.d(le),n[82](null),O=!1,sa(k)}}}function l5(n){let e,t,i,r,a,h,s,p,x,I,C,M,O,k,z,G,q,Z,K=!n[14]&&n[15]!=="outlined"&&mA(n),te=(n[14]||n[15]==="outlined")&&yA(n);r=new gE({props:{key:"SMUI:textfield:icon:leading",value:!0,$$slots:{default:[p5]},$$scope:{ctx:n}}});const ie=n[56].default,Te=Sr(ie,n,n[87],null),le=[g5,m5],fe=[];function Fe(Ge,Le){return Ge[14]&&typeof Ge[0]=="string"?0:1}s=Fe(n),p=fe[s]=le[s](n),I=new gE({props:{key:"SMUI:textfield:icon:leading",value:!1,$$slots:{default:[v5]},$$scope:{ctx:n}}});let Ne=!n[14]&&n[15]!=="outlined"&&n[11]&&EA(n),Ue=[{class:M=si({[n[9]]:!0,"mdc-text-field":!0,"mdc-text-field--disabled":n[12],"mdc-text-field--textarea":n[14],"mdc-text-field--filled":n[15]==="filled","mdc-text-field--outlined":n[15]==="outlined","smui-text-field--standard":n[15]==="standard"&&!n[14],"mdc-text-field--no-label":n[16]||n[17]==null&&!n[47].label,"mdc-text-field--label-floating":n[28]||n[0]!=null&&n[0]!=="","mdc-text-field--with-leading-icon":n[35](n[22])?n[47].leadingIcon:n[22],"mdc-text-field--with-trailing-icon":n[35](n[23])?n[47].trailingIcon:n[23],"mdc-text-field--with-internal-counter":n[14]&&n[47].internalCounter,"mdc-text-field--invalid":n[1],...n[25]})},{style:O=Object.entries(n[26]).map(IA).concat([n[10]]).join(" ")},{for:void 0},ep(n[46],["input$","label$","ripple$","outline$","helperLine$"])],dt={};for(let Ge=0;Ge<Ue.length;Ge+=1)dt=dn(dt,Ue[Ge]);return{c(){e=un("label"),K&&K.c(),t=qn(),te&&te.c(),i=qn(),Pn(r.$$.fragment),a=qn(),Te&&Te.c(),h=qn(),p.c(),x=qn(),Pn(I.$$.fragment),C=qn(),Ne&&Ne.c(),this.h()},l(Ge){e=cn(Ge,"LABEL",{class:!0,style:!0,for:!0});var Le=_n(e);K&&K.l(Le),t=Hn(Le),te&&te.l(Le),i=Hn(Le),Zn(r.$$.fragment,Le),a=Hn(Le),Te&&Te.l(Le),h=Hn(Le),p.l(Le),x=Hn(Le),Zn(I.$$.fragment,Le),C=Hn(Le),Ne&&Ne.l(Le),Le.forEach(Oe),this.h()},h(){Ki(e,dt)},m(Ge,Le){Tt(Ge,e,Le),K&&K.m(e,null),an(e,t),te&&te.m(e,null),an(e,i),Rn(r,e,null),an(e,a),Te&&Te.m(e,null),an(e,h),fe[s].m(e,null),an(e,x),Rn(I,e,null),an(e,C),Ne&&Ne.m(e,null),n[78](e),G=!0,q||(Z=[tr(k=ff.call(null,e,{ripple:!n[14]&&n[15]==="filled",unbounded:!1,addClass:n[43],removeClass:n[44],addStyle:n[45],eventTarget:n[33],activeTarget:n[33],initPromise:n[37]})),tr(z=ra.call(null,e,n[8])),tr(n[34].call(null,e)),Vi(e,"SMUITextfieldLeadingIcon:mount",n[38]),Vi(e,"SMUITextfieldLeadingIcon:unmount",n[79]),Vi(e,"SMUITextfieldTrailingIcon:mount",n[39]),Vi(e,"SMUITextfieldTrailingIcon:unmount",n[80]),Vi(e,"SMUITextfieldCharacterCounter:mount",n[40]),Vi(e,"SMUITextfieldCharacterCounter:unmount",n[81])],q=!0)},p(Ge,Le){!Ge[14]&&Ge[15]!=="outlined"?K?(K.p(Ge,Le),Le[0]&49152&&Ke(K,1)):(K=mA(Ge),K.c(),Ke(K,1),K.m(e,t)):K&&(vr(),rt(K,1,1,()=>{K=null}),xr()),Ge[14]||Ge[15]==="outlined"?te?(te.p(Ge,Le),Le[0]&49152&&Ke(te,1)):(te=yA(Ge),te.c(),Ke(te,1),te.m(e,i)):te&&(vr(),rt(te,1,1,()=>{te=null}),xr());const nt={};Le[2]&33554432&&(nt.$$scope={dirty:Le,ctx:Ge}),r.$set(nt),Te&&Te.p&&(!G||Le[2]&33554432)&&Cr(Te,ie,Ge,Ge[87],G?Mr(ie,Ge[87],Le,null):Ar(Ge[87]),null);let zt=s;s=Fe(Ge),s===zt?fe[s].p(Ge,Le):(vr(),rt(fe[zt],1,1,()=>{fe[zt]=null}),xr(),p=fe[s],p?p.p(Ge,Le):(p=fe[s]=le[s](Ge),p.c()),Ke(p,1),p.m(e,x));const Ot={};Le[2]&33554432&&(Ot.$$scope={dirty:Le,ctx:Ge}),I.$set(Ot),!Ge[14]&&Ge[15]!=="outlined"&&Ge[11]?Ne?(Ne.p(Ge,Le),Le[0]&51200&&Ke(Ne,1)):(Ne=EA(Ge),Ne.c(),Ke(Ne,1),Ne.m(e,null)):Ne&&(vr(),rt(Ne,1,1,()=>{Ne=null}),xr()),Ki(e,dt=Gi(Ue,[(!G||Le[0]&314823171|Le[1]&65536&&M!==(M=si({[Ge[9]]:!0,"mdc-text-field":!0,"mdc-text-field--disabled":Ge[12],"mdc-text-field--textarea":Ge[14],"mdc-text-field--filled":Ge[15]==="filled","mdc-text-field--outlined":Ge[15]==="outlined","smui-text-field--standard":Ge[15]==="standard"&&!Ge[14],"mdc-text-field--no-label":Ge[16]||Ge[17]==null&&!Ge[47].label,"mdc-text-field--label-floating":Ge[28]||Ge[0]!=null&&Ge[0]!=="","mdc-text-field--with-leading-icon":Ge[35](Ge[22])?Ge[47].leadingIcon:Ge[22],"mdc-text-field--with-trailing-icon":Ge[35](Ge[23])?Ge[47].trailingIcon:Ge[23],"mdc-text-field--with-internal-counter":Ge[14]&&Ge[47].internalCounter,"mdc-text-field--invalid":Ge[1],...Ge[25]})))&&{class:M},(!G||Le[0]&67109888&&O!==(O=Object.entries(Ge[26]).map(IA).concat([Ge[10]]).join(" ")))&&{style:O},{for:void 0},Le[1]&32768&&ep(Ge[46],["input$","label$","ripple$","outline$","helperLine$"])])),k&&as(k.update)&&Le[0]&49152|Le[1]&4&&k.update.call(null,{ripple:!Ge[14]&&Ge[15]==="filled",unbounded:!1,addClass:Ge[43],removeClass:Ge[44],addStyle:Ge[45],eventTarget:Ge[33],activeTarget:Ge[33],initPromise:Ge[37]}),z&&as(z.update)&&Le[0]&256&&z.update.call(null,Ge[8])},i(Ge){G||(Ke(K),Ke(te),Ke(r.$$.fragment,Ge),Ke(Te,Ge),Ke(p),Ke(I.$$.fragment,Ge),Ke(Ne),G=!0)},o(Ge){rt(K),rt(te),rt(r.$$.fragment,Ge),rt(Te,Ge),rt(p),rt(I.$$.fragment,Ge),rt(Ne),G=!1},d(Ge){Ge&&Oe(e),K&&K.d(),te&&te.d(),Dn(r),Te&&Te.d(Ge),fe[s].d(),Dn(I),Ne&&Ne.d(),n[78](null),q=!1,sa(Z)}}}function u5(n){let e;const t=n[56].leadingIcon,i=Sr(t,n,n[87],oA);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a[2]&33554432)&&Cr(i,t,r,r[87],e?Mr(t,r[87],a,Q4):Ar(r[87]),oA)},i(r){e||(Ke(i,r),e=!0)},o(r){rt(i,r),e=!1},d(r){i&&i.d(r)}}}function c5(n){let e;const t=n[56].trailingIcon,i=Sr(t,n,n[87],sA);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a[2]&33554432)&&Cr(i,t,r,r[87],e?Mr(t,r[87],a,J4):Ar(r[87]),sA)},i(r){e||(Ke(i,r),e=!0)},o(r){rt(i,r),e=!1},d(r){i&&i.d(r)}}}function mA(n){let e,t,i,r=n[15]==="filled"&&gA(),a=!n[16]&&(n[17]!=null||n[47].label)&&_A(n);return{c(){r&&r.c(),e=qn(),a&&a.c(),t=Ei()},l(h){r&&r.l(h),e=Hn(h),a&&a.l(h),t=Ei()},m(h,s){r&&r.m(h,s),Tt(h,e,s),a&&a.m(h,s),Tt(h,t,s),i=!0},p(h,s){h[15]==="filled"?r||(r=gA(),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),!h[16]&&(h[17]!=null||h[47].label)?a?(a.p(h,s),s[0]&196608|s[1]&65536&&Ke(a,1)):(a=_A(h),a.c(),Ke(a,1),a.m(t.parentNode,t)):a&&(vr(),rt(a,1,1,()=>{a=null}),xr())},i(h){i||(Ke(a),i=!0)},o(h){rt(a),i=!1},d(h){r&&r.d(h),h&&Oe(e),a&&a.d(h),h&&Oe(t)}}}function gA(n){let e;return{c(){e=un("span"),this.h()},l(t){e=cn(t,"SPAN",{class:!0}),_n(e).forEach(Oe),this.h()},h(){tn(e,"class","mdc-text-field__ripple")},m(t,i){Tt(t,e,i)},d(t){t&&Oe(e)}}}function _A(n){let e,t;const i=[{floatAbove:n[28]||n[0]!=null&&n[0]!==""&&(typeof n[0]!="number"||!isNaN(n[0]))},{required:n[13]},{wrapped:!0},sr(n[46],"label$")];let r={$$slots:{default:[h5]},$$scope:{ctx:n}};for(let a=0;a<i.length;a+=1)r=dn(r,i[a]);return e=new iw({props:r}),n[57](e),{c(){Pn(e.$$.fragment)},l(a){Zn(e.$$.fragment,a)},m(a,h){Rn(e,a,h),t=!0},p(a,h){const s=h[0]&268443649|h[1]&32768?Gi(i,[h[0]&268435457&&{floatAbove:a[28]||a[0]!=null&&a[0]!==""&&(typeof a[0]!="number"||!isNaN(a[0]))},h[0]&8192&&{required:a[13]},i[2],h[1]&32768&&kr(sr(a[46],"label$"))]):{};h[0]&131072|h[2]&33554432&&(s.$$scope={dirty:h,ctx:a}),e.$set(s)},i(a){t||(Ke(e.$$.fragment,a),t=!0)},o(a){rt(e.$$.fragment,a),t=!1},d(a){n[57](null),Dn(e,a)}}}function h5(n){let e=(n[17]==null?"":n[17])+"",t,i;const r=n[56].label,a=Sr(r,n,n[87],pA);return{c(){t=_r(e),a&&a.c()},l(h){t=yr(h,e),a&&a.l(h)},m(h,s){Tt(h,t,s),a&&a.m(h,s),i=!0},p(h,s){(!i||s[0]&131072)&&e!==(e=(h[17]==null?"":h[17])+"")&&Ao(t,e),a&&a.p&&(!i||s[2]&33554432)&&Cr(a,r,h,h[87],i?Mr(r,h[87],s,o5):Ar(h[87]),pA)},i(h){i||(Ke(a,h),i=!0)},o(h){rt(a,h),i=!1},d(h){h&&Oe(t),a&&a.d(h)}}}function yA(n){let e,t;const i=[{noLabel:n[16]||n[17]==null&&!n[47].label},sr(n[46],"outline$")];let r={$$slots:{default:[d5]},$$scope:{ctx:n}};for(let a=0;a<i.length;a+=1)r=dn(r,i[a]);return e=new HL({props:r}),n[59](e),{c(){Pn(e.$$.fragment)},l(a){Zn(e.$$.fragment,a)},m(a,h){Rn(e,a,h),t=!0},p(a,h){const s=h[0]&196608|h[1]&98304?Gi(i,[h[0]&196608|h[1]&65536&&{noLabel:a[16]||a[17]==null&&!a[47].label},h[1]&32768&&kr(sr(a[46],"outline$"))]):{};h[0]&268640289|h[1]&98304|h[2]&33554432&&(s.$$scope={dirty:h,ctx:a}),e.$set(s)},i(a){t||(Ke(e.$$.fragment,a),t=!0)},o(a){rt(e.$$.fragment,a),t=!1},d(a){n[59](null),Dn(e,a)}}}function vA(n){let e,t;const i=[{floatAbove:n[28]||n[0]!=null&&n[0]!==""&&(typeof n[0]!="number"||!isNaN(n[0]))},{required:n[13]},{wrapped:!0},sr(n[46],"label$")];let r={$$slots:{default:[f5]},$$scope:{ctx:n}};for(let a=0;a<i.length;a+=1)r=dn(r,i[a]);return e=new iw({props:r}),n[58](e),{c(){Pn(e.$$.fragment)},l(a){Zn(e.$$.fragment,a)},m(a,h){Rn(e,a,h),t=!0},p(a,h){const s=h[0]&268443649|h[1]&32768?Gi(i,[h[0]&268435457&&{floatAbove:a[28]||a[0]!=null&&a[0]!==""&&(typeof a[0]!="number"||!isNaN(a[0]))},h[0]&8192&&{required:a[13]},i[2],h[1]&32768&&kr(sr(a[46],"label$"))]):{};h[0]&131072|h[2]&33554432&&(s.$$scope={dirty:h,ctx:a}),e.$set(s)},i(a){t||(Ke(e.$$.fragment,a),t=!0)},o(a){rt(e.$$.fragment,a),t=!1},d(a){n[58](null),Dn(e,a)}}}function f5(n){let e=(n[17]==null?"":n[17])+"",t,i;const r=n[56].label,a=Sr(r,n,n[87],dA);return{c(){t=_r(e),a&&a.c()},l(h){t=yr(h,e),a&&a.l(h)},m(h,s){Tt(h,t,s),a&&a.m(h,s),i=!0},p(h,s){(!i||s[0]&131072)&&e!==(e=(h[17]==null?"":h[17])+"")&&Ao(t,e),a&&a.p&&(!i||s[2]&33554432)&&Cr(a,r,h,h[87],i?Mr(r,h[87],s,s5):Ar(h[87]),dA)},i(h){i||(Ke(a,h),i=!0)},o(h){rt(a,h),i=!1},d(h){h&&Oe(t),a&&a.d(h)}}}function d5(n){let e,t,i=!n[16]&&(n[17]!=null||n[47].label)&&vA(n);return{c(){i&&i.c(),e=Ei()},l(r){i&&i.l(r),e=Ei()},m(r,a){i&&i.m(r,a),Tt(r,e,a),t=!0},p(r,a){!r[16]&&(r[17]!=null||r[47].label)?i?(i.p(r,a),a[0]&196608|a[1]&65536&&Ke(i,1)):(i=vA(r),i.c(),Ke(i,1),i.m(e.parentNode,e)):i&&(vr(),rt(i,1,1,()=>{i=null}),xr())},i(r){t||(Ke(i),t=!0)},o(r){rt(i),t=!1},d(r){i&&i.d(r),r&&Oe(e)}}}function p5(n){let e;const t=n[56].leadingIcon,i=Sr(t,n,n[87],fA);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a[2]&33554432)&&Cr(i,t,r,r[87],e?Mr(t,r[87],a,r5):Ar(r[87]),fA)},i(r){e||(Ke(i,r),e=!0)},o(r){rt(i,r),e=!1},d(r){i&&i.d(r)}}}function m5(n){let e,t,i,r,a,h,s,p,x,I;const C=n[56].prefix,M=Sr(C,n,n[87],cA);let O=n[20]!=null&&xA(n);const k=[{type:n[18]},{disabled:n[12]},{required:n[13]},{updateInvalid:n[19]},{"aria-controls":n[27]},{"aria-describedby":n[27]},n[16]&&n[17]!=null?{placeholder:n[17]}:{},sr(n[46],"input$")];function z(le){n[69](le)}function G(le){n[70](le)}function q(le){n[71](le)}function Z(le){n[72](le)}let K={};for(let le=0;le<k.length;le+=1)K=dn(K,k[le]);n[0]!==void 0&&(K.value=n[0]),n[3]!==void 0&&(K.files=n[3]),n[4]!==void 0&&(K.dirty=n[4]),n[1]!==void 0&&(K.invalid=n[1]),i=new H4({props:K}),n[68](i),$n.push(()=>ho(i,"value",z)),$n.push(()=>ho(i,"files",G)),$n.push(()=>ho(i,"dirty",q)),$n.push(()=>ho(i,"invalid",Z)),i.$on("blur",n[73]),i.$on("focus",n[74]),i.$on("blur",n[75]),i.$on("focus",n[76]);let te=n[21]!=null&&bA(n);const ie=n[56].suffix,Te=Sr(ie,n,n[87],uA);return{c(){M&&M.c(),e=qn(),O&&O.c(),t=qn(),Pn(i.$$.fragment),p=qn(),te&&te.c(),x=qn(),Te&&Te.c()},l(le){M&&M.l(le),e=Hn(le),O&&O.l(le),t=Hn(le),Zn(i.$$.fragment,le),p=Hn(le),te&&te.l(le),x=Hn(le),Te&&Te.l(le)},m(le,fe){M&&M.m(le,fe),Tt(le,e,fe),O&&O.m(le,fe),Tt(le,t,fe),Rn(i,le,fe),Tt(le,p,fe),te&&te.m(le,fe),Tt(le,x,fe),Te&&Te.m(le,fe),I=!0},p(le,fe){M&&M.p&&(!I||fe[2]&33554432)&&Cr(M,C,le,le[87],I?Mr(C,le[87],fe,n5):Ar(le[87]),cA),le[20]!=null?O?(O.p(le,fe),fe[0]&1048576&&Ke(O,1)):(O=xA(le),O.c(),Ke(O,1),O.m(t.parentNode,t)):O&&(vr(),rt(O,1,1,()=>{O=null}),xr());const Fe=fe[0]&135213056|fe[1]&32768?Gi(k,[fe[0]&262144&&{type:le[18]},fe[0]&4096&&{disabled:le[12]},fe[0]&8192&&{required:le[13]},fe[0]&524288&&{updateInvalid:le[19]},fe[0]&134217728&&{"aria-controls":le[27]},fe[0]&134217728&&{"aria-describedby":le[27]},fe[0]&196608&&kr(le[16]&&le[17]!=null?{placeholder:le[17]}:{}),fe[1]&32768&&kr(sr(le[46],"input$"))]):{};!r&&fe[0]&1&&(r=!0,Fe.value=le[0],Eo(()=>r=!1)),!a&&fe[0]&8&&(a=!0,Fe.files=le[3],Eo(()=>a=!1)),!h&&fe[0]&16&&(h=!0,Fe.dirty=le[4],Eo(()=>h=!1)),!s&&fe[0]&2&&(s=!0,Fe.invalid=le[1],Eo(()=>s=!1)),i.$set(Fe),le[21]!=null?te?(te.p(le,fe),fe[0]&2097152&&Ke(te,1)):(te=bA(le),te.c(),Ke(te,1),te.m(x.parentNode,x)):te&&(vr(),rt(te,1,1,()=>{te=null}),xr()),Te&&Te.p&&(!I||fe[2]&33554432)&&Cr(Te,ie,le,le[87],I?Mr(ie,le[87],fe,t5):Ar(le[87]),uA)},i(le){I||(Ke(M,le),Ke(O),Ke(i.$$.fragment,le),Ke(te),Ke(Te,le),I=!0)},o(le){rt(M,le),rt(O),rt(i.$$.fragment,le),rt(te),rt(Te,le),I=!1},d(le){M&&M.d(le),le&&Oe(e),O&&O.d(le),le&&Oe(t),n[68](null),Dn(i,le),le&&Oe(p),te&&te.d(le),le&&Oe(x),Te&&Te.d(le)}}}function g5(n){let e,t,i,r,a,h,s,p;const x=[{disabled:n[12]},{required:n[13]},{updateInvalid:n[19]},{"aria-controls":n[27]},{"aria-describedby":n[27]},sr(n[46],"input$")];function I(G){n[61](G)}function C(G){n[62](G)}function M(G){n[63](G)}let O={};for(let G=0;G<x.length;G+=1)O=dn(O,x[G]);n[0]!==void 0&&(O.value=n[0]),n[4]!==void 0&&(O.dirty=n[4]),n[1]!==void 0&&(O.invalid=n[1]),t=new Z4({props:O}),n[60](t),$n.push(()=>ho(t,"value",I)),$n.push(()=>ho(t,"dirty",C)),$n.push(()=>ho(t,"invalid",M)),t.$on("blur",n[64]),t.$on("focus",n[65]),t.$on("blur",n[66]),t.$on("focus",n[67]);const k=n[56].internalCounter,z=Sr(k,n,n[87],hA);return{c(){e=un("span"),Pn(t.$$.fragment),h=qn(),z&&z.c(),this.h()},l(G){e=cn(G,"SPAN",{class:!0});var q=_n(e);Zn(t.$$.fragment,q),h=Hn(q),z&&z.l(q),q.forEach(Oe),this.h()},h(){tn(e,"class",s=si({"mdc-text-field__resizer":!("input$resizable"in n[46])||n[46].input$resizable}))},m(G,q){Tt(G,e,q),Rn(t,e,null),an(e,h),z&&z.m(e,null),p=!0},p(G,q){const Z=q[0]&134754304|q[1]&32768?Gi(x,[q[0]&4096&&{disabled:G[12]},q[0]&8192&&{required:G[13]},q[0]&524288&&{updateInvalid:G[19]},q[0]&134217728&&{"aria-controls":G[27]},q[0]&134217728&&{"aria-describedby":G[27]},q[1]&32768&&kr(sr(G[46],"input$"))]):{};!i&&q[0]&1&&(i=!0,Z.value=G[0],Eo(()=>i=!1)),!r&&q[0]&16&&(r=!0,Z.dirty=G[4],Eo(()=>r=!1)),!a&&q[0]&2&&(a=!0,Z.invalid=G[1],Eo(()=>a=!1)),t.$set(Z),z&&z.p&&(!p||q[2]&33554432)&&Cr(z,k,G,G[87],p?Mr(k,G[87],q,i5):Ar(G[87]),hA),(!p||q[1]&32768&&s!==(s=si({"mdc-text-field__resizer":!("input$resizable"in G[46])||G[46].input$resizable})))&&tn(e,"class",s)},i(G){p||(Ke(t.$$.fragment,G),Ke(z,G),p=!0)},o(G){rt(t.$$.fragment,G),rt(z,G),p=!1},d(G){G&&Oe(e),n[60](null),Dn(t),z&&z.d(G)}}}function xA(n){let e,t;return e=new U4({props:{$$slots:{default:[_5]},$$scope:{ctx:n}}}),{c(){Pn(e.$$.fragment)},l(i){Zn(e.$$.fragment,i)},m(i,r){Rn(e,i,r),t=!0},p(i,r){const a={};r[0]&1048576|r[2]&33554432&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Ke(e.$$.fragment,i),t=!0)},o(i){rt(e.$$.fragment,i),t=!1},d(i){Dn(e,i)}}}function _5(n){let e;return{c(){e=_r(n[20])},l(t){e=yr(t,n[20])},m(t,i){Tt(t,e,i)},p(t,i){i[0]&1048576&&Ao(e,t[20])},d(t){t&&Oe(e)}}}function bA(n){let e,t;return e=new V4({props:{$$slots:{default:[y5]},$$scope:{ctx:n}}}),{c(){Pn(e.$$.fragment)},l(i){Zn(e.$$.fragment,i)},m(i,r){Rn(e,i,r),t=!0},p(i,r){const a={};r[0]&2097152|r[2]&33554432&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Ke(e.$$.fragment,i),t=!0)},o(i){rt(e.$$.fragment,i),t=!1},d(i){Dn(e,i)}}}function y5(n){let e;return{c(){e=_r(n[21])},l(t){e=yr(t,n[21])},m(t,i){Tt(t,e,i)},p(t,i){i[0]&2097152&&Ao(e,t[21])},d(t){t&&Oe(e)}}}function v5(n){let e;const t=n[56].trailingIcon,i=Sr(t,n,n[87],lA);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a[2]&33554432)&&Cr(i,t,r,r[87],e?Mr(t,r[87],a,e5):Ar(r[87]),lA)},i(r){e||(Ke(i,r),e=!0)},o(r){rt(i,r),e=!1},d(r){i&&i.d(r)}}}function EA(n){let e,t;const i=[sr(n[46],"ripple$")];let r={};for(let a=0;a<i.length;a+=1)r=dn(r,i[a]);return e=new qL({props:r}),n[77](e),{c(){Pn(e.$$.fragment)},l(a){Zn(e.$$.fragment,a)},m(a,h){Rn(e,a,h),t=!0},p(a,h){const s=h[1]&32768?Gi(i,[kr(sr(a[46],"ripple$"))]):{};e.$set(s)},i(a){t||(Ke(e.$$.fragment,a),t=!0)},o(a){rt(e.$$.fragment,a),t=!1},d(a){n[77](null),Dn(e,a)}}}function wA(n){let e,t;const i=[sr(n[46],"helperLine$")];let r={$$slots:{default:[x5]},$$scope:{ctx:n}};for(let a=0;a<i.length;a+=1)r=dn(r,i[a]);return e=new z4({props:r}),e.$on("SMUITextfieldHelperText:id",n[41]),e.$on("SMUITextfieldHelperText:mount",n[42]),e.$on("SMUITextfieldHelperText:unmount",n[85]),e.$on("SMUITextfieldCharacterCounter:mount",n[40]),e.$on("SMUITextfieldCharacterCounter:unmount",n[86]),{c(){Pn(e.$$.fragment)},l(a){Zn(e.$$.fragment,a)},m(a,h){Rn(e,a,h),t=!0},p(a,h){const s=h[1]&32768?Gi(i,[kr(sr(a[46],"helperLine$"))]):{};h[2]&33554432&&(s.$$scope={dirty:h,ctx:a}),e.$set(s)},i(a){t||(Ke(e.$$.fragment,a),t=!0)},o(a){rt(e.$$.fragment,a),t=!1},d(a){Dn(e,a)}}}function x5(n){let e;const t=n[56].helper,i=Sr(t,n,n[87],iA);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a[2]&33554432)&&Cr(i,t,r,r[87],e?Mr(t,r[87],a,Y4):Ar(r[87]),iA)},i(r){e||(Ke(i,r),e=!0)},o(r){rt(i,r),e=!1},d(r){i&&i.d(r)}}}function b5(n){let e,t,i,r,a;const h=[l5,a5],s=[];function p(I,C){return I[36]?0:1}e=p(n),t=s[e]=h[e](n);let x=n[47].helper&&wA(n);return{c(){t.c(),i=qn(),x&&x.c(),r=Ei()},l(I){t.l(I),i=Hn(I),x&&x.l(I),r=Ei()},m(I,C){s[e].m(I,C),Tt(I,i,C),x&&x.m(I,C),Tt(I,r,C),a=!0},p(I,C){t.p(I,C),I[47].helper?x?(x.p(I,C),C[1]&65536&&Ke(x,1)):(x=wA(I),x.c(),Ke(x,1),x.m(r.parentNode,r)):x&&(vr(),rt(x,1,1,()=>{x=null}),xr())},i(I){a||(Ke(t),Ke(x),a=!0)},o(I){rt(t),rt(x),a=!1},d(I){s[e].d(I),I&&Oe(i),x&&x.d(I),I&&Oe(r)}}}const IA=([n,e])=>`${n}: ${e};`,TA=([n,e])=>`${n}: ${e};`;function E5(n,e,t){let i;const r=["use","class","style","ripple","disabled","required","textarea","variant","noLabel","label","type","value","files","invalid","updateInvalid","dirty","prefix","suffix","validateOnValueChange","useNativeValidation","withLeadingIcon","withTrailingIcon","input","floatingLabel","lineRipple","notchedOutline","focus","blur","layout","getElement"];let a=Ji(e,r),{$$slots:h={},$$scope:s}=e;const p=rM(h),{applyPassive:x}=fM,I=Uo(zo());let C=()=>{};function M(ge){return ge===C}let{use:O=[]}=e,{class:k=""}=e,{style:z=""}=e,{ripple:G=!0}=e,{disabled:q=!1}=e,{required:Z=!1}=e,{textarea:K=!1}=e,{variant:te=K?"outlined":"standard"}=e,{noLabel:ie=!1}=e,{label:Te=void 0}=e,{type:le="text"}=e,{value:fe=a.input$emptyValueUndefined?void 0:C}=e,{files:Fe=C}=e;const Ne=!M(fe)||!M(Fe);M(fe)&&(fe=void 0),M(Fe)&&(Fe=null);let{invalid:Ue=C}=e,{updateInvalid:dt=M(Ue)}=e;M(Ue)&&(Ue=!1);let{dirty:Ge=!1}=e,{prefix:Le=void 0}=e,{suffix:nt=void 0}=e,{validateOnValueChange:zt=dt}=e,{useNativeValidation:Ot=dt}=e,{withLeadingIcon:et=C}=e,{withTrailingIcon:Ze=C}=e,{input:At=void 0}=e,{floatingLabel:Kt=void 0}=e,{lineRipple:sn=void 0}=e,{notchedOutline:zn=void 0}=e,ri,Yt,ii={},kn={},on,Di=!1,Ut=Ws("SMUI:addLayoutListener"),Nt,Gn,Ci=new Promise(ge=>Gn=ge),ln,Mt,Un,ti,jr=fe;Ut&&(Nt=Ut(kt)),Ll(()=>{if(t(54,Yt=new L4({addClass:fi,removeClass:Kn,hasClass:Tn,registerTextFieldInteractionHandler:(ge,It)=>mn().addEventListener(ge,It),deregisterTextFieldInteractionHandler:(ge,It)=>mn().removeEventListener(ge,It),registerValidationAttributeChangeHandler:ge=>{const It=Vn=>Vn.map(je=>je.attributeName).filter(je=>je),vn=new MutationObserver(Vn=>{Ot&&ge(It(Vn))}),Wn={attributes:!0};return At&&vn.observe(At.getElement(),Wn),vn},deregisterValidationAttributeChangeHandler:ge=>{ge.disconnect()},getNativeInput:()=>{var ge;return(ge=At==null?void 0:At.getElement())!==null&&ge!==void 0?ge:null},setInputAttr:(ge,It)=>{At==null||At.addAttr(ge,It)},removeInputAttr:ge=>{At==null||At.removeAttr(ge)},isFocused:()=>document.activeElement===(At==null?void 0:At.getElement()),registerInputInteractionHandler:(ge,It)=>{At==null||At.getElement().addEventListener(ge,It,x())},deregisterInputInteractionHandler:(ge,It)=>{At==null||At.getElement().removeEventListener(ge,It,x())},floatLabel:ge=>Kt&&Kt.float(ge),getLabelWidth:()=>Kt?Kt.getWidth():0,hasLabel:()=>!!Kt,shakeLabel:ge=>Kt&&Kt.shake(ge),setLabelRequired:ge=>Kt&&Kt.setRequired(ge),activateLineRipple:()=>sn&&sn.activate(),deactivateLineRipple:()=>sn&&sn.deactivate(),setLineRippleTransformOrigin:ge=>sn&&sn.setRippleCenter(ge),closeOutline:()=>zn&&zn.closeNotch(),hasOutline:()=>!!zn,notchOutline:ge=>zn&&zn.notch(ge)},{get helperText(){return Un},get characterCounter(){return ti},get leadingIcon(){return ln},get trailingIcon(){return Mt}})),Ne){if(At==null)throw new Error("SMUI Textfield initialized without Input component.");Yt.init()}else SP().then(()=>{if(At==null)throw new Error("SMUI Textfield initialized without Input component.");Yt.init()});return Gn(),()=>{Yt.destroy()}}),pd(()=>{Nt&&Nt()});function Yr(ge){t(29,ln=ge.detail)}function hi(ge){t(30,Mt=ge.detail)}function Hi(ge){t(32,ti=ge.detail)}function or(ge){t(27,on=ge.detail)}function $e(ge){t(31,Un=ge.detail)}function Tn(ge){var It;return ge in ii?(It=ii[ge])!==null&&It!==void 0?It:null:mn().classList.contains(ge)}function fi(ge){ii[ge]||t(25,ii[ge]=!0,ii)}function Kn(ge){(!(ge in ii)||ii[ge])&&t(25,ii[ge]=!1,ii)}function pn(ge,It){kn[ge]!=It&&(It===""||It==null?(delete kn[ge],t(26,kn)):t(26,kn[ge]=It,kn))}function vi(){At==null||At.focus()}function Rs(){At==null||At.blur()}function kt(){if(Yt){const ge=Yt.shouldFloat;Yt.notchOutline(ge)}}function mn(){return ri}function jn(ge){$n[ge?"unshift":"push"](()=>{Kt=ge,t(5,Kt)})}function ki(ge){$n[ge?"unshift":"push"](()=>{Kt=ge,t(5,Kt)})}function Ds(ge){$n[ge?"unshift":"push"](()=>{zn=ge,t(7,zn)})}function io(ge){$n[ge?"unshift":"push"](()=>{At=ge,t(2,At)})}function oa(ge){fe=ge,t(0,fe)}function Vo(ge){Ge=ge,t(4,Ge)}function Os(ge){Ue=ge,t(1,Ue),t(54,Yt),t(19,dt)}const Mo=()=>t(28,Di=!1),qa=()=>t(28,Di=!0),ro=ge=>vs(ri,"blur",ge),Ia=ge=>vs(ri,"focus",ge);function Rl(ge){$n[ge?"unshift":"push"](()=>{At=ge,t(2,At)})}function Ha(ge){fe=ge,t(0,fe)}function aa(ge){Fe=ge,t(3,Fe)}function Wa(ge){Ge=ge,t(4,Ge)}function Bs(ge){Ue=ge,t(1,Ue),t(54,Yt),t(19,dt)}const Ta=()=>t(28,Di=!1),Zs=()=>t(28,Di=!0),Sa=ge=>vs(ri,"blur",ge),xe=ge=>vs(ri,"focus",ge);function Q(ge){$n[ge?"unshift":"push"](()=>{sn=ge,t(6,sn)})}function ne(ge){$n[ge?"unshift":"push"](()=>{ri=ge,t(24,ri)})}const ve=()=>t(29,ln=void 0),Ce=()=>t(30,Mt=void 0),Be=()=>t(32,ti=void 0);function st(ge){$n[ge?"unshift":"push"](()=>{ri=ge,t(24,ri)})}const tt=()=>t(29,ln=void 0),He=()=>t(30,Mt=void 0),ue=()=>{t(27,on=void 0),t(31,Un=void 0)},Ye=()=>t(32,ti=void 0);return n.$$set=ge=>{e=dn(dn({},e),So(ge)),t(46,a=Ji(e,r)),"use"in ge&&t(8,O=ge.use),"class"in ge&&t(9,k=ge.class),"style"in ge&&t(10,z=ge.style),"ripple"in ge&&t(11,G=ge.ripple),"disabled"in ge&&t(12,q=ge.disabled),"required"in ge&&t(13,Z=ge.required),"textarea"in ge&&t(14,K=ge.textarea),"variant"in ge&&t(15,te=ge.variant),"noLabel"in ge&&t(16,ie=ge.noLabel),"label"in ge&&t(17,Te=ge.label),"type"in ge&&t(18,le=ge.type),"value"in ge&&t(0,fe=ge.value),"files"in ge&&t(3,Fe=ge.files),"invalid"in ge&&t(1,Ue=ge.invalid),"updateInvalid"in ge&&t(19,dt=ge.updateInvalid),"dirty"in ge&&t(4,Ge=ge.dirty),"prefix"in ge&&t(20,Le=ge.prefix),"suffix"in ge&&t(21,nt=ge.suffix),"validateOnValueChange"in ge&&t(48,zt=ge.validateOnValueChange),"useNativeValidation"in ge&&t(49,Ot=ge.useNativeValidation),"withLeadingIcon"in ge&&t(22,et=ge.withLeadingIcon),"withTrailingIcon"in ge&&t(23,Ze=ge.withTrailingIcon),"input"in ge&&t(2,At=ge.input),"floatingLabel"in ge&&t(5,Kt=ge.floatingLabel),"lineRipple"in ge&&t(6,sn=ge.lineRipple),"notchedOutline"in ge&&t(7,zn=ge.notchedOutline),"$$scope"in ge&&t(87,s=ge.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&4&&t(33,i=At&&At.getElement()),n.$$.dirty[0]&524290|n.$$.dirty[1]&8388608&&Yt&&Yt.isValid()!==!Ue&&(dt?t(1,Ue=!Yt.isValid()):Yt.setValid(!Ue)),n.$$.dirty[1]&8519680&&Yt&&Yt.getValidateOnValueChange()!==zt&&Yt.setValidateOnValueChange(M(zt)?!1:zt),n.$$.dirty[1]&8650752&&Yt&&Yt.setUseNativeValidation(M(Ot)?!0:Ot),n.$$.dirty[0]&4096|n.$$.dirty[1]&8388608&&Yt&&Yt.setDisabled(q),n.$$.dirty[0]&1|n.$$.dirty[1]&25165824&&Yt&&Ne&&jr!==fe){t(55,jr=fe);const ge=`${fe}`;Yt.getValue()!==ge&&Yt.setValue(ge)}},[fe,Ue,At,Fe,Ge,Kt,sn,zn,O,k,z,G,q,Z,K,te,ie,Te,le,dt,Le,nt,et,Ze,ri,ii,kn,on,Di,ln,Mt,Un,ti,i,I,M,Ne,Ci,Yr,hi,Hi,or,$e,fi,Kn,pn,a,p,zt,Ot,vi,Rs,kt,mn,Yt,jr,h,jn,ki,Ds,io,oa,Vo,Os,Mo,qa,ro,Ia,Rl,Ha,aa,Wa,Bs,Ta,Zs,Sa,xe,Q,ne,ve,Ce,Be,st,tt,He,ue,Ye,s]}class w5 extends Fr{constructor(e){super(),Br(this,e,E5,b5,Lr,{use:8,class:9,style:10,ripple:11,disabled:12,required:13,textarea:14,variant:15,noLabel:16,label:17,type:18,value:0,files:3,invalid:1,updateInvalid:19,dirty:4,prefix:20,suffix:21,validateOnValueChange:48,useNativeValidation:49,withLeadingIcon:22,withTrailingIcon:23,input:2,floatingLabel:5,lineRipple:6,notchedOutline:7,focus:50,blur:51,layout:52,getElement:53},null,[-1,-1,-1,-1])}get focus(){return this.$$.ctx[50]}get blur(){return this.$$.ctx[51]}get layout(){return this.$$.ctx[52]}get getElement(){return this.$$.ctx[53]}}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var I5={ANCHOR:"mdc-menu-surface--anchor",ANIMATING_CLOSED:"mdc-menu-surface--animating-closed",ANIMATING_OPEN:"mdc-menu-surface--animating-open",FIXED:"mdc-menu-surface--fixed",IS_OPEN_BELOW:"mdc-menu-surface--is-open-below",OPEN:"mdc-menu-surface--open",ROOT:"mdc-menu-surface"},T5={CLOSED_EVENT:"MDCMenuSurface:closed",CLOSING_EVENT:"MDCMenuSurface:closing",OPENED_EVENT:"MDCMenuSurface:opened",OPENING_EVENT:"MDCMenuSurface:opening",FOCUSABLE_ELEMENTS:["button:not(:disabled)",'[href]:not([aria-disabled="true"])',"input:not(:disabled)","select:not(:disabled)","textarea:not(:disabled)",'[tabindex]:not([tabindex="-1"]):not([aria-disabled="true"])'].join(", ")},a1={TRANSITION_OPEN_DURATION:120,TRANSITION_CLOSE_DURATION:75,MARGIN_TO_EDGE:32,ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO:.67,TOUCH_EVENT_WAIT_MS:30},ya;(function(n){n[n.BOTTOM=1]="BOTTOM",n[n.CENTER=2]="CENTER",n[n.RIGHT=4]="RIGHT",n[n.FLIP_RTL=8]="FLIP_RTL"})(ya||(ya={}));var h_;(function(n){n[n.TOP_LEFT=0]="TOP_LEFT",n[n.TOP_RIGHT=4]="TOP_RIGHT",n[n.BOTTOM_LEFT=1]="BOTTOM_LEFT",n[n.BOTTOM_RIGHT=5]="BOTTOM_RIGHT",n[n.TOP_START=8]="TOP_START",n[n.TOP_END=12]="TOP_END",n[n.BOTTOM_START=9]="BOTTOM_START",n[n.BOTTOM_END=13]="BOTTOM_END"})(h_||(h_={}));/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Fm,qp,$r={LIST_ITEM_ACTIVATED_CLASS:"mdc-list-item--activated",LIST_ITEM_CLASS:"mdc-list-item",LIST_ITEM_DISABLED_CLASS:"mdc-list-item--disabled",LIST_ITEM_SELECTED_CLASS:"mdc-list-item--selected",LIST_ITEM_TEXT_CLASS:"mdc-list-item__text",LIST_ITEM_PRIMARY_TEXT_CLASS:"mdc-list-item__primary-text",ROOT:"mdc-list"};Fm={},Fm[""+$r.LIST_ITEM_ACTIVATED_CLASS]="mdc-list-item--activated",Fm[""+$r.LIST_ITEM_CLASS]="mdc-list-item",Fm[""+$r.LIST_ITEM_DISABLED_CLASS]="mdc-list-item--disabled",Fm[""+$r.LIST_ITEM_SELECTED_CLASS]="mdc-list-item--selected",Fm[""+$r.LIST_ITEM_PRIMARY_TEXT_CLASS]="mdc-list-item__primary-text",Fm[""+$r.ROOT]="mdc-list";var jy=(qp={},qp[""+$r.LIST_ITEM_ACTIVATED_CLASS]="mdc-deprecated-list-item--activated",qp[""+$r.LIST_ITEM_CLASS]="mdc-deprecated-list-item",qp[""+$r.LIST_ITEM_DISABLED_CLASS]="mdc-deprecated-list-item--disabled",qp[""+$r.LIST_ITEM_SELECTED_CLASS]="mdc-deprecated-list-item--selected",qp[""+$r.LIST_ITEM_TEXT_CLASS]="mdc-deprecated-list-item__text",qp[""+$r.LIST_ITEM_PRIMARY_TEXT_CLASS]="mdc-deprecated-list-item__primary-text",qp[""+$r.ROOT]="mdc-deprecated-list",qp),Bm={ACTION_EVENT:"MDCList:action",SELECTION_CHANGE_EVENT:"MDCList:selectionChange",ARIA_CHECKED:"aria-checked",ARIA_CHECKED_CHECKBOX_SELECTOR:'[role="checkbox"][aria-checked="true"]',ARIA_CHECKED_RADIO_SELECTOR:'[role="radio"][aria-checked="true"]',ARIA_CURRENT:"aria-current",ARIA_DISABLED:"aria-disabled",ARIA_ORIENTATION:"aria-orientation",ARIA_ORIENTATION_HORIZONTAL:"horizontal",ARIA_ROLE_CHECKBOX_SELECTOR:'[role="checkbox"]',ARIA_SELECTED:"aria-selected",ARIA_INTERACTIVE_ROLES_SELECTOR:'[role="listbox"], [role="menu"]',ARIA_MULTI_SELECTABLE_SELECTOR:'[aria-multiselectable="true"]',CHECKBOX_RADIO_SELECTOR:'input[type="checkbox"], input[type="radio"]',CHECKBOX_SELECTOR:'input[type="checkbox"]',CHILD_ELEMENTS_TO_TOGGLE_TABINDEX:`
    .`+$r.LIST_ITEM_CLASS+` button:not(:disabled),
    .`+$r.LIST_ITEM_CLASS+` a,
    .`+jy[$r.LIST_ITEM_CLASS]+` button:not(:disabled),
    .`+jy[$r.LIST_ITEM_CLASS]+` a
  `,DEPRECATED_SELECTOR:".mdc-deprecated-list",FOCUSABLE_CHILD_ELEMENTS:`
    .`+$r.LIST_ITEM_CLASS+` button:not(:disabled),
    .`+$r.LIST_ITEM_CLASS+` a,
    .`+$r.LIST_ITEM_CLASS+` input[type="radio"]:not(:disabled),
    .`+$r.LIST_ITEM_CLASS+` input[type="checkbox"]:not(:disabled),
    .`+jy[$r.LIST_ITEM_CLASS]+` button:not(:disabled),
    .`+jy[$r.LIST_ITEM_CLASS]+` a,
    .`+jy[$r.LIST_ITEM_CLASS]+` input[type="radio"]:not(:disabled),
    .`+jy[$r.LIST_ITEM_CLASS]+` input[type="checkbox"]:not(:disabled)
  `,RADIO_SELECTOR:'input[type="radio"]',SELECTED_ITEM_SELECTOR:'[aria-selected="true"], [aria-current="true"]'},_a={UNSET_INDEX:-1,TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS:300};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var S5=["input","button","textarea","select"],sf=function(n){var e=n.target;if(e){var t=(""+e.tagName).toLowerCase();S5.indexOf(t)===-1&&n.preventDefault()}};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function C5(){var n={bufferClearTimeout:0,currentFirstChar:"",sortedIndexCursor:0,typeaheadBuffer:""};return n}function A5(n,e){for(var t=new Map,i=0;i<n;i++){var r=e(i).trim();if(r){var a=r[0].toLowerCase();t.has(a)||t.set(a,[]),t.get(a).push({text:r.toLowerCase(),index:i})}}return t.forEach(function(h){h.sort(function(s,p){return s.index-p.index})}),t}function HT(n,e){var t=n.nextChar,i=n.focusItemAtIndex,r=n.sortedIndexByFirstChar,a=n.focusedItemIndex,h=n.skipFocus,s=n.isItemAtIndexDisabled;clearTimeout(e.bufferClearTimeout),e.bufferClearTimeout=setTimeout(function(){XL(e)},_a.TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS),e.typeaheadBuffer=e.typeaheadBuffer+t;var p;return e.typeaheadBuffer.length===1?p=M5(r,a,s,e):p=L5(r,s,e),p!==-1&&!h&&i(p),p}function M5(n,e,t,i){var r=i.typeaheadBuffer[0],a=n.get(r);if(!a)return-1;if(r===i.currentFirstChar&&a[i.sortedIndexCursor].index===e){i.sortedIndexCursor=(i.sortedIndexCursor+1)%a.length;var h=a[i.sortedIndexCursor].index;if(!t(h))return h}i.currentFirstChar=r;var s=-1,p;for(p=0;p<a.length;p++)if(!t(a[p].index)){s=p;break}for(;p<a.length;p++)if(a[p].index>e&&!t(a[p].index)){s=p;break}return s!==-1?(i.sortedIndexCursor=s,a[i.sortedIndexCursor].index):-1}function L5(n,e,t){var i=t.typeaheadBuffer[0],r=n.get(i);if(!r)return-1;var a=r[t.sortedIndexCursor];if(a.text.lastIndexOf(t.typeaheadBuffer,0)===0&&!e(a.index))return a.index;for(var h=(t.sortedIndexCursor+1)%r.length,s=-1;h!==t.sortedIndexCursor;){var p=r[h],x=p.text.lastIndexOf(t.typeaheadBuffer,0)===0,I=!e(p.index);if(x&&I){s=h;break}h=(h+1)%r.length}return s!==-1?(t.sortedIndexCursor=s,r[t.sortedIndexCursor].index):-1}function WL(n){return n.typeaheadBuffer.length>0}function XL(n){n.typeaheadBuffer=""}function SA(n,e){var t=n.event,i=n.isTargetListItem,r=n.focusedItemIndex,a=n.focusItemAtIndex,h=n.sortedIndexByFirstChar,s=n.isItemAtIndexDisabled,p=va(t)==="ArrowLeft",x=va(t)==="ArrowUp",I=va(t)==="ArrowRight",C=va(t)==="ArrowDown",M=va(t)==="Home",O=va(t)==="End",k=va(t)==="Enter",z=va(t)==="Spacebar";if(t.altKey||t.ctrlKey||t.metaKey||p||x||I||C||M||O||k)return-1;var G=!z&&t.key.length===1;if(G){sf(t);var q={focusItemAtIndex:a,focusedItemIndex:r,nextChar:t.key.toLowerCase(),sortedIndexByFirstChar:h,skipFocus:!1,isItemAtIndexDisabled:s};return HT(q,e)}if(!z)return-1;i&&sf(t);var Z=i&&WL(e);if(Z){var q={focusItemAtIndex:a,focusedItemIndex:r,nextChar:" ",sortedIndexByFirstChar:h,skipFocus:!1,isItemAtIndexDisabled:s};return HT(q,e)}return-1}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function P5(n){return n instanceof Array}var R5=["Alt","Control","Meta","Shift"];function CA(n){var e=new Set(n?R5.filter(function(t){return n.getModifierState(t)}):[]);return function(t){return t.every(function(i){return e.has(i)})&&t.length===e.size}}var D5=function(n){Eh(e,n);function e(t){var i=n.call(this,ks(ks({},e.defaultAdapter),t))||this;return i.wrapFocus=!1,i.isVertical=!0,i.isSingleSelectionList=!1,i.areDisabledItemsFocusable=!0,i.selectedIndex=_a.UNSET_INDEX,i.focusedItemIndex=_a.UNSET_INDEX,i.useActivatedClass=!1,i.useSelectedAttr=!1,i.ariaCurrentAttrValue=null,i.isCheckboxList=!1,i.isRadioList=!1,i.lastSelectedIndex=null,i.hasTypeahead=!1,i.typeaheadState=C5(),i.sortedIndexByFirstChar=new Map,i}return Object.defineProperty(e,"strings",{get:function(){return Bm},enumerable:!1,configurable:!0}),Object.defineProperty(e,"cssClasses",{get:function(){return $r},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return _a},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClassForElementIndex:function(){},focusItemAtIndex:function(){},getAttributeForElementIndex:function(){return null},getFocusedElementIndex:function(){return 0},getListItemCount:function(){return 0},hasCheckboxAtIndex:function(){return!1},hasRadioAtIndex:function(){return!1},isCheckboxCheckedAtIndex:function(){return!1},isFocusInsideList:function(){return!1},isRootFocused:function(){return!1},listItemAtIndexHasClass:function(){return!1},notifyAction:function(){},notifySelectionChange:function(){},removeClassForElementIndex:function(){},setAttributeForElementIndex:function(){},setCheckedCheckboxOrRadioAtIndex:function(){},setTabIndexForListItemChildren:function(){},getPrimaryTextAtIndex:function(){return""}}},enumerable:!1,configurable:!0}),e.prototype.layout=function(){this.adapter.getListItemCount()!==0&&(this.adapter.hasCheckboxAtIndex(0)?this.isCheckboxList=!0:this.adapter.hasRadioAtIndex(0)?this.isRadioList=!0:this.maybeInitializeSingleSelection(),this.hasTypeahead&&(this.sortedIndexByFirstChar=this.typeaheadInitSortedIndex()))},e.prototype.getFocusedItemIndex=function(){return this.focusedItemIndex},e.prototype.setWrapFocus=function(t){this.wrapFocus=t},e.prototype.setVerticalOrientation=function(t){this.isVertical=t},e.prototype.setSingleSelection=function(t){this.isSingleSelectionList=t,t&&(this.maybeInitializeSingleSelection(),this.selectedIndex=this.getSelectedIndexFromDOM())},e.prototype.setDisabledItemsFocusable=function(t){this.areDisabledItemsFocusable=t},e.prototype.maybeInitializeSingleSelection=function(){var t=this.getSelectedIndexFromDOM();if(t!==_a.UNSET_INDEX){var i=this.adapter.listItemAtIndexHasClass(t,$r.LIST_ITEM_ACTIVATED_CLASS);i&&this.setUseActivatedClass(!0),this.isSingleSelectionList=!0,this.selectedIndex=t}},e.prototype.getSelectedIndexFromDOM=function(){for(var t=_a.UNSET_INDEX,i=this.adapter.getListItemCount(),r=0;r<i;r++){var a=this.adapter.listItemAtIndexHasClass(r,$r.LIST_ITEM_SELECTED_CLASS),h=this.adapter.listItemAtIndexHasClass(r,$r.LIST_ITEM_ACTIVATED_CLASS);if(a||h){t=r;break}}return t},e.prototype.setHasTypeahead=function(t){this.hasTypeahead=t,t&&(this.sortedIndexByFirstChar=this.typeaheadInitSortedIndex())},e.prototype.isTypeaheadInProgress=function(){return this.hasTypeahead&&WL(this.typeaheadState)},e.prototype.setUseActivatedClass=function(t){this.useActivatedClass=t},e.prototype.setUseSelectedAttribute=function(t){this.useSelectedAttr=t},e.prototype.getSelectedIndex=function(){return this.selectedIndex},e.prototype.setSelectedIndex=function(t,i){i===void 0&&(i={}),this.isIndexValid(t)&&(this.isCheckboxList?this.setCheckboxAtIndex(t,i):this.isRadioList?this.setRadioAtIndex(t,i):this.setSingleSelectionAtIndex(t,i))},e.prototype.handleFocusIn=function(t){t>=0&&(this.focusedItemIndex=t,this.adapter.setAttributeForElementIndex(t,"tabindex","0"),this.adapter.setTabIndexForListItemChildren(t,"0"))},e.prototype.handleFocusOut=function(t){var i=this;t>=0&&(this.adapter.setAttributeForElementIndex(t,"tabindex","-1"),this.adapter.setTabIndexForListItemChildren(t,"-1")),setTimeout(function(){i.adapter.isFocusInsideList()||i.setTabindexToFirstSelectedOrFocusedItem()},0)},e.prototype.isIndexDisabled=function(t){return this.adapter.listItemAtIndexHasClass(t,$r.LIST_ITEM_DISABLED_CLASS)},e.prototype.handleKeydown=function(t,i,r){var a=this,h,s=va(t)==="ArrowLeft",p=va(t)==="ArrowUp",x=va(t)==="ArrowRight",I=va(t)==="ArrowDown",C=va(t)==="Home",M=va(t)==="End",O=va(t)==="Enter",k=va(t)==="Spacebar",z=this.isVertical&&I||!this.isVertical&&x,G=this.isVertical&&p||!this.isVertical&&s,q=t.key==="A"||t.key==="a",Z=CA(t);if(this.adapter.isRootFocused()){if((G||M)&&Z([]))t.preventDefault(),this.focusLastElement();else if((z||C)&&Z([]))t.preventDefault(),this.focusFirstElement();else if(G&&Z(["Shift"])&&this.isCheckboxList){t.preventDefault();var K=this.focusLastElement();K!==-1&&this.setSelectedIndexOnAction(K,!1)}else if(z&&Z(["Shift"])&&this.isCheckboxList){t.preventDefault();var K=this.focusFirstElement();K!==-1&&this.setSelectedIndexOnAction(K,!1)}if(this.hasTypeahead){var te={event:t,focusItemAtIndex:function(le){a.focusItemAtIndex(le)},focusedItemIndex:-1,isTargetListItem:i,sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:function(le){return a.isIndexDisabled(le)}};SA(te,this.typeaheadState)}return}var ie=this.adapter.getFocusedElementIndex();if(!(ie===-1&&(ie=r,ie<0))){if(z&&Z([]))sf(t),this.focusNextElement(ie);else if(G&&Z([]))sf(t),this.focusPrevElement(ie);else if(z&&Z(["Shift"])&&this.isCheckboxList){sf(t);var K=this.focusNextElement(ie);K!==-1&&this.setSelectedIndexOnAction(K,!1)}else if(G&&Z(["Shift"])&&this.isCheckboxList){sf(t);var K=this.focusPrevElement(ie);K!==-1&&this.setSelectedIndexOnAction(K,!1)}else if(C&&Z([]))sf(t),this.focusFirstElement();else if(M&&Z([]))sf(t),this.focusLastElement();else if(C&&Z(["Control","Shift"])&&this.isCheckboxList){if(sf(t),this.isIndexDisabled(ie))return;this.focusFirstElement(),this.toggleCheckboxRange(0,ie,ie)}else if(M&&Z(["Control","Shift"])&&this.isCheckboxList){if(sf(t),this.isIndexDisabled(ie))return;this.focusLastElement(),this.toggleCheckboxRange(ie,this.adapter.getListItemCount()-1,ie)}else if(q&&Z(["Control"])&&this.isCheckboxList)t.preventDefault(),this.checkboxListToggleAll(this.selectedIndex===_a.UNSET_INDEX?[]:this.selectedIndex,!0);else if((O||k)&&Z([])){if(i){var Te=t.target;if(Te&&Te.tagName==="A"&&O||(sf(t),this.isIndexDisabled(ie)))return;this.isTypeaheadInProgress()||(this.isSelectableList()&&this.setSelectedIndexOnAction(ie,!1),this.adapter.notifyAction(ie))}}else if((O||k)&&Z(["Shift"])&&this.isCheckboxList){var Te=t.target;if(Te&&Te.tagName==="A"&&O||(sf(t),this.isIndexDisabled(ie)))return;this.isTypeaheadInProgress()||(this.toggleCheckboxRange((h=this.lastSelectedIndex)!==null&&h!==void 0?h:ie,ie,ie),this.adapter.notifyAction(ie))}if(this.hasTypeahead){var te={event:t,focusItemAtIndex:function(fe){a.focusItemAtIndex(fe)},focusedItemIndex:this.focusedItemIndex,isTargetListItem:i,sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:function(fe){return a.isIndexDisabled(fe)}};SA(te,this.typeaheadState)}}},e.prototype.handleClick=function(t,i,r){var a,h=CA(r);t!==_a.UNSET_INDEX&&(this.isIndexDisabled(t)||(h([])?(this.isSelectableList()&&this.setSelectedIndexOnAction(t,i),this.adapter.notifyAction(t)):this.isCheckboxList&&h(["Shift"])&&(this.toggleCheckboxRange((a=this.lastSelectedIndex)!==null&&a!==void 0?a:t,t,t),this.adapter.notifyAction(t))))},e.prototype.focusNextElement=function(t){var i=this.adapter.getListItemCount(),r=t,a=null;do{if(r++,r>=i)if(this.wrapFocus)r=0;else return t;if(r===a)return-1;a=a??r}while(!this.areDisabledItemsFocusable&&this.isIndexDisabled(r));return this.focusItemAtIndex(r),r},e.prototype.focusPrevElement=function(t){var i=this.adapter.getListItemCount(),r=t,a=null;do{if(r--,r<0)if(this.wrapFocus)r=i-1;else return t;if(r===a)return-1;a=a??r}while(!this.areDisabledItemsFocusable&&this.isIndexDisabled(r));return this.focusItemAtIndex(r),r},e.prototype.focusFirstElement=function(){return this.focusNextElement(-1)},e.prototype.focusLastElement=function(){return this.focusPrevElement(this.adapter.getListItemCount())},e.prototype.focusInitialElement=function(){var t=this.getFirstSelectedOrFocusedItemIndex();return this.focusItemAtIndex(t),t},e.prototype.setEnabled=function(t,i){this.isIndexValid(t,!1)&&(i?(this.adapter.removeClassForElementIndex(t,$r.LIST_ITEM_DISABLED_CLASS),this.adapter.setAttributeForElementIndex(t,Bm.ARIA_DISABLED,"false")):(this.adapter.addClassForElementIndex(t,$r.LIST_ITEM_DISABLED_CLASS),this.adapter.setAttributeForElementIndex(t,Bm.ARIA_DISABLED,"true")))},e.prototype.setSingleSelectionAtIndex=function(t,i){if(i===void 0&&(i={}),!(this.selectedIndex===t&&!i.forceUpdate)){var r=$r.LIST_ITEM_SELECTED_CLASS;this.useActivatedClass&&(r=$r.LIST_ITEM_ACTIVATED_CLASS),this.selectedIndex!==_a.UNSET_INDEX&&this.adapter.removeClassForElementIndex(this.selectedIndex,r),this.setAriaForSingleSelectionAtIndex(t),this.setTabindexAtIndex(t),t!==_a.UNSET_INDEX&&this.adapter.addClassForElementIndex(t,r),this.selectedIndex=t,i.isUserInteraction&&!i.forceUpdate&&this.adapter.notifySelectionChange([t])}},e.prototype.setAriaForSingleSelectionAtIndex=function(t){this.selectedIndex===_a.UNSET_INDEX&&(this.ariaCurrentAttrValue=this.adapter.getAttributeForElementIndex(t,Bm.ARIA_CURRENT));var i=this.ariaCurrentAttrValue!==null,r=i?Bm.ARIA_CURRENT:Bm.ARIA_SELECTED;if(this.selectedIndex!==_a.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex,r,"false"),t!==_a.UNSET_INDEX){var a=i?this.ariaCurrentAttrValue:"true";this.adapter.setAttributeForElementIndex(t,r,a)}},e.prototype.getSelectionAttribute=function(){return this.useSelectedAttr?Bm.ARIA_SELECTED:Bm.ARIA_CHECKED},e.prototype.setRadioAtIndex=function(t,i){i===void 0&&(i={});var r=this.getSelectionAttribute();this.adapter.setCheckedCheckboxOrRadioAtIndex(t,!0),!(this.selectedIndex===t&&!i.forceUpdate)&&(this.selectedIndex!==_a.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex,r,"false"),this.adapter.setAttributeForElementIndex(t,r,"true"),this.selectedIndex=t,i.isUserInteraction&&!i.forceUpdate&&this.adapter.notifySelectionChange([t]))},e.prototype.setCheckboxAtIndex=function(t,i){i===void 0&&(i={});for(var r=this.selectedIndex,a=i.isUserInteraction?new Set(r===_a.UNSET_INDEX?[]:r):null,h=this.getSelectionAttribute(),s=[],p=0;p<this.adapter.getListItemCount();p++){var x=a==null?void 0:a.has(p),I=t.indexOf(p)>=0;I!==x&&s.push(p),this.adapter.setCheckedCheckboxOrRadioAtIndex(p,I),this.adapter.setAttributeForElementIndex(p,h,I?"true":"false")}this.selectedIndex=t,i.isUserInteraction&&s.length&&this.adapter.notifySelectionChange(s)},e.prototype.toggleCheckboxRange=function(t,i,r){this.lastSelectedIndex=r;for(var a=new Set(this.selectedIndex===_a.UNSET_INDEX?[]:this.selectedIndex),h=!(a!=null&&a.has(r)),s=rC([t,i].sort(),2),p=s[0],x=s[1],I=this.getSelectionAttribute(),C=[],M=p;M<=x;M++)if(!this.isIndexDisabled(M)){var O=a.has(M);h!==O&&(C.push(M),this.adapter.setCheckedCheckboxOrRadioAtIndex(M,h),this.adapter.setAttributeForElementIndex(M,I,""+h),h?a.add(M):a.delete(M))}C.length&&(this.selectedIndex=VP([],rC(a)),this.adapter.notifySelectionChange(C))},e.prototype.setTabindexAtIndex=function(t){this.focusedItemIndex===_a.UNSET_INDEX&&t!==0?this.adapter.setAttributeForElementIndex(0,"tabindex","-1"):this.focusedItemIndex>=0&&this.focusedItemIndex!==t&&this.adapter.setAttributeForElementIndex(this.focusedItemIndex,"tabindex","-1"),!(this.selectedIndex instanceof Array)&&this.selectedIndex!==t&&this.adapter.setAttributeForElementIndex(this.selectedIndex,"tabindex","-1"),t!==_a.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(t,"tabindex","0")},e.prototype.isSelectableList=function(){return this.isSingleSelectionList||this.isCheckboxList||this.isRadioList},e.prototype.setTabindexToFirstSelectedOrFocusedItem=function(){var t=this.getFirstSelectedOrFocusedItemIndex();this.setTabindexAtIndex(t)},e.prototype.getFirstSelectedOrFocusedItemIndex=function(){return this.isSelectableList()?typeof this.selectedIndex=="number"&&this.selectedIndex!==_a.UNSET_INDEX?this.selectedIndex:P5(this.selectedIndex)&&this.selectedIndex.length>0?this.selectedIndex.reduce(function(t,i){return Math.min(t,i)}):0:Math.max(this.focusedItemIndex,0)},e.prototype.isIndexValid=function(t,i){var r=this;if(i===void 0&&(i=!0),t instanceof Array){if(!this.isCheckboxList&&i)throw new Error("MDCListFoundation: Array of index is only supported for checkbox based list");return t.length===0?!0:t.some(function(a){return r.isIndexInRange(a)})}else if(typeof t=="number"){if(this.isCheckboxList&&i)throw new Error("MDCListFoundation: Expected array of index for checkbox based list but got number: "+t);return this.isIndexInRange(t)||this.isSingleSelectionList&&t===_a.UNSET_INDEX}else return!1},e.prototype.isIndexInRange=function(t){var i=this.adapter.getListItemCount();return t>=0&&t<i},e.prototype.setSelectedIndexOnAction=function(t,i){this.lastSelectedIndex=t,this.isCheckboxList?(this.toggleCheckboxAtIndex(t,i),this.adapter.notifySelectionChange([t])):this.setSelectedIndex(t,{isUserInteraction:!0})},e.prototype.toggleCheckboxAtIndex=function(t,i){var r=this.getSelectionAttribute(),a=this.adapter.isCheckboxCheckedAtIndex(t),h;i?h=a:(h=!a,this.adapter.setCheckedCheckboxOrRadioAtIndex(t,h)),this.adapter.setAttributeForElementIndex(t,r,h?"true":"false");var s=this.selectedIndex===_a.UNSET_INDEX?[]:this.selectedIndex.slice();h?s.push(t):s=s.filter(function(p){return p!==t}),this.selectedIndex=s},e.prototype.focusItemAtIndex=function(t){this.adapter.focusItemAtIndex(t),this.focusedItemIndex=t},e.prototype.checkboxListToggleAll=function(t,i){var r=this.adapter.getListItemCount();if(t.length===r)this.setCheckboxAtIndex([],{isUserInteraction:i});else{for(var a=[],h=0;h<r;h++)(!this.isIndexDisabled(h)||t.indexOf(h)>-1)&&a.push(h);this.setCheckboxAtIndex(a,{isUserInteraction:i})}},e.prototype.typeaheadMatchItem=function(t,i,r){var a=this;r===void 0&&(r=!1);var h={focusItemAtIndex:function(s){a.focusItemAtIndex(s)},focusedItemIndex:i||this.focusedItemIndex,nextChar:t,sortedIndexByFirstChar:this.sortedIndexByFirstChar,skipFocus:r,isItemAtIndexDisabled:function(s){return a.isIndexDisabled(s)}};return HT(h,this.typeaheadState)},e.prototype.typeaheadInitSortedIndex=function(){return A5(this.adapter.getListItemCount(),this.adapter.getPrimaryTextAtIndex)},e.prototype.clearTypeaheadBuffer=function(){XL(this.typeaheadState)},e}(wh);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var ZL=function(n){Eh(e,n);function e(t){var i=n.call(this,ks(ks({},e.defaultAdapter),t))||this;return i.isSurfaceOpen=!1,i.isQuickOpen=!1,i.isHoistedElement=!1,i.isFixedPosition=!1,i.isHorizontallyCenteredOnViewport=!1,i.maxHeight=0,i.openBottomBias=0,i.openAnimationEndTimerId=0,i.closeAnimationEndTimerId=0,i.animationRequestId=0,i.anchorCorner=h_.TOP_START,i.originCorner=h_.TOP_START,i.anchorMargin={top:0,right:0,bottom:0,left:0},i.position={x:0,y:0},i}return Object.defineProperty(e,"cssClasses",{get:function(){return I5},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return T5},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return a1},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Corner",{get:function(){return h_},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},hasAnchor:function(){return!1},isElementInContainer:function(){return!1},isFocused:function(){return!1},isRtl:function(){return!1},getInnerDimensions:function(){return{height:0,width:0}},getAnchorDimensions:function(){return null},getWindowDimensions:function(){return{height:0,width:0}},getBodyDimensions:function(){return{height:0,width:0}},getWindowScroll:function(){return{x:0,y:0}},setPosition:function(){},setMaxHeight:function(){},setTransformOrigin:function(){},saveFocus:function(){},restoreFocus:function(){},notifyClose:function(){},notifyClosing:function(){},notifyOpen:function(){},notifyOpening:function(){}}},enumerable:!1,configurable:!0}),e.prototype.init=function(){var t=e.cssClasses,i=t.ROOT,r=t.OPEN;if(!this.adapter.hasClass(i))throw new Error(i+" class required in root element.");this.adapter.hasClass(r)&&(this.isSurfaceOpen=!0)},e.prototype.destroy=function(){clearTimeout(this.openAnimationEndTimerId),clearTimeout(this.closeAnimationEndTimerId),cancelAnimationFrame(this.animationRequestId)},e.prototype.setAnchorCorner=function(t){this.anchorCorner=t},e.prototype.flipCornerHorizontally=function(){this.originCorner=this.originCorner^ya.RIGHT},e.prototype.setAnchorMargin=function(t){this.anchorMargin.top=t.top||0,this.anchorMargin.right=t.right||0,this.anchorMargin.bottom=t.bottom||0,this.anchorMargin.left=t.left||0},e.prototype.setIsHoisted=function(t){this.isHoistedElement=t},e.prototype.setFixedPosition=function(t){this.isFixedPosition=t},e.prototype.isFixed=function(){return this.isFixedPosition},e.prototype.setAbsolutePosition=function(t,i){this.position.x=this.isFinite(t)?t:0,this.position.y=this.isFinite(i)?i:0},e.prototype.setIsHorizontallyCenteredOnViewport=function(t){this.isHorizontallyCenteredOnViewport=t},e.prototype.setQuickOpen=function(t){this.isQuickOpen=t},e.prototype.setMaxHeight=function(t){this.maxHeight=t},e.prototype.setOpenBottomBias=function(t){this.openBottomBias=t},e.prototype.isOpen=function(){return this.isSurfaceOpen},e.prototype.open=function(){var t=this;this.isSurfaceOpen||(this.adapter.notifyOpening(),this.adapter.saveFocus(),this.isQuickOpen?(this.isSurfaceOpen=!0,this.adapter.addClass(e.cssClasses.OPEN),this.dimensions=this.adapter.getInnerDimensions(),this.autoposition(),this.adapter.notifyOpen()):(this.adapter.addClass(e.cssClasses.ANIMATING_OPEN),this.animationRequestId=requestAnimationFrame(function(){t.dimensions=t.adapter.getInnerDimensions(),t.autoposition(),t.adapter.addClass(e.cssClasses.OPEN),t.openAnimationEndTimerId=setTimeout(function(){t.openAnimationEndTimerId=0,t.adapter.removeClass(e.cssClasses.ANIMATING_OPEN),t.adapter.notifyOpen()},a1.TRANSITION_OPEN_DURATION)}),this.isSurfaceOpen=!0))},e.prototype.close=function(t){var i=this;if(t===void 0&&(t=!1),!!this.isSurfaceOpen){if(this.adapter.notifyClosing(),this.isQuickOpen){this.isSurfaceOpen=!1,t||this.maybeRestoreFocus(),this.adapter.removeClass(e.cssClasses.OPEN),this.adapter.removeClass(e.cssClasses.IS_OPEN_BELOW),this.adapter.notifyClose();return}this.adapter.addClass(e.cssClasses.ANIMATING_CLOSED),requestAnimationFrame(function(){i.adapter.removeClass(e.cssClasses.OPEN),i.adapter.removeClass(e.cssClasses.IS_OPEN_BELOW),i.closeAnimationEndTimerId=setTimeout(function(){i.closeAnimationEndTimerId=0,i.adapter.removeClass(e.cssClasses.ANIMATING_CLOSED),i.adapter.notifyClose()},a1.TRANSITION_CLOSE_DURATION)}),this.isSurfaceOpen=!1,t||this.maybeRestoreFocus()}},e.prototype.handleBodyClick=function(t){var i=t.target;this.adapter.isElementInContainer(i)||this.close()},e.prototype.handleKeydown=function(t){var i=t.keyCode,r=t.key,a=r==="Escape"||i===27;a&&this.close()},e.prototype.autoposition=function(){var t;this.measurements=this.getAutoLayoutmeasurements();var i=this.getoriginCorner(),r=this.getMenuSurfaceMaxHeight(i),a=this.hasBit(i,ya.BOTTOM)?"bottom":"top",h=this.hasBit(i,ya.RIGHT)?"right":"left",s=this.getHorizontalOriginOffset(i),p=this.getVerticalOriginOffset(i),x=this.measurements,I=x.anchorSize,C=x.surfaceSize,M=(t={},t[h]=s,t[a]=p,t);I.width/C.width>a1.ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO&&(h="center"),(this.isHoistedElement||this.isFixedPosition)&&this.adjustPositionForHoistedElement(M),this.adapter.setTransformOrigin(h+" "+a),this.adapter.setPosition(M),this.adapter.setMaxHeight(r?r+"px":""),this.hasBit(i,ya.BOTTOM)||this.adapter.addClass(e.cssClasses.IS_OPEN_BELOW)},e.prototype.getAutoLayoutmeasurements=function(){var t=this.adapter.getAnchorDimensions(),i=this.adapter.getBodyDimensions(),r=this.adapter.getWindowDimensions(),a=this.adapter.getWindowScroll();return t||(t={top:this.position.y,right:this.position.x,bottom:this.position.y,left:this.position.x,width:0,height:0}),{anchorSize:t,bodySize:i,surfaceSize:this.dimensions,viewportDistance:{top:t.top,right:r.width-t.right,bottom:r.height-t.bottom,left:t.left},viewportSize:r,windowScroll:a}},e.prototype.getoriginCorner=function(){var t=this.originCorner,i=this.measurements,r=i.viewportDistance,a=i.anchorSize,h=i.surfaceSize,s=e.numbers.MARGIN_TO_EDGE,p=this.hasBit(this.anchorCorner,ya.BOTTOM),x,I;p?(x=r.top-s+this.anchorMargin.bottom,I=r.bottom-s-this.anchorMargin.bottom):(x=r.top-s+this.anchorMargin.top,I=r.bottom-s+a.height-this.anchorMargin.top);var C=I-h.height>0;!C&&x>I+this.openBottomBias&&(t=this.setBit(t,ya.BOTTOM));var M=this.adapter.isRtl(),O=this.hasBit(this.anchorCorner,ya.FLIP_RTL),k=this.hasBit(this.anchorCorner,ya.RIGHT)||this.hasBit(t,ya.RIGHT),z=!1;M&&O?z=!k:z=k;var G,q;z?(G=r.left+a.width+this.anchorMargin.right,q=r.right-this.anchorMargin.right):(G=r.left+this.anchorMargin.left,q=r.right+a.width-this.anchorMargin.left);var Z=G-h.width>0,K=q-h.width>0,te=this.hasBit(t,ya.FLIP_RTL)&&this.hasBit(t,ya.RIGHT);return K&&te&&M||!Z&&te?t=this.unsetBit(t,ya.RIGHT):(Z&&z&&M||Z&&!z&&k||!K&&G>=q)&&(t=this.setBit(t,ya.RIGHT)),t},e.prototype.getMenuSurfaceMaxHeight=function(t){if(this.maxHeight>0)return this.maxHeight;var i=this.measurements.viewportDistance,r=0,a=this.hasBit(t,ya.BOTTOM),h=this.hasBit(this.anchorCorner,ya.BOTTOM),s=e.numbers.MARGIN_TO_EDGE;return a?(r=i.top+this.anchorMargin.top-s,h||(r+=this.measurements.anchorSize.height)):(r=i.bottom-this.anchorMargin.bottom+this.measurements.anchorSize.height-s,h&&(r-=this.measurements.anchorSize.height)),r},e.prototype.getHorizontalOriginOffset=function(t){var i=this.measurements.anchorSize,r=this.hasBit(t,ya.RIGHT),a=this.hasBit(this.anchorCorner,ya.RIGHT);if(r){var h=a?i.width-this.anchorMargin.left:this.anchorMargin.right;return this.isHoistedElement||this.isFixedPosition?h-(this.measurements.viewportSize.width-this.measurements.bodySize.width):h}return a?i.width-this.anchorMargin.right:this.anchorMargin.left},e.prototype.getVerticalOriginOffset=function(t){var i=this.measurements.anchorSize,r=this.hasBit(t,ya.BOTTOM),a=this.hasBit(this.anchorCorner,ya.BOTTOM),h=0;return r?h=a?i.height-this.anchorMargin.top:-this.anchorMargin.bottom:h=a?i.height+this.anchorMargin.bottom:this.anchorMargin.top,h},e.prototype.adjustPositionForHoistedElement=function(t){var i,r,a=this.measurements,h=a.windowScroll,s=a.viewportDistance,p=a.surfaceSize,x=a.viewportSize,I=Object.keys(t);try{for(var C=Xl(I),M=C.next();!M.done;M=C.next()){var O=M.value,k=t[O]||0;if(this.isHorizontallyCenteredOnViewport&&(O==="left"||O==="right")){t[O]=(x.width-p.width)/2;continue}k+=s[O],this.isFixedPosition||(O==="top"?k+=h.y:O==="bottom"?k-=h.y:O==="left"?k+=h.x:k-=h.x),t[O]=k}}catch(z){i={error:z}}finally{try{M&&!M.done&&(r=C.return)&&r.call(C)}finally{if(i)throw i.error}}},e.prototype.maybeRestoreFocus=function(){var t=this,i=this.adapter.isFocused(),r=this.adapter.getOwnerDocument?this.adapter.getOwnerDocument():document,a=r.activeElement&&this.adapter.isElementInContainer(r.activeElement);(i||a)&&setTimeout(function(){t.adapter.restoreFocus()},a1.TOUCH_EVENT_WAIT_MS)},e.prototype.hasBit=function(t,i){return!!(t&i)},e.prototype.setBit=function(t,i){return t|i},e.prototype.unsetBit=function(t,i){return t^i},e.prototype.isFinite=function(t){return typeof t=="number"&&isFinite(t)},e}(wh);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var lv={MENU_SELECTED_LIST_ITEM:"mdc-menu-item--selected",MENU_SELECTION_GROUP:"mdc-menu__selection-group",ROOT:"mdc-menu"},qy={ARIA_CHECKED_ATTR:"aria-checked",ARIA_DISABLED_ATTR:"aria-disabled",CHECKBOX_SELECTOR:'input[type="checkbox"]',LIST_SELECTOR:".mdc-list,.mdc-deprecated-list",SELECTED_EVENT:"MDCMenu:selected",SKIP_RESTORE_FOCUS:"data-menu-item-skip-restore-focus"},O5={FOCUS_ROOT_INDEX:-1},ev;(function(n){n[n.NONE=0]="NONE",n[n.LIST_ROOT=1]="LIST_ROOT",n[n.FIRST_ITEM=2]="FIRST_ITEM",n[n.LAST_ITEM=3]="LAST_ITEM"})(ev||(ev={}));/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var N5=function(n){Eh(e,n);function e(t){var i=n.call(this,ks(ks({},e.defaultAdapter),t))||this;return i.closeAnimationEndTimerId=0,i.defaultFocusState=ev.LIST_ROOT,i.selectedIndex=-1,i}return Object.defineProperty(e,"cssClasses",{get:function(){return lv},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return qy},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return O5},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClassToElementAtIndex:function(){},removeClassFromElementAtIndex:function(){},addAttributeToElementAtIndex:function(){},removeAttributeFromElementAtIndex:function(){},getAttributeFromElementAtIndex:function(){return null},elementContainsClass:function(){return!1},closeSurface:function(){},getElementIndex:function(){return-1},notifySelected:function(){},getMenuItemCount:function(){return 0},focusItemAtIndex:function(){},focusListRoot:function(){},getSelectedSiblingOfItemAtIndex:function(){return-1},isSelectableItemAtIndex:function(){return!1}}},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){this.closeAnimationEndTimerId&&clearTimeout(this.closeAnimationEndTimerId),this.adapter.closeSurface()},e.prototype.handleKeydown=function(t){var i=t.key,r=t.keyCode,a=i==="Tab"||r===9;a&&this.adapter.closeSurface(!0)},e.prototype.handleItemAction=function(t){var i=this,r=this.adapter.getElementIndex(t);if(!(r<0)){this.adapter.notifySelected({index:r});var a=this.adapter.getAttributeFromElementAtIndex(r,qy.SKIP_RESTORE_FOCUS)==="true";this.adapter.closeSurface(a),this.closeAnimationEndTimerId=setTimeout(function(){var h=i.adapter.getElementIndex(t);h>=0&&i.adapter.isSelectableItemAtIndex(h)&&i.setSelectedIndex(h)},ZL.numbers.TRANSITION_CLOSE_DURATION)}},e.prototype.handleMenuSurfaceOpened=function(){switch(this.defaultFocusState){case ev.FIRST_ITEM:this.adapter.focusItemAtIndex(0);break;case ev.LAST_ITEM:this.adapter.focusItemAtIndex(this.adapter.getMenuItemCount()-1);break;case ev.NONE:break;default:this.adapter.focusListRoot();break}},e.prototype.setDefaultFocusState=function(t){this.defaultFocusState=t},e.prototype.getSelectedIndex=function(){return this.selectedIndex},e.prototype.setSelectedIndex=function(t){if(this.validatedIndex(t),!this.adapter.isSelectableItemAtIndex(t))throw new Error("MDCMenuFoundation: No selection group at specified index.");var i=this.adapter.getSelectedSiblingOfItemAtIndex(t);i>=0&&(this.adapter.removeAttributeFromElementAtIndex(i,qy.ARIA_CHECKED_ATTR),this.adapter.removeClassFromElementAtIndex(i,lv.MENU_SELECTED_LIST_ITEM)),this.adapter.addClassToElementAtIndex(t,lv.MENU_SELECTED_LIST_ITEM),this.adapter.addAttributeToElementAtIndex(t,qy.ARIA_CHECKED_ATTR,"true"),this.selectedIndex=t},e.prototype.setEnabled=function(t,i){this.validatedIndex(t),i?(this.adapter.removeClassFromElementAtIndex(t,$r.LIST_ITEM_DISABLED_CLASS),this.adapter.addAttributeToElementAtIndex(t,qy.ARIA_DISABLED_ATTR,"false")):(this.adapter.addClassToElementAtIndex(t,$r.LIST_ITEM_DISABLED_CLASS),this.adapter.addAttributeToElementAtIndex(t,qy.ARIA_DISABLED_ATTR,"true"))},e.prototype.validatedIndex=function(t){var i=this.adapter.getMenuItemCount(),r=t>=0&&t<i;if(!r)throw new Error("MDCMenuFoundation: No list item at specified index.")},e}(wh);/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Xo={ACTIVATED:"mdc-select--activated",DISABLED:"mdc-select--disabled",FOCUSED:"mdc-select--focused",INVALID:"mdc-select--invalid",MENU_INVALID:"mdc-select__menu--invalid",OUTLINED:"mdc-select--outlined",REQUIRED:"mdc-select--required",ROOT:"mdc-select",WITH_LEADING_ICON:"mdc-select--with-leading-icon"},gT={ARIA_CONTROLS:"aria-controls",ARIA_DESCRIBEDBY:"aria-describedby",ARIA_SELECTED_ATTR:"aria-selected",CHANGE_EVENT:"MDCSelect:change",HIDDEN_INPUT_SELECTOR:'input[type="hidden"]',LABEL_SELECTOR:".mdc-floating-label",LEADING_ICON_SELECTOR:".mdc-select__icon",LINE_RIPPLE_SELECTOR:".mdc-line-ripple",MENU_SELECTOR:".mdc-select__menu",OUTLINE_SELECTOR:".mdc-notched-outline",SELECTED_TEXT_SELECTOR:".mdc-select__selected-text",SELECT_ANCHOR_SELECTOR:".mdc-select__anchor",VALUE_ATTR:"data-value"},r_={LABEL_SCALE:.75,UNSET_INDEX:-1,CLICK_DEBOUNCE_TIMEOUT_MS:330};/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var k5=function(n){Eh(e,n);function e(t,i){i===void 0&&(i={});var r=n.call(this,ks(ks({},e.defaultAdapter),t))||this;return r.disabled=!1,r.isMenuOpen=!1,r.useDefaultValidation=!0,r.customValidity=!0,r.lastSelectedIndex=r_.UNSET_INDEX,r.clickDebounceTimeout=0,r.recentlyClicked=!1,r.leadingIcon=i.leadingIcon,r.helperText=i.helperText,r}return Object.defineProperty(e,"cssClasses",{get:function(){return Xo},enumerable:!1,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return r_},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return gT},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},activateBottomLine:function(){},deactivateBottomLine:function(){},getSelectedIndex:function(){return-1},setSelectedIndex:function(){},hasLabel:function(){return!1},floatLabel:function(){},getLabelWidth:function(){return 0},setLabelRequired:function(){},hasOutline:function(){return!1},notchOutline:function(){},closeOutline:function(){},setRippleCenter:function(){},notifyChange:function(){},setSelectedText:function(){},isSelectAnchorFocused:function(){return!1},getSelectAnchorAttr:function(){return""},setSelectAnchorAttr:function(){},removeSelectAnchorAttr:function(){},addMenuClass:function(){},removeMenuClass:function(){},openMenu:function(){},closeMenu:function(){},getAnchorElement:function(){return null},setMenuAnchorElement:function(){},setMenuAnchorCorner:function(){},setMenuWrapFocus:function(){},focusMenuItemAtIndex:function(){},getMenuItemCount:function(){return 0},getMenuItemValues:function(){return[]},getMenuItemTextAtIndex:function(){return""},isTypeaheadInProgress:function(){return!1},typeaheadMatchItem:function(){return-1}}},enumerable:!1,configurable:!0}),e.prototype.getSelectedIndex=function(){return this.adapter.getSelectedIndex()},e.prototype.setSelectedIndex=function(t,i,r){i===void 0&&(i=!1),r===void 0&&(r=!1),!(t>=this.adapter.getMenuItemCount())&&(t===r_.UNSET_INDEX?this.adapter.setSelectedText(""):this.adapter.setSelectedText(this.adapter.getMenuItemTextAtIndex(t).trim()),this.adapter.setSelectedIndex(t),i&&this.adapter.closeMenu(),!r&&this.lastSelectedIndex!==t&&this.handleChange(),this.lastSelectedIndex=t)},e.prototype.setValue=function(t,i){i===void 0&&(i=!1);var r=this.adapter.getMenuItemValues().indexOf(t);this.setSelectedIndex(r,!1,i)},e.prototype.getValue=function(){var t=this.adapter.getSelectedIndex(),i=this.adapter.getMenuItemValues();return t!==r_.UNSET_INDEX?i[t]:""},e.prototype.getDisabled=function(){return this.disabled},e.prototype.setDisabled=function(t){this.disabled=t,this.disabled?(this.adapter.addClass(Xo.DISABLED),this.adapter.closeMenu()):this.adapter.removeClass(Xo.DISABLED),this.leadingIcon&&this.leadingIcon.setDisabled(this.disabled),this.disabled?this.adapter.removeSelectAnchorAttr("tabindex"):this.adapter.setSelectAnchorAttr("tabindex","0"),this.adapter.setSelectAnchorAttr("aria-disabled",this.disabled.toString())},e.prototype.openMenu=function(){this.adapter.addClass(Xo.ACTIVATED),this.adapter.openMenu(),this.isMenuOpen=!0,this.adapter.setSelectAnchorAttr("aria-expanded","true")},e.prototype.setHelperTextContent=function(t){this.helperText&&this.helperText.setContent(t)},e.prototype.layout=function(){if(this.adapter.hasLabel()){var t=this.getValue().length>0,i=this.adapter.hasClass(Xo.FOCUSED),r=t||i,a=this.adapter.hasClass(Xo.REQUIRED);this.notchOutline(r),this.adapter.floatLabel(r),this.adapter.setLabelRequired(a)}},e.prototype.layoutOptions=function(){var t=this.adapter.getMenuItemValues(),i=t.indexOf(this.getValue());this.setSelectedIndex(i,!1,!0)},e.prototype.handleMenuOpened=function(){if(this.adapter.getMenuItemValues().length!==0){var t=this.getSelectedIndex(),i=t>=0?t:0;this.adapter.focusMenuItemAtIndex(i)}},e.prototype.handleMenuClosing=function(){this.adapter.setSelectAnchorAttr("aria-expanded","false")},e.prototype.handleMenuClosed=function(){this.adapter.removeClass(Xo.ACTIVATED),this.isMenuOpen=!1,this.adapter.isSelectAnchorFocused()||this.blur()},e.prototype.handleChange=function(){this.layout(),this.adapter.notifyChange(this.getValue());var t=this.adapter.hasClass(Xo.REQUIRED);t&&this.useDefaultValidation&&this.setValid(this.isValid())},e.prototype.handleMenuItemAction=function(t){this.setSelectedIndex(t,!0)},e.prototype.handleFocus=function(){this.adapter.addClass(Xo.FOCUSED),this.layout(),this.adapter.activateBottomLine()},e.prototype.handleBlur=function(){this.isMenuOpen||this.blur()},e.prototype.handleClick=function(t){if(!(this.disabled||this.recentlyClicked)){if(this.setClickDebounceTimeout(),this.isMenuOpen){this.adapter.closeMenu();return}this.adapter.setRippleCenter(t),this.openMenu()}},e.prototype.handleKeydown=function(t){if(!(this.isMenuOpen||!this.adapter.hasClass(Xo.FOCUSED))){var i=va(t)===br.ENTER,r=va(t)===br.SPACEBAR,a=va(t)===br.ARROW_UP,h=va(t)===br.ARROW_DOWN,s=t.ctrlKey||t.metaKey;if(!s&&(!r&&t.key&&t.key.length===1||r&&this.adapter.isTypeaheadInProgress())){var p=r?" ":t.key,x=this.adapter.typeaheadMatchItem(p,this.getSelectedIndex());x>=0&&this.setSelectedIndex(x),t.preventDefault();return}!i&&!r&&!a&&!h||(this.openMenu(),t.preventDefault())}},e.prototype.notchOutline=function(t){if(this.adapter.hasOutline()){var i=this.adapter.hasClass(Xo.FOCUSED);if(t){var r=r_.LABEL_SCALE,a=this.adapter.getLabelWidth()*r;this.adapter.notchOutline(a)}else i||this.adapter.closeOutline()}},e.prototype.setLeadingIconAriaLabel=function(t){this.leadingIcon&&this.leadingIcon.setAriaLabel(t)},e.prototype.setLeadingIconContent=function(t){this.leadingIcon&&this.leadingIcon.setContent(t)},e.prototype.getUseDefaultValidation=function(){return this.useDefaultValidation},e.prototype.setUseDefaultValidation=function(t){this.useDefaultValidation=t},e.prototype.setValid=function(t){this.useDefaultValidation||(this.customValidity=t),this.adapter.setSelectAnchorAttr("aria-invalid",(!t).toString()),t?(this.adapter.removeClass(Xo.INVALID),this.adapter.removeMenuClass(Xo.MENU_INVALID)):(this.adapter.addClass(Xo.INVALID),this.adapter.addMenuClass(Xo.MENU_INVALID)),this.syncHelperTextValidity(t)},e.prototype.isValid=function(){return this.useDefaultValidation&&this.adapter.hasClass(Xo.REQUIRED)&&!this.adapter.hasClass(Xo.DISABLED)?this.getSelectedIndex()!==r_.UNSET_INDEX&&(this.getSelectedIndex()!==0||!!this.getValue()):this.customValidity},e.prototype.setRequired=function(t){t?this.adapter.addClass(Xo.REQUIRED):this.adapter.removeClass(Xo.REQUIRED),this.adapter.setSelectAnchorAttr("aria-required",t.toString()),this.adapter.setLabelRequired(t)},e.prototype.getRequired=function(){return this.adapter.getSelectAnchorAttr("aria-required")==="true"},e.prototype.init=function(){var t=this.adapter.getAnchorElement();t&&(this.adapter.setMenuAnchorElement(t),this.adapter.setMenuAnchorCorner(h_.BOTTOM_START)),this.adapter.setMenuWrapFocus(!1),this.setDisabled(this.adapter.hasClass(Xo.DISABLED)),this.syncHelperTextValidity(!this.adapter.hasClass(Xo.INVALID)),this.layout(),this.layoutOptions()},e.prototype.blur=function(){this.adapter.removeClass(Xo.FOCUSED),this.layout(),this.adapter.deactivateBottomLine();var t=this.adapter.hasClass(Xo.REQUIRED);t&&this.useDefaultValidation&&this.setValid(this.isValid())},e.prototype.syncHelperTextValidity=function(t){if(this.helperText){this.helperText.setValidity(t);var i=this.helperText.isVisible(),r=this.helperText.getId();i&&r?this.adapter.setSelectAnchorAttr(gT.ARIA_DESCRIBEDBY,r):this.adapter.removeSelectAnchorAttr(gT.ARIA_DESCRIBEDBY)}},e.prototype.setClickDebounceTimeout=function(){var t=this;clearTimeout(this.clickDebounceTimeout),this.clickDebounceTimeout=setTimeout(function(){t.recentlyClicked=!1},r_.CLICK_DEBOUNCE_TIMEOUT_MS),this.recentlyClicked=!0},e}(wh);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var s_={ARIA_HIDDEN:"aria-hidden",ROLE:"role"},Hp={HELPER_TEXT_VALIDATION_MSG:"mdc-select-helper-text--validation-msg",HELPER_TEXT_VALIDATION_MSG_PERSISTENT:"mdc-select-helper-text--validation-msg-persistent"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var F5=function(n){Eh(e,n);function e(t){return n.call(this,ks(ks({},e.defaultAdapter),t))||this}return Object.defineProperty(e,"cssClasses",{get:function(){return Hp},enumerable:!1,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return s_},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setAttr:function(){},getAttr:function(){return null},removeAttr:function(){},setContent:function(){}}},enumerable:!1,configurable:!0}),e.prototype.getId=function(){return this.adapter.getAttr("id")},e.prototype.isVisible=function(){return this.adapter.getAttr(s_.ARIA_HIDDEN)!=="true"},e.prototype.setContent=function(t){this.adapter.setContent(t)},e.prototype.setValidation=function(t){t?this.adapter.addClass(Hp.HELPER_TEXT_VALIDATION_MSG):this.adapter.removeClass(Hp.HELPER_TEXT_VALIDATION_MSG)},e.prototype.setValidationMsgPersistent=function(t){t?this.adapter.addClass(Hp.HELPER_TEXT_VALIDATION_MSG_PERSISTENT):this.adapter.removeClass(Hp.HELPER_TEXT_VALIDATION_MSG_PERSISTENT)},e.prototype.getIsValidation=function(){return this.adapter.hasClass(Hp.HELPER_TEXT_VALIDATION_MSG)},e.prototype.getIsValidationMsgPersistent=function(){return this.adapter.hasClass(Hp.HELPER_TEXT_VALIDATION_MSG_PERSISTENT)},e.prototype.setValidity=function(t){var i=this.adapter.hasClass(Hp.HELPER_TEXT_VALIDATION_MSG);if(i){var r=this.adapter.hasClass(Hp.HELPER_TEXT_VALIDATION_MSG_PERSISTENT),a=!t||r;if(a){this.showToScreenReader(),t?this.adapter.removeAttr(s_.ROLE):this.adapter.setAttr(s_.ROLE,"alert");return}this.adapter.removeAttr(s_.ROLE),this.hide()}},e.prototype.showToScreenReader=function(){this.adapter.removeAttr(s_.ARIA_HIDDEN)},e.prototype.hide=function(){this.adapter.setAttr(s_.ARIA_HIDDEN,"true")},e}(wh);const{document:B5}=CP;function z5(n){let e,t,i,r,a,h,s,p;const x=n[34].default,I=Sr(x,n,n[33],null);let C=[{class:i=si({[n[1]]:!0,"mdc-menu-surface":!0,"mdc-menu-surface--fixed":n[4],"mdc-menu-surface--open":n[3],"smui-menu-surface--static":n[3],"mdc-menu-surface--fullwidth":n[5],...n[8]})},{style:r=Object.entries(n[9]).map(AA).concat([n[2]]).join(" ")},n[12]],M={};for(let O=0;O<C.length;O+=1)M=dn(M,C[O]);return{c(){e=qn(),t=un("div"),I&&I.c(),this.h()},l(O){e=Hn(O),t=cn(O,"DIV",{class:!0,style:!0});var k=_n(t);I&&I.l(k),k.forEach(Oe),this.h()},h(){Ki(t,M)},m(O,k){Tt(O,e,k),Tt(O,t,k),I&&I.m(t,null),n[35](t),h=!0,s||(p=[Vi(B5.body,"click",n[11],!0),tr(a=ra.call(null,t,n[0])),tr(n[10].call(null,t)),Vi(t,"keydown",function(){as(n[7]&&n[7].handleKeydown.bind(n[7]))&&(n[7]&&n[7].handleKeydown.bind(n[7])).apply(this,arguments)})],s=!0)},p(O,k){n=O,I&&I.p&&(!h||k[1]&4)&&Cr(I,x,n,n[33],h?Mr(x,n[33],k,null):Ar(n[33]),null),Ki(t,M=Gi(C,[(!h||k[0]&314&&i!==(i=si({[n[1]]:!0,"mdc-menu-surface":!0,"mdc-menu-surface--fixed":n[4],"mdc-menu-surface--open":n[3],"smui-menu-surface--static":n[3],"mdc-menu-surface--fullwidth":n[5],...n[8]})))&&{class:i},(!h||k[0]&516&&r!==(r=Object.entries(n[9]).map(AA).concat([n[2]]).join(" ")))&&{style:r},k[0]&4096&&n[12]])),a&&as(a.update)&&k[0]&1&&a.update.call(null,n[0])},i(O){h||(Ke(I,O),h=!0)},o(O){rt(I,O),h=!1},d(O){O&&Oe(e),O&&Oe(t),I&&I.d(O),n[35](null),s=!1,sa(p)}}}const AA=([n,e])=>`${n}: ${e};`;function U5(n,e,t){const i=["use","class","style","static","anchor","fixed","open","managed","fullWidth","quickOpen","anchorElement","anchorCorner","anchorMargin","maxHeight","horizontallyCenteredOnViewport","openBottomBias","neverRestoreFocus","isOpen","setOpen","setAbsolutePosition","setIsHoisted","isFixed","getElement"];let r=Ji(e,i),{$$slots:a={},$$scope:h}=e;var s,p,x;const I=Uo(zo());let{use:C=[]}=e,{class:M=""}=e,{style:O=""}=e,{static:k=!1}=e,{anchor:z=!0}=e,{fixed:G=!1}=e,{open:q=k}=e,{managed:Z=!1}=e,{fullWidth:K=!1}=e,{quickOpen:te=!1}=e,{anchorElement:ie=void 0}=e,{anchorCorner:Te=void 0}=e,{anchorMargin:le={top:0,right:0,bottom:0,left:0}}=e,{maxHeight:fe=0}=e,{horizontallyCenteredOnViewport:Fe=!1}=e,{openBottomBias:Ne=0}=e,{neverRestoreFocus:Ue=!1}=e,dt,Ge,Le={},nt={},zt;xo("SMUI:list:role","menu"),xo("SMUI:list:item:role","menuitem");const Ot=h_;Ll(()=>(t(7,Ge=new ZL({addClass:Ze,removeClass:At,hasClass:et,hasAnchor:()=>!!ie,notifyClose:()=>{Z||t(13,q=k),q||vs(dt,"SMUIMenuSurface:closed",void 0,void 0,!0)},notifyClosing:()=>{Z||t(13,q=k),q||vs(dt,"SMUIMenuSurface:closing",void 0,void 0,!0)},notifyOpen:()=>{Z||t(13,q=!0),q&&vs(dt,"SMUIMenuSurface:opened",void 0,void 0,!0)},notifyOpening:()=>{q||vs(dt,"SMUIMenuSurface:opening",void 0,void 0,!0)},isElementInContainer:Nt=>dt.contains(Nt),isRtl:()=>getComputedStyle(dt).getPropertyValue("direction")==="rtl",setTransformOrigin:Nt=>{t(9,nt["transform-origin"]=Nt,nt)},isFocused:()=>document.activeElement===dt,saveFocus:()=>{var Nt;zt=(Nt=document.activeElement)!==null&&Nt!==void 0?Nt:void 0},restoreFocus:()=>{!Ue&&(!dt||dt.contains(document.activeElement))&&zt&&document.contains(zt)&&"focus"in zt&&zt.focus()},getInnerDimensions:()=>({width:dt.offsetWidth,height:dt.offsetHeight}),getAnchorDimensions:()=>ie?ie.getBoundingClientRect():null,getWindowDimensions:()=>({width:window.innerWidth,height:window.innerHeight}),getBodyDimensions:()=>({width:document.body.clientWidth,height:document.body.clientHeight}),getWindowScroll:()=>({x:window.pageXOffset,y:window.pageYOffset}),setPosition:Nt=>{t(9,nt.left="left"in Nt?`${Nt.left}px`:"",nt),t(9,nt.right="right"in Nt?`${Nt.right}px`:"",nt),t(9,nt.top="top"in Nt?`${Nt.top}px`:"",nt),t(9,nt.bottom="bottom"in Nt?`${Nt.bottom}px`:"",nt)},setMaxHeight:Nt=>{t(9,nt["max-height"]=Nt,nt)}})),vs(dt,"SMUIMenuSurface:mount",{get open(){return q},set open(Nt){t(13,q=Nt)},closeProgrammatic:Kt}),Ge.init(),()=>{var Nt;const Gn=Ge.isHoistedElement;Ge.destroy(),Gn&&((Nt=dt.parentNode)===null||Nt===void 0||Nt.removeChild(dt))})),pd(()=>{var Ut;z&&dt&&((Ut=dt.parentElement)===null||Ut===void 0||Ut.classList.remove("mdc-menu-surface--anchor"))});function et(Ut){return Ut in Le?Le[Ut]:on().classList.contains(Ut)}function Ze(Ut){Le[Ut]||t(8,Le[Ut]=!0,Le)}function At(Ut){(!(Ut in Le)||Le[Ut])&&t(8,Le[Ut]=!1,Le)}function Kt(Ut){Ge.close(Ut),t(13,q=!1)}function sn(Ut){Ge&&q&&!Z&&Ge.handleBodyClick(Ut)}function zn(){return q}function ri(Ut){t(13,q=Ut)}function Yt(Ut,Nt){return Ge.setAbsolutePosition(Ut,Nt)}function ii(Ut){return Ge.setIsHoisted(Ut)}function kn(){return Ge.isFixed()}function on(){return dt}function Di(Ut){$n[Ut?"unshift":"push"](()=>{dt=Ut,t(6,dt)})}return n.$$set=Ut=>{e=dn(dn({},e),So(Ut)),t(12,r=Ji(e,i)),"use"in Ut&&t(0,C=Ut.use),"class"in Ut&&t(1,M=Ut.class),"style"in Ut&&t(2,O=Ut.style),"static"in Ut&&t(3,k=Ut.static),"anchor"in Ut&&t(15,z=Ut.anchor),"fixed"in Ut&&t(4,G=Ut.fixed),"open"in Ut&&t(13,q=Ut.open),"managed"in Ut&&t(16,Z=Ut.managed),"fullWidth"in Ut&&t(5,K=Ut.fullWidth),"quickOpen"in Ut&&t(17,te=Ut.quickOpen),"anchorElement"in Ut&&t(14,ie=Ut.anchorElement),"anchorCorner"in Ut&&t(18,Te=Ut.anchorCorner),"anchorMargin"in Ut&&t(19,le=Ut.anchorMargin),"maxHeight"in Ut&&t(20,fe=Ut.maxHeight),"horizontallyCenteredOnViewport"in Ut&&t(21,Fe=Ut.horizontallyCenteredOnViewport),"openBottomBias"in Ut&&t(22,Ne=Ut.openBottomBias),"neverRestoreFocus"in Ut&&t(23,Ue=Ut.neverRestoreFocus),"$$scope"in Ut&&t(33,h=Ut.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&1073774656|n.$$.dirty[1]&3&&dt&&z&&!(!(t(30,s=dt.parentElement)===null||s===void 0)&&s.classList.contains("mdc-menu-surface--anchor"))&&(t(31,p=dt.parentElement)===null||p===void 0||p.classList.add("mdc-menu-surface--anchor"),t(14,ie=t(32,x=dt.parentElement)!==null&&x!==void 0?x:void 0)),n.$$.dirty[0]&8320&&Ge&&Ge.isOpen()!==q&&(q?Ge.open():Ge.close()),n.$$.dirty[0]&131200&&Ge&&Ge.setQuickOpen(te),n.$$.dirty[0]&144&&Ge&&Ge.setFixedPosition(G),n.$$.dirty[0]&1048704&&Ge&&Ge.setMaxHeight(fe),n.$$.dirty[0]&2097280&&Ge&&Ge.setIsHorizontallyCenteredOnViewport(Fe),n.$$.dirty[0]&262272&&Ge&&Te!=null&&(typeof Te=="string"?Ge.setAnchorCorner(Ot[Te]):Ge.setAnchorCorner(Te)),n.$$.dirty[0]&524416&&Ge&&Ge.setAnchorMargin(le),n.$$.dirty[0]&4194432&&Ge&&Ge.setOpenBottomBias(Ne)},[C,M,O,k,G,K,dt,Ge,Le,nt,I,sn,r,q,ie,z,Z,te,Te,le,fe,Fe,Ne,Ue,zn,ri,Yt,ii,kn,on,s,p,x,h,a,Di]}class V5 extends Fr{constructor(e){super(),Br(this,e,U5,z5,Lr,{use:0,class:1,style:2,static:3,anchor:15,fixed:4,open:13,managed:16,fullWidth:5,quickOpen:17,anchorElement:14,anchorCorner:18,anchorMargin:19,maxHeight:20,horizontallyCenteredOnViewport:21,openBottomBias:22,neverRestoreFocus:23,isOpen:24,setOpen:25,setAbsolutePosition:26,setIsHoisted:27,isFixed:28,getElement:29},null,[-1,-1])}get isOpen(){return this.$$.ctx[24]}get setOpen(){return this.$$.ctx[25]}get setAbsolutePosition(){return this.$$.ctx[26]}get setIsHoisted(){return this.$$.ctx[27]}get isFixed(){return this.$$.ctx[28]}get getElement(){return this.$$.ctx[29]}}function G5(n,{addClass:e=i=>n.classList.add(i),removeClass:t=i=>n.classList.remove(i)}={}){return e("mdc-menu-surface--anchor"),{destroy(){t("mdc-menu-surface--anchor")}}}function j5(n){let e;const t=n[17].default,i=Sr(t,n,n[22],null);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a&4194304)&&Cr(i,t,r,r[22],e?Mr(t,r[22],a,null):Ar(r[22]),null)},i(r){e||(Ke(i,r),e=!0)},o(r){rt(i,r),e=!1},d(r){i&&i.d(r)}}}function q5(n){let e,t,i;const r=[{use:n[5]},{class:si({[n[1]]:!0,"mdc-menu":!0})},n[9]];function a(s){n[19](s)}let h={$$slots:{default:[j5]},$$scope:{ctx:n}};for(let s=0;s<r.length;s+=1)h=dn(h,r[s]);return n[0]!==void 0&&(h.open=n[0]),e=new V5({props:h}),n[18](e),$n.push(()=>ho(e,"open",a)),e.$on("SMUIMenuSurface:mount",n[7]),e.$on("SMUIList:mount",n[8]),e.$on("SMUIMenuSurface:opened",n[20]),e.$on("keydown",n[6]),e.$on("SMUIList:action",n[21]),{c(){Pn(e.$$.fragment)},l(s){Zn(e.$$.fragment,s)},m(s,p){Rn(e,s,p),i=!0},p(s,[p]){const x=p&546?Gi(r,[p&32&&{use:s[5]},p&2&&{class:si({[s[1]]:!0,"mdc-menu":!0})},p&512&&kr(s[9])]):{};p&4194304&&(x.$$scope={dirty:p,ctx:s}),!t&&p&1&&(t=!0,x.open=s[0],Eo(()=>t=!1)),e.$set(x)},i(s){i||(Ke(e.$$.fragment,s),i=!0)},o(s){rt(e.$$.fragment,s),i=!1},d(s){n[18](null),Dn(e,s)}}}function H5(n,e,t){let i;const r=["use","class","open","isOpen","setOpen","setDefaultFocusState","getSelectedIndex","getMenuSurface","getElement"];let a=Ji(e,r),{$$slots:h={},$$scope:s}=e;const{closest:p}=oS,x=Uo(zo());let{use:I=[]}=e,{class:C=""}=e,{open:M=!1}=e,O,k,z,G;Ll(()=>(t(3,k=new N5({addClassToElementAtIndex:(Le,nt)=>{G.addClassForElementIndex(Le,nt)},removeClassFromElementAtIndex:(Le,nt)=>{G.removeClassForElementIndex(Le,nt)},addAttributeToElementAtIndex:(Le,nt,zt)=>{G.setAttributeForElementIndex(Le,nt,zt)},removeAttributeFromElementAtIndex:(Le,nt)=>{G.removeAttributeForElementIndex(Le,nt)},getAttributeFromElementAtIndex:(Le,nt)=>G.getAttributeFromElementIndex(Le,nt),elementContainsClass:(Le,nt)=>Le.classList.contains(nt),closeSurface:Le=>{z.closeProgrammatic(Le),vs(Fe(),"SMUIMenu:closedProgrammatically")},getElementIndex:Le=>G.getOrderedList().map(nt=>nt.element).indexOf(Le),notifySelected:Le=>vs(Fe(),"SMUIMenu:selected",{index:Le.index,item:G.getOrderedList()[Le.index].element},void 0,!0),getMenuItemCount:()=>G.items.length,focusItemAtIndex:Le=>G.focusItemAtIndex(Le),focusListRoot:()=>"focus"in G.element&&G.element.focus(),isSelectableItemAtIndex:Le=>!!p(G.getOrderedList()[Le].element,`.${lv.MENU_SELECTION_GROUP}`),getSelectedSiblingOfItemAtIndex:Le=>{const nt=G.getOrderedList(),zt=p(nt[Le].element,`.${lv.MENU_SELECTION_GROUP}`),Ot=zt==null?void 0:zt.querySelector(`.${lv.MENU_SELECTED_LIST_ITEM}`);return Ot?nt.map(et=>et.element).indexOf(Ot):-1}})),vs(Fe(),"SMUIMenu:mount",k),k.init(),()=>{k.destroy()}));function q(Le){k&&k.handleKeydown(Le)}function Z(Le){z||(z=Le.detail)}function K(Le){G||t(4,G=Le.detail)}function te(){return M}function ie(Le){t(0,M=Le)}function Te(Le){k.setDefaultFocusState(Le)}function le(){return k.getSelectedIndex()}function fe(){return O}function Fe(){return O.getElement()}function Ne(Le){$n[Le?"unshift":"push"](()=>{O=Le,t(2,O)})}function Ue(Le){M=Le,t(0,M)}const dt=()=>k&&k.handleMenuSurfaceOpened(),Ge=Le=>k&&k.handleItemAction(G.getOrderedList()[Le.detail.index].element);return n.$$set=Le=>{e=dn(dn({},e),So(Le)),t(9,a=Ji(e,r)),"use"in Le&&t(10,I=Le.use),"class"in Le&&t(1,C=Le.class),"open"in Le&&t(0,M=Le.open),"$$scope"in Le&&t(22,s=Le.$$scope)},n.$$.update=()=>{n.$$.dirty&1024&&t(5,i=[x,...I])},[M,C,O,k,G,i,q,Z,K,a,I,te,ie,Te,le,fe,Fe,h,Ne,Ue,dt,Ge,s]}class W5 extends Fr{constructor(e){super(),Br(this,e,H5,q5,Lr,{use:10,class:1,open:0,isOpen:11,setOpen:12,setDefaultFocusState:13,getSelectedIndex:14,getMenuSurface:15,getElement:16})}get isOpen(){return this.$$.ctx[11]}get setOpen(){return this.$$.ctx[12]}get setDefaultFocusState(){return this.$$.ctx[13]}get getSelectedIndex(){return this.$$.ctx[14]}get getMenuSurface(){return this.$$.ctx[15]}get getElement(){return this.$$.ctx[16]}}function X5(n){let e;const t=n[42].default,i=Sr(t,n,n[44],null);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a[1]&8192)&&Cr(i,t,r,r[44],e?Mr(t,r[44],a,null):Ar(r[44]),null)},i(r){e||(Ke(i,r),e=!0)},o(r){rt(i,r),e=!1},d(r){i&&i.d(r)}}}function Z5(n){let e,t,i;const r=[{tag:n[13]},{use:[n[16],...n[0]]},{class:si({[n[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":n[2],"mdc-deprecated-list--dense":n[3],"mdc-deprecated-list--textual-list":n[4],"mdc-deprecated-list--avatar-list":n[5]||n[17],"mdc-deprecated-list--icon-list":n[6],"mdc-deprecated-list--image-list":n[7],"mdc-deprecated-list--thumbnail-list":n[8],"mdc-deprecated-list--video-list":n[9],"mdc-deprecated-list--two-line":n[10],"smui-list--three-line":n[11]&&!n[10]})},{role:n[15]},n[25]];var a=n[12];function h(s){let p={$$slots:{default:[X5]},$$scope:{ctx:s}};for(let x=0;x<r.length;x+=1)p=dn(p,r[x]);return{props:p}}return a&&(e=Tl(a,h(n)),n[43](e),e.$on("keydown",n[20]),e.$on("focusin",n[21]),e.$on("focusout",n[22]),e.$on("click",n[23]),e.$on("SMUIListItem:mount",n[18]),e.$on("SMUIListItem:unmount",n[19]),e.$on("SMUI:action",n[24])),{c(){e&&Pn(e.$$.fragment),t=Ei()},l(s){e&&Zn(e.$$.fragment,s),t=Ei()},m(s,p){e&&Rn(e,s,p),Tt(s,t,p),i=!0},p(s,p){const x=p[0]&33796095?Gi(r,[p[0]&8192&&{tag:s[13]},p[0]&65537&&{use:[s[16],...s[0]]},p[0]&135166&&{class:si({[s[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":s[2],"mdc-deprecated-list--dense":s[3],"mdc-deprecated-list--textual-list":s[4],"mdc-deprecated-list--avatar-list":s[5]||s[17],"mdc-deprecated-list--icon-list":s[6],"mdc-deprecated-list--image-list":s[7],"mdc-deprecated-list--thumbnail-list":s[8],"mdc-deprecated-list--video-list":s[9],"mdc-deprecated-list--two-line":s[10],"smui-list--three-line":s[11]&&!s[10]})},p[0]&32768&&{role:s[15]},p[0]&33554432&&kr(s[25])]):{};if(p[1]&8192&&(x.$$scope={dirty:p,ctx:s}),p[0]&4096&&a!==(a=s[12])){if(e){vr();const I=e;rt(I.$$.fragment,1,0,()=>{Dn(I,1)}),xr()}a?(e=Tl(a,h(s)),s[43](e),e.$on("keydown",s[20]),e.$on("focusin",s[21]),e.$on("focusout",s[22]),e.$on("click",s[23]),e.$on("SMUIListItem:mount",s[18]),e.$on("SMUIListItem:unmount",s[19]),e.$on("SMUI:action",s[24]),Pn(e.$$.fragment),Ke(e.$$.fragment,1),Rn(e,t.parentNode,t)):e=null}else a&&e.$set(x)},i(s){i||(e&&Ke(e.$$.fragment,s),i=!0)},o(s){e&&rt(e.$$.fragment,s),i=!1},d(s){n[43](null),s&&Oe(t),e&&Dn(e,s)}}}function Y5(n,e,t){const i=["use","class","nonInteractive","dense","textualList","avatarList","iconList","imageList","thumbnailList","videoList","twoLine","threeLine","vertical","wrapFocus","singleSelection","disabledItemsFocusable","selectedIndex","radioList","checkList","hasTypeahead","component","tag","layout","setEnabled","getTypeaheadInProgress","getSelectedIndex","getFocusedItemIndex","focusItemAtIndex","getElement"];let r=Ji(e,i),{$$slots:a={},$$scope:h}=e;var s;const{closest:p,matches:x}=oS,I=Uo(zo());let{use:C=[]}=e,{class:M=""}=e,{nonInteractive:O=!1}=e,{dense:k=!1}=e,{textualList:z=!1}=e,{avatarList:G=!1}=e,{iconList:q=!1}=e,{imageList:Z=!1}=e,{thumbnailList:K=!1}=e,{videoList:te=!1}=e,{twoLine:ie=!1}=e,{threeLine:Te=!1}=e,{vertical:le=!0}=e,{wrapFocus:fe=(s=Ws("SMUI:list:wrapFocus"))!==null&&s!==void 0?s:!1}=e,{singleSelection:Fe=!1}=e,{disabledItemsFocusable:Ne=!1}=e,{selectedIndex:Ue=-1}=e,{radioList:dt=!1}=e,{checkList:Ge=!1}=e,{hasTypeahead:Le=!1}=e,nt,zt,Ot=[],et=Ws("SMUI:list:role"),Ze=Ws("SMUI:list:nav");const At=new WeakMap;let Kt=Ws("SMUI:dialog:selection"),sn=Ws("SMUI:addLayoutListener"),zn,{component:ri=Oc}=e,{tag:Yt=ri===Oc?Ze?"nav":"ul":void 0}=e;xo("SMUI:list:nonInteractive",O),xo("SMUI:separator:context","list"),et||(Fe?(et="listbox",xo("SMUI:list:item:role","option")):dt?(et="radiogroup",xo("SMUI:list:item:role","radio")):Ge?(et="group",xo("SMUI:list:item:role","checkbox")):(et="list",xo("SMUI:list:item:role",void 0))),sn&&(zn=sn(or)),Ll(()=>{t(41,zt=new D5({addClassForElementIndex:Mt,focusItemAtIndex:pn,getAttributeForElementIndex:(mn,jn)=>{var ki,Ds;return(Ds=(ki=Ci()[mn])===null||ki===void 0?void 0:ki.getAttr(jn))!==null&&Ds!==void 0?Ds:null},getFocusedElementIndex:()=>document.activeElement?Ci().map(mn=>mn.element).indexOf(document.activeElement):-1,getListItemCount:()=>Ot.length,getPrimaryTextAtIndex:hi,hasCheckboxAtIndex:mn=>{var jn,ki;return(ki=(jn=Ci()[mn])===null||jn===void 0?void 0:jn.hasCheckbox)!==null&&ki!==void 0?ki:!1},hasRadioAtIndex:mn=>{var jn,ki;return(ki=(jn=Ci()[mn])===null||jn===void 0?void 0:jn.hasRadio)!==null&&ki!==void 0?ki:!1},isCheckboxCheckedAtIndex:mn=>{var jn;const ki=Ci()[mn];return(jn=(ki==null?void 0:ki.hasCheckbox)&&ki.checked)!==null&&jn!==void 0?jn:!1},isFocusInsideList:()=>nt!=null&&vi()!==document.activeElement&&vi().contains(document.activeElement),isRootFocused:()=>nt!=null&&document.activeElement===vi(),listItemAtIndexHasClass:ln,notifyAction:mn=>{t(26,Ue=mn),nt!=null&&vs(vi(),"SMUIList:action",{index:mn},void 0,!0)},notifySelectionChange:mn=>{nt!=null&&vs(vi(),"SMUIList:selectionChange",{changedIndices:mn})},removeClassForElementIndex:Un,setAttributeForElementIndex:ti,setCheckedCheckboxOrRadioAtIndex:(mn,jn)=>{Ci()[mn].checked=jn},setTabIndexForListItemChildren:(mn,jn)=>{const ki=Ci()[mn],Ds="button:not(:disabled), a";Array.prototype.forEach.call(ki.element.querySelectorAll(Ds),io=>{io.setAttribute("tabindex",jn)})}}));const kt={get element(){return vi()},get items(){return Ot},get typeaheadInProgress(){return zt.isTypeaheadInProgress()},typeaheadMatchItem(mn,jn){return zt.typeaheadMatchItem(mn,jn,!0)},getOrderedList:Ci,focusItemAtIndex:pn,addClassForElementIndex:Mt,removeClassForElementIndex:Un,setAttributeForElementIndex:ti,removeAttributeForElementIndex:jr,getAttributeFromElementIndex:Yr,getPrimaryTextAtIndex:hi};return vs(vi(),"SMUIList:mount",kt),zt.init(),zt.layout(),()=>{zt.destroy()}}),pd(()=>{zn&&zn()});function ii(kt){Ot.push(kt.detail),At.set(kt.detail.element,kt.detail),Fe&&kt.detail.selected&&t(26,Ue=Hi(kt.detail.element)),kt.stopPropagation()}function kn(kt){var mn;const jn=(mn=kt.detail&&Ot.indexOf(kt.detail))!==null&&mn!==void 0?mn:-1;jn!==-1&&(Ot.splice(jn,1),Ot=Ot,At.delete(kt.detail.element)),kt.stopPropagation()}function on(kt){zt&&kt.target&&zt.handleKeydown(kt,kt.target.classList.contains("mdc-deprecated-list-item"),Hi(kt.target))}function Di(kt){zt&&kt.target&&zt.handleFocusIn(Hi(kt.target))}function Ut(kt){zt&&kt.target&&zt.handleFocusOut(Hi(kt.target))}function Nt(kt){zt&&kt.target&&zt.handleClick(Hi(kt.target),!x(kt.target,'input[type="checkbox"], input[type="radio"]'),kt)}function Gn(kt){if(dt||Ge){const mn=Hi(kt.target);if(mn!==-1){const jn=Ci()[mn];jn&&(dt&&!jn.checked||Ge)&&(x(kt.detail.target,'input[type="checkbox"], input[type="radio"]')||(jn.checked=!jn.checked),jn.activateRipple(),window.requestAnimationFrame(()=>{jn.deactivateRipple()}))}}}function Ci(){return nt==null?[]:[...vi().children].map(kt=>At.get(kt)).filter(kt=>kt&&kt._smui_list_item_accessor)}function ln(kt,mn){var jn;const ki=Ci()[kt];return(jn=ki&&ki.hasClass(mn))!==null&&jn!==void 0?jn:!1}function Mt(kt,mn){const jn=Ci()[kt];jn&&jn.addClass(mn)}function Un(kt,mn){const jn=Ci()[kt];jn&&jn.removeClass(mn)}function ti(kt,mn,jn){const ki=Ci()[kt];ki&&ki.addAttr(mn,jn)}function jr(kt,mn){const jn=Ci()[kt];jn&&jn.removeAttr(mn)}function Yr(kt,mn){const jn=Ci()[kt];return jn?jn.getAttr(mn):null}function hi(kt){var mn;const jn=Ci()[kt];return(mn=jn&&jn.getPrimaryText())!==null&&mn!==void 0?mn:""}function Hi(kt){const mn=p(kt,".mdc-deprecated-list-item, .mdc-deprecated-list");return mn&&x(mn,".mdc-deprecated-list-item")?Ci().map(jn=>jn==null?void 0:jn.element).indexOf(mn):-1}function or(){return zt.layout()}function $e(kt,mn){return zt.setEnabled(kt,mn)}function Tn(){return zt.isTypeaheadInProgress()}function fi(){return zt.getSelectedIndex()}function Kn(){return zt.getFocusedItemIndex()}function pn(kt){const mn=Ci()[kt];mn&&"focus"in mn.element&&mn.element.focus()}function vi(){return nt.getElement()}function Rs(kt){$n[kt?"unshift":"push"](()=>{nt=kt,t(14,nt)})}return n.$$set=kt=>{e=dn(dn({},e),So(kt)),t(25,r=Ji(e,i)),"use"in kt&&t(0,C=kt.use),"class"in kt&&t(1,M=kt.class),"nonInteractive"in kt&&t(2,O=kt.nonInteractive),"dense"in kt&&t(3,k=kt.dense),"textualList"in kt&&t(4,z=kt.textualList),"avatarList"in kt&&t(5,G=kt.avatarList),"iconList"in kt&&t(6,q=kt.iconList),"imageList"in kt&&t(7,Z=kt.imageList),"thumbnailList"in kt&&t(8,K=kt.thumbnailList),"videoList"in kt&&t(9,te=kt.videoList),"twoLine"in kt&&t(10,ie=kt.twoLine),"threeLine"in kt&&t(11,Te=kt.threeLine),"vertical"in kt&&t(27,le=kt.vertical),"wrapFocus"in kt&&t(28,fe=kt.wrapFocus),"singleSelection"in kt&&t(29,Fe=kt.singleSelection),"disabledItemsFocusable"in kt&&t(30,Ne=kt.disabledItemsFocusable),"selectedIndex"in kt&&t(26,Ue=kt.selectedIndex),"radioList"in kt&&t(31,dt=kt.radioList),"checkList"in kt&&t(32,Ge=kt.checkList),"hasTypeahead"in kt&&t(33,Le=kt.hasTypeahead),"component"in kt&&t(12,ri=kt.component),"tag"in kt&&t(13,Yt=kt.tag),"$$scope"in kt&&t(44,h=kt.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&134217728|n.$$.dirty[1]&1024&&zt&&zt.setVerticalOrientation(le),n.$$.dirty[0]&268435456|n.$$.dirty[1]&1024&&zt&&zt.setWrapFocus(fe),n.$$.dirty[1]&1028&&zt&&zt.setHasTypeahead(Le),n.$$.dirty[0]&536870912|n.$$.dirty[1]&1024&&zt&&zt.setSingleSelection(Fe),n.$$.dirty[0]&1073741824|n.$$.dirty[1]&1024&&zt&&zt.setDisabledItemsFocusable(Ne),n.$$.dirty[0]&603979776|n.$$.dirty[1]&1024&&zt&&Fe&&fi()!==Ue&&zt.setSelectedIndex(Ue)},[C,M,O,k,z,G,q,Z,K,te,ie,Te,ri,Yt,nt,et,I,Kt,ii,kn,on,Di,Ut,Nt,Gn,r,Ue,le,fe,Fe,Ne,dt,Ge,Le,or,$e,Tn,fi,Kn,pn,vi,zt,a,Rs,h]}class K5 extends Fr{constructor(e){super(),Br(this,e,Y5,Z5,Lr,{use:0,class:1,nonInteractive:2,dense:3,textualList:4,avatarList:5,iconList:6,imageList:7,thumbnailList:8,videoList:9,twoLine:10,threeLine:11,vertical:27,wrapFocus:28,singleSelection:29,disabledItemsFocusable:30,selectedIndex:26,radioList:31,checkList:32,hasTypeahead:33,component:12,tag:13,layout:34,setEnabled:35,getTypeaheadInProgress:36,getSelectedIndex:37,getFocusedItemIndex:38,focusItemAtIndex:39,getElement:40},null,[-1,-1])}get layout(){return this.$$.ctx[34]}get setEnabled(){return this.$$.ctx[35]}get getTypeaheadInProgress(){return this.$$.ctx[36]}get getSelectedIndex(){return this.$$.ctx[37]}get getFocusedItemIndex(){return this.$$.ctx[38]}get focusItemAtIndex(){return this.$$.ctx[39]}get getElement(){return this.$$.ctx[40]}}function MA(n){let e;return{c(){e=un("span"),this.h()},l(t){e=cn(t,"SPAN",{class:!0}),_n(e).forEach(Oe),this.h()},h(){tn(e,"class","mdc-deprecated-list-item__ripple")},m(t,i){Tt(t,e,i)},d(t){t&&Oe(e)}}}function J5(n){let e,t,i=n[7]&&MA();const r=n[34].default,a=Sr(r,n,n[37],null);return{c(){i&&i.c(),e=Ei(),a&&a.c()},l(h){i&&i.l(h),e=Ei(),a&&a.l(h)},m(h,s){i&&i.m(h,s),Tt(h,e,s),a&&a.m(h,s),t=!0},p(h,s){h[7]?i||(i=MA(),i.c(),i.m(e.parentNode,e)):i&&(i.d(1),i=null),a&&a.p&&(!t||s[1]&64)&&Cr(a,r,h,h[37],t?Mr(r,h[37],s,null):Ar(h[37]),null)},i(h){t||(Ke(a,h),t=!0)},o(h){rt(a,h),t=!1},d(h){i&&i.d(h),h&&Oe(e),a&&a.d(h)}}}function Q5(n){let e,t,i;const r=[{tag:n[14]},{use:[...n[6]?[]:[[ff,{ripple:!n[16],unbounded:!1,color:(n[1]||n[0])&&n[5]==null?"primary":n[5],disabled:n[10],addClass:n[24],removeClass:n[25],addStyle:n[26]}]],n[22],...n[2]]},{class:si({[n[3]]:!0,"mdc-deprecated-list-item":!n[8],"mdc-deprecated-list-item__wrapper":n[8],"mdc-deprecated-list-item--activated":n[1],"mdc-deprecated-list-item--selected":n[0],"mdc-deprecated-list-item--disabled":n[10],"mdc-menu-item--selected":!n[23]&&n[9]==="menuitem"&&n[0],"smui-menu-item--non-interactive":n[6],...n[18]})},{style:Object.entries(n[19]).map(LA).concat([n[4]]).join(" ")},n[23]&&n[1]?{"aria-current":"page"}:{},!n[23]||n[8]?{role:n[9]}:{},!n[23]&&n[9]==="option"?{"aria-selected":n[0]?"true":"false"}:{},!n[23]&&(n[9]==="radio"||n[9]==="checkbox")?{"aria-checked":n[16]&&n[16].checked?"true":"false"}:{},n[23]?{}:{"aria-disabled":n[10]?"true":"false"},{"data-menu-item-skip-restore-focus":n[11]||void 0},{tabindex:n[21]},{href:n[12]},n[20],n[29]];var a=n[13];function h(s){let p={$$slots:{default:[J5]},$$scope:{ctx:s}};for(let x=0;x<r.length;x+=1)p=dn(p,r[x]);return{props:p}}return a&&(e=Tl(a,h(n)),n[35](e),e.$on("click",n[15]),e.$on("keydown",n[27]),e.$on("SMUIGenericInput:mount",n[28]),e.$on("SMUIGenericInput:unmount",n[36])),{c(){e&&Pn(e.$$.fragment),t=Ei()},l(s){e&&Zn(e.$$.fragment,s),t=Ei()},m(s,p){e&&Rn(e,s,p),Tt(s,t,p),i=!0},p(s,p){const x=p[0]&670916479?Gi(r,[p[0]&16384&&{tag:s[14]},p[0]&121701479&&{use:[...s[6]?[]:[[ff,{ripple:!s[16],unbounded:!1,color:(s[1]||s[0])&&s[5]==null?"primary":s[5],disabled:s[10],addClass:s[24],removeClass:s[25],addStyle:s[26]}]],s[22],...s[2]]},p[0]&8652619&&{class:si({[s[3]]:!0,"mdc-deprecated-list-item":!s[8],"mdc-deprecated-list-item__wrapper":s[8],"mdc-deprecated-list-item--activated":s[1],"mdc-deprecated-list-item--selected":s[0],"mdc-deprecated-list-item--disabled":s[10],"mdc-menu-item--selected":!s[23]&&s[9]==="menuitem"&&s[0],"smui-menu-item--non-interactive":s[6],...s[18]})},p[0]&524304&&{style:Object.entries(s[19]).map(LA).concat([s[4]]).join(" ")},p[0]&8388610&&kr(s[23]&&s[1]?{"aria-current":"page"}:{}),p[0]&8389376&&kr(!s[23]||s[8]?{role:s[9]}:{}),p[0]&8389121&&kr(!s[23]&&s[9]==="option"?{"aria-selected":s[0]?"true":"false"}:{}),p[0]&8454656&&kr(!s[23]&&(s[9]==="radio"||s[9]==="checkbox")?{"aria-checked":s[16]&&s[16].checked?"true":"false"}:{}),p[0]&8389632&&kr(s[23]?{}:{"aria-disabled":s[10]?"true":"false"}),p[0]&2048&&{"data-menu-item-skip-restore-focus":s[11]||void 0},p[0]&2097152&&{tabindex:s[21]},p[0]&4096&&{href:s[12]},p[0]&1048576&&kr(s[20]),p[0]&536870912&&kr(s[29])]):{};if(p[0]&128|p[1]&64&&(x.$$scope={dirty:p,ctx:s}),p[0]&8192&&a!==(a=s[13])){if(e){vr();const I=e;rt(I.$$.fragment,1,0,()=>{Dn(I,1)}),xr()}a?(e=Tl(a,h(s)),s[35](e),e.$on("click",s[15]),e.$on("keydown",s[27]),e.$on("SMUIGenericInput:mount",s[28]),e.$on("SMUIGenericInput:unmount",s[36]),Pn(e.$$.fragment),Ke(e.$$.fragment,1),Rn(e,t.parentNode,t)):e=null}else a&&e.$set(x)},i(s){i||(e&&Ke(e.$$.fragment,s),i=!0)},o(s){e&&rt(e.$$.fragment,s),i=!1},d(s){n[35](null),s&&Oe(t),e&&Dn(e,s)}}}let $5=0;const LA=([n,e])=>`${n}: ${e};`;function e6(n,e,t){let i;const r=["use","class","style","color","nonInteractive","ripple","wrapper","activated","role","selected","disabled","skipRestoreFocus","tabindex","inputId","href","component","tag","action","getPrimaryText","getElement"];let a=Ji(e,r),{$$slots:h={},$$scope:s}=e;var p;const x=Uo(zo());let I=()=>{};function C(Mt){return Mt===I}let{use:M=[]}=e,{class:O=""}=e,{style:k=""}=e,{color:z=void 0}=e,{nonInteractive:G=(p=Ws("SMUI:list:nonInteractive"))!==null&&p!==void 0?p:!1}=e;xo("SMUI:list:nonInteractive",void 0);let{ripple:q=!G}=e,{wrapper:Z=!1}=e,{activated:K=!1}=e,{role:te=Z?"presentation":Ws("SMUI:list:item:role")}=e;xo("SMUI:list:item:role",void 0);let{selected:ie=!1}=e,{disabled:Te=!1}=e,{skipRestoreFocus:le=!1}=e,{tabindex:fe=I}=e,{inputId:Fe="SMUI-form-field-list-"+$5++}=e,{href:Ne=void 0}=e,Ue,dt={},Ge={},Le={},nt,zt,Ot=Ws("SMUI:list:item:nav"),{component:et=Oc}=e,{tag:Ze=et===Oc?Ot?Ne?"a":"span":"li":void 0}=e;xo("SMUI:generic:input:props",{id:Fe}),xo("SMUI:separator:context",void 0),Ll(()=>{if(!ie&&!G){let Un=!0,ti=Ue.getElement();for(;ti.previousSibling;)if(ti=ti.previousSibling,ti.nodeType===1&&ti.classList.contains("mdc-deprecated-list-item")&&!ti.classList.contains("mdc-deprecated-list-item--disabled")){Un=!1;break}Un&&(zt=window.requestAnimationFrame(()=>kn(ti)))}const Mt={_smui_list_item_accessor:!0,get element(){return Gn()},get selected(){return ie},set selected(Un){t(0,ie=Un)},hasClass:At,addClass:Kt,removeClass:sn,getAttr:ri,addAttr:Yt,removeAttr:ii,getPrimaryText:Nt,get checked(){var Un;return(Un=nt&&nt.checked)!==null&&Un!==void 0?Un:!1},set checked(Un){nt&&t(16,nt.checked=!!Un,nt)},get hasCheckbox(){return!!(nt&&"_smui_checkbox_accessor"in nt)},get hasRadio(){return!!(nt&&"_smui_radio_accessor"in nt)},activateRipple(){nt&&nt.activateRipple()},deactivateRipple(){nt&&nt.deactivateRipple()},getValue(){return a.value},action:Ut,get tabindex(){return i},set tabindex(Un){t(30,fe=Un)},get disabled(){return Te},get activated(){return K},set activated(Un){t(1,K=Un)}};return vs(Gn(),"SMUIListItem:mount",Mt),()=>{vs(Gn(),"SMUIListItem:unmount",Mt)}}),pd(()=>{zt&&window.cancelAnimationFrame(zt)});function At(Mt){return Mt in dt?dt[Mt]:Gn().classList.contains(Mt)}function Kt(Mt){dt[Mt]||t(18,dt[Mt]=!0,dt)}function sn(Mt){(!(Mt in dt)||dt[Mt])&&t(18,dt[Mt]=!1,dt)}function zn(Mt,Un){Ge[Mt]!=Un&&(Un===""||Un==null?(delete Ge[Mt],t(19,Ge)):t(19,Ge[Mt]=Un,Ge))}function ri(Mt){var Un;return Mt in Le?(Un=Le[Mt])!==null&&Un!==void 0?Un:null:Gn().getAttribute(Mt)}function Yt(Mt,Un){Le[Mt]!==Un&&t(20,Le[Mt]=Un,Le)}function ii(Mt){(!(Mt in Le)||Le[Mt]!=null)&&t(20,Le[Mt]=void 0,Le)}function kn(Mt){let Un=!0;for(;Mt.nextElementSibling;)if(Mt=Mt.nextElementSibling,Mt.nodeType===1&&Mt.classList.contains("mdc-deprecated-list-item")){const ti=Mt.attributes.getNamedItem("tabindex");if(ti&&ti.value==="0"){Un=!1;break}}Un&&t(21,i=0)}function on(Mt){const Un=Mt.key==="Enter",ti=Mt.key==="Space";(Un||ti)&&Ut(Mt)}function Di(Mt){("_smui_checkbox_accessor"in Mt.detail||"_smui_radio_accessor"in Mt.detail)&&t(16,nt=Mt.detail)}function Ut(Mt){Te||vs(Gn(),"SMUI:action",Mt)}function Nt(){var Mt,Un,ti;const jr=Gn(),Yr=jr.querySelector(".mdc-deprecated-list-item__primary-text");if(Yr)return(Mt=Yr.textContent)!==null&&Mt!==void 0?Mt:"";const hi=jr.querySelector(".mdc-deprecated-list-item__text");return hi?(Un=hi.textContent)!==null&&Un!==void 0?Un:"":(ti=jr.textContent)!==null&&ti!==void 0?ti:""}function Gn(){return Ue.getElement()}function Ci(Mt){$n[Mt?"unshift":"push"](()=>{Ue=Mt,t(17,Ue)})}const ln=()=>t(16,nt=void 0);return n.$$set=Mt=>{e=dn(dn({},e),So(Mt)),t(29,a=Ji(e,r)),"use"in Mt&&t(2,M=Mt.use),"class"in Mt&&t(3,O=Mt.class),"style"in Mt&&t(4,k=Mt.style),"color"in Mt&&t(5,z=Mt.color),"nonInteractive"in Mt&&t(6,G=Mt.nonInteractive),"ripple"in Mt&&t(7,q=Mt.ripple),"wrapper"in Mt&&t(8,Z=Mt.wrapper),"activated"in Mt&&t(1,K=Mt.activated),"role"in Mt&&t(9,te=Mt.role),"selected"in Mt&&t(0,ie=Mt.selected),"disabled"in Mt&&t(10,Te=Mt.disabled),"skipRestoreFocus"in Mt&&t(11,le=Mt.skipRestoreFocus),"tabindex"in Mt&&t(30,fe=Mt.tabindex),"inputId"in Mt&&t(31,Fe=Mt.inputId),"href"in Mt&&t(12,Ne=Mt.href),"component"in Mt&&t(13,et=Mt.component),"tag"in Mt&&t(14,Ze=Mt.tag),"$$scope"in Mt&&t(37,s=Mt.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&1073808449&&t(21,i=C(fe)?!G&&!Te&&(ie||nt&&nt.checked)?0:-1:fe)},[ie,K,M,O,k,z,G,q,Z,te,Te,le,Ne,et,Ze,Ut,nt,Ue,dt,Ge,Le,i,x,Ot,Kt,sn,zn,on,Di,a,fe,Fe,Nt,Gn,h,Ci,ln,s]}class t6 extends Fr{constructor(e){super(),Br(this,e,e6,Q5,Lr,{use:2,class:3,style:4,color:5,nonInteractive:6,ripple:7,wrapper:8,activated:1,role:9,selected:0,disabled:10,skipRestoreFocus:11,tabindex:30,inputId:31,href:12,component:13,tag:14,action:15,getPrimaryText:32,getElement:33},null,[-1,-1])}get action(){return this.$$.ctx[15]}get getPrimaryText(){return this.$$.ctx[32]}get getElement(){return this.$$.ctx[33]}}zc({class:"mdc-deprecated-list-item__text",tag:"span"});zc({class:"mdc-deprecated-list-item__primary-text",tag:"span"});zc({class:"mdc-deprecated-list-item__secondary-text",tag:"span"});function n6(n){let e,t,i,r,a,h;const s=n[8].default,p=Sr(s,n,n[7],null);let x=[{class:t=si({[n[1]]:!0,"mdc-deprecated-list-item__graphic":!0,"mdc-menu__selection-group-icon":n[4]})},n[5]],I={};for(let C=0;C<x.length;C+=1)I=dn(I,x[C]);return{c(){e=un("span"),p&&p.c(),this.h()},l(C){e=cn(C,"SPAN",{class:!0});var M=_n(e);p&&p.l(M),M.forEach(Oe),this.h()},h(){Ki(e,I)},m(C,M){Tt(C,e,M),p&&p.m(e,null),n[9](e),r=!0,a||(h=[tr(i=ra.call(null,e,n[0])),tr(n[3].call(null,e))],a=!0)},p(C,[M]){p&&p.p&&(!r||M&128)&&Cr(p,s,C,C[7],r?Mr(s,C[7],M,null):Ar(C[7]),null),Ki(e,I=Gi(x,[(!r||M&2&&t!==(t=si({[C[1]]:!0,"mdc-deprecated-list-item__graphic":!0,"mdc-menu__selection-group-icon":C[4]})))&&{class:t},M&32&&C[5]])),i&&as(i.update)&&M&1&&i.update.call(null,C[0])},i(C){r||(Ke(p,C),r=!0)},o(C){rt(p,C),r=!1},d(C){C&&Oe(e),p&&p.d(C),n[9](null),a=!1,sa(h)}}}function i6(n,e,t){const i=["use","class","getElement"];let r=Ji(e,i),{$$slots:a={},$$scope:h}=e;const s=Uo(zo());let{use:p=[]}=e,{class:x=""}=e,I,C=Ws("SMUI:list:graphic:menu-selection-group");function M(){return I}function O(k){$n[k?"unshift":"push"](()=>{I=k,t(2,I)})}return n.$$set=k=>{e=dn(dn({},e),So(k)),t(5,r=Ji(e,i)),"use"in k&&t(0,p=k.use),"class"in k&&t(1,x=k.class),"$$scope"in k&&t(7,h=k.$$scope)},[p,x,I,s,C,r,M,h,a,O]}class r6 extends Fr{constructor(e){super(),Br(this,e,i6,n6,Lr,{use:0,class:1,getElement:6})}get getElement(){return this.$$.ctx[6]}}zc({class:"mdc-deprecated-list-item__meta",tag:"span"});zc({class:"mdc-deprecated-list-group",tag:"div"});zc({class:"mdc-deprecated-list-group__subheader",tag:"h3"});zc({class:"mdc-menu__selection-group-icon",component:r6});function s6(n){let e;return{c(){e=_r(n[8])},l(t){e=yr(t,n[8])},m(t,i){Tt(t,e,i)},p(t,i){i&256&&Ao(e,t[8])},i:za,o:za,d(t){t&&Oe(e)}}}function o6(n){let e;const t=n[13].default,i=Sr(t,n,n[12],null);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a&4096)&&Cr(i,t,r,r[12],e?Mr(t,r[12],a,null):Ar(r[12]),null)},i(r){e||(Ke(i,r),e=!0)},o(r){rt(i,r),e=!1},d(r){i&&i.d(r)}}}function a6(n){let e,t,i,r,a,h,s,p,x;const I=[o6,s6],C=[];function M(z,G){return z[8]==null?0:1}t=M(n),i=C[t]=I[t](n);let O=[{class:r=si({[n[1]]:!0,"mdc-select-helper-text":!0,"mdc-select-helper-text--validation-msg":n[4],"mdc-select-helper-text--validation-msg-persistent":n[3],...n[6]})},{"aria-hidden":a=n[3]?void 0:"true"},{id:n[2]},n[7],n[10]],k={};for(let z=0;z<O.length;z+=1)k=dn(k,O[z]);return{c(){e=un("div"),i.c(),this.h()},l(z){e=cn(z,"DIV",{class:!0,"aria-hidden":!0,id:!0});var G=_n(e);i.l(G),G.forEach(Oe),this.h()},h(){Ki(e,k)},m(z,G){Tt(z,e,G),C[t].m(e,null),n[14](e),s=!0,p||(x=[tr(h=ra.call(null,e,n[0])),tr(n[9].call(null,e))],p=!0)},p(z,[G]){let q=t;t=M(z),t===q?C[t].p(z,G):(vr(),rt(C[q],1,1,()=>{C[q]=null}),xr(),i=C[t],i?i.p(z,G):(i=C[t]=I[t](z),i.c()),Ke(i,1),i.m(e,null)),Ki(e,k=Gi(O,[(!s||G&90&&r!==(r=si({[z[1]]:!0,"mdc-select-helper-text":!0,"mdc-select-helper-text--validation-msg":z[4],"mdc-select-helper-text--validation-msg-persistent":z[3],...z[6]})))&&{class:r},(!s||G&8&&a!==(a=z[3]?void 0:"true"))&&{"aria-hidden":a},(!s||G&4)&&{id:z[2]},G&128&&z[7],G&1024&&z[10]])),h&&as(h.update)&&G&1&&h.update.call(null,z[0])},i(z){s||(Ke(i),s=!0)},o(z){rt(i),s=!1},d(z){z&&Oe(e),C[t].d(),n[14](null),p=!1,sa(x)}}}let l6=0;function u6(n,e,t){const i=["use","class","id","persistent","validationMsg","getElement"];let r=Ji(e,i),{$$slots:a={},$$scope:h}=e;const s=Uo(zo());let{use:p=[]}=e,{class:x=""}=e,{id:I="SMUI-select-helper-text-"+l6++}=e,{persistent:C=!1}=e,{validationMsg:M=!1}=e,O,k,z={},G={},q;Ll(()=>(k=new F5({addClass:K,removeClass:te,hasClass:Z,getAttr:ie,setAttr:Te,removeAttr:le,setContent:Ne=>{t(8,q=Ne)}}),I.startsWith("SMUI-select-helper-text-")&&vs(fe(),"SMUISelectHelperText:id",I),vs(fe(),"SMUISelectHelperText:mount",k),k.init(),()=>{vs(fe(),"SMUISelectHelperText:unmount",k),k.destroy()}));function Z(Ne){return Ne in z?z[Ne]:fe().classList.contains(Ne)}function K(Ne){z[Ne]||t(6,z[Ne]=!0,z)}function te(Ne){(!(Ne in z)||z[Ne])&&t(6,z[Ne]=!1,z)}function ie(Ne){var Ue;return Ne in G?(Ue=G[Ne])!==null&&Ue!==void 0?Ue:null:fe().getAttribute(Ne)}function Te(Ne,Ue){G[Ne]!==Ue&&t(7,G[Ne]=Ue,G)}function le(Ne){(!(Ne in G)||G[Ne]!=null)&&t(7,G[Ne]=void 0,G)}function fe(){return O}function Fe(Ne){$n[Ne?"unshift":"push"](()=>{O=Ne,t(5,O)})}return n.$$set=Ne=>{e=dn(dn({},e),So(Ne)),t(10,r=Ji(e,i)),"use"in Ne&&t(0,p=Ne.use),"class"in Ne&&t(1,x=Ne.class),"id"in Ne&&t(2,I=Ne.id),"persistent"in Ne&&t(3,C=Ne.persistent),"validationMsg"in Ne&&t(4,M=Ne.validationMsg),"$$scope"in Ne&&t(12,h=Ne.$$scope)},[p,x,I,C,M,O,z,G,q,s,r,fe,h,a,Fe]}class c6 extends Fr{constructor(e){super(),Br(this,e,u6,a6,Lr,{use:0,class:1,id:2,persistent:3,validationMsg:4,getElement:11})}get getElement(){return this.$$.ctx[11]}}const h6=n=>({}),PA=n=>({}),f6=n=>({}),RA=n=>({}),d6=n=>({}),DA=n=>({}),p6=n=>({}),OA=n=>({});function NA(n){let e,t=[{type:"hidden"},{required:n[10]},{disabled:n[6]},{value:n[0]},sr(n[53],"input$")],i={};for(let r=0;r<t.length;r+=1)i=dn(i,t[r]);return{c(){e=un("input"),this.h()},l(r){e=cn(r,"INPUT",{type:!0}),this.h()},h(){Ki(e,i)},m(r,a){Tt(r,e,a),e.autofocus&&e.focus()},p(r,a){Ki(e,i=Gi(t,[{type:"hidden"},a[0]&1024&&{required:r[10]},a[0]&64&&{disabled:r[6]},a[0]&1&&{value:r[0]},a[1]&4194304&&sr(r[53],"input$")]))},d(r){r&&Oe(e)}}}function kA(n){let e;return{c(){e=un("span"),this.h()},l(t){e=cn(t,"SPAN",{class:!0}),_n(e).forEach(Oe),this.h()},h(){tn(e,"class","mdc-select__ripple")},m(t,i){Tt(t,e,i)},d(t){t&&Oe(e)}}}function FA(n){let e,t;const i=[{id:n[11]+"-smui-label"},{floatAbove:n[42]!==""},{required:n[10]},sr(n[53],"label$")];let r={$$slots:{default:[m6]},$$scope:{ctx:n}};for(let a=0;a<i.length;a+=1)r=dn(r,i[a]);return e=new iw({props:r}),n[66](e),{c(){Pn(e.$$.fragment)},l(a){Zn(e.$$.fragment,a)},m(a,h){Rn(e,a,h),t=!0},p(a,h){const s=h[0]&3072|h[1]&4196352?Gi(i,[h[0]&2048&&{id:a[11]+"-smui-label"},h[1]&2048&&{floatAbove:a[42]!==""},h[0]&1024&&{required:a[10]},h[1]&4194304&&kr(sr(a[53],"label$"))]):{};h[0]&512|h[2]&16777216&&(s.$$scope={dirty:h,ctx:a}),e.$set(s)},i(a){t||(Ke(e.$$.fragment,a),t=!0)},o(a){rt(e.$$.fragment,a),t=!1},d(a){n[66](null),Dn(e,a)}}}function m6(n){let e=(n[9]==null?"":n[9])+"",t,i;const r=n[63].label,a=Sr(r,n,n[86],OA);return{c(){t=_r(e),a&&a.c()},l(h){t=yr(h,e),a&&a.l(h)},m(h,s){Tt(h,t,s),a&&a.m(h,s),i=!0},p(h,s){(!i||s[0]&512)&&e!==(e=(h[9]==null?"":h[9])+"")&&Ao(t,e),a&&a.p&&(!i||s[2]&16777216)&&Cr(a,r,h,h[86],i?Mr(r,h[86],s,p6):Ar(h[86]),OA)},i(h){i||(Ke(a,h),i=!0)},o(h){rt(a,h),i=!1},d(h){h&&Oe(t),a&&a.d(h)}}}function BA(n){let e,t;const i=[{noLabel:n[8]||n[9]==null&&!n[52].label},sr(n[53],"outline$")];let r={$$slots:{default:[_6]},$$scope:{ctx:n}};for(let a=0;a<i.length;a+=1)r=dn(r,i[a]);return e=new HL({props:r}),n[68](e),{c(){Pn(e.$$.fragment)},l(a){Zn(e.$$.fragment,a)},m(a,h){Rn(e,a,h),t=!0},p(a,h){const s=h[0]&768|h[1]&6291456?Gi(i,[h[0]&768|h[1]&2097152&&{noLabel:a[8]||a[9]==null&&!a[52].label},h[1]&4194304&&kr(sr(a[53],"outline$"))]):{};h[0]&3840|h[1]&6293760|h[2]&16777216&&(s.$$scope={dirty:h,ctx:a}),e.$set(s)},i(a){t||(Ke(e.$$.fragment,a),t=!0)},o(a){rt(e.$$.fragment,a),t=!1},d(a){n[68](null),Dn(e,a)}}}function zA(n){let e,t;const i=[{id:n[11]+"-smui-label"},{floatAbove:n[42]!==""},{required:n[10]},sr(n[53],"label$")];let r={$$slots:{default:[g6]},$$scope:{ctx:n}};for(let a=0;a<i.length;a+=1)r=dn(r,i[a]);return e=new iw({props:r}),n[67](e),{c(){Pn(e.$$.fragment)},l(a){Zn(e.$$.fragment,a)},m(a,h){Rn(e,a,h),t=!0},p(a,h){const s=h[0]&3072|h[1]&4196352?Gi(i,[h[0]&2048&&{id:a[11]+"-smui-label"},h[1]&2048&&{floatAbove:a[42]!==""},h[0]&1024&&{required:a[10]},h[1]&4194304&&kr(sr(a[53],"label$"))]):{};h[0]&512|h[2]&16777216&&(s.$$scope={dirty:h,ctx:a}),e.$set(s)},i(a){t||(Ke(e.$$.fragment,a),t=!0)},o(a){rt(e.$$.fragment,a),t=!1},d(a){n[67](null),Dn(e,a)}}}function g6(n){let e=(n[9]==null?"":n[9])+"",t,i;const r=n[63].label,a=Sr(r,n,n[86],DA);return{c(){t=_r(e),a&&a.c()},l(h){t=yr(h,e),a&&a.l(h)},m(h,s){Tt(h,t,s),a&&a.m(h,s),i=!0},p(h,s){(!i||s[0]&512)&&e!==(e=(h[9]==null?"":h[9])+"")&&Ao(t,e),a&&a.p&&(!i||s[2]&16777216)&&Cr(a,r,h,h[86],i?Mr(r,h[86],s,d6):Ar(h[86]),DA)},i(h){i||(Ke(a,h),i=!0)},o(h){rt(a,h),i=!1},d(h){h&&Oe(t),a&&a.d(h)}}}function _6(n){let e,t,i=!n[8]&&(n[9]!=null||n[52].label)&&zA(n);return{c(){i&&i.c(),e=Ei()},l(r){i&&i.l(r),e=Ei()},m(r,a){i&&i.m(r,a),Tt(r,e,a),t=!0},p(r,a){!r[8]&&(r[9]!=null||r[52].label)?i?(i.p(r,a),a[0]&768|a[1]&2097152&&Ke(i,1)):(i=zA(r),i.c(),Ke(i,1),i.m(e.parentNode,e)):i&&(vr(),rt(i,1,1,()=>{i=null}),xr())},i(r){t||(Ke(i),t=!0)},o(r){rt(i),t=!1},d(r){i&&i.d(r),r&&Oe(e)}}}function UA(n){let e,t;const i=[sr(n[53],"ripple$")];let r={};for(let a=0;a<i.length;a+=1)r=dn(r,i[a]);return e=new qL({props:r}),n[69](e),{c(){Pn(e.$$.fragment)},l(a){Zn(e.$$.fragment,a)},m(a,h){Rn(e,a,h),t=!0},p(a,h){const s=h[1]&4194304?Gi(i,[kr(sr(a[53],"ripple$"))]):{};e.$set(s)},i(a){t||(Ke(e.$$.fragment,a),t=!0)},o(a){rt(e.$$.fragment,a),t=!1},d(a){n[69](null),Dn(e,a)}}}function y6(n){let e;const t=n[63].default,i=Sr(t,n,n[86],null);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a[2]&16777216)&&Cr(i,t,r,r[86],e?Mr(t,r[86],a,null):Ar(r[86]),null)},i(r){e||(Ke(i,r),e=!0)},o(r){rt(i,r),e=!1},d(r){i&&i.d(r)}}}function v6(n){let e,t,i;const r=[{role:"listbox"},{wrapFocus:n[35]},sr(n[53],"list$")];function a(s){n[74](s)}let h={$$slots:{default:[y6]},$$scope:{ctx:n}};for(let s=0;s<r.length;s+=1)h=dn(h,r[s]);return n[24]!==void 0&&(h.selectedIndex=n[24]),e=new K5({props:h}),$n.push(()=>ho(e,"selectedIndex",a)),e.$on("SMUIList:mount",n[75]),{c(){Pn(e.$$.fragment)},l(s){Zn(e.$$.fragment,s)},m(s,p){Rn(e,s,p),i=!0},p(s,p){const x=p[1]&4194320?Gi(r,[r[0],p[1]&16&&{wrapFocus:s[35]},p[1]&4194304&&kr(sr(s[53],"list$"))]):{};p[2]&16777216&&(x.$$scope={dirty:p,ctx:s}),!t&&p[0]&16777216&&(t=!0,x.selectedIndex=s[24],Eo(()=>t=!1)),e.$set(x)},i(s){i||(Ke(e.$$.fragment,s),i=!0)},o(s){rt(e.$$.fragment,s),i=!1},d(s){Dn(e,s)}}}function VA(n){let e,t;const i=[sr(n[53],"helperText$")];let r={$$slots:{default:[x6]},$$scope:{ctx:n}};for(let a=0;a<i.length;a+=1)r=dn(r,i[a]);return e=new c6({props:r}),e.$on("SMUISelectHelperText:id",n[83]),e.$on("SMUISelectHelperText:mount",n[84]),e.$on("SMUISelectHelperText:unmount",n[85]),{c(){Pn(e.$$.fragment)},l(a){Zn(e.$$.fragment,a)},m(a,h){Rn(e,a,h),t=!0},p(a,h){const s=h[1]&4194304?Gi(i,[kr(sr(a[53],"helperText$"))]):{};h[2]&16777216&&(s.$$scope={dirty:h,ctx:a}),e.$set(s)},i(a){t||(Ke(e.$$.fragment,a),t=!0)},o(a){rt(e.$$.fragment,a),t=!1},d(a){Dn(e,a)}}}function x6(n){let e;const t=n[63].helperText,i=Sr(t,n,n[86],PA);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a[2]&16777216)&&Cr(i,t,r,r[86],e?Mr(t,r[86],a,h6):Ar(r[86]),PA)},i(r){e||(Ke(i,r),e=!0)},o(r){rt(i,r),e=!1},d(r){i&&i.d(r)}}}function b6(n){let e,t,i,r,a,h,s,p,x,I,C,M,O,k,z,G,q,Z,K,te,ie,Te,le,fe,Fe,Ne,Ue,dt,Ge,Le,nt,zt,Ot,et,Ze,At,Kt,sn,zn,ri,Yt=n[12]&&NA(n),ii=n[7]==="filled"&&kA(),kn=n[7]!=="outlined"&&!n[8]&&(n[9]!=null||n[52].label)&&FA(n),on=n[7]==="outlined"&&BA(n);const Di=n[63].leadingIcon,Ut=Sr(Di,n,n[86],RA);let Nt=[{id:C=n[11]+"-smui-selected-text"},{class:M=si({[n[19]]:!0,"mdc-select__selected-text":!0})},{role:"button"},{"aria-haspopup":"listbox"},{"aria-labelledby":O=n[11]+"-smui-label"},sr(n[53],"selectedText$")],Gn={};for(let Kn=0;Kn<Nt.length;Kn+=1)Gn=dn(Gn,Nt[Kn]);let Ci=[{class:z=si({[n[17]]:!0,"mdc-select__selected-text-container":!0})},sr(n[53],"selectedTextContainer$")],ln={};for(let Kn=0;Kn<Ci.length;Kn+=1)ln=dn(ln,Ci[Kn]);let Mt=[{class:Te=si({[n[21]]:!0,"mdc-select__dropdown-icon":!0})},sr(n[53],"dropdownIcon$")],Un={};for(let Kn=0;Kn<Mt.length;Kn+=1)Un=dn(Un,Mt[Kn]);let ti=n[7]!=="outlined"&&n[5]&&UA(n),jr=[{class:Fe=si({[n[15]]:!0,"mdc-select__anchor":!0})},{"aria-required":Ne=n[10]?"true":void 0},{"aria-disabled":Ue=n[6]?"true":void 0},{"aria-controls":n[30]},{"aria-describedby":n[30]},n[29],sr(n[53],"anchor$")],Yr={};for(let Kn=0;Kn<jr.length;Kn+=1)Yr=dn(Yr,jr[Kn]);const hi=[{class:si({[n[22]]:!0,"mdc-select__menu":!0,...n[32]})},{fullWidth:!0},{anchor:!1},{anchorElement:n[33]},{anchorCorner:n[34]},sr(n[53],"menu$")];function Hi(Kn){n[76](Kn)}let or={$$slots:{default:[v6]},$$scope:{ctx:n}};for(let Kn=0;Kn<hi.length;Kn+=1)or=dn(or,hi[Kn]);n[31]!==void 0&&(or.open=n[31]),Le=new W5({props:or}),$n.push(()=>ho(Le,"open",Hi)),Le.$on("SMUIMenu:selected",n[77]),Le.$on("SMUIMenuSurface:closing",n[78]),Le.$on("SMUIMenuSurface:closed",n[79]),Le.$on("SMUIMenuSurface:opened",n[80]);let $e=[{class:zt=si({[n[3]]:!0,"mdc-select":!0,"mdc-select--required":n[10],"mdc-select--disabled":n[6],"mdc-select--filled":n[7]==="filled","mdc-select--outlined":n[7]==="outlined","smui-select--standard":n[7]==="standard","mdc-select--with-leading-icon":n[44](n[13])?n[52].leadingIcon:n[13],"mdc-select--no-label":n[8]||n[9]==null&&!n[52].label,"mdc-select--invalid":n[1],"mdc-select--activated":n[31],"mdc-data-table__pagination-rows-per-page-select":n[45]==="data-table:pagination",...n[26]})},{style:Ot=Object.entries(n[27]).map(GA).concat([n[4]]).join(" ")},ep(n[53],["input$","anchor$","label$","outline$","selectedTextContainer$","selectedText$","dropdownIcon$","ripple$","menu$","list$","helperText$"])],Tn={};for(let Kn=0;Kn<$e.length;Kn+=1)Tn=dn(Tn,$e[Kn]);let fi=n[52].helperText&&VA(n);return{c(){e=un("div"),Yt&&Yt.c(),t=qn(),i=un("div"),ii&&ii.c(),r=qn(),kn&&kn.c(),a=qn(),on&&on.c(),h=qn(),Ut&&Ut.c(),s=qn(),p=un("span"),x=un("span"),I=_r(n[42]),q=qn(),Z=un("span"),K=rE("svg"),te=rE("polygon"),ie=rE("polygon"),fe=qn(),ti&&ti.c(),Ge=qn(),Pn(Le.$$.fragment),At=qn(),fi&&fi.c(),Kt=Ei(),this.h()},l(Kn){e=cn(Kn,"DIV",{class:!0,style:!0});var pn=_n(e);Yt&&Yt.l(pn),t=Hn(pn),i=cn(pn,"DIV",{class:!0,"aria-required":!0,"aria-disabled":!0,"aria-controls":!0,"aria-describedby":!0});var vi=_n(i);ii&&ii.l(vi),r=Hn(vi),kn&&kn.l(vi),a=Hn(vi),on&&on.l(vi),h=Hn(vi),Ut&&Ut.l(vi),s=Hn(vi),p=cn(vi,"SPAN",{class:!0});var Rs=_n(p);x=cn(Rs,"SPAN",{id:!0,class:!0,role:!0,"aria-haspopup":!0,"aria-labelledby":!0});var kt=_n(x);I=yr(kt,n[42]),kt.forEach(Oe),Rs.forEach(Oe),q=Hn(vi),Z=cn(vi,"SPAN",{class:!0});var mn=_n(Z);K=sE(mn,"svg",{class:!0,viewBox:!0,focusable:!0});var jn=_n(K);te=sE(jn,"polygon",{class:!0,stroke:!0,"fill-rule":!0,points:!0}),_n(te).forEach(Oe),ie=sE(jn,"polygon",{class:!0,stroke:!0,"fill-rule":!0,points:!0}),_n(ie).forEach(Oe),jn.forEach(Oe),mn.forEach(Oe),fe=Hn(vi),ti&&ti.l(vi),vi.forEach(Oe),Ge=Hn(pn),Zn(Le.$$.fragment,pn),pn.forEach(Oe),At=Hn(Kn),fi&&fi.l(Kn),Kt=Ei(),this.h()},h(){Ki(x,Gn),Ki(p,ln),tn(te,"class","mdc-select__dropdown-icon-inactive"),tn(te,"stroke","none"),tn(te,"fill-rule","evenodd"),tn(te,"points","7 10 12 15 17 10"),tn(ie,"class","mdc-select__dropdown-icon-active"),tn(ie,"stroke","none"),tn(ie,"fill-rule","evenodd"),tn(ie,"points","7 15 12 10 17 15"),tn(K,"class","mdc-select__dropdown-icon-graphic"),tn(K,"viewBox","7 10 10 5"),tn(K,"focusable","false"),Ki(Z,Un),Ki(i,Yr),Ki(e,Tn)},m(Kn,pn){Tt(Kn,e,pn),Yt&&Yt.m(e,null),an(e,t),an(e,i),ii&&ii.m(i,null),an(i,r),kn&&kn.m(i,null),an(i,a),on&&on.m(i,null),an(i,h),Ut&&Ut.m(i,null),an(i,s),an(i,p),an(p,x),an(x,I),an(i,q),an(i,Z),an(Z,K),an(K,te),an(K,ie),an(i,fe),ti&&ti.m(i,null),n[70](i),an(e,Ge),Rn(Le,e,null),n[81](e),Tt(Kn,At,pn),fi&&fi.m(Kn,pn),Tt(Kn,Kt,pn),sn=!0,zn||(ri=[tr(k=ra.call(null,x,n[18])),tr(G=ra.call(null,p,n[16])),tr(le=ra.call(null,Z,n[20])),tr(dt=ra.call(null,i,n[14])),Vi(i,"focus",n[71]),Vi(i,"blur",n[72]),Vi(i,"click",n[73]),Vi(i,"keydown",function(){as(n[23]&&n[23].handleKeydown.bind(n[23]))&&(n[23]&&n[23].handleKeydown.bind(n[23])).apply(this,arguments)}),Vi(i,"focus",n[64]),Vi(i,"blur",n[65]),tr(et=ff.call(null,e,{ripple:n[7]==="filled",unbounded:!1,addClass:n[49],removeClass:n[50],addStyle:n[51]})),tr(G5.call(null,e,{addClass:n[49],removeClass:n[50]})),tr(Ze=ra.call(null,e,n[2])),tr(n[43].call(null,e)),Vi(e,"SMUISelectLeadingIcon:mount",n[48]),Vi(e,"SMUISelectLeadingIcon:unmount",n[82])],zn=!0)},p(Kn,pn){n=Kn,n[12]?Yt?Yt.p(n,pn):(Yt=NA(n),Yt.c(),Yt.m(e,t)):Yt&&(Yt.d(1),Yt=null),n[7]==="filled"?ii||(ii=kA(),ii.c(),ii.m(i,r)):ii&&(ii.d(1),ii=null),n[7]!=="outlined"&&!n[8]&&(n[9]!=null||n[52].label)?kn?(kn.p(n,pn),pn[0]&896|pn[1]&2097152&&Ke(kn,1)):(kn=FA(n),kn.c(),Ke(kn,1),kn.m(i,a)):kn&&(vr(),rt(kn,1,1,()=>{kn=null}),xr()),n[7]==="outlined"?on?(on.p(n,pn),pn[0]&128&&Ke(on,1)):(on=BA(n),on.c(),Ke(on,1),on.m(i,h)):on&&(vr(),rt(on,1,1,()=>{on=null}),xr()),Ut&&Ut.p&&(!sn||pn[2]&16777216)&&Cr(Ut,Di,n,n[86],sn?Mr(Di,n[86],pn,f6):Ar(n[86]),RA),(!sn||pn[1]&2048)&&Ao(I,n[42]),Ki(x,Gn=Gi(Nt,[(!sn||pn[0]&2048&&C!==(C=n[11]+"-smui-selected-text"))&&{id:C},(!sn||pn[0]&524288&&M!==(M=si({[n[19]]:!0,"mdc-select__selected-text":!0})))&&{class:M},{role:"button"},{"aria-haspopup":"listbox"},(!sn||pn[0]&2048&&O!==(O=n[11]+"-smui-label"))&&{"aria-labelledby":O},pn[1]&4194304&&sr(n[53],"selectedText$")])),k&&as(k.update)&&pn[0]&262144&&k.update.call(null,n[18]),Ki(p,ln=Gi(Ci,[(!sn||pn[0]&131072&&z!==(z=si({[n[17]]:!0,"mdc-select__selected-text-container":!0})))&&{class:z},pn[1]&4194304&&sr(n[53],"selectedTextContainer$")])),G&&as(G.update)&&pn[0]&65536&&G.update.call(null,n[16]),Ki(Z,Un=Gi(Mt,[(!sn||pn[0]&2097152&&Te!==(Te=si({[n[21]]:!0,"mdc-select__dropdown-icon":!0})))&&{class:Te},pn[1]&4194304&&sr(n[53],"dropdownIcon$")])),le&&as(le.update)&&pn[0]&1048576&&le.update.call(null,n[20]),n[7]!=="outlined"&&n[5]?ti?(ti.p(n,pn),pn[0]&160&&Ke(ti,1)):(ti=UA(n),ti.c(),Ke(ti,1),ti.m(i,null)):ti&&(vr(),rt(ti,1,1,()=>{ti=null}),xr()),Ki(i,Yr=Gi(jr,[(!sn||pn[0]&32768&&Fe!==(Fe=si({[n[15]]:!0,"mdc-select__anchor":!0})))&&{class:Fe},(!sn||pn[0]&1024&&Ne!==(Ne=n[10]?"true":void 0))&&{"aria-required":Ne},(!sn||pn[0]&64&&Ue!==(Ue=n[6]?"true":void 0))&&{"aria-disabled":Ue},(!sn||pn[0]&1073741824)&&{"aria-controls":n[30]},(!sn||pn[0]&1073741824)&&{"aria-describedby":n[30]},pn[0]&536870912&&n[29],pn[1]&4194304&&sr(n[53],"anchor$")])),dt&&as(dt.update)&&pn[0]&16384&&dt.update.call(null,n[14]);const vi=pn[0]&4194304|pn[1]&4194318?Gi(hi,[pn[0]&4194304|pn[1]&2&&{class:si({[n[22]]:!0,"mdc-select__menu":!0,...n[32]})},hi[1],hi[2],pn[1]&4&&{anchorElement:n[33]},pn[1]&8&&{anchorCorner:n[34]},pn[1]&4194304&&kr(sr(n[53],"menu$"))]):{};pn[0]&16777216|pn[1]&4194352|pn[2]&16777216&&(vi.$$scope={dirty:pn,ctx:n}),!nt&&pn[1]&1&&(nt=!0,vi.open=n[31],Eo(()=>nt=!1)),Le.$set(vi),Ki(e,Tn=Gi($e,[(!sn||pn[0]&67119050|pn[1]&2097153&&zt!==(zt=si({[n[3]]:!0,"mdc-select":!0,"mdc-select--required":n[10],"mdc-select--disabled":n[6],"mdc-select--filled":n[7]==="filled","mdc-select--outlined":n[7]==="outlined","smui-select--standard":n[7]==="standard","mdc-select--with-leading-icon":n[44](n[13])?n[52].leadingIcon:n[13],"mdc-select--no-label":n[8]||n[9]==null&&!n[52].label,"mdc-select--invalid":n[1],"mdc-select--activated":n[31],"mdc-data-table__pagination-rows-per-page-select":n[45]==="data-table:pagination",...n[26]})))&&{class:zt},(!sn||pn[0]&134217744&&Ot!==(Ot=Object.entries(n[27]).map(GA).concat([n[4]]).join(" ")))&&{style:Ot},pn[1]&4194304&&ep(n[53],["input$","anchor$","label$","outline$","selectedTextContainer$","selectedText$","dropdownIcon$","ripple$","menu$","list$","helperText$"])])),et&&as(et.update)&&pn[0]&128&&et.update.call(null,{ripple:n[7]==="filled",unbounded:!1,addClass:n[49],removeClass:n[50],addStyle:n[51]}),Ze&&as(Ze.update)&&pn[0]&4&&Ze.update.call(null,n[2]),n[52].helperText?fi?(fi.p(n,pn),pn[1]&2097152&&Ke(fi,1)):(fi=VA(n),fi.c(),Ke(fi,1),fi.m(Kt.parentNode,Kt)):fi&&(vr(),rt(fi,1,1,()=>{fi=null}),xr())},i(Kn){sn||(Ke(kn),Ke(on),Ke(Ut,Kn),Ke(ti),Ke(Le.$$.fragment,Kn),Ke(fi),sn=!0)},o(Kn){rt(kn),rt(on),rt(Ut,Kn),rt(ti),rt(Le.$$.fragment,Kn),rt(fi),sn=!1},d(Kn){Kn&&Oe(e),Yt&&Yt.d(),ii&&ii.d(),kn&&kn.d(),on&&on.d(),Ut&&Ut.d(Kn),ti&&ti.d(),n[70](null),Dn(Le),n[81](null),Kn&&Oe(At),fi&&fi.d(Kn),Kn&&Oe(Kt),zn=!1,sa(ri)}}}let E6=0;function w6(n){const e=n.currentTarget.getBoundingClientRect();return(I6(n)?n.touches[0].clientX:n.clientX)-e.left}function I6(n){return"touches"in n}const GA=([n,e])=>`${n}: ${e};`;function T6(n,e,t){const i=["use","class","style","ripple","disabled","variant","noLabel","label","value","key","dirty","invalid","updateInvalid","required","inputId","hiddenInput","withLeadingIcon","anchor$use","anchor$class","selectedTextContainer$use","selectedTextContainer$class","selectedText$use","selectedText$class","dropdownIcon$use","dropdownIcon$class","menu$class","getUseDefaultValidation","setUseDefaultValidation","focus","layout","getElement"];let r=Ji(e,i),a,h,{$$slots:s={},$$scope:p}=e;const x=rM(s),I=Uo(zo());let C=()=>{};function M(je){return je===C}let{use:O=[]}=e,{class:k=""}=e,{style:z=""}=e,{ripple:G=!0}=e,{disabled:q=!1}=e,{variant:Z="standard"}=e,{noLabel:K=!1}=e,{label:te=void 0}=e,{value:ie=""}=e,{key:Te=je=>je}=e,{dirty:le=!1}=e,{invalid:fe=C}=e,{updateInvalid:Fe=M(fe)}=e;const Ne=M(fe);M(fe)&&(fe=!1);let{required:Ue=!1}=e,{inputId:dt="SMUI-select-"+E6++}=e,{hiddenInput:Ge=!1}=e,{withLeadingIcon:Le=C}=e,{anchor$use:nt=[]}=e,{anchor$class:zt=""}=e,{selectedTextContainer$use:Ot=[]}=e,{selectedTextContainer$class:et=""}=e,{selectedText$use:Ze=[]}=e,{selectedText$class:At=""}=e,{dropdownIcon$use:Kt=[]}=e,{dropdownIcon$class:sn=""}=e,{menu$class:zn=""}=e,ri,Yt,ii={},kn={},on,Di={},Ut=-1,Nt,Gn=Ws("SMUI:addLayoutListener"),Ci,ln=!1,Mt={},Un,ti,jr=!1,Yr,hi=Ws("SMUI:select:context"),Hi,or,$e,Tn,fi;xo("SMUI:list:role",""),xo("SMUI:list:nav",!1);const Kn=Xm("");id(n,Kn,je=>t(42,a=je)),xo("SMUI:select:selectedText",Kn);const pn=Xm(ie);id(n,pn,je=>t(88,h=je)),xo("SMUI:select:value",pn);let vi=Ut;Gn&&(Ci=Gn(Rl)),Ll(()=>(t(23,Yt=new k5({setSelectedText:je=>{cv(Kn,a=je,a)},isSelectAnchorFocused:()=>document.activeElement===on,getSelectAnchorAttr:oa,setSelectAnchorAttr:Vo,removeSelectAnchorAttr:Os,addMenuClass:Ds,removeMenuClass:io,openMenu:()=>{t(31,ln=!0)},closeMenu:()=>{t(31,ln=!1)},getAnchorElement:()=>on,setMenuAnchorElement:je=>{t(33,Un=je)},setMenuAnchorCorner:je=>{t(34,ti=je)},setMenuWrapFocus:je=>{t(35,jr=je)},getSelectedIndex:()=>Ut,setSelectedIndex:je=>{t(62,vi=je),t(24,Ut=je),t(0,ie=Mo()[Ut])},focusMenuItemAtIndex:je=>{Yr.focusItemAtIndex(je)},getMenuItemCount:()=>Yr.items.length,getMenuItemValues:()=>Mo().map(Te),getMenuItemTextAtIndex:je=>Yr.getPrimaryTextAtIndex(je),isTypeaheadInProgress:()=>Yr.typeaheadInProgress,typeaheadMatchItem:(je,Fn)=>Yr.typeaheadMatchItem(je,Fn),addClass:mn,removeClass:jn,hasClass:kt,setRippleCenter:je=>Tn&&Tn.setRippleCenter(je),activateBottomLine:()=>Tn&&Tn.activate(),deactivateBottomLine:()=>Tn&&Tn.deactivate(),notifyChange:je=>{t(54,le=!0),Fe&&t(1,fe=!Yt.isValid()),vs(Ha(),"SMUISelect:change",{value:ie,index:Ut},void 0,!0)},hasOutline:()=>!!fi,notchOutline:je=>fi&&fi.notch(je),closeOutline:()=>fi&&fi.closeNotch(),hasLabel:()=>!!$e,floatLabel:je=>$e&&$e.float(je),getLabelWidth:()=>$e?$e.getWidth():0,setLabelRequired:je=>$e&&$e.setRequired(je)},{get helperText(){return or},get leadingIcon(){return Hi}})),t(24,Ut=Mo().indexOf(ie)),Yt.init(),ro(Ne),()=>{Yt.destroy()})),pd(()=>{Ci&&Ci()});function Rs(je){t(37,Hi=je.detail)}function kt(je){return je in ii?ii[je]:Ha().classList.contains(je)}function mn(je){ii[je]||t(26,ii[je]=!0,ii)}function jn(je){(!(je in ii)||ii[je])&&t(26,ii[je]=!1,ii)}function ki(je,Fn){kn[je]!=Fn&&(Fn===""||Fn==null?(delete kn[je],t(27,kn)):t(27,kn[je]=Fn,kn))}function Ds(je){Mt[je]||t(32,Mt[je]=!0,Mt)}function io(je){(!(je in Mt)||Mt[je])&&t(32,Mt[je]=!1,Mt)}function oa(je){var Fn;return je in Di?(Fn=Di[je])!==null&&Fn!==void 0?Fn:null:Ha().getAttribute(je)}function Vo(je,Fn){Di[je]!==Fn&&t(29,Di[je]=Fn,Di)}function Os(je){(!(je in Di)||Di[je]!=null)&&t(29,Di[je]=void 0,Di)}function Mo(){return Yr.getOrderedList().map(je=>je.getValue())}function qa(){return Yt.getUseDefaultValidation()}function ro(je){Yt.setUseDefaultValidation(je)}function Ia(){on.focus()}function Rl(){Yt.layout()}function Ha(){return ri}function aa(je){Zl.call(this,n,je)}function Wa(je){Zl.call(this,n,je)}function Bs(je){$n[je?"unshift":"push"](()=>{$e=je,t(39,$e)})}function Ta(je){$n[je?"unshift":"push"](()=>{$e=je,t(39,$e)})}function Zs(je){$n[je?"unshift":"push"](()=>{fi=je,t(41,fi)})}function Sa(je){$n[je?"unshift":"push"](()=>{Tn=je,t(40,Tn)})}function xe(je){$n[je?"unshift":"push"](()=>{on=je,t(28,on)})}const Q=()=>Yt&&Yt.handleFocus(),ne=()=>Yt&&Yt.handleBlur(),ve=je=>{on.focus(),Yt&&Yt.handleClick(w6(je))};function Ce(je){Ut=je,t(24,Ut)}const Be=je=>t(36,Yr=je.detail);function st(je){ln=je,t(31,ln)}const tt=je=>Yt&&Yt.handleMenuItemAction(je.detail.index),He=()=>Yt&&Yt.handleMenuClosing(),ue=()=>Yt&&Yt.handleMenuClosed(),Ye=()=>Yt&&Yt.handleMenuOpened();function ge(je){$n[je?"unshift":"push"](()=>{ri=je,t(25,ri)})}const It=()=>t(37,Hi=void 0),vn=je=>t(30,Nt=je.detail),Wn=je=>t(38,or=je.detail),Vn=()=>{t(30,Nt=void 0),t(38,or=void 0)};return n.$$set=je=>{e=dn(dn({},e),So(je)),t(53,r=Ji(e,i)),"use"in je&&t(2,O=je.use),"class"in je&&t(3,k=je.class),"style"in je&&t(4,z=je.style),"ripple"in je&&t(5,G=je.ripple),"disabled"in je&&t(6,q=je.disabled),"variant"in je&&t(7,Z=je.variant),"noLabel"in je&&t(8,K=je.noLabel),"label"in je&&t(9,te=je.label),"value"in je&&t(0,ie=je.value),"key"in je&&t(55,Te=je.key),"dirty"in je&&t(54,le=je.dirty),"invalid"in je&&t(1,fe=je.invalid),"updateInvalid"in je&&t(56,Fe=je.updateInvalid),"required"in je&&t(10,Ue=je.required),"inputId"in je&&t(11,dt=je.inputId),"hiddenInput"in je&&t(12,Ge=je.hiddenInput),"withLeadingIcon"in je&&t(13,Le=je.withLeadingIcon),"anchor$use"in je&&t(14,nt=je.anchor$use),"anchor$class"in je&&t(15,zt=je.anchor$class),"selectedTextContainer$use"in je&&t(16,Ot=je.selectedTextContainer$use),"selectedTextContainer$class"in je&&t(17,et=je.selectedTextContainer$class),"selectedText$use"in je&&t(18,Ze=je.selectedText$use),"selectedText$class"in je&&t(19,At=je.selectedText$class),"dropdownIcon$use"in je&&t(20,Kt=je.dropdownIcon$use),"dropdownIcon$class"in je&&t(21,sn=je.dropdownIcon$class),"menu$class"in je&&t(22,zn=je.menu$class),"$$scope"in je&&t(86,p=je.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&25165825|n.$$.dirty[2]&1&&vi!==Ut)if(t(62,vi=Ut),Yt)Yt.setSelectedIndex(Ut,!1,!0);else{const je=Mo();ie!==je[Ut]&&t(0,ie=je[Ut])}n.$$.dirty[0]&1&&cv(pn,h=ie,h),n.$$.dirty[0]&8388609|n.$$.dirty[1]&16777216&&Yt&&Yt.getValue()!==Te(ie)&&Yt.setValue(Te(ie)),n.$$.dirty[0]&8388672&&Yt&&Yt.getDisabled()!==q&&Yt.setDisabled(q),n.$$.dirty[0]&8388610|n.$$.dirty[1]&41943040&&Yt&&le&&Yt.isValid()!==!fe&&(Fe?t(1,fe=!Yt.isValid()):Yt.setValid(!fe)),n.$$.dirty[0]&8389632&&Yt&&Yt.getRequired()!==Ue&&Yt.setRequired(Ue)},[ie,fe,O,k,z,G,q,Z,K,te,Ue,dt,Ge,Le,nt,zt,Ot,et,Ze,At,Kt,sn,zn,Yt,Ut,ri,ii,kn,on,Di,Nt,ln,Mt,Un,ti,jr,Yr,Hi,or,$e,Tn,fi,a,I,M,hi,Kn,pn,Rs,mn,jn,ki,x,r,le,Te,Fe,qa,ro,Ia,Rl,Ha,vi,s,aa,Wa,Bs,Ta,Zs,Sa,xe,Q,ne,ve,Ce,Be,st,tt,He,ue,Ye,ge,It,vn,Wn,Vn,p]}class WT extends Fr{constructor(e){super(),Br(this,e,T6,b6,Lr,{use:2,class:3,style:4,ripple:5,disabled:6,variant:7,noLabel:8,label:9,value:0,key:55,dirty:54,invalid:1,updateInvalid:56,required:10,inputId:11,hiddenInput:12,withLeadingIcon:13,anchor$use:14,anchor$class:15,selectedTextContainer$use:16,selectedTextContainer$class:17,selectedText$use:18,selectedText$class:19,dropdownIcon$use:20,dropdownIcon$class:21,menu$class:22,getUseDefaultValidation:57,setUseDefaultValidation:58,focus:59,layout:60,getElement:61},null,[-1,-1,-1,-1])}get getUseDefaultValidation(){return this.$$.ctx[57]}get setUseDefaultValidation(){return this.$$.ctx[58]}get focus(){return this.$$.ctx[59]}get layout(){return this.$$.ctx[60]}get getElement(){return this.$$.ctx[61]}}function S6(n){let e;const t=n[11].default,i=Sr(t,n,n[13],null);return{c(){i&&i.c()},l(r){i&&i.l(r)},m(r,a){i&&i.m(r,a),e=!0},p(r,a){i&&i.p&&(!e||a&8192)&&Cr(i,t,r,r[13],e?Mr(t,r[13],a,null):Ar(r[13]),null)},i(r){e||(Ke(i,r),e=!0)},o(r){rt(i,r),e=!1},d(r){i&&i.d(r)}}}function C6(n){let e,t;const i=[{use:n[3]},{"data-value":n[0]},{value:n[0]},{selected:n[2]},n[6]];let r={$$slots:{default:[S6]},$$scope:{ctx:n}};for(let a=0;a<i.length;a+=1)r=dn(r,i[a]);return e=new t6({props:r}),n[12](e),{c(){Pn(e.$$.fragment)},l(a){Zn(e.$$.fragment,a)},m(a,h){Rn(e,a,h),t=!0},p(a,[h]){const s=h&77?Gi(i,[h&8&&{use:a[3]},h&1&&{"data-value":a[0]},h&1&&{value:a[0]},h&4&&{selected:a[2]},h&64&&kr(a[6])]):{};h&8192&&(s.$$scope={dirty:h,ctx:a}),e.$set(s)},i(a){t||(Ke(e.$$.fragment,a),t=!0)},o(a){rt(e.$$.fragment,a),t=!1},d(a){n[12](null),Dn(e,a)}}}function A6(n,e,t){let i,r;const a=["use","class","value","getElement"];let h=Ji(e,a),s,p,{$$slots:x={},$$scope:I}=e;const C=Uo(zo());let{use:M=[]}=e;const O="";let{value:k=""}=e,z;const G=Ws("SMUI:select:selectedText");id(n,G,ie=>t(14,s=ie));const q=Ws("SMUI:select:value");id(n,q,ie=>t(10,p=ie)),xo("SMUI:list:item:role","option"),Ll(Z),pd(Z);function Z(){r&&z&&cv(G,s=z.getPrimaryText(),s)}function K(){return z.getElement()}function te(ie){$n[ie?"unshift":"push"](()=>{z=ie,t(1,z)})}return n.$$set=ie=>{e=dn(dn({},e),So(ie)),t(6,h=Ji(e,a)),"use"in ie&&t(7,M=ie.use),"value"in ie&&t(0,k=ie.value),"$$scope"in ie&&t(13,I=ie.$$scope)},n.$$.update=()=>{n.$$.dirty&128&&t(3,i=[C,...M]),n.$$.dirty&1025&&t(2,r=k!=null&&k!==""&&p===k)},[k,z,r,i,G,q,h,M,O,K,p,x,te,I]}class DS extends Fr{constructor(e){super(),Br(this,e,A6,C6,Lr,{use:7,class:8,value:0,getElement:9})}get class(){return this.$$.ctx[8]}get getElement(){return this.$$.ctx[9]}}function jA(n,e,t){const i=n.slice();return i[9]=e[t],i}function M6(n){let e,t,i;function r(h){n[7](h)}let a={style:"width: 100%;",min:1,max:1e3,step:1};return n[1]!==void 0&&(a.value=n[1]),e=new jL({props:a}),$n.push(()=>ho(e,"value",r)),{c(){Pn(e.$$.fragment)},l(h){Zn(e.$$.fragment,h)},m(h,s){Rn(e,h,s),i=!0},p(h,s){const p={};!t&&s&2&&(t=!0,p.value=h[1],Eo(()=>t=!1)),e.$set(p)},i(h){i||(Ke(e.$$.fragment,h),i=!0)},o(h){rt(e.$$.fragment,h),i=!1},d(h){Dn(e,h)}}}function L6(n){let e,t,i;function r(h){n[6](h)}let a={style:"width: 100%;",min:1,max:50,step:1};return n[1]!==void 0&&(a.value=n[1]),e=new jL({props:a}),$n.push(()=>ho(e,"value",r)),{c(){Pn(e.$$.fragment)},l(h){Zn(e.$$.fragment,h)},m(h,s){Rn(e,h,s),i=!0},p(h,s){const p={};!t&&s&2&&(t=!0,p.value=h[1],Eo(()=>t=!1)),e.$set(p)},i(h){i||(Ke(e.$$.fragment,h),i=!0)},o(h){rt(e.$$.fragment,h),i=!1},d(h){Dn(e,h)}}}function P6(n){let e=n[9].charAt(0).toUpperCase()+n[9].slice(1)+"",t;return{c(){t=_r(e)},l(i){t=yr(i,e)},m(i,r){Tt(i,t,r)},p:za,d(i){i&&Oe(t)}}}function qA(n){let e,t;return e=new DS({props:{value:n[9],$$slots:{default:[P6]},$$scope:{ctx:n}}}),{c(){Pn(e.$$.fragment)},l(i){Zn(e.$$.fragment,i)},m(i,r){Rn(e,i,r),t=!0},p(i,r){const a={};r&4096&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Ke(e.$$.fragment,i),t=!0)},o(i){rt(e.$$.fragment,i),t=!1},d(i){Dn(e,i)}}}function R6(n){let e,t,i=n[2],r=[];for(let h=0;h<i.length;h+=1)r[h]=qA(jA(n,i,h));const a=h=>rt(r[h],1,1,()=>{r[h]=null});return{c(){for(let h=0;h<r.length;h+=1)r[h].c();e=Ei()},l(h){for(let s=0;s<r.length;s+=1)r[s].l(h);e=Ei()},m(h,s){for(let p=0;p<r.length;p+=1)r[p]&&r[p].m(h,s);Tt(h,e,s),t=!0},p(h,s){if(s&4){i=h[2];let p;for(p=0;p<i.length;p+=1){const x=jA(h,i,p);r[p]?(r[p].p(x,s),Ke(r[p],1)):(r[p]=qA(x),r[p].c(),Ke(r[p],1),r[p].m(e.parentNode,e))}for(vr(),p=i.length;p<r.length;p+=1)a(p);xr()}},i(h){if(!t){for(let s=0;s<i.length;s+=1)Ke(r[s]);t=!0}},o(h){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)rt(r[s]);t=!1},d(h){U1(r,h),h&&Oe(e)}}}function D6(n){let e,t,i,r,a,h=n[1].toFixed(0)+"",s,p,x,I,C,M,O;const k=[L6,M6],z=[];function G(K,te){return K[0]==="kilometers"?0:K[0]==="meters"?1:-1}~(t=G(n))&&(i=z[t]=k[t](n));function q(K){n[8](K)}let Z={label:"Unit: ",$$slots:{default:[R6]},$$scope:{ctx:n}};return n[0]!==void 0&&(Z.value=n[0]),x=new WT({props:Z}),$n.push(()=>ho(x,"value",q)),{c(){e=un("span"),i&&i.c(),r=qn(),a=un("p"),s=_r(h),p=qn(),Pn(x.$$.fragment),C=qn(),M=un("span"),this.h()},l(K){e=cn(K,"SPAN",{style:!0});var te=_n(e);i&&i.l(te),r=Hn(te),a=cn(te,"P",{});var ie=_n(a);s=yr(ie,h),ie.forEach(Oe),te.forEach(Oe),p=Hn(K),Zn(x.$$.fragment,K),C=Hn(K),M=cn(K,"SPAN",{style:!0}),_n(M).forEach(Oe),this.h()},h(){Wu(e,"display","flex"),Wu(e,"align-items","center"),Wu(M,"margin-top","20px")},m(K,te){Tt(K,e,te),~t&&z[t].m(e,null),an(e,r),an(e,a),an(a,s),Tt(K,p,te),Rn(x,K,te),Tt(K,C,te),Tt(K,M,te),O=!0},p(K,[te]){let ie=t;t=G(K),t===ie?~t&&z[t].p(K,te):(i&&(vr(),rt(z[ie],1,1,()=>{z[ie]=null}),xr()),~t?(i=z[t],i?i.p(K,te):(i=z[t]=k[t](K),i.c()),Ke(i,1),i.m(e,r)):i=null),(!O||te&2)&&h!==(h=K[1].toFixed(0)+"")&&Ao(s,h);const Te={};te&4096&&(Te.$$scope={dirty:te,ctx:K}),!I&&te&1&&(I=!0,Te.value=K[0],Eo(()=>I=!1)),x.$set(Te)},i(K){O||(Ke(i),Ke(x.$$.fragment,K),O=!0)},o(K){rt(i),rt(x.$$.fragment,K),O=!1},d(K){K&&Oe(e),~t&&z[t].d(),K&&Oe(p),Dn(x,K),K&&Oe(C),K&&Oe(M)}}}function O6(n,e,t){let{updateOptions:i}=e;const r=["meters","kilometers"];let a="kilometers",h=1,s=h.toString(),p=s;function x(M){h=M,t(1,h),t(4,s),t(5,p),t(3,i),t(0,a)}function I(M){h=M,t(1,h),t(4,s),t(5,p),t(3,i),t(0,a)}function C(M){a=M,t(0,a)}return n.$$set=M=>{"updateOptions"in M&&t(3,i=M.updateOptions)},n.$$.update=()=>{n.$$.dirty&59&&(s&&s!==p&&t(1,h=parseInt(s)),t(4,s=h.toString()),t(5,p=s),i({args:{radius:h,units:a}}))},[a,h,r,i,s,p,x,I,C]}class N6 extends Fr{constructor(e){super(),Br(this,e,O6,D6,Lr,{updateOptions:3})}}function HA(n,e,t){const i=n.slice();return i[7]=e[t],i}function WA(n,e,t){const i=n.slice();return i[7]=e[t],i}function k6(n){let e=n[7].displayName+"",t;return{c(){t=_r(e)},l(i){t=yr(i,e)},m(i,r){Tt(i,t,r)},p(i,r){r&8&&e!==(e=i[7].displayName+"")&&Ao(t,e)},d(i){i&&Oe(t)}}}function XA(n){let e,t;return e=new DS({props:{value:n[7].id,$$slots:{default:[k6]},$$scope:{ctx:n}}}),{c(){Pn(e.$$.fragment)},l(i){Zn(e.$$.fragment,i)},m(i,r){Rn(e,i,r),t=!0},p(i,r){const a={};r&8&&(a.value=i[7].id),r&4104&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Ke(e.$$.fragment,i),t=!0)},o(i){rt(e.$$.fragment,i),t=!1},d(i){Dn(e,i)}}}function F6(n){let e,t,i=n[3],r=[];for(let h=0;h<i.length;h+=1)r[h]=XA(WA(n,i,h));const a=h=>rt(r[h],1,1,()=>{r[h]=null});return{c(){for(let h=0;h<r.length;h+=1)r[h].c();e=Ei()},l(h){for(let s=0;s<r.length;s+=1)r[s].l(h);e=Ei()},m(h,s){for(let p=0;p<r.length;p+=1)r[p]&&r[p].m(h,s);Tt(h,e,s),t=!0},p(h,s){if(s&8){i=h[3];let p;for(p=0;p<i.length;p+=1){const x=WA(h,i,p);r[p]?(r[p].p(x,s),Ke(r[p],1)):(r[p]=XA(x),r[p].c(),Ke(r[p],1),r[p].m(e.parentNode,e))}for(vr(),p=i.length;p<r.length;p+=1)a(p);xr()}},i(h){if(!t){for(let s=0;s<i.length;s+=1)Ke(r[s]);t=!0}},o(h){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)rt(r[s]);t=!1},d(h){U1(r,h),h&&Oe(e)}}}function B6(n){let e=n[7].displayName+"",t;return{c(){t=_r(e)},l(i){t=yr(i,e)},m(i,r){Tt(i,t,r)},p(i,r){r&4&&e!==(e=i[7].displayName+"")&&Ao(t,e)},d(i){i&&Oe(t)}}}function ZA(n){let e,t;return e=new DS({props:{value:n[7].id,$$slots:{default:[B6]},$$scope:{ctx:n}}}),{c(){Pn(e.$$.fragment)},l(i){Zn(e.$$.fragment,i)},m(i,r){Rn(e,i,r),t=!0},p(i,r){const a={};r&4&&(a.value=i[7].id),r&4100&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Ke(e.$$.fragment,i),t=!0)},o(i){rt(e.$$.fragment,i),t=!1},d(i){Dn(e,i)}}}function z6(n){let e,t,i=n[2],r=[];for(let h=0;h<i.length;h+=1)r[h]=ZA(HA(n,i,h));const a=h=>rt(r[h],1,1,()=>{r[h]=null});return{c(){for(let h=0;h<r.length;h+=1)r[h].c();e=Ei()},l(h){for(let s=0;s<r.length;s+=1)r[s].l(h);e=Ei()},m(h,s){for(let p=0;p<r.length;p+=1)r[p]&&r[p].m(h,s);Tt(h,e,s),t=!0},p(h,s){if(s&4){i=h[2];let p;for(p=0;p<i.length;p+=1){const x=HA(h,i,p);r[p]?(r[p].p(x,s),Ke(r[p],1)):(r[p]=ZA(x),r[p].c(),Ke(r[p],1),r[p].m(e.parentNode,e))}for(vr(),p=i.length;p<r.length;p+=1)a(p);xr()}},i(h){if(!t){for(let s=0;s<i.length;s+=1)Ke(r[s]);t=!0}},o(h){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)rt(r[s]);t=!1},d(h){U1(r,h),h&&Oe(e)}}}function U6(n){let e,t,i,r,a,h,s,p;function x(O){n[5](O)}let I={label:"Layer A",$$slots:{default:[F6]},$$scope:{ctx:n}};n[0]!==void 0&&(I.value=n[0]),e=new WT({props:I}),$n.push(()=>ho(e,"value",x));function C(O){n[6](O)}let M={label:"Layer B",$$slots:{default:[z6]},$$scope:{ctx:n}};return n[1]!==void 0&&(M.value=n[1]),r=new WT({props:M}),$n.push(()=>ho(r,"value",C)),{c(){Pn(e.$$.fragment),i=qn(),Pn(r.$$.fragment),h=qn(),s=un("span"),this.h()},l(O){Zn(e.$$.fragment,O),i=Hn(O),Zn(r.$$.fragment,O),h=Hn(O),s=cn(O,"SPAN",{style:!0}),_n(s).forEach(Oe),this.h()},h(){Wu(s,"margin-top","20px")},m(O,k){Rn(e,O,k),Tt(O,i,k),Rn(r,O,k),Tt(O,h,k),Tt(O,s,k),p=!0},p(O,[k]){const z={};k&4104&&(z.$$scope={dirty:k,ctx:O}),!t&&k&1&&(t=!0,z.value=O[0],Eo(()=>t=!1)),e.$set(z);const G={};k&4100&&(G.$$scope={dirty:k,ctx:O}),!a&&k&2&&(a=!0,G.value=O[1],Eo(()=>a=!1)),r.$set(G)},i(O){p||(Ke(e.$$.fragment,O),Ke(r.$$.fragment,O),p=!0)},o(O){rt(e.$$.fragment,O),rt(r.$$.fragment,O),p=!1},d(O){Dn(e,O),O&&Oe(i),Dn(r,O),O&&Oe(h),O&&Oe(s)}}}function V6(n,e,t){let i,r,{updateOptions:a}=e,h,s;function p(I){h=I,t(0,h)}function x(I){s=I,t(1,s)}return n.$$set=I=>{"updateOptions"in I&&t(4,a=I.updateOptions)},n.$$.update=()=>{n.$$.dirty&2&&t(3,i=Xp(bo).filter(I=>I.id!==s)),n.$$.dirty&1&&t(2,r=Xp(bo).filter(I=>I.id!==h)),n.$$.dirty&19&&a({args:{layerA:Xp(bo).find(I=>I.id===h),layerB:Xp(bo).find(I=>I.id===s)},layerSelection:Xp(bo).filter(I=>[h,s].includes(I.id))})},[h,s,r,i,a,p,x]}class G6 extends Fr{constructor(e){super(),Br(this,e,V6,U6,Lr,{updateOptions:4})}}function j6(n){let e;return{c(){e=_r("arrow_forward")},l(t){e=yr(t,"arrow_forward")},m(t,i){Tt(t,e,i)},d(t){t&&Oe(e)}}}function q6(n){let e;return{c(){e=_r("mode_edit")},l(t){e=yr(t,"mode_edit")},m(t,i){Tt(t,e,i)},d(t){t&&Oe(e)}}}function H6(n){let e,t,i,r,a,h,s,p,x,I;return a=new sS({props:{class:"material-icons",on:!0,$$slots:{default:[j6]},$$scope:{ctx:n}}}),p=new hg({props:{class:"material-icons",$$slots:{default:[q6]},$$scope:{ctx:n}}}),p.$on("click",n[1]),{c(){e=un("div"),t=un("h4"),i=_r("Draw bounding box"),r=qn(),Pn(a.$$.fragment),h=qn(),s=un("span"),Pn(p.$$.fragment),this.h()},l(C){e=cn(C,"DIV",{style:!0});var M=_n(e);t=cn(M,"H4",{});var O=_n(t);i=yr(O,"Draw bounding box"),O.forEach(Oe),r=Hn(M),Zn(a.$$.fragment,M),h=Hn(M),s=cn(M,"SPAN",{class:!0});var k=_n(s);Zn(p.$$.fragment,k),k.forEach(Oe),M.forEach(Oe),this.h()},h(){tn(s,"class",x=eC(n[0]?"drawing":"")+" svelte-1pq5lgy"),Wu(e,"display","flex"),Wu(e,"align-items","center")},m(C,M){Tt(C,e,M),an(e,t),an(t,i),an(e,r),Rn(a,e,null),an(e,h),an(e,s),Rn(p,s,null),I=!0},p(C,[M]){const O={};M&64&&(O.$$scope={dirty:M,ctx:C}),a.$set(O);const k={};M&64&&(k.$$scope={dirty:M,ctx:C}),p.$set(k),(!I||M&1&&x!==(x=eC(C[0]?"drawing":"")+" svelte-1pq5lgy"))&&tn(s,"class",x)},i(C){I||(Ke(a.$$.fragment,C),Ke(p.$$.fragment,C),I=!0)},o(C){rt(a.$$.fragment,C),rt(p.$$.fragment,C),I=!1},d(C){C&&Oe(e),Dn(a),Dn(p)}}}function W6(n,e,t){let{updateOptions:i}=e,{map:r}=e,{draw:a}=e,h=a.getMode()==="draw_rectangle",s;function p(){a.getMode()==="draw_rectangle"?a.changeMode("simple_select"):a.changeMode("draw_rectangle"),t(0,h=!h)}return r.on("draw.create",x=>{const I=x.features[0];!Vv(I)||!Mc(I.geometry)||(t(5,s={id:I.id,bbox:Jm(I.geometry)}),t(0,h=!h))}),n.$$set=x=>{"updateOptions"in x&&t(2,i=x.updateOptions),"map"in x&&t(3,r=x.map),"draw"in x&&t(4,a=x.draw)},n.$$.update=()=>{n.$$.dirty&52&&s&&i({args:{bbox:s.bbox}},()=>{a.delete(s.id),console.log(a.getAll())})},[h,p,i,r,a,s]}class X6 extends Fr{constructor(e){super(),Br(this,e,W6,H6,Lr,{updateOptions:2,map:3,draw:4})}}function Z6(n){let e;return{c(){e=_r("Draw new BBox")},l(t){e=yr(t,"Draw new BBox")},m(t,i){Tt(t,e,i)},d(t){t&&Oe(e)}}}function Y6(n){let e,t;return e=new rS({props:{$$slots:{default:[Z6]},$$scope:{ctx:n}}}),{c(){Pn(e.$$.fragment)},l(i){Zn(e.$$.fragment,i)},m(i,r){Rn(e,i,r),t=!0},p(i,r){const a={};r&128&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(Ke(e.$$.fragment,i),t=!0)},o(i){rt(e.$$.fragment,i),t=!1},d(i){Dn(e,i)}}}function K6(n){let e,t,i,r;function a(s){n[5](s)}let h={variant:"unelevated",$$slots:{default:[Y6]},$$scope:{ctx:n}};return n[0]!==void 0&&(h.disabled=n[0]),t=new _1({props:h}),$n.push(()=>ho(t,"disabled",a)),t.$on("click",n[6]),{c(){e=un("span"),Pn(t.$$.fragment),this.h()},l(s){e=cn(s,"SPAN",{class:!0});var p=_n(e);Zn(t.$$.fragment,p),p.forEach(Oe),this.h()},h(){tn(e,"class","draw-btn svelte-1big6lk")},m(s,p){Tt(s,e,p),Rn(t,e,null),r=!0},p(s,[p]){const x={};p&128&&(x.$$scope={dirty:p,ctx:s}),!i&&p&1&&(i=!0,x.disabled=s[0],Eo(()=>i=!1)),t.$set(x)},i(s){r||(Ke(t.$$.fragment,s),r=!0)},o(s){rt(t.$$.fragment,s),r=!1},d(s){s&&Oe(e),Dn(t)}}}function J6(n,e,t){let{updateOptions:i}=e,{map:r}=e,{draw:a}=e,h=!0,s;r.on("draw.create",I=>{const C=I.features[0];!Vv(C)||!Mc(C.geometry)||(s&&a.delete(s.id),t(4,s={id:C.id,bbox:Jm(C.geometry)}),t(0,h=!1))});function p(I){h=I,t(0,h)}const x=()=>{t(0,h=!0)};return n.$$set=I=>{"updateOptions"in I&&t(1,i=I.updateOptions),"map"in I&&t(2,r=I.map),"draw"in I&&t(3,a=I.draw)},n.$$.update=()=>{n.$$.dirty&9&&(h?a.changeMode("draw_rectangle"):a.changeMode("simple_select")),n.$$.dirty&26&&s&&i({args:{bbox:s.bbox}},()=>{a.delete(s.id)})},[h,i,r,a,s,p,x]}class Q6 extends Fr{constructor(e){super(),Br(this,e,J6,K6,Lr,{updateOptions:1,map:2,draw:3})}}/*!
 * iro.js v5.5.2
 * 2016-2021 James Daniel
 * Licensed under MPL 2.0
 * github.com/jaames/iro.js
 */var $o,FE,YL,XT,KL,Wm={},OS=[],$6=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i;function Gm(n,e){for(var t in e)n[t]=e[t];return n}function JL(n){var e=n.parentNode;e&&e.removeChild(n)}function eo(n,e,t){var i,r,a,h,s=arguments;if(e=Gm({},e),arguments.length>3)for(t=[t],i=3;i<arguments.length;i++)t.push(s[i]);if(t!=null&&(e.children=t),n!=null&&n.defaultProps!=null)for(r in n.defaultProps)e[r]===void 0&&(e[r]=n.defaultProps[r]);return h=e.key,(a=e.ref)!=null&&delete e.ref,h!=null&&delete e.key,ZT(n,e,h,a)}function ZT(n,e,t,i){var r={type:n,props:e,key:t,ref:i,__k:null,__p:null,__b:0,__e:null,l:null,__c:null,constructor:void 0};return $o.vnode&&$o.vnode(r),r}function rw(n){return n.children}function eU(n){if(n==null||typeof n=="boolean")return null;if(typeof n=="string"||typeof n=="number")return ZT(null,n,null,null);if(n.__e!=null||n.__c!=null){var e=ZT(n.type,n.props,n.key,null);return e.__e=n.__e,e}return n}function uv(n,e){this.props=n,this.context=e}function BE(n,e){if(e==null)return n.__p?BE(n.__p,n.__p.__k.indexOf(n)+1):null;for(var t;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null)return t.__e;return typeof n.type=="function"?BE(n):null}function QL(n){var e,t;if((n=n.__p)!=null&&n.__c!=null){for(n.__e=n.__c.base=null,e=0;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null){n.__e=n.__c.base=t.__e;break}return QL(n)}}function _T(n){(!n.__d&&(n.__d=!0)&&FE.push(n)===1||XT!==$o.debounceRendering)&&(XT=$o.debounceRendering,($o.debounceRendering||YL)(tU))}function tU(){var n,e,t,i,r,a,h,s;for(FE.sort(function(p,x){return x.__v.__b-p.__v.__b});n=FE.pop();)n.__d&&(t=void 0,i=void 0,a=(r=(e=n).__v).__e,h=e.__P,s=e.u,e.u=!1,h&&(t=[],i=kS(h,r,Gm({},r),e.__n,h.ownerSVGElement!==void 0,null,t,s,a??BE(r)),eP(t,r),i!=a&&QL(r)))}function $L(n,e,t,i,r,a,h,s,p){var x,I,C,M,O,k,z,G=t&&t.__k||OS,q=G.length;if(s==Wm&&(s=a!=null?a[0]:q?BE(t,0):null),x=0,e.__k=NS(e.__k,function(Z){if(Z!=null){if(Z.__p=e,Z.__b=e.__b+1,(C=G[x])===null||C&&Z.key==C.key&&Z.type===C.type)G[x]=void 0;else for(I=0;I<q;I++){if((C=G[I])&&Z.key==C.key&&Z.type===C.type){G[I]=void 0;break}C=null}if(M=kS(n,Z,C=C||Wm,i,r,a,h,null,s,p),(I=Z.ref)&&C.ref!=I&&(z||(z=[])).push(I,Z.__c||M,Z),M!=null){if(k==null&&(k=M),Z.l!=null)M=Z.l,Z.l=null;else if(a==C||M!=s||M.parentNode==null){e:if(s==null||s.parentNode!==n)n.appendChild(M);else{for(O=s,I=0;(O=O.nextSibling)&&I<q;I+=2)if(O==M)break e;n.insertBefore(M,s)}e.type=="option"&&(n.value="")}s=M.nextSibling,typeof e.type=="function"&&(e.l=M)}}return x++,Z}),e.__e=k,a!=null&&typeof e.type!="function")for(x=a.length;x--;)a[x]!=null&&JL(a[x]);for(x=q;x--;)G[x]!=null&&nP(G[x],G[x]);if(z)for(x=0;x<z.length;x++)tP(z[x],z[++x],z[++x])}function NS(n,e,t){if(t==null&&(t=[]),n==null||typeof n=="boolean")e&&t.push(e(null));else if(Array.isArray(n))for(var i=0;i<n.length;i++)NS(n[i],e,t);else t.push(e?e(eU(n)):n);return t}function nU(n,e,t,i,r){var a;for(a in t)a in e||KA(n,a,null,t[a],i);for(a in e)r&&typeof e[a]!="function"||a==="value"||a==="checked"||t[a]===e[a]||KA(n,a,e[a],t[a],i)}function YA(n,e,t){e[0]==="-"?n.setProperty(e,t):n[e]=typeof t=="number"&&$6.test(e)===!1?t+"px":t??""}function KA(n,e,t,i,r){var a,h,s,p,x;if(!((e=r?e==="className"?"class":e:e==="class"?"className":e)==="key"||e==="children"))if(e==="style")if(a=n.style,typeof t=="string")a.cssText=t;else{if(typeof i=="string"&&(a.cssText="",i=null),i)for(h in i)t&&h in t||YA(a,h,"");if(t)for(s in t)i&&t[s]===i[s]||YA(a,s,t[s])}else e[0]==="o"&&e[1]==="n"?(p=e!==(e=e.replace(/Capture$/,"")),x=e.toLowerCase(),e=(x in n?x:e).slice(2),t?(i||n.addEventListener(e,JA,p),(n.t||(n.t={}))[e]=t):n.removeEventListener(e,JA,p)):e!=="list"&&e!=="tagName"&&e!=="form"&&!r&&e in n?n[e]=t??"":typeof t!="function"&&e!=="dangerouslySetInnerHTML"&&(e!==(e=e.replace(/^xlink:?/,""))?t==null||t===!1?n.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):n.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),t):t==null||t===!1?n.removeAttribute(e):n.setAttribute(e,t))}function JA(n){return this.t[n.type]($o.event?$o.event(n):n)}function kS(n,e,t,i,r,a,h,s,p,x){var I,C,M,O,k,z,G,q,Z,K,te=e.type;if(e.constructor!==void 0)return null;(I=$o.__b)&&I(e);try{e:if(typeof te=="function"){if(q=e.props,Z=(I=te.contextType)&&i[I.__c],K=I?Z?Z.props.value:I.__p:i,t.__c?G=(C=e.__c=t.__c).__p=C.__E:("prototype"in te&&te.prototype.render?e.__c=C=new te(q,K):(e.__c=C=new uv(q,K),C.constructor=te,C.render=rU),Z&&Z.sub(C),C.props=q,C.state||(C.state={}),C.context=K,C.__n=i,M=C.__d=!0,C.__h=[]),C.__s==null&&(C.__s=C.state),te.getDerivedStateFromProps!=null&&Gm(C.__s==C.state?C.__s=Gm({},C.__s):C.__s,te.getDerivedStateFromProps(q,C.__s)),M)te.getDerivedStateFromProps==null&&C.componentWillMount!=null&&C.componentWillMount(),C.componentDidMount!=null&&h.push(C);else{if(te.getDerivedStateFromProps==null&&s==null&&C.componentWillReceiveProps!=null&&C.componentWillReceiveProps(q,K),!s&&C.shouldComponentUpdate!=null&&C.shouldComponentUpdate(q,C.__s,K)===!1){for(C.props=q,C.state=C.__s,C.__d=!1,C.__v=e,e.__e=p!=null?p!==t.__e?p:t.__e:null,e.__k=t.__k,I=0;I<e.__k.length;I++)e.__k[I]&&(e.__k[I].__p=e);break e}C.componentWillUpdate!=null&&C.componentWillUpdate(q,C.__s,K)}for(O=C.props,k=C.state,C.context=K,C.props=q,C.state=C.__s,(I=$o.__r)&&I(e),C.__d=!1,C.__v=e,C.__P=n,I=C.render(C.props,C.state,C.context),e.__k=NS(I!=null&&I.type==rw&&I.key==null?I.props.children:I),C.getChildContext!=null&&(i=Gm(Gm({},i),C.getChildContext())),M||C.getSnapshotBeforeUpdate==null||(z=C.getSnapshotBeforeUpdate(O,k)),$L(n,e,t,i,r,a,h,p,x),C.base=e.__e;I=C.__h.pop();)C.__s&&(C.state=C.__s),I.call(C);M||O==null||C.componentDidUpdate==null||C.componentDidUpdate(O,k,z),G&&(C.__E=C.__p=null)}else e.__e=iU(t.__e,e,t,i,r,a,h,x);(I=$o.diffed)&&I(e)}catch(ie){$o.__e(ie,e,t)}return e.__e}function eP(n,e){for(var t;t=n.pop();)try{t.componentDidMount()}catch(i){$o.__e(i,t.__v)}$o.__c&&$o.__c(e)}function iU(n,e,t,i,r,a,h,s){var p,x,I,C,M=t.props,O=e.props;if(r=e.type==="svg"||r,n==null&&a!=null){for(p=0;p<a.length;p++)if((x=a[p])!=null&&(e.type===null?x.nodeType===3:x.localName===e.type)){n=x,a[p]=null;break}}if(n==null){if(e.type===null)return document.createTextNode(O);n=r?document.createElementNS("http://www.w3.org/2000/svg",e.type):document.createElement(e.type),a=null}return e.type===null?M!==O&&(a!=null&&(a[a.indexOf(n)]=null),n.data=O):e!==t&&(a!=null&&(a=OS.slice.call(n.childNodes)),I=(M=t.props||Wm).dangerouslySetInnerHTML,C=O.dangerouslySetInnerHTML,s||(C||I)&&(C&&I&&C.__html==I.__html||(n.innerHTML=C&&C.__html||"")),nU(n,O,M,r,s),e.__k=e.props.children,C||$L(n,e,t,i,e.type!=="foreignObject"&&r,a,h,Wm,s),s||("value"in O&&O.value!==void 0&&O.value!==n.value&&(n.value=O.value==null?"":O.value),"checked"in O&&O.checked!==void 0&&O.checked!==n.checked&&(n.checked=O.checked))),n}function tP(n,e,t){try{typeof n=="function"?n(e):n.current=e}catch(i){$o.__e(i,t)}}function nP(n,e,t){var i,r,a;if($o.unmount&&$o.unmount(n),(i=n.ref)&&tP(i,null,e),t||typeof n.type=="function"||(t=(r=n.__e)!=null),n.__e=n.l=null,(i=n.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(h){$o.__e(h,e)}i.base=i.__P=null}if(i=n.__k)for(a=0;a<i.length;a++)i[a]&&nP(i[a],e,t);r!=null&&JL(r)}function rU(n,e,t){return this.constructor(n,t)}function sU(n,e,t){var i,r,a;$o.__p&&$o.__p(n,e),r=(i=t===KL)?null:t&&t.__k||e.__k,n=eo(rw,null,[n]),a=[],kS(e,i?e.__k=n:(t||e).__k=n,r||Wm,Wm,e.ownerSVGElement!==void 0,t&&!i?[t]:r?null:OS.slice.call(e.childNodes),a,!1,t||Wm,i),eP(a,n)}$o={},uv.prototype.setState=function(n,e){var t=this.__s!==this.state&&this.__s||(this.__s=Gm({},this.state));(typeof n!="function"||(n=n(t,this.props)))&&Gm(t,n),n!=null&&this.__v&&(this.u=!1,e&&this.__h.push(e),_T(this))},uv.prototype.forceUpdate=function(n){this.__v&&(n&&this.__h.push(n),this.u=!0,_T(this))},uv.prototype.render=rw,FE=[],YL=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,XT=$o.debounceRendering,$o.__e=function(n,e,t){for(var i;e=e.__p;)if((i=e.__c)&&!i.__p)try{if(i.constructor&&i.constructor.getDerivedStateFromError!=null)i.setState(i.constructor.getDerivedStateFromError(n));else{if(i.componentDidCatch==null)continue;i.componentDidCatch(n)}return _T(i.__E=i)}catch(r){n=r}throw n},KL=Wm;function QA(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function oU(n,e,t){return e&&QA(n.prototype,e),t&&QA(n,t),n}function Ac(){return Ac=Object.assign||function(n){for(var e=arguments,t=1;t<arguments.length;t++){var i=e[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n},Ac.apply(this,arguments)}var aU="[-\\+]?\\d+%?",lU="[-\\+]?\\d*\\.\\d+%?",l_="(?:"+lU+")|(?:"+aU+")",iP="[\\s|\\(]+("+l_+")[,|\\s]+("+l_+")[,|\\s]+("+l_+")\\s*\\)?",rP="[\\s|\\(]+("+l_+")[,|\\s]+("+l_+")[,|\\s]+("+l_+")[,|\\s]+("+l_+")\\s*\\)?",uU=new RegExp("rgb"+iP),cU=new RegExp("rgba"+rP),hU=new RegExp("hsl"+iP),fU=new RegExp("hsla"+rP),sw="^(?:#?|0x?)",u_="([0-9a-fA-F]{1})",c_="([0-9a-fA-F]{2})",dU=new RegExp(sw+u_+u_+u_+"$"),pU=new RegExp(sw+u_+u_+u_+u_+"$"),mU=new RegExp(sw+c_+c_+c_+"$"),gU=new RegExp(sw+c_+c_+c_+c_+"$"),_U=2e3,yU=4e4,nE=Math.log,Hy=Math.round,l1=Math.floor;function tf(n,e,t){return Math.min(Math.max(n,e),t)}function Tc(n,e){var t=n.indexOf("%")>-1,i=parseFloat(n);return t?e/100*i:i}function Sc(n){return parseInt(n,16)}function o_(n){return n.toString(16).padStart(2,"0")}var tv=function(){function n(t,i){this.$={h:0,s:0,v:0,a:1},t&&this.set(t),this.onChange=i,this.initialValue=Ac({},this.$)}var e=n.prototype;return e.set=function(i){if(typeof i=="string")/^(?:#?|0x?)[0-9a-fA-F]{3,8}$/.test(i)?this.hexString=i:/^rgba?/.test(i)?this.rgbString=i:/^hsla?/.test(i)&&(this.hslString=i);else if(typeof i=="object")i instanceof n?this.hsva=i.hsva:"r"in i&&"g"in i&&"b"in i?this.rgb=i:"h"in i&&"s"in i&&"v"in i?this.hsv=i:"h"in i&&"s"in i&&"l"in i?this.hsl=i:"kelvin"in i&&(this.kelvin=i.kelvin);else throw new Error("Invalid color value")},e.setChannel=function(i,r,a){var h;this[i]=Ac({},this[i],(h={},h[r]=a,h))},e.reset=function(){this.hsva=this.initialValue},e.clone=function(){return new n(this)},e.unbind=function(){this.onChange=void 0},n.hsvToRgb=function(i){var r=i.h/60,a=i.s/100,h=i.v/100,s=l1(r),p=r-s,x=h*(1-a),I=h*(1-p*a),C=h*(1-(1-p)*a),M=s%6,O=[h,I,x,x,C,h][M],k=[C,h,h,I,x,x][M],z=[x,x,C,h,h,I][M];return{r:tf(O*255,0,255),g:tf(k*255,0,255),b:tf(z*255,0,255)}},n.rgbToHsv=function(i){var r=i.r/255,a=i.g/255,h=i.b/255,s=Math.max(r,a,h),p=Math.min(r,a,h),x=s-p,I=0,C=s,M=s===0?0:x/s;switch(s){case p:I=0;break;case r:I=(a-h)/x+(a<h?6:0);break;case a:I=(h-r)/x+2;break;case h:I=(r-a)/x+4;break}return{h:I*60%360,s:tf(M*100,0,100),v:tf(C*100,0,100)}},n.hsvToHsl=function(i){var r=i.s/100,a=i.v/100,h=(2-r)*a,s=h<=1?h:2-h,p=s<1e-9?0:r*a/s;return{h:i.h,s:tf(p*100,0,100),l:tf(h*50,0,100)}},n.hslToHsv=function(i){var r=i.l*2,a=i.s*(r<=100?r:200-r)/100,h=r+a<1e-9?0:2*a/(r+a);return{h:i.h,s:tf(h*100,0,100),v:tf((r+a)/2,0,100)}},n.kelvinToRgb=function(i){var r=i/100,a,h,s;return r<66?(a=255,h=-155.25485562709179-.44596950469579133*(h=r-2)+104.49216199393888*nE(h),s=r<20?0:-254.76935184120902+.8274096064007395*(s=r-10)+115.67994401066147*nE(s)):(a=351.97690566805693+.114206453784165*(a=r-55)-40.25366309332127*nE(a),h=325.4494125711974+.07943456536662342*(h=r-50)-28.0852963507957*nE(h),s=255),{r:tf(l1(a),0,255),g:tf(l1(h),0,255),b:tf(l1(s),0,255)}},n.rgbToKelvin=function(i){for(var r=i.r,a=i.b,h=.4,s=_U,p=yU,x;p-s>h;){x=(p+s)*.5;var I=n.kelvinToRgb(x);I.b/I.r>=a/r?p=x:s=x}return x},oU(n,[{key:"hsv",get:function(){var i=this.$;return{h:i.h,s:i.s,v:i.v}},set:function(i){var r=this.$;if(i=Ac({},r,i),this.onChange){var a={h:!1,v:!1,s:!1,a:!1};for(var h in r)a[h]=i[h]!=r[h];this.$=i,(a.h||a.s||a.v||a.a)&&this.onChange(this,a)}else this.$=i}},{key:"hsva",get:function(){return Ac({},this.$)},set:function(i){this.hsv=i}},{key:"hue",get:function(){return this.$.h},set:function(i){this.hsv={h:i}}},{key:"saturation",get:function(){return this.$.s},set:function(i){this.hsv={s:i}}},{key:"value",get:function(){return this.$.v},set:function(i){this.hsv={v:i}}},{key:"alpha",get:function(){return this.$.a},set:function(i){this.hsv=Ac({},this.hsv,{a:i})}},{key:"kelvin",get:function(){return n.rgbToKelvin(this.rgb)},set:function(i){this.rgb=n.kelvinToRgb(i)}},{key:"red",get:function(){var i=this.rgb;return i.r},set:function(i){this.rgb=Ac({},this.rgb,{r:i})}},{key:"green",get:function(){var i=this.rgb;return i.g},set:function(i){this.rgb=Ac({},this.rgb,{g:i})}},{key:"blue",get:function(){var i=this.rgb;return i.b},set:function(i){this.rgb=Ac({},this.rgb,{b:i})}},{key:"rgb",get:function(){var i=n.hsvToRgb(this.$),r=i.r,a=i.g,h=i.b;return{r:Hy(r),g:Hy(a),b:Hy(h)}},set:function(i){this.hsv=Ac({},n.rgbToHsv(i),{a:i.a===void 0?1:i.a})}},{key:"rgba",get:function(){return Ac({},this.rgb,{a:this.alpha})},set:function(i){this.rgb=i}},{key:"hsl",get:function(){var i=n.hsvToHsl(this.$),r=i.h,a=i.s,h=i.l;return{h:Hy(r),s:Hy(a),l:Hy(h)}},set:function(i){this.hsv=Ac({},n.hslToHsv(i),{a:i.a===void 0?1:i.a})}},{key:"hsla",get:function(){return Ac({},this.hsl,{a:this.alpha})},set:function(i){this.hsl=i}},{key:"rgbString",get:function(){var i=this.rgb;return"rgb("+i.r+", "+i.g+", "+i.b+")"},set:function(i){var r,a,h,s,p=1;if((r=uU.exec(i))?(a=Tc(r[1],255),h=Tc(r[2],255),s=Tc(r[3],255)):(r=cU.exec(i))&&(a=Tc(r[1],255),h=Tc(r[2],255),s=Tc(r[3],255),p=Tc(r[4],1)),r)this.rgb={r:a,g:h,b:s,a:p};else throw new Error("Invalid rgb string")}},{key:"rgbaString",get:function(){var i=this.rgba;return"rgba("+i.r+", "+i.g+", "+i.b+", "+i.a+")"},set:function(i){this.rgbString=i}},{key:"hexString",get:function(){var i=this.rgb;return"#"+o_(i.r)+o_(i.g)+o_(i.b)},set:function(i){var r,a,h,s,p=255;if((r=dU.exec(i))?(a=Sc(r[1])*17,h=Sc(r[2])*17,s=Sc(r[3])*17):(r=pU.exec(i))?(a=Sc(r[1])*17,h=Sc(r[2])*17,s=Sc(r[3])*17,p=Sc(r[4])*17):(r=mU.exec(i))?(a=Sc(r[1]),h=Sc(r[2]),s=Sc(r[3])):(r=gU.exec(i))&&(a=Sc(r[1]),h=Sc(r[2]),s=Sc(r[3]),p=Sc(r[4])),r)this.rgb={r:a,g:h,b:s,a:p/255};else throw new Error("Invalid hex string")}},{key:"hex8String",get:function(){var i=this.rgba;return"#"+o_(i.r)+o_(i.g)+o_(i.b)+o_(l1(i.a*255))},set:function(i){this.hexString=i}},{key:"hslString",get:function(){var i=this.hsl;return"hsl("+i.h+", "+i.s+"%, "+i.l+"%)"},set:function(i){var r,a,h,s,p=1;if((r=hU.exec(i))?(a=Tc(r[1],360),h=Tc(r[2],100),s=Tc(r[3],100)):(r=fU.exec(i))&&(a=Tc(r[1],360),h=Tc(r[2],100),s=Tc(r[3],100),p=Tc(r[4],1)),r)this.hsl={h:a,s:h,l:s,a:p};else throw new Error("Invalid hsl string")}},{key:"hslaString",get:function(){var i=this.hsla;return"hsla("+i.h+", "+i.s+"%, "+i.l+"%, "+i.a+")"},set:function(i){this.hslString=i}}]),n}(),vU={sliderShape:"bar",sliderType:"value",minTemperature:2200,maxTemperature:11e3};function FS(n){var e,t=n.width,i=n.sliderSize,r=n.borderWidth,a=n.handleRadius,h=n.padding,s=n.sliderShape,p=n.layoutDirection==="horizontal";return i=(e=i)!=null?e:h*2+a*2,s==="circle"?{handleStart:n.padding+n.handleRadius,handleRange:t-h*2-a*2,width:t,height:t,cx:t/2,cy:t/2,radius:t/2-r/2}:{handleStart:i/2,handleRange:t-i,radius:i/2,x:0,y:0,width:p?i:t,height:p?t:i}}function xU(n,e){var t=e.hsva,i=e.rgb;switch(n.sliderType){case"red":return i.r/2.55;case"green":return i.g/2.55;case"blue":return i.b/2.55;case"alpha":return t.a*100;case"kelvin":var r=n.minTemperature,a=n.maxTemperature,h=a-r,s=(e.kelvin-r)/h*100;return Math.max(0,Math.min(s,100));case"hue":return t.h/=3.6;case"saturation":return t.s;case"value":default:return t.v}}function bU(n,e,t){var i=FS(n),r=i.handleRange,a=i.handleStart,h;n.layoutDirection==="horizontal"?h=-1*t+r+a:h=e-a,h=Math.max(Math.min(h,r),0);var s=Math.round(100/r*h);switch(n.sliderType){case"kelvin":var p=n.minTemperature,x=n.maxTemperature,I=x-p;return p+I*(s/100);case"alpha":return s/100;case"hue":return s*3.6;case"red":case"blue":case"green":return s*2.55;default:return s}}function EU(n,e){var t=FS(n),i=t.width,r=t.height,a=t.handleRange,h=t.handleStart,s=n.layoutDirection==="horizontal",p=xU(n,e),x=s?i/2:r/2,I=h+p/100*a;return s&&(I=-1*I+a+h*2),{x:s?x:I,y:s?I:x}}function wU(n,e){var t=e.hsv,i=e.rgb;switch(n.sliderType){case"red":return[[0,"rgb(0,"+i.g+","+i.b+")"],[100,"rgb(255,"+i.g+","+i.b+")"]];case"green":return[[0,"rgb("+i.r+",0,"+i.b+")"],[100,"rgb("+i.r+",255,"+i.b+")"]];case"blue":return[[0,"rgb("+i.r+","+i.g+",0)"],[100,"rgb("+i.r+","+i.g+",255)"]];case"alpha":return[[0,"rgba("+i.r+","+i.g+","+i.b+",0)"],[100,"rgb("+i.r+","+i.g+","+i.b+")"]];case"kelvin":for(var r=[],a=n.minTemperature,h=n.maxTemperature,s=8,p=h-a,x=a,I=0;x<h;x+=p/s,I+=1){var C=tv.kelvinToRgb(x),M=C.r,O=C.g,k=C.b;r.push([100/s*I,"rgb("+M+","+O+","+k+")"])}return r;case"hue":return[[0,"#f00"],[16.666,"#ff0"],[33.333,"#0f0"],[50,"#0ff"],[66.666,"#00f"],[83.333,"#f0f"],[100,"#f00"]];case"saturation":var z=tv.hsvToHsl({h:t.h,s:0,v:t.v}),G=tv.hsvToHsl({h:t.h,s:100,v:t.v});return[[0,"hsl("+z.h+","+z.s+"%,"+z.l+"%)"],[100,"hsl("+G.h+","+G.s+"%,"+G.l+"%)"]];case"value":default:var q=tv.hsvToHsl({h:t.h,s:t.s,v:100});return[[0,"#000"],[100,"hsl("+q.h+","+q.s+"%,"+q.l+"%)"]]}}var sP=Math.PI*2,IU=function(e,t){return(e%t+t)%t},oP=function(e,t){return Math.sqrt(e*e+t*t)};function aP(n){return n.width/2-n.padding-n.handleRadius-n.borderWidth}function TU(n,e,t){var i=ow(n),r=i.cx,a=i.cy,h=n.width/2;return oP(r-e,a-t)<h}function ow(n){var e=n.width/2;return{width:n.width,radius:e-n.borderWidth,cx:e,cy:e}}function lP(n,e,t){var i=n.wheelAngle,r=n.wheelDirection;return t&&r==="clockwise"?e=i+e:r==="clockwise"?e=360-i+e:t&&r==="anticlockwise"?e=i+180-e:r==="anticlockwise"&&(e=i-e),IU(e,360)}function SU(n,e){var t=e.hsv,i=ow(n),r=i.cx,a=i.cy,h=aP(n),s=(180+lP(n,t.h,!0))*(sP/360),p=t.s/100*h,x=n.wheelDirection==="clockwise"?-1:1;return{x:r+p*Math.cos(s)*x,y:a+p*Math.sin(s)*x}}function $A(n,e,t){var i=ow(n),r=i.cx,a=i.cy,h=aP(n);e=r-e,t=a-t;var s=lP(n,Math.atan2(-t,-e)*(360/sP)),p=Math.min(oP(e,t),h);return{h:Math.round(s),s:Math.round(100/h*p)}}function BS(n){var e=n.width,t=n.boxHeight,i=n.padding,r=n.handleRadius;return{width:e,height:t??e,radius:i+r}}function eM(n,e,t){var i=BS(n),r=i.width,a=i.height,h=i.radius,s=h,p=r-h*2,x=a-h*2,I=(e-s)/p*100,C=(t-s)/x*100;return{s:Math.max(0,Math.min(I,100)),v:Math.max(0,Math.min(100-C,100))}}function CU(n,e){var t=BS(n),i=t.width,r=t.height,a=t.radius,h=e.hsv,s=a,p=i-a*2,x=r-a*2;return{x:s+h.s/100*p,y:s+(x-h.v/100*x)}}function AU(n,e){var t=e.hue;return[[[0,"#fff"],[100,"hsl("+t+",100%,50%)"]],[[0,"rgba(0,0,0,0)"],[100,"#000"]]]}var yT;function MU(n){yT||(yT=document.getElementsByTagName("base"));var e=window.navigator.userAgent,t=/^((?!chrome|android).)*safari/i.test(e),i=/iPhone|iPod|iPad/i.test(e),r=window.location;return(t||i)&&yT.length>0?r.protocol+"//"+r.host+r.pathname+r.search+n:n}function uP(n,e,t,i){for(var r=0;r<i.length;r++){var a=i[r].x-e,h=i[r].y-t,s=Math.sqrt(a*a+h*h);if(s<n.handleRadius)return r}return null}function zS(n){return{boxSizing:"border-box",border:n.borderWidth+"px solid "+n.borderColor}}function YT(n,e,t){return n+"-gradient("+e+", "+t.map(function(i){var r=i[0],a=i[1];return a+" "+r+"%"}).join(",")+")"}function Hu(n){return typeof n=="string"?n:n+"px"}var LU={width:300,height:300,color:"#fff",colors:[],padding:6,layoutDirection:"vertical",borderColor:"#fff",borderWidth:0,handleRadius:8,activeHandleRadius:null,handleSvg:null,handleProps:{x:0,y:0},wheelLightness:!0,wheelAngle:0,wheelDirection:"anticlockwise",sliderSize:null,sliderMargin:12,boxHeight:null},tM=["mousemove","touchmove","mouseup","touchend"],aw=function(n){function e(t){n.call(this,t),this.uid=(Math.random()+1).toString(36).substring(5)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.render=function(i){var r=this.handleEvent.bind(this),a={onMouseDown:r,ontouchstart:r},h=i.layoutDirection==="horizontal",s=i.margin===null?i.sliderMargin:i.margin,p={overflow:"visible",display:h?"inline-block":"block"};return i.index>0&&(p[h?"marginLeft":"marginTop"]=s),eo(rw,null,i.children(this.uid,a,p))},e.prototype.handleEvent=function(i){var r=this,a=this.props.onInput,h=this.base.getBoundingClientRect();i.preventDefault();var s=i.touches?i.changedTouches[0]:i,p=s.clientX-h.left,x=s.clientY-h.top;switch(i.type){case"mousedown":case"touchstart":var I=a(p,x,0);I!==!1&&tM.forEach(function(C){document.addEventListener(C,r,{passive:!1})});break;case"mousemove":case"touchmove":a(p,x,1);break;case"mouseup":case"touchend":a(p,x,2),tM.forEach(function(C){document.removeEventListener(C,r,{passive:!1})});break}},e}(uv);function S_(n){var e=n.r,t=n.url,i=e,r=e;return eo("svg",{className:"IroHandle IroHandle--"+n.index+" "+(n.isActive?"IroHandle--isActive":""),style:{"-webkit-tap-highlight-color":"rgba(0, 0, 0, 0);",transform:"translate("+Hu(n.x)+", "+Hu(n.y)+")",willChange:"transform",top:Hu(-e),left:Hu(-e),width:Hu(e*2),height:Hu(e*2),position:"absolute",overflow:"visible"}},t&&eo("use",Object.assign({xlinkHref:MU(t)},n.props)),!t&&eo("circle",{cx:i,cy:r,r:e,fill:"none","stroke-width":2,stroke:"#000"}),!t&&eo("circle",{cx:i,cy:r,r:e-2,fill:n.fill,"stroke-width":2,stroke:"#fff"}))}S_.defaultProps={fill:"none",x:0,y:0,r:8,url:null,props:{x:0,y:0}};function zE(n){var e=n.activeIndex,t=e!==void 0&&e<n.colors.length?n.colors[e]:n.color,i=FS(n),r=i.width,a=i.height,h=i.radius,s=EU(n,t),p=wU(n,t);function x(I,C,M){var O=bU(n,I,C);n.parent.inputActive=!0,t[n.sliderType]=O,n.onInput(M,n.id)}return eo(aw,Object.assign({},n,{onInput:x}),function(I,C,M){return eo("div",Object.assign({},C,{className:"IroSlider",style:Object.assign({},{position:"relative",width:Hu(r),height:Hu(a),borderRadius:Hu(h),background:"conic-gradient(#ccc 25%, #fff 0 50%, #ccc 0 75%, #fff 0)",backgroundSize:"8px 8px"},M)}),eo("div",{className:"IroSliderGradient",style:Object.assign({},{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:Hu(h),background:YT("linear",n.layoutDirection==="horizontal"?"to top":"to right",p)},zS(n))}),eo(S_,{isActive:!0,index:t.index,r:n.handleRadius,url:n.handleSvg,props:n.handleProps,x:s.x,y:s.y}))})}zE.defaultProps=Object.assign({},vU);function PU(n){var e=BS(n),t=e.width,i=e.height,r=e.radius,a=n.colors,h=n.parent,s=n.activeIndex,p=s!==void 0&&s<n.colors.length?n.colors[s]:n.color,x=AU(n,p),I=a.map(function(M){return CU(n,M)});function C(M,O,k){if(k===0){var z=uP(n,M,O,I);z!==null?h.setActiveColor(z):(h.inputActive=!0,p.hsv=eM(n,M,O),n.onInput(k,n.id))}else k===1&&(h.inputActive=!0,p.hsv=eM(n,M,O));n.onInput(k,n.id)}return eo(aw,Object.assign({},n,{onInput:C}),function(M,O,k){return eo("div",Object.assign({},O,{className:"IroBox",style:Object.assign({},{width:Hu(t),height:Hu(i),position:"relative"},k)}),eo("div",{className:"IroBox",style:Object.assign({},{width:"100%",height:"100%",borderRadius:Hu(r)},zS(n),{background:YT("linear","to bottom",x[1])+","+YT("linear","to right",x[0])})}),a.filter(function(z){return z!==p}).map(function(z){return eo(S_,{isActive:!1,index:z.index,fill:z.hslString,r:n.handleRadius,url:n.handleSvg,props:n.handleProps,x:I[z.index].x,y:I[z.index].y})}),eo(S_,{isActive:!0,index:p.index,fill:p.hslString,r:n.activeHandleRadius||n.handleRadius,url:n.handleSvg,props:n.handleProps,x:I[p.index].x,y:I[p.index].y}))})}var RU="conic-gradient(red, yellow, lime, aqua, blue, magenta, red)",DU="conic-gradient(red, magenta, blue, aqua, lime, yellow, red)";function cP(n){var e=ow(n),t=e.width,i=n.colors;n.borderWidth;var r=n.parent,a=n.color,h=a.hsv,s=i.map(function(I){return SU(n,I)}),p={position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",boxSizing:"border-box"};function x(I,C,M){if(M===0){if(!TU(n,I,C))return!1;var O=uP(n,I,C,s);O!==null?r.setActiveColor(O):(r.inputActive=!0,a.hsv=$A(n,I,C),n.onInput(M,n.id))}else M===1&&(r.inputActive=!0,a.hsv=$A(n,I,C));n.onInput(M,n.id)}return eo(aw,Object.assign({},n,{onInput:x}),function(I,C,M){return eo("div",Object.assign({},C,{className:"IroWheel",style:Object.assign({},{width:Hu(t),height:Hu(t),position:"relative"},M)}),eo("div",{className:"IroWheelHue",style:Object.assign({},p,{transform:"rotateZ("+(n.wheelAngle+90)+"deg)",background:n.wheelDirection==="clockwise"?RU:DU})}),eo("div",{className:"IroWheelSaturation",style:Object.assign({},p,{background:"radial-gradient(circle closest-side, #fff, transparent)"})}),n.wheelLightness&&eo("div",{className:"IroWheelLightness",style:Object.assign({},p,{background:"#000",opacity:1-h.v/100})}),eo("div",{className:"IroWheelBorder",style:Object.assign({},p,zS(n))}),i.filter(function(O){return O!==a}).map(function(O){return eo(S_,{isActive:!1,index:O.index,fill:O.hslString,r:n.handleRadius,url:n.handleSvg,props:n.handleProps,x:s[O.index].x,y:s[O.index].y})}),eo(S_,{isActive:!0,index:a.index,fill:a.hslString,r:n.activeHandleRadius||n.handleRadius,url:n.handleSvg,props:n.handleProps,x:s[a.index].x,y:s[a.index].y}))})}function OU(n){var e=function(t,i){var r,a=document.createElement("div");sU(eo(n,Object.assign({},{ref:function(s){return r=s}},i)),a);function h(){var s=t instanceof Element?t:document.querySelector(t);s.appendChild(r.base),r.onMount(s)}return document.readyState!=="loading"?h():document.addEventListener("DOMContentLoaded",h),r};return e.prototype=n.prototype,Object.assign(e,n),e.__component=n,e}var hP=function(n){function e(t){var i=this;n.call(this,t),this.colors=[],this.inputActive=!1,this.events={},this.activeEvents={},this.deferredEvents={},this.id=t.id;var r=t.colors.length>0?t.colors:[t.color];r.forEach(function(a){return i.addColor(a)}),this.setActiveColor(0),this.state=Object.assign({},t,{color:this.color,colors:this.colors,layout:t.layout})}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.addColor=function(i,r){r===void 0&&(r=this.colors.length);var a=new tv(i,this.onColorChange.bind(this));this.colors.splice(r,0,a),this.colors.forEach(function(h,s){return h.index=s}),this.state&&this.setState({colors:this.colors}),this.deferredEmit("color:init",a)},e.prototype.removeColor=function(i){var r=this.colors.splice(i,1)[0];r.unbind(),this.colors.forEach(function(a,h){return a.index=h}),this.state&&this.setState({colors:this.colors}),r.index===this.color.index&&this.setActiveColor(0),this.emit("color:remove",r)},e.prototype.setActiveColor=function(i){this.color=this.colors[i],this.state&&this.setState({color:this.color}),this.emit("color:setActive",this.color)},e.prototype.setColors=function(i,r){var a=this;r===void 0&&(r=0),this.colors.forEach(function(h){return h.unbind()}),this.colors=[],i.forEach(function(h){return a.addColor(h)}),this.setActiveColor(r),this.emit("color:setAll",this.colors)},e.prototype.on=function(i,r){var a=this,h=this.events;(Array.isArray(i)?i:[i]).forEach(function(s){(h[s]||(h[s]=[])).push(r),a.deferredEvents[s]&&(a.deferredEvents[s].forEach(function(p){r.apply(null,p)}),a.deferredEvents[s]=[])})},e.prototype.off=function(i,r){var a=this;(Array.isArray(i)?i:[i]).forEach(function(h){var s=a.events[h];s&&s.splice(s.indexOf(r),1)})},e.prototype.emit=function(i){for(var r=this,a=[],h=arguments.length-1;h-- >0;)a[h]=arguments[h+1];var s=this.activeEvents,p=s.hasOwnProperty(i)?s[i]:!1;if(!p){s[i]=!0;var x=this.events[i]||[];x.forEach(function(I){return I.apply(r,a)}),s[i]=!1}},e.prototype.deferredEmit=function(i){for(var r,a=[],h=arguments.length-1;h-- >0;)a[h]=arguments[h+1];var s=this.deferredEvents;(r=this).emit.apply(r,[i].concat(a)),(s[i]||(s[i]=[])).push(a)},e.prototype.setOptions=function(i){this.setState(i)},e.prototype.resize=function(i){this.setOptions({width:i})},e.prototype.reset=function(){this.colors.forEach(function(i){return i.reset()}),this.setState({colors:this.colors})},e.prototype.onMount=function(i){this.el=i,this.deferredEmit("mount",this)},e.prototype.onColorChange=function(i,r){this.setState({color:this.color}),this.inputActive&&(this.inputActive=!1,this.emit("input:change",i,r)),this.emit("color:change",i,r)},e.prototype.emitInputEvent=function(i,r){i===0?this.emit("input:start",this.color,r):i===1?this.emit("input:move",this.color,r):i===2&&this.emit("input:end",this.color,r)},e.prototype.render=function(i,r){var a=this,h=r.layout;if(!Array.isArray(h)){switch(h){default:h=[{component:cP},{component:zE}]}r.transparency&&h.push({component:zE,options:{sliderType:"alpha"}})}return eo("div",{class:"IroColorPicker",id:r.id,style:{display:r.display}},h.map(function(s,p){var x=s.component,I=s.options;return eo(x,Object.assign({},r,I,{ref:void 0,onInput:a.emitInputEvent.bind(a),parent:a,index:p}))}))},e}(uv);hP.defaultProps=Object.assign({},LU,{colors:[],display:"block",id:null,layout:"default",margin:null});var NU=OU(hP),KT;(function(n){n.version="5.5.2",n.Color=tv,n.ColorPicker=NU,function(e){e.h=eo,e.ComponentBase=aw,e.Handle=S_,e.Slider=zE,e.Wheel=cP,e.Box=PU}(n.ui||(n.ui={}))})(KT||(KT={}));var iE=KT;function kU(n){let e;return{c(){e=_r("Apply")},l(t){e=yr(t,"Apply")},m(t,i){Tt(t,e,i)},d(t){t&&Oe(e)}}}function FU(n){let e;return{c(){e=_r("Cancel")},l(t){e=yr(t,"Cancel")},m(t,i){Tt(t,e,i)},d(t){t&&Oe(e)}}}function BU(n){let e,t,i,r,a,h,s,p,x,I,C,M,O,k,z,G;function q(K){n[6](K)}let Z={label:"Layer name"};return n[0]!==void 0&&(Z.value=n[0]),h=new w5({props:Z}),$n.push(()=>ho(h,"value",q)),O=new _1({props:{variant:"unelevated",$$slots:{default:[kU]},$$scope:{ctx:n}}}),O.$on("click",n[2]),z=new _1({props:{variant:"outlined",$$slots:{default:[FU]},$$scope:{ctx:n}}}),z.$on("click",n[7]),{c(){e=un("h3"),t=_r("Properties"),i=qn(),r=un("span"),a=qn(),Pn(h.$$.fragment),p=qn(),x=un("div"),I=qn(),C=un("span"),M=un("span"),Pn(O.$$.fragment),k=qn(),Pn(z.$$.fragment),this.h()},l(K){e=cn(K,"H3",{});var te=_n(e);t=yr(te,"Properties"),te.forEach(Oe),i=Hn(K),r=cn(K,"SPAN",{style:!0}),_n(r).forEach(Oe),a=Hn(K),Zn(h.$$.fragment,K),p=Hn(K),x=cn(K,"DIV",{class:!0,id:!0}),_n(x).forEach(Oe),I=Hn(K),C=cn(K,"SPAN",{class:!0});var ie=_n(C);M=cn(ie,"SPAN",{id:!0,class:!0});var Te=_n(M);Zn(O.$$.fragment,Te),Te.forEach(Oe),k=Hn(ie),Zn(z.$$.fragment,ie),ie.forEach(Oe),this.h()},h(){Wu(r,"height","10px"),tn(x,"class","wheel svelte-sxmi40"),tn(x,"id","colorWheel"),tn(M,"id","apply-btn"),tn(M,"class","svelte-sxmi40"),tn(C,"class","btn-row svelte-sxmi40")},m(K,te){Tt(K,e,te),an(e,t),Tt(K,i,te),Tt(K,r,te),Tt(K,a,te),Rn(h,K,te),Tt(K,p,te),Tt(K,x,te),Tt(K,I,te),Tt(K,C,te),an(C,M),Rn(O,M,null),an(C,k),Rn(z,C,null),G=!0},p(K,[te]){const ie={};!s&&te&1&&(s=!0,ie.value=K[0],Eo(()=>s=!1)),h.$set(ie);const Te={};te&256&&(Te.$$scope={dirty:te,ctx:K}),O.$set(Te);const le={};te&256&&(le.$$scope={dirty:te,ctx:K}),z.$set(le)},i(K){G||(Ke(h.$$.fragment,K),Ke(O.$$.fragment,K),Ke(z.$$.fragment,K),G=!0)},o(K){rt(h.$$.fragment,K),rt(O.$$.fragment,K),rt(z.$$.fragment,K),G=!1},d(K){K&&Oe(e),K&&Oe(i),K&&Oe(r),K&&Oe(a),Dn(h,K),K&&Oe(p),K&&Oe(x),K&&Oe(I),K&&Oe(C),Dn(O),Dn(z)}}}function zU(n){return{color:"#"+((n.r|256).toString(16).slice(1)+(n.g|256).toString(16).slice(1)+(n.b|256).toString(16).slice(1)),opacity:n.a}}function UU(n){var e=Math.round(n*255),t=e.toString(16).padStart(2,"0");return t}function VU(n,e,t){let i,r,{layer:a}=e,h;const s=z1();function p(){s("propertiesSet",{layer:a,newName:r,...zU(h.color.rgba)})}Ll(()=>{t(4,h=iE.ColorPicker("#colorWheel",{width:250,color:"#fff",layoutDirection:"vertical",padding:4,handleRadius:8,wheelLightness:!0,wheelDirection:"anticlockwise",sliderSize:void 0,sliderMargin:12,layout:[{component:iE.ui.Wheel,options:{wheelLightness:!0,wheelAngle:0,wheelDirection:"anticlockwise"}},{component:iE.ui.Slider,options:{sliderType:"value"}},{component:iE.ui.Slider,options:{sliderType:"alpha",activeIndex:2}}]}))});function x(C){r=C,t(0,r),t(5,i),t(3,a)}const I=()=>s("closeProperties");return n.$$set=C=>{"layer"in C&&t(3,a=C.layer)},n.$$.update=()=>{if(n.$$.dirty&8&&t(5,i=a.displayName),n.$$.dirty&32&&t(0,r=i),n.$$.dirty&24&&h){const C=a.paint[`${a.type}-color`],M=a.paint[`${a.type}-opacity`],O=UU(M||1);h.color.set(C+O)}},[r,s,p,a,h,i,x,I]}class GU extends Fr{constructor(e){super(),Br(this,e,VU,BU,Lr,{layer:3})}}function jU(n){let e,t;return{c(){e=un("h1"),t=_r("Info")},l(i){e=cn(i,"H1",{});var r=_n(e);t=yr(r,"Info"),r.forEach(Oe)},m(i,r){Tt(i,e,r),an(e,t)},p:za,i:za,o:za,d(i){i&&Oe(e)}}}function qU(n,e,t){let{layer:i}=e;return n.$$set=r=>{"layer"in r&&t(0,i=r.layer)},[i]}class HU extends Fr{constructor(e){super(),Br(this,e,qU,jU,Lr,{layer:0})}}function nM(n){let e,t,i,r;function a(p){n[2](p)}var h=n[1].component;function s(p){let x={};return p[0]!==void 0&&(x.layer=p[0]),{props:x}}return h&&(e=Tl(h,s(n)),$n.push(()=>ho(e,"layer",a)),e.$on("propertiesSet",n[3]),e.$on("closeProperties",n[4])),{c(){e&&Pn(e.$$.fragment),i=Ei()},l(p){e&&Zn(e.$$.fragment,p),i=Ei()},m(p,x){e&&Rn(e,p,x),Tt(p,i,x),r=!0},p(p,x){const I={};if(!t&&x&1&&(t=!0,I.layer=p[0],Eo(()=>t=!1)),h!==(h=p[1].component)){if(e){vr();const C=e;rt(C.$$.fragment,1,0,()=>{Dn(C,1)}),xr()}h?(e=Tl(h,s(p)),$n.push(()=>ho(e,"layer",a)),e.$on("propertiesSet",p[3]),e.$on("closeProperties",p[4]),Pn(e.$$.fragment),Ke(e.$$.fragment,1),Rn(e,i.parentNode,i)):e=null}else h&&e.$set(I)},i(p){r||(e&&Ke(e.$$.fragment,p),r=!0)},o(p){e&&rt(e.$$.fragment,p),r=!1},d(p){p&&Oe(i),e&&Dn(e,p)}}}function WU(n){let e,t,i,r=n[0]&&nM(n);return{c(){e=un("div"),t=un("div"),r&&r.c(),this.h()},l(a){e=cn(a,"DIV",{class:!0});var h=_n(e);t=cn(h,"DIV",{class:!0});var s=_n(t);r&&r.l(s),s.forEach(Oe),h.forEach(Oe),this.h()},h(){tn(t,"class","content svelte-qwyr07"),tn(e,"class","container svelte-qwyr07")},m(a,h){Tt(a,e,h),an(e,t),r&&r.m(t,null),i=!0},p(a,[h]){a[0]?r?(r.p(a,h),h&1&&Ke(r,1)):(r=nM(a),r.c(),Ke(r,1),r.m(t,null)):r&&(vr(),rt(r,1,1,()=>{r=null}),xr())},i(a){i||(Ke(r),i=!0)},o(a){rt(r),i=!1},d(a){a&&Oe(e),r&&r.d()}}}function XU(n,e,t){let{layer:i}=e,a=[{tabName:"Properties",component:GU},{tabName:"Info",component:HU}][0];function h(x){i=x,t(0,i)}function s(x){Zl.call(this,n,x)}function p(x){Zl.call(this,n,x)}return n.$$set=x=>{"layer"in x&&t(0,i=x.layer)},[i,a,h,s,p]}class ZU extends Fr{constructor(e){super(),Br(this,e,XU,WU,Lr,{layer:0})}}function iM(n){let e,t,i,r;function a(s){n[10](s)}let h={};return n[4]!==void 0&&(h.layer=n[4]),t=new ZU({props:h}),$n.push(()=>ho(t,"layer",a)),t.$on("propertiesSet",n[6]),t.$on("closeProperties",n[11]),{c(){e=un("span"),Pn(t.$$.fragment),this.h()},l(s){e=cn(s,"SPAN",{style:!0});var p=_n(e);Zn(t.$$.fragment,p),p.forEach(Oe),this.h()},h(){Wu(e,"margin-left","auto")},m(s,p){Tt(s,e,p),Rn(t,e,null),r=!0},p(s,p){const x={};!i&&p&16&&(i=!0,x.layer=s[4],Eo(()=>i=!1)),t.$set(x)},i(s){r||(Ke(t.$$.fragment,s),r=!0)},o(s){rt(t.$$.fragment,s),r=!1},d(s){s&&Oe(e),Dn(t)}}}function YU(n){let e,t,i,r,a,h,s,p,x,I;function C(G){n[7](G)}let M={map:n[0],draw:n[1],tools:n[2]};n[3]!==void 0&&(M.selectedTool=n[3]),r=new BF({props:M}),$n.push(()=>ho(r,"selectedTool",C)),r.$on("singleLayerSelect",n[5]);function O(G){n[8](G)}let k={tools:n[2]};n[3]!==void 0&&(k.selectedTool=n[3]),s=new qF({props:k}),$n.push(()=>ho(s,"selectedTool",O)),s.$on("toolSelected",n[9]);let z=n[4]&&iM(n);return{c(){e=un("div"),t=qn(),i=un("div"),Pn(r.$$.fragment),h=qn(),Pn(s.$$.fragment),x=qn(),z&&z.c(),this.h()},l(G){e=cn(G,"DIV",{id:!0,class:!0}),_n(e).forEach(Oe),t=Hn(G),i=cn(G,"DIV",{id:!0,class:!0});var q=_n(i);Zn(r.$$.fragment,q),h=Hn(q),Zn(s.$$.fragment,q),x=Hn(q),z&&z.l(q),q.forEach(Oe),this.h()},h(){tn(e,"id","map"),tn(e,"class","svelte-7s216m"),tn(i,"id","overlay"),tn(i,"class","svelte-7s216m")},m(G,q){Tt(G,e,q),Tt(G,t,q),Tt(G,i,q),Rn(r,i,null),an(i,h),Rn(s,i,null),an(i,x),z&&z.m(i,null),I=!0},p(G,[q]){const Z={};q&1&&(Z.map=G[0]),q&2&&(Z.draw=G[1]),q&4&&(Z.tools=G[2]),!a&&q&8&&(a=!0,Z.selectedTool=G[3],Eo(()=>a=!1)),r.$set(Z);const K={};q&4&&(K.tools=G[2]),!p&&q&8&&(p=!0,K.selectedTool=G[3],Eo(()=>p=!1)),s.$set(K),G[4]?z?(z.p(G,q),q&16&&Ke(z,1)):(z=iM(G),z.c(),Ke(z,1),z.m(i,null)):z&&(vr(),rt(z,1,1,()=>{z=null}),xr())},i(G){I||(Ke(r.$$.fragment,G),Ke(s.$$.fragment,G),Ke(z),I=!0)},o(G){rt(r.$$.fragment,G),rt(s.$$.fragment,G),rt(z),I=!1},d(G){G&&Oe(e),G&&Oe(t),G&&Oe(i),Dn(r),Dn(s),z&&z.d()}}}function KU(n,e,t){let i;id(n,bo,G=>t(13,i=G));let r,a,h,s=null,p;function x(G){t(4,p=G.detail.layer)}Ll(()=>{tC.accessToken="pk.eyJ1Ijoia29ob2xtIiwiYSI6ImNremUzM2tsMzJmZWsybm54d20xazFicWQifQ.uZRVptXit_O5hkkSFBKXug",t(0,r=new tC.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[10.345053,63.430515],zoom:11})),t(1,a=new nC({modes:{...nC.modes,draw_rectangle:WF},displayControlsDefault:!1,defaultMode:"simple_select"})),t(2,h=[{name:"bbox",iconPath:"button-icons/bbox.png",geoProcessor:Rz,tooltip:"Takes a set of features, calculates the bbox of all input features, and returns a bounding box."},{name:"buffer",iconPath:"button-icons/buffer.png",geoProcessor:XB,tooltip:"Calculates a buffer for input features for a given radius. For FeatureCollections, individual buffers are calculated for each feature, but you can use dissolve to combine them.",optionsComponent:{component:N6,props:{}}},{name:"clip",iconPath:"button-icons/clip.png",geoProcessor:u4,tooltip:"Clips a selected feature to the bbox (bounding box) using lineclip. Select two positions in the map to create the bbox.",optionsComponent:{component:Q6,props:{map:r,draw:a}}},{name:"difference",iconPath:"button-icons/difference.png",geoProcessor:Mz,tooltip:"Finds the difference between two polygons by clipping the second polygon from the first.",optionsComponent:{component:G6,props:{}}},{name:"intersect",iconPath:"button-icons/intersection.png",geoProcessor:bz,tooltip:"Takes two polygon or multi-polygon geometries and finds their polygonal intersection, if there is one."},{name:"union",iconPath:"button-icons/union.png",geoProcessor:Tz,tooltip:"Takes two (Multi)Polygon(s) and returns a combined polygon. If the input polygons are not contiguous, this function returns a MultiPolygon feature."},{name:"voronoi",iconPath:"button-icons/voronoi.png",geoProcessor:n4,tooltip:"Takes a FeatureCollection of points, and an optional bounding box, and returns a FeatureCollection of Voronoi polygons.",optionsComponent:{component:X6,props:{map:r,draw:a}}},{name:"dissolve",iconPath:"button-icons/dissolve.png",geoProcessor:f4,tooltip:"Dissolves a FeatureCollection of polygon features, filtered by an optional property name. Like a union reduction on a single FeatureCollection."}]),r.addControl(a,"top-left"),r.on("load",function(){bo.subscribeNewLayerIndex(G=>{if(!G)return;const{index:q}=G,Z=i[q],K=i[q-1];K?r.moveLayer(Z.id,K.id):r.moveLayer(Z.id)})}),bo.subscribe(G=>{G.forEach(q=>{r.getLayer(q.id)&&r.setLayoutProperty(q.id,"visibility",q.isVisible?"visible":"none")})})}),Uv.subscribe(G=>{G.forEach(q=>{if(r.getSource(q.id))return;const Z=q.geojson.data;if(!C_(Z))return;const K={type:"geojson",data:Z};r.addSource(q.id,K),eS(r,q)})});function I(G){const{layer:q,newName:Z,color:K,opacity:te}=G.detail;bo.update(ie=>{const Te=ie.find(le=>le.id===q.id);return Te&&(Te.displayName=Z,Te.paint[`${q.type}-color`]=K,Te.paint[`${q.type}-opacity`]=te),ie}),r.setPaintProperty(q.id,`${q.type}-color`,K),r.setPaintProperty(q.id,`${q.type}-opacity`,te)}function C(G){s=G,t(3,s)}function M(G){s=G,t(3,s)}const O=G=>t(3,s=G.detail);function k(G){p=G,t(4,p)}return[r,a,h,s,p,x,I,C,M,O,k,()=>{t(4,p=null)}]}class JU extends Fr{constructor(e){super(),Br(this,e,KU,YU,Lr,{})}}function QU(n){let e,t;return e=new JU({}),e.$on("variableUpdated",n[0]),{c(){Pn(e.$$.fragment)},l(i){Zn(e.$$.fragment,i)},m(i,r){Rn(e,i,r),t=!0},p:za,i(i){t||(Ke(e.$$.fragment,i),t=!0)},o(i){rt(e.$$.fragment,i),t=!1},d(i){Dn(e,i)}}}function $U(n){function e(t){Zl.call(this,n,t)}return[e]}class n8 extends Fr{constructor(e){super(),Br(this,e,$U,QU,Lr,{})}}export{n8 as component};
